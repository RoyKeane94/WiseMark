var Zb=r=>{throw TypeError(r)};var fp=(r,t,e)=>t.has(r)||Zb("Cannot "+e);var Xe=(r,t,e)=>(fp(r,t,"read from private field"),e?e.call(r):t.get(r)),ws=(r,t,e)=>t.has(r)?Zb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),hi=(r,t,e,i)=>(fp(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),xs=(r,t,e)=>(fp(r,t,"access private method"),e);var Jb=(r,t,e,i)=>({set _(a){hi(r,t,a,e)},get _(){return Xe(r,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=e(a);fetch(a.href,l)}})();var T1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cv(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var pp={exports:{}},xc={};var t0;function R1(){if(t0)return xc;t0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var u in a)u!=="key"&&(l[u]=a[u])}else l=a;return a=l.ref,{$$typeof:r,type:i,key:c,ref:a!==void 0?a:null,props:l}}return xc.Fragment=t,xc.jsx=e,xc.jsxs=e,xc}var e0;function M1(){return e0||(e0=1,pp.exports=R1()),pp.exports}var D=M1(),mp={exports:{}},ae={};var n0;function D1(){if(n0)return ae;n0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),w=Symbol.iterator;function S(U){return U===null||typeof U!="object"?null:(U=w&&U[w]||U["@@iterator"],typeof U=="function"?U:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A=Object.assign,C={};function M(U,J,ft){this.props=U,this.context=J,this.refs=C,this.updater=ft||_}M.prototype.isReactComponent={},M.prototype.setState=function(U,J){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,J,"setState")},M.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function N(){}N.prototype=M.prototype;function k(U,J,ft){this.props=U,this.context=J,this.refs=C,this.updater=ft||_}var j=k.prototype=new N;j.constructor=k,A(j,M.prototype),j.isPureReactComponent=!0;var F=Array.isArray;function z(){}var H={H:null,A:null,T:null,S:null},ct=Object.prototype.hasOwnProperty;function dt(U,J,ft){var wt=ft.ref;return{$$typeof:r,type:U,key:J,ref:wt!==void 0?wt:null,props:ft}}function Tt(U,J){return dt(U.type,J,U.props)}function xt(U){return typeof U=="object"&&U!==null&&U.$$typeof===r}function Nt(U){var J={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(ft){return J[ft]})}var At=/\/+/g;function Rt(U,J){return typeof U=="object"&&U!==null&&U.key!=null?Nt(""+U.key):J.toString(36)}function qt(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(z,z):(U.status="pending",U.then(function(J){U.status==="pending"&&(U.status="fulfilled",U.value=J)},function(J){U.status==="pending"&&(U.status="rejected",U.reason=J)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function G(U,J,ft,wt,Bt){var Ft=typeof U;(Ft==="undefined"||Ft==="boolean")&&(U=null);var It=!1;if(U===null)It=!0;else switch(Ft){case"bigint":case"string":case"number":It=!0;break;case"object":switch(U.$$typeof){case r:case t:It=!0;break;case p:return It=U._init,G(It(U._payload),J,ft,wt,Bt)}}if(It)return Bt=Bt(U),It=wt===""?"."+Rt(U,0):wt,F(Bt)?(ft="",It!=null&&(ft=It.replace(At,"$&/")+"/"),G(Bt,J,ft,"",function(kt){return kt})):Bt!=null&&(xt(Bt)&&(Bt=Tt(Bt,ft+(Bt.key==null||U&&U.key===Bt.key?"":(""+Bt.key).replace(At,"$&/")+"/")+It)),J.push(Bt)),1;It=0;var re=wt===""?".":wt+":";if(F(U))for(var Kt=0;Kt<U.length;Kt++)wt=U[Kt],Ft=re+Rt(wt,Kt),It+=G(wt,J,ft,Ft,Bt);else if(Kt=S(U),typeof Kt=="function")for(U=Kt.call(U),Kt=0;!(wt=U.next()).done;)wt=wt.value,Ft=re+Rt(wt,Kt++),It+=G(wt,J,ft,Ft,Bt);else if(Ft==="object"){if(typeof U.then=="function")return G(qt(U),J,ft,wt,Bt);throw J=String(U),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return It}function tt(U,J,ft){if(U==null)return U;var wt=[],Bt=0;return G(U,wt,"","",function(Ft){return J.call(ft,Ft,Bt++)}),wt}function vt(U){if(U._status===-1){var J=U._result;J=J(),J.then(function(ft){(U._status===0||U._status===-1)&&(U._status=1,U._result=ft)},function(ft){(U._status===0||U._status===-1)&&(U._status=2,U._result=ft)}),U._status===-1&&(U._status=0,U._result=J)}if(U._status===1)return U._result.default;throw U._result}var Xt=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Ct={map:tt,forEach:function(U,J,ft){tt(U,function(){J.apply(this,arguments)},ft)},count:function(U){var J=0;return tt(U,function(){J++}),J},toArray:function(U){return tt(U,function(J){return J})||[]},only:function(U){if(!xt(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return ae.Activity=y,ae.Children=Ct,ae.Component=M,ae.Fragment=e,ae.Profiler=a,ae.PureComponent=k,ae.StrictMode=i,ae.Suspense=d,ae.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,ae.__COMPILER_RUNTIME={__proto__:null,c:function(U){return H.H.useMemoCache(U)}},ae.cache=function(U){return function(){return U.apply(null,arguments)}},ae.cacheSignal=function(){return null},ae.cloneElement=function(U,J,ft){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var wt=A({},U.props),Bt=U.key;if(J!=null)for(Ft in J.key!==void 0&&(Bt=""+J.key),J)!ct.call(J,Ft)||Ft==="key"||Ft==="__self"||Ft==="__source"||Ft==="ref"&&J.ref===void 0||(wt[Ft]=J[Ft]);var Ft=arguments.length-2;if(Ft===1)wt.children=ft;else if(1<Ft){for(var It=Array(Ft),re=0;re<Ft;re++)It[re]=arguments[re+2];wt.children=It}return dt(U.type,Bt,wt)},ae.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},ae.createElement=function(U,J,ft){var wt,Bt={},Ft=null;if(J!=null)for(wt in J.key!==void 0&&(Ft=""+J.key),J)ct.call(J,wt)&&wt!=="key"&&wt!=="__self"&&wt!=="__source"&&(Bt[wt]=J[wt]);var It=arguments.length-2;if(It===1)Bt.children=ft;else if(1<It){for(var re=Array(It),Kt=0;Kt<It;Kt++)re[Kt]=arguments[Kt+2];Bt.children=re}if(U&&U.defaultProps)for(wt in It=U.defaultProps,It)Bt[wt]===void 0&&(Bt[wt]=It[wt]);return dt(U,Ft,Bt)},ae.createRef=function(){return{current:null}},ae.forwardRef=function(U){return{$$typeof:u,render:U}},ae.isValidElement=xt,ae.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:vt}},ae.memo=function(U,J){return{$$typeof:f,type:U,compare:J===void 0?null:J}},ae.startTransition=function(U){var J=H.T,ft={};H.T=ft;try{var wt=U(),Bt=H.S;Bt!==null&&Bt(ft,wt),typeof wt=="object"&&wt!==null&&typeof wt.then=="function"&&wt.then(z,Xt)}catch(Ft){Xt(Ft)}finally{J!==null&&ft.types!==null&&(J.types=ft.types),H.T=J}},ae.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},ae.use=function(U){return H.H.use(U)},ae.useActionState=function(U,J,ft){return H.H.useActionState(U,J,ft)},ae.useCallback=function(U,J){return H.H.useCallback(U,J)},ae.useContext=function(U){return H.H.useContext(U)},ae.useDebugValue=function(){},ae.useDeferredValue=function(U,J){return H.H.useDeferredValue(U,J)},ae.useEffect=function(U,J){return H.H.useEffect(U,J)},ae.useEffectEvent=function(U){return H.H.useEffectEvent(U)},ae.useId=function(){return H.H.useId()},ae.useImperativeHandle=function(U,J,ft){return H.H.useImperativeHandle(U,J,ft)},ae.useInsertionEffect=function(U,J){return H.H.useInsertionEffect(U,J)},ae.useLayoutEffect=function(U,J){return H.H.useLayoutEffect(U,J)},ae.useMemo=function(U,J){return H.H.useMemo(U,J)},ae.useOptimistic=function(U,J){return H.H.useOptimistic(U,J)},ae.useReducer=function(U,J,ft){return H.H.useReducer(U,J,ft)},ae.useRef=function(U){return H.H.useRef(U)},ae.useState=function(U){return H.H.useState(U)},ae.useSyncExternalStore=function(U,J,ft){return H.H.useSyncExternalStore(U,J,ft)},ae.useTransition=function(){return H.H.useTransition()},ae.version="19.2.4",ae}var i0;function fm(){return i0||(i0=1,mp.exports=D1()),mp.exports}var I=fm();const gh=Cv(I);var gp={exports:{}},Sc={},yp={exports:{}},bp={};var s0;function O1(){return s0||(s0=1,(function(r){function t(G,tt){var vt=G.length;G.push(tt);t:for(;0<vt;){var Xt=vt-1>>>1,Ct=G[Xt];if(0<a(Ct,tt))G[Xt]=tt,G[vt]=Ct,vt=Xt;else break t}}function e(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var tt=G[0],vt=G.pop();if(vt!==tt){G[0]=vt;t:for(var Xt=0,Ct=G.length,U=Ct>>>1;Xt<U;){var J=2*(Xt+1)-1,ft=G[J],wt=J+1,Bt=G[wt];if(0>a(ft,vt))wt<Ct&&0>a(Bt,ft)?(G[Xt]=Bt,G[wt]=vt,Xt=wt):(G[Xt]=ft,G[J]=vt,Xt=J);else if(wt<Ct&&0>a(Bt,vt))G[Xt]=Bt,G[wt]=vt,Xt=wt;else break t}}return tt}function a(G,tt){var vt=G.sortIndex-tt.sortIndex;return vt!==0?vt:G.id-tt.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;r.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();r.unstable_now=function(){return c.now()-u}}var d=[],f=[],p=1,y=null,w=3,S=!1,_=!1,A=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function j(G){for(var tt=e(f);tt!==null;){if(tt.callback===null)i(f);else if(tt.startTime<=G)i(f),tt.sortIndex=tt.expirationTime,t(d,tt);else break;tt=e(f)}}function F(G){if(A=!1,j(G),!_)if(e(d)!==null)_=!0,z||(z=!0,Nt());else{var tt=e(f);tt!==null&&qt(F,tt.startTime-G)}}var z=!1,H=-1,ct=5,dt=-1;function Tt(){return C?!0:!(r.unstable_now()-dt<ct)}function xt(){if(C=!1,z){var G=r.unstable_now();dt=G;var tt=!0;try{t:{_=!1,A&&(A=!1,N(H),H=-1),S=!0;var vt=w;try{e:{for(j(G),y=e(d);y!==null&&!(y.expirationTime>G&&Tt());){var Xt=y.callback;if(typeof Xt=="function"){y.callback=null,w=y.priorityLevel;var Ct=Xt(y.expirationTime<=G);if(G=r.unstable_now(),typeof Ct=="function"){y.callback=Ct,j(G),tt=!0;break e}y===e(d)&&i(d),j(G)}else i(d);y=e(d)}if(y!==null)tt=!0;else{var U=e(f);U!==null&&qt(F,U.startTime-G),tt=!1}}break t}finally{y=null,w=vt,S=!1}tt=void 0}}finally{tt?Nt():z=!1}}}var Nt;if(typeof k=="function")Nt=function(){k(xt)};else if(typeof MessageChannel<"u"){var At=new MessageChannel,Rt=At.port2;At.port1.onmessage=xt,Nt=function(){Rt.postMessage(null)}}else Nt=function(){M(xt,0)};function qt(G,tt){H=M(function(){G(r.unstable_now())},tt)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(G){G.callback=null},r.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ct=0<G?Math.floor(1e3/G):5},r.unstable_getCurrentPriorityLevel=function(){return w},r.unstable_next=function(G){switch(w){case 1:case 2:case 3:var tt=3;break;default:tt=w}var vt=w;w=tt;try{return G()}finally{w=vt}},r.unstable_requestPaint=function(){C=!0},r.unstable_runWithPriority=function(G,tt){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var vt=w;w=G;try{return tt()}finally{w=vt}},r.unstable_scheduleCallback=function(G,tt,vt){var Xt=r.unstable_now();switch(typeof vt=="object"&&vt!==null?(vt=vt.delay,vt=typeof vt=="number"&&0<vt?Xt+vt:Xt):vt=Xt,G){case 1:var Ct=-1;break;case 2:Ct=250;break;case 5:Ct=1073741823;break;case 4:Ct=1e4;break;default:Ct=5e3}return Ct=vt+Ct,G={id:p++,callback:tt,priorityLevel:G,startTime:vt,expirationTime:Ct,sortIndex:-1},vt>Xt?(G.sortIndex=vt,t(f,G),e(d)===null&&G===e(f)&&(A?(N(H),H=-1):A=!0,qt(F,vt-Xt))):(G.sortIndex=Ct,t(d,G),_||S||(_=!0,z||(z=!0,Nt()))),G},r.unstable_shouldYield=Tt,r.unstable_wrapCallback=function(G){var tt=w;return function(){var vt=w;w=tt;try{return G.apply(this,arguments)}finally{w=vt}}}})(bp)),bp}var a0;function N1(){return a0||(a0=1,yp.exports=O1()),yp.exports}var vp={exports:{}},Xn={};var r0;function k1(){if(r0)return Xn;r0=1;var r=fm();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(d,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:p}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Xn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Xn.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(d,f,null,p)},Xn.flushSync=function(d){var f=c.T,p=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=f,i.p=p,i.d.f()}},Xn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Xn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Xn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),w=typeof f.integrity=="string"?f.integrity:void 0,S=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:w,fetchPriority:S}):p==="script"&&i.d.X(d,{crossOrigin:y,integrity:w,fetchPriority:S,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Xn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Xn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);i.d.L(d,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Xn.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Xn.requestFormReset=function(d){i.d.r(d)},Xn.unstable_batchedUpdates=function(d,f){return d(f)},Xn.useFormState=function(d,f,p){return c.H.useFormState(d,f,p)},Xn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Xn.version="19.2.4",Xn}var o0;function Tv(){if(o0)return vp.exports;o0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),vp.exports=k1(),vp.exports}var l0;function L1(){if(l0)return Sc;l0=1;var r=N1(),t=fm(),e=Tv();function i(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,o=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(o=s.return),n=s.return;while(n)}return s.tag===3?o:null}function c(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function u(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function d(n){if(l(n)!==n)throw Error(i(188))}function f(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(i(188));return s!==n?null:n}for(var o=n,h=s;;){var g=o.return;if(g===null)break;var b=g.alternate;if(b===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===o)return d(g),n;if(b===h)return d(g),s;b=b.sibling}throw Error(i(188))}if(o.return!==h.return)o=g,h=b;else{for(var T=!1,L=g.child;L;){if(L===o){T=!0,o=g,h=b;break}if(L===h){T=!0,h=g,o=b;break}L=L.sibling}if(!T){for(L=b.child;L;){if(L===o){T=!0,o=b,h=g;break}if(L===h){T=!0,h=b,o=g;break}L=L.sibling}if(!T)throw Error(i(189))}}if(o.alternate!==h)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:s}function p(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=p(n),s!==null)return s;n=n.sibling}return null}var y=Object.assign,w=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),A=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),ct=Symbol.for("react.lazy"),dt=Symbol.for("react.activity"),Tt=Symbol.for("react.memo_cache_sentinel"),xt=Symbol.iterator;function Nt(n){return n===null||typeof n!="object"?null:(n=xt&&n[xt]||n["@@iterator"],typeof n=="function"?n:null)}var At=Symbol.for("react.client.reference");function Rt(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===At?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case A:return"Fragment";case M:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case z:return"SuspenseList";case dt:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case _:return"Portal";case k:return n.displayName||"Context";case N:return(n._context.displayName||"Context")+".Consumer";case j:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case H:return s=n.displayName||null,s!==null?s:Rt(n.type)||"Memo";case ct:s=n._payload,n=n._init;try{return Rt(n(s))}catch{}}return null}var qt=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,tt=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,vt={pending:!1,data:null,method:null,action:null},Xt=[],Ct=-1;function U(n){return{current:n}}function J(n){0>Ct||(n.current=Xt[Ct],Xt[Ct]=null,Ct--)}function ft(n,s){Ct++,Xt[Ct]=n.current,n.current=s}var wt=U(null),Bt=U(null),Ft=U(null),It=U(null);function re(n,s){switch(ft(Ft,s),ft(Bt,n),ft(wt,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?xb(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=xb(s),n=Sb(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}J(wt),ft(wt,n)}function Kt(){J(wt),J(Bt),J(Ft)}function kt(n){n.memoizedState!==null&&ft(It,n);var s=wt.current,o=Sb(s,n.type);s!==o&&(ft(Bt,n),ft(wt,o))}function He(n){Bt.current===n&&(J(wt),J(Bt)),It.current===n&&(J(It),yc._currentValue=vt)}var yt,le;function Mt(n){if(yt===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);yt=s&&s[1]||"",le=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+yt+n+le}var de=!1;function Wn(n,s){if(!n||de)return"";de=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var bt=function(){throw Error()};if(Object.defineProperty(bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(bt,[])}catch(ht){var lt=ht}Reflect.construct(n,[],bt)}else{try{bt.call()}catch(ht){lt=ht}n.call(bt.prototype)}}else{try{throw Error()}catch(ht){lt=ht}(bt=n())&&typeof bt.catch=="function"&&bt.catch(function(){})}}catch(ht){if(ht&&lt&&typeof ht.stack=="string")return[ht.stack,lt.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=h.DetermineComponentFrameRoot(),T=b[0],L=b[1];if(T&&L){var q=T.split(`
`),rt=L.split(`
`);for(g=h=0;h<q.length&&!q[h].includes("DetermineComponentFrameRoot");)h++;for(;g<rt.length&&!rt[g].includes("DetermineComponentFrameRoot");)g++;if(h===q.length||g===rt.length)for(h=q.length-1,g=rt.length-1;1<=h&&0<=g&&q[h]!==rt[g];)g--;for(;1<=h&&0<=g;h--,g--)if(q[h]!==rt[g]){if(h!==1||g!==1)do if(h--,g--,0>g||q[h]!==rt[g]){var mt=`
`+q[h].replace(" at new "," at ");return n.displayName&&mt.includes("<anonymous>")&&(mt=mt.replace("<anonymous>",n.displayName)),mt}while(1<=h&&0<=g);break}}}finally{de=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?Mt(o):""}function On(n,s){switch(n.tag){case 26:case 27:case 5:return Mt(n.type);case 16:return Mt("Lazy");case 13:return n.child!==s&&s!==null?Mt("Suspense Fallback"):Mt("Suspense");case 19:return Mt("SuspenseList");case 0:case 15:return Wn(n.type,!1);case 11:return Wn(n.type.render,!1);case 1:return Wn(n.type,!0);case 31:return Mt("Activity");default:return""}}function si(n){try{var s="",o=null;do s+=On(n,o),o=n,n=n.return;while(n);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var Di=Object.prototype.hasOwnProperty,An=r.unstable_scheduleCallback,En=r.unstable_cancelCallback,nu=r.unstable_shouldYield,cr=r.unstable_requestPaint,Hn=r.unstable_now,ur=r.unstable_getCurrentPriorityLevel,qn=r.unstable_ImmediatePriority,ss=r.unstable_UserBlockingPriority,va=r.unstable_NormalPriority,hr=r.unstable_LowPriority,ao=r.unstable_IdlePriority,ro=r.log,Ns=r.unstable_setDisableYieldValue,as=null,Nn=null;function kn(n){if(typeof ro=="function"&&Ns(n),Nn&&typeof Nn.setStrictMode=="function")try{Nn.setStrictMode(as,n)}catch{}}var jt=Math.clz32?Math.clz32:oo,dr=Math.log,ks=Math.LN2;function oo(n){return n>>>=0,n===0?32:31-(dr(n)/ks|0)|0}var Lt=256,wa=262144,fr=4194304;function Xi(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function pr(n,s,o){var h=n.pendingLanes;if(h===0)return 0;var g=0,b=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var L=h&134217727;return L!==0?(h=L&~b,h!==0?g=Xi(h):(T&=L,T!==0?g=Xi(T):o||(o=L&~n,o!==0&&(g=Xi(o))))):(L=h&~b,L!==0?g=Xi(L):T!==0?g=Xi(T):o||(o=h&~n,o!==0&&(g=Xi(o)))),g===0?0:s!==0&&s!==g&&(s&b)===0&&(b=g&-g,o=s&-s,b>=o||b===32&&(o&4194048)!==0)?s:g}function Ls(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function vd(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function iu(){var n=fr;return fr<<=1,(fr&62914560)===0&&(fr=4194304),n}function rs(n){for(var s=[],o=0;31>o;o++)s.push(n);return s}function Oi(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function xl(n,s,o,h,g,b){var T=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var L=n.entanglements,q=n.expirationTimes,rt=n.hiddenUpdates;for(o=T&~o;0<o;){var mt=31-jt(o),bt=1<<mt;L[mt]=0,q[mt]=-1;var lt=rt[mt];if(lt!==null)for(rt[mt]=null,mt=0;mt<lt.length;mt++){var ht=lt[mt];ht!==null&&(ht.lane&=-536870913)}o&=~bt}h!==0&&mr(n,h,0),b!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=b&~(T&~s))}function mr(n,s,o){n.pendingLanes|=s,n.suspendedLanes&=~s;var h=31-jt(s);n.entangledLanes|=s,n.entanglements[h]=n.entanglements[h]|1073741824|o&261930}function Ie(n,s){var o=n.entangledLanes|=s;for(n=n.entanglements;o;){var h=31-jt(o),g=1<<h;g&s|n[h]&s&&(n[h]|=s),o&=~g}}function sn(n,s){var o=s&-s;return o=(o&42)!==0?1:Sl(o),(o&(n.suspendedLanes|s))!==0?0:o}function Sl(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function xa(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function gr(){var n=tt.p;return n!==0?n:(n=window.event,n===void 0?32:Vb(n.type))}function yr(n,s){var o=tt.p;try{return tt.p=n,s()}finally{tt.p=o}}var os=Math.random().toString(36).slice(2),ze="__reactFiber$"+os,an="__reactProps$"+os,Zn="__reactContainer$"+os,Sa="__reactEvents$"+os,wd="__reactListeners$"+os,ls="__reactHandles$"+os,Al="__reactResources$"+os,yi="__reactMarker$"+os;function lo(n){delete n[ze],delete n[an],delete n[Sa],delete n[wd],delete n[ls]}function cs(n){var s=n[ze];if(s)return s;for(var o=n.parentNode;o;){if(s=o[Zn]||o[ze]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(n=Mb(n);n!==null;){if(o=n[ze])return o;n=Mb(n)}return s}n=o,o=n.parentNode}return null}function ke(n){if(n=n[ze]||n[Zn]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function bi(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(i(33))}function Gn(n){var s=n[Al];return s||(s=n[Al]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function rn(n){n[yi]=!0}var Ps=new Set,br={};function Yi(n,s){us(n,s),us(n+"Capture",s)}function us(n,s){for(br[n]=s,n=0;n<s.length;n++)Ps.add(s[n])}var Bs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),El={},vr={};function su(n){return Di.call(vr,n)?!0:Di.call(El,n)?!1:Bs.test(n)?vr[n]=!0:(El[n]=!0,!1)}function he(n,s,o){if(su(s))if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+o)}}function wr(n,s,o){if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+o)}}function Ni(n,s,o,h){if(h===null)n.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(s,o,""+h)}}function Ln(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Aa(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function au(n,s,o){var h=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,b=h.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return g.call(this)},set:function(T){o=""+T,b.call(this,T)}}),Object.defineProperty(n,s,{enumerable:h.enumerable}),{getValue:function(){return o},setValue:function(T){o=""+T},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function co(n){if(!n._valueTracker){var s=Aa(n)?"checked":"value";n._valueTracker=au(n,s,""+n[s])}}function _l(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return n&&(h=Aa(n)?n.checked?"true":"false":n.value),n=h,n!==o?(s.setValue(n),!0):!1}function Ae(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var xr=/[\n"\\]/g;function _n(n){return n.replace(xr,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function hs(n,s,o,h,g,b,T,L){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),s!=null?T==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+Ln(s)):n.value!==""+Ln(s)&&(n.value=""+Ln(s)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),s!=null?Sr(n,T,Ln(s)):o!=null?Sr(n,T,Ln(o)):h!=null&&n.removeAttribute("value"),g==null&&b!=null&&(n.defaultChecked=!!b),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?n.name=""+Ln(L):n.removeAttribute("name")}function uo(n,s,o,h,g,b,T,L){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.type=b),s!=null||o!=null){if(!(b!=="submit"&&b!=="reset"||s!=null)){co(n);return}o=o!=null?""+Ln(o):"",s=s!=null?""+Ln(s):o,L||s===n.value||(n.value=s),n.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,n.checked=L?n.checked:!!h,n.defaultChecked=!!h,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),co(n)}function Sr(n,s,o){s==="number"&&Ae(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Qi(n,s,o,h){if(n=n.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<n.length;o++)g=s.hasOwnProperty("$"+n[o].value),n[o].selected!==g&&(n[o].selected=g),g&&h&&(n[o].defaultSelected=!0)}else{for(o=""+Ln(o),s=null,g=0;g<n.length;g++){if(n[g].value===o){n[g].selected=!0,h&&(n[g].defaultSelected=!0);return}s!==null||n[g].disabled||(s=n[g])}s!==null&&(s.selected=!0)}}function Cl(n,s,o){if(s!=null&&(s=""+Ln(s),s!==n.value&&(n.value=s),o==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=o!=null?""+Ln(o):""}function Ar(n,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(i(92));if(qt(h)){if(1<h.length)throw Error(i(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=Ln(s),n.defaultValue=o,h=n.textContent,h===o&&h!==""&&h!==null&&(n.value=h),co(n)}function js(n,s){if(s){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=s;return}}n.textContent=s}var xd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function be(n,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":h?n.setProperty(s,o):typeof o!="number"||o===0||xd.has(s)?s==="float"?n.cssFloat=o:n[s]=(""+o).trim():n[s]=o+"px"}function Tl(n,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(n=n.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?n.setProperty(h,""):h==="float"?n.cssFloat="":n[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&o[g]!==h&&be(n,g,h)}else for(var b in s)s.hasOwnProperty(b)&&be(n,b,s[b])}function Rl(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Sd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Jn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Wi(n){return Jn.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ai(){}var ki=null;function ho(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Fs=null,qe=null;function vi(n){var s=ke(n);if(s&&(n=s.stateNode)){var o=n[an]||null;t:switch(n=s.stateNode,s.type){case"input":if(hs(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+_n(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==n&&h.form===n.form){var g=h[an]||null;if(!g)throw Error(i(90));hs(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===n.form&&_l(h)}break t;case"textarea":Cl(n,o.value,o.defaultValue);break t;case"select":s=o.value,s!=null&&Qi(n,!!o.multiple,s,!1)}}}var Is=!1;function Ea(n,s,o){if(Is)return n(s,o);Is=!0;try{var h=n(s);return h}finally{if(Is=!1,(Fs!==null||qe!==null)&&(Xu(),Fs&&(s=Fs,n=qe,qe=Fs=null,vi(s),n)))for(s=0;s<n.length;s++)vi(n[s])}}function Us(n,s){var o=n.stateNode;if(o===null)return null;var h=o[an]||null;if(h===null)return null;o=h[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break t;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var Cn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ml=!1;if(Cn)try{var Vn={};Object.defineProperty(Vn,"passive",{get:function(){Ml=!0}}),window.addEventListener("test",Vn,Vn),window.removeEventListener("test",Vn,Vn)}catch{Ml=!1}var Li=null,fo=null,_a=null;function Ca(){if(_a)return _a;var n,s=fo,o=s.length,h,g="value"in Li?Li.value:Li.textContent,b=g.length;for(n=0;n<o&&s[n]===g[n];n++);var T=o-n;for(h=1;h<=T&&s[o-h]===g[b-h];h++);return _a=g.slice(n,1<h?1-h:void 0)}function Ta(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function Er(){return!0}function ru(){return!1}function dn(n){function s(o,h,g,b,T){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=b,this.target=T,this.currentTarget=null;for(var L in n)n.hasOwnProperty(L)&&(o=n[L],this[L]=o?o(b):b[L]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Er:ru,this.isPropagationStopped=ru,this}return y(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Er)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Er)},persist:function(){},isPersistent:Er}),s}var zs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},po=dn(zs),ds=y({},zs,{view:0,detail:0}),mo=dn(ds),_r,Dl,Cr,go=y({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hs,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Cr&&(Cr&&n.type==="mousemove"?(_r=n.screenX-Cr.screenX,Dl=n.screenY-Cr.screenY):Dl=_r=0,Cr=n),_r)},movementY:function(n){return"movementY"in n?n.movementY:Dl}}),yo=dn(go),Ol=y({},go,{dataTransfer:0}),ou=dn(Ol),bo=y({},ds,{relatedTarget:0}),Ra=dn(bo),vo=y({},zs,{animationName:0,elapsedTime:0,pseudoElement:0}),lu=dn(vo),Ad=y({},zs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ma=dn(Ad),Nl=y({},zs,{data:0}),wo=dn(Nl),kl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ll={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Tn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tr(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=Tn[n])?!!s[n]:!1}function Hs(){return Tr}var cu=y({},ds,{key:function(n){if(n.key){var s=kl[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Ta(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ll[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hs,charCode:function(n){return n.type==="keypress"?Ta(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Ta(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),xo=dn(cu),uu=y({},go,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Pl=dn(uu),So=y({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hs}),Bl=dn(So),qs=y({},zs,{propertyName:0,elapsedTime:0,pseudoElement:0}),jl=dn(qs),Fl=y({},go,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),Ao=dn(Fl),Il=y({},zs,{newState:0,oldState:0}),hu=dn(Il),Ed=[9,13,27,32],Rr=Cn&&"CompositionEvent"in window,fs=null;Cn&&"documentMode"in document&&(fs=document.documentMode);var _d=Cn&&"TextEvent"in window&&!fs,Eo=Cn&&(!Rr||fs&&8<fs&&11>=fs),_o=" ",du=!1;function Ul(n,s){switch(n){case"keyup":return Ed.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function fu(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Gs=!1;function pu(n,s){switch(n){case"compositionend":return fu(s);case"keypress":return s.which!==32?null:(du=!0,_o);case"textInput":return n=s.data,n===_o&&du?null:n;default:return null}}function Cd(n,s){if(Gs)return n==="compositionend"||!Rr&&Ul(n,s)?(n=Ca(),_a=fo=Li=null,Gs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Eo&&s.locale!=="ko"?null:s.data;default:return null}}var mu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Co(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!mu[n.type]:s==="textarea"}function zl(n,s,o,h){Fs?qe?qe.push(h):qe=[h]:Fs=h,s=eh(s,"onChange"),0<s.length&&(o=new po("onChange","change",null,o,h),n.push({event:o,listeners:s}))}var Da=null,Mr=null;function Td(n){mb(n,0)}function To(n){var s=bi(n);if(_l(s))return n}function Dr(n,s){if(n==="change")return s}var Pi=!1;if(Cn){var Ge;if(Cn){var Oa="oninput"in document;if(!Oa){var Vs=document.createElement("div");Vs.setAttribute("oninput","return;"),Oa=typeof Vs.oninput=="function"}Ge=Oa}else Ge=!1;Pi=Ge&&(!document.documentMode||9<document.documentMode)}function gu(){Da&&(Da.detachEvent("onpropertychange",Ro),Mr=Da=null)}function Ro(n){if(n.propertyName==="value"&&To(Mr)){var s=[];zl(s,Mr,n,ho(n)),Ea(Td,s)}}function yu(n,s,o){n==="focusin"?(gu(),Da=s,Mr=o,Da.attachEvent("onpropertychange",Ro)):n==="focusout"&&gu()}function Ks(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return To(Mr)}function Hl(n,s){if(n==="click")return To(s)}function Na(n,s){if(n==="input"||n==="change")return To(s)}function ps(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var Kn=typeof Object.is=="function"?Object.is:ps;function m(n,s){if(Kn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var o=Object.keys(n),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!Di.call(s,g)||!Kn(n[g],s[g]))return!1}return!0}function v(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function x(n,s){var o=v(n);n=0;for(var h;o;){if(o.nodeType===3){if(h=n+o.textContent.length,n<=s&&h>=s)return{node:o,offset:s-n};n=h}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=v(o)}}function E(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?E(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function R(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=Ae(n.document);s instanceof n.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)n=s.contentWindow;else break;s=Ae(n.document)}return s}function O(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var P=Cn&&"documentMode"in document&&11>=document.documentMode,B=null,K=null,nt=null,$=!1;function V(n,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;$||B==null||B!==Ae(h)||(h=B,"selectionStart"in h&&O(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),nt&&m(nt,h)||(nt=h,h=eh(K,"onSelect"),0<h.length&&(s=new po("onSelect","select",null,s,o),n.push({event:s,listeners:h}),s.target=B)))}function Q(n,s){var o={};return o[n.toLowerCase()]=s.toLowerCase(),o["Webkit"+n]="webkit"+s,o["Moz"+n]="moz"+s,o}var Z={animationend:Q("Animation","AnimationEnd"),animationiteration:Q("Animation","AnimationIteration"),animationstart:Q("Animation","AnimationStart"),transitionrun:Q("Transition","TransitionRun"),transitionstart:Q("Transition","TransitionStart"),transitioncancel:Q("Transition","TransitionCancel"),transitionend:Q("Transition","TransitionEnd")},X={},Y={};Cn&&(Y=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function st(n){if(X[n])return X[n];if(!Z[n])return n;var s=Z[n],o;for(o in s)if(s.hasOwnProperty(o)&&o in Y)return X[n]=s[o];return n}var ot=st("animationend"),it=st("animationiteration"),pt=st("animationstart"),St=st("transitionrun"),Dt=st("transitionstart"),Ot=st("transitioncancel"),Et=st("transitionend"),Ut=new Map,Pt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pt.push("scrollEnd");function _t(n,s){Ut.set(n,s),Yi(s,[n])}var zt=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},ee=[],fe=0,Yt=0;function se(){for(var n=fe,s=Yt=fe=0;s<n;){var o=ee[s];ee[s++]=null;var h=ee[s];ee[s++]=null;var g=ee[s];ee[s++]=null;var b=ee[s];if(ee[s++]=null,h!==null&&g!==null){var T=h.pending;T===null?g.next=g:(g.next=T.next,T.next=g),h.pending=g}b!==0&&ms(o,g,b)}}function Le(n,s,o,h){ee[fe++]=n,ee[fe++]=s,ee[fe++]=o,ee[fe++]=h,Yt|=h,n.lanes|=h,n=n.alternate,n!==null&&(n.lanes|=h)}function $n(n,s,o,h){return Le(n,s,o,h),ka(n)}function De(n,s){return Le(n,null,null,s),ka(n)}function ms(n,s,o){n.lanes|=o;var h=n.alternate;h!==null&&(h.lanes|=o);for(var g=!1,b=n.return;b!==null;)b.childLanes|=o,h=b.alternate,h!==null&&(h.childLanes|=o),b.tag===22&&(n=b.stateNode,n===null||n._visibility&1||(g=!0)),n=b,b=b.return;return n.tag===3?(b=n.stateNode,g&&s!==null&&(g=31-jt(o),n=b.hiddenUpdates,h=n[g],h===null?n[g]=[s]:h.push(s),s.lane=o|536870912),b):null}function ka(n){if(50<uc)throw uc=0,jf=null,Error(i(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var Mo={};function ux(n,s,o,h){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function wi(n,s,o,h){return new ux(n,s,o,h)}function Rd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function $s(n,s){var o=n.alternate;return o===null?(o=wi(n.tag,s,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=s,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,s=n.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Wm(n,s){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,s=o.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function bu(n,s,o,h,g,b){var T=0;if(h=n,typeof n=="function")Rd(n)&&(T=1);else if(typeof n=="string")T=m1(n,o,wt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case dt:return n=wi(31,o,s,g),n.elementType=dt,n.lanes=b,n;case A:return Or(o.children,g,b,s);case C:T=8,g|=24;break;case M:return n=wi(12,o,s,g|2),n.elementType=M,n.lanes=b,n;case F:return n=wi(13,o,s,g),n.elementType=F,n.lanes=b,n;case z:return n=wi(19,o,s,g),n.elementType=z,n.lanes=b,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case k:T=10;break t;case N:T=9;break t;case j:T=11;break t;case H:T=14;break t;case ct:T=16,h=null;break t}T=29,o=Error(i(130,n===null?"null":typeof n,"")),h=null}return s=wi(T,o,s,g),s.elementType=n,s.type=h,s.lanes=b,s}function Or(n,s,o,h){return n=wi(7,n,h,s),n.lanes=o,n}function Md(n,s,o){return n=wi(6,n,null,s),n.lanes=o,n}function Zm(n){var s=wi(18,null,null,0);return s.stateNode=n,s}function Dd(n,s,o){return s=wi(4,n.children!==null?n.children:[],n.key,s),s.lanes=o,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var Jm=new WeakMap;function Bi(n,s){if(typeof n=="object"&&n!==null){var o=Jm.get(n);return o!==void 0?o:(s={value:n,source:s,stack:si(s)},Jm.set(n,s),s)}return{value:n,source:s,stack:si(s)}}var Do=[],Oo=0,vu=null,ql=0,ji=[],Fi=0,La=null,gs=1,ys="";function Xs(n,s){Do[Oo++]=ql,Do[Oo++]=vu,vu=n,ql=s}function tg(n,s,o){ji[Fi++]=gs,ji[Fi++]=ys,ji[Fi++]=La,La=n;var h=gs;n=ys;var g=32-jt(h)-1;h&=~(1<<g),o+=1;var b=32-jt(s)+g;if(30<b){var T=g-g%5;b=(h&(1<<T)-1).toString(32),h>>=T,g-=T,gs=1<<32-jt(s)+g|o<<g|h,ys=b+n}else gs=1<<b|o<<g|h,ys=n}function Od(n){n.return!==null&&(Xs(n,1),tg(n,1,0))}function Nd(n){for(;n===vu;)vu=Do[--Oo],Do[Oo]=null,ql=Do[--Oo],Do[Oo]=null;for(;n===La;)La=ji[--Fi],ji[Fi]=null,ys=ji[--Fi],ji[Fi]=null,gs=ji[--Fi],ji[Fi]=null}function eg(n,s){ji[Fi++]=gs,ji[Fi++]=ys,ji[Fi++]=La,gs=s.id,ys=s.overflow,La=n}var Pn=null,Ve=null,ve=!1,Pa=null,Ii=!1,kd=Error(i(519));function Ba(n){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Gl(Bi(s,n)),kd}function ng(n){var s=n.stateNode,o=n.type,h=n.memoizedProps;switch(s[ze]=n,s[an]=h,o){case"dialog":me("cancel",s),me("close",s);break;case"iframe":case"object":case"embed":me("load",s);break;case"video":case"audio":for(o=0;o<dc.length;o++)me(dc[o],s);break;case"source":me("error",s);break;case"img":case"image":case"link":me("error",s),me("load",s);break;case"details":me("toggle",s);break;case"input":me("invalid",s),uo(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":me("invalid",s);break;case"textarea":me("invalid",s),Ar(s,h.value,h.defaultValue,h.children)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||vb(s.textContent,o)?(h.popover!=null&&(me("beforetoggle",s),me("toggle",s)),h.onScroll!=null&&me("scroll",s),h.onScrollEnd!=null&&me("scrollend",s),h.onClick!=null&&(s.onclick=ai),s=!0):s=!1,s||Ba(n,!0)}function ig(n){for(Pn=n.return;Pn;)switch(Pn.tag){case 5:case 31:case 13:Ii=!1;return;case 27:case 3:Ii=!0;return;default:Pn=Pn.return}}function No(n){if(n!==Pn)return!1;if(!ve)return ig(n),ve=!0,!1;var s=n.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Zf(n.type,n.memoizedProps)),o=!o),o&&Ve&&Ba(n),ig(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Ve=Rb(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Ve=Rb(n)}else s===27?(s=Ve,Qa(n.type)?(n=ip,ip=null,Ve=n):Ve=s):Ve=Pn?zi(n.stateNode.nextSibling):null;return!0}function Nr(){Ve=Pn=null,ve=!1}function Ld(){var n=Pa;return n!==null&&(ci===null?ci=n:ci.push.apply(ci,n),Pa=null),n}function Gl(n){Pa===null?Pa=[n]:Pa.push(n)}var Pd=U(null),kr=null,Ys=null;function ja(n,s,o){ft(Pd,s._currentValue),s._currentValue=o}function Qs(n){n._currentValue=Pd.current,J(Pd)}function Bd(n,s,o){for(;n!==null;){var h=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),n===o)break;n=n.return}}function jd(n,s,o,h){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var b=g.dependencies;if(b!==null){var T=g.child;b=b.firstContext;t:for(;b!==null;){var L=b;b=g;for(var q=0;q<s.length;q++)if(L.context===s[q]){b.lanes|=o,L=b.alternate,L!==null&&(L.lanes|=o),Bd(b.return,o,n),h||(T=null);break t}b=L.next}}else if(g.tag===18){if(T=g.return,T===null)throw Error(i(341));T.lanes|=o,b=T.alternate,b!==null&&(b.lanes|=o),Bd(T,o,n),T=null}else T=g.child;if(T!==null)T.return=g;else for(T=g;T!==null;){if(T===n){T=null;break}if(g=T.sibling,g!==null){g.return=T.return,T=g;break}T=T.return}g=T}}function ko(n,s,o,h){n=null;for(var g=s,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var T=g.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var L=g.type;Kn(g.pendingProps.value,T.value)||(n!==null?n.push(L):n=[L])}}else if(g===It.current){if(T=g.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(yc):n=[yc])}g=g.return}n!==null&&jd(s,n,o,h),s.flags|=262144}function wu(n){for(n=n.firstContext;n!==null;){if(!Kn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Lr(n){kr=n,Ys=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Bn(n){return sg(kr,n)}function xu(n,s){return kr===null&&Lr(n),sg(n,s)}function sg(n,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},Ys===null){if(n===null)throw Error(i(308));Ys=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else Ys=Ys.next=s;return o}var hx=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(o,h){n.push(h)}};this.abort=function(){s.aborted=!0,n.forEach(function(o){return o()})}},dx=r.unstable_scheduleCallback,fx=r.unstable_NormalPriority,fn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Fd(){return{controller:new hx,data:new Map,refCount:0}}function Vl(n){n.refCount--,n.refCount===0&&dx(fx,function(){n.controller.abort()})}var Kl=null,Id=0,Lo=0,Po=null;function px(n,s){if(Kl===null){var o=Kl=[];Id=0,Lo=qf(),Po={status:"pending",value:void 0,then:function(h){o.push(h)}}}return Id++,s.then(ag,ag),s}function ag(){if(--Id===0&&Kl!==null){Po!==null&&(Po.status="fulfilled");var n=Kl;Kl=null,Lo=0,Po=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function mx(n,s){var o=[],h={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return n.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),h}var rg=G.S;G.S=function(n,s){qy=Hn(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&px(n,s),rg!==null&&rg(n,s)};var Pr=U(null);function Ud(){var n=Pr.current;return n!==null?n:Ue.pooledCache}function Su(n,s){s===null?ft(Pr,Pr.current):ft(Pr,s.pool)}function og(){var n=Ud();return n===null?null:{parent:fn._currentValue,pool:n}}var Bo=Error(i(460)),zd=Error(i(474)),Au=Error(i(542)),Eu={then:function(){}};function lg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function cg(n,s,o){switch(o=n[o],o===void 0?n.push(s):o!==s&&(s.then(ai,ai),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,hg(n),n;default:if(typeof s.status=="string")s.then(ai,ai);else{if(n=Ue,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=s,n.status="pending",n.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,hg(n),n}throw jr=s,Bo}}function Br(n){try{var s=n._init;return s(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(jr=o,Bo):o}}var jr=null;function ug(){if(jr===null)throw Error(i(459));var n=jr;return jr=null,n}function hg(n){if(n===Bo||n===Au)throw Error(i(483))}var jo=null,$l=0;function _u(n){var s=$l;return $l+=1,jo===null&&(jo=[]),cg(jo,n,s)}function Xl(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function Cu(n,s){throw s.$$typeof===w?Error(i(525)):(n=Object.prototype.toString.call(s),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function dg(n){function s(et,W){if(n){var at=et.deletions;at===null?(et.deletions=[W],et.flags|=16):at.push(W)}}function o(et,W){if(!n)return null;for(;W!==null;)s(et,W),W=W.sibling;return null}function h(et){for(var W=new Map;et!==null;)et.key!==null?W.set(et.key,et):W.set(et.index,et),et=et.sibling;return W}function g(et,W){return et=$s(et,W),et.index=0,et.sibling=null,et}function b(et,W,at){return et.index=at,n?(at=et.alternate,at!==null?(at=at.index,at<W?(et.flags|=67108866,W):at):(et.flags|=67108866,W)):(et.flags|=1048576,W)}function T(et){return n&&et.alternate===null&&(et.flags|=67108866),et}function L(et,W,at,gt){return W===null||W.tag!==6?(W=Md(at,et.mode,gt),W.return=et,W):(W=g(W,at),W.return=et,W)}function q(et,W,at,gt){var Qt=at.type;return Qt===A?mt(et,W,at.props.children,gt,at.key):W!==null&&(W.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===ct&&Br(Qt)===W.type)?(W=g(W,at.props),Xl(W,at),W.return=et,W):(W=bu(at.type,at.key,at.props,null,et.mode,gt),Xl(W,at),W.return=et,W)}function rt(et,W,at,gt){return W===null||W.tag!==4||W.stateNode.containerInfo!==at.containerInfo||W.stateNode.implementation!==at.implementation?(W=Dd(at,et.mode,gt),W.return=et,W):(W=g(W,at.children||[]),W.return=et,W)}function mt(et,W,at,gt,Qt){return W===null||W.tag!==7?(W=Or(at,et.mode,gt,Qt),W.return=et,W):(W=g(W,at),W.return=et,W)}function bt(et,W,at){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Md(""+W,et.mode,at),W.return=et,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case S:return at=bu(W.type,W.key,W.props,null,et.mode,at),Xl(at,W),at.return=et,at;case _:return W=Dd(W,et.mode,at),W.return=et,W;case ct:return W=Br(W),bt(et,W,at)}if(qt(W)||Nt(W))return W=Or(W,et.mode,at,null),W.return=et,W;if(typeof W.then=="function")return bt(et,_u(W),at);if(W.$$typeof===k)return bt(et,xu(et,W),at);Cu(et,W)}return null}function lt(et,W,at,gt){var Qt=W!==null?W.key:null;if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Qt!==null?null:L(et,W,""+at,gt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case S:return at.key===Qt?q(et,W,at,gt):null;case _:return at.key===Qt?rt(et,W,at,gt):null;case ct:return at=Br(at),lt(et,W,at,gt)}if(qt(at)||Nt(at))return Qt!==null?null:mt(et,W,at,gt,null);if(typeof at.then=="function")return lt(et,W,_u(at),gt);if(at.$$typeof===k)return lt(et,W,xu(et,at),gt);Cu(et,at)}return null}function ht(et,W,at,gt,Qt){if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return et=et.get(at)||null,L(W,et,""+gt,Qt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case S:return et=et.get(gt.key===null?at:gt.key)||null,q(W,et,gt,Qt);case _:return et=et.get(gt.key===null?at:gt.key)||null,rt(W,et,gt,Qt);case ct:return gt=Br(gt),ht(et,W,at,gt,Qt)}if(qt(gt)||Nt(gt))return et=et.get(at)||null,mt(W,et,gt,Qt,null);if(typeof gt.then=="function")return ht(et,W,at,_u(gt),Qt);if(gt.$$typeof===k)return ht(et,W,at,xu(W,gt),Qt);Cu(W,gt)}return null}function Vt(et,W,at,gt){for(var Qt=null,xe=null,$t=W,ue=W=0,ye=null;$t!==null&&ue<at.length;ue++){$t.index>ue?(ye=$t,$t=null):ye=$t.sibling;var Se=lt(et,$t,at[ue],gt);if(Se===null){$t===null&&($t=ye);break}n&&$t&&Se.alternate===null&&s(et,$t),W=b(Se,W,ue),xe===null?Qt=Se:xe.sibling=Se,xe=Se,$t=ye}if(ue===at.length)return o(et,$t),ve&&Xs(et,ue),Qt;if($t===null){for(;ue<at.length;ue++)$t=bt(et,at[ue],gt),$t!==null&&(W=b($t,W,ue),xe===null?Qt=$t:xe.sibling=$t,xe=$t);return ve&&Xs(et,ue),Qt}for($t=h($t);ue<at.length;ue++)ye=ht($t,et,ue,at[ue],gt),ye!==null&&(n&&ye.alternate!==null&&$t.delete(ye.key===null?ue:ye.key),W=b(ye,W,ue),xe===null?Qt=ye:xe.sibling=ye,xe=ye);return n&&$t.forEach(function(er){return s(et,er)}),ve&&Xs(et,ue),Qt}function Zt(et,W,at,gt){if(at==null)throw Error(i(151));for(var Qt=null,xe=null,$t=W,ue=W=0,ye=null,Se=at.next();$t!==null&&!Se.done;ue++,Se=at.next()){$t.index>ue?(ye=$t,$t=null):ye=$t.sibling;var er=lt(et,$t,Se.value,gt);if(er===null){$t===null&&($t=ye);break}n&&$t&&er.alternate===null&&s(et,$t),W=b(er,W,ue),xe===null?Qt=er:xe.sibling=er,xe=er,$t=ye}if(Se.done)return o(et,$t),ve&&Xs(et,ue),Qt;if($t===null){for(;!Se.done;ue++,Se=at.next())Se=bt(et,Se.value,gt),Se!==null&&(W=b(Se,W,ue),xe===null?Qt=Se:xe.sibling=Se,xe=Se);return ve&&Xs(et,ue),Qt}for($t=h($t);!Se.done;ue++,Se=at.next())Se=ht($t,et,ue,Se.value,gt),Se!==null&&(n&&Se.alternate!==null&&$t.delete(Se.key===null?ue:Se.key),W=b(Se,W,ue),xe===null?Qt=Se:xe.sibling=Se,xe=Se);return n&&$t.forEach(function(C1){return s(et,C1)}),ve&&Xs(et,ue),Qt}function je(et,W,at,gt){if(typeof at=="object"&&at!==null&&at.type===A&&at.key===null&&(at=at.props.children),typeof at=="object"&&at!==null){switch(at.$$typeof){case S:t:{for(var Qt=at.key;W!==null;){if(W.key===Qt){if(Qt=at.type,Qt===A){if(W.tag===7){o(et,W.sibling),gt=g(W,at.props.children),gt.return=et,et=gt;break t}}else if(W.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===ct&&Br(Qt)===W.type){o(et,W.sibling),gt=g(W,at.props),Xl(gt,at),gt.return=et,et=gt;break t}o(et,W);break}else s(et,W);W=W.sibling}at.type===A?(gt=Or(at.props.children,et.mode,gt,at.key),gt.return=et,et=gt):(gt=bu(at.type,at.key,at.props,null,et.mode,gt),Xl(gt,at),gt.return=et,et=gt)}return T(et);case _:t:{for(Qt=at.key;W!==null;){if(W.key===Qt)if(W.tag===4&&W.stateNode.containerInfo===at.containerInfo&&W.stateNode.implementation===at.implementation){o(et,W.sibling),gt=g(W,at.children||[]),gt.return=et,et=gt;break t}else{o(et,W);break}else s(et,W);W=W.sibling}gt=Dd(at,et.mode,gt),gt.return=et,et=gt}return T(et);case ct:return at=Br(at),je(et,W,at,gt)}if(qt(at))return Vt(et,W,at,gt);if(Nt(at)){if(Qt=Nt(at),typeof Qt!="function")throw Error(i(150));return at=Qt.call(at),Zt(et,W,at,gt)}if(typeof at.then=="function")return je(et,W,_u(at),gt);if(at.$$typeof===k)return je(et,W,xu(et,at),gt);Cu(et,at)}return typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint"?(at=""+at,W!==null&&W.tag===6?(o(et,W.sibling),gt=g(W,at),gt.return=et,et=gt):(o(et,W),gt=Md(at,et.mode,gt),gt.return=et,et=gt),T(et)):o(et,W)}return function(et,W,at,gt){try{$l=0;var Qt=je(et,W,at,gt);return jo=null,Qt}catch($t){if($t===Bo||$t===Au)throw $t;var xe=wi(29,$t,null,et.mode);return xe.lanes=gt,xe.return=et,xe}}}var Fr=dg(!0),fg=dg(!1),Fa=!1;function Hd(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function qd(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ia(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ua(n,s,o){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,(Ee&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=ka(n),ms(n,null,o),s}return Le(n,h,s,o),ka(n)}function Yl(n,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ie(n,o)}}function Gd(n,s){var o=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};b===null?g=b=T:b=b.next=T,o=o.next}while(o!==null);b===null?g=b=s:b=b.next=s}else g=b=s;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:h.shared,callbacks:h.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=s:n.next=s,o.lastBaseUpdate=s}var Vd=!1;function Ql(){if(Vd){var n=Po;if(n!==null)throw n}}function Wl(n,s,o,h){Vd=!1;var g=n.updateQueue;Fa=!1;var b=g.firstBaseUpdate,T=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var q=L,rt=q.next;q.next=null,T===null?b=rt:T.next=rt,T=q;var mt=n.alternate;mt!==null&&(mt=mt.updateQueue,L=mt.lastBaseUpdate,L!==T&&(L===null?mt.firstBaseUpdate=rt:L.next=rt,mt.lastBaseUpdate=q))}if(b!==null){var bt=g.baseState;T=0,mt=rt=q=null,L=b;do{var lt=L.lane&-536870913,ht=lt!==L.lane;if(ht?(ge&lt)===lt:(h&lt)===lt){lt!==0&&lt===Lo&&(Vd=!0),mt!==null&&(mt=mt.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});t:{var Vt=n,Zt=L;lt=s;var je=o;switch(Zt.tag){case 1:if(Vt=Zt.payload,typeof Vt=="function"){bt=Vt.call(je,bt,lt);break t}bt=Vt;break t;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=Zt.payload,lt=typeof Vt=="function"?Vt.call(je,bt,lt):Vt,lt==null)break t;bt=y({},bt,lt);break t;case 2:Fa=!0}}lt=L.callback,lt!==null&&(n.flags|=64,ht&&(n.flags|=8192),ht=g.callbacks,ht===null?g.callbacks=[lt]:ht.push(lt))}else ht={lane:lt,tag:L.tag,payload:L.payload,callback:L.callback,next:null},mt===null?(rt=mt=ht,q=bt):mt=mt.next=ht,T|=lt;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;ht=L,L=ht.next,ht.next=null,g.lastBaseUpdate=ht,g.shared.pending=null}}while(!0);mt===null&&(q=bt),g.baseState=q,g.firstBaseUpdate=rt,g.lastBaseUpdate=mt,b===null&&(g.shared.lanes=0),Va|=T,n.lanes=T,n.memoizedState=bt}}function pg(n,s){if(typeof n!="function")throw Error(i(191,n));n.call(s)}function mg(n,s){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)pg(o[n],s)}var Fo=U(null),Tu=U(0);function gg(n,s){n=aa,ft(Tu,n),ft(Fo,s),aa=n|s.baseLanes}function Kd(){ft(Tu,aa),ft(Fo,Fo.current)}function $d(){aa=Tu.current,J(Fo),J(Tu)}var xi=U(null),Ui=null;function za(n){var s=n.alternate;ft(on,on.current&1),ft(xi,n),Ui===null&&(s===null||Fo.current!==null||s.memoizedState!==null)&&(Ui=n)}function Xd(n){ft(on,on.current),ft(xi,n),Ui===null&&(Ui=n)}function yg(n){n.tag===22?(ft(on,on.current),ft(xi,n),Ui===null&&(Ui=n)):Ha()}function Ha(){ft(on,on.current),ft(xi,xi.current)}function Si(n){J(xi),Ui===n&&(Ui=null),J(on)}var on=U(0);function Ru(n){for(var s=n;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||ep(o)||np(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ws=0,ce=null,Pe=null,pn=null,Mu=!1,Io=!1,Ir=!1,Du=0,Zl=0,Uo=null,gx=0;function tn(){throw Error(i(321))}function Yd(n,s){if(s===null)return!1;for(var o=0;o<s.length&&o<n.length;o++)if(!Kn(n[o],s[o]))return!1;return!0}function Qd(n,s,o,h,g,b){return Ws=b,ce=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,G.H=n===null||n.memoizedState===null?ty:df,Ir=!1,b=o(h,g),Ir=!1,Io&&(b=vg(s,o,h,g)),bg(n),b}function bg(n){G.H=ec;var s=Pe!==null&&Pe.next!==null;if(Ws=0,pn=Pe=ce=null,Mu=!1,Zl=0,Uo=null,s)throw Error(i(300));n===null||mn||(n=n.dependencies,n!==null&&wu(n)&&(mn=!0))}function vg(n,s,o,h){ce=n;var g=0;do{if(Io&&(Uo=null),Zl=0,Io=!1,25<=g)throw Error(i(301));if(g+=1,pn=Pe=null,n.updateQueue!=null){var b=n.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}G.H=ey,b=s(o,h)}while(Io);return b}function yx(){var n=G.H,s=n.useState()[0];return s=typeof s.then=="function"?Jl(s):s,n=n.useState()[0],(Pe!==null?Pe.memoizedState:null)!==n&&(ce.flags|=1024),s}function Wd(){var n=Du!==0;return Du=0,n}function Zd(n,s,o){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~o}function Jd(n){if(Mu){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Mu=!1}Ws=0,pn=Pe=ce=null,Io=!1,Zl=Du=0,Uo=null}function ti(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return pn===null?ce.memoizedState=pn=n:pn=pn.next=n,pn}function ln(){if(Pe===null){var n=ce.alternate;n=n!==null?n.memoizedState:null}else n=Pe.next;var s=pn===null?ce.memoizedState:pn.next;if(s!==null)pn=s,Pe=n;else{if(n===null)throw ce.alternate===null?Error(i(467)):Error(i(310));Pe=n,n={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},pn===null?ce.memoizedState=pn=n:pn=pn.next=n}return pn}function Ou(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Jl(n){var s=Zl;return Zl+=1,Uo===null&&(Uo=[]),n=cg(Uo,n,s),s=ce,(pn===null?s.memoizedState:pn.next)===null&&(s=s.alternate,G.H=s===null||s.memoizedState===null?ty:df),n}function Nu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Jl(n);if(n.$$typeof===k)return Bn(n)}throw Error(i(438,String(n)))}function tf(n){var s=null,o=ce.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=ce.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Ou(),ce.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(n),h=0;h<n;h++)o[h]=Tt;return s.index++,o}function Zs(n,s){return typeof s=="function"?s(n):s}function ku(n){var s=ln();return ef(s,Pe,n)}function ef(n,s,o){var h=n.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=o;var g=n.baseQueue,b=h.pending;if(b!==null){if(g!==null){var T=g.next;g.next=b.next,b.next=T}s.baseQueue=g=b,h.pending=null}if(b=n.baseState,g===null)n.memoizedState=b;else{s=g.next;var L=T=null,q=null,rt=s,mt=!1;do{var bt=rt.lane&-536870913;if(bt!==rt.lane?(ge&bt)===bt:(Ws&bt)===bt){var lt=rt.revertLane;if(lt===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),bt===Lo&&(mt=!0);else if((Ws&lt)===lt){rt=rt.next,lt===Lo&&(mt=!0);continue}else bt={lane:0,revertLane:rt.revertLane,gesture:null,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},q===null?(L=q=bt,T=b):q=q.next=bt,ce.lanes|=lt,Va|=lt;bt=rt.action,Ir&&o(b,bt),b=rt.hasEagerState?rt.eagerState:o(b,bt)}else lt={lane:bt,revertLane:rt.revertLane,gesture:rt.gesture,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},q===null?(L=q=lt,T=b):q=q.next=lt,ce.lanes|=bt,Va|=bt;rt=rt.next}while(rt!==null&&rt!==s);if(q===null?T=b:q.next=L,!Kn(b,n.memoizedState)&&(mn=!0,mt&&(o=Po,o!==null)))throw o;n.memoizedState=b,n.baseState=T,n.baseQueue=q,h.lastRenderedState=b}return g===null&&(h.lanes=0),[n.memoizedState,h.dispatch]}function nf(n){var s=ln(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var h=o.dispatch,g=o.pending,b=s.memoizedState;if(g!==null){o.pending=null;var T=g=g.next;do b=n(b,T.action),T=T.next;while(T!==g);Kn(b,s.memoizedState)||(mn=!0),s.memoizedState=b,s.baseQueue===null&&(s.baseState=b),o.lastRenderedState=b}return[b,h]}function wg(n,s,o){var h=ce,g=ln(),b=ve;if(b){if(o===void 0)throw Error(i(407));o=o()}else o=s();var T=!Kn((Pe||g).memoizedState,o);if(T&&(g.memoizedState=o,mn=!0),g=g.queue,rf(Ag.bind(null,h,g,n),[n]),g.getSnapshot!==s||T||pn!==null&&pn.memoizedState.tag&1){if(h.flags|=2048,zo(9,{destroy:void 0},Sg.bind(null,h,g,o,s),null),Ue===null)throw Error(i(349));b||(Ws&127)!==0||xg(h,s,o)}return o}function xg(n,s,o){n.flags|=16384,n={getSnapshot:s,value:o},s=ce.updateQueue,s===null?(s=Ou(),ce.updateQueue=s,s.stores=[n]):(o=s.stores,o===null?s.stores=[n]:o.push(n))}function Sg(n,s,o,h){s.value=o,s.getSnapshot=h,Eg(s)&&_g(n)}function Ag(n,s,o){return o(function(){Eg(s)&&_g(n)})}function Eg(n){var s=n.getSnapshot;n=n.value;try{var o=s();return!Kn(n,o)}catch{return!0}}function _g(n){var s=De(n,2);s!==null&&ui(s,n,2)}function sf(n){var s=ti();if(typeof n=="function"){var o=n;if(n=o(),Ir){kn(!0);try{o()}finally{kn(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:n},s}function Cg(n,s,o,h){return n.baseState=o,ef(n,Pe,typeof h=="function"?h:Zs)}function bx(n,s,o,h,g){if(Bu(n))throw Error(i(485));if(n=s.action,n!==null){var b={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){b.listeners.push(T)}};G.T!==null?o(!0):b.isTransition=!1,h(b),o=s.pending,o===null?(b.next=s.pending=b,Tg(s,b)):(b.next=o.next,s.pending=o.next=b)}}function Tg(n,s){var o=s.action,h=s.payload,g=n.state;if(s.isTransition){var b=G.T,T={};G.T=T;try{var L=o(g,h),q=G.S;q!==null&&q(T,L),Rg(n,s,L)}catch(rt){af(n,s,rt)}finally{b!==null&&T.types!==null&&(b.types=T.types),G.T=b}}else try{b=o(g,h),Rg(n,s,b)}catch(rt){af(n,s,rt)}}function Rg(n,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){Mg(n,s,h)},function(h){return af(n,s,h)}):Mg(n,s,o)}function Mg(n,s,o){s.status="fulfilled",s.value=o,Dg(s),n.state=o,s=n.pending,s!==null&&(o=s.next,o===s?n.pending=null:(o=o.next,s.next=o,Tg(n,o)))}function af(n,s,o){var h=n.pending;if(n.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,Dg(s),s=s.next;while(s!==h)}n.action=null}function Dg(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function Og(n,s){return s}function Ng(n,s){if(ve){var o=Ue.formState;if(o!==null){t:{var h=ce;if(ve){if(Ve){e:{for(var g=Ve,b=Ii;g.nodeType!==8;){if(!b){g=null;break e}if(g=zi(g.nextSibling),g===null){g=null;break e}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){Ve=zi(g.nextSibling),h=g.data==="F!";break t}}Ba(h)}h=!1}h&&(s=o[0])}}return o=ti(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Og,lastRenderedState:s},o.queue=h,o=Wg.bind(null,ce,h),h.dispatch=o,h=sf(!1),b=hf.bind(null,ce,!1,h.queue),h=ti(),g={state:s,dispatch:null,action:n,pending:null},h.queue=g,o=bx.bind(null,ce,g,b,o),g.dispatch=o,h.memoizedState=n,[s,o,!1]}function kg(n){var s=ln();return Lg(s,Pe,n)}function Lg(n,s,o){if(s=ef(n,s,Og)[0],n=ku(Zs)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Jl(s)}catch(T){throw T===Bo?Au:T}else h=s;s=ln();var g=s.queue,b=g.dispatch;return o!==s.memoizedState&&(ce.flags|=2048,zo(9,{destroy:void 0},vx.bind(null,g,o),null)),[h,b,n]}function vx(n,s){n.action=s}function Pg(n){var s=ln(),o=Pe;if(o!==null)return Lg(s,o,n);ln(),s=s.memoizedState,o=ln();var h=o.queue.dispatch;return o.memoizedState=n,[s,h,!1]}function zo(n,s,o,h){return n={tag:n,create:o,deps:h,inst:s,next:null},s=ce.updateQueue,s===null&&(s=Ou(),ce.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=n.next=n:(h=o.next,o.next=n,n.next=h,s.lastEffect=n),n}function Bg(){return ln().memoizedState}function Lu(n,s,o,h){var g=ti();ce.flags|=n,g.memoizedState=zo(1|s,{destroy:void 0},o,h===void 0?null:h)}function Pu(n,s,o,h){var g=ln();h=h===void 0?null:h;var b=g.memoizedState.inst;Pe!==null&&h!==null&&Yd(h,Pe.memoizedState.deps)?g.memoizedState=zo(s,b,o,h):(ce.flags|=n,g.memoizedState=zo(1|s,b,o,h))}function jg(n,s){Lu(8390656,8,n,s)}function rf(n,s){Pu(2048,8,n,s)}function wx(n){ce.flags|=4;var s=ce.updateQueue;if(s===null)s=Ou(),ce.updateQueue=s,s.events=[n];else{var o=s.events;o===null?s.events=[n]:o.push(n)}}function Fg(n){var s=ln().memoizedState;return wx({ref:s,nextImpl:n}),function(){if((Ee&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function Ig(n,s){return Pu(4,2,n,s)}function Ug(n,s){return Pu(4,4,n,s)}function zg(n,s){if(typeof s=="function"){n=n();var o=s(n);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function Hg(n,s,o){o=o!=null?o.concat([n]):null,Pu(4,4,zg.bind(null,s,n),o)}function of(){}function qg(n,s){var o=ln();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&Yd(s,h[1])?h[0]:(o.memoizedState=[n,s],n)}function Gg(n,s){var o=ln();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&Yd(s,h[1]))return h[0];if(h=n(),Ir){kn(!0);try{n()}finally{kn(!1)}}return o.memoizedState=[h,s],h}function lf(n,s,o){return o===void 0||(Ws&1073741824)!==0&&(ge&261930)===0?n.memoizedState=s:(n.memoizedState=o,n=Vy(),ce.lanes|=n,Va|=n,o)}function Vg(n,s,o,h){return Kn(o,s)?o:Fo.current!==null?(n=lf(n,o,h),Kn(n,s)||(mn=!0),n):(Ws&42)===0||(Ws&1073741824)!==0&&(ge&261930)===0?(mn=!0,n.memoizedState=o):(n=Vy(),ce.lanes|=n,Va|=n,s)}function Kg(n,s,o,h,g){var b=tt.p;tt.p=b!==0&&8>b?b:8;var T=G.T,L={};G.T=L,hf(n,!1,s,o);try{var q=g(),rt=G.S;if(rt!==null&&rt(L,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var mt=mx(q,h);tc(n,s,mt,_i(n))}else tc(n,s,h,_i(n))}catch(bt){tc(n,s,{then:function(){},status:"rejected",reason:bt},_i())}finally{tt.p=b,T!==null&&L.types!==null&&(T.types=L.types),G.T=T}}function xx(){}function cf(n,s,o,h){if(n.tag!==5)throw Error(i(476));var g=$g(n).queue;Kg(n,g,s,vt,o===null?xx:function(){return Xg(n),o(h)})}function $g(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:vt,baseState:vt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:vt},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Zs,lastRenderedState:o},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function Xg(n){var s=$g(n);s.next===null&&(s=n.alternate.memoizedState),tc(n,s.next.queue,{},_i())}function uf(){return Bn(yc)}function Yg(){return ln().memoizedState}function Qg(){return ln().memoizedState}function Sx(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var o=_i();n=Ia(o);var h=Ua(s,n,o);h!==null&&(ui(h,s,o),Yl(h,s,o)),s={cache:Fd()},n.payload=s;return}s=s.return}}function Ax(n,s,o){var h=_i();o={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Bu(n)?Zg(s,o):(o=$n(n,s,o,h),o!==null&&(ui(o,n,h),Jg(o,s,h)))}function Wg(n,s,o){var h=_i();tc(n,s,o,h)}function tc(n,s,o,h){var g={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Bu(n))Zg(s,g);else{var b=n.alternate;if(n.lanes===0&&(b===null||b.lanes===0)&&(b=s.lastRenderedReducer,b!==null))try{var T=s.lastRenderedState,L=b(T,o);if(g.hasEagerState=!0,g.eagerState=L,Kn(L,T))return Le(n,s,g,0),Ue===null&&se(),!1}catch{}if(o=$n(n,s,g,h),o!==null)return ui(o,n,h),Jg(o,s,h),!0}return!1}function hf(n,s,o,h){if(h={lane:2,revertLane:qf(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Bu(n)){if(s)throw Error(i(479))}else s=$n(n,o,h,2),s!==null&&ui(s,n,2)}function Bu(n){var s=n.alternate;return n===ce||s!==null&&s===ce}function Zg(n,s){Io=Mu=!0;var o=n.pending;o===null?s.next=s:(s.next=o.next,o.next=s),n.pending=s}function Jg(n,s,o){if((o&4194048)!==0){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ie(n,o)}}var ec={readContext:Bn,use:Nu,useCallback:tn,useContext:tn,useEffect:tn,useImperativeHandle:tn,useLayoutEffect:tn,useInsertionEffect:tn,useMemo:tn,useReducer:tn,useRef:tn,useState:tn,useDebugValue:tn,useDeferredValue:tn,useTransition:tn,useSyncExternalStore:tn,useId:tn,useHostTransitionStatus:tn,useFormState:tn,useActionState:tn,useOptimistic:tn,useMemoCache:tn,useCacheRefresh:tn};ec.useEffectEvent=tn;var ty={readContext:Bn,use:Nu,useCallback:function(n,s){return ti().memoizedState=[n,s===void 0?null:s],n},useContext:Bn,useEffect:jg,useImperativeHandle:function(n,s,o){o=o!=null?o.concat([n]):null,Lu(4194308,4,zg.bind(null,s,n),o)},useLayoutEffect:function(n,s){return Lu(4194308,4,n,s)},useInsertionEffect:function(n,s){Lu(4,2,n,s)},useMemo:function(n,s){var o=ti();s=s===void 0?null:s;var h=n();if(Ir){kn(!0);try{n()}finally{kn(!1)}}return o.memoizedState=[h,s],h},useReducer:function(n,s,o){var h=ti();if(o!==void 0){var g=o(s);if(Ir){kn(!0);try{o(s)}finally{kn(!1)}}}else g=s;return h.memoizedState=h.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},h.queue=n,n=n.dispatch=Ax.bind(null,ce,n),[h.memoizedState,n]},useRef:function(n){var s=ti();return n={current:n},s.memoizedState=n},useState:function(n){n=sf(n);var s=n.queue,o=Wg.bind(null,ce,s);return s.dispatch=o,[n.memoizedState,o]},useDebugValue:of,useDeferredValue:function(n,s){var o=ti();return lf(o,n,s)},useTransition:function(){var n=sf(!1);return n=Kg.bind(null,ce,n.queue,!0,!1),ti().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,o){var h=ce,g=ti();if(ve){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),Ue===null)throw Error(i(349));(ge&127)!==0||xg(h,s,o)}g.memoizedState=o;var b={value:o,getSnapshot:s};return g.queue=b,jg(Ag.bind(null,h,b,n),[n]),h.flags|=2048,zo(9,{destroy:void 0},Sg.bind(null,h,b,o,s),null),o},useId:function(){var n=ti(),s=Ue.identifierPrefix;if(ve){var o=ys,h=gs;o=(h&~(1<<32-jt(h)-1)).toString(32)+o,s="_"+s+"R_"+o,o=Du++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=gx++,s="_"+s+"r_"+o.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:uf,useFormState:Ng,useActionState:Ng,useOptimistic:function(n){var s=ti();s.memoizedState=s.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=hf.bind(null,ce,!0,o),o.dispatch=s,[n,s]},useMemoCache:tf,useCacheRefresh:function(){return ti().memoizedState=Sx.bind(null,ce)},useEffectEvent:function(n){var s=ti(),o={impl:n};return s.memoizedState=o,function(){if((Ee&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},df={readContext:Bn,use:Nu,useCallback:qg,useContext:Bn,useEffect:rf,useImperativeHandle:Hg,useInsertionEffect:Ig,useLayoutEffect:Ug,useMemo:Gg,useReducer:ku,useRef:Bg,useState:function(){return ku(Zs)},useDebugValue:of,useDeferredValue:function(n,s){var o=ln();return Vg(o,Pe.memoizedState,n,s)},useTransition:function(){var n=ku(Zs)[0],s=ln().memoizedState;return[typeof n=="boolean"?n:Jl(n),s]},useSyncExternalStore:wg,useId:Yg,useHostTransitionStatus:uf,useFormState:kg,useActionState:kg,useOptimistic:function(n,s){var o=ln();return Cg(o,Pe,n,s)},useMemoCache:tf,useCacheRefresh:Qg};df.useEffectEvent=Fg;var ey={readContext:Bn,use:Nu,useCallback:qg,useContext:Bn,useEffect:rf,useImperativeHandle:Hg,useInsertionEffect:Ig,useLayoutEffect:Ug,useMemo:Gg,useReducer:nf,useRef:Bg,useState:function(){return nf(Zs)},useDebugValue:of,useDeferredValue:function(n,s){var o=ln();return Pe===null?lf(o,n,s):Vg(o,Pe.memoizedState,n,s)},useTransition:function(){var n=nf(Zs)[0],s=ln().memoizedState;return[typeof n=="boolean"?n:Jl(n),s]},useSyncExternalStore:wg,useId:Yg,useHostTransitionStatus:uf,useFormState:Pg,useActionState:Pg,useOptimistic:function(n,s){var o=ln();return Pe!==null?Cg(o,Pe,n,s):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:tf,useCacheRefresh:Qg};ey.useEffectEvent=Fg;function ff(n,s,o,h){s=n.memoizedState,o=o(h,s),o=o==null?s:y({},s,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var pf={enqueueSetState:function(n,s,o){n=n._reactInternals;var h=_i(),g=Ia(h);g.payload=s,o!=null&&(g.callback=o),s=Ua(n,g,h),s!==null&&(ui(s,n,h),Yl(s,n,h))},enqueueReplaceState:function(n,s,o){n=n._reactInternals;var h=_i(),g=Ia(h);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=Ua(n,g,h),s!==null&&(ui(s,n,h),Yl(s,n,h))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var o=_i(),h=Ia(o);h.tag=2,s!=null&&(h.callback=s),s=Ua(n,h,o),s!==null&&(ui(s,n,o),Yl(s,n,o))}};function ny(n,s,o,h,g,b,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,b,T):s.prototype&&s.prototype.isPureReactComponent?!m(o,h)||!m(g,b):!0}function iy(n,s,o,h){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==n&&pf.enqueueReplaceState(s,s.state,null)}function Ur(n,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(n=n.defaultProps){o===s&&(o=y({},o));for(var g in n)o[g]===void 0&&(o[g]=n[g])}return o}function sy(n){zt(n)}function ay(n){console.error(n)}function ry(n){zt(n)}function ju(n,s){try{var o=n.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function oy(n,s,o){try{var h=n.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function mf(n,s,o){return o=Ia(o),o.tag=3,o.payload={element:null},o.callback=function(){ju(n,s)},o}function ly(n){return n=Ia(n),n.tag=3,n}function cy(n,s,o,h){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var b=h.value;n.payload=function(){return g(b)},n.callback=function(){oy(s,o,h)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){oy(s,o,h),typeof g!="function"&&(Ka===null?Ka=new Set([this]):Ka.add(this));var L=h.stack;this.componentDidCatch(h.value,{componentStack:L!==null?L:""})})}function Ex(n,s,o,h,g){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&ko(s,o,g,!0),o=xi.current,o!==null){switch(o.tag){case 31:case 13:return Ui===null?Yu():o.alternate===null&&en===0&&(en=3),o.flags&=-257,o.flags|=65536,o.lanes=g,h===Eu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),Uf(n,h,g)),!1;case 22:return o.flags|=65536,h===Eu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),Uf(n,h,g)),!1}throw Error(i(435,o.tag))}return Uf(n,h,g),Yu(),!1}if(ve)return s=xi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==kd&&(n=Error(i(422),{cause:h}),Gl(Bi(n,o)))):(h!==kd&&(s=Error(i(423),{cause:h}),Gl(Bi(s,o))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,h=Bi(h,o),g=mf(n.stateNode,h,g),Gd(n,g),en!==4&&(en=2)),!1;var b=Error(i(520),{cause:h});if(b=Bi(b,o),cc===null?cc=[b]:cc.push(b),en!==4&&(en=2),s===null)return!0;h=Bi(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,n=g&-g,o.lanes|=n,n=mf(o.stateNode,h,n),Gd(o,n),!1;case 1:if(s=o.type,b=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Ka===null||!Ka.has(b))))return o.flags|=65536,g&=-g,o.lanes|=g,g=ly(g),cy(g,n,o,h),Gd(o,g),!1}o=o.return}while(o!==null);return!1}var gf=Error(i(461)),mn=!1;function jn(n,s,o,h){s.child=n===null?fg(s,null,o,h):Fr(s,n.child,o,h)}function uy(n,s,o,h,g){o=o.render;var b=s.ref;if("ref"in h){var T={};for(var L in h)L!=="ref"&&(T[L]=h[L])}else T=h;return Lr(s),h=Qd(n,s,o,T,b,g),L=Wd(),n!==null&&!mn?(Zd(n,s,g),Js(n,s,g)):(ve&&L&&Od(s),s.flags|=1,jn(n,s,h,g),s.child)}function hy(n,s,o,h,g){if(n===null){var b=o.type;return typeof b=="function"&&!Rd(b)&&b.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=b,dy(n,s,b,h,g)):(n=bu(o.type,null,h,s,s.mode,g),n.ref=s.ref,n.return=s,s.child=n)}if(b=n.child,!Ef(n,g)){var T=b.memoizedProps;if(o=o.compare,o=o!==null?o:m,o(T,h)&&n.ref===s.ref)return Js(n,s,g)}return s.flags|=1,n=$s(b,h),n.ref=s.ref,n.return=s,s.child=n}function dy(n,s,o,h,g){if(n!==null){var b=n.memoizedProps;if(m(b,h)&&n.ref===s.ref)if(mn=!1,s.pendingProps=h=b,Ef(n,g))(n.flags&131072)!==0&&(mn=!0);else return s.lanes=n.lanes,Js(n,s,g)}return yf(n,s,o,h,g)}function fy(n,s,o,h){var g=h.children,b=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(b=b!==null?b.baseLanes|o:o,n!==null){for(h=s.child=n.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~b}else h=0,s.child=null;return py(n,s,b,o,h)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&Su(s,b!==null?b.cachePool:null),b!==null?gg(s,b):Kd(),yg(s);else return h=s.lanes=536870912,py(n,s,b!==null?b.baseLanes|o:o,o,h)}else b!==null?(Su(s,b.cachePool),gg(s,b),Ha(),s.memoizedState=null):(n!==null&&Su(s,null),Kd(),Ha());return jn(n,s,g,o),s.child}function nc(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function py(n,s,o,h,g){var b=Ud();return b=b===null?null:{parent:fn._currentValue,pool:b},s.memoizedState={baseLanes:o,cachePool:b},n!==null&&Su(s,null),Kd(),yg(s),n!==null&&ko(n,s,h,!0),s.childLanes=g,null}function Fu(n,s){return s=Uu({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function my(n,s,o){return Fr(s,n.child,null,o),n=Fu(s,s.pendingProps),n.flags|=2,Si(s),s.memoizedState=null,n}function _x(n,s,o){var h=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(ve){if(h.mode==="hidden")return n=Fu(s,h),s.lanes=536870912,nc(null,n);if(Xd(s),(n=Ve)?(n=Tb(n,Ii),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:La!==null?{id:gs,overflow:ys}:null,retryLane:536870912,hydrationErrors:null},o=Zm(n),o.return=s,s.child=o,Pn=s,Ve=null)):n=null,n===null)throw Ba(s);return s.lanes=536870912,null}return Fu(s,h)}var b=n.memoizedState;if(b!==null){var T=b.dehydrated;if(Xd(s),g)if(s.flags&256)s.flags&=-257,s=my(n,s,o);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(i(558));else if(mn||ko(n,s,o,!1),g=(o&n.childLanes)!==0,mn||g){if(h=Ue,h!==null&&(T=sn(h,o),T!==0&&T!==b.retryLane))throw b.retryLane=T,De(n,T),ui(h,n,T),gf;Yu(),s=my(n,s,o)}else n=b.treeContext,Ve=zi(T.nextSibling),Pn=s,ve=!0,Pa=null,Ii=!1,n!==null&&eg(s,n),s=Fu(s,h),s.flags|=4096;return s}return n=$s(n.child,{mode:h.mode,children:h.children}),n.ref=s.ref,s.child=n,n.return=s,n}function Iu(n,s){var o=s.ref;if(o===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(s.flags|=4194816)}}function yf(n,s,o,h,g){return Lr(s),o=Qd(n,s,o,h,void 0,g),h=Wd(),n!==null&&!mn?(Zd(n,s,g),Js(n,s,g)):(ve&&h&&Od(s),s.flags|=1,jn(n,s,o,g),s.child)}function gy(n,s,o,h,g,b){return Lr(s),s.updateQueue=null,o=vg(s,h,o,g),bg(n),h=Wd(),n!==null&&!mn?(Zd(n,s,b),Js(n,s,b)):(ve&&h&&Od(s),s.flags|=1,jn(n,s,o,b),s.child)}function yy(n,s,o,h,g){if(Lr(s),s.stateNode===null){var b=Mo,T=o.contextType;typeof T=="object"&&T!==null&&(b=Bn(T)),b=new o(h,b),s.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=pf,s.stateNode=b,b._reactInternals=s,b=s.stateNode,b.props=h,b.state=s.memoizedState,b.refs={},Hd(s),T=o.contextType,b.context=typeof T=="object"&&T!==null?Bn(T):Mo,b.state=s.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(ff(s,o,T,h),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(T=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),T!==b.state&&pf.enqueueReplaceState(b,b.state,null),Wl(s,h,b,g),Ql(),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(n===null){b=s.stateNode;var L=s.memoizedProps,q=Ur(o,L);b.props=q;var rt=b.context,mt=o.contextType;T=Mo,typeof mt=="object"&&mt!==null&&(T=Bn(mt));var bt=o.getDerivedStateFromProps;mt=typeof bt=="function"||typeof b.getSnapshotBeforeUpdate=="function",L=s.pendingProps!==L,mt||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(L||rt!==T)&&iy(s,b,h,T),Fa=!1;var lt=s.memoizedState;b.state=lt,Wl(s,h,b,g),Ql(),rt=s.memoizedState,L||lt!==rt||Fa?(typeof bt=="function"&&(ff(s,o,bt,h),rt=s.memoizedState),(q=Fa||ny(s,o,q,h,lt,rt,T))?(mt||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=rt),b.props=h,b.state=rt,b.context=T,h=q):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{b=s.stateNode,qd(n,s),T=s.memoizedProps,mt=Ur(o,T),b.props=mt,bt=s.pendingProps,lt=b.context,rt=o.contextType,q=Mo,typeof rt=="object"&&rt!==null&&(q=Bn(rt)),L=o.getDerivedStateFromProps,(rt=typeof L=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(T!==bt||lt!==q)&&iy(s,b,h,q),Fa=!1,lt=s.memoizedState,b.state=lt,Wl(s,h,b,g),Ql();var ht=s.memoizedState;T!==bt||lt!==ht||Fa||n!==null&&n.dependencies!==null&&wu(n.dependencies)?(typeof L=="function"&&(ff(s,o,L,h),ht=s.memoizedState),(mt=Fa||ny(s,o,mt,h,lt,ht,q)||n!==null&&n.dependencies!==null&&wu(n.dependencies))?(rt||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,ht,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,ht,q)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=ht),b.props=h,b.state=ht,b.context=q,h=mt):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),h=!1)}return b=h,Iu(n,s),h=(s.flags&128)!==0,b||h?(b=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:b.render(),s.flags|=1,n!==null&&h?(s.child=Fr(s,n.child,null,g),s.child=Fr(s,null,o,g)):jn(n,s,o,g),s.memoizedState=b.state,n=s.child):n=Js(n,s,g),n}function by(n,s,o,h){return Nr(),s.flags|=256,jn(n,s,o,h),s.child}var bf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function vf(n){return{baseLanes:n,cachePool:og()}}function wf(n,s,o){return n=n!==null?n.childLanes&~o:0,s&&(n|=Ei),n}function vy(n,s,o){var h=s.pendingProps,g=!1,b=(s.flags&128)!==0,T;if((T=b)||(T=n!==null&&n.memoizedState===null?!1:(on.current&2)!==0),T&&(g=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,n===null){if(ve){if(g?za(s):Ha(),(n=Ve)?(n=Tb(n,Ii),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:La!==null?{id:gs,overflow:ys}:null,retryLane:536870912,hydrationErrors:null},o=Zm(n),o.return=s,s.child=o,Pn=s,Ve=null)):n=null,n===null)throw Ba(s);return np(n)?s.lanes=32:s.lanes=536870912,null}var L=h.children;return h=h.fallback,g?(Ha(),g=s.mode,L=Uu({mode:"hidden",children:L},g),h=Or(h,g,o,null),L.return=s,h.return=s,L.sibling=h,s.child=L,h=s.child,h.memoizedState=vf(o),h.childLanes=wf(n,T,o),s.memoizedState=bf,nc(null,h)):(za(s),xf(s,L))}var q=n.memoizedState;if(q!==null&&(L=q.dehydrated,L!==null)){if(b)s.flags&256?(za(s),s.flags&=-257,s=Sf(n,s,o)):s.memoizedState!==null?(Ha(),s.child=n.child,s.flags|=128,s=null):(Ha(),L=h.fallback,g=s.mode,h=Uu({mode:"visible",children:h.children},g),L=Or(L,g,o,null),L.flags|=2,h.return=s,L.return=s,h.sibling=L,s.child=h,Fr(s,n.child,null,o),h=s.child,h.memoizedState=vf(o),h.childLanes=wf(n,T,o),s.memoizedState=bf,s=nc(null,h));else if(za(s),np(L)){if(T=L.nextSibling&&L.nextSibling.dataset,T)var rt=T.dgst;T=rt,h=Error(i(419)),h.stack="",h.digest=T,Gl({value:h,source:null,stack:null}),s=Sf(n,s,o)}else if(mn||ko(n,s,o,!1),T=(o&n.childLanes)!==0,mn||T){if(T=Ue,T!==null&&(h=sn(T,o),h!==0&&h!==q.retryLane))throw q.retryLane=h,De(n,h),ui(T,n,h),gf;ep(L)||Yu(),s=Sf(n,s,o)}else ep(L)?(s.flags|=192,s.child=n.child,s=null):(n=q.treeContext,Ve=zi(L.nextSibling),Pn=s,ve=!0,Pa=null,Ii=!1,n!==null&&eg(s,n),s=xf(s,h.children),s.flags|=4096);return s}return g?(Ha(),L=h.fallback,g=s.mode,q=n.child,rt=q.sibling,h=$s(q,{mode:"hidden",children:h.children}),h.subtreeFlags=q.subtreeFlags&65011712,rt!==null?L=$s(rt,L):(L=Or(L,g,o,null),L.flags|=2),L.return=s,h.return=s,h.sibling=L,s.child=h,nc(null,h),h=s.child,L=n.child.memoizedState,L===null?L=vf(o):(g=L.cachePool,g!==null?(q=fn._currentValue,g=g.parent!==q?{parent:q,pool:q}:g):g=og(),L={baseLanes:L.baseLanes|o,cachePool:g}),h.memoizedState=L,h.childLanes=wf(n,T,o),s.memoizedState=bf,nc(n.child,h)):(za(s),o=n.child,n=o.sibling,o=$s(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,n!==null&&(T=s.deletions,T===null?(s.deletions=[n],s.flags|=16):T.push(n)),s.child=o,s.memoizedState=null,o)}function xf(n,s){return s=Uu({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function Uu(n,s){return n=wi(22,n,null,s),n.lanes=0,n}function Sf(n,s,o){return Fr(s,n.child,null,o),n=xf(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function wy(n,s,o){n.lanes|=s;var h=n.alternate;h!==null&&(h.lanes|=s),Bd(n.return,s,o)}function Af(n,s,o,h,g,b){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g,treeForkCount:b}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=h,T.tail=o,T.tailMode=g,T.treeForkCount=b)}function xy(n,s,o){var h=s.pendingProps,g=h.revealOrder,b=h.tail;h=h.children;var T=on.current,L=(T&2)!==0;if(L?(T=T&1|2,s.flags|=128):T&=1,ft(on,T),jn(n,s,h,o),h=ve?ql:0,!L&&n!==null&&(n.flags&128)!==0)t:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&wy(n,o,s);else if(n.tag===19)wy(n,o,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break t;for(;n.sibling===null;){if(n.return===null||n.return===s)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)n=o.alternate,n!==null&&Ru(n)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),Af(s,!1,g,o,b,h);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(n=g.alternate,n!==null&&Ru(n)===null){s.child=g;break}n=g.sibling,g.sibling=o,o=g,g=n}Af(s,!0,o,null,b,h);break;case"together":Af(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function Js(n,s,o){if(n!==null&&(s.dependencies=n.dependencies),Va|=s.lanes,(o&s.childLanes)===0)if(n!==null){if(ko(n,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(i(153));if(s.child!==null){for(n=s.child,o=$s(n,n.pendingProps),s.child=o,o.return=s;n.sibling!==null;)n=n.sibling,o=o.sibling=$s(n,n.pendingProps),o.return=s;o.sibling=null}return s.child}function Ef(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&wu(n)))}function Cx(n,s,o){switch(s.tag){case 3:re(s,s.stateNode.containerInfo),ja(s,fn,n.memoizedState.cache),Nr();break;case 27:case 5:kt(s);break;case 4:re(s,s.stateNode.containerInfo);break;case 10:ja(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Xd(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(za(s),s.flags|=128,null):(o&s.child.childLanes)!==0?vy(n,s,o):(za(s),n=Js(n,s,o),n!==null?n.sibling:null);za(s);break;case 19:var g=(n.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(ko(n,s,o,!1),h=(o&s.childLanes)!==0),g){if(h)return xy(n,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ft(on,on.current),h)break;return null;case 22:return s.lanes=0,fy(n,s,o,s.pendingProps);case 24:ja(s,fn,n.memoizedState.cache)}return Js(n,s,o)}function Sy(n,s,o){if(n!==null)if(n.memoizedProps!==s.pendingProps)mn=!0;else{if(!Ef(n,o)&&(s.flags&128)===0)return mn=!1,Cx(n,s,o);mn=(n.flags&131072)!==0}else mn=!1,ve&&(s.flags&1048576)!==0&&tg(s,ql,s.index);switch(s.lanes=0,s.tag){case 16:t:{var h=s.pendingProps;if(n=Br(s.elementType),s.type=n,typeof n=="function")Rd(n)?(h=Ur(n,h),s.tag=1,s=yy(null,s,n,h,o)):(s.tag=0,s=yf(null,s,n,h,o));else{if(n!=null){var g=n.$$typeof;if(g===j){s.tag=11,s=uy(null,s,n,h,o);break t}else if(g===H){s.tag=14,s=hy(null,s,n,h,o);break t}}throw s=Rt(n)||n,Error(i(306,s,""))}}return s;case 0:return yf(n,s,s.type,s.pendingProps,o);case 1:return h=s.type,g=Ur(h,s.pendingProps),yy(n,s,h,g,o);case 3:t:{if(re(s,s.stateNode.containerInfo),n===null)throw Error(i(387));h=s.pendingProps;var b=s.memoizedState;g=b.element,qd(n,s),Wl(s,h,null,o);var T=s.memoizedState;if(h=T.cache,ja(s,fn,h),h!==b.cache&&jd(s,[fn],o,!0),Ql(),h=T.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=b,s.memoizedState=b,s.flags&256){s=by(n,s,h,o);break t}else if(h!==g){g=Bi(Error(i(424)),s),Gl(g),s=by(n,s,h,o);break t}else for(n=s.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Ve=zi(n.firstChild),Pn=s,ve=!0,Pa=null,Ii=!0,o=fg(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Nr(),h===g){s=Js(n,s,o);break t}jn(n,s,h,o)}s=s.child}return s;case 26:return Iu(n,s),n===null?(o=kb(s.type,null,s.pendingProps,null))?s.memoizedState=o:ve||(o=s.type,n=s.pendingProps,h=nh(Ft.current).createElement(o),h[ze]=s,h[an]=n,Fn(h,o,n),rn(h),s.stateNode=h):s.memoizedState=kb(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return kt(s),n===null&&ve&&(h=s.stateNode=Db(s.type,s.pendingProps,Ft.current),Pn=s,Ii=!0,g=Ve,Qa(s.type)?(ip=g,Ve=zi(h.firstChild)):Ve=g),jn(n,s,s.pendingProps.children,o),Iu(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&ve&&((g=h=Ve)&&(h=n1(h,s.type,s.pendingProps,Ii),h!==null?(s.stateNode=h,Pn=s,Ve=zi(h.firstChild),Ii=!1,g=!0):g=!1),g||Ba(s)),kt(s),g=s.type,b=s.pendingProps,T=n!==null?n.memoizedProps:null,h=b.children,Zf(g,b)?h=null:T!==null&&Zf(g,T)&&(s.flags|=32),s.memoizedState!==null&&(g=Qd(n,s,yx,null,null,o),yc._currentValue=g),Iu(n,s),jn(n,s,h,o),s.child;case 6:return n===null&&ve&&((n=o=Ve)&&(o=i1(o,s.pendingProps,Ii),o!==null?(s.stateNode=o,Pn=s,Ve=null,n=!0):n=!1),n||Ba(s)),null;case 13:return vy(n,s,o);case 4:return re(s,s.stateNode.containerInfo),h=s.pendingProps,n===null?s.child=Fr(s,null,h,o):jn(n,s,h,o),s.child;case 11:return uy(n,s,s.type,s.pendingProps,o);case 7:return jn(n,s,s.pendingProps,o),s.child;case 8:return jn(n,s,s.pendingProps.children,o),s.child;case 12:return jn(n,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,ja(s,s.type,h.value),jn(n,s,h.children,o),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,Lr(s),g=Bn(g),h=h(g),s.flags|=1,jn(n,s,h,o),s.child;case 14:return hy(n,s,s.type,s.pendingProps,o);case 15:return dy(n,s,s.type,s.pendingProps,o);case 19:return xy(n,s,o);case 31:return _x(n,s,o);case 22:return fy(n,s,o,s.pendingProps);case 24:return Lr(s),h=Bn(fn),n===null?(g=Ud(),g===null&&(g=Ue,b=Fd(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=o),g=b),s.memoizedState={parent:h,cache:g},Hd(s),ja(s,fn,g)):((n.lanes&o)!==0&&(qd(n,s),Wl(s,null,null,o),Ql()),g=n.memoizedState,b=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),ja(s,fn,h)):(h=b.cache,ja(s,fn,h),h!==g.cache&&jd(s,[fn],o,!0))),jn(n,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function ta(n){n.flags|=4}function _f(n,s,o,h,g){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if(Yy())n.flags|=8192;else throw jr=Eu,zd}else n.flags&=-16777217}function Ay(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Fb(s))if(Yy())n.flags|=8192;else throw jr=Eu,zd}function zu(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?iu():536870912,n.lanes|=s,Vo|=s)}function ic(n,s){if(!ve)switch(n.tailMode){case"hidden":s=n.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function Ke(n){var s=n.alternate!==null&&n.alternate.child===n.child,o=0,h=0;if(s)for(var g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=h,n.childLanes=o,s}function Tx(n,s,o){var h=s.pendingProps;switch(Nd(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ke(s),null;case 1:return Ke(s),null;case 3:return o=s.stateNode,h=null,n!==null&&(h=n.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),Qs(fn),Kt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(No(s)?ta(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Ld())),Ke(s),null;case 26:var g=s.type,b=s.memoizedState;return n===null?(ta(s),b!==null?(Ke(s),Ay(s,b)):(Ke(s),_f(s,g,null,h,o))):b?b!==n.memoizedState?(ta(s),Ke(s),Ay(s,b)):(Ke(s),s.flags&=-16777217):(n=n.memoizedProps,n!==h&&ta(s),Ke(s),_f(s,g,n,h,o)),null;case 27:if(He(s),o=Ft.current,g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&ta(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Ke(s),null}n=wt.current,No(s)?ng(s):(n=Db(g,h,o),s.stateNode=n,ta(s))}return Ke(s),null;case 5:if(He(s),g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&ta(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Ke(s),null}if(b=wt.current,No(s))ng(s);else{var T=nh(Ft.current);switch(b){case 1:b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":b=T.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof h.is=="string"?T.createElement("select",{is:h.is}):T.createElement("select"),h.multiple?b.multiple=!0:h.size&&(b.size=h.size);break;default:b=typeof h.is=="string"?T.createElement(g,{is:h.is}):T.createElement(g)}}b[ze]=s,b[an]=h;t:for(T=s.child;T!==null;){if(T.tag===5||T.tag===6)b.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===s)break t;for(;T.sibling===null;){if(T.return===null||T.return===s)break t;T=T.return}T.sibling.return=T.return,T=T.sibling}s.stateNode=b;t:switch(Fn(b,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&ta(s)}}return Ke(s),_f(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,o),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==h&&ta(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(i(166));if(n=Ft.current,No(s)){if(n=s.stateNode,o=s.memoizedProps,h=null,g=Pn,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}n[ze]=s,n=!!(n.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||vb(n.nodeValue,o)),n||Ba(s,!0)}else n=nh(n).createTextNode(h),n[ze]=s,s.stateNode=n}return Ke(s),null;case 31:if(o=s.memoizedState,n===null||n.memoizedState!==null){if(h=No(s),o!==null){if(n===null){if(!h)throw Error(i(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[ze]=s}else Nr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ke(s),n=!1}else o=Ld(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return s.flags&256?(Si(s),s):(Si(s),null);if((s.flags&128)!==0)throw Error(i(558))}return Ke(s),null;case 13:if(h=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=No(s),h!==null&&h.dehydrated!==null){if(n===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[ze]=s}else Nr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ke(s),g=!1}else g=Ld(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Si(s),s):(Si(s),null)}return Si(s),(s.flags&128)!==0?(s.lanes=o,s):(o=h!==null,n=n!==null&&n.memoizedState!==null,o&&(h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),b=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==g&&(h.flags|=2048)),o!==n&&o&&(s.child.flags|=8192),zu(s,s.updateQueue),Ke(s),null);case 4:return Kt(),n===null&&$f(s.stateNode.containerInfo),Ke(s),null;case 10:return Qs(s.type),Ke(s),null;case 19:if(J(on),h=s.memoizedState,h===null)return Ke(s),null;if(g=(s.flags&128)!==0,b=h.rendering,b===null)if(g)ic(h,!1);else{if(en!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(b=Ru(n),b!==null){for(s.flags|=128,ic(h,!1),n=b.updateQueue,s.updateQueue=n,zu(s,n),s.subtreeFlags=0,n=o,o=s.child;o!==null;)Wm(o,n),o=o.sibling;return ft(on,on.current&1|2),ve&&Xs(s,h.treeForkCount),s.child}n=n.sibling}h.tail!==null&&Hn()>Ku&&(s.flags|=128,g=!0,ic(h,!1),s.lanes=4194304)}else{if(!g)if(n=Ru(b),n!==null){if(s.flags|=128,g=!0,n=n.updateQueue,s.updateQueue=n,zu(s,n),ic(h,!0),h.tail===null&&h.tailMode==="hidden"&&!b.alternate&&!ve)return Ke(s),null}else 2*Hn()-h.renderingStartTime>Ku&&o!==536870912&&(s.flags|=128,g=!0,ic(h,!1),s.lanes=4194304);h.isBackwards?(b.sibling=s.child,s.child=b):(n=h.last,n!==null?n.sibling=b:s.child=b,h.last=b)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=Hn(),n.sibling=null,o=on.current,ft(on,g?o&1|2:o&1),ve&&Xs(s,h.treeForkCount),n):(Ke(s),null);case 22:case 23:return Si(s),$d(),h=s.memoizedState!==null,n!==null?n.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&(Ke(s),s.subtreeFlags&6&&(s.flags|=8192)):Ke(s),o=s.updateQueue,o!==null&&zu(s,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),n!==null&&J(Pr),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Qs(fn),Ke(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function Rx(n,s){switch(Nd(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return Qs(fn),Kt(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return He(s),null;case 31:if(s.memoizedState!==null){if(Si(s),s.alternate===null)throw Error(i(340));Nr()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(Si(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Nr()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return J(on),null;case 4:return Kt(),null;case 10:return Qs(s.type),null;case 22:case 23:return Si(s),$d(),n!==null&&J(Pr),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return Qs(fn),null;case 25:return null;default:return null}}function Ey(n,s){switch(Nd(s),s.tag){case 3:Qs(fn),Kt();break;case 26:case 27:case 5:He(s);break;case 4:Kt();break;case 31:s.memoizedState!==null&&Si(s);break;case 13:Si(s);break;case 19:J(on);break;case 10:Qs(s.type);break;case 22:case 23:Si(s),$d(),n!==null&&J(Pr);break;case 24:Qs(fn)}}function sc(n,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var g=h.next;o=g;do{if((o.tag&n)===n){h=void 0;var b=o.create,T=o.inst;h=b(),T.destroy=h}o=o.next}while(o!==g)}}catch(L){Ne(s,s.return,L)}}function qa(n,s,o){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var b=g.next;h=b;do{if((h.tag&n)===n){var T=h.inst,L=T.destroy;if(L!==void 0){T.destroy=void 0,g=s;var q=o,rt=L;try{rt()}catch(mt){Ne(g,q,mt)}}}h=h.next}while(h!==b)}}catch(mt){Ne(s,s.return,mt)}}function _y(n){var s=n.updateQueue;if(s!==null){var o=n.stateNode;try{mg(s,o)}catch(h){Ne(n,n.return,h)}}}function Cy(n,s,o){o.props=Ur(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(h){Ne(n,s,h)}}function ac(n,s){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var h=n.stateNode;break;case 30:h=n.stateNode;break;default:h=n.stateNode}typeof o=="function"?n.refCleanup=o(h):o.current=h}}catch(g){Ne(n,s,g)}}function bs(n,s){var o=n.ref,h=n.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(g){Ne(n,s,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Ne(n,s,g)}else o.current=null}function Ty(n){var s=n.type,o=n.memoizedProps,h=n.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break t;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(g){Ne(n,n.return,g)}}function Cf(n,s,o){try{var h=n.stateNode;Qx(h,n.type,o,s),h[an]=s}catch(g){Ne(n,n.return,g)}}function Ry(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Qa(n.type)||n.tag===4}function Tf(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Ry(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Qa(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Rf(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(n),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=ai));else if(h!==4&&(h===27&&Qa(n.type)&&(o=n.stateNode,s=null),n=n.child,n!==null))for(Rf(n,s,o),n=n.sibling;n!==null;)Rf(n,s,o),n=n.sibling}function Hu(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?o.insertBefore(n,s):o.appendChild(n);else if(h!==4&&(h===27&&Qa(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Hu(n,s,o),n=n.sibling;n!==null;)Hu(n,s,o),n=n.sibling}function My(n){var s=n.stateNode,o=n.memoizedProps;try{for(var h=n.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Fn(s,h,o),s[ze]=n,s[an]=o}catch(b){Ne(n,n.return,b)}}var ea=!1,gn=!1,Mf=!1,Dy=typeof WeakSet=="function"?WeakSet:Set,Rn=null;function Mx(n,s){if(n=n.containerInfo,Qf=ch,n=R(n),O(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else t:{o=(o=n.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break t}var T=0,L=-1,q=-1,rt=0,mt=0,bt=n,lt=null;e:for(;;){for(var ht;bt!==o||g!==0&&bt.nodeType!==3||(L=T+g),bt!==b||h!==0&&bt.nodeType!==3||(q=T+h),bt.nodeType===3&&(T+=bt.nodeValue.length),(ht=bt.firstChild)!==null;)lt=bt,bt=ht;for(;;){if(bt===n)break e;if(lt===o&&++rt===g&&(L=T),lt===b&&++mt===h&&(q=T),(ht=bt.nextSibling)!==null)break;bt=lt,lt=bt.parentNode}bt=ht}o=L===-1||q===-1?null:{start:L,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(Wf={focusedElem:n,selectionRange:o},ch=!1,Rn=s;Rn!==null;)if(s=Rn,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Rn=n;else for(;Rn!==null;){switch(s=Rn,b=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)g=n[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&b!==null){n=void 0,o=s,g=b.memoizedProps,b=b.memoizedState,h=o.stateNode;try{var Vt=Ur(o.type,g);n=h.getSnapshotBeforeUpdate(Vt,b),h.__reactInternalSnapshotBeforeUpdate=n}catch(Zt){Ne(o,o.return,Zt)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,o=n.nodeType,o===9)tp(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":tp(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=s.sibling,n!==null){n.return=s.return,Rn=n;break}Rn=s.return}}function Oy(n,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:ia(n,o),h&4&&sc(5,o);break;case 1:if(ia(n,o),h&4)if(n=o.stateNode,s===null)try{n.componentDidMount()}catch(T){Ne(o,o.return,T)}else{var g=Ur(o.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(g,s,n.__reactInternalSnapshotBeforeUpdate)}catch(T){Ne(o,o.return,T)}}h&64&&_y(o),h&512&&ac(o,o.return);break;case 3:if(ia(n,o),h&64&&(n=o.updateQueue,n!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{mg(n,s)}catch(T){Ne(o,o.return,T)}}break;case 27:s===null&&h&4&&My(o);case 26:case 5:ia(n,o),s===null&&h&4&&Ty(o),h&512&&ac(o,o.return);break;case 12:ia(n,o);break;case 31:ia(n,o),h&4&&Ly(n,o);break;case 13:ia(n,o),h&4&&Py(n,o),h&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=Fx.bind(null,o),s1(n,o))));break;case 22:if(h=o.memoizedState!==null||ea,!h){s=s!==null&&s.memoizedState!==null||gn,g=ea;var b=gn;ea=h,(gn=s)&&!b?sa(n,o,(o.subtreeFlags&8772)!==0):ia(n,o),ea=g,gn=b}break;case 30:break;default:ia(n,o)}}function Ny(n){var s=n.alternate;s!==null&&(n.alternate=null,Ny(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&lo(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var $e=null,ri=!1;function na(n,s,o){for(o=o.child;o!==null;)ky(n,s,o),o=o.sibling}function ky(n,s,o){if(Nn&&typeof Nn.onCommitFiberUnmount=="function")try{Nn.onCommitFiberUnmount(as,o)}catch{}switch(o.tag){case 26:gn||bs(o,s),na(n,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:gn||bs(o,s);var h=$e,g=ri;Qa(o.type)&&($e=o.stateNode,ri=!1),na(n,s,o),pc(o.stateNode),$e=h,ri=g;break;case 5:gn||bs(o,s);case 6:if(h=$e,g=ri,$e=null,na(n,s,o),$e=h,ri=g,$e!==null)if(ri)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(o.stateNode)}catch(b){Ne(o,s,b)}else try{$e.removeChild(o.stateNode)}catch(b){Ne(o,s,b)}break;case 18:$e!==null&&(ri?(n=$e,_b(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Jo(n)):_b($e,o.stateNode));break;case 4:h=$e,g=ri,$e=o.stateNode.containerInfo,ri=!0,na(n,s,o),$e=h,ri=g;break;case 0:case 11:case 14:case 15:qa(2,o,s),gn||qa(4,o,s),na(n,s,o);break;case 1:gn||(bs(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&Cy(o,s,h)),na(n,s,o);break;case 21:na(n,s,o);break;case 22:gn=(h=gn)||o.memoizedState!==null,na(n,s,o),gn=h;break;default:na(n,s,o)}}function Ly(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Jo(n)}catch(o){Ne(s,s.return,o)}}}function Py(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Jo(n)}catch(o){Ne(s,s.return,o)}}function Dx(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new Dy),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new Dy),s;default:throw Error(i(435,n.tag))}}function qu(n,s){var o=Dx(n);s.forEach(function(h){if(!o.has(h)){o.add(h);var g=Ix.bind(null,n,h);h.then(g,g)}})}function oi(n,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h],b=n,T=s,L=T;t:for(;L!==null;){switch(L.tag){case 27:if(Qa(L.type)){$e=L.stateNode,ri=!1;break t}break;case 5:$e=L.stateNode,ri=!1;break t;case 3:case 4:$e=L.stateNode.containerInfo,ri=!0;break t}L=L.return}if($e===null)throw Error(i(160));ky(b,T,g),$e=null,ri=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)By(s,n),s=s.sibling}var Zi=null;function By(n,s){var o=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:oi(s,n),li(n),h&4&&(qa(3,n,n.return),sc(3,n),qa(5,n,n.return));break;case 1:oi(s,n),li(n),h&512&&(gn||o===null||bs(o,o.return)),h&64&&ea&&(n=n.updateQueue,n!==null&&(h=n.callbacks,h!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var g=Zi;if(oi(s,n),li(n),h&512&&(gn||o===null||bs(o,o.return)),h&4){var b=o!==null?o.memoizedState:null;if(h=n.memoizedState,o===null)if(h===null)if(n.stateNode===null){t:{h=n.type,o=n.memoizedProps,g=g.ownerDocument||g;e:switch(h){case"title":b=g.getElementsByTagName("title")[0],(!b||b[yi]||b[ze]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(h),g.head.insertBefore(b,g.querySelector("head > title"))),Fn(b,h,o),b[ze]=n,rn(b),h=b;break t;case"link":var T=Bb("link","href",g).get(h+(o.href||""));if(T){for(var L=0;L<T.length;L++)if(b=T[L],b.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&b.getAttribute("rel")===(o.rel==null?null:o.rel)&&b.getAttribute("title")===(o.title==null?null:o.title)&&b.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(L,1);break e}}b=g.createElement(h),Fn(b,h,o),g.head.appendChild(b);break;case"meta":if(T=Bb("meta","content",g).get(h+(o.content||""))){for(L=0;L<T.length;L++)if(b=T[L],b.getAttribute("content")===(o.content==null?null:""+o.content)&&b.getAttribute("name")===(o.name==null?null:o.name)&&b.getAttribute("property")===(o.property==null?null:o.property)&&b.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&b.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(L,1);break e}}b=g.createElement(h),Fn(b,h,o),g.head.appendChild(b);break;default:throw Error(i(468,h))}b[ze]=n,rn(b),h=b}n.stateNode=h}else jb(g,n.type,n.stateNode);else n.stateNode=Pb(g,h,n.memoizedProps);else b!==h?(b===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):b.count--,h===null?jb(g,n.type,n.stateNode):Pb(g,h,n.memoizedProps)):h===null&&n.stateNode!==null&&Cf(n,n.memoizedProps,o.memoizedProps)}break;case 27:oi(s,n),li(n),h&512&&(gn||o===null||bs(o,o.return)),o!==null&&h&4&&Cf(n,n.memoizedProps,o.memoizedProps);break;case 5:if(oi(s,n),li(n),h&512&&(gn||o===null||bs(o,o.return)),n.flags&32){g=n.stateNode;try{js(g,"")}catch(Vt){Ne(n,n.return,Vt)}}h&4&&n.stateNode!=null&&(g=n.memoizedProps,Cf(n,g,o!==null?o.memoizedProps:g)),h&1024&&(Mf=!0);break;case 6:if(oi(s,n),li(n),h&4){if(n.stateNode===null)throw Error(i(162));h=n.memoizedProps,o=n.stateNode;try{o.nodeValue=h}catch(Vt){Ne(n,n.return,Vt)}}break;case 3:if(ah=null,g=Zi,Zi=ih(s.containerInfo),oi(s,n),Zi=g,li(n),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Jo(s.containerInfo)}catch(Vt){Ne(n,n.return,Vt)}Mf&&(Mf=!1,jy(n));break;case 4:h=Zi,Zi=ih(n.stateNode.containerInfo),oi(s,n),li(n),Zi=h;break;case 12:oi(s,n),li(n);break;case 31:oi(s,n),li(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,qu(n,h)));break;case 13:oi(s,n),li(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Vu=Hn()),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,qu(n,h)));break;case 22:g=n.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,rt=ea,mt=gn;if(ea=rt||g,gn=mt||q,oi(s,n),gn=mt,ea=rt,li(n),h&8192)t:for(s=n.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||q||ea||gn||zr(n)),o=null,s=n;;){if(s.tag===5||s.tag===26){if(o===null){q=o=s;try{if(b=q.stateNode,g)T=b.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{L=q.stateNode;var bt=q.memoizedProps.style,lt=bt!=null&&bt.hasOwnProperty("display")?bt.display:null;L.style.display=lt==null||typeof lt=="boolean"?"":(""+lt).trim()}}catch(Vt){Ne(q,q.return,Vt)}}}else if(s.tag===6){if(o===null){q=s;try{q.stateNode.nodeValue=g?"":q.memoizedProps}catch(Vt){Ne(q,q.return,Vt)}}}else if(s.tag===18){if(o===null){q=s;try{var ht=q.stateNode;g?Cb(ht,!0):Cb(q.stateNode,!1)}catch(Vt){Ne(q,q.return,Vt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break t;for(;s.sibling===null;){if(s.return===null||s.return===n)break t;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=n.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,qu(n,o))));break;case 19:oi(s,n),li(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,qu(n,h)));break;case 30:break;case 21:break;default:oi(s,n),li(n)}}function li(n){var s=n.flags;if(s&2){try{for(var o,h=n.return;h!==null;){if(Ry(h)){o=h;break}h=h.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,b=Tf(n);Hu(n,b,g);break;case 5:var T=o.stateNode;o.flags&32&&(js(T,""),o.flags&=-33);var L=Tf(n);Hu(n,L,T);break;case 3:case 4:var q=o.stateNode.containerInfo,rt=Tf(n);Rf(n,rt,q);break;default:throw Error(i(161))}}catch(mt){Ne(n,n.return,mt)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function jy(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;jy(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function ia(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Oy(n,s.alternate,s),s=s.sibling}function zr(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:qa(4,s,s.return),zr(s);break;case 1:bs(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&Cy(s,s.return,o),zr(s);break;case 27:pc(s.stateNode);case 26:case 5:bs(s,s.return),zr(s);break;case 22:s.memoizedState===null&&zr(s);break;case 30:zr(s);break;default:zr(s)}n=n.sibling}}function sa(n,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=n,b=s,T=b.flags;switch(b.tag){case 0:case 11:case 15:sa(g,b,o),sc(4,b);break;case 1:if(sa(g,b,o),h=b,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(rt){Ne(h,h.return,rt)}if(h=b,g=h.updateQueue,g!==null){var L=h.stateNode;try{var q=g.shared.hiddenCallbacks;if(q!==null)for(g.shared.hiddenCallbacks=null,g=0;g<q.length;g++)pg(q[g],L)}catch(rt){Ne(h,h.return,rt)}}o&&T&64&&_y(b),ac(b,b.return);break;case 27:My(b);case 26:case 5:sa(g,b,o),o&&h===null&&T&4&&Ty(b),ac(b,b.return);break;case 12:sa(g,b,o);break;case 31:sa(g,b,o),o&&T&4&&Ly(g,b);break;case 13:sa(g,b,o),o&&T&4&&Py(g,b);break;case 22:b.memoizedState===null&&sa(g,b,o),ac(b,b.return);break;case 30:break;default:sa(g,b,o)}s=s.sibling}}function Df(n,s){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Vl(o))}function Of(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Vl(n))}function Ji(n,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Fy(n,s,o,h),s=s.sibling}function Fy(n,s,o,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:Ji(n,s,o,h),g&2048&&sc(9,s);break;case 1:Ji(n,s,o,h);break;case 3:Ji(n,s,o,h),g&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Vl(n)));break;case 12:if(g&2048){Ji(n,s,o,h),n=s.stateNode;try{var b=s.memoizedProps,T=b.id,L=b.onPostCommit;typeof L=="function"&&L(T,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(q){Ne(s,s.return,q)}}else Ji(n,s,o,h);break;case 31:Ji(n,s,o,h);break;case 13:Ji(n,s,o,h);break;case 23:break;case 22:b=s.stateNode,T=s.alternate,s.memoizedState!==null?b._visibility&2?Ji(n,s,o,h):rc(n,s):b._visibility&2?Ji(n,s,o,h):(b._visibility|=2,Ho(n,s,o,h,(s.subtreeFlags&10256)!==0||!1)),g&2048&&Df(T,s);break;case 24:Ji(n,s,o,h),g&2048&&Of(s.alternate,s);break;default:Ji(n,s,o,h)}}function Ho(n,s,o,h,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var b=n,T=s,L=o,q=h,rt=T.flags;switch(T.tag){case 0:case 11:case 15:Ho(b,T,L,q,g),sc(8,T);break;case 23:break;case 22:var mt=T.stateNode;T.memoizedState!==null?mt._visibility&2?Ho(b,T,L,q,g):rc(b,T):(mt._visibility|=2,Ho(b,T,L,q,g)),g&&rt&2048&&Df(T.alternate,T);break;case 24:Ho(b,T,L,q,g),g&&rt&2048&&Of(T.alternate,T);break;default:Ho(b,T,L,q,g)}s=s.sibling}}function rc(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=n,h=s,g=h.flags;switch(h.tag){case 22:rc(o,h),g&2048&&Df(h.alternate,h);break;case 24:rc(o,h),g&2048&&Of(h.alternate,h);break;default:rc(o,h)}s=s.sibling}}var oc=8192;function qo(n,s,o){if(n.subtreeFlags&oc)for(n=n.child;n!==null;)Iy(n,s,o),n=n.sibling}function Iy(n,s,o){switch(n.tag){case 26:qo(n,s,o),n.flags&oc&&n.memoizedState!==null&&g1(o,Zi,n.memoizedState,n.memoizedProps);break;case 5:qo(n,s,o);break;case 3:case 4:var h=Zi;Zi=ih(n.stateNode.containerInfo),qo(n,s,o),Zi=h;break;case 22:n.memoizedState===null&&(h=n.alternate,h!==null&&h.memoizedState!==null?(h=oc,oc=16777216,qo(n,s,o),oc=h):qo(n,s,o));break;default:qo(n,s,o)}}function Uy(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function lc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Rn=h,Hy(h,n)}Uy(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)zy(n),n=n.sibling}function zy(n){switch(n.tag){case 0:case 11:case 15:lc(n),n.flags&2048&&qa(9,n,n.return);break;case 3:lc(n);break;case 12:lc(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,Gu(n)):lc(n);break;default:lc(n)}}function Gu(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Rn=h,Hy(h,n)}Uy(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:qa(8,s,s.return),Gu(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Gu(s));break;default:Gu(s)}n=n.sibling}}function Hy(n,s){for(;Rn!==null;){var o=Rn;switch(o.tag){case 0:case 11:case 15:qa(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Vl(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Rn=h;else t:for(o=n;Rn!==null;){h=Rn;var g=h.sibling,b=h.return;if(Ny(h),h===o){Rn=null;break t}if(g!==null){g.return=b,Rn=g;break t}Rn=b}}}var Ox={getCacheForType:function(n){var s=Bn(fn),o=s.data.get(n);return o===void 0&&(o=n(),s.data.set(n,o)),o},cacheSignal:function(){return Bn(fn).controller.signal}},Nx=typeof WeakMap=="function"?WeakMap:Map,Ee=0,Ue=null,pe=null,ge=0,Oe=0,Ai=null,Ga=!1,Go=!1,Nf=!1,aa=0,en=0,Va=0,Hr=0,kf=0,Ei=0,Vo=0,cc=null,ci=null,Lf=!1,Vu=0,qy=0,Ku=1/0,$u=null,Ka=null,vn=0,$a=null,Ko=null,ra=0,Pf=0,Bf=null,Gy=null,uc=0,jf=null;function _i(){return(Ee&2)!==0&&ge!==0?ge&-ge:G.T!==null?qf():gr()}function Vy(){if(Ei===0)if((ge&536870912)===0||ve){var n=wa;wa<<=1,(wa&3932160)===0&&(wa=262144),Ei=n}else Ei=536870912;return n=xi.current,n!==null&&(n.flags|=32),Ei}function ui(n,s,o){(n===Ue&&(Oe===2||Oe===9)||n.cancelPendingCommit!==null)&&($o(n,0),Xa(n,ge,Ei,!1)),Oi(n,o),((Ee&2)===0||n!==Ue)&&(n===Ue&&((Ee&2)===0&&(Hr|=o),en===4&&Xa(n,ge,Ei,!1)),vs(n))}function Ky(n,s,o){if((Ee&6)!==0)throw Error(i(327));var h=!o&&(s&127)===0&&(s&n.expiredLanes)===0||Ls(n,s),g=h?Px(n,s):If(n,s,!0),b=h;do{if(g===0){Go&&!h&&Xa(n,s,0,!1);break}else{if(o=n.current.alternate,b&&!kx(o)){g=If(n,s,!1),b=!1;continue}if(g===2){if(b=s,n.errorRecoveryDisabledLanes&b)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;t:{var L=n;g=cc;var q=L.current.memoizedState.isDehydrated;if(q&&($o(L,T).flags|=256),T=If(L,T,!1),T!==2){if(Nf&&!q){L.errorRecoveryDisabledLanes|=b,Hr|=b,g=4;break t}b=ci,ci=g,b!==null&&(ci===null?ci=b:ci.push.apply(ci,b))}g=T}if(b=!1,g!==2)continue}}if(g===1){$o(n,0),Xa(n,s,0,!0);break}t:{switch(h=n,b=g,b){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Xa(h,s,Ei,!Ga);break t;case 2:ci=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=Vu+300-Hn(),10<g)){if(Xa(h,s,Ei,!Ga),pr(h,0,!0)!==0)break t;ra=s,h.timeoutHandle=Ab($y.bind(null,h,o,ci,$u,Lf,s,Ei,Hr,Vo,Ga,b,"Throttled",-0,0),g);break t}$y(h,o,ci,$u,Lf,s,Ei,Hr,Vo,Ga,b,null,-0,0)}}break}while(!0);vs(n)}function $y(n,s,o,h,g,b,T,L,q,rt,mt,bt,lt,ht){if(n.timeoutHandle=-1,bt=s.subtreeFlags,bt&8192||(bt&16785408)===16785408){bt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ai},Iy(s,b,bt);var Vt=(b&62914560)===b?Vu-Hn():(b&4194048)===b?qy-Hn():0;if(Vt=y1(bt,Vt),Vt!==null){ra=b,n.cancelPendingCommit=Vt(eb.bind(null,n,s,b,o,h,g,T,L,q,mt,bt,null,lt,ht)),Xa(n,b,T,!rt);return}}eb(n,s,b,o,h,g,T,L,q)}function kx(n){for(var s=n;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var g=o[h],b=g.getSnapshot;g=g.value;try{if(!Kn(b(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Xa(n,s,o,h){s&=~kf,s&=~Hr,n.suspendedLanes|=s,n.pingedLanes&=~s,h&&(n.warmLanes|=s),h=n.expirationTimes;for(var g=s;0<g;){var b=31-jt(g),T=1<<b;h[b]=-1,g&=~T}o!==0&&mr(n,o,s)}function Xu(){return(Ee&6)===0?(hc(0),!1):!0}function Ff(){if(pe!==null){if(Oe===0)var n=pe.return;else n=pe,Ys=kr=null,Jd(n),jo=null,$l=0,n=pe;for(;n!==null;)Ey(n.alternate,n),n=n.return;pe=null}}function $o(n,s){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,Jx(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),ra=0,Ff(),Ue=n,pe=o=$s(n.current,null),ge=s,Oe=0,Ai=null,Ga=!1,Go=Ls(n,s),Nf=!1,Vo=Ei=kf=Hr=Va=en=0,ci=cc=null,Lf=!1,(s&8)!==0&&(s|=s&32);var h=n.entangledLanes;if(h!==0)for(n=n.entanglements,h&=s;0<h;){var g=31-jt(h),b=1<<g;s|=n[g],h&=~b}return aa=s,se(),o}function Xy(n,s){ce=null,G.H=ec,s===Bo||s===Au?(s=ug(),Oe=3):s===zd?(s=ug(),Oe=4):Oe=s===gf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Ai=s,pe===null&&(en=1,ju(n,Bi(s,n.current)))}function Yy(){var n=xi.current;return n===null?!0:(ge&4194048)===ge?Ui===null:(ge&62914560)===ge||(ge&536870912)!==0?n===Ui:!1}function Qy(){var n=G.H;return G.H=ec,n===null?ec:n}function Wy(){var n=G.A;return G.A=Ox,n}function Yu(){en=4,Ga||(ge&4194048)!==ge&&xi.current!==null||(Go=!0),(Va&134217727)===0&&(Hr&134217727)===0||Ue===null||Xa(Ue,ge,Ei,!1)}function If(n,s,o){var h=Ee;Ee|=2;var g=Qy(),b=Wy();(Ue!==n||ge!==s)&&($u=null,$o(n,s)),s=!1;var T=en;t:do try{if(Oe!==0&&pe!==null){var L=pe,q=Ai;switch(Oe){case 8:Ff(),T=6;break t;case 3:case 2:case 9:case 6:xi.current===null&&(s=!0);var rt=Oe;if(Oe=0,Ai=null,Xo(n,L,q,rt),o&&Go){T=0;break t}break;default:rt=Oe,Oe=0,Ai=null,Xo(n,L,q,rt)}}Lx(),T=en;break}catch(mt){Xy(n,mt)}while(!0);return s&&n.shellSuspendCounter++,Ys=kr=null,Ee=h,G.H=g,G.A=b,pe===null&&(Ue=null,ge=0,se()),T}function Lx(){for(;pe!==null;)Zy(pe)}function Px(n,s){var o=Ee;Ee|=2;var h=Qy(),g=Wy();Ue!==n||ge!==s?($u=null,Ku=Hn()+500,$o(n,s)):Go=Ls(n,s);t:do try{if(Oe!==0&&pe!==null){s=pe;var b=Ai;e:switch(Oe){case 1:Oe=0,Ai=null,Xo(n,s,b,1);break;case 2:case 9:if(lg(b)){Oe=0,Ai=null,Jy(s);break}s=function(){Oe!==2&&Oe!==9||Ue!==n||(Oe=7),vs(n)},b.then(s,s);break t;case 3:Oe=7;break t;case 4:Oe=5;break t;case 7:lg(b)?(Oe=0,Ai=null,Jy(s)):(Oe=0,Ai=null,Xo(n,s,b,7));break;case 5:var T=null;switch(pe.tag){case 26:T=pe.memoizedState;case 5:case 27:var L=pe;if(T?Fb(T):L.stateNode.complete){Oe=0,Ai=null;var q=L.sibling;if(q!==null)pe=q;else{var rt=L.return;rt!==null?(pe=rt,Qu(rt)):pe=null}break e}}Oe=0,Ai=null,Xo(n,s,b,5);break;case 6:Oe=0,Ai=null,Xo(n,s,b,6);break;case 8:Ff(),en=6;break t;default:throw Error(i(462))}}Bx();break}catch(mt){Xy(n,mt)}while(!0);return Ys=kr=null,G.H=h,G.A=g,Ee=o,pe!==null?0:(Ue=null,ge=0,se(),en)}function Bx(){for(;pe!==null&&!nu();)Zy(pe)}function Zy(n){var s=Sy(n.alternate,n,aa);n.memoizedProps=n.pendingProps,s===null?Qu(n):pe=s}function Jy(n){var s=n,o=s.alternate;switch(s.tag){case 15:case 0:s=gy(o,s,s.pendingProps,s.type,void 0,ge);break;case 11:s=gy(o,s,s.pendingProps,s.type.render,s.ref,ge);break;case 5:Jd(s);default:Ey(o,s),s=pe=Wm(s,aa),s=Sy(o,s,aa)}n.memoizedProps=n.pendingProps,s===null?Qu(n):pe=s}function Xo(n,s,o,h){Ys=kr=null,Jd(s),jo=null,$l=0;var g=s.return;try{if(Ex(n,g,s,o,ge)){en=1,ju(n,Bi(o,n.current)),pe=null;return}}catch(b){if(g!==null)throw pe=g,b;en=1,ju(n,Bi(o,n.current)),pe=null;return}s.flags&32768?(ve||h===1?n=!0:Go||(ge&536870912)!==0?n=!1:(Ga=n=!0,(h===2||h===9||h===3||h===6)&&(h=xi.current,h!==null&&h.tag===13&&(h.flags|=16384))),tb(s,n)):Qu(s)}function Qu(n){var s=n;do{if((s.flags&32768)!==0){tb(s,Ga);return}n=s.return;var o=Tx(s.alternate,s,aa);if(o!==null){pe=o;return}if(s=s.sibling,s!==null){pe=s;return}pe=s=n}while(s!==null);en===0&&(en=5)}function tb(n,s){do{var o=Rx(n.alternate,n);if(o!==null){o.flags&=32767,pe=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(n=n.sibling,n!==null)){pe=n;return}pe=n=o}while(n!==null);en=6,pe=null}function eb(n,s,o,h,g,b,T,L,q){n.cancelPendingCommit=null;do Wu();while(vn!==0);if((Ee&6)!==0)throw Error(i(327));if(s!==null){if(s===n.current)throw Error(i(177));if(b=s.lanes|s.childLanes,b|=Yt,xl(n,o,b,T,L,q),n===Ue&&(pe=Ue=null,ge=0),Ko=s,$a=n,ra=o,Pf=b,Bf=g,Gy=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Ux(va,function(){return rb(),null})):(n.callbackNode=null,n.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=G.T,G.T=null,g=tt.p,tt.p=2,T=Ee,Ee|=4;try{Mx(n,s,o)}finally{Ee=T,tt.p=g,G.T=h}}vn=1,nb(),ib(),sb()}}function nb(){if(vn===1){vn=0;var n=$a,s=Ko,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var h=tt.p;tt.p=2;var g=Ee;Ee|=4;try{By(s,n);var b=Wf,T=R(n.containerInfo),L=b.focusedElem,q=b.selectionRange;if(T!==L&&L&&L.ownerDocument&&E(L.ownerDocument.documentElement,L)){if(q!==null&&O(L)){var rt=q.start,mt=q.end;if(mt===void 0&&(mt=rt),"selectionStart"in L)L.selectionStart=rt,L.selectionEnd=Math.min(mt,L.value.length);else{var bt=L.ownerDocument||document,lt=bt&&bt.defaultView||window;if(lt.getSelection){var ht=lt.getSelection(),Vt=L.textContent.length,Zt=Math.min(q.start,Vt),je=q.end===void 0?Zt:Math.min(q.end,Vt);!ht.extend&&Zt>je&&(T=je,je=Zt,Zt=T);var et=x(L,Zt),W=x(L,je);if(et&&W&&(ht.rangeCount!==1||ht.anchorNode!==et.node||ht.anchorOffset!==et.offset||ht.focusNode!==W.node||ht.focusOffset!==W.offset)){var at=bt.createRange();at.setStart(et.node,et.offset),ht.removeAllRanges(),Zt>je?(ht.addRange(at),ht.extend(W.node,W.offset)):(at.setEnd(W.node,W.offset),ht.addRange(at))}}}}for(bt=[],ht=L;ht=ht.parentNode;)ht.nodeType===1&&bt.push({element:ht,left:ht.scrollLeft,top:ht.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<bt.length;L++){var gt=bt[L];gt.element.scrollLeft=gt.left,gt.element.scrollTop=gt.top}}ch=!!Qf,Wf=Qf=null}finally{Ee=g,tt.p=h,G.T=o}}n.current=s,vn=2}}function ib(){if(vn===2){vn=0;var n=$a,s=Ko,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var h=tt.p;tt.p=2;var g=Ee;Ee|=4;try{Oy(n,s.alternate,s)}finally{Ee=g,tt.p=h,G.T=o}}vn=3}}function sb(){if(vn===4||vn===3){vn=0,cr();var n=$a,s=Ko,o=ra,h=Gy;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?vn=5:(vn=0,Ko=$a=null,ab(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(Ka=null),xa(o),s=s.stateNode,Nn&&typeof Nn.onCommitFiberRoot=="function")try{Nn.onCommitFiberRoot(as,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=G.T,g=tt.p,tt.p=2,G.T=null;try{for(var b=n.onRecoverableError,T=0;T<h.length;T++){var L=h[T];b(L.value,{componentStack:L.stack})}}finally{G.T=s,tt.p=g}}(ra&3)!==0&&Wu(),vs(n),g=n.pendingLanes,(o&261930)!==0&&(g&42)!==0?n===jf?uc++:(uc=0,jf=n):uc=0,hc(0)}}function ab(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,Vl(s)))}function Wu(){return nb(),ib(),sb(),rb()}function rb(){if(vn!==5)return!1;var n=$a,s=Pf;Pf=0;var o=xa(ra),h=G.T,g=tt.p;try{tt.p=32>o?32:o,G.T=null,o=Bf,Bf=null;var b=$a,T=ra;if(vn=0,Ko=$a=null,ra=0,(Ee&6)!==0)throw Error(i(331));var L=Ee;if(Ee|=4,zy(b.current),Fy(b,b.current,T,o),Ee=L,hc(0,!1),Nn&&typeof Nn.onPostCommitFiberRoot=="function")try{Nn.onPostCommitFiberRoot(as,b)}catch{}return!0}finally{tt.p=g,G.T=h,ab(n,s)}}function ob(n,s,o){s=Bi(o,s),s=mf(n.stateNode,s,2),n=Ua(n,s,2),n!==null&&(Oi(n,2),vs(n))}function Ne(n,s,o){if(n.tag===3)ob(n,n,o);else for(;s!==null;){if(s.tag===3){ob(s,n,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Ka===null||!Ka.has(h))){n=Bi(o,n),o=ly(2),h=Ua(s,o,2),h!==null&&(cy(o,h,s,n),Oi(h,2),vs(h));break}}s=s.return}}function Uf(n,s,o){var h=n.pingCache;if(h===null){h=n.pingCache=new Nx;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(o)||(Nf=!0,g.add(o),n=jx.bind(null,n,s,o),s.then(n,n))}function jx(n,s,o){var h=n.pingCache;h!==null&&h.delete(s),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Ue===n&&(ge&o)===o&&(en===4||en===3&&(ge&62914560)===ge&&300>Hn()-Vu?(Ee&2)===0&&$o(n,0):kf|=o,Vo===ge&&(Vo=0)),vs(n)}function lb(n,s){s===0&&(s=iu()),n=De(n,s),n!==null&&(Oi(n,s),vs(n))}function Fx(n){var s=n.memoizedState,o=0;s!==null&&(o=s.retryLane),lb(n,o)}function Ix(n,s){var o=0;switch(n.tag){case 31:case 13:var h=n.stateNode,g=n.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=n.stateNode;break;case 22:h=n.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(s),lb(n,o)}function Ux(n,s){return An(n,s)}var Zu=null,Yo=null,zf=!1,Ju=!1,Hf=!1,Ya=0;function vs(n){n!==Yo&&n.next===null&&(Yo===null?Zu=Yo=n:Yo=Yo.next=n),Ju=!0,zf||(zf=!0,Hx())}function hc(n,s){if(!Hf&&Ju){Hf=!0;do for(var o=!1,h=Zu;h!==null;){if(n!==0){var g=h.pendingLanes;if(g===0)var b=0;else{var T=h.suspendedLanes,L=h.pingedLanes;b=(1<<31-jt(42|n)+1)-1,b&=g&~(T&~L),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(o=!0,db(h,b))}else b=ge,b=pr(h,h===Ue?b:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(b&3)===0||Ls(h,b)||(o=!0,db(h,b));h=h.next}while(o);Hf=!1}}function zx(){cb()}function cb(){Ju=zf=!1;var n=0;Ya!==0&&Zx()&&(n=Ya);for(var s=Hn(),o=null,h=Zu;h!==null;){var g=h.next,b=ub(h,s);b===0?(h.next=null,o===null?Zu=g:o.next=g,g===null&&(Yo=o)):(o=h,(n!==0||(b&3)!==0)&&(Ju=!0)),h=g}vn!==0&&vn!==5||hc(n),Ya!==0&&(Ya=0)}function ub(n,s){for(var o=n.suspendedLanes,h=n.pingedLanes,g=n.expirationTimes,b=n.pendingLanes&-62914561;0<b;){var T=31-jt(b),L=1<<T,q=g[T];q===-1?((L&o)===0||(L&h)!==0)&&(g[T]=vd(L,s)):q<=s&&(n.expiredLanes|=L),b&=~L}if(s=Ue,o=ge,o=pr(n,n===s?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h=n.callbackNode,o===0||n===s&&(Oe===2||Oe===9)||n.cancelPendingCommit!==null)return h!==null&&h!==null&&En(h),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Ls(n,o)){if(s=o&-o,s===n.callbackPriority)return s;switch(h!==null&&En(h),xa(o)){case 2:case 8:o=ss;break;case 32:o=va;break;case 268435456:o=ao;break;default:o=va}return h=hb.bind(null,n),o=An(o,h),n.callbackPriority=s,n.callbackNode=o,s}return h!==null&&h!==null&&En(h),n.callbackPriority=2,n.callbackNode=null,2}function hb(n,s){if(vn!==0&&vn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Wu()&&n.callbackNode!==o)return null;var h=ge;return h=pr(n,n===Ue?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h===0?null:(Ky(n,h,s),ub(n,Hn()),n.callbackNode!=null&&n.callbackNode===o?hb.bind(null,n):null)}function db(n,s){if(Wu())return null;Ky(n,s,!0)}function Hx(){t1(function(){(Ee&6)!==0?An(qn,zx):cb()})}function qf(){if(Ya===0){var n=Lo;n===0&&(n=Lt,Lt<<=1,(Lt&261888)===0&&(Lt=256)),Ya=n}return Ya}function fb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Wi(""+n)}function pb(n,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,n.id&&o.setAttribute("form",n.id),s.parentNode.insertBefore(o,s),n=new FormData(n),o.parentNode.removeChild(o),n}function qx(n,s,o,h,g){if(s==="submit"&&o&&o.stateNode===g){var b=fb((g[an]||null).action),T=h.submitter;T&&(s=(s=T[an]||null)?fb(s.formAction):T.getAttribute("formAction"),s!==null&&(b=s,T=null));var L=new po("action","action",null,h,g);n.push({event:L,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ya!==0){var q=T?pb(g,T):new FormData(g);cf(o,{pending:!0,data:q,method:g.method,action:b},null,q)}}else typeof b=="function"&&(L.preventDefault(),q=T?pb(g,T):new FormData(g),cf(o,{pending:!0,data:q,method:g.method,action:b},b,q))},currentTarget:g}]})}}for(var Gf=0;Gf<Pt.length;Gf++){var Vf=Pt[Gf],Gx=Vf.toLowerCase(),Vx=Vf[0].toUpperCase()+Vf.slice(1);_t(Gx,"on"+Vx)}_t(ot,"onAnimationEnd"),_t(it,"onAnimationIteration"),_t(pt,"onAnimationStart"),_t("dblclick","onDoubleClick"),_t("focusin","onFocus"),_t("focusout","onBlur"),_t(St,"onTransitionRun"),_t(Dt,"onTransitionStart"),_t(Ot,"onTransitionCancel"),_t(Et,"onTransitionEnd"),us("onMouseEnter",["mouseout","mouseover"]),us("onMouseLeave",["mouseout","mouseover"]),us("onPointerEnter",["pointerout","pointerover"]),us("onPointerLeave",["pointerout","pointerover"]),Yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var dc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Kx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(dc));function mb(n,s){s=(s&4)!==0;for(var o=0;o<n.length;o++){var h=n[o],g=h.event;h=h.listeners;t:{var b=void 0;if(s)for(var T=h.length-1;0<=T;T--){var L=h[T],q=L.instance,rt=L.currentTarget;if(L=L.listener,q!==b&&g.isPropagationStopped())break t;b=L,g.currentTarget=rt;try{b(g)}catch(mt){zt(mt)}g.currentTarget=null,b=q}else for(T=0;T<h.length;T++){if(L=h[T],q=L.instance,rt=L.currentTarget,L=L.listener,q!==b&&g.isPropagationStopped())break t;b=L,g.currentTarget=rt;try{b(g)}catch(mt){zt(mt)}g.currentTarget=null,b=q}}}}function me(n,s){var o=s[Sa];o===void 0&&(o=s[Sa]=new Set);var h=n+"__bubble";o.has(h)||(gb(s,n,2,!1),o.add(h))}function Kf(n,s,o){var h=0;s&&(h|=4),gb(o,n,h,s)}var th="_reactListening"+Math.random().toString(36).slice(2);function $f(n){if(!n[th]){n[th]=!0,Ps.forEach(function(o){o!=="selectionchange"&&(Kx.has(o)||Kf(o,!1,n),Kf(o,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[th]||(s[th]=!0,Kf("selectionchange",!1,s))}}function gb(n,s,o,h){switch(Vb(s)){case 2:var g=w1;break;case 8:g=x1;break;default:g=lp}o=g.bind(null,s,o,n),g=void 0,!Ml||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?n.addEventListener(s,o,{capture:!0,passive:g}):n.addEventListener(s,o,!0):g!==void 0?n.addEventListener(s,o,{passive:g}):n.addEventListener(s,o,!1)}function Xf(n,s,o,h,g){var b=h;if((s&1)===0&&(s&2)===0&&h!==null)t:for(;;){if(h===null)return;var T=h.tag;if(T===3||T===4){var L=h.stateNode.containerInfo;if(L===g)break;if(T===4)for(T=h.return;T!==null;){var q=T.tag;if((q===3||q===4)&&T.stateNode.containerInfo===g)return;T=T.return}for(;L!==null;){if(T=cs(L),T===null)return;if(q=T.tag,q===5||q===6||q===26||q===27){h=b=T;continue t}L=L.parentNode}}h=h.return}Ea(function(){var rt=b,mt=ho(o),bt=[];t:{var lt=Ut.get(n);if(lt!==void 0){var ht=po,Vt=n;switch(n){case"keypress":if(Ta(o)===0)break t;case"keydown":case"keyup":ht=xo;break;case"focusin":Vt="focus",ht=Ra;break;case"focusout":Vt="blur",ht=Ra;break;case"beforeblur":case"afterblur":ht=Ra;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ht=yo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ht=ou;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ht=Bl;break;case ot:case it:case pt:ht=lu;break;case Et:ht=jl;break;case"scroll":case"scrollend":ht=mo;break;case"wheel":ht=Ao;break;case"copy":case"cut":case"paste":ht=Ma;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ht=Pl;break;case"toggle":case"beforetoggle":ht=hu}var Zt=(s&4)!==0,je=!Zt&&(n==="scroll"||n==="scrollend"),et=Zt?lt!==null?lt+"Capture":null:lt;Zt=[];for(var W=rt,at;W!==null;){var gt=W;if(at=gt.stateNode,gt=gt.tag,gt!==5&&gt!==26&&gt!==27||at===null||et===null||(gt=Us(W,et),gt!=null&&Zt.push(fc(W,gt,at))),je)break;W=W.return}0<Zt.length&&(lt=new ht(lt,Vt,null,o,mt),bt.push({event:lt,listeners:Zt}))}}if((s&7)===0){t:{if(lt=n==="mouseover"||n==="pointerover",ht=n==="mouseout"||n==="pointerout",lt&&o!==ki&&(Vt=o.relatedTarget||o.fromElement)&&(cs(Vt)||Vt[Zn]))break t;if((ht||lt)&&(lt=mt.window===mt?mt:(lt=mt.ownerDocument)?lt.defaultView||lt.parentWindow:window,ht?(Vt=o.relatedTarget||o.toElement,ht=rt,Vt=Vt?cs(Vt):null,Vt!==null&&(je=l(Vt),Zt=Vt.tag,Vt!==je||Zt!==5&&Zt!==27&&Zt!==6)&&(Vt=null)):(ht=null,Vt=rt),ht!==Vt)){if(Zt=yo,gt="onMouseLeave",et="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(Zt=Pl,gt="onPointerLeave",et="onPointerEnter",W="pointer"),je=ht==null?lt:bi(ht),at=Vt==null?lt:bi(Vt),lt=new Zt(gt,W+"leave",ht,o,mt),lt.target=je,lt.relatedTarget=at,gt=null,cs(mt)===rt&&(Zt=new Zt(et,W+"enter",Vt,o,mt),Zt.target=at,Zt.relatedTarget=je,gt=Zt),je=gt,ht&&Vt)e:{for(Zt=$x,et=ht,W=Vt,at=0,gt=et;gt;gt=Zt(gt))at++;gt=0;for(var Qt=W;Qt;Qt=Zt(Qt))gt++;for(;0<at-gt;)et=Zt(et),at--;for(;0<gt-at;)W=Zt(W),gt--;for(;at--;){if(et===W||W!==null&&et===W.alternate){Zt=et;break e}et=Zt(et),W=Zt(W)}Zt=null}else Zt=null;ht!==null&&yb(bt,lt,ht,Zt,!1),Vt!==null&&je!==null&&yb(bt,je,Vt,Zt,!0)}}t:{if(lt=rt?bi(rt):window,ht=lt.nodeName&&lt.nodeName.toLowerCase(),ht==="select"||ht==="input"&&lt.type==="file")var xe=Dr;else if(Co(lt))if(Pi)xe=Na;else{xe=Ks;var $t=yu}else ht=lt.nodeName,!ht||ht.toLowerCase()!=="input"||lt.type!=="checkbox"&&lt.type!=="radio"?rt&&Rl(rt.elementType)&&(xe=Dr):xe=Hl;if(xe&&(xe=xe(n,rt))){zl(bt,xe,o,mt);break t}$t&&$t(n,lt,rt),n==="focusout"&&rt&&lt.type==="number"&&rt.memoizedProps.value!=null&&Sr(lt,"number",lt.value)}switch($t=rt?bi(rt):window,n){case"focusin":(Co($t)||$t.contentEditable==="true")&&(B=$t,K=rt,nt=null);break;case"focusout":nt=K=B=null;break;case"mousedown":$=!0;break;case"contextmenu":case"mouseup":case"dragend":$=!1,V(bt,o,mt);break;case"selectionchange":if(P)break;case"keydown":case"keyup":V(bt,o,mt)}var ue;if(Rr)t:{switch(n){case"compositionstart":var ye="onCompositionStart";break t;case"compositionend":ye="onCompositionEnd";break t;case"compositionupdate":ye="onCompositionUpdate";break t}ye=void 0}else Gs?Ul(n,o)&&(ye="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(ye="onCompositionStart");ye&&(Eo&&o.locale!=="ko"&&(Gs||ye!=="onCompositionStart"?ye==="onCompositionEnd"&&Gs&&(ue=Ca()):(Li=mt,fo="value"in Li?Li.value:Li.textContent,Gs=!0)),$t=eh(rt,ye),0<$t.length&&(ye=new wo(ye,n,null,o,mt),bt.push({event:ye,listeners:$t}),ue?ye.data=ue:(ue=fu(o),ue!==null&&(ye.data=ue)))),(ue=_d?pu(n,o):Cd(n,o))&&(ye=eh(rt,"onBeforeInput"),0<ye.length&&($t=new wo("onBeforeInput","beforeinput",null,o,mt),bt.push({event:$t,listeners:ye}),$t.data=ue)),qx(bt,n,rt,o,mt)}mb(bt,s)})}function fc(n,s,o){return{instance:n,listener:s,currentTarget:o}}function eh(n,s){for(var o=s+"Capture",h=[];n!==null;){var g=n,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=Us(n,o),g!=null&&h.unshift(fc(n,g,b)),g=Us(n,s),g!=null&&h.push(fc(n,g,b))),n.tag===3)return h;n=n.return}return[]}function $x(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function yb(n,s,o,h,g){for(var b=s._reactName,T=[];o!==null&&o!==h;){var L=o,q=L.alternate,rt=L.stateNode;if(L=L.tag,q!==null&&q===h)break;L!==5&&L!==26&&L!==27||rt===null||(q=rt,g?(rt=Us(o,b),rt!=null&&T.unshift(fc(o,rt,q))):g||(rt=Us(o,b),rt!=null&&T.push(fc(o,rt,q)))),o=o.return}T.length!==0&&n.push({event:s,listeners:T})}var Xx=/\r\n?/g,Yx=/\u0000|\uFFFD/g;function bb(n){return(typeof n=="string"?n:""+n).replace(Xx,`
`).replace(Yx,"")}function vb(n,s){return s=bb(s),bb(n)===s}function Be(n,s,o,h,g,b){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||js(n,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&js(n,""+h);break;case"className":wr(n,"class",h);break;case"tabIndex":wr(n,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":wr(n,o,h);break;case"style":Tl(n,h,b);break;case"data":if(s!=="object"){wr(n,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){n.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Wi(""+h),n.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(o==="formAction"?(s!=="input"&&Be(n,s,"name",g.name,g,null),Be(n,s,"formEncType",g.formEncType,g,null),Be(n,s,"formMethod",g.formMethod,g,null),Be(n,s,"formTarget",g.formTarget,g,null)):(Be(n,s,"encType",g.encType,g,null),Be(n,s,"method",g.method,g,null),Be(n,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Wi(""+h),n.setAttribute(o,h);break;case"onClick":h!=null&&(n.onclick=ai);break;case"onScroll":h!=null&&me("scroll",n);break;case"onScrollEnd":h!=null&&me("scrollend",n);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":n.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){n.removeAttribute("xlink:href");break}o=Wi(""+h),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""+h):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":h===!0?n.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,h):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?n.setAttribute(o,h):n.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?n.removeAttribute(o):n.setAttribute(o,h);break;case"popover":me("beforetoggle",n),me("toggle",n),he(n,"popover",h);break;case"xlinkActuate":Ni(n,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Ni(n,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Ni(n,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Ni(n,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Ni(n,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Ni(n,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Ni(n,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Ni(n,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Ni(n,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":he(n,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Sd.get(o)||o,he(n,o,h))}}function Yf(n,s,o,h,g,b){switch(o){case"style":Tl(n,h,b);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof h=="string"?js(n,h):(typeof h=="number"||typeof h=="bigint")&&js(n,""+h);break;case"onScroll":h!=null&&me("scroll",n);break;case"onScrollEnd":h!=null&&me("scrollend",n);break;case"onClick":h!=null&&(n.onclick=ai);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!br.hasOwnProperty(o))t:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),b=n[an]||null,b=b!=null?b[o]:null,typeof b=="function"&&n.removeEventListener(s,b,g),typeof h=="function")){typeof b!="function"&&b!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(s,h,g);break t}o in n?n[o]=h:h===!0?n.setAttribute(o,""):he(n,o,h)}}}function Fn(n,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":me("error",n),me("load",n);var h=!1,g=!1,b;for(b in o)if(o.hasOwnProperty(b)){var T=o[b];if(T!=null)switch(b){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Be(n,s,b,T,o,null)}}g&&Be(n,s,"srcSet",o.srcSet,o,null),h&&Be(n,s,"src",o.src,o,null);return;case"input":me("invalid",n);var L=b=T=g=null,q=null,rt=null;for(h in o)if(o.hasOwnProperty(h)){var mt=o[h];if(mt!=null)switch(h){case"name":g=mt;break;case"type":T=mt;break;case"checked":q=mt;break;case"defaultChecked":rt=mt;break;case"value":b=mt;break;case"defaultValue":L=mt;break;case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(i(137,s));break;default:Be(n,s,h,mt,o,null)}}uo(n,b,L,q,rt,T,g,!1);return;case"select":me("invalid",n),h=T=b=null;for(g in o)if(o.hasOwnProperty(g)&&(L=o[g],L!=null))switch(g){case"value":b=L;break;case"defaultValue":T=L;break;case"multiple":h=L;default:Be(n,s,g,L,o,null)}s=b,o=T,n.multiple=!!h,s!=null?Qi(n,!!h,s,!1):o!=null&&Qi(n,!!h,o,!0);return;case"textarea":me("invalid",n),b=g=h=null;for(T in o)if(o.hasOwnProperty(T)&&(L=o[T],L!=null))switch(T){case"value":h=L;break;case"defaultValue":g=L;break;case"children":b=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(i(91));break;default:Be(n,s,T,L,o,null)}Ar(n,h,g,b);return;case"option":for(q in o)o.hasOwnProperty(q)&&(h=o[q],h!=null)&&(q==="selected"?n.selected=h&&typeof h!="function"&&typeof h!="symbol":Be(n,s,q,h,o,null));return;case"dialog":me("beforetoggle",n),me("toggle",n),me("cancel",n),me("close",n);break;case"iframe":case"object":me("load",n);break;case"video":case"audio":for(h=0;h<dc.length;h++)me(dc[h],n);break;case"image":me("error",n),me("load",n);break;case"details":me("toggle",n);break;case"embed":case"source":case"link":me("error",n),me("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(rt in o)if(o.hasOwnProperty(rt)&&(h=o[rt],h!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Be(n,s,rt,h,o,null)}return;default:if(Rl(s)){for(mt in o)o.hasOwnProperty(mt)&&(h=o[mt],h!==void 0&&Yf(n,s,mt,h,o,void 0));return}}for(L in o)o.hasOwnProperty(L)&&(h=o[L],h!=null&&Be(n,s,L,h,o,null))}function Qx(n,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,T=null,L=null,q=null,rt=null,mt=null;for(ht in o){var bt=o[ht];if(o.hasOwnProperty(ht)&&bt!=null)switch(ht){case"checked":break;case"value":break;case"defaultValue":q=bt;default:h.hasOwnProperty(ht)||Be(n,s,ht,null,h,bt)}}for(var lt in h){var ht=h[lt];if(bt=o[lt],h.hasOwnProperty(lt)&&(ht!=null||bt!=null))switch(lt){case"type":b=ht;break;case"name":g=ht;break;case"checked":rt=ht;break;case"defaultChecked":mt=ht;break;case"value":T=ht;break;case"defaultValue":L=ht;break;case"children":case"dangerouslySetInnerHTML":if(ht!=null)throw Error(i(137,s));break;default:ht!==bt&&Be(n,s,lt,ht,h,bt)}}hs(n,T,L,q,rt,mt,b,g);return;case"select":ht=T=L=lt=null;for(b in o)if(q=o[b],o.hasOwnProperty(b)&&q!=null)switch(b){case"value":break;case"multiple":ht=q;default:h.hasOwnProperty(b)||Be(n,s,b,null,h,q)}for(g in h)if(b=h[g],q=o[g],h.hasOwnProperty(g)&&(b!=null||q!=null))switch(g){case"value":lt=b;break;case"defaultValue":L=b;break;case"multiple":T=b;default:b!==q&&Be(n,s,g,b,h,q)}s=L,o=T,h=ht,lt!=null?Qi(n,!!o,lt,!1):!!h!=!!o&&(s!=null?Qi(n,!!o,s,!0):Qi(n,!!o,o?[]:"",!1));return;case"textarea":ht=lt=null;for(L in o)if(g=o[L],o.hasOwnProperty(L)&&g!=null&&!h.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Be(n,s,L,null,h,g)}for(T in h)if(g=h[T],b=o[T],h.hasOwnProperty(T)&&(g!=null||b!=null))switch(T){case"value":lt=g;break;case"defaultValue":ht=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==b&&Be(n,s,T,g,h,b)}Cl(n,lt,ht);return;case"option":for(var Vt in o)lt=o[Vt],o.hasOwnProperty(Vt)&&lt!=null&&!h.hasOwnProperty(Vt)&&(Vt==="selected"?n.selected=!1:Be(n,s,Vt,null,h,lt));for(q in h)lt=h[q],ht=o[q],h.hasOwnProperty(q)&&lt!==ht&&(lt!=null||ht!=null)&&(q==="selected"?n.selected=lt&&typeof lt!="function"&&typeof lt!="symbol":Be(n,s,q,lt,h,ht));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Zt in o)lt=o[Zt],o.hasOwnProperty(Zt)&&lt!=null&&!h.hasOwnProperty(Zt)&&Be(n,s,Zt,null,h,lt);for(rt in h)if(lt=h[rt],ht=o[rt],h.hasOwnProperty(rt)&&lt!==ht&&(lt!=null||ht!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(i(137,s));break;default:Be(n,s,rt,lt,h,ht)}return;default:if(Rl(s)){for(var je in o)lt=o[je],o.hasOwnProperty(je)&&lt!==void 0&&!h.hasOwnProperty(je)&&Yf(n,s,je,void 0,h,lt);for(mt in h)lt=h[mt],ht=o[mt],!h.hasOwnProperty(mt)||lt===ht||lt===void 0&&ht===void 0||Yf(n,s,mt,lt,h,ht);return}}for(var et in o)lt=o[et],o.hasOwnProperty(et)&&lt!=null&&!h.hasOwnProperty(et)&&Be(n,s,et,null,h,lt);for(bt in h)lt=h[bt],ht=o[bt],!h.hasOwnProperty(bt)||lt===ht||lt==null&&ht==null||Be(n,s,bt,lt,h,ht)}function wb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Wx(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,o=performance.getEntriesByType("resource"),h=0;h<o.length;h++){var g=o[h],b=g.transferSize,T=g.initiatorType,L=g.duration;if(b&&L&&wb(T)){for(T=0,L=g.responseEnd,h+=1;h<o.length;h++){var q=o[h],rt=q.startTime;if(rt>L)break;var mt=q.transferSize,bt=q.initiatorType;mt&&wb(bt)&&(q=q.responseEnd,T+=mt*(q<L?1:(L-rt)/(q-rt)))}if(--h,s+=8*(b+T)/(g.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Qf=null,Wf=null;function nh(n){return n.nodeType===9?n:n.ownerDocument}function xb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sb(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Zf(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Jf=null;function Zx(){var n=window.event;return n&&n.type==="popstate"?n===Jf?!1:(Jf=n,!0):(Jf=null,!1)}var Ab=typeof setTimeout=="function"?setTimeout:void 0,Jx=typeof clearTimeout=="function"?clearTimeout:void 0,Eb=typeof Promise=="function"?Promise:void 0,t1=typeof queueMicrotask=="function"?queueMicrotask:typeof Eb<"u"?function(n){return Eb.resolve(null).then(n).catch(e1)}:Ab;function e1(n){setTimeout(function(){throw n})}function Qa(n){return n==="head"}function _b(n,s){var o=s,h=0;do{var g=o.nextSibling;if(n.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(h===0){n.removeChild(g),Jo(s);return}h--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")h++;else if(o==="html")pc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,pc(o);for(var b=o.firstChild;b;){var T=b.nextSibling,L=b.nodeName;b[yi]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&b.rel.toLowerCase()==="stylesheet"||o.removeChild(b),b=T}}else o==="body"&&pc(n.ownerDocument.body);o=g}while(o);Jo(s)}function Cb(n,s){var o=n;n=0;do{var h=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=h}while(o)}function tp(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":tp(o),lo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function n1(n,s,o,h){for(;n.nodeType===1;){var g=o;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(h){if(!n[yi])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(b=n.getAttribute("rel"),b==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(b!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(b=n.getAttribute("src"),(b!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===b)return n}else return n;if(n=zi(n.nextSibling),n===null)break}return null}function i1(n,s,o){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=zi(n.nextSibling),n===null))return null;return n}function Tb(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=zi(n.nextSibling),n===null))return null;return n}function ep(n){return n.data==="$?"||n.data==="$~"}function np(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function s1(n,s){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||o.readyState!=="loading")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),n._reactRetry=h}}function zi(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var ip=null;function Rb(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(s===0)return zi(n.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}n=n.nextSibling}return null}function Mb(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return n;s--}else o!=="/$"&&o!=="/&"||s++}n=n.previousSibling}return null}function Db(n,s,o){switch(s=nh(o),n){case"html":if(n=s.documentElement,!n)throw Error(i(452));return n;case"head":if(n=s.head,!n)throw Error(i(453));return n;case"body":if(n=s.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function pc(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);lo(n)}var Hi=new Map,Ob=new Set;function ih(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var oa=tt.d;tt.d={f:a1,r:r1,D:o1,C:l1,L:c1,m:u1,X:d1,S:h1,M:f1};function a1(){var n=oa.f(),s=Xu();return n||s}function r1(n){var s=ke(n);s!==null&&s.tag===5&&s.type==="form"?Xg(s):oa.r(n)}var Qo=typeof document>"u"?null:document;function Nb(n,s,o){var h=Qo;if(h&&typeof s=="string"&&s){var g=_n(s);g='link[rel="'+n+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Ob.has(g)||(Ob.add(g),n={rel:n,crossOrigin:o,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),Fn(s,"link",n),rn(s),h.head.appendChild(s)))}}function o1(n){oa.D(n),Nb("dns-prefetch",n,null)}function l1(n,s){oa.C(n,s),Nb("preconnect",n,s)}function c1(n,s,o){oa.L(n,s,o);var h=Qo;if(h&&n&&s){var g='link[rel="preload"][as="'+_n(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+_n(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+_n(o.imageSizes)+'"]')):g+='[href="'+_n(n)+'"]';var b=g;switch(s){case"style":b=Wo(n);break;case"script":b=Zo(n)}Hi.has(b)||(n=y({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:n,as:s},o),Hi.set(b,n),h.querySelector(g)!==null||s==="style"&&h.querySelector(mc(b))||s==="script"&&h.querySelector(gc(b))||(s=h.createElement("link"),Fn(s,"link",n),rn(s),h.head.appendChild(s)))}}function u1(n,s){oa.m(n,s);var o=Qo;if(o&&n){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+_n(h)+'"][href="'+_n(n)+'"]',b=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Zo(n)}if(!Hi.has(b)&&(n=y({rel:"modulepreload",href:n},s),Hi.set(b,n),o.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(gc(b)))return}h=o.createElement("link"),Fn(h,"link",n),rn(h),o.head.appendChild(h)}}}function h1(n,s,o){oa.S(n,s,o);var h=Qo;if(h&&n){var g=Gn(h).hoistableStyles,b=Wo(n);s=s||"default";var T=g.get(b);if(!T){var L={loading:0,preload:null};if(T=h.querySelector(mc(b)))L.loading=5;else{n=y({rel:"stylesheet",href:n,"data-precedence":s},o),(o=Hi.get(b))&&sp(n,o);var q=T=h.createElement("link");rn(q),Fn(q,"link",n),q._p=new Promise(function(rt,mt){q.onload=rt,q.onerror=mt}),q.addEventListener("load",function(){L.loading|=1}),q.addEventListener("error",function(){L.loading|=2}),L.loading|=4,sh(T,s,h)}T={type:"stylesheet",instance:T,count:1,state:L},g.set(b,T)}}}function d1(n,s){oa.X(n,s);var o=Qo;if(o&&n){var h=Gn(o).hoistableScripts,g=Zo(n),b=h.get(g);b||(b=o.querySelector(gc(g)),b||(n=y({src:n,async:!0},s),(s=Hi.get(g))&&ap(n,s),b=o.createElement("script"),rn(b),Fn(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function f1(n,s){oa.M(n,s);var o=Qo;if(o&&n){var h=Gn(o).hoistableScripts,g=Zo(n),b=h.get(g);b||(b=o.querySelector(gc(g)),b||(n=y({src:n,async:!0,type:"module"},s),(s=Hi.get(g))&&ap(n,s),b=o.createElement("script"),rn(b),Fn(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function kb(n,s,o,h){var g=(g=Ft.current)?ih(g):null;if(!g)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Wo(o.href),o=Gn(g).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Wo(o.href);var b=Gn(g).hoistableStyles,T=b.get(n);if(T||(g=g.ownerDocument||g,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(n,T),(b=g.querySelector(mc(n)))&&!b._p&&(T.instance=b,T.state.loading=5),Hi.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Hi.set(n,o),b||p1(g,n,o,T.state))),s&&h===null)throw Error(i(528,""));return T}if(s&&h!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Zo(o),o=Gn(g).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Wo(n){return'href="'+_n(n)+'"'}function mc(n){return'link[rel="stylesheet"]['+n+"]"}function Lb(n){return y({},n,{"data-precedence":n.precedence,precedence:null})}function p1(n,s,o,h){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=n.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Fn(s,"link",o),rn(s),n.head.appendChild(s))}function Zo(n){return'[src="'+_n(n)+'"]'}function gc(n){return"script[async]"+n}function Pb(n,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=n.querySelector('style[data-href~="'+_n(o.href)+'"]');if(h)return s.instance=h,rn(h),h;var g=y({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(n.ownerDocument||n).createElement("style"),rn(h),Fn(h,"style",g),sh(h,o.precedence,n),s.instance=h;case"stylesheet":g=Wo(o.href);var b=n.querySelector(mc(g));if(b)return s.state.loading|=4,s.instance=b,rn(b),b;h=Lb(o),(g=Hi.get(g))&&sp(h,g),b=(n.ownerDocument||n).createElement("link"),rn(b);var T=b;return T._p=new Promise(function(L,q){T.onload=L,T.onerror=q}),Fn(b,"link",h),s.state.loading|=4,sh(b,o.precedence,n),s.instance=b;case"script":return b=Zo(o.src),(g=n.querySelector(gc(b)))?(s.instance=g,rn(g),g):(h=o,(g=Hi.get(b))&&(h=y({},o),ap(h,g)),n=n.ownerDocument||n,g=n.createElement("script"),rn(g),Fn(g,"link",h),n.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,sh(h,o.precedence,n));return s.instance}function sh(n,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,b=g,T=0;T<h.length;T++){var L=h[T];if(L.dataset.precedence===s)b=L;else if(b!==g)break}b?b.parentNode.insertBefore(n,b.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(n,s.firstChild))}function sp(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function ap(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var ah=null;function Bb(n,s,o){if(ah===null){var h=new Map,g=ah=new Map;g.set(o,h)}else g=ah,h=g.get(o),h||(h=new Map,g.set(o,h));if(h.has(n))return h;for(h.set(n,null),o=o.getElementsByTagName(n),g=0;g<o.length;g++){var b=o[g];if(!(b[yi]||b[ze]||n==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var T=b.getAttribute(s)||"";T=n+T;var L=h.get(T);L?L.push(b):h.set(T,[b])}}return h}function jb(n,s,o){n=n.ownerDocument||n,n.head.insertBefore(o,s==="title"?n.querySelector("head > title"):null)}function m1(n,s,o){if(o===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(n=s.disabled,typeof s.precedence=="string"&&n==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Fb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function g1(n,s,o,h){if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Wo(h.href),b=s.querySelector(mc(g));if(b){s=b._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=rh.bind(n),s.then(n,n)),o.state.loading|=4,o.instance=b,rn(b);return}b=s.ownerDocument||s,h=Lb(h),(g=Hi.get(g))&&sp(h,g),b=b.createElement("link"),rn(b);var T=b;T._p=new Promise(function(L,q){T.onload=L,T.onerror=q}),Fn(b,"link",h),o.instance=b}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=rh.bind(n),s.addEventListener("load",o),s.addEventListener("error",o))}}var rp=0;function y1(n,s){return n.stylesheets&&n.count===0&&lh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var h=setTimeout(function(){if(n.stylesheets&&lh(n,n.stylesheets),n.unsuspend){var b=n.unsuspend;n.unsuspend=null,b()}},6e4+s);0<n.imgBytes&&rp===0&&(rp=62500*Wx());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&lh(n,n.stylesheets),n.unsuspend)){var b=n.unsuspend;n.unsuspend=null,b()}},(n.imgBytes>rp?50:800)+s);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function rh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)lh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var oh=null;function lh(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,oh=new Map,s.forEach(b1,n),oh=null,rh.call(n))}function b1(n,s){if(!(s.state.loading&4)){var o=oh.get(n);if(o)var h=o.get(null);else{o=new Map,oh.set(n,o);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var T=g[b];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),h=T)}h&&o.set(null,h)}g=s.instance,T=g.getAttribute("data-precedence"),b=o.get(T)||h,b===h&&o.set(null,g),o.set(T,g),this.count++,h=rh.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),b?b.parentNode.insertBefore(g,b.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),s.state.loading|=4}}var yc={$$typeof:k,Provider:null,Consumer:null,_currentValue:vt,_currentValue2:vt,_threadCount:0};function v1(n,s,o,h,g,b,T,L,q){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=rs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=rs(0),this.hiddenUpdates=rs(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Ib(n,s,o,h,g,b,T,L,q,rt,mt,bt){return n=new v1(n,s,o,T,q,rt,mt,bt,L),s=1,b===!0&&(s|=24),b=wi(3,null,null,s),n.current=b,b.stateNode=n,s=Fd(),s.refCount++,n.pooledCache=s,s.refCount++,b.memoizedState={element:h,isDehydrated:o,cache:s},Hd(b),n}function Ub(n){return n?(n=Mo,n):Mo}function zb(n,s,o,h,g,b){g=Ub(g),h.context===null?h.context=g:h.pendingContext=g,h=Ia(s),h.payload={element:o},b=b===void 0?null:b,b!==null&&(h.callback=b),o=Ua(n,h,s),o!==null&&(ui(o,n,s),Yl(o,n,s))}function Hb(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<s?o:s}}function op(n,s){Hb(n,s),(n=n.alternate)&&Hb(n,s)}function qb(n){if(n.tag===13||n.tag===31){var s=De(n,67108864);s!==null&&ui(s,n,67108864),op(n,67108864)}}function Gb(n){if(n.tag===13||n.tag===31){var s=_i();s=Sl(s);var o=De(n,s);o!==null&&ui(o,n,s),op(n,s)}}var ch=!0;function w1(n,s,o,h){var g=G.T;G.T=null;var b=tt.p;try{tt.p=2,lp(n,s,o,h)}finally{tt.p=b,G.T=g}}function x1(n,s,o,h){var g=G.T;G.T=null;var b=tt.p;try{tt.p=8,lp(n,s,o,h)}finally{tt.p=b,G.T=g}}function lp(n,s,o,h){if(ch){var g=cp(h);if(g===null)Xf(n,s,h,uh,o),Kb(n,h);else if(A1(g,n,s,o,h))h.stopPropagation();else if(Kb(n,h),s&4&&-1<S1.indexOf(n)){for(;g!==null;){var b=ke(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var T=Xi(b.pendingLanes);if(T!==0){var L=b;for(L.pendingLanes|=2,L.entangledLanes|=2;T;){var q=1<<31-jt(T);L.entanglements[1]|=q,T&=~q}vs(b),(Ee&6)===0&&(Ku=Hn()+500,hc(0))}}break;case 31:case 13:L=De(b,2),L!==null&&ui(L,b,2),Xu(),op(b,2)}if(b=cp(h),b===null&&Xf(n,s,h,uh,o),b===g)break;g=b}g!==null&&h.stopPropagation()}else Xf(n,s,h,null,o)}}function cp(n){return n=ho(n),up(n)}var uh=null;function up(n){if(uh=null,n=cs(n),n!==null){var s=l(n);if(s===null)n=null;else{var o=s.tag;if(o===13){if(n=c(s),n!==null)return n;n=null}else if(o===31){if(n=u(s),n!==null)return n;n=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return uh=n,null}function Vb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ur()){case qn:return 2;case ss:return 8;case va:case hr:return 32;case ao:return 268435456;default:return 32}default:return 32}}var hp=!1,Wa=null,Za=null,Ja=null,bc=new Map,vc=new Map,tr=[],S1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Kb(n,s){switch(n){case"focusin":case"focusout":Wa=null;break;case"dragenter":case"dragleave":Za=null;break;case"mouseover":case"mouseout":Ja=null;break;case"pointerover":case"pointerout":bc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":vc.delete(s.pointerId)}}function wc(n,s,o,h,g,b){return n===null||n.nativeEvent!==b?(n={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:b,targetContainers:[g]},s!==null&&(s=ke(s),s!==null&&qb(s)),n):(n.eventSystemFlags|=h,s=n.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),n)}function A1(n,s,o,h,g){switch(s){case"focusin":return Wa=wc(Wa,n,s,o,h,g),!0;case"dragenter":return Za=wc(Za,n,s,o,h,g),!0;case"mouseover":return Ja=wc(Ja,n,s,o,h,g),!0;case"pointerover":var b=g.pointerId;return bc.set(b,wc(bc.get(b)||null,n,s,o,h,g)),!0;case"gotpointercapture":return b=g.pointerId,vc.set(b,wc(vc.get(b)||null,n,s,o,h,g)),!0}return!1}function $b(n){var s=cs(n.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){n.blockedOn=s,yr(n.priority,function(){Gb(o)});return}}else if(s===31){if(s=u(o),s!==null){n.blockedOn=s,yr(n.priority,function(){Gb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function hh(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var o=cp(n.nativeEvent);if(o===null){o=n.nativeEvent;var h=new o.constructor(o.type,o);ki=h,o.target.dispatchEvent(h),ki=null}else return s=ke(o),s!==null&&qb(s),n.blockedOn=o,!1;s.shift()}return!0}function Xb(n,s,o){hh(n)&&o.delete(s)}function E1(){hp=!1,Wa!==null&&hh(Wa)&&(Wa=null),Za!==null&&hh(Za)&&(Za=null),Ja!==null&&hh(Ja)&&(Ja=null),bc.forEach(Xb),vc.forEach(Xb)}function dh(n,s){n.blockedOn===s&&(n.blockedOn=null,hp||(hp=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,E1)))}var fh=null;function Yb(n){fh!==n&&(fh=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){fh===n&&(fh=null);for(var s=0;s<n.length;s+=3){var o=n[s],h=n[s+1],g=n[s+2];if(typeof h!="function"){if(up(h||o)===null)continue;break}var b=ke(o);b!==null&&(n.splice(s,3),s-=3,cf(b,{pending:!0,data:g,method:o.method,action:h},h,g))}}))}function Jo(n){function s(q){return dh(q,n)}Wa!==null&&dh(Wa,n),Za!==null&&dh(Za,n),Ja!==null&&dh(Ja,n),bc.forEach(s),vc.forEach(s);for(var o=0;o<tr.length;o++){var h=tr[o];h.blockedOn===n&&(h.blockedOn=null)}for(;0<tr.length&&(o=tr[0],o.blockedOn===null);)$b(o),o.blockedOn===null&&tr.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var g=o[h],b=o[h+1],T=g[an]||null;if(typeof b=="function")T||Yb(o);else if(T){var L=null;if(b&&b.hasAttribute("formAction")){if(g=b,T=b[an]||null)L=T.formAction;else if(up(g)!==null)continue}else L=T.action;typeof L=="function"?o[h+1]=L:(o.splice(h,3),h-=3),Yb(o)}}}function Qb(){function n(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(T){return g=T})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),h||setTimeout(o,20)}function o(){if(!h&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){h=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function dp(n){this._internalRoot=n}ph.prototype.render=dp.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,h=_i();zb(o,h,n,s,null,null)},ph.prototype.unmount=dp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;zb(n.current,2,null,n,null,null),Xu(),s[Zn]=null}};function ph(n){this._internalRoot=n}ph.prototype.unstable_scheduleHydration=function(n){if(n){var s=gr();n={blockedOn:null,target:n,priority:s};for(var o=0;o<tr.length&&s!==0&&s<tr[o].priority;o++);tr.splice(o,0,n),o===0&&$b(n)}};var Wb=t.version;if(Wb!=="19.2.4")throw Error(i(527,Wb,"19.2.4"));tt.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(s),n=n!==null?p(n):null,n=n===null?null:n.stateNode,n};var _1={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mh.isDisabled&&mh.supportsFiber)try{as=mh.inject(_1),Nn=mh}catch{}}return Sc.createRoot=function(n,s){if(!a(n))throw Error(i(299));var o=!1,h="",g=sy,b=ay,T=ry;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),s=Ib(n,1,!1,null,null,o,h,null,g,b,T,Qb),n[Zn]=s.current,$f(n),new dp(s)},Sc.hydrateRoot=function(n,s,o){if(!a(n))throw Error(i(299));var h=!1,g="",b=sy,T=ay,L=ry,q=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(L=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),s=Ib(n,1,!0,s,o??null,h,g,q,b,T,L,Qb),s.context=Ub(null),o=s.current,h=_i(),h=Sl(h),g=Ia(h),g.callback=null,Ua(o,g,h),o=h,s.current.lanes=o,Oi(s,o),vs(s),n[Zn]=s.current,$f(n),new ph(s)},Sc.version="19.2.4",Sc}var c0;function P1(){if(c0)return gp.exports;c0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),gp.exports=L1(),gp.exports}var B1=P1();var u0="popstate";function j1(r={}){function t(i,a){let{pathname:l,search:c,hash:u}=i.location;return Bp("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(i,a){return typeof a=="string"?a:jc(a)}return I1(t,e,null,r)}function We(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function es(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function F1(){return Math.random().toString(36).substring(2,10)}function h0(r,t){return{usr:r.state,key:r.key,idx:t}}function Bp(r,t,e=null,i){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?ml(t):t,state:e,key:t&&t.key||i||F1()}}function jc({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function ml(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let i=r.indexOf("?");i>=0&&(t.search=r.substring(i),r=r.substring(0,i)),r&&(t.pathname=r)}return t}function I1(r,t,e,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,u="POP",d=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function y(){u="POP";let C=p(),M=C==null?null:C-f;f=C,d&&d({action:u,location:A.location,delta:M})}function w(C,M){u="PUSH";let N=Bp(A.location,C,M);f=p()+1;let k=h0(N,f),j=A.createHref(N);try{c.pushState(k,"",j)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(j)}l&&d&&d({action:u,location:A.location,delta:1})}function S(C,M){u="REPLACE";let N=Bp(A.location,C,M);f=p();let k=h0(N,f),j=A.createHref(N);c.replaceState(k,"",j),l&&d&&d({action:u,location:A.location,delta:0})}function _(C){return U1(C)}let A={get action(){return u},get location(){return r(a,c)},listen(C){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(u0,y),d=C,()=>{a.removeEventListener(u0,y),d=null}},createHref(C){return t(a,C)},createURL:_,encodeLocation(C){let M=_(C);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:w,replace:S,go(C){return c.go(C)}};return A}function U1(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),We(e,"No window.location.(origin|href) available to create URL");let i=typeof r=="string"?r:jc(r);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function Rv(r,t,e="/"){return z1(r,t,e,!1)}function z1(r,t,e,i){let a=typeof t=="string"?ml(t):t,l=ga(a.pathname||"/",e);if(l==null)return null;let c=Mv(r);H1(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let f=J1(l);u=W1(c[d],f,i)}return u}function Mv(r,t=[],e=[],i="",a=!1){let l=(c,u,d=a,f)=>{let p={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(i)&&d)return;We(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length)}let y=fa([i,p.relativePath]),w=e.concat(p);c.children&&c.children.length>0&&(We(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),Mv(c.children,t,w,y,d)),!(c.path==null&&!c.index)&&t.push({path:y,score:Y1(y,c.index),routesMeta:w})};return r.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let d of Dv(c.path))l(c,u,!0,d)}),t}function Dv(r){let t=r.split("/");if(t.length===0)return[];let[e,...i]=t,a=e.endsWith("?"),l=e.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=Dv(i.join("/")),u=[];return u.push(...c.map(d=>d===""?l:[l,d].join("/"))),a&&u.push(...c),u.map(d=>r.startsWith("/")&&d===""?"/":d)}function H1(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:Q1(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var q1=/^:[\w-]+$/,G1=3,V1=2,K1=1,$1=10,X1=-2,d0=r=>r==="*";function Y1(r,t){let e=r.split("/"),i=e.length;return e.some(d0)&&(i+=X1),t&&(i+=V1),e.filter(a=>!d0(a)).reduce((a,l)=>a+(q1.test(l)?G1:l===""?K1:$1),i)}function Q1(r,t){return r.length===t.length&&r.slice(0,-1).every((i,a)=>i===t[a])?r[r.length-1]-t[t.length-1]:0}function W1(r,t,e=!1){let{routesMeta:i}=r,a={},l="/",c=[];for(let u=0;u<i.length;++u){let d=i[u],f=u===i.length-1,p=l==="/"?t:t.slice(l.length)||"/",y=zh({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},p),w=d.route;if(!y&&f&&e&&!i[i.length-1].route.index&&(y=zh({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!y)return null;Object.assign(a,y.params),c.push({params:a,pathname:fa([l,y.pathname]),pathnameBase:iS(fa([l,y.pathnameBase])),route:w}),y.pathnameBase!=="/"&&(l=fa([l,y.pathnameBase]))}return c}function zh(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,i]=Z1(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:i.reduce((f,{paramName:p,isOptional:y},w)=>{if(p==="*"){let _=u[w]||"";c=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const S=u[w];return y&&!S?f[p]=void 0:f[p]=(S||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:r}}function Z1(r,t=!1,e=!0){es(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let i=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(i.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function J1(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return es(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function ga(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=r.charAt(e);return i&&i!=="/"?null:r.slice(e)||"/"}var tS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function eS(r,t="/"){let{pathname:e,search:i="",hash:a=""}=typeof r=="string"?ml(r):r,l;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?l=f0(e.substring(1),"/"):l=f0(e,t)):l=t,{pathname:l,search:sS(i),hash:aS(a)}}function f0(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function wp(r,t,e,i){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function nS(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function pm(r){let t=nS(r);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function mm(r,t,e,i=!1){let a;typeof r=="string"?a=ml(r):(a={...r},We(!a.pathname||!a.pathname.includes("?"),wp("?","pathname","search",a)),We(!a.pathname||!a.pathname.includes("#"),wp("#","pathname","hash",a)),We(!a.search||!a.search.includes("#"),wp("#","search","hash",a)));let l=r===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=e;else{let y=t.length-1;if(!i&&c.startsWith("..")){let w=c.split("/");for(;w[0]==="..";)w.shift(),y-=1;a.pathname=w.join("/")}u=y>=0?t[y]:"/"}let d=eS(a,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||p)&&(d.pathname+="/"),d}var fa=r=>r.join("/").replace(/\/\/+/g,"/"),iS=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),sS=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,aS=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,rS=class{constructor(r,t,e,i=!1){this.status=r,this.statusText=t||"",this.internal=i,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function oS(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function lS(r){return r.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Ov=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Nv(r,t){let e=r;if(typeof e!="string"||!tS.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let i=e,a=!1;if(Ov)try{let l=new URL(window.location.href),c=e.startsWith("//")?new URL(l.protocol+e):new URL(e),u=ga(c.pathname,t);c.origin===l.origin&&u!=null?e=u+c.search+c.hash:a=!0}catch{es(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var kv=["POST","PUT","PATCH","DELETE"];new Set(kv);var cS=["GET",...kv];new Set(cS);var gl=I.createContext(null);gl.displayName="DataRouter";var Zh=I.createContext(null);Zh.displayName="DataRouterState";var uS=I.createContext(!1),Lv=I.createContext({isTransitioning:!1});Lv.displayName="ViewTransition";var hS=I.createContext(new Map);hS.displayName="Fetchers";var dS=I.createContext(null);dS.displayName="Await";var Mi=I.createContext(null);Mi.displayName="Navigation";var Gc=I.createContext(null);Gc.displayName="Location";var ns=I.createContext({outlet:null,matches:[],isDataRoute:!1});ns.displayName="Route";var gm=I.createContext(null);gm.displayName="RouteError";var Pv="REACT_ROUTER_ERROR",fS="REDIRECT",pS="ROUTE_ERROR_RESPONSE";function mS(r){if(r.startsWith(`${Pv}:${fS}:{`))try{let t=JSON.parse(r.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function gS(r){if(r.startsWith(`${Pv}:${pS}:{`))try{let t=JSON.parse(r.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new rS(t.status,t.statusText,t.data)}catch{}}function yS(r,{relative:t}={}){We(yl(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=I.useContext(Mi),{hash:a,pathname:l,search:c}=Vc(r,{relative:t}),u=l;return e!=="/"&&(u=l==="/"?e:fa([e,l])),i.createHref({pathname:u,search:c,hash:a})}function yl(){return I.useContext(Gc)!=null}function lr(){return We(yl(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Gc).location}var Bv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function jv(r){I.useContext(Mi).static||I.useLayoutEffect(r)}function ya(){let{isDataRoute:r}=I.useContext(ns);return r?DS():bS()}function bS(){We(yl(),"useNavigate() may be used only in the context of a <Router> component.");let r=I.useContext(gl),{basename:t,navigator:e}=I.useContext(Mi),{matches:i}=I.useContext(ns),{pathname:a}=lr(),l=JSON.stringify(pm(i)),c=I.useRef(!1);return jv(()=>{c.current=!0}),I.useCallback((d,f={})=>{if(es(c.current,Bv),!c.current)return;if(typeof d=="number"){e.go(d);return}let p=mm(d,JSON.parse(l),a,f.relative==="path");r==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:fa([t,p.pathname])),(f.replace?e.replace:e.push)(p,f.state,f)},[t,e,l,a,r])}I.createContext(null);function ym(){let{matches:r}=I.useContext(ns),t=r[r.length-1];return t?t.params:{}}function Vc(r,{relative:t}={}){let{matches:e}=I.useContext(ns),{pathname:i}=lr(),a=JSON.stringify(pm(e));return I.useMemo(()=>mm(r,JSON.parse(a),i,t==="path"),[r,a,i,t])}function vS(r,t){return Fv(r,t)}function Fv(r,t,e,i,a){We(yl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=I.useContext(Mi),{matches:c}=I.useContext(ns),u=c[c.length-1],d=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",y=u&&u.route;{let N=y&&y.path||"";Uv(f,!y||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let w=lr(),S;if(t){let N=typeof t=="string"?ml(t):t;We(p==="/"||N.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${N.pathname}" was given in the \`location\` prop.`),S=N}else S=w;let _=S.pathname||"/",A=_;if(p!=="/"){let N=p.replace(/^\//,"").split("/");A="/"+_.replace(/^\//,"").split("/").slice(N.length).join("/")}let C=Rv(r,{pathname:A});es(y||C!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),es(C==null||C[C.length-1].route.element!==void 0||C[C.length-1].route.Component!==void 0||C[C.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let M=ES(C&&C.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:fa([p,l.encodeLocation?l.encodeLocation(N.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?p:fa([p,l.encodeLocation?l.encodeLocation(N.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathnameBase])})),c,e,i,a);return t&&M?I.createElement(Gc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},M):M}function wS(){let r=MS(),t=oS(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",r),c=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:l},"ErrorBoundary")," or"," ",I.createElement("code",{style:l},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),e?I.createElement("pre",{style:a},e):null,c)}var xS=I.createElement(wS,null),Iv=class extends I.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.onError?this.props.onError(r,t):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const e=gS(r.digest);e&&(r=e)}let t=r!==void 0?I.createElement(ns.Provider,{value:this.props.routeContext},I.createElement(gm.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?I.createElement(SS,{error:r},t):t}};Iv.contextType=uS;var xp=new WeakMap;function SS({children:r,error:t}){let{basename:e}=I.useContext(Mi);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=mS(t.digest);if(i){let a=xp.get(t);if(a)throw a;let l=Nv(i.location,e);if(Ov&&!xp.get(t))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw xp.set(t,c),c}return I.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return r}function AS({routeContext:r,match:t,children:e}){let i=I.useContext(gl);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),I.createElement(ns.Provider,{value:r},e)}function ES(r,t=[],e=null,i=null,a=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let l=r,c=e?.errors;if(c!=null){let p=l.findIndex(y=>y.route.id&&c?.[y.route.id]!==void 0);We(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,p+1))}let u=!1,d=-1;if(e)for(let p=0;p<l.length;p++){let y=l[p];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=p),y.route.id){let{loaderData:w,errors:S}=e,_=y.route.loader&&!w.hasOwnProperty(y.route.id)&&(!S||S[y.route.id]===void 0);if(y.route.lazy||_){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}let f=e&&i?(p,y)=>{i(p,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:lS(e.matches),errorInfo:y})}:void 0;return l.reduceRight((p,y,w)=>{let S,_=!1,A=null,C=null;e&&(S=c&&y.route.id?c[y.route.id]:void 0,A=y.route.errorElement||xS,u&&(d<0&&w===0?(Uv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,C=null):d===w&&(_=!0,C=y.route.hydrateFallbackElement||null)));let M=t.concat(l.slice(0,w+1)),N=()=>{let k;return S?k=A:_?k=C:y.route.Component?k=I.createElement(y.route.Component,null):y.route.element?k=y.route.element:k=p,I.createElement(AS,{match:y,routeContext:{outlet:p,matches:M,isDataRoute:e!=null},children:k})};return e&&(y.route.ErrorBoundary||y.route.errorElement||w===0)?I.createElement(Iv,{location:e.location,revalidation:e.revalidation,component:A,error:S,children:N(),routeContext:{outlet:null,matches:M,isDataRoute:!0},onError:f}):N()},null)}function bm(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function _S(r){let t=I.useContext(gl);return We(t,bm(r)),t}function CS(r){let t=I.useContext(Zh);return We(t,bm(r)),t}function TS(r){let t=I.useContext(ns);return We(t,bm(r)),t}function vm(r){let t=TS(r),e=t.matches[t.matches.length-1];return We(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function RS(){return vm("useRouteId")}function MS(){let r=I.useContext(gm),t=CS("useRouteError"),e=vm("useRouteError");return r!==void 0?r:t.errors?.[e]}function DS(){let{router:r}=_S("useNavigate"),t=vm("useNavigate"),e=I.useRef(!1);return jv(()=>{e.current=!0}),I.useCallback(async(a,l={})=>{es(e.current,Bv),e.current&&(typeof a=="number"?await r.navigate(a):await r.navigate(a,{fromRouteId:t,...l}))},[r,t])}var p0={};function Uv(r,t,e){!t&&!p0[r]&&(p0[r]=!0,es(!1,e))}I.memo(OS);function OS({routes:r,future:t,state:e,onError:i}){return Fv(r,void 0,e,i,t)}function Hh({to:r,replace:t,state:e,relative:i}){We(yl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=I.useContext(Mi);es(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=I.useContext(ns),{pathname:c}=lr(),u=ya(),d=mm(r,pm(l),c,i==="path"),f=JSON.stringify(d);return I.useEffect(()=>{u(JSON.parse(f),{replace:t,state:e,relative:i})},[u,f,i,t,e]),null}function _s(r){We(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function NS({basename:r="/",children:t=null,location:e,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){We(!yl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=r.replace(/^\/*/,"/"),d=I.useMemo(()=>({basename:u,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[u,a,l,c]);typeof e=="string"&&(e=ml(e));let{pathname:f="/",search:p="",hash:y="",state:w=null,key:S="default"}=e,_=I.useMemo(()=>{let A=ga(f,u);return A==null?null:{location:{pathname:A,search:p,hash:y,state:w,key:S},navigationType:i}},[u,f,p,y,w,S,i]);return es(_!=null,`<Router basename="${u}"> is not able to match the URL "${f}${p}${y}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:I.createElement(Mi.Provider,{value:d},I.createElement(Gc.Provider,{children:t,value:_}))}function kS({children:r,location:t}){return vS(jp(r),t)}function jp(r,t=[]){let e=[];return I.Children.forEach(r,(i,a)=>{if(!I.isValidElement(i))return;let l=[...t,a];if(i.type===I.Fragment){e.push.apply(e,jp(i.props.children,l));return}We(i.type===_s,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),We(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=jp(i.props.children,l)),e.push(c)}),e}var Nh="get",kh="application/x-www-form-urlencoded";function Jh(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function LS(r){return Jh(r)&&r.tagName.toLowerCase()==="button"}function PS(r){return Jh(r)&&r.tagName.toLowerCase()==="form"}function BS(r){return Jh(r)&&r.tagName.toLowerCase()==="input"}function jS(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function FS(r,t){return r.button===0&&(!t||t==="_self")&&!jS(r)}var yh=null;function IS(){if(yh===null)try{new FormData(document.createElement("form"),0),yh=!1}catch{yh=!0}return yh}var US=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Sp(r){return r!=null&&!US.has(r)?(es(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${kh}"`),null):r}function zS(r,t){let e,i,a,l,c;if(PS(r)){let u=r.getAttribute("action");i=u?ga(u,t):null,e=r.getAttribute("method")||Nh,a=Sp(r.getAttribute("enctype"))||kh,l=new FormData(r)}else if(LS(r)||BS(r)&&(r.type==="submit"||r.type==="image")){let u=r.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=r.getAttribute("formaction")||u.getAttribute("action");if(i=d?ga(d,t):null,e=r.getAttribute("formmethod")||u.getAttribute("method")||Nh,a=Sp(r.getAttribute("formenctype"))||Sp(u.getAttribute("enctype"))||kh,l=new FormData(u,r),!IS()){let{name:f,type:p,value:y}=r;if(p==="image"){let w=f?`${f}.`:"";l.append(`${w}x`,"0"),l.append(`${w}y`,"0")}else f&&l.append(f,y)}}else{if(Jh(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Nh,i=null,a=kh,c=r}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:e.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function wm(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function HS(r,t,e,i){let a=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${i}`:a.pathname=`${a.pathname}.${i}`:a.pathname==="/"?a.pathname=`_root.${i}`:t&&ga(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function qS(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function GS(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function VS(r,t,e){let i=await Promise.all(r.map(async a=>{let l=t.routes[a.route.id];if(l){let c=await qS(l,e);return c.links?c.links():[]}return[]}));return YS(i.flat(1).filter(GS).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function m0(r,t,e,i,a,l){let c=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return l==="assets"?t.filter((d,f)=>c(d,f)||u(d,f)):l==="data"?t.filter((d,f)=>{let p=i.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(c(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function KS(r,t,{includeHydrateFallback:e}={}){return $S(r.map(i=>{let a=t.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function $S(r){return[...new Set(r)]}function XS(r){let t={},e=Object.keys(r).sort();for(let i of e)t[i]=r[i];return t}function YS(r,t){let e=new Set;return new Set(t),r.reduce((i,a)=>{let l=JSON.stringify(XS(a));return e.has(l)||(e.add(l),i.push({key:l,link:a})),i},[])}function zv(){let r=I.useContext(gl);return wm(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function QS(){let r=I.useContext(Zh);return wm(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var xm=I.createContext(void 0);xm.displayName="FrameworkContext";function Hv(){let r=I.useContext(xm);return wm(r,"You must render this element inside a <HydratedRouter> element"),r}function WS(r,t){let e=I.useContext(xm),[i,a]=I.useState(!1),[l,c]=I.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:p,onTouchStart:y}=t,w=I.useRef(null);I.useEffect(()=>{if(r==="render"&&c(!0),r==="viewport"){let A=M=>{M.forEach(N=>{c(N.isIntersecting)})},C=new IntersectionObserver(A,{threshold:.5});return w.current&&C.observe(w.current),()=>{C.disconnect()}}},[r]),I.useEffect(()=>{if(i){let A=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(A)}}},[i]);let S=()=>{a(!0)},_=()=>{a(!1),c(!1)};return e?r!=="intent"?[l,w,{}]:[l,w,{onFocus:Ac(u,S),onBlur:Ac(d,_),onMouseEnter:Ac(f,S),onMouseLeave:Ac(p,_),onTouchStart:Ac(y,S)}]:[!1,w,{}]}function Ac(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function ZS({page:r,...t}){let{router:e}=zv(),i=I.useMemo(()=>Rv(e.routes,r,e.basename),[e.routes,r,e.basename]);return i?I.createElement(tA,{page:r,matches:i,...t}):null}function JS(r){let{manifest:t,routeModules:e}=Hv(),[i,a]=I.useState([]);return I.useEffect(()=>{let l=!1;return VS(r,t,e).then(c=>{l||a(c)}),()=>{l=!0}},[r,t,e]),i}function tA({page:r,matches:t,...e}){let i=lr(),{future:a,manifest:l,routeModules:c}=Hv(),{basename:u}=zv(),{loaderData:d,matches:f}=QS(),p=I.useMemo(()=>m0(r,t,f,l,i,"data"),[r,t,f,l,i]),y=I.useMemo(()=>m0(r,t,f,l,i,"assets"),[r,t,f,l,i]),w=I.useMemo(()=>{if(r===i.pathname+i.search+i.hash)return[];let A=new Set,C=!1;if(t.forEach(N=>{let k=l.routes[N.route.id];!k||!k.hasLoader||(!p.some(j=>j.route.id===N.route.id)&&N.route.id in d&&c[N.route.id]?.shouldRevalidate||k.hasClientLoader?C=!0:A.add(N.route.id))}),A.size===0)return[];let M=HS(r,u,a.unstable_trailingSlashAwareDataRequests,"data");return C&&A.size>0&&M.searchParams.set("_routes",t.filter(N=>A.has(N.route.id)).map(N=>N.route.id).join(",")),[M.pathname+M.search]},[u,a.unstable_trailingSlashAwareDataRequests,d,i,l,p,t,r,c]),S=I.useMemo(()=>KS(y,l),[y,l]),_=JS(y);return I.createElement(I.Fragment,null,w.map(A=>I.createElement("link",{key:A,rel:"prefetch",as:"fetch",href:A,...e})),S.map(A=>I.createElement("link",{key:A,rel:"modulepreload",href:A,...e})),_.map(({key:A,link:C})=>I.createElement("link",{key:A,nonce:e.nonce,...C,crossOrigin:C.crossOrigin??e.crossOrigin})))}function eA(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var nA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{nA&&(window.__reactRouterVersion="7.13.0")}catch{}function iA({basename:r,children:t,unstable_useTransitions:e,window:i}){let a=I.useRef();a.current==null&&(a.current=j1({window:i,v5Compat:!0}));let l=a.current,[c,u]=I.useState({action:l.action,location:l.location}),d=I.useCallback(f=>{e===!1?u(f):I.startTransition(()=>u(f))},[e]);return I.useLayoutEffect(()=>l.listen(d),[l,d]),I.createElement(NS,{basename:r,children:t,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:e})}var qv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,td=I.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:u,target:d,to:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w,...S},_){let{basename:A,unstable_useTransitions:C}=I.useContext(Mi),M=typeof f=="string"&&qv.test(f),N=Nv(f,A);f=N.to;let k=yS(f,{relative:a}),[j,F,z]=WS(i,S),H=oA(f,{replace:c,state:u,target:d,preventScrollReset:p,relative:a,viewTransition:y,unstable_defaultShouldRevalidate:w,unstable_useTransitions:C});function ct(Tt){t&&t(Tt),Tt.defaultPrevented||H(Tt)}let dt=I.createElement("a",{...S,...z,href:N.absoluteURL||k,onClick:N.isExternal||l?t:ct,ref:eA(_,F),target:d,"data-discover":!M&&e==="render"?"true":void 0});return j&&!M?I.createElement(I.Fragment,null,dt,I.createElement(ZS,{page:k})):dt});td.displayName="Link";var sA=I.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:u,children:d,...f},p){let y=Vc(c,{relative:f.relative}),w=lr(),S=I.useContext(Zh),{navigator:_,basename:A}=I.useContext(Mi),C=S!=null&&dA(y)&&u===!0,M=_.encodeLocation?_.encodeLocation(y).pathname:y.pathname,N=w.pathname,k=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;e||(N=N.toLowerCase(),k=k?k.toLowerCase():null,M=M.toLowerCase()),k&&A&&(k=ga(k,A)||k);const j=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let F=N===M||!a&&N.startsWith(M)&&N.charAt(j)==="/",z=k!=null&&(k===M||!a&&k.startsWith(M)&&k.charAt(M.length)==="/"),H={isActive:F,isPending:z,isTransitioning:C},ct=F?t:void 0,dt;typeof i=="function"?dt=i(H):dt=[i,F?"active":null,z?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let Tt=typeof l=="function"?l(H):l;return I.createElement(td,{...f,"aria-current":ct,className:dt,ref:p,style:Tt,to:c,viewTransition:u},typeof d=="function"?d(H):d)});sA.displayName="NavLink";var aA=I.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:a,state:l,method:c=Nh,action:u,onSubmit:d,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w,...S},_)=>{let{unstable_useTransitions:A}=I.useContext(Mi),C=uA(),M=hA(u,{relative:f}),N=c.toLowerCase()==="get"?"get":"post",k=typeof u=="string"&&qv.test(u),j=F=>{if(d&&d(F),F.defaultPrevented)return;F.preventDefault();let z=F.nativeEvent.submitter,H=z?.getAttribute("formmethod")||c,ct=()=>C(z||F.currentTarget,{fetcherKey:t,method:H,navigate:e,replace:a,state:l,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w});A&&e!==!1?I.startTransition(()=>ct()):ct()};return I.createElement("form",{ref:_,method:N,action:M,onSubmit:i?d:j,...S,"data-discover":!k&&r==="render"?"true":void 0})});aA.displayName="Form";function rA(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Gv(r){let t=I.useContext(gl);return We(t,rA(r)),t}function oA(r,{target:t,replace:e,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let f=ya(),p=lr(),y=Vc(r,{relative:l});return I.useCallback(w=>{if(FS(w,t)){w.preventDefault();let S=e!==void 0?e:jc(p)===jc(y),_=()=>f(r,{replace:S,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u});d?I.startTransition(()=>_()):_()}},[p,f,y,e,i,t,r,a,l,c,u,d])}var lA=0,cA=()=>`__${String(++lA)}__`;function uA(){let{router:r}=Gv("useSubmit"),{basename:t}=I.useContext(Mi),e=RS(),i=r.fetch,a=r.navigate;return I.useCallback(async(l,c={})=>{let{action:u,method:d,encType:f,formData:p,body:y}=zS(l,t);if(c.navigate===!1){let w=c.fetcherKey||cA();await i(w,e,c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,flushSync:c.flushSync})}else await a(c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:e,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,t,e])}function hA(r,{relative:t}={}){let{basename:e}=I.useContext(Mi),i=I.useContext(ns);We(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...Vc(r||".",{relative:t})},c=lr();if(r==null){l.search=c.search;let u=new URLSearchParams(l.search),d=u.getAll("index");if(d.some(p=>p==="")){u.delete("index"),d.filter(y=>y).forEach(y=>u.append("index",y));let p=u.toString();l.search=p?`?${p}`:""}}return(!r||r===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(l.pathname=l.pathname==="/"?e:fa([e,l.pathname])),jc(l)}function dA(r,{relative:t}={}){let e=I.useContext(Lv);We(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Gv("useViewTransitionState"),a=Vc(r,{relative:t});if(!e.isTransitioning)return!1;let l=ga(e.currentLocation.pathname,i)||e.currentLocation.pathname,c=ga(e.nextLocation.pathname,i)||e.nextLocation.pathname;return zh(a.pathname,c)!=null||zh(a.pathname,l)!=null}var fA=Tv(),bl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},pA={setTimeout:(r,t)=>setTimeout(r,t),clearTimeout:r=>clearTimeout(r),setInterval:(r,t)=>setInterval(r,t),clearInterval:r=>clearInterval(r)},mA=class{#t=pA;#e=!1;setTimeoutProvider(r){this.#t=r}setTimeout(r,t){return this.#t.setTimeout(r,t)}clearTimeout(r){this.#t.clearTimeout(r)}setInterval(r,t){return this.#t.setInterval(r,t)}clearInterval(r){this.#t.clearInterval(r)}},qr=new mA;function gA(r){setTimeout(r,0)}var Wr=typeof window>"u"||"Deno"in globalThis;function ni(){}function yA(r,t){return typeof r=="function"?r(t):r}function Fp(r){return typeof r=="number"&&r>=0&&r!==1/0}function Vv(r,t){return Math.max(r+(t||0)-Date.now(),0)}function ar(r,t){return typeof r=="function"?r(t):r}function Ki(r,t){return typeof r=="function"?r(t):r}function g0(r,t){const{type:e="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:u}=r;if(c){if(i){if(t.queryHash!==Sm(c,t.options))return!1}else if(!Fc(t.queryKey,c))return!1}if(e!=="all"){const d=t.isActive();if(e==="active"&&!d||e==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||a&&a!==t.state.fetchStatus||l&&!l(t))}function y0(r,t){const{exact:e,status:i,predicate:a,mutationKey:l}=r;if(l){if(!t.options.mutationKey)return!1;if(e){if(Zr(t.options.mutationKey)!==Zr(l))return!1}else if(!Fc(t.options.mutationKey,l))return!1}return!(i&&t.state.status!==i||a&&!a(t))}function Sm(r,t){return(t?.queryKeyHashFn||Zr)(r)}function Zr(r){return JSON.stringify(r,(t,e)=>Ip(e)?Object.keys(e).sort().reduce((i,a)=>(i[a]=e[a],i),{}):e)}function Fc(r,t){return r===t?!0:typeof r!=typeof t?!1:r&&t&&typeof r=="object"&&typeof t=="object"?Object.keys(t).every(e=>Fc(r[e],t[e])):!1}var bA=Object.prototype.hasOwnProperty;function Kv(r,t,e=0){if(r===t)return r;if(e>500)return t;const i=b0(r)&&b0(t);if(!i&&!(Ip(r)&&Ip(t)))return t;const l=(i?r:Object.keys(r)).length,c=i?t:Object.keys(t),u=c.length,d=i?new Array(u):{};let f=0;for(let p=0;p<u;p++){const y=i?p:c[p],w=r[y],S=t[y];if(w===S){d[y]=w,(i?p<l:bA.call(r,y))&&f++;continue}if(w===null||S===null||typeof w!="object"||typeof S!="object"){d[y]=S;continue}const _=Kv(w,S,e+1);d[y]=_,_===w&&f++}return l===u&&f===l?r:d}function qh(r,t){if(!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}function b0(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Ip(r){if(!v0(r))return!1;const t=r.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!v0(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function v0(r){return Object.prototype.toString.call(r)==="[object Object]"}function vA(r){return new Promise(t=>{qr.setTimeout(t,r)})}function Up(r,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(r,t):e.structuralSharing!==!1?Kv(r,t):t}function wA(r,t,e=0){const i=[...r,t];return e&&i.length>e?i.slice(1):i}function xA(r,t,e=0){const i=[t,...r];return e&&i.length>e?i.slice(0,-1):i}var Am=Symbol();function $v(r,t){return!r.queryFn&&t?.initialPromise?()=>t.initialPromise:!r.queryFn||r.queryFn===Am?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function Em(r,t){return typeof r=="function"?r(...t):!!r}function SA(r,t,e){let i=!1,a;return Object.defineProperty(r,"signal",{enumerable:!0,get:()=>(a??=t(),i||(i=!0,a.aborted?e():a.addEventListener("abort",e,{once:!0})),a)}),r}var AA=class extends bl{#t;#e;#i;constructor(){super(),this.#i=r=>{if(!Wr&&window.addEventListener){const t=()=>r();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(r){this.#i=r,this.#e?.(),this.#e=r(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(r){this.#t!==r&&(this.#t=r,this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(t=>{t(r)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},_m=new AA;function zp(){let r,t;const e=new Promise((a,l)=>{r=a,t=l});e.status="pending",e.catch(()=>{});function i(a){Object.assign(e,a),delete e.resolve,delete e.reject}return e.resolve=a=>{i({status:"fulfilled",value:a}),r(a)},e.reject=a=>{i({status:"rejected",reason:a}),t(a)},e}var EA=gA;function _A(){let r=[],t=0,e=u=>{u()},i=u=>{u()},a=EA;const l=u=>{t?r.push(u):a(()=>{e(u)})},c=()=>{const u=r;r=[],u.length&&a(()=>{i(()=>{u.forEach(d=>{e(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{l(()=>{u(...d)})},schedule:l,setNotifyFunction:u=>{e=u},setBatchNotifyFunction:u=>{i=u},setScheduler:u=>{a=u}}}var xn=_A(),CA=class extends bl{#t=!0;#e;#i;constructor(){super(),this.#i=r=>{if(!Wr&&window.addEventListener){const t=()=>r(!0),e=()=>r(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",e,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(r){this.#i=r,this.#e?.(),this.#e=r(this.setOnline.bind(this))}setOnline(r){this.#t!==r&&(this.#t=r,this.listeners.forEach(e=>{e(r)}))}isOnline(){return this.#t}},Gh=new CA;function TA(r){return Math.min(1e3*2**r,3e4)}function Xv(r){return(r??"online")==="online"?Gh.isOnline():!0}var Hp=class extends Error{constructor(r){super("CancelledError"),this.revert=r?.revert,this.silent=r?.silent}};function Yv(r){let t=!1,e=0,i;const a=zp(),l=()=>a.status!=="pending",c=A=>{if(!l()){const C=new Hp(A);w(C),r.onCancel?.(C)}},u=()=>{t=!0},d=()=>{t=!1},f=()=>_m.isFocused()&&(r.networkMode==="always"||Gh.isOnline())&&r.canRun(),p=()=>Xv(r.networkMode)&&r.canRun(),y=A=>{l()||(i?.(),a.resolve(A))},w=A=>{l()||(i?.(),a.reject(A))},S=()=>new Promise(A=>{i=C=>{(l()||f())&&A(C)},r.onPause?.()}).then(()=>{i=void 0,l()||r.onContinue?.()}),_=()=>{if(l())return;let A;const C=e===0?r.initialPromise:void 0;try{A=C??r.fn()}catch(M){A=Promise.reject(M)}Promise.resolve(A).then(y).catch(M=>{if(l())return;const N=r.retry??(Wr?0:3),k=r.retryDelay??TA,j=typeof k=="function"?k(e,M):k,F=N===!0||typeof N=="number"&&e<N||typeof N=="function"&&N(e,M);if(t||!F){w(M);return}e++,r.onFail?.(e,M),vA(j).then(()=>f()?void 0:S()).then(()=>{t?w(M):_()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:u,continueRetry:d,canStart:p,start:()=>(p()?_():S().then(_),a)}}var Qv=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Fp(this.gcTime)&&(this.#t=qr.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Wr?1/0:300*1e3))}clearGcTimeout(){this.#t&&(qr.clearTimeout(this.#t),this.#t=void 0)}},RA=class extends Qv{#t;#e;#i;#n;#s;#r;#a;constructor(r){super(),this.#a=!1,this.#r=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.#n=r.client,this.#i=this.#n.getQueryCache(),this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.#t=x0(this.options),this.state=r.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(r){if(this.options={...this.#r,...r},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=x0(this.options);t.data!==void 0&&(this.setState(w0(t.data,t.dataUpdatedAt)),this.#t=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#i.remove(this)}setData(r,t){const e=Up(this.state.data,r,this.options);return this.#o({data:e,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),e}setState(r,t){this.#o({type:"setState",state:r,setStateOptions:t})}cancel(r){const t=this.#s?.promise;return this.#s?.cancel(r),t?t.then(ni).catch(ni):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(r=>Ki(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Am||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>ar(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!Vv(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(t=>t!==r),this.observers.length||(this.#s&&(this.#a?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#i.notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#o({type:"invalidate"})}async fetch(r,t){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(r&&this.setOptions(r),!this.options.queryFn){const u=this.observers.find(d=>d.options.queryFn);u&&this.setOptions(u.options)}const e=new AbortController,i=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(this.#a=!0,e.signal)})},a=()=>{const u=$v(this.options,t),f=(()=>{const p={client:this.#n,queryKey:this.queryKey,meta:this.meta};return i(p),p})();return this.#a=!1,this.options.persister?this.options.persister(u,f,this):u(f)},c=(()=>{const u={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:a};return i(u),u})();this.options.behavior?.onFetch(c,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&this.#o({type:"fetch",meta:c.fetchOptions?.meta}),this.#s=Yv({initialPromise:t?.initialPromise,fn:c.fetchFn,onCancel:u=>{u instanceof Hp&&u.revert&&this.setState({...this.#e,fetchStatus:"idle"}),e.abort()},onFail:(u,d)=>{this.#o({type:"failed",failureCount:u,error:d})},onPause:()=>{this.#o({type:"pause"})},onContinue:()=>{this.#o({type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0});try{const u=await this.#s.start();if(u===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(u),this.#i.config.onSuccess?.(u,this),this.#i.config.onSettled?.(u,this.state.error,this),u}catch(u){if(u instanceof Hp){if(u.silent)return this.#s.promise;if(u.revert){if(this.state.data===void 0)throw u;return this.state.data}}throw this.#o({type:"error",error:u}),this.#i.config.onError?.(u,this),this.#i.config.onSettled?.(this.state.data,u,this),u}finally{this.scheduleGc()}}#o(r){const t=e=>{switch(r.type){case"failed":return{...e,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...e,fetchStatus:"paused"};case"continue":return{...e,fetchStatus:"fetching"};case"fetch":return{...e,...Wv(e.data,this.options),fetchMeta:r.meta??null};case"success":const i={...e,...w0(r.data,r.dataUpdatedAt),dataUpdateCount:e.dataUpdateCount+1,...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=r.manual?i:void 0,i;case"error":const a=r.error;return{...e,error:a,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...e,isInvalidated:!0};case"setState":return{...e,...r.state}}};this.state=t(this.state),xn.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#i.notify({query:this,type:"updated",action:r})})}};function Wv(r,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Xv(t.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function w0(r,t){return{data:r,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function x0(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=t!==void 0,i=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var MA=class extends bl{constructor(r,t){super(),this.options=t,this.#t=r,this.#o=null,this.#a=zp(),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#i=void 0;#n=void 0;#s;#r;#a;#o;#c;#l;#d;#h;#f;#g;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),S0(this.#e,this.options)?this.#u():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return qp(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return qp(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#E(),this.#A(),this.#e.removeObserver(this)}setOptions(r){const t=this.options,e=this.#e;if(this.options=this.#t.defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Ki(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#e.setOptions(this.options),t._defaulted&&!qh(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const i=this.hasListeners();i&&A0(this.#e,e,this.options,t)&&this.#u(),this.updateResult(),i&&(this.#e!==e||Ki(this.options.enabled,this.#e)!==Ki(t.enabled,this.#e)||ar(this.options.staleTime,this.#e)!==ar(t.staleTime,this.#e))&&this.#p();const a=this.#y();i&&(this.#e!==e||Ki(this.options.enabled,this.#e)!==Ki(t.enabled,this.#e)||a!==this.#g)&&this.#v(a)}getOptimisticResult(r){const t=this.#t.getQueryCache().build(this.#t,r),e=this.createResult(t,r);return OA(this,e)&&(this.#n=e,this.#r=this.options,this.#s=this.#e.state),e}getCurrentResult(){return this.#n}trackResult(r,t){return new Proxy(r,{get:(e,i)=>(this.trackProp(i),t?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,i))})}trackProp(r){this.#m.add(r)}getCurrentQuery(){return this.#e}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const t=this.#t.defaultQueryOptions(r),e=this.#t.getQueryCache().build(this.#t,t);return e.fetch().then(()=>this.createResult(e,t))}fetch(r){return this.#u({...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#u(r){this.#w();let t=this.#e.fetch(this.options,r);return r?.throwOnError||(t=t.catch(ni)),t}#p(){this.#E();const r=ar(this.options.staleTime,this.#e);if(Wr||this.#n.isStale||!Fp(r))return;const e=Vv(this.#n.dataUpdatedAt,r)+1;this.#h=qr.setTimeout(()=>{this.#n.isStale||this.updateResult()},e)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#v(r){this.#A(),this.#g=r,!(Wr||Ki(this.options.enabled,this.#e)===!1||!Fp(this.#g)||this.#g===0)&&(this.#f=qr.setInterval(()=>{(this.options.refetchIntervalInBackground||_m.isFocused())&&this.#u()},this.#g))}#b(){this.#p(),this.#v(this.#y())}#E(){this.#h&&(qr.clearTimeout(this.#h),this.#h=void 0)}#A(){this.#f&&(qr.clearInterval(this.#f),this.#f=void 0)}createResult(r,t){const e=this.#e,i=this.options,a=this.#n,l=this.#s,c=this.#r,d=r!==e?r.state:this.#i,{state:f}=r;let p={...f},y=!1,w;if(t._optimisticResults){const ct=this.hasListeners(),dt=!ct&&S0(r,t),Tt=ct&&A0(r,e,t,i);(dt||Tt)&&(p={...p,...Wv(f.data,r.options)}),t._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:S,errorUpdatedAt:_,status:A}=p;w=p.data;let C=!1;if(t.placeholderData!==void 0&&w===void 0&&A==="pending"){let ct;a?.isPlaceholderData&&t.placeholderData===c?.placeholderData?(ct=a.data,C=!0):ct=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,ct!==void 0&&(A="success",w=Up(a?.data,ct,t),y=!0)}if(t.select&&w!==void 0&&!C)if(a&&w===l?.data&&t.select===this.#c)w=this.#l;else try{this.#c=t.select,w=t.select(w),w=Up(a?.data,w,t),this.#l=w,this.#o=null}catch(ct){this.#o=ct}this.#o&&(S=this.#o,w=this.#l,_=Date.now(),A="error");const M=p.fetchStatus==="fetching",N=A==="pending",k=A==="error",j=N&&M,F=w!==void 0,H={status:A,fetchStatus:p.fetchStatus,isPending:N,isSuccess:A==="success",isError:k,isInitialLoading:j,isLoading:j,data:w,dataUpdatedAt:p.dataUpdatedAt,error:S,errorUpdatedAt:_,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:M,isRefetching:M&&!N,isLoadingError:k&&!F,isPaused:p.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:k&&F,isStale:Cm(r,t),refetch:this.refetch,promise:this.#a,isEnabled:Ki(t.enabled,r)!==!1};if(this.options.experimental_prefetchInRender){const ct=H.data!==void 0,dt=H.status==="error"&&!ct,Tt=At=>{dt?At.reject(H.error):ct&&At.resolve(H.data)},xt=()=>{const At=this.#a=H.promise=zp();Tt(At)},Nt=this.#a;switch(Nt.status){case"pending":r.queryHash===e.queryHash&&Tt(Nt);break;case"fulfilled":(dt||H.data!==Nt.value)&&xt();break;case"rejected":(!dt||H.error!==Nt.reason)&&xt();break}}return H}updateResult(){const r=this.#n,t=this.createResult(this.#e,this.options);if(this.#s=this.#e.state,this.#r=this.options,this.#s.data!==void 0&&(this.#d=this.#e),qh(t,r))return;this.#n=t;const e=()=>{if(!r)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#n).some(c=>{const u=c;return this.#n[u]!==r[u]&&l.has(u)})};this.#C({listeners:e()})}#w(){const r=this.#t.getQueryCache().build(this.#t,this.options);if(r===this.#e)return;const t=this.#e;this.#e=r,this.#i=r.state,this.hasListeners()&&(t?.removeObserver(this),r.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#C(r){xn.batch(()=>{r.listeners&&this.listeners.forEach(t=>{t(this.#n)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function DA(r,t){return Ki(t.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&t.retryOnMount===!1)}function S0(r,t){return DA(r,t)||r.state.data!==void 0&&qp(r,t,t.refetchOnMount)}function qp(r,t,e){if(Ki(t.enabled,r)!==!1&&ar(t.staleTime,r)!=="static"){const i=typeof e=="function"?e(r):e;return i==="always"||i!==!1&&Cm(r,t)}return!1}function A0(r,t,e,i){return(r!==t||Ki(i.enabled,r)===!1)&&(!e.suspense||r.state.status!=="error")&&Cm(r,e)}function Cm(r,t){return Ki(t.enabled,r)!==!1&&r.isStaleByTime(ar(t.staleTime,r))}function OA(r,t){return!qh(r.getCurrentResult(),t)}function E0(r){return{onFetch:(t,e)=>{const i=t.options,a=t.fetchOptions?.meta?.fetchMore?.direction,l=t.state.data?.pages||[],c=t.state.data?.pageParams||[];let u={pages:[],pageParams:[]},d=0;const f=async()=>{let p=!1;const y=_=>{SA(_,()=>t.signal,()=>p=!0)},w=$v(t.options,t.fetchOptions),S=async(_,A,C)=>{if(p)return Promise.reject();if(A==null&&_.pages.length)return Promise.resolve(_);const N=(()=>{const z={client:t.client,queryKey:t.queryKey,pageParam:A,direction:C?"backward":"forward",meta:t.options.meta};return y(z),z})(),k=await w(N),{maxPages:j}=t.options,F=C?xA:wA;return{pages:F(_.pages,k,j),pageParams:F(_.pageParams,A,j)}};if(a&&l.length){const _=a==="backward",A=_?NA:_0,C={pages:l,pageParams:c},M=A(i,C);u=await S(C,M,_)}else{const _=r??l.length;do{const A=d===0?c[0]??i.initialPageParam:_0(i,u);if(d>0&&A==null)break;u=await S(u,A),d++}while(d<_)}return u};t.options.persister?t.fetchFn=()=>t.options.persister?.(f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e):t.fetchFn=f}}}function _0(r,{pages:t,pageParams:e}){const i=t.length-1;return t.length>0?r.getNextPageParam(t[i],t,e[i],e):void 0}function NA(r,{pages:t,pageParams:e}){return t.length>0?r.getPreviousPageParam?.(t[0],t,e[0],e):void 0}var kA=class extends Qv{#t;#e;#i;#n;constructor(r){super(),this.#t=r.client,this.mutationId=r.mutationId,this.#i=r.mutationCache,this.#e=[],this.state=r.state||Zv(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){this.#e.includes(r)||(this.#e.push(r),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){this.#e=this.#e.filter(t=>t!==r),this.scheduleGc(),this.#i.notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#i.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(r){const t=()=>{this.#s({type:"continue"})},e={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#n=Yv({fn:()=>this.options.mutationFn?this.options.mutationFn(r,e):Promise.reject(new Error("No mutationFn found")),onFail:(l,c)=>{this.#s({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#i.canRun(this)});const i=this.state.status==="pending",a=!this.#n.canStart();try{if(i)t();else{this.#s({type:"pending",variables:r,isPaused:a}),this.#i.config.onMutate&&await this.#i.config.onMutate(r,this,e);const c=await this.options.onMutate?.(r,e);c!==this.state.context&&this.#s({type:"pending",context:c,variables:r,isPaused:a})}const l=await this.#n.start();return await this.#i.config.onSuccess?.(l,r,this.state.context,this,e),await this.options.onSuccess?.(l,r,this.state.context,e),await this.#i.config.onSettled?.(l,null,this.state.variables,this.state.context,this,e),await this.options.onSettled?.(l,null,r,this.state.context,e),this.#s({type:"success",data:l}),l}catch(l){try{await this.#i.config.onError?.(l,r,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onError?.(l,r,this.state.context,e)}catch(c){Promise.reject(c)}try{await this.#i.config.onSettled?.(void 0,l,this.state.variables,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onSettled?.(void 0,l,r,this.state.context,e)}catch(c){Promise.reject(c)}throw this.#s({type:"error",error:l}),l}finally{this.#i.runNext(this)}}#s(r){const t=e=>{switch(r.type){case"failed":return{...e,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...e,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:r.error,failureCount:e.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=t(this.state),xn.batch(()=>{this.#e.forEach(e=>{e.onMutationUpdate(r)}),this.#i.notify({mutation:this,type:"updated",action:r})})}};function Zv(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var LA=class extends bl{constructor(r={}){super(),this.config=r,this.#t=new Set,this.#e=new Map,this.#i=0}#t;#e;#i;build(r,t,e){const i=new kA({client:r,mutationCache:this,mutationId:++this.#i,options:r.defaultMutationOptions(t),state:e});return this.add(i),i}add(r){this.#t.add(r);const t=bh(r);if(typeof t=="string"){const e=this.#e.get(t);e?e.push(r):this.#e.set(t,[r])}this.notify({type:"added",mutation:r})}remove(r){if(this.#t.delete(r)){const t=bh(r);if(typeof t=="string"){const e=this.#e.get(t);if(e)if(e.length>1){const i=e.indexOf(r);i!==-1&&e.splice(i,1)}else e[0]===r&&this.#e.delete(t)}}this.notify({type:"removed",mutation:r})}canRun(r){const t=bh(r);if(typeof t=="string"){const i=this.#e.get(t)?.find(a=>a.state.status==="pending");return!i||i===r}else return!0}runNext(r){const t=bh(r);return typeof t=="string"?this.#e.get(t)?.find(i=>i!==r&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){xn.batch(()=>{this.#t.forEach(r=>{this.notify({type:"removed",mutation:r})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(r){const t={exact:!0,...r};return this.getAll().find(e=>y0(t,e))}findAll(r={}){return this.getAll().filter(t=>y0(r,t))}notify(r){xn.batch(()=>{this.listeners.forEach(t=>{t(r)})})}resumePausedMutations(){const r=this.getAll().filter(t=>t.state.isPaused);return xn.batch(()=>Promise.all(r.map(t=>t.continue().catch(ni))))}};function bh(r){return r.options.scope?.id}var PA=class extends bl{#t;#e=void 0;#i;#n;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),qh(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#i,observer:this}),e?.mutationKey&&this.options.mutationKey&&Zr(e.mutationKey)!==Zr(this.options.mutationKey)?this.reset():this.#i?.state.status==="pending"&&this.#i.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#i?.removeObserver(this)}onMutationUpdate(t){this.#s(),this.#r(t)}getCurrentResult(){return this.#e}reset(){this.#i?.removeObserver(this),this.#i=void 0,this.#s(),this.#r()}mutate(t,e){return this.#n=e,this.#i?.removeObserver(this),this.#i=this.#t.getMutationCache().build(this.#t,this.options),this.#i.addObserver(this),this.#i.execute(t)}#s(){const t=this.#i?.state??Zv();this.#e={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#r(t){xn.batch(()=>{if(this.#n&&this.hasListeners()){const e=this.#e.variables,i=this.#e.context,a={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#n.onSuccess?.(t.data,e,i,a)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(t.data,null,e,i,a)}catch(l){Promise.reject(l)}}else if(t?.type==="error"){try{this.#n.onError?.(t.error,e,i,a)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(void 0,t.error,e,i,a)}catch(l){Promise.reject(l)}}}this.listeners.forEach(e=>{e(this.#e)})})}},BA=class extends bl{constructor(r={}){super(),this.config=r,this.#t=new Map}#t;build(r,t,e){const i=t.queryKey,a=t.queryHash??Sm(i,t);let l=this.get(a);return l||(l=new RA({client:r,queryKey:i,queryHash:a,options:r.defaultQueryOptions(t),state:e,defaultOptions:r.getQueryDefaults(i)}),this.add(l)),l}add(r){this.#t.has(r.queryHash)||(this.#t.set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const t=this.#t.get(r.queryHash);t&&(r.destroy(),t===r&&this.#t.delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){xn.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return this.#t.get(r)}getAll(){return[...this.#t.values()]}find(r){const t={exact:!0,...r};return this.getAll().find(e=>g0(t,e))}findAll(r={}){const t=this.getAll();return Object.keys(r).length>0?t.filter(e=>g0(r,e)):t}notify(r){xn.batch(()=>{this.listeners.forEach(t=>{t(r)})})}onFocus(){xn.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){xn.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},jA=class{#t;#e;#i;#n;#s;#r;#a;#o;constructor(r={}){this.#t=r.queryCache||new BA,this.#e=r.mutationCache||new LA,this.#i=r.defaultOptions||{},this.#n=new Map,this.#s=new Map,this.#r=0}mount(){this.#r++,this.#r===1&&(this.#a=_m.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#o=Gh.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#r--,this.#r===0&&(this.#a?.(),this.#a=void 0,this.#o?.(),this.#o=void 0)}isFetching(r){return this.#t.findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return this.#e.findAll({...r,status:"pending"}).length}getQueryData(r){const t=this.defaultQueryOptions({queryKey:r});return this.#t.get(t.queryHash)?.state.data}ensureQueryData(r){const t=this.defaultQueryOptions(r),e=this.#t.build(this,t),i=e.state.data;return i===void 0?this.fetchQuery(r):(r.revalidateIfStale&&e.isStaleByTime(ar(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(r){return this.#t.findAll(r).map(({queryKey:t,state:e})=>{const i=e.data;return[t,i]})}setQueryData(r,t,e){const i=this.defaultQueryOptions({queryKey:r}),l=this.#t.get(i.queryHash)?.state.data,c=yA(t,l);if(c!==void 0)return this.#t.build(this,i).setData(c,{...e,manual:!0})}setQueriesData(r,t,e){return xn.batch(()=>this.#t.findAll(r).map(({queryKey:i})=>[i,this.setQueryData(i,t,e)]))}getQueryState(r){const t=this.defaultQueryOptions({queryKey:r});return this.#t.get(t.queryHash)?.state}removeQueries(r){const t=this.#t;xn.batch(()=>{t.findAll(r).forEach(e=>{t.remove(e)})})}resetQueries(r,t){const e=this.#t;return xn.batch(()=>(e.findAll(r).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...r},t)))}cancelQueries(r,t={}){const e={revert:!0,...t},i=xn.batch(()=>this.#t.findAll(r).map(a=>a.cancel(e)));return Promise.all(i).then(ni).catch(ni)}invalidateQueries(r,t={}){return xn.batch(()=>(this.#t.findAll(r).forEach(e=>{e.invalidate()}),r?.refetchType==="none"?Promise.resolve():this.refetchQueries({...r,type:r?.refetchType??r?.type??"active"},t)))}refetchQueries(r,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},i=xn.batch(()=>this.#t.findAll(r).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,e);return e.throwOnError||(l=l.catch(ni)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(ni)}fetchQuery(r){const t=this.defaultQueryOptions(r);t.retry===void 0&&(t.retry=!1);const e=this.#t.build(this,t);return e.isStaleByTime(ar(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(ni).catch(ni)}fetchInfiniteQuery(r){return r.behavior=E0(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(ni).catch(ni)}ensureInfiniteQueryData(r){return r.behavior=E0(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Gh.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#i}setDefaultOptions(r){this.#i=r}setQueryDefaults(r,t){this.#n.set(Zr(r),{queryKey:r,defaultOptions:t})}getQueryDefaults(r){const t=[...this.#n.values()],e={};return t.forEach(i=>{Fc(r,i.queryKey)&&Object.assign(e,i.defaultOptions)}),e}setMutationDefaults(r,t){this.#s.set(Zr(r),{mutationKey:r,defaultOptions:t})}getMutationDefaults(r){const t=[...this.#s.values()],e={};return t.forEach(i=>{Fc(r,i.mutationKey)&&Object.assign(e,i.defaultOptions)}),e}defaultQueryOptions(r){if(r._defaulted)return r;const t={...this.#i.queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return t.queryHash||(t.queryHash=Sm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Am&&(t.enabled=!1),t}defaultMutationOptions(r){return r?._defaulted?r:{...this.#i.mutations,...r?.mutationKey&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},Jv=I.createContext(void 0),vl=r=>{const t=I.useContext(Jv);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},FA=({client:r,children:t})=>(I.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),D.jsx(Jv.Provider,{value:r,children:t})),tw=I.createContext(!1),IA=()=>I.useContext(tw);tw.Provider;function UA(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var zA=I.createContext(UA()),HA=()=>I.useContext(zA),qA=(r,t,e)=>{const i=e?.state.error&&typeof r.throwOnError=="function"?Em(r.throwOnError,[e.state.error,e]):r.throwOnError;(r.suspense||r.experimental_prefetchInRender||i)&&(t.isReset()||(r.retryOnMount=!1))},GA=r=>{I.useEffect(()=>{r.clearReset()},[r])},VA=({result:r,errorResetBoundary:t,throwOnError:e,query:i,suspense:a})=>r.isError&&!t.isReset()&&!r.isFetching&&i&&(a&&r.data===void 0||Em(e,[r.error,i])),KA=r=>{if(r.suspense){const e=a=>a==="static"?a:Math.max(a??1e3,1e3),i=r.staleTime;r.staleTime=typeof i=="function"?(...a)=>e(i(...a)):e(i),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3))}},$A=(r,t)=>r.isLoading&&r.isFetching&&!t,XA=(r,t)=>r?.suspense&&t.isPending,C0=(r,t,e)=>t.fetchOptimistic(r).catch(()=>{e.clearReset()});function YA(r,t,e){const i=IA(),a=HA(),l=vl(),c=l.defaultQueryOptions(r);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c);const u=l.getQueryCache().get(c.queryHash);c._optimisticResults=i?"isRestoring":"optimistic",KA(c),qA(c,a,u),GA(a);const d=!l.getQueryCache().get(c.queryHash),[f]=I.useState(()=>new t(l,c)),p=f.getOptimisticResult(c),y=!i&&r.subscribed!==!1;if(I.useSyncExternalStore(I.useCallback(w=>{const S=y?f.subscribe(xn.batchCalls(w)):ni;return f.updateResult(),S},[f,y]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),I.useEffect(()=>{f.setOptions(c)},[c,f]),XA(c,p))throw C0(c,f,a);if(VA({result:p,errorResetBoundary:a,throwOnError:c.throwOnError,query:u,suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!Wr&&$A(p,i)&&(d?C0(c,f,a):u?.promise)?.catch(ni).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function pa(r,t){return YA(r,MA)}function Pc(r,t){const e=vl(),[i]=I.useState(()=>new PA(e,r));I.useEffect(()=>{i.setOptions(r)},[i,r]);const a=I.useSyncExternalStore(I.useCallback(c=>i.subscribe(xn.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=I.useCallback((c,u)=>{i.mutate(c,u).catch(ni)},[i]);if(a.error&&Em(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}const T0=r=>{let t;const e=new Set,i=(f,p)=>{const y=typeof f=="function"?f(t):f;if(!Object.is(y,t)){const w=t;t=p??(typeof y!="object"||y===null)?y:Object.assign({},t,y),e.forEach(S=>S(t,w))}},a=()=>t,u={setState:i,getState:a,getInitialState:()=>d,subscribe:f=>(e.add(f),()=>e.delete(f))},d=t=r(i,a,u);return u},QA=(r=>r?T0(r):T0),WA=r=>r;function ZA(r,t=WA){const e=gh.useSyncExternalStore(r.subscribe,gh.useCallback(()=>t(r.getState()),[r,t]),gh.useCallback(()=>t(r.getInitialState()),[r,t]));return gh.useDebugValue(e),e}const R0=r=>{const t=QA(r),e=i=>ZA(t,i);return Object.assign(e,t),e},JA=(r=>r?R0(r):R0);function tE(r,t){let e;try{e=r()}catch{return}return{getItem:a=>{var l;const c=d=>d===null?null:JSON.parse(d,void 0),u=(l=e.getItem(a))!=null?l:null;return u instanceof Promise?u.then(c):c(u)},setItem:(a,l)=>e.setItem(a,JSON.stringify(l,void 0)),removeItem:a=>e.removeItem(a)}}const Gp=r=>t=>{try{const e=r(t);return e instanceof Promise?e:{then(i){return Gp(i)(e)},catch(i){return this}}}catch(e){return{then(i){return this},catch(i){return Gp(i)(e)}}}},eE=(r,t)=>(e,i,a)=>{let l={storage:tE(()=>window.localStorage),partialize:C=>C,version:0,merge:(C,M)=>({...M,...C}),...t},c=!1,u=0;const d=new Set,f=new Set;let p=l.storage;if(!p)return r((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),e(...C)},i,a);const y=()=>{const C=l.partialize({...i()});return p.setItem(l.name,{state:C,version:l.version})},w=a.setState;a.setState=(C,M)=>(w(C,M),y());const S=r((...C)=>(e(...C),y()),i,a);a.getInitialState=()=>S;let _;const A=()=>{var C,M;if(!p)return;const N=++u;c=!1,d.forEach(j=>{var F;return j((F=i())!=null?F:S)});const k=((M=l.onRehydrateStorage)==null?void 0:M.call(l,(C=i())!=null?C:S))||void 0;return Gp(p.getItem.bind(p))(l.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==l.version){if(l.migrate){const F=l.migrate(j.state,j.version);return F instanceof Promise?F.then(z=>[!0,z]):[!0,F]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var F;if(N!==u)return;const[z,H]=j;if(_=l.merge(H,(F=i())!=null?F:S),e(_,!0),z)return y()}).then(()=>{N===u&&(k?.(_,void 0),_=i(),c=!0,f.forEach(j=>j(_)))}).catch(j=>{N===u&&k?.(void 0,j)})};return a.persist={setOptions:C=>{l={...l,...C},C.storage&&(p=C.storage)},clearStorage:()=>{p?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>A(),hasHydrated:()=>c,onHydrate:C=>(d.add(C),()=>{d.delete(C)}),onFinishHydration:C=>(f.add(C),()=>{f.delete(C)})},l.skipHydration||A(),_||S},nE=eE,ba=JA(nE(r=>({token:null,setToken:t=>r({token:t}),logout:()=>r({token:null})}),{name:"wisemark-auth",partialize:r=>({token:r.token})}));function ew(r,t){return function(){return r.apply(t,arguments)}}const{toString:iE}=Object.prototype,{getPrototypeOf:Tm}=Object,{iterator:ed,toStringTag:nw}=Symbol,nd=(r=>t=>{const e=iE.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),is=r=>(r=r.toLowerCase(),t=>nd(t)===r),id=r=>t=>typeof t===r,{isArray:wl}=Array,dl=id("undefined");function Kc(r){return r!==null&&!dl(r)&&r.constructor!==null&&!dl(r.constructor)&&mi(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const iw=is("ArrayBuffer");function sE(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&iw(r.buffer),t}const aE=id("string"),mi=id("function"),sw=id("number"),$c=r=>r!==null&&typeof r=="object",rE=r=>r===!0||r===!1,Lh=r=>{if(nd(r)!=="object")return!1;const t=Tm(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(nw in r)&&!(ed in r)},oE=r=>{if(!$c(r)||Kc(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},lE=is("Date"),cE=is("File"),uE=is("Blob"),hE=is("FileList"),dE=r=>$c(r)&&mi(r.pipe),fE=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||mi(r.append)&&((t=nd(r))==="formdata"||t==="object"&&mi(r.toString)&&r.toString()==="[object FormData]"))},pE=is("URLSearchParams"),[mE,gE,yE,bE]=["ReadableStream","Request","Response","Headers"].map(is),vE=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Xc(r,t,{allOwnKeys:e=!1}={}){if(r===null||typeof r>"u")return;let i,a;if(typeof r!="object"&&(r=[r]),wl(r))for(i=0,a=r.length;i<a;i++)t.call(null,r[i],i,r);else{if(Kc(r))return;const l=e?Object.getOwnPropertyNames(r):Object.keys(r),c=l.length;let u;for(i=0;i<c;i++)u=l[i],t.call(null,r[u],u,r)}}function aw(r,t){if(Kc(r))return null;t=t.toLowerCase();const e=Object.keys(r);let i=e.length,a;for(;i-- >0;)if(a=e[i],t===a.toLowerCase())return a;return null}const Gr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,rw=r=>!dl(r)&&r!==Gr;function Vp(){const{caseless:r,skipUndefined:t}=rw(this)&&this||{},e={},i=(a,l)=>{if(l==="__proto__"||l==="constructor"||l==="prototype")return;const c=r&&aw(e,l)||l;Lh(e[c])&&Lh(a)?e[c]=Vp(e[c],a):Lh(a)?e[c]=Vp({},a):wl(a)?e[c]=a.slice():(!t||!dl(a))&&(e[c]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Xc(arguments[a],i);return e}const wE=(r,t,e,{allOwnKeys:i}={})=>(Xc(t,(a,l)=>{e&&mi(a)?Object.defineProperty(r,l,{value:ew(a,e),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(r,l,{value:a,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:i}),r),xE=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),SE=(r,t,e,i)=>{r.prototype=Object.create(t.prototype,i),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},AE=(r,t,e,i)=>{let a,l,c;const u={};if(t=t||{},r==null)return t;do{for(a=Object.getOwnPropertyNames(r),l=a.length;l-- >0;)c=a[l],(!i||i(c,r,t))&&!u[c]&&(t[c]=r[c],u[c]=!0);r=e!==!1&&Tm(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},EE=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const i=r.indexOf(t,e);return i!==-1&&i===e},_E=r=>{if(!r)return null;if(wl(r))return r;let t=r.length;if(!sw(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},CE=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Tm(Uint8Array)),TE=(r,t)=>{const i=(r&&r[ed]).call(r);let a;for(;(a=i.next())&&!a.done;){const l=a.value;t.call(r,l[0],l[1])}},RE=(r,t)=>{let e;const i=[];for(;(e=r.exec(t))!==null;)i.push(e);return i},ME=is("HTMLFormElement"),DE=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,i,a){return i.toUpperCase()+a}),M0=(({hasOwnProperty:r})=>(t,e)=>r.call(t,e))(Object.prototype),OE=is("RegExp"),ow=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),i={};Xc(e,(a,l)=>{let c;(c=t(a,l,r))!==!1&&(i[l]=c||a)}),Object.defineProperties(r,i)},NE=r=>{ow(r,(t,e)=>{if(mi(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const i=r[e];if(mi(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},kE=(r,t)=>{const e={},i=a=>{a.forEach(l=>{e[l]=!0})};return wl(r)?i(r):i(String(r).split(t)),e},LE=()=>{},PE=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t;function BE(r){return!!(r&&mi(r.append)&&r[nw]==="FormData"&&r[ed])}const jE=r=>{const t=new Array(10),e=(i,a)=>{if($c(i)){if(t.indexOf(i)>=0)return;if(Kc(i))return i;if(!("toJSON"in i)){t[a]=i;const l=wl(i)?[]:{};return Xc(i,(c,u)=>{const d=e(c,a+1);!dl(d)&&(l[u]=d)}),t[a]=void 0,l}}return i};return e(r,0)},FE=is("AsyncFunction"),IE=r=>r&&($c(r)||mi(r))&&mi(r.then)&&mi(r.catch),lw=((r,t)=>r?setImmediate:t?((e,i)=>(Gr.addEventListener("message",({source:a,data:l})=>{a===Gr&&l===e&&i.length&&i.shift()()},!1),a=>{i.push(a),Gr.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",mi(Gr.postMessage)),UE=typeof queueMicrotask<"u"?queueMicrotask.bind(Gr):typeof process<"u"&&process.nextTick||lw,zE=r=>r!=null&&mi(r[ed]),ut={isArray:wl,isArrayBuffer:iw,isBuffer:Kc,isFormData:fE,isArrayBufferView:sE,isString:aE,isNumber:sw,isBoolean:rE,isObject:$c,isPlainObject:Lh,isEmptyObject:oE,isReadableStream:mE,isRequest:gE,isResponse:yE,isHeaders:bE,isUndefined:dl,isDate:lE,isFile:cE,isBlob:uE,isRegExp:OE,isFunction:mi,isStream:dE,isURLSearchParams:pE,isTypedArray:CE,isFileList:hE,forEach:Xc,merge:Vp,extend:wE,trim:vE,stripBOM:xE,inherits:SE,toFlatObject:AE,kindOf:nd,kindOfTest:is,endsWith:EE,toArray:_E,forEachEntry:TE,matchAll:RE,isHTMLForm:ME,hasOwnProperty:M0,hasOwnProp:M0,reduceDescriptors:ow,freezeMethods:NE,toObjectSet:kE,toCamelCase:DE,noop:LE,toFiniteNumber:PE,findKey:aw,global:Gr,isContextDefined:rw,isSpecCompliantForm:BE,toJSONObject:jE,isAsyncFn:FE,isThenable:IE,setImmediate:lw,asap:UE,isIterable:zE};let te=class cw extends Error{static from(t,e,i,a,l,c){const u=new cw(t.message,e||t.code,i,a,l);return u.cause=t,u.name=t.name,c&&Object.assign(u,c),u}constructor(t,e,i,a,l){super(t),this.name="AxiosError",this.isAxiosError=!0,e&&(this.code=e),i&&(this.config=i),a&&(this.request=a),l&&(this.response=l,this.status=l.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ut.toJSONObject(this.config),code:this.code,status:this.status}}};te.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";te.ERR_BAD_OPTION="ERR_BAD_OPTION";te.ECONNABORTED="ECONNABORTED";te.ETIMEDOUT="ETIMEDOUT";te.ERR_NETWORK="ERR_NETWORK";te.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";te.ERR_DEPRECATED="ERR_DEPRECATED";te.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";te.ERR_BAD_REQUEST="ERR_BAD_REQUEST";te.ERR_CANCELED="ERR_CANCELED";te.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";te.ERR_INVALID_URL="ERR_INVALID_URL";const HE=null;function Kp(r){return ut.isPlainObject(r)||ut.isArray(r)}function uw(r){return ut.endsWith(r,"[]")?r.slice(0,-2):r}function D0(r,t,e){return r?r.concat(t).map(function(a,l){return a=uw(a),!e&&l?"["+a+"]":a}).join(e?".":""):t}function qE(r){return ut.isArray(r)&&!r.some(Kp)}const GE=ut.toFlatObject(ut,{},null,function(t){return/^is[A-Z]/.test(t)});function sd(r,t,e){if(!ut.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=ut.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(A,C){return!ut.isUndefined(C[A])});const i=e.metaTokens,a=e.visitor||p,l=e.dots,c=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&ut.isSpecCompliantForm(t);if(!ut.isFunction(a))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(ut.isDate(_))return _.toISOString();if(ut.isBoolean(_))return _.toString();if(!d&&ut.isBlob(_))throw new te("Blob is not supported. Use a Buffer instead.");return ut.isArrayBuffer(_)||ut.isTypedArray(_)?d&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function p(_,A,C){let M=_;if(_&&!C&&typeof _=="object"){if(ut.endsWith(A,"{}"))A=i?A:A.slice(0,-2),_=JSON.stringify(_);else if(ut.isArray(_)&&qE(_)||(ut.isFileList(_)||ut.endsWith(A,"[]"))&&(M=ut.toArray(_)))return A=uw(A),M.forEach(function(k,j){!(ut.isUndefined(k)||k===null)&&t.append(c===!0?D0([A],j,l):c===null?A:A+"[]",f(k))}),!1}return Kp(_)?!0:(t.append(D0(C,A,l),f(_)),!1)}const y=[],w=Object.assign(GE,{defaultVisitor:p,convertValue:f,isVisitable:Kp});function S(_,A){if(!ut.isUndefined(_)){if(y.indexOf(_)!==-1)throw Error("Circular reference detected in "+A.join("."));y.push(_),ut.forEach(_,function(M,N){(!(ut.isUndefined(M)||M===null)&&a.call(t,M,ut.isString(N)?N.trim():N,A,w))===!0&&S(M,A?A.concat(N):[N])}),y.pop()}}if(!ut.isObject(r))throw new TypeError("data must be an object");return S(r),t}function O0(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Rm(r,t){this._pairs=[],r&&sd(r,this,t)}const hw=Rm.prototype;hw.append=function(t,e){this._pairs.push([t,e])};hw.toString=function(t){const e=t?function(i){return t.call(this,i,O0)}:O0;return this._pairs.map(function(a){return e(a[0])+"="+e(a[1])},"").join("&")};function VE(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function dw(r,t,e){if(!t)return r;const i=e&&e.encode||VE,a=ut.isFunction(e)?{serialize:e}:e,l=a&&a.serialize;let c;if(l?c=l(t,a):c=ut.isURLSearchParams(t)?t.toString():new Rm(t,a).toString(i),c){const u=r.indexOf("#");u!==-1&&(r=r.slice(0,u)),r+=(r.indexOf("?")===-1?"?":"&")+c}return r}class N0{constructor(){this.handlers=[]}use(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ut.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Mm={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},KE=typeof URLSearchParams<"u"?URLSearchParams:Rm,$E=typeof FormData<"u"?FormData:null,XE=typeof Blob<"u"?Blob:null,YE={isBrowser:!0,classes:{URLSearchParams:KE,FormData:$E,Blob:XE},protocols:["http","https","file","blob","url","data"]},Dm=typeof window<"u"&&typeof document<"u",$p=typeof navigator=="object"&&navigator||void 0,QE=Dm&&(!$p||["ReactNative","NativeScript","NS"].indexOf($p.product)<0),WE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",ZE=Dm&&window.location.href||"http://localhost",JE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Dm,hasStandardBrowserEnv:QE,hasStandardBrowserWebWorkerEnv:WE,navigator:$p,origin:ZE},Symbol.toStringTag,{value:"Module"})),Qn={...JE,...YE};function t_(r,t){return sd(r,new Qn.classes.URLSearchParams,{visitor:function(e,i,a,l){return Qn.isNode&&ut.isBuffer(e)?(this.append(i,e.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function e_(r){return ut.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function n_(r){const t={},e=Object.keys(r);let i;const a=e.length;let l;for(i=0;i<a;i++)l=e[i],t[l]=r[l];return t}function fw(r){function t(e,i,a,l){let c=e[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=l>=e.length;return c=!c&&ut.isArray(a)?a.length:c,d?(ut.hasOwnProp(a,c)?a[c]=[a[c],i]:a[c]=i,!u):((!a[c]||!ut.isObject(a[c]))&&(a[c]=[]),t(e,i,a[c],l)&&ut.isArray(a[c])&&(a[c]=n_(a[c])),!u)}if(ut.isFormData(r)&&ut.isFunction(r.entries)){const e={};return ut.forEachEntry(r,(i,a)=>{t(e_(i),a,e,0)}),e}return null}function i_(r,t,e){if(ut.isString(r))try{return(t||JSON.parse)(r),ut.trim(r)}catch(i){if(i.name!=="SyntaxError")throw i}return(e||JSON.stringify)(r)}const Yc={transitional:Mm,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const i=e.getContentType()||"",a=i.indexOf("application/json")>-1,l=ut.isObject(t);if(l&&ut.isHTMLForm(t)&&(t=new FormData(t)),ut.isFormData(t))return a?JSON.stringify(fw(t)):t;if(ut.isArrayBuffer(t)||ut.isBuffer(t)||ut.isStream(t)||ut.isFile(t)||ut.isBlob(t)||ut.isReadableStream(t))return t;if(ut.isArrayBufferView(t))return t.buffer;if(ut.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(i.indexOf("application/x-www-form-urlencoded")>-1)return t_(t,this.formSerializer).toString();if((u=ut.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return sd(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return l||a?(e.setContentType("application/json",!1),i_(t)):t}],transformResponse:[function(t){const e=this.transitional||Yc.transitional,i=e&&e.forcedJSONParsing,a=this.responseType==="json";if(ut.isResponse(t)||ut.isReadableStream(t))return t;if(t&&ut.isString(t)&&(i&&!this.responseType||a)){const c=!(e&&e.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?te.from(u,te.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Qn.classes.FormData,Blob:Qn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ut.forEach(["delete","get","head","post","put","patch"],r=>{Yc.headers[r]={}});const s_=ut.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),a_=r=>{const t={};let e,i,a;return r&&r.split(`
`).forEach(function(c){a=c.indexOf(":"),e=c.substring(0,a).trim().toLowerCase(),i=c.substring(a+1).trim(),!(!e||t[e]&&s_[e])&&(e==="set-cookie"?t[e]?t[e].push(i):t[e]=[i]:t[e]=t[e]?t[e]+", "+i:i)}),t},k0=Symbol("internals");function Ec(r){return r&&String(r).trim().toLowerCase()}function Ph(r){return r===!1||r==null?r:ut.isArray(r)?r.map(Ph):String(r)}function r_(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=e.exec(r);)t[i[1]]=i[2];return t}const o_=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Ap(r,t,e,i,a){if(ut.isFunction(i))return i.call(this,t,e);if(a&&(t=e),!!ut.isString(t)){if(ut.isString(i))return t.indexOf(i)!==-1;if(ut.isRegExp(i))return i.test(t)}}function l_(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,i)=>e.toUpperCase()+i)}function c_(r,t){const e=ut.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(r,i+e,{value:function(a,l,c){return this[i].call(this,t,a,l,c)},configurable:!0})})}let gi=class{constructor(t){t&&this.set(t)}set(t,e,i){const a=this;function l(u,d,f){const p=Ec(d);if(!p)throw new Error("header name must be a non-empty string");const y=ut.findKey(a,p);(!y||a[y]===void 0||f===!0||f===void 0&&a[y]!==!1)&&(a[y||d]=Ph(u))}const c=(u,d)=>ut.forEach(u,(f,p)=>l(f,p,d));if(ut.isPlainObject(t)||t instanceof this.constructor)c(t,e);else if(ut.isString(t)&&(t=t.trim())&&!o_(t))c(a_(t),e);else if(ut.isObject(t)&&ut.isIterable(t)){let u={},d,f;for(const p of t){if(!ut.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?ut.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}c(u,e)}else t!=null&&l(e,t,i);return this}get(t,e){if(t=Ec(t),t){const i=ut.findKey(this,t);if(i){const a=this[i];if(!e)return a;if(e===!0)return r_(a);if(ut.isFunction(e))return e.call(this,a,i);if(ut.isRegExp(e))return e.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Ec(t),t){const i=ut.findKey(this,t);return!!(i&&this[i]!==void 0&&(!e||Ap(this,this[i],i,e)))}return!1}delete(t,e){const i=this;let a=!1;function l(c){if(c=Ec(c),c){const u=ut.findKey(i,c);u&&(!e||Ap(i,i[u],u,e))&&(delete i[u],a=!0)}}return ut.isArray(t)?t.forEach(l):l(t),a}clear(t){const e=Object.keys(this);let i=e.length,a=!1;for(;i--;){const l=e[i];(!t||Ap(this,this[l],l,t,!0))&&(delete this[l],a=!0)}return a}normalize(t){const e=this,i={};return ut.forEach(this,(a,l)=>{const c=ut.findKey(i,l);if(c){e[c]=Ph(a),delete e[l];return}const u=t?l_(l):String(l).trim();u!==l&&delete e[l],e[u]=Ph(a),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return ut.forEach(this,(i,a)=>{i!=null&&i!==!1&&(e[a]=t&&ut.isArray(i)?i.join(", "):i)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const i=new this(t);return e.forEach(a=>i.set(a)),i}static accessor(t){const i=(this[k0]=this[k0]={accessors:{}}).accessors,a=this.prototype;function l(c){const u=Ec(c);i[u]||(c_(a,c),i[u]=!0)}return ut.isArray(t)?t.forEach(l):l(t),this}};gi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ut.reduceDescriptors(gi.prototype,({value:r},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(i){this[e]=i}}});ut.freezeMethods(gi);function Ep(r,t){const e=this||Yc,i=t||e,a=gi.from(i.headers);let l=i.data;return ut.forEach(r,function(u){l=u.call(e,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function pw(r){return!!(r&&r.__CANCEL__)}let Qc=class extends te{constructor(t,e,i){super(t??"canceled",te.ERR_CANCELED,e,i),this.name="CanceledError",this.__CANCEL__=!0}};function mw(r,t,e){const i=e.config.validateStatus;!e.status||!i||i(e.status)?r(e):t(new te("Request failed with status code "+e.status,[te.ERR_BAD_REQUEST,te.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function u_(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function h_(r,t){r=r||10;const e=new Array(r),i=new Array(r);let a=0,l=0,c;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=i[l];c||(c=f),e[a]=d,i[a]=f;let y=l,w=0;for(;y!==a;)w+=e[y++],y=y%r;if(a=(a+1)%r,a===l&&(l=(l+1)%r),f-c<t)return;const S=p&&f-p;return S?Math.round(w*1e3/S):void 0}}function d_(r,t){let e=0,i=1e3/t,a,l;const c=(f,p=Date.now())=>{e=p,a=null,l&&(clearTimeout(l),l=null),r(...f)};return[(...f)=>{const p=Date.now(),y=p-e;y>=i?c(f,p):(a=f,l||(l=setTimeout(()=>{l=null,c(a)},i-y)))},()=>a&&c(a)]}const Vh=(r,t,e=3)=>{let i=0;const a=h_(50,250);return d_(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,d=c-i,f=a(d),p=c<=u;i=c;const y={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-c)/f:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};r(y)},e)},L0=(r,t)=>{const e=r!=null;return[i=>t[0]({lengthComputable:e,total:r,loaded:i}),t[1]]},P0=r=>(...t)=>ut.asap(()=>r(...t)),f_=Qn.hasStandardBrowserEnv?((r,t)=>e=>(e=new URL(e,Qn.origin),r.protocol===e.protocol&&r.host===e.host&&(t||r.port===e.port)))(new URL(Qn.origin),Qn.navigator&&/(msie|trident)/i.test(Qn.navigator.userAgent)):()=>!0,p_=Qn.hasStandardBrowserEnv?{write(r,t,e,i,a,l,c){if(typeof document>"u")return;const u=[`${r}=${encodeURIComponent(t)}`];ut.isNumber(e)&&u.push(`expires=${new Date(e).toUTCString()}`),ut.isString(i)&&u.push(`path=${i}`),ut.isString(a)&&u.push(`domain=${a}`),l===!0&&u.push("secure"),ut.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(r){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+r+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(r){this.write(r,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function m_(r){return typeof r!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function g_(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function gw(r,t,e){let i=!m_(t);return r&&(i||e==!1)?g_(r,t):t}const B0=r=>r instanceof gi?{...r}:r;function Jr(r,t){t=t||{};const e={};function i(f,p,y,w){return ut.isPlainObject(f)&&ut.isPlainObject(p)?ut.merge.call({caseless:w},f,p):ut.isPlainObject(p)?ut.merge({},p):ut.isArray(p)?p.slice():p}function a(f,p,y,w){if(ut.isUndefined(p)){if(!ut.isUndefined(f))return i(void 0,f,y,w)}else return i(f,p,y,w)}function l(f,p){if(!ut.isUndefined(p))return i(void 0,p)}function c(f,p){if(ut.isUndefined(p)){if(!ut.isUndefined(f))return i(void 0,f)}else return i(void 0,p)}function u(f,p,y){if(y in t)return i(f,p);if(y in r)return i(void 0,f)}const d={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(f,p,y)=>a(B0(f),B0(p),y,!0)};return ut.forEach(Object.keys({...r,...t}),function(p){if(p==="__proto__"||p==="constructor"||p==="prototype")return;const y=ut.hasOwnProp(d,p)?d[p]:a,w=y(r[p],t[p],p);ut.isUndefined(w)&&y!==u||(e[p]=w)}),e}const yw=r=>{const t=Jr({},r);let{data:e,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:l,headers:c,auth:u}=t;if(t.headers=c=gi.from(c),t.url=dw(gw(t.baseURL,t.url,t.allowAbsoluteUrls),r.params,r.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),ut.isFormData(e)){if(Qn.hasStandardBrowserEnv||Qn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(ut.isFunction(e.getHeaders)){const d=e.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,y])=>{f.includes(p.toLowerCase())&&c.set(p,y)})}}if(Qn.hasStandardBrowserEnv&&(i&&ut.isFunction(i)&&(i=i(t)),i||i!==!1&&f_(t.url))){const d=a&&l&&p_.read(l);d&&c.set(a,d)}return t},y_=typeof XMLHttpRequest<"u",b_=y_&&function(r){return new Promise(function(e,i){const a=yw(r);let l=a.data;const c=gi.from(a.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=a,p,y,w,S,_;function A(){S&&S(),_&&_(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let C=new XMLHttpRequest;C.open(a.method.toUpperCase(),a.url,!0),C.timeout=a.timeout;function M(){if(!C)return;const k=gi.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),F={data:!u||u==="text"||u==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:k,config:r,request:C};mw(function(H){e(H),A()},function(H){i(H),A()},F),C=null}"onloadend"in C?C.onloadend=M:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(M)},C.onabort=function(){C&&(i(new te("Request aborted",te.ECONNABORTED,r,C)),C=null)},C.onerror=function(j){const F=j&&j.message?j.message:"Network Error",z=new te(F,te.ERR_NETWORK,r,C);z.event=j||null,i(z),C=null},C.ontimeout=function(){let j=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const F=a.transitional||Mm;a.timeoutErrorMessage&&(j=a.timeoutErrorMessage),i(new te(j,F.clarifyTimeoutError?te.ETIMEDOUT:te.ECONNABORTED,r,C)),C=null},l===void 0&&c.setContentType(null),"setRequestHeader"in C&&ut.forEach(c.toJSON(),function(j,F){C.setRequestHeader(F,j)}),ut.isUndefined(a.withCredentials)||(C.withCredentials=!!a.withCredentials),u&&u!=="json"&&(C.responseType=a.responseType),f&&([w,_]=Vh(f,!0),C.addEventListener("progress",w)),d&&C.upload&&([y,S]=Vh(d),C.upload.addEventListener("progress",y),C.upload.addEventListener("loadend",S)),(a.cancelToken||a.signal)&&(p=k=>{C&&(i(!k||k.type?new Qc(null,r,C):k),C.abort(),C=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const N=u_(a.url);if(N&&Qn.protocols.indexOf(N)===-1){i(new te("Unsupported protocol "+N+":",te.ERR_BAD_REQUEST,r));return}C.send(l||null)})},v_=(r,t)=>{const{length:e}=r=r?r.filter(Boolean):[];if(t||e){let i=new AbortController,a;const l=function(f){if(!a){a=!0,u();const p=f instanceof Error?f:this.reason;i.abort(p instanceof te?p:new Qc(p instanceof Error?p.message:p))}};let c=t&&setTimeout(()=>{c=null,l(new te(`timeout of ${t}ms exceeded`,te.ETIMEDOUT))},t);const u=()=>{r&&(c&&clearTimeout(c),c=null,r.forEach(f=>{f.unsubscribe?f.unsubscribe(l):f.removeEventListener("abort",l)}),r=null)};r.forEach(f=>f.addEventListener("abort",l));const{signal:d}=i;return d.unsubscribe=()=>ut.asap(u),d}},w_=function*(r,t){let e=r.byteLength;if(e<t){yield r;return}let i=0,a;for(;i<e;)a=i+t,yield r.slice(i,a),i=a},x_=async function*(r,t){for await(const e of S_(r))yield*w_(e,t)},S_=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:e,value:i}=await t.read();if(e)break;yield i}}finally{await t.cancel()}},j0=(r,t,e,i)=>{const a=x_(r,t);let l=0,c,u=d=>{c||(c=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await a.next();if(f){u(),d.close();return}let y=p.byteLength;if(e){let w=l+=y;e(w)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),a.return()}},{highWaterMark:2})},F0=64*1024,{isFunction:vh}=ut,A_=(({Request:r,Response:t})=>({Request:r,Response:t}))(ut.global),{ReadableStream:I0,TextEncoder:U0}=ut.global,z0=(r,...t)=>{try{return!!r(...t)}catch{return!1}},E_=r=>{r=ut.merge.call({skipUndefined:!0},A_,r);const{fetch:t,Request:e,Response:i}=r,a=t?vh(t):typeof fetch=="function",l=vh(e),c=vh(i);if(!a)return!1;const u=a&&vh(I0),d=a&&(typeof U0=="function"?(_=>A=>_.encode(A))(new U0):async _=>new Uint8Array(await new e(_).arrayBuffer())),f=l&&u&&z0(()=>{let _=!1;const A=new e(Qn.origin,{body:new I0,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!A}),p=c&&u&&z0(()=>ut.isReadableStream(new i("").body)),y={stream:p&&(_=>_.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(_=>{!y[_]&&(y[_]=(A,C)=>{let M=A&&A[_];if(M)return M.call(A);throw new te(`Response type '${_}' is not supported`,te.ERR_NOT_SUPPORT,C)})});const w=async _=>{if(_==null)return 0;if(ut.isBlob(_))return _.size;if(ut.isSpecCompliantForm(_))return(await new e(Qn.origin,{method:"POST",body:_}).arrayBuffer()).byteLength;if(ut.isArrayBufferView(_)||ut.isArrayBuffer(_))return _.byteLength;if(ut.isURLSearchParams(_)&&(_=_+""),ut.isString(_))return(await d(_)).byteLength},S=async(_,A)=>{const C=ut.toFiniteNumber(_.getContentLength());return C??w(A)};return async _=>{let{url:A,method:C,data:M,signal:N,cancelToken:k,timeout:j,onDownloadProgress:F,onUploadProgress:z,responseType:H,headers:ct,withCredentials:dt="same-origin",fetchOptions:Tt}=yw(_),xt=t||fetch;H=H?(H+"").toLowerCase():"text";let Nt=v_([N,k&&k.toAbortSignal()],j),At=null;const Rt=Nt&&Nt.unsubscribe&&(()=>{Nt.unsubscribe()});let qt;try{if(z&&f&&C!=="get"&&C!=="head"&&(qt=await S(ct,M))!==0){let U=new e(A,{method:"POST",body:M,duplex:"half"}),J;if(ut.isFormData(M)&&(J=U.headers.get("content-type"))&&ct.setContentType(J),U.body){const[ft,wt]=L0(qt,Vh(P0(z)));M=j0(U.body,F0,ft,wt)}}ut.isString(dt)||(dt=dt?"include":"omit");const G=l&&"credentials"in e.prototype,tt={...Tt,signal:Nt,method:C.toUpperCase(),headers:ct.normalize().toJSON(),body:M,duplex:"half",credentials:G?dt:void 0};At=l&&new e(A,tt);let vt=await(l?xt(At,Tt):xt(A,tt));const Xt=p&&(H==="stream"||H==="response");if(p&&(F||Xt&&Rt)){const U={};["status","statusText","headers"].forEach(Bt=>{U[Bt]=vt[Bt]});const J=ut.toFiniteNumber(vt.headers.get("content-length")),[ft,wt]=F&&L0(J,Vh(P0(F),!0))||[];vt=new i(j0(vt.body,F0,ft,()=>{wt&&wt(),Rt&&Rt()}),U)}H=H||"text";let Ct=await y[ut.findKey(y,H)||"text"](vt,_);return!Xt&&Rt&&Rt(),await new Promise((U,J)=>{mw(U,J,{data:Ct,headers:gi.from(vt.headers),status:vt.status,statusText:vt.statusText,config:_,request:At})})}catch(G){throw Rt&&Rt(),G&&G.name==="TypeError"&&/Load failed|fetch/i.test(G.message)?Object.assign(new te("Network Error",te.ERR_NETWORK,_,At,G&&G.response),{cause:G.cause||G}):te.from(G,G&&G.code,_,At,G&&G.response)}}},__=new Map,bw=r=>{let t=r&&r.env||{};const{fetch:e,Request:i,Response:a}=t,l=[i,a,e];let c=l.length,u=c,d,f,p=__;for(;u--;)d=l[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:E_(t)),p=f;return f};bw();const Om={http:HE,xhr:b_,fetch:{get:bw}};ut.forEach(Om,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const H0=r=>`- ${r}`,C_=r=>ut.isFunction(r)||r===null||r===!1;function T_(r,t){r=ut.isArray(r)?r:[r];const{length:e}=r;let i,a;const l={};for(let c=0;c<e;c++){i=r[c];let u;if(a=i,!C_(i)&&(a=Om[(u=String(i)).toLowerCase()],a===void 0))throw new te(`Unknown adapter '${u}'`);if(a&&(ut.isFunction(a)||(a=a.get(t))))break;l[u||"#"+c]=a}if(!a){const c=Object.entries(l).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=e?c.length>1?`since :
`+c.map(H0).join(`
`):" "+H0(c[0]):"as no adapter specified";throw new te("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a}const vw={getAdapter:T_,adapters:Om};function _p(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Qc(null,r)}function q0(r){return _p(r),r.headers=gi.from(r.headers),r.data=Ep.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),vw.getAdapter(r.adapter||Yc.adapter,r)(r).then(function(i){return _p(r),i.data=Ep.call(r,r.transformResponse,i),i.headers=gi.from(i.headers),i},function(i){return pw(i)||(_p(r),i&&i.response&&(i.response.data=Ep.call(r,r.transformResponse,i.response),i.response.headers=gi.from(i.response.headers))),Promise.reject(i)})}const ww="1.13.5",ad={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{ad[r]=function(i){return typeof i===r||"a"+(t<1?"n ":" ")+r}});const G0={};ad.transitional=function(t,e,i){function a(l,c){return"[Axios v"+ww+"] Transitional option '"+l+"'"+c+(i?". "+i:"")}return(l,c,u)=>{if(t===!1)throw new te(a(c," has been removed"+(e?" in "+e:"")),te.ERR_DEPRECATED);return e&&!G0[c]&&(G0[c]=!0,console.warn(a(c," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(l,c,u):!0}};ad.spelling=function(t){return(e,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function R_(r,t,e){if(typeof r!="object")throw new te("options must be an object",te.ERR_BAD_OPTION_VALUE);const i=Object.keys(r);let a=i.length;for(;a-- >0;){const l=i[a],c=t[l];if(c){const u=r[l],d=u===void 0||c(u,l,r);if(d!==!0)throw new te("option "+l+" must be "+d,te.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new te("Unknown option "+l,te.ERR_BAD_OPTION)}}const Bh={assertOptions:R_,validators:ad},qi=Bh.validators;let Yr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new N0,response:new N0}}async request(t,e){try{return await this._request(t,e)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?l&&!String(i.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+l):i.stack=l}catch{}}throw i}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Jr(this.defaults,e);const{transitional:i,paramsSerializer:a,headers:l}=e;i!==void 0&&Bh.assertOptions(i,{silentJSONParsing:qi.transitional(qi.boolean),forcedJSONParsing:qi.transitional(qi.boolean),clarifyTimeoutError:qi.transitional(qi.boolean),legacyInterceptorReqResOrdering:qi.transitional(qi.boolean)},!1),a!=null&&(ut.isFunction(a)?e.paramsSerializer={serialize:a}:Bh.assertOptions(a,{encode:qi.function,serialize:qi.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Bh.assertOptions(e,{baseUrl:qi.spelling("baseURL"),withXsrfToken:qi.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let c=l&&ut.merge(l.common,l[e.method]);l&&ut.forEach(["delete","get","head","post","put","patch","common"],_=>{delete l[_]}),e.headers=gi.concat(c,l);const u=[];let d=!0;this.interceptors.request.forEach(function(A){if(typeof A.runWhen=="function"&&A.runWhen(e)===!1)return;d=d&&A.synchronous;const C=e.transitional||Mm;C&&C.legacyInterceptorReqResOrdering?u.unshift(A.fulfilled,A.rejected):u.push(A.fulfilled,A.rejected)});const f=[];this.interceptors.response.forEach(function(A){f.push(A.fulfilled,A.rejected)});let p,y=0,w;if(!d){const _=[q0.bind(this),void 0];for(_.unshift(...u),_.push(...f),w=_.length,p=Promise.resolve(e);y<w;)p=p.then(_[y++],_[y++]);return p}w=u.length;let S=e;for(;y<w;){const _=u[y++],A=u[y++];try{S=_(S)}catch(C){A.call(this,C);break}}try{p=q0.call(this,S)}catch(_){return Promise.reject(_)}for(y=0,w=f.length;y<w;)p=p.then(f[y++],f[y++]);return p}getUri(t){t=Jr(this.defaults,t);const e=gw(t.baseURL,t.url,t.allowAbsoluteUrls);return dw(e,t.params,t.paramsSerializer)}};ut.forEach(["delete","get","head","options"],function(t){Yr.prototype[t]=function(e,i){return this.request(Jr(i||{},{method:t,url:e,data:(i||{}).data}))}});ut.forEach(["post","put","patch"],function(t){function e(i){return function(l,c,u){return this.request(Jr(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Yr.prototype[t]=e(),Yr.prototype[t+"Form"]=e(!0)});let M_=class xw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(l){e=l});const i=this;this.promise.then(a=>{if(!i._listeners)return;let l=i._listeners.length;for(;l-- >0;)i._listeners[l](a);i._listeners=null}),this.promise.then=a=>{let l;const c=new Promise(u=>{i.subscribe(u),l=u}).then(a);return c.cancel=function(){i.unsubscribe(l)},c},t(function(l,c,u){i.reason||(i.reason=new Qc(l,c,u),e(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=i=>{t.abort(i)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new xw(function(a){t=a}),cancel:t}}};function D_(r){return function(e){return r.apply(null,e)}}function O_(r){return ut.isObject(r)&&r.isAxiosError===!0}const Xp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Xp).forEach(([r,t])=>{Xp[t]=r});function Sw(r){const t=new Yr(r),e=ew(Yr.prototype.request,t);return ut.extend(e,Yr.prototype,t,{allOwnKeys:!0}),ut.extend(e,t,null,{allOwnKeys:!0}),e.create=function(a){return Sw(Jr(r,a))},e}const un=Sw(Yc);un.Axios=Yr;un.CanceledError=Qc;un.CancelToken=M_;un.isCancel=pw;un.VERSION=ww;un.toFormData=sd;un.AxiosError=te;un.Cancel=un.CanceledError;un.all=function(t){return Promise.all(t)};un.spread=D_;un.isAxiosError=O_;un.mergeConfig=Jr;un.AxiosHeaders=gi;un.formToJSON=r=>fw(ut.isHTMLForm(r)?new FormData(r):r);un.getAdapter=vw.getAdapter;un.HttpStatusCode=Xp;un.default=un;const{Axios:Q2,AxiosError:W2,CanceledError:Z2,isCancel:J2,CancelToken:tR,VERSION:eR,all:nR,Cancel:iR,isAxiosError:sR,spread:aR,toFormData:rR,AxiosHeaders:oR,HttpStatusCode:lR,formToJSON:cR,getAdapter:uR,mergeConfig:hR}=un,Qe=un.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});Qe.interceptors.request.use(r=>{const t=ba.getState().token;return t&&(r.headers.Authorization=`Token ${t}`),r.data instanceof FormData&&delete r.headers["Content-Type"],r});Qe.interceptors.response.use(r=>r,r=>(r.response?.status===401&&ba.getState().logout(),Promise.reject(r)));const fl={login:(r,t)=>Qe.post("/auth/login/",{email:r,password:t}),register:r=>Qe.post("/auth/register/",r),logout:()=>Qe.post("/auth/logout/"),me:()=>Qe.get("/auth/me/"),deleteAccount:()=>Qe.post("/auth/me/delete/")},Kh={list:()=>Qe.get("/projects/"),get:r=>Qe.get(`/projects/${r}/`),create:r=>Qe.post("/projects/",r),update:(r,t)=>Qe.patch(`/projects/${r}/`,t),delete:r=>Qe.delete(`/projects/${r}/`)},Yn={list:r=>Qe.get("/documents/",{params:r}),get:r=>Qe.get(`/documents/${r}/`),create:r=>Qe.post("/documents/",r),createWithFile:r=>Qe.post("/documents/",r),getPdf:r=>Qe.get(`/documents/${r}/pdf/`,{responseType:"arraybuffer"}),uploadPdf:(r,t)=>Qe.post(`/documents/${r}/upload_pdf/`,t),update:(r,t)=>Qe.patch(`/documents/${r}/`,t),delete:r=>Qe.delete(`/documents/${r}/`),highlights:r=>Qe.get(`/documents/${r}/highlights/`),createHighlight:(r,t)=>Qe.post(`/documents/${r}/highlights/`,t),updateHighlight:(r,t,e)=>Qe.patch(`/documents/${r}/highlights/${t}/`,e),deleteHighlight:(r,t)=>Qe.delete(`/documents/${r}/highlights/${t}/`)},N_={page:"bg-slate-50",surface:"bg-white",muted:"bg-slate-100"},Jt={body:"text-slate-800",heading:"text-slate-900",secondary:"text-slate-600",muted:"text-slate-500"},sr={default:"border-slate-200"},Qr="min-h-screen p-6",Aw="bg-white border-b border-slate-200",to="bg-slate-800 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-slate-700 cursor-pointer",Oc="p-2 rounded-lg text-slate-600 hover:bg-slate-100 cursor-pointer",V0="w-px h-6 bg-slate-200",ma=N_;function k_(){const r=ya(),t=ba(y=>y.setToken),[e,i]=I.useState(""),[a,l]=I.useState(""),[c,u]=I.useState(""),[d,f]=I.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{const{data:w}=await fl.login(e,a);t(w.token),r("/",{replace:!0})}catch(w){u(w.response?.data?.detail||w.response?.data?.email?.[0]||"Login failed")}finally{f(!1)}};return D.jsx("div",{className:`${Qr} ${ma.page} flex items-center justify-center`,children:D.jsxs("div",{className:"w-full max-w-sm",children:[D.jsx("h1",{className:`text-2xl font-semibold ${Jt.heading} mb-6`,children:"Sign in"}),D.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&D.jsx("p",{className:"text-sm text-red-600",children:c}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Email"}),D.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Password"}),D.jsx("input",{type:"password",value:a,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"current-password"})]}),D.jsx("button",{type:"submit",disabled:d,className:to,children:d?"Signing in...":"Sign in"})]}),D.jsxs("p",{className:`mt-4 text-sm ${Jt.muted}`,children:["No account? ",D.jsx(td,{to:"/register",className:"text-slate-700 underline",children:"Register"})]})]})})}function L_(){const r=ya(),t=ba(y=>y.setToken),[e,i]=I.useState(""),[a,l]=I.useState(""),[c,u]=I.useState(""),[d,f]=I.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{await fl.register({email:e,password:a});const{data:w}=await fl.login(e,a);t(w.token),r("/",{replace:!0})}catch(w){const S=w.response?.data;u(S?.email?.[0]||S?.password?.[0]||"Registration failed")}finally{f(!1)}};return D.jsx("div",{className:`${Qr} ${ma.page} flex items-center justify-center`,children:D.jsxs("div",{className:"w-full max-w-sm",children:[D.jsx("h1",{className:`text-2xl font-semibold ${Jt.heading} mb-6`,children:"Create account"}),D.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&D.jsx("p",{className:"text-sm text-red-600",children:c}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Email"}),D.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Password"}),D.jsx("input",{type:"password",value:a,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"new-password"})]}),D.jsx("button",{type:"submit",disabled:d,className:to,children:d?"Creating account...":"Register"})]}),D.jsxs("p",{className:`mt-4 text-sm ${Jt.muted}`,children:["Already have an account? ",D.jsx(td,{to:"/login",className:"text-slate-700 underline",children:"Sign in"})]})]})})}const Ew=(...r)=>r.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();const P_=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const B_=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase());const K0=r=>{const t=B_(r);return t.charAt(0).toUpperCase()+t.slice(1)};var j_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const F_=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const I_=I.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:c,...u},d)=>I.createElement("svg",{ref:d,...j_,width:t,height:t,stroke:r,strokeWidth:i?Number(e)*24/Number(t):e,className:Ew("lucide",a),...!l&&!F_(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>I.createElement(f,p)),...Array.isArray(l)?l:[l]]));const hn=(r,t)=>{const e=I.forwardRef(({className:i,...a},l)=>I.createElement(I_,{ref:l,iconNode:t,className:Ew(`lucide-${P_(K0(r))}`,`lucide-${r}`,i),...a}));return e.displayName=K0(r),e};const U_=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],rd=hn("arrow-left",U_);const z_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$0=hn("check",z_);const H_=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],q_=hn("chevron-down",H_);const G_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],V_=hn("chevron-right",G_);const K_=[["path",{d:"M11 21a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1",key:"likhh7"}],["path",{d:"M16 16a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1",key:"17ky3x"}],["path",{d:"M21 6a2 2 0 0 0-.586-1.414l-2-2A2 2 0 0 0 17 2h-3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1z",key:"1hyeo0"}]],$_=hn("file-stack",K_);const X_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],_w=hn("file-text",X_);const Y_=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Q_=hn("layers",Y_);const W_=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],Z_=hn("list-ordered",W_);const J_=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ds=hn("loader-circle",J_);const tC=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Nm=hn("log-out",tC);const eC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],nC=hn("panel-right-close",eC);const iC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],sC=hn("panel-right-open",iC);const aC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Yp=hn("pencil",aC);const rC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],oC=hn("plus",rC);const lC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],cC=hn("search",lC);const uC=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],hC=hn("settings-2",uC);const dC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],km=hn("trash-2",dC);const fC=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Qp=hn("upload",fC);const pC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Wp=hn("x",pC);const mC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],gC=hn("zoom-in",mC);const yC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],bC=hn("zoom-out",yC),ha=["#f59e0b","#3b82f6","#10b981","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316"];function vC(r){if(!r)return"";const t=new Date(r);if(Number.isNaN(t.getTime()))return"";const e=new Date,i=e-t,a=Math.floor(i/6e4),l=Math.floor(i/36e5),c=Math.floor(i/864e5);return a<1?"Just now":a<60?`${a} min ago`:l<24?`${l} hour${l===1?"":"s"} ago`:c===1?"Yesterday":c<7?`${c} days ago`:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:t.getFullYear()!==e.getFullYear()?"numeric":void 0})}function wC({project:r,onOpen:t}){const[e,i]=I.useState(!1),a=r.document_count??0,l=r.annotation_count??0,c=r.color&&ha.includes(r.color)?r.color:ha[r.id%ha.length];return D.jsxs("div",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onClick:()=>t(r.id),role:"button",tabIndex:0,onKeyDown:u=>u.key==="Enter"&&t(r.id),className:"flex items-center gap-4 rounded-xl border border-slate-200 bg-white px-5 py-5 cursor-pointer transition-all duration-200",style:{boxShadow:e?"0 4px 12px rgba(71,85,105,0.08)":"0 1px 3px rgba(0,0,0,0.04)",transform:e?"translateY(-1px)":"none",background:e?"#f8fafc":"#fff"},children:[D.jsx("div",{className:"shrink-0 rounded-sm",style:{width:4,height:48,background:c}}),D.jsxs("div",{className:"flex-1 min-w-0",children:[D.jsx("div",{className:"text-base font-normal text-slate-900 truncate",style:{fontFamily:"'Instrument Serif', serif"},children:r.name}),D.jsxs("div",{className:"flex items-center gap-3 mt-1 text-[13px] text-slate-400",style:{fontFamily:"'JetBrains Mono', monospace"},children:[D.jsxs("span",{className:"flex items-center gap-1",children:[D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-400",children:[D.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),D.jsx("polyline",{points:"14 2 14 8 20 8"})]}),a," ",a===1?"doc":"docs"]}),D.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),D.jsxs("span",{className:"flex items-center gap-1",children:[D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-400",children:[D.jsx("path",{d:"M12 20h9"}),D.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"})]}),l," ",l===1?"annotation":"annotations"]})]})]}),D.jsx("div",{className:"text-[13px] text-slate-400 whitespace-nowrap shrink-0",style:{fontFamily:"'JetBrains Mono', monospace"},children:vC(r.updated_at)}),D.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:e?"#475569":"#cbd5e1",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 transition-colors",children:D.jsx("polyline",{points:"9 18 15 12 9 6"})})]})}function xC({onClose:r,onCreate:t,isPending:e,defaultColorIndex:i=0}){const[a,l]=I.useState(""),[c,u]=I.useState(ha[i%ha.length]),d=()=>{const f=a.trim();f&&(t(f,c),l(""),u(ha[i%ha.length]))};return D.jsx("div",{className:"fixed inset-0 bg-slate-950/40 backdrop-blur-sm flex items-center justify-center z-[1000]",onClick:r,children:D.jsxs("div",{className:"bg-white rounded-xl p-8 w-full max-w-[420px] shadow-xl mx-4",onClick:f=>f.stopPropagation(),children:[D.jsx("h2",{className:"m-0 text-xl font-normal text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"New project"}),D.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:"Group related deal documents together."}),D.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mb-1.5 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Project name"}),D.jsx("input",{type:"text",value:a,onChange:f=>l(f.target.value),placeholder:"e.g. Meridian Healthcare CIM",autoFocus:!0,className:"w-full px-3.5 py-2.5 text-[15px] border border-slate-200 rounded-lg outline-none text-slate-800 focus:border-slate-600 transition-colors box-border",style:{fontFamily:"'DM Sans', sans-serif"}}),D.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mt-5 mb-2 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Colour"}),D.jsx("div",{className:"flex gap-2",children:ha.map(f=>D.jsx("button",{type:"button",onClick:()=>u(f),className:"w-7 h-7 rounded-full shrink-0 transition-all border-2 border-transparent focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2",style:{background:f,borderColor:c===f?"#1e293b":"transparent",outline:c===f?"2px solid #fff":"none",outlineOffset:-4}},f))}),D.jsxs("div",{className:"flex justify-end gap-2.5 mt-7",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium border border-slate-200 rounded-lg bg-white text-slate-500 hover:bg-slate-50",children:"Cancel"}),D.jsx("button",{type:"button",onClick:d,disabled:!a.trim()||e,className:"px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors disabled:bg-slate-300 disabled:cursor-default hover:bg-slate-700",style:{background:a.trim()&&!e?"#1e293b":"#cbd5e1"},children:e?"Creating":"Create project"})]})]})})}function SC(){const r=ya(),t=vl(),e=ba(N=>N.logout),[i,a]=I.useState(!1),[l,c]=I.useState(""),{data:u}=pa({queryKey:["me"],queryFn:async()=>{const{data:N}=await fl.me();return N}}),{data:d,isLoading:f}=pa({queryKey:["projects"],queryFn:async()=>{const{data:N}=await Kh.list();return N}}),p=Array.isArray(d)?d:d?.results??[],y=p.filter(N=>N.name.toLowerCase().includes(l.toLowerCase())),w=p.reduce((N,k)=>N+(k.document_count??0),0),S=p.reduce((N,k)=>N+(k.annotation_count??0),0),_=Pc({mutationFn:({name:N,color:k})=>Kh.create({name:N.trim(),color:k}),onSuccess:()=>{t.invalidateQueries({queryKey:["projects"]}),a(!1)}}),A=(N,k)=>{_.mutate({name:N,color:k})},C=()=>{e(),r("/login",{replace:!0})},M=(u?.email?.[0]||u?.username?.[0]||"?").toUpperCase();return D.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif",color:"#1e293b"},children:[D.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap",rel:"stylesheet"}),D.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("div",{className:"w-6 h-6 rounded-md bg-slate-700 flex items-center justify-center text-white text-xs font-semibold",style:{fontFamily:"'DM Sans', sans-serif"},children:"W"}),D.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:C,className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:D.jsx(Nm,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:()=>r("/app/settings"),className:"w-8 h-8 rounded-full bg-slate-700 text-white flex items-center justify-center text-[13px] font-semibold hover:bg-slate-600 transition-colors cursor-pointer",style:{fontFamily:"'DM Sans', sans-serif"},title:"Account settings",children:M})]})]}),D.jsxs("div",{className:"max-w-[720px] mx-auto px-6 py-10",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsxs("div",{className:"flex items-start justify-between mb-2",children:[D.jsx("h1",{className:"m-0 text-[28px] text-slate-950",style:{fontFamily:"'Instrument Serif', serif",fontWeight:700,letterSpacing:"0.01em"},children:"Projects"}),D.jsxs("button",{type:"button",onClick:()=>a(!0),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors hover:bg-slate-700",style:{background:"#1e293b",fontFamily:"'DM Sans', sans-serif"},children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[D.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),D.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New project"]})]}),D.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-400 mb-6 uppercase",style:{fontFamily:"'JetBrains Mono', monospace",letterSpacing:"0.08em"},children:[D.jsxs("span",{children:[p.length," project",p.length!==1?"s":""]}),D.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),D.jsxs("span",{children:[w," document",w!==1?"s":""]}),D.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),D.jsxs("span",{children:[S," annotation",S!==1?"s":""]})]}),p.length>3&&D.jsxs("div",{className:"relative mb-4",children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#94a3b8",strokeWidth:"2",className:"absolute left-3 top-1/2 -translate-y-1/2",children:[D.jsx("circle",{cx:"11",cy:"11",r:"8"}),D.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),D.jsx("input",{type:"text",placeholder:"Search projects",value:l,onChange:N=>c(N.target.value),className:"w-full py-2.5 pl-9 pr-3.5 text-sm border border-slate-200 rounded-lg outline-none text-slate-800 bg-white box-border",style:{fontFamily:"'DM Sans', sans-serif"}})]}),f?D.jsxs("div",{className:"flex items-center gap-2 text-slate-500 py-12",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx(Ds,{className:"w-5 h-5 animate-spin"}),"Loading projects"]}):D.jsx("div",{className:"flex flex-col gap-2",children:y.map(N=>D.jsx(wC,{project:N,onOpen:k=>r(`/project/${k}`)},N.id))}),!f&&y.length===0&&l&&D.jsxs("div",{className:"text-center py-12 text-slate-500 text-sm",style:{fontFamily:"'DM Sans', sans-serif"},children:['No projects match "',l,'"']}),!f&&p.length===0&&D.jsxs("div",{className:"text-center py-16 text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto mb-4",children:D.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),D.jsx("div",{className:"text-base font-medium text-slate-600 mb-1.5",children:"No projects yet"}),D.jsx("div",{className:"text-sm text-slate-500",children:"Create a project to start organising your deal documents."})]})]}),i&&D.jsx(xC,{onClose:()=>a(!1),onCreate:A,isPending:_.isPending,defaultColorIndex:p.length%ha.length})]})}var jh={exports:{}},AC=jh.exports,X0;function EC(){return X0||(X0=1,(function(r,t){((e,i)=>{r.exports=i()})(AC,function(){var e=function(m,v){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(x,E){x.__proto__=E}:function(x,E){for(var R in E)Object.prototype.hasOwnProperty.call(E,R)&&(x[R]=E[R])}))(m,v)},i=function(){return(i=Object.assign||function(m){for(var v,x=1,E=arguments.length;x<E;x++)for(var R in v=arguments[x])Object.prototype.hasOwnProperty.call(v,R)&&(m[R]=v[R]);return m}).apply(this,arguments)};function a(m,v,x){for(var E,R=0,O=v.length;R<O;R++)!E&&R in v||((E=E||Array.prototype.slice.call(v,0,R))[R]=v[R]);return m.concat(E||Array.prototype.slice.call(v))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:T1,c=Object.keys,u=Array.isArray;function d(m,v){return typeof v=="object"&&c(v).forEach(function(x){m[x]=v[x]}),m}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var f=Object.getPrototypeOf,p={}.hasOwnProperty;function y(m,v){return p.call(m,v)}function w(m,v){typeof v=="function"&&(v=v(f(m))),(typeof Reflect>"u"?c:Reflect.ownKeys)(v).forEach(function(x){_(m,x,v[x])})}var S=Object.defineProperty;function _(m,v,x,E){S(m,v,d(x&&y(x,"get")&&typeof x.get=="function"?{get:x.get,set:x.set,configurable:!0}:{value:x,configurable:!0,writable:!0},E))}function A(m){return{from:function(v){return m.prototype=Object.create(v.prototype),_(m.prototype,"constructor",m),{extend:w.bind(null,m.prototype)}}}}var C=Object.getOwnPropertyDescriptor,M=[].slice;function N(m,v,x){return M.call(m,v,x)}function k(m,v){return v(m)}function j(m){if(!m)throw new Error("Assertion Failed")}function F(m){l.setImmediate?setImmediate(m):setTimeout(m,0)}function z(m,v){if(typeof v=="string"&&y(m,v))return m[v];if(!v)return m;if(typeof v!="string"){for(var x=[],E=0,R=v.length;E<R;++E){var O=z(m,v[E]);x.push(O)}return x}var P,B=v.indexOf(".");return B===-1||(P=m[v.substr(0,B)])==null?void 0:z(P,v.substr(B+1))}function H(m,v,x){if(m&&v!==void 0&&!("isFrozen"in Object&&Object.isFrozen(m)))if(typeof v!="string"&&"length"in v){j(typeof x!="string"&&"length"in x);for(var E=0,R=v.length;E<R;++E)H(m,v[E],x[E])}else{var O,P,B=v.indexOf(".");B!==-1?(O=v.substr(0,B),(B=v.substr(B+1))===""?x===void 0?u(m)&&!isNaN(parseInt(O))?m.splice(O,1):delete m[O]:m[O]=x:H(P=(P=m[O])&&y(m,O)?P:m[O]={},B,x)):x===void 0?u(m)&&!isNaN(parseInt(v))?m.splice(v,1):delete m[v]:m[v]=x}}function ct(m){var v,x={};for(v in m)y(m,v)&&(x[v]=m[v]);return x}var dt=[].concat;function Tt(m){return dt.apply([],m)}var J="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(Tt([8,16,32,64].map(function(m){return["Int","Uint","Float"].map(function(v){return v+m+"Array"})}))).filter(function(m){return l[m]}),xt=new Set(J.map(function(m){return l[m]})),Nt=null;function At(m){return Nt=new WeakMap,m=(function v(x){if(!x||typeof x!="object")return x;var E=Nt.get(x);if(E)return E;if(u(x)){E=[],Nt.set(x,E);for(var R=0,O=x.length;R<O;++R)E.push(v(x[R]))}else if(xt.has(x.constructor))E=x;else{var P,B=f(x);for(P in E=B===Object.prototype?{}:Object.create(B),Nt.set(x,E),x)y(x,P)&&(E[P]=v(x[P]))}return E})(m),Nt=null,m}var Rt={}.toString;function qt(m){return Rt.call(m).slice(8,-1)}var G=typeof Symbol<"u"?Symbol.iterator:"@@iterator",tt=typeof G=="symbol"?function(m){var v;return m!=null&&(v=m[G])&&v.apply(m)}:function(){return null};function vt(m,v){v=m.indexOf(v),0<=v&&m.splice(v,1)}var Xt={};function Ct(m){var v,x,E,R;if(arguments.length===1){if(u(m))return m.slice();if(this===Xt&&typeof m=="string")return[m];if(R=tt(m))for(x=[];!(E=R.next()).done;)x.push(E.value);else{if(m==null)return[m];if(typeof(v=m.length)!="number")return[m];for(x=new Array(v);v--;)x[v]=m[v]}}else for(v=arguments.length,x=new Array(v);v--;)x[v]=arguments[v];return x}var U=typeof Symbol<"u"?function(m){return m[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},J=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],qn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(J),ft={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function wt(m,v){this.name=m,this.message=v}function Bt(m,v){return m+". Errors: "+Object.keys(v).map(function(x){return v[x].toString()}).filter(function(x,E,R){return R.indexOf(x)===E}).join(`
`)}function Ft(m,v,x,E){this.failures=v,this.failedKeys=E,this.successCount=x,this.message=Bt(m,v)}function It(m,v){this.name="BulkError",this.failures=Object.keys(v).map(function(x){return v[x]}),this.failuresByPos=v,this.message=Bt(m,this.failures)}A(wt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),A(Ft).from(wt),A(It).from(wt);var re=qn.reduce(function(m,v){return m[v]=v+"Error",m},{}),Kt=wt,kt=qn.reduce(function(m,v){var x=v+"Error";function E(R,O){this.name=x,R?typeof R=="string"?(this.message="".concat(R).concat(O?`
 `+O:""),this.inner=O||null):typeof R=="object"&&(this.message="".concat(R.name," ").concat(R.message),this.inner=R):(this.message=ft[v]||x,this.inner=null)}return A(E).from(Kt),m[v]=E,m},{}),He=(kt.Syntax=SyntaxError,kt.Type=TypeError,kt.Range=RangeError,J.reduce(function(m,v){return m[v+"Error"]=kt[v],m},{}));J=qn.reduce(function(m,v){return["Syntax","Type","Range"].indexOf(v)===-1&&(m[v+"Error"]=kt[v]),m},{});function yt(){}function le(m){return m}function Mt(m,v){return m==null||m===le?v:function(x){return v(m(x))}}function de(m,v){return function(){m.apply(this,arguments),v.apply(this,arguments)}}function Wn(m,v){return m===yt?v:function(){var x=m.apply(this,arguments),E=(x!==void 0&&(arguments[0]=x),this.onsuccess),R=this.onerror,O=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return E&&(this.onsuccess=this.onsuccess?de(E,this.onsuccess):E),R&&(this.onerror=this.onerror?de(R,this.onerror):R),O!==void 0?O:x}}function On(m,v){return m===yt?v:function(){m.apply(this,arguments);var x=this.onsuccess,E=this.onerror;this.onsuccess=this.onerror=null,v.apply(this,arguments),x&&(this.onsuccess=this.onsuccess?de(x,this.onsuccess):x),E&&(this.onerror=this.onerror?de(E,this.onerror):E)}}function si(m,v){return m===yt?v:function(R){var E=m.apply(this,arguments),R=(d(R,E),this.onsuccess),O=this.onerror,P=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return R&&(this.onsuccess=this.onsuccess?de(R,this.onsuccess):R),O&&(this.onerror=this.onerror?de(O,this.onerror):O),E===void 0?P===void 0?void 0:P:d(E,P)}}function Di(m,v){return m===yt?v:function(){return v.apply(this,arguments)!==!1&&m.apply(this,arguments)}}function An(m,v){return m===yt?v:function(){var x=m.apply(this,arguments);if(x&&typeof x.then=="function"){for(var E=this,R=arguments.length,O=new Array(R);R--;)O[R]=arguments[R];return x.then(function(){return v.apply(E,O)})}return v.apply(this,arguments)}}J.ModifyError=Ft,J.DexieError=wt,J.BulkError=It;var En=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function nu(m){En=m}var cr={},Hn=100,ur=typeof Promise>"u"?[]:(qn=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[ur=crypto.subtle.digest("SHA-512",new Uint8Array([0])),f(ur),qn]:[qn,f(qn),qn]),qn=ur[0],Vs=ur[1],Vs=Vs&&Vs.then,ss=qn&&qn.constructor,va=!!ur[2],hr=function(m,v){dr.push([m,v]),ro&&(queueMicrotask(iu),ro=!1)},ao=!0,ro=!0,Ns=[],as=[],Nn=le,kn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:yt,pgp:!1,env:{},finalize:yt},jt=kn,dr=[],ks=0,oo=[];function Lt(m){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var v=this._PSD=jt;if(typeof m!="function"){if(m!==cr)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Xi(this,this._value)}else this._state=null,this._value=null,++v.ref,(function x(E,R){try{R(function(O){if(E._state===null){if(O===E)throw new TypeError("A promise cannot be resolved with itself.");var P=E._lib&&rs();O&&typeof O.then=="function"?x(E,function(B,K){O instanceof Lt?O._then(B,K):O.then(B,K)}):(E._state=!0,E._value=O,pr(E)),P&&Oi()}},Xi.bind(null,E))}catch(O){Xi(E,O)}})(this,m)}var wa={get:function(){var m=jt,v=yr;function x(E,R){var O=this,P=!m.global&&(m!==jt||v!==yr),B=P&&!Zn(),K=new Lt(function(nt,$){Ls(O,new fr(lo(E,m,P,B),lo(R,m,P,B),nt,$,m))});return this._consoleTask&&(K._consoleTask=this._consoleTask),K}return x.prototype=cr,x},set:function(m){_(this,"then",m&&m.prototype===cr?wa:{get:function(){return m},set:wa.set})}};function fr(m,v,x,E,R){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof v=="function"?v:null,this.resolve=x,this.reject=E,this.psd=R}function Xi(m,v){var x,E;as.push(v),m._state===null&&(x=m._lib&&rs(),v=Nn(v),m._state=!1,m._value=v,E=m,Ns.some(function(R){return R._value===E._value})||Ns.push(E),pr(m),x)&&Oi()}function pr(m){var v=m._listeners;m._listeners=[];for(var x=0,E=v.length;x<E;++x)Ls(m,v[x]);var R=m._PSD;--R.ref||R.finalize(),ks===0&&(++ks,hr(function(){--ks==0&&xl()},[]))}function Ls(m,v){if(m._state===null)m._listeners.push(v);else{var x=m._state?v.onFulfilled:v.onRejected;if(x===null)return(m._state?v.resolve:v.reject)(m._value);++v.psd.ref,++ks,hr(vd,[x,m,v])}}function vd(m,v,x){try{var E,R=v._value;!v._state&&as.length&&(as=[]),E=En&&v._consoleTask?v._consoleTask.run(function(){return m(R)}):m(R),v._state||as.indexOf(R)!==-1||(O=>{for(var P=Ns.length;P;)if(Ns[--P]._value===O._value)return Ns.splice(P,1)})(v),x.resolve(E)}catch(O){x.reject(O)}finally{--ks==0&&xl(),--x.psd.ref||x.psd.finalize()}}function iu(){yi(kn,function(){rs()&&Oi()})}function rs(){var m=ao;return ro=ao=!1,m}function Oi(){var m,v,x;do for(;0<dr.length;)for(m=dr,dr=[],x=m.length,v=0;v<x;++v){var E=m[v];E[0].apply(null,E[1])}while(0<dr.length);ro=ao=!0}function xl(){for(var m=Ns,v=(Ns=[],m.forEach(function(E){E._PSD.onunhandled.call(null,E._value,E)}),oo.slice(0)),x=v.length;x;)v[--x]()}function mr(m){return new Lt(cr,!1,m)}function Ie(m,v){var x=jt;return function(){var E=rs(),R=jt;try{return ls(x,!0),m.apply(this,arguments)}catch(O){v&&v(O)}finally{ls(R,!1),E&&Oi()}}}w(Lt.prototype,{then:wa,_then:function(m,v){Ls(this,new fr(null,null,m,v,jt))},catch:function(m){var v,x;return arguments.length===1?this.then(null,m):(v=m,x=arguments[1],typeof v=="function"?this.then(null,function(E){return(E instanceof v?x:mr)(E)}):this.then(null,function(E){return(E&&E.name===v?x:mr)(E)}))},finally:function(m){return this.then(function(v){return Lt.resolve(m()).then(function(){return v})},function(v){return Lt.resolve(m()).then(function(){return mr(v)})})},timeout:function(m,v){var x=this;return m<1/0?new Lt(function(E,R){var O=setTimeout(function(){return R(new kt.Timeout(v))},m);x.then(E,R).finally(clearTimeout.bind(null,O))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&_(Lt.prototype,Symbol.toStringTag,"Dexie.Promise"),kn.env=Al(),w(Lt,{all:function(){var m=Ct.apply(null,arguments).map(Sa);return new Lt(function(v,x){m.length===0&&v([]);var E=m.length;m.forEach(function(R,O){return Lt.resolve(R).then(function(P){m[O]=P,--E||v(m)},x)})})},resolve:function(m){return m instanceof Lt?m:m&&typeof m.then=="function"?new Lt(function(v,x){m.then(v,x)}):new Lt(cr,!0,m)},reject:mr,race:function(){var m=Ct.apply(null,arguments).map(Sa);return new Lt(function(v,x){m.map(function(E){return Lt.resolve(E).then(v,x)})})},PSD:{get:function(){return jt},set:function(m){return jt=m}},totalEchoes:{get:function(){return yr}},newPSD:ze,usePSD:yi,scheduler:{get:function(){return hr},set:function(m){hr=m}},rejectionMapper:{get:function(){return Nn},set:function(m){Nn=m}},follow:function(m,v){return new Lt(function(x,E){return ze(function(R,O){var P=jt;P.unhandleds=[],P.onunhandled=O,P.finalize=de(function(){var B,K=this;B=function(){K.unhandleds.length===0?R():O(K.unhandleds[0])},oo.push(function nt(){B(),oo.splice(oo.indexOf(nt),1)}),++ks,hr(function(){--ks==0&&xl()},[])},P.finalize),m()},v,x,E)})}}),ss&&(ss.allSettled&&_(Lt,"allSettled",function(){var m=Ct.apply(null,arguments).map(Sa);return new Lt(function(v){m.length===0&&v([]);var x=m.length,E=new Array(x);m.forEach(function(R,O){return Lt.resolve(R).then(function(P){return E[O]={status:"fulfilled",value:P}},function(P){return E[O]={status:"rejected",reason:P}}).then(function(){return--x||v(E)})})})}),ss.any&&typeof AggregateError<"u"&&_(Lt,"any",function(){var m=Ct.apply(null,arguments).map(Sa);return new Lt(function(v,x){m.length===0&&x(new AggregateError([]));var E=m.length,R=new Array(E);m.forEach(function(O,P){return Lt.resolve(O).then(function(B){return v(B)},function(B){R[P]=B,--E||x(new AggregateError(R))})})})}),ss.withResolvers)&&(Lt.withResolvers=ss.withResolvers);var sn={awaits:0,echoes:0,id:0},Sl=0,xa=[],gr=0,yr=0,os=0;function ze(m,P,x,E){var R=jt,O=Object.create(R),P=(O.parent=R,O.ref=0,O.global=!1,O.id=++os,kn.env,O.env=va?{Promise:Lt,PromiseProp:{value:Lt,configurable:!0,writable:!0},all:Lt.all,race:Lt.race,allSettled:Lt.allSettled,any:Lt.any,resolve:Lt.resolve,reject:Lt.reject}:{},P&&d(O,P),++R.ref,O.finalize=function(){--this.parent.ref||this.parent.finalize()},yi(O,m,x,E));return O.ref===0&&O.finalize(),P}function an(){return sn.id||(sn.id=++Sl),++sn.awaits,sn.echoes+=Hn,sn.id}function Zn(){return!!sn.awaits&&(--sn.awaits==0&&(sn.id=0),sn.echoes=sn.awaits*Hn,!0)}function Sa(m){return sn.echoes&&m&&m.constructor===ss?(an(),m.then(function(v){return Zn(),v},function(v){return Zn(),ke(v)})):m}function wd(){var m=xa[xa.length-1];xa.pop(),ls(m,!1)}function ls(m,v){var x,E,R=jt;(v?!sn.echoes||gr++&&m===jt:!gr||--gr&&m===jt)||queueMicrotask(v?(function(O){++yr,sn.echoes&&--sn.echoes!=0||(sn.echoes=sn.awaits=sn.id=0),xa.push(jt),ls(O,!0)}).bind(null,m):wd),m!==jt&&(jt=m,R===kn&&(kn.env=Al()),va)&&(x=kn.env.Promise,E=m.env,R.global||m.global)&&(Object.defineProperty(l,"Promise",E.PromiseProp),x.all=E.all,x.race=E.race,x.resolve=E.resolve,x.reject=E.reject,E.allSettled&&(x.allSettled=E.allSettled),E.any)&&(x.any=E.any)}function Al(){var m=l.Promise;return va?{Promise:m,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:m.all,race:m.race,allSettled:m.allSettled,any:m.any,resolve:m.resolve,reject:m.reject}:{}}function yi(m,v,x,E,R){var O=jt;try{return ls(m,!0),v(x,E,R)}finally{ls(O,!1)}}function lo(m,v,x,E){return typeof m!="function"?m:function(){var R=jt;x&&an(),ls(v,!0);try{return m.apply(this,arguments)}finally{ls(R,!1),E&&queueMicrotask(Zn)}}}function cs(m){Promise===ss&&sn.echoes===0?gr===0?m():enqueueNativeMicroTask(m):setTimeout(m,0)}(""+Vs).indexOf("[native code]")===-1&&(an=Zn=yt);var ke=Lt.reject,bi="",Gn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",rn="String expected.",Ps=[],br="__dbnames",Yi="readonly",us="readwrite";function Bs(m,v){return m?v?function(){return m.apply(this,arguments)&&v.apply(this,arguments)}:m:v}var El={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function vr(m){return typeof m!="string"||/\./.test(m)?function(v){return v}:function(v){return v[m]===void 0&&m in v&&delete(v=At(v))[m],v}}function su(){throw kt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function he(m,v){try{var x=wr(m),E=wr(v);if(x!==E)return x==="Array"?1:E==="Array"?-1:x==="binary"?1:E==="binary"?-1:x==="string"?1:E==="string"?-1:x==="Date"?1:E!=="Date"?NaN:-1;switch(x){case"number":case"Date":case"string":return v<m?1:m<v?-1:0;case"binary":for(var R=Ni(m),O=Ni(v),P=R.length,B=O.length,K=P<B?P:B,nt=0;nt<K;++nt)if(R[nt]!==O[nt])return R[nt]<O[nt]?-1:1;return P===B?0:P<B?-1:1;case"Array":for(var $=m,V=v,Q=$.length,Z=V.length,X=Q<Z?Q:Z,Y=0;Y<X;++Y){var st=he($[Y],V[Y]);if(st!==0)return st}return Q===Z?0:Q<Z?-1:1}}catch{}return NaN}function wr(m){var v=typeof m;return v=="object"&&(ArrayBuffer.isView(m)||(v=qt(m))==="ArrayBuffer")?"binary":v}function Ni(m){return m instanceof Uint8Array?m:ArrayBuffer.isView(m)?new Uint8Array(m.buffer,m.byteOffset,m.byteLength):new Uint8Array(m)}function Ln(m,v,x){var E=m.schema.yProps;return E?(v&&0<x.numFailures&&(v=v.filter(function(R,O){return!x.failures[O]})),Promise.all(E.map(function(R){return R=R.updatesTable,v?m.db.table(R).where("k").anyOf(v).delete():m.db.table(R).clear()})).then(function(){return x})):x}au.prototype.execute=function(m){var v=this["@@propmod"];if(v.add!==void 0){var x=v.add;if(u(x))return a(a([],u(m)?m:[],!0),x).sort();if(typeof x=="number")return(Number(m)||0)+x;if(typeof x=="bigint")try{return BigInt(m)+x}catch{return BigInt(0)+x}throw new TypeError("Invalid term ".concat(x))}if(v.remove!==void 0){var E=v.remove;if(u(E))return u(m)?m.filter(function(R){return!E.includes(R)}).sort():[];if(typeof E=="number")return Number(m)-E;if(typeof E=="bigint")try{return BigInt(m)-E}catch{return BigInt(0)-E}throw new TypeError("Invalid subtrahend ".concat(E))}return x=(x=v.replacePrefix)==null?void 0:x[0],x&&typeof m=="string"&&m.startsWith(x)?v.replacePrefix[1]+m.substring(x.length):m};var Aa=au;function au(m){this["@@propmod"]=m}function co(m,v){for(var x=c(v),E=x.length,R=!1,O=0;O<E;++O){var P=x[O],B=v[P],K=z(m,P);B instanceof Aa?(H(m,P,B.execute(K)),R=!0):K!==B&&(H(m,P,B),R=!0)}return R}Ae.prototype._trans=function(m,v,x){var E=this._tx||jt.trans,R=this.name,O=En&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(m==="readonly"?"read":"write"," ").concat(this.name));function P(nt,$,V){if(V.schema[R])return v(V.idbtrans,V);throw new kt.NotFound("Table "+R+" not part of transaction")}var B=rs();try{var K=E&&E.db._novip===this.db._novip?E===jt.trans?E._promise(m,P,x):ze(function(){return E._promise(m,P,x)},{trans:E,transless:jt.transless||jt}):(function nt($,V,Q,Z){if($.idbdb&&($._state.openComplete||jt.letThrough||$._vip)){var X=$._createTransaction(V,Q,$._dbSchema);try{X.create(),$._state.PR1398_maxLoop=3}catch(Y){return Y.name===re.InvalidState&&$.isOpen()&&0<--$._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$.close({disableAutoOpen:!1}),$.open().then(function(){return nt($,V,Q,Z)})):ke(Y)}return X._promise(V,function(Y,st){return ze(function(){return jt.trans=X,Z(Y,st,X)})}).then(function(Y){if(V==="readwrite")try{X.idbtrans.commit()}catch{}return V==="readonly"?Y:X._completion.then(function(){return Y})})}if($._state.openComplete)return ke(new kt.DatabaseClosed($._state.dbOpenError));if(!$._state.isBeingOpened){if(!$._state.autoOpen)return ke(new kt.DatabaseClosed);$.open().catch(yt)}return $._state.dbReadyPromise.then(function(){return nt($,V,Q,Z)})})(this.db,m,[this.name],P);return O&&(K._consoleTask=O,K=K.catch(function(nt){return console.trace(nt),ke(nt)})),K}finally{B&&Oi()}},Ae.prototype.get=function(m,v){var x=this;return m&&m.constructor===Object?this.where(m).first(v):m==null?ke(new kt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(E){return x.core.get({trans:E,key:m}).then(function(R){return x.hook.reading.fire(R)})}).then(v)},Ae.prototype.where=function(m){if(typeof m=="string")return new this.db.WhereClause(this,m);if(u(m))return new this.db.WhereClause(this,"[".concat(m.join("+"),"]"));var v=c(m);if(v.length===1)return this.where(v[0]).equals(m[v[0]]);var x=this.schema.indexes.concat(this.schema.primKey).filter(function(B){if(B.compound&&v.every(function(nt){return 0<=B.keyPath.indexOf(nt)})){for(var K=0;K<v.length;++K)if(v.indexOf(B.keyPath[K])===-1)return!1;return!0}return!1}).sort(function(B,K){return B.keyPath.length-K.keyPath.length})[0];if(x&&this.db._maxKey!==bi)return P=x.keyPath.slice(0,v.length),this.where(P).equals(P.map(function(B){return m[B]}));!x&&En&&console.warn("The query ".concat(JSON.stringify(m)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(v.join("+"),"]"));var E=this.schema.idxByName;function R(B,K){return he(B,K)===0}var P=v.reduce(function($,K){var nt=$[0],$=$[1],V=E[K],Q=m[K];return[nt||V,nt||!V?Bs($,V&&V.multi?function(Z){return Z=z(Z,K),u(Z)&&Z.some(function(X){return R(Q,X)})}:function(Z){return R(Q,z(Z,K))}):$]},[null,null]),O=P[0],P=P[1];return O?this.where(O.name).equals(m[O.keyPath]).filter(P):x?this.filter(P):this.where(v).equals("")},Ae.prototype.filter=function(m){return this.toCollection().and(m)},Ae.prototype.count=function(m){return this.toCollection().count(m)},Ae.prototype.offset=function(m){return this.toCollection().offset(m)},Ae.prototype.limit=function(m){return this.toCollection().limit(m)},Ae.prototype.each=function(m){return this.toCollection().each(m)},Ae.prototype.toArray=function(m){return this.toCollection().toArray(m)},Ae.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ae.prototype.orderBy=function(m){return new this.db.Collection(new this.db.WhereClause(this,u(m)?"[".concat(m.join("+"),"]"):m))},Ae.prototype.reverse=function(){return this.toCollection().reverse()},Ae.prototype.mapToClass=function(m){for(var v=this.db,x=this.name,E=((this.schema.mappedClass=m).prototype instanceof su&&(m=(P=>{var B=$,K=P;if(typeof K!="function"&&K!==null)throw new TypeError("Class extends value "+String(K)+" is not a constructor or null");function nt(){this.constructor=B}function $(){return P!==null&&P.apply(this,arguments)||this}return e(B,K),B.prototype=K===null?Object.create(K):(nt.prototype=K.prototype,new nt),Object.defineProperty($.prototype,"db",{get:function(){return v},enumerable:!1,configurable:!0}),$.prototype.table=function(){return x},$})(m)),new Set),R=m.prototype;R;R=f(R))Object.getOwnPropertyNames(R).forEach(function(P){return E.add(P)});function O(P){if(!P)return P;var B,K=Object.create(m.prototype);for(B in P)if(!E.has(B))try{K[B]=P[B]}catch{}return K}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=O,this.hook("reading",O),m},Ae.prototype.defineClass=function(){return this.mapToClass(function(m){d(this,m)})},Ae.prototype.add=function(m,v){var x=this,E=this.schema.primKey,R=E.auto,O=E.keyPath,P=m;return O&&R&&(P=vr(O)(m)),this._trans("readwrite",function(B){return x.core.mutate({trans:B,type:"add",keys:v!=null?[v]:null,values:[P]})}).then(function(B){return B.numFailures?Lt.reject(B.failures[0]):B.lastResult}).then(function(B){if(O)try{H(m,O,B)}catch{}return B})},Ae.prototype.upsert=function(m,v){var x=this,E=this.schema.primKey.keyPath;return this._trans("readwrite",function(R){return x.core.get({trans:R,key:m}).then(function(O){var P=O??{};return co(P,v),E&&H(P,E,m),x.core.mutate({trans:R,type:"put",values:[P],keys:[m],upsert:!0,updates:{keys:[m],changeSpecs:[v]}}).then(function(B){return B.numFailures?Lt.reject(B.failures[0]):!!O})})})},Ae.prototype.update=function(m,v){return typeof m!="object"||u(m)?this.where(":id").equals(m).modify(v):(m=z(m,this.schema.primKey.keyPath))===void 0?ke(new kt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(m).modify(v)},Ae.prototype.put=function(m,v){var x=this,E=this.schema.primKey,R=E.auto,O=E.keyPath,P=m;return O&&R&&(P=vr(O)(m)),this._trans("readwrite",function(B){return x.core.mutate({trans:B,type:"put",values:[P],keys:v!=null?[v]:null})}).then(function(B){return B.numFailures?Lt.reject(B.failures[0]):B.lastResult}).then(function(B){if(O)try{H(m,O,B)}catch{}return B})},Ae.prototype.delete=function(m){var v=this;return this._trans("readwrite",function(x){return v.core.mutate({trans:x,type:"delete",keys:[m]}).then(function(E){return Ln(v,[m],E)}).then(function(E){return E.numFailures?Lt.reject(E.failures[0]):void 0})})},Ae.prototype.clear=function(){var m=this;return this._trans("readwrite",function(v){return m.core.mutate({trans:v,type:"deleteRange",range:El}).then(function(x){return Ln(m,null,x)})}).then(function(v){return v.numFailures?Lt.reject(v.failures[0]):void 0})},Ae.prototype.bulkGet=function(m){var v=this;return this._trans("readonly",function(x){return v.core.getMany({keys:m,trans:x}).then(function(E){return E.map(function(R){return v.hook.reading.fire(R)})})})},Ae.prototype.bulkAdd=function(m,v,x){var E=this,R=Array.isArray(v)?v:void 0,O=(x=x||(R?void 0:v))?x.allKeys:void 0;return this._trans("readwrite",function(P){var B=E.schema.primKey,nt=B.auto,B=B.keyPath;if(B&&R)throw new kt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(R&&R.length!==m.length)throw new kt.InvalidArgument("Arguments objects and keys must have the same length");var K=m.length,nt=B&&nt?m.map(vr(B)):m;return E.core.mutate({trans:P,type:"add",keys:R,values:nt,wantResults:O}).then(function($){var V=$.numFailures,Q=$.failures;if(V===0)return O?$.results:$.lastResult;throw new It("".concat(E.name,".bulkAdd(): ").concat(V," of ").concat(K," operations failed"),Q)})})},Ae.prototype.bulkPut=function(m,v,x){var E=this,R=Array.isArray(v)?v:void 0,O=(x=x||(R?void 0:v))?x.allKeys:void 0;return this._trans("readwrite",function(P){var B=E.schema.primKey,nt=B.auto,B=B.keyPath;if(B&&R)throw new kt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(R&&R.length!==m.length)throw new kt.InvalidArgument("Arguments objects and keys must have the same length");var K=m.length,nt=B&&nt?m.map(vr(B)):m;return E.core.mutate({trans:P,type:"put",keys:R,values:nt,wantResults:O}).then(function($){var V=$.numFailures,Q=$.failures;if(V===0)return O?$.results:$.lastResult;throw new It("".concat(E.name,".bulkPut(): ").concat(V," of ").concat(K," operations failed"),Q)})})},Ae.prototype.bulkUpdate=function(m){var v=this,x=this.core,E=m.map(function(P){return P.key}),R=m.map(function(P){return P.changes}),O=[];return this._trans("readwrite",function(P){return x.getMany({trans:P,keys:E,cache:"clone"}).then(function(B){var K=[],nt=[],$=(m.forEach(function(V,Q){var Z=V.key,X=V.changes,Y=B[Q];if(Y){for(var st=0,ot=Object.keys(X);st<ot.length;st++){var it=ot[st],pt=X[it];if(it===v.schema.primKey.keyPath){if(he(pt,Z)!==0)throw new kt.Constraint("Cannot update primary key in bulkUpdate()")}else H(Y,it,pt)}O.push(Q),K.push(Z),nt.push(Y)}}),K.length);return x.mutate({trans:P,type:"put",keys:K,values:nt,updates:{keys:E,changeSpecs:R}}).then(function(V){var Q=V.numFailures,Z=V.failures;if(Q===0)return $;for(var X=0,Y=Object.keys(Z);X<Y.length;X++){var st,ot=Y[X],it=O[Number(ot)];it!=null&&(st=Z[ot],delete Z[ot],Z[it]=st)}throw new It("".concat(v.name,".bulkUpdate(): ").concat(Q," of ").concat($," operations failed"),Z)})})})},Ae.prototype.bulkDelete=function(m){var v=this,x=m.length;return this._trans("readwrite",function(E){return v.core.mutate({trans:E,type:"delete",keys:m}).then(function(R){return Ln(v,m,R)})}).then(function(E){var R=E.numFailures,O=E.failures;if(R===0)return E.lastResult;throw new It("".concat(v.name,".bulkDelete(): ").concat(R," of ").concat(x," operations failed"),O)})};var _l=Ae;function Ae(){}function xr(m){function v(P,B){if(B){for(var K=arguments.length,nt=new Array(K-1);--K;)nt[K-1]=arguments[K];return x[P].subscribe.apply(null,nt),m}if(typeof P=="string")return x[P]}var x={};v.addEventType=O;for(var E=1,R=arguments.length;E<R;++E)O(arguments[E]);return v;function O(P,B,K){var nt,$;if(typeof P!="object")return B=B||Di,$={subscribers:[],fire:K=K||yt,subscribe:function(V){$.subscribers.indexOf(V)===-1&&($.subscribers.push(V),$.fire=B($.fire,V))},unsubscribe:function(V){$.subscribers=$.subscribers.filter(function(Q){return Q!==V}),$.fire=$.subscribers.reduce(B,K)}},x[P]=v[P]=$;c(nt=P).forEach(function(V){var Q=nt[V];if(u(Q))O(V,nt[V][0],nt[V][1]);else{if(Q!=="asap")throw new kt.InvalidArgument("Invalid event config");var Z=O(V,le,function(){for(var X=arguments.length,Y=new Array(X);X--;)Y[X]=arguments[X];Z.subscribers.forEach(function(st){F(function(){st.apply(null,Y)})})})}})}}function _n(m,v){return A(v).from({prototype:m}),v}function hs(m,v){return!(m.filter||m.algorithm||m.or)&&(v?m.justLimit:!m.replayFilter)}function uo(m,v){m.filter=Bs(m.filter,v)}function Sr(m,v,x){var E=m.replayFilter;m.replayFilter=E?function(){return Bs(E(),v())}:v,m.justLimit=x&&!E}function Qi(m,v){if(m.isPrimKey)return v.primaryKey;var x=v.getIndexByKeyPath(m.index);if(x)return x;throw new kt.Schema("KeyPath "+m.index+" on object store "+v.name+" is not indexed")}function Cl(m,v,x){var E=Qi(m,v.schema);return v.openCursor({trans:x,values:!m.keysOnly,reverse:m.dir==="prev",unique:!!m.unique,query:{index:E,range:m.range}})}function Ar(m,v,x,E){var R,O,P=m.replayFilter?Bs(m.filter,m.replayFilter()):m.filter;return m.or?(R={},O=function(B,K,nt){var $,V;P&&!P(K,nt,function(Q){return K.stop(Q)},function(Q){return K.fail(Q)})||((V=""+($=K.primaryKey))=="[object ArrayBuffer]"&&(V=""+new Uint8Array($)),y(R,V))||(R[V]=!0,v(B,K,nt))},Promise.all([m.or._iterate(O,x),js(Cl(m,E,x),m.algorithm,O,!m.keysOnly&&m.valueMapper)])):js(Cl(m,E,x),Bs(m.algorithm,P),v,!m.keysOnly&&m.valueMapper)}function js(m,v,x,E){var R=Ie(E?function(O,P,B){return x(E(O),P,B)}:x);return m.then(function(O){if(O)return O.start(function(){var P=function(){return O.continue()};v&&!v(O,function(B){return P=B},function(B){O.stop(B),P=yt},function(B){O.fail(B),P=yt})||R(O.value,O,function(B){return P=B}),P()})})}be.prototype._read=function(m,v){var x=this._ctx;return x.error?x.table._trans(null,ke.bind(null,x.error)):x.table._trans("readonly",m).then(v)},be.prototype._write=function(m){var v=this._ctx;return v.error?v.table._trans(null,ke.bind(null,v.error)):v.table._trans("readwrite",m,"locked")},be.prototype._addAlgorithm=function(m){var v=this._ctx;v.algorithm=Bs(v.algorithm,m)},be.prototype._iterate=function(m,v){return Ar(this._ctx,m,v,this._ctx.table.core)},be.prototype.clone=function(m){var v=Object.create(this.constructor.prototype),x=Object.create(this._ctx);return m&&d(x,m),v._ctx=x,v},be.prototype.raw=function(){return this._ctx.valueMapper=null,this},be.prototype.each=function(m){var v=this._ctx;return this._read(function(x){return Ar(v,m,x,v.table.core)})},be.prototype.count=function(m){var v=this;return this._read(function(x){var E,R=v._ctx,O=R.table.core;return hs(R,!0)?O.count({trans:x,query:{index:Qi(R,O.schema),range:R.range}}).then(function(P){return Math.min(P,R.limit)}):(E=0,Ar(R,function(){return++E,!1},x,O).then(function(){return E}))}).then(m)},be.prototype.sortBy=function(m,v){var x=m.split(".").reverse(),E=x[0],R=x.length-1;function O(K,nt){return nt?O(K[x[nt]],nt-1):K[E]}var P=this._ctx.dir==="next"?1:-1;function B(K,nt){return he(O(K,R),O(nt,R))*P}return this.toArray(function(K){return K.sort(B)}).then(v)},be.prototype.toArray=function(m){var v=this;return this._read(function(x){var E,R,O,P=v._ctx;return P.dir==="next"&&hs(P,!0)&&0<P.limit?(E=P.valueMapper,R=Qi(P,P.table.core.schema),P.table.core.query({trans:x,limit:P.limit,values:!0,query:{index:R,range:P.range}}).then(function(B){return B=B.result,E?B.map(E):B})):(O=[],Ar(P,function(B){return O.push(B)},x,P.table.core).then(function(){return O}))},m)},be.prototype.offset=function(m){var v=this._ctx;return m<=0||(v.offset+=m,hs(v)?Sr(v,function(){var x=m;return function(E,R){return x===0||(x===1?--x:R(function(){E.advance(x),x=0}),!1)}}):Sr(v,function(){var x=m;return function(){return--x<0}})),this},be.prototype.limit=function(m){return this._ctx.limit=Math.min(this._ctx.limit,m),Sr(this._ctx,function(){var v=m;return function(x,E,R){return--v<=0&&E(R),0<=v}},!0),this},be.prototype.until=function(m,v){return uo(this._ctx,function(x,E,R){return!m(x.value)||(E(R),v)}),this},be.prototype.first=function(m){return this.limit(1).toArray(function(v){return v[0]}).then(m)},be.prototype.last=function(m){return this.reverse().first(m)},be.prototype.filter=function(m){var v;return uo(this._ctx,function(x){return m(x.value)}),(v=this._ctx).isMatch=Bs(v.isMatch,m),this},be.prototype.and=function(m){return this.filter(m)},be.prototype.or=function(m){return new this.db.WhereClause(this._ctx.table,m,this)},be.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},be.prototype.desc=function(){return this.reverse()},be.prototype.eachKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(x,E){m(E.key,E)})},be.prototype.eachUniqueKey=function(m){return this._ctx.unique="unique",this.eachKey(m)},be.prototype.eachPrimaryKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(x,E){m(E.primaryKey,E)})},be.prototype.keys=function(m){var v=this._ctx,x=(v.keysOnly=!v.isMatch,[]);return this.each(function(E,R){x.push(R.key)}).then(function(){return x}).then(m)},be.prototype.primaryKeys=function(m){var v=this._ctx;if(v.dir==="next"&&hs(v,!0)&&0<v.limit)return this._read(function(E){var R=Qi(v,v.table.core.schema);return v.table.core.query({trans:E,values:!1,limit:v.limit,query:{index:R,range:v.range}})}).then(function(E){return E.result}).then(m);v.keysOnly=!v.isMatch;var x=[];return this.each(function(E,R){x.push(R.primaryKey)}).then(function(){return x}).then(m)},be.prototype.uniqueKeys=function(m){return this._ctx.unique="unique",this.keys(m)},be.prototype.firstKey=function(m){return this.limit(1).keys(function(v){return v[0]}).then(m)},be.prototype.lastKey=function(m){return this.reverse().firstKey(m)},be.prototype.distinct=function(){var m,v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];return v&&v.multi&&(m={},uo(this._ctx,function(E){var E=E.primaryKey.toString(),R=y(m,E);return m[E]=!0,!R})),this},be.prototype.modify=function(m){var v=this,x=this._ctx;return this._write(function(E){function R(Y,st){var ot=st.failures;Q+=Y-st.numFailures;for(var it=0,pt=c(ot);it<pt.length;it++){var St=pt[it];V.push(ot[St])}}var O=typeof m=="function"?m:function(Y){return co(Y,m)},P=x.table.core,$=P.schema.primaryKey,B=$.outbound,K=$.extractKey,nt=200,$=v.db._options.modifyChunkSize,V=($&&(nt=typeof $=="object"?$[P.name]||$["*"]||200:$),[]),Q=0,Z=[],X=m===Tl;return v.clone().primaryKeys().then(function(Y){function st(it){var pt=Math.min(nt,Y.length-it),St=Y.slice(it,it+pt);return(X?Promise.resolve([]):P.getMany({trans:E,keys:St,cache:"immutable"})).then(function(Dt){var Ot=[],Et=[],Ut=B?[]:null,Pt=X?St:[];if(!X)for(var _t=0;_t<pt;++_t){var zt=Dt[_t],ee={value:At(zt),primKey:Y[it+_t]};O.call(ee,ee.value,ee)!==!1&&(ee.value==null?Pt.push(Y[it+_t]):B||he(K(zt),K(ee.value))===0?(Et.push(ee.value),B&&Ut.push(Y[it+_t])):(Pt.push(Y[it+_t]),Ot.push(ee.value)))}return Promise.resolve(0<Ot.length&&P.mutate({trans:E,type:"add",values:Ot}).then(function(fe){for(var Yt in fe.failures)Pt.splice(parseInt(Yt),1);R(Ot.length,fe)})).then(function(){return(0<Et.length||ot&&typeof m=="object")&&P.mutate({trans:E,type:"put",keys:Ut,values:Et,criteria:ot,changeSpec:typeof m!="function"&&m,isAdditionalChunk:0<it}).then(function(fe){return R(Et.length,fe)})}).then(function(){return(0<Pt.length||ot&&X)&&P.mutate({trans:E,type:"delete",keys:Pt,criteria:ot,isAdditionalChunk:0<it}).then(function(fe){return Ln(x.table,Pt,fe)}).then(function(fe){return R(Pt.length,fe)})}).then(function(){return Y.length>it+pt&&st(it+nt)})})}var ot=hs(x)&&x.limit===1/0&&(typeof m!="function"||X)&&{index:x.index,range:x.range};return st(0).then(function(){if(0<V.length)throw new Ft("Error modifying one or more objects",V,Q,Z);return Y.length})})})},be.prototype.delete=function(){var m=this._ctx,v=m.range;return!hs(m)||m.table.schema.yProps||!m.isPrimKey&&v.type!==3?this.modify(Tl):this._write(function(x){var E=m.table.core.schema.primaryKey,R=v;return m.table.core.count({trans:x,query:{index:E,range:R}}).then(function(O){return m.table.core.mutate({trans:x,type:"deleteRange",range:R}).then(function(K){var B=K.failures,K=K.numFailures;if(K)throw new Ft("Could not delete some values",Object.keys(B).map(function(nt){return B[nt]}),O-K);return O-K})})})};var xd=be;function be(){}var Tl=function(m,v){return v.value=null};function Rl(m,v){return m<v?-1:m===v?0:1}function Sd(m,v){return v<m?-1:m===v?0:1}function Jn(m,v,x){return m=m instanceof Fs?new m.Collection(m):m,m._ctx.error=new(x||TypeError)(v),m}function Wi(m){return new m.Collection(m,function(){return ho("")}).limit(0)}function ai(Z,v,x,E){var R,O,P,B,K,nt,$,V=x.length;if(!x.every(function(Y){return typeof Y=="string"}))return Jn(Z,rn);function Q(Y){R=Y==="next"?function(ot){return ot.toUpperCase()}:function(ot){return ot.toLowerCase()},O=Y==="next"?function(ot){return ot.toLowerCase()}:function(ot){return ot.toUpperCase()},P=Y==="next"?Rl:Sd;var st=x.map(function(ot){return{lower:O(ot),upper:R(ot)}}).sort(function(ot,it){return P(ot.lower,it.lower)});B=st.map(function(ot){return ot.upper}),K=st.map(function(ot){return ot.lower}),$=(nt=Y)==="next"?"":E}Q("next");var Z=new Z.Collection(Z,function(){return ki(B[0],K[V-1]+E)}),X=(Z._ondirectionchange=function(Y){Q(Y)},0);return Z._addAlgorithm(function(Y,st,ot){var it=Y.key;if(typeof it=="string"){var pt=O(it);if(v(pt,K,X))return!0;for(var St=null,Dt=X;Dt<V;++Dt){var Ot=((Et,Ut,Pt,_t,zt,ee)=>{for(var fe=Math.min(Et.length,_t.length),Yt=-1,se=0;se<fe;++se){var Le=Ut[se];if(Le!==_t[se])return zt(Et[se],Pt[se])<0?Et.substr(0,se)+Pt[se]+Pt.substr(se+1):zt(Et[se],_t[se])<0?Et.substr(0,se)+_t[se]+Pt.substr(se+1):0<=Yt?Et.substr(0,Yt)+Ut[Yt]+Pt.substr(Yt+1):null;zt(Et[se],Le)<0&&(Yt=se)}return fe<_t.length&&ee==="next"?Et+Pt.substr(Et.length):fe<Et.length&&ee==="prev"?Et.substr(0,Pt.length):Yt<0?null:Et.substr(0,Yt)+_t[Yt]+Pt.substr(Yt+1)})(it,pt,B[Dt],K[Dt],P,nt);Ot===null&&St===null?X=Dt+1:(St===null||0<P(St,Ot))&&(St=Ot)}st(St!==null?function(){Y.continue(St+$)}:ot)}return!1}),Z}function ki(m,v,x,E){return{type:2,lower:m,upper:v,lowerOpen:x,upperOpen:E}}function ho(m){return{type:1,lower:m,upper:m}}Object.defineProperty(qe.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),qe.prototype.between=function(m,v,x,E){x=x!==!1,E=E===!0;try{return 0<this._cmp(m,v)||this._cmp(m,v)===0&&(x||E)&&(!x||!E)?Wi(this):new this.Collection(this,function(){return ki(m,v,!x,!E)})}catch{return Jn(this,Gn)}},qe.prototype.equals=function(m){return m==null?Jn(this,Gn):new this.Collection(this,function(){return ho(m)})},qe.prototype.above=function(m){return m==null?Jn(this,Gn):new this.Collection(this,function(){return ki(m,void 0,!0)})},qe.prototype.aboveOrEqual=function(m){return m==null?Jn(this,Gn):new this.Collection(this,function(){return ki(m,void 0,!1)})},qe.prototype.below=function(m){return m==null?Jn(this,Gn):new this.Collection(this,function(){return ki(void 0,m,!1,!0)})},qe.prototype.belowOrEqual=function(m){return m==null?Jn(this,Gn):new this.Collection(this,function(){return ki(void 0,m)})},qe.prototype.startsWith=function(m){return typeof m!="string"?Jn(this,rn):this.between(m,m+bi,!0,!0)},qe.prototype.startsWithIgnoreCase=function(m){return m===""?this.startsWith(m):ai(this,function(v,x){return v.indexOf(x[0])===0},[m],bi)},qe.prototype.equalsIgnoreCase=function(m){return ai(this,function(v,x){return v===x[0]},[m],"")},qe.prototype.anyOfIgnoreCase=function(){var m=Ct.apply(Xt,arguments);return m.length===0?Wi(this):ai(this,function(v,x){return x.indexOf(v)!==-1},m,"")},qe.prototype.startsWithAnyOfIgnoreCase=function(){var m=Ct.apply(Xt,arguments);return m.length===0?Wi(this):ai(this,function(v,x){return x.some(function(E){return v.indexOf(E)===0})},m,bi)},qe.prototype.anyOf=function(){var m,v,x=this,E=Ct.apply(Xt,arguments),R=this._cmp;try{E.sort(R)}catch{return Jn(this,Gn)}return E.length===0?Wi(this):((m=new this.Collection(this,function(){return ki(E[0],E[E.length-1])}))._ondirectionchange=function(O){R=O==="next"?x._ascending:x._descending,E.sort(R)},v=0,m._addAlgorithm(function(O,P,B){for(var K=O.key;0<R(K,E[v]);)if(++v===E.length)return P(B),!1;return R(K,E[v])===0||(P(function(){O.continue(E[v])}),!1)}),m)},qe.prototype.notEqual=function(m){return this.inAnyRange([[-1/0,m],[m,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},qe.prototype.noneOf=function(){var m=Ct.apply(Xt,arguments);if(m.length===0)return new this.Collection(this);try{m.sort(this._ascending)}catch{return Jn(this,Gn)}var v=m.reduce(function(x,E){return x?x.concat([[x[x.length-1][1],E]]):[[-1/0,E]]},null);return v.push([m[m.length-1],this.db._maxKey]),this.inAnyRange(v,{includeLowers:!1,includeUppers:!1})},qe.prototype.inAnyRange=function(m,ot){var x=this,E=this._cmp,R=this._ascending,O=this._descending,P=this._min,B=this._max;if(m.length===0)return Wi(this);if(!m.every(function(it){return it[0]!==void 0&&it[1]!==void 0&&R(it[0],it[1])<=0}))return Jn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",kt.InvalidArgument);var K=!ot||ot.includeLowers!==!1,nt=ot&&ot.includeUppers===!0,$,V=R;function Q(it,pt){return V(it[0],pt[0])}try{($=m.reduce(function(it,pt){for(var St=0,Dt=it.length;St<Dt;++St){var Ot=it[St];if(E(pt[0],Ot[1])<0&&0<E(pt[1],Ot[0])){Ot[0]=P(Ot[0],pt[0]),Ot[1]=B(Ot[1],pt[1]);break}}return St===Dt&&it.push(pt),it},[])).sort(Q)}catch{return Jn(this,Gn)}var Z=0,X=nt?function(it){return 0<R(it,$[Z][1])}:function(it){return 0<=R(it,$[Z][1])},Y=K?function(it){return 0<O(it,$[Z][0])}:function(it){return 0<=O(it,$[Z][0])},st=X,ot=new this.Collection(this,function(){return ki($[0][0],$[$.length-1][1],!K,!nt)});return ot._ondirectionchange=function(it){V=it==="next"?(st=X,R):(st=Y,O),$.sort(Q)},ot._addAlgorithm(function(it,pt,St){for(var Dt,Ot=it.key;st(Ot);)if(++Z===$.length)return pt(St),!1;return!X(Dt=Ot)&&!Y(Dt)||(x._cmp(Ot,$[Z][1])===0||x._cmp(Ot,$[Z][0])===0||pt(function(){V===R?it.continue($[Z][0]):it.continue($[Z][1])}),!1)}),ot},qe.prototype.startsWithAnyOf=function(){var m=Ct.apply(Xt,arguments);return m.every(function(v){return typeof v=="string"})?m.length===0?Wi(this):this.inAnyRange(m.map(function(v){return[v,v+bi]})):Jn(this,"startsWithAnyOf() only works with strings")};var Fs=qe;function qe(){}function vi(m){return Ie(function(v){return Is(v),m(v.target.error),!1})}function Is(m){m.stopPropagation&&m.stopPropagation(),m.preventDefault&&m.preventDefault()}var Ea="storagemutated",Us="x-storagemutated-1",Cn=xr(null,Ea),Ml=(Vn.prototype._lock=function(){return j(!jt.global),++this._reculock,this._reculock!==1||jt.global||(jt.lockOwnerFor=this),this},Vn.prototype._unlock=function(){if(j(!jt.global),--this._reculock==0)for(jt.global||(jt.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var m=this._blockedFuncs.shift();try{yi(m[1],m[0])}catch{}}return this},Vn.prototype._locked=function(){return this._reculock&&jt.lockOwnerFor!==this},Vn.prototype.create=function(m){var v=this;if(this.mode){var x=this.db.idbdb,E=this.db._state.dbOpenError;if(j(!this.idbtrans),!m&&!x)switch(E&&E.name){case"DatabaseClosedError":throw new kt.DatabaseClosed(E);case"MissingAPIError":throw new kt.MissingAPI(E.message,E);default:throw new kt.OpenFailed(E)}if(!this.active)throw new kt.TransactionInactive;j(this._completion._state===null),(m=this.idbtrans=m||(this.db.core||x).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ie(function(R){Is(R),v._reject(m.error)}),m.onabort=Ie(function(R){Is(R),v.active&&v._reject(new kt.Abort(m.error)),v.active=!1,v.on("abort").fire(R)}),m.oncomplete=Ie(function(){v.active=!1,v._resolve(),"mutatedParts"in m&&Cn.storagemutated.fire(m.mutatedParts)})}return this},Vn.prototype._promise=function(m,v,x){var E,R=this;return m==="readwrite"&&this.mode!=="readwrite"?ke(new kt.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Lt(function(O,P){R._blockedFuncs.push([function(){R._promise(m,v,x).then(O,P)},jt])}):x?ze(function(){var O=new Lt(function(P,B){R._lock();var K=v(P,B,R);K&&K.then&&K.then(P,B)});return O.finally(function(){return R._unlock()}),O._lib=!0,O}):((E=new Lt(function(O,P){var B=v(O,P,R);B&&B.then&&B.then(O,P)}))._lib=!0,E):ke(new kt.TransactionInactive)},Vn.prototype._root=function(){return this.parent?this.parent._root():this},Vn.prototype.waitFor=function(m){var v,x=this._root(),E=Lt.resolve(m),R=(x._waitingFor?x._waitingFor=x._waitingFor.then(function(){return E}):(x._waitingFor=E,x._waitingQueue=[],v=x.idbtrans.objectStore(x.storeNames[0]),(function O(){for(++x._spinCount;x._waitingQueue.length;)x._waitingQueue.shift()();x._waitingFor&&(v.get(-1/0).onsuccess=O)})()),x._waitingFor);return new Lt(function(O,P){E.then(function(B){return x._waitingQueue.push(Ie(O.bind(null,B)))},function(B){return x._waitingQueue.push(Ie(P.bind(null,B)))}).finally(function(){x._waitingFor===R&&(x._waitingFor=null)})})},Vn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new kt.Abort))},Vn.prototype.table=function(m){var v=this._memoizedTables||(this._memoizedTables={});if(y(v,m))return v[m];var x=this.schema[m];if(x)return(x=new this.db.Table(m,x,this)).core=this.db.core.table(m),v[m]=x;throw new kt.NotFound("Table "+m+" not part of transaction")},Vn);function Vn(){}function Li(m,v,x,E,R,O,P,B){return{name:m,keyPath:v,unique:x,multi:E,auto:R,compound:O,src:(x&&!P?"&":"")+(E?"*":"")+(R?"++":"")+fo(v),type:B}}function fo(m){return typeof m=="string"?m:m?"["+[].join.call(m,"+")+"]":""}function _a(m,v,x){return{name:m,primKey:v,indexes:x,mappedClass:null,idxByName:(E=function(R){return[R.name,R]},x.reduce(function(R,O,P){return O=E(O,P),O&&(R[O[0]]=O[1]),R},{}))};var E}var Ca=function(m){try{return m.only([[]]),Ca=function(){return[[]]},[[]]}catch{return Ca=function(){return bi},bi}};function Ta(m){return m==null?function(){}:typeof m=="string"?(v=m).split(".").length===1?function(x){return x[v]}:function(x){return z(x,v)}:function(x){return z(x,m)};var v}function Er(m){return[].slice.call(m)}var ru=0;function dn(m){return m==null?":id":typeof m=="string"?m:"[".concat(m.join("+"),"]")}function zs(m,v,K){function E(X){if(X.type===3)return null;if(X.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var V=X.lower,Q=X.upper,Z=X.lowerOpen,X=X.upperOpen;return V===void 0?Q===void 0?null:v.upperBound(Q,!!X):Q===void 0?v.lowerBound(V,!!Z):v.bound(V,Q,!!Z,!!X)}function R($){var V,Q=$.name;return{name:Q,schema:$,mutate:function(Z){var X=Z.trans,Y=Z.type,st=Z.keys,ot=Z.values,it=Z.range;return new Promise(function(pt,St){pt=Ie(pt);var Dt=X.objectStore(Q),Ot=Dt.keyPath==null,Et=Y==="put"||Y==="add";if(!Et&&Y!=="delete"&&Y!=="deleteRange")throw new Error("Invalid operation type: "+Y);var Ut,Pt=(st||ot||{length:1}).length;if(st&&ot&&st.length!==ot.length)throw new Error("Given keys array must have same length as given values array.");if(Pt===0)return pt({numFailures:0,failures:{},results:[],lastResult:void 0});function _t(De){++fe,Is(De)}var zt=[],ee=[],fe=0;if(Y==="deleteRange"){if(it.type===4)return pt({numFailures:fe,failures:ee,results:[],lastResult:void 0});it.type===3?zt.push(Ut=Dt.clear()):zt.push(Ut=Dt.delete(E(it)))}else{var Ot=Et?Ot?[ot,st]:[ot,null]:[st,null],Yt=Ot[0],se=Ot[1];if(Et)for(var Le=0;Le<Pt;++Le)zt.push(Ut=se&&se[Le]!==void 0?Dt[Y](Yt[Le],se[Le]):Dt[Y](Yt[Le])),Ut.onerror=_t;else for(Le=0;Le<Pt;++Le)zt.push(Ut=Dt[Y](Yt[Le])),Ut.onerror=_t}function $n(De){De=De.target.result,zt.forEach(function(ms,ka){return ms.error!=null&&(ee[ka]=ms.error)}),pt({numFailures:fe,failures:ee,results:Y==="delete"?st:zt.map(function(ms){return ms.result}),lastResult:De})}Ut.onerror=function(De){_t(De),$n(De)},Ut.onsuccess=$n})},getMany:function(Z){var X=Z.trans,Y=Z.keys;return new Promise(function(st,ot){st=Ie(st);for(var it,pt=X.objectStore(Q),St=Y.length,Dt=new Array(St),Ot=0,Et=0,Ut=function(zt){zt=zt.target,Dt[zt._pos]=zt.result,++Et===Ot&&st(Dt)},Pt=vi(ot),_t=0;_t<St;++_t)Y[_t]!=null&&((it=pt.get(Y[_t]))._pos=_t,it.onsuccess=Ut,it.onerror=Pt,++Ot);Ot===0&&st(Dt)})},get:function(Z){var X=Z.trans,Y=Z.key;return new Promise(function(st,ot){st=Ie(st);var it=X.objectStore(Q).get(Y);it.onsuccess=function(pt){return st(pt.target.result)},it.onerror=vi(ot)})},query:(V=B,function(Z){return new Promise(function(X,Y){X=Ie(X);var st,ot,it,Et=Z.trans,pt=Z.values,St=Z.limit,Ot=Z.query,Dt=St===1/0?void 0:St,Ut=Ot.index,Ot=Ot.range,Et=Et.objectStore(Q),Et=Ut.isPrimaryKey?Et:Et.index(Ut.name),Ut=E(Ot);if(St===0)return X({result:[]});V?((Ot=pt?Et.getAll(Ut,Dt):Et.getAllKeys(Ut,Dt)).onsuccess=function(Pt){return X({result:Pt.target.result})},Ot.onerror=vi(Y)):(st=0,ot=!pt&&"openKeyCursor"in Et?Et.openKeyCursor(Ut):Et.openCursor(Ut),it=[],ot.onsuccess=function(Pt){var _t=ot.result;return!_t||(it.push(pt?_t.value:_t.primaryKey),++st===St)?X({result:it}):void _t.continue()},ot.onerror=vi(Y))})}),openCursor:function(Z){var X=Z.trans,Y=Z.values,st=Z.query,ot=Z.reverse,it=Z.unique;return new Promise(function(pt,St){pt=Ie(pt);var Et=st.index,Dt=st.range,Ot=X.objectStore(Q),Ot=Et.isPrimaryKey?Ot:Ot.index(Et.name),Et=ot?it?"prevunique":"prev":it?"nextunique":"next",Ut=!Y&&"openKeyCursor"in Ot?Ot.openKeyCursor(E(Dt),Et):Ot.openCursor(E(Dt),Et);Ut.onerror=vi(St),Ut.onsuccess=Ie(function(Pt){var _t,zt,ee,fe,Yt=Ut.result;Yt?(Yt.___id=++ru,Yt.done=!1,_t=Yt.continue.bind(Yt),zt=(zt=Yt.continuePrimaryKey)&&zt.bind(Yt),ee=Yt.advance.bind(Yt),fe=function(){throw new Error("Cursor not stopped")},Yt.trans=X,Yt.stop=Yt.continue=Yt.continuePrimaryKey=Yt.advance=function(){throw new Error("Cursor not started")},Yt.fail=Ie(St),Yt.next=function(){var se=this,Le=1;return this.start(function(){return Le--?se.continue():se.stop()}).then(function(){return se})},Yt.start=function(se){function Le(){if(Ut.result)try{se()}catch(De){Yt.fail(De)}else Yt.done=!0,Yt.start=function(){throw new Error("Cursor behind last entry")},Yt.stop()}var $n=new Promise(function(De,ms){De=Ie(De),Ut.onerror=vi(ms),Yt.fail=ms,Yt.stop=function(ka){Yt.stop=Yt.continue=Yt.continuePrimaryKey=Yt.advance=fe,De(ka)}});return Ut.onsuccess=Ie(function(De){Ut.onsuccess=Le,Le()}),Yt.continue=_t,Yt.continuePrimaryKey=zt,Yt.advance=ee,Le(),$n},pt(Yt)):pt(null)},St)})},count:function(Z){var X=Z.query,Y=Z.trans,st=X.index,ot=X.range;return new Promise(function(it,pt){var St=Y.objectStore(Q),St=st.isPrimaryKey?St:St.index(st.name),Dt=E(ot),Dt=Dt?St.count(Dt):St.count();Dt.onsuccess=Ie(function(Ot){return it(Ot.target.result)}),Dt.onerror=vi(pt)})}}}O=K,P=Er((K=m).objectStoreNames);var O,K={schema:{name:K.name,tables:P.map(function($){return O.objectStore($)}).map(function($){var V=$.keyPath,Q=$.autoIncrement,X=u(V),Z={},X={name:$.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:V==null,compound:X,keyPath:V,autoIncrement:Q,unique:!0,extractKey:Ta(V)},indexes:Er($.indexNames).map(function(Y){return $.index(Y)}).map(function(it){var pt=it.name,st=it.unique,ot=it.multiEntry,it=it.keyPath,pt={name:pt,compound:u(it),keyPath:it,unique:st,multiEntry:ot,extractKey:Ta(it)};return Z[dn(it)]=pt}),getIndexByKeyPath:function(Y){return Z[dn(Y)]}};return Z[":id"]=X.primaryKey,V!=null&&(Z[dn(V)]=X.primaryKey),X})},hasGetAll:0<P.length&&"getAll"in O.objectStore(P[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},P=K.schema,B=K.hasGetAll,K=P.tables.map(R),nt={};return K.forEach(function($){return nt[$.name]=$}),{stack:"dbcore",transaction:m.transaction.bind(m),table:function($){if(nt[$])return nt[$];throw new Error("Table '".concat($,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Ca(v),schema:P}}function po(m,v,x,E){return x=x.IDBKeyRange,v=zs(v,x,E),{dbcore:m.dbcore.reduce(function(R,O){return O=O.create,i(i({},R),O(R))},v)}}function ds(m,v){var x=v.db,x=po(m._middlewares,x,m._deps,v);m.core=x.dbcore,m.tables.forEach(function(E){var R=E.name;m.core.schema.tables.some(function(O){return O.name===R})&&(E.core=m.core.table(R),m[R]instanceof m.Table)&&(m[R].core=E.core)})}function mo(m,v,x,E){x.forEach(function(R){var O=E[R];v.forEach(function(P){var B=(function K(nt,$){return C(nt,$)||(nt=f(nt))&&K(nt,$)})(P,R);(!B||"value"in B&&B.value===void 0)&&(P===m.Transaction.prototype||P instanceof m.Transaction?_(P,R,{get:function(){return this.table(R)},set:function(K){S(this,R,{value:K,writable:!0,configurable:!0,enumerable:!0})}}):P[R]=new m.Table(R,O))})})}function _r(m,v){v.forEach(function(x){for(var E in x)x[E]instanceof m.Table&&delete x[E]})}function Dl(m,v){return m._cfg.version-v._cfg.version}function Cr(m,v,x,E){var R=m._dbSchema,O=(x.objectStoreNames.contains("$meta")&&!R.$meta&&(R.$meta=_a("$meta",lu("")[0],[]),m._storeNames.push("$meta")),m._createTransaction("readwrite",m._storeNames,R)),P=(O.create(x),O._completion.catch(E),O._reject.bind(O)),B=jt.transless||jt;ze(function(){if(jt.trans=O,jt.transless=B,v!==0)return ds(m,x),nt=v,((K=O).storeNames.includes("$meta")?K.table("$meta").get("version").then(function($){return $??nt}):Lt.resolve(nt)).then(function(st){var V=m,Q=st,Z=O,X=x,Y=[],st=V._versions,ot=V._dbSchema=Ra(0,V.idbdb,X);return(st=st.filter(function(it){return it._cfg.version>=Q})).length===0?Lt.resolve():(st.forEach(function(it){Y.push(function(){var pt,St,Dt,Ot=ot,Et=it._cfg.dbschema,Ut=(vo(V,Ot,X),vo(V,Et,X),ot=V._dbSchema=Et,yo(Ot,Et)),Pt=(Ut.add.forEach(function(_t){Ol(X,_t[0],_t[1].primKey,_t[1].indexes)}),Ut.change.forEach(function(_t){if(_t.recreate)throw new kt.Upgrade("Not yet support for changing primary key");var zt=X.objectStore(_t.name);_t.add.forEach(function(ee){return bo(zt,ee)}),_t.change.forEach(function(ee){zt.deleteIndex(ee.name),bo(zt,ee)}),_t.del.forEach(function(ee){return zt.deleteIndex(ee)})}),it._cfg.contentUpgrade);if(Pt&&it._cfg.version>Q)return ds(V,X),Z._memoizedTables={},pt=ct(Et),Ut.del.forEach(function(_t){pt[_t]=Ot[_t]}),_r(V,[V.Transaction.prototype]),mo(V,[V.Transaction.prototype],c(pt),pt),Z.schema=pt,(St=U(Pt))&&an(),Et=Lt.follow(function(){var _t;(Dt=Pt(Z))&&St&&(_t=Zn.bind(null,null),Dt.then(_t,_t))}),Dt&&typeof Dt.then=="function"?Lt.resolve(Dt):Et.then(function(){return Dt})}),Y.push(function(pt){var St,Dt,Ot=it._cfg.dbschema;St=Ot,Dt=pt,[].slice.call(Dt.db.objectStoreNames).forEach(function(Et){return St[Et]==null&&Dt.db.deleteObjectStore(Et)}),_r(V,[V.Transaction.prototype]),mo(V,[V.Transaction.prototype],V._storeNames,V._dbSchema),Z.schema=V._dbSchema}),Y.push(function(pt){V.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(V.idbdb.version/10)===it._cfg.version?(V.idbdb.deleteObjectStore("$meta"),delete V._dbSchema.$meta,V._storeNames=V._storeNames.filter(function(St){return St!=="$meta"})):pt.objectStore("$meta").put(it._cfg.version,"version"))})}),(function it(){return Y.length?Lt.resolve(Y.shift()(Z.idbtrans)).then(it):Lt.resolve()})().then(function(){ou(ot,X)}))}).catch(P);var K,nt;c(R).forEach(function($){Ol(x,$,R[$].primKey,R[$].indexes)}),ds(m,x),Lt.follow(function(){return m.on.populate.fire(O)}).catch(P)})}function go(m,v){ou(m._dbSchema,v),v.db.version%10!=0||v.objectStoreNames.contains("$meta")||v.db.createObjectStore("$meta").add(Math.ceil(v.db.version/10-1),"version");var x=Ra(0,m.idbdb,v);vo(m,m._dbSchema,v);for(var E=0,R=yo(x,m._dbSchema).change;E<R.length;E++){var O=(P=>{if(P.change.length||P.recreate)return console.warn("Unable to patch indexes of table ".concat(P.name," because it has changes on the type of index or primary key.")),{value:void 0};var B=v.objectStore(P.name);P.add.forEach(function(K){En&&console.debug("Dexie upgrade patch: Creating missing index ".concat(P.name,".").concat(K.src)),bo(B,K)})})(R[E]);if(typeof O=="object")return O.value}}function yo(m,v){var x,E={del:[],add:[],change:[]};for(x in m)v[x]||E.del.push(x);for(x in v){var R=m[x],O=v[x];if(R){var P={name:x,def:O,recreate:!1,del:[],add:[],change:[]};if(""+(R.primKey.keyPath||"")!=""+(O.primKey.keyPath||"")||R.primKey.auto!==O.primKey.auto)P.recreate=!0,E.change.push(P);else{var B=R.idxByName,K=O.idxByName,nt=void 0;for(nt in B)K[nt]||P.del.push(nt);for(nt in K){var $=B[nt],V=K[nt];$?$.src!==V.src&&P.change.push(V):P.add.push(V)}(0<P.del.length||0<P.add.length||0<P.change.length)&&E.change.push(P)}}else E.add.push([x,O])}return E}function Ol(m,v,x,E){var R=m.db.createObjectStore(v,x.keyPath?{keyPath:x.keyPath,autoIncrement:x.auto}:{autoIncrement:x.auto});E.forEach(function(O){return bo(R,O)})}function ou(m,v){c(m).forEach(function(x){v.db.objectStoreNames.contains(x)||(En&&console.debug("Dexie: Creating missing table",x),Ol(v,x,m[x].primKey,m[x].indexes))})}function bo(m,v){m.createIndex(v.name,v.keyPath,{unique:v.unique,multiEntry:v.multi})}function Ra(m,v,x){var E={};return N(v.objectStoreNames,0).forEach(function(R){for(var O=x.objectStore(R),P=Li(fo(nt=O.keyPath),nt||"",!0,!1,!!O.autoIncrement,nt&&typeof nt!="string",!0),B=[],K=0;K<O.indexNames.length;++K){var $=O.index(O.indexNames[K]),nt=$.keyPath,$=Li($.name,nt,!!$.unique,!!$.multiEntry,!1,nt&&typeof nt!="string",!1);B.push($)}E[R]=_a(R,P,B)}),E}function vo(m,v,x){for(var E=x.db.objectStoreNames,R=0;R<E.length;++R){var O=E[R],P=x.objectStore(O);m._hasGetAll="getAll"in P;for(var B=0;B<P.indexNames.length;++B){var K,nt=P.indexNames[B],$=P.index(nt).keyPath,$=typeof $=="string"?$:"["+N($).join("+")+"]";v[O]&&(K=v[O].idxByName[$])&&(K.name=nt,delete v[O].idxByName[$],v[O].idxByName[nt]=K)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(m._hasGetAll=!1)}function lu(m){return m.split(",").map(function(v,x){var R=v.split(":"),E=(E=R[1])==null?void 0:E.trim(),R=(v=R[0].trim()).replace(/([&*]|\+\+)/g,""),O=/^\[/.test(R)?R.match(/^\[(.*)\]$/)[1].split("+"):R;return Li(R,O||null,/\&/.test(v),/\*/.test(v),/\+\+/.test(v),u(O),x===0,E)})}Ma.prototype._createTableSchema=_a,Ma.prototype._parseIndexSyntax=lu,Ma.prototype._parseStoresSpec=function(m,v){var x=this;c(m).forEach(function(E){if(m[E]!==null){var R=x._parseIndexSyntax(m[E]),O=R.shift();if(!O)throw new kt.Schema("Invalid schema for table "+E+": "+m[E]);if(O.unique=!0,O.multi)throw new kt.Schema("Primary key cannot be multiEntry*");R.forEach(function(P){if(P.auto)throw new kt.Schema("Only primary key can be marked as autoIncrement (++)");if(!P.keyPath)throw new kt.Schema("Index must have a name and cannot be an empty string")}),O=x._createTableSchema(E,O,R),v[E]=O}})},Ma.prototype.stores=function(x){var v=this.db,x=(this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,x):x,v._versions),E={},R={};return x.forEach(function(O){d(E,O._cfg.storesSource),R=O._cfg.dbschema={},O._parseStoresSpec(E,R)}),v._dbSchema=R,_r(v,[v._allTables,v,v.Transaction.prototype]),mo(v,[v._allTables,v,v.Transaction.prototype,this._cfg.tables],c(R),R),v._storeNames=c(R),this},Ma.prototype.upgrade=function(m){return this._cfg.contentUpgrade=An(this._cfg.contentUpgrade||yt,m),this};var Ad=Ma;function Ma(){}function Nl(m,v){var x=m._dbNamesDB;return x||(x=m._dbNamesDB=new Pi(br,{addons:[],indexedDB:m,IDBKeyRange:v})).version(1).stores({dbnames:"name"}),x.table("dbnames")}function wo(m){return m&&typeof m.databases=="function"}function kl(m){return ze(function(){return jt.letThrough=!0,m()})}function Ll(m){return!("from"in m)}var Tn=function(m,v){var x;if(!this)return x=new Tn,m&&"d"in m&&d(x,m),x;d(this,arguments.length?{d:1,from:m,to:1<arguments.length?v:m}:{d:0})};function Tr(m,v,x){var E=he(v,x);if(!isNaN(E)){if(0<E)throw RangeError();if(Ll(m))return d(m,{from:v,to:x,d:1});var E=m.l,R=m.r;if(he(x,m.from)<0)return E?Tr(E,v,x):m.l={from:v,to:x,d:1,l:null,r:null},uu(m);if(0<he(v,m.to))return R?Tr(R,v,x):m.r={from:v,to:x,d:1,l:null,r:null},uu(m);he(v,m.from)<0&&(m.from=v,m.l=null,m.d=R?R.d+1:1),0<he(x,m.to)&&(m.to=x,m.r=null,m.d=m.l?m.l.d+1:1),v=!m.r,E&&!m.l&&Hs(m,E),R&&v&&Hs(m,R)}}function Hs(m,v){Ll(v)||(function x(E,R){var O=R.from,P=R.l,B=R.r;Tr(E,O,R.to),P&&x(E,P),B&&x(E,B)})(m,v)}function cu(m,v){var x=xo(v),E=x.next();if(!E.done)for(var R=E.value,O=xo(m),P=O.next(R.from),B=P.value;!E.done&&!P.done;){if(he(B.from,R.to)<=0&&0<=he(B.to,R.from))return!0;he(R.from,B.from)<0?R=(E=x.next(B.from)).value:B=(P=O.next(R.from)).value}return!1}function xo(m){var v=Ll(m)?null:{s:0,n:m};return{next:function(x){for(var E=0<arguments.length;v;)switch(v.s){case 0:if(v.s=1,E)for(;v.n.l&&he(x,v.n.from)<0;)v={up:v,n:v.n.l,s:1};else for(;v.n.l;)v={up:v,n:v.n.l,s:1};case 1:if(v.s=2,!E||he(x,v.n.to)<=0)return{value:v.n,done:!1};case 2:if(v.n.r){v.s=3,v={up:v,n:v.n.r,s:0};continue}case 3:v=v.up}return{done:!0}}}}function uu(m){var v,x,E,R=(((R=m.r)==null?void 0:R.d)||0)-(((R=m.l)==null?void 0:R.d)||0),R=1<R?"r":R<-1?"l":"";R&&(v=R=="r"?"l":"r",x=i({},m),E=m[R],m.from=E.from,m.to=E.to,m[R]=E[R],x[R]=E[v],(m[v]=x).d=Pl(x)),m.d=Pl(m)}function Pl(x){var v=x.r,x=x.l;return(v?x?Math.max(v.d,x.d):v.d:x?x.d:0)+1}function So(m,v){return c(v).forEach(function(x){m[x]?Hs(m[x],v[x]):m[x]=(function E(R){var O,P,B={};for(O in R)y(R,O)&&(P=R[O],B[O]=!P||typeof P!="object"||xt.has(P.constructor)?P:E(P));return B})(v[x])}),m}function Bl(m,v){return m.all||v.all||Object.keys(m).some(function(x){return v[x]&&cu(v[x],m[x])})}w(Tn.prototype,((qn={add:function(m){return Hs(this,m),this},addKey:function(m){return Tr(this,m,m),this},addKeys:function(m){var v=this;return m.forEach(function(x){return Tr(v,x,x)}),this},hasKey:function(m){var v=xo(this).next(m).value;return v&&he(v.from,m)<=0&&0<=he(v.to,m)}})[G]=function(){return xo(this)},qn));var qs={},jl={},Fl=!1;function Ao(m){So(jl,m),Fl||(Fl=!0,setTimeout(function(){Fl=!1,Il(jl,!(jl={}))},0))}function Il(m,v){v===void 0&&(v=!1);var x=new Set;if(m.all)for(var E=0,R=Object.values(qs);E<R.length;E++)hu(B=R[E],m,x,v);else for(var O in m){var P,B,O=/^idb\:\/\/(.*)\/(.*)\//.exec(O);O&&(P=O[1],O=O[2],B=qs["idb://".concat(P,"/").concat(O)])&&hu(B,m,x,v)}x.forEach(function(K){return K()})}function hu(m,v,x,E){for(var R=[],O=0,P=Object.entries(m.queries.query);O<P.length;O++){for(var B=P[O],K=B[0],nt=[],$=0,V=B[1];$<V.length;$++){var Q=V[$];Bl(v,Q.obsSet)?Q.subscribers.forEach(function(st){return x.add(st)}):E&&nt.push(Q)}E&&R.push([K,nt])}if(E)for(var Z=0,X=R;Z<X.length;Z++){var Y=X[Z],K=Y[0],nt=Y[1];m.queries.query[K]=nt}}function Ed(m){var v=m._state,x=m._deps.indexedDB;if(v.isBeingOpened||m.idbdb)return v.dbReadyPromise.then(function(){return v.dbOpenError?ke(v.dbOpenError):m});v.isBeingOpened=!0,v.dbOpenError=null,v.openComplete=!1;var E=v.openCanceller,R=Math.round(10*m.verno),O=!1;function P(){if(v.openCanceller!==E)throw new kt.DatabaseClosed("db.open() was cancelled")}function B(){return new Lt(function(Q,Z){if(P(),!x)throw new kt.MissingAPI;var X=m.name,Y=v.autoSchema||!R?x.open(X):x.open(X,R);if(!Y)throw new kt.MissingAPI;Y.onerror=vi(Z),Y.onblocked=Ie(m._fireOnBlocked),Y.onupgradeneeded=Ie(function(st){var ot;$=Y.transaction,v.autoSchema&&!m._options.allowEmptyDB?(Y.onerror=Is,$.abort(),Y.result.close(),(ot=x.deleteDatabase(X)).onsuccess=ot.onerror=Ie(function(){Z(new kt.NoSuchDatabase("Database ".concat(X," doesnt exist")))})):($.onerror=vi(Z),ot=st.oldVersion>Math.pow(2,62)?0:st.oldVersion,V=ot<1,m.idbdb=Y.result,O&&go(m,$),Cr(m,ot/10,$,Z))},Z),Y.onsuccess=Ie(function(){$=null;var st,ot,it,pt,St,Dt,Ot=m.idbdb=Y.result,Et=N(Ot.objectStoreNames);if(0<Et.length)try{var Ut=Ot.transaction((St=Et).length===1?St[0]:St,"readonly");if(v.autoSchema)Dt=Ot,pt=Ut,(it=m).verno=Dt.version/10,pt=it._dbSchema=Ra(0,Dt,pt),it._storeNames=N(Dt.objectStoreNames,0),mo(it,[it._allTables],c(pt),pt);else if(vo(m,m._dbSchema,Ut),ot=Ut,((ot=yo(Ra(0,(st=m).idbdb,ot),st._dbSchema)).add.length||ot.change.some(function(Pt){return Pt.add.length||Pt.change.length}))&&!O)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ot.close(),R=Ot.version+1,O=!0,Q(B());ds(m,Ut)}catch{}Ps.push(m),Ot.onversionchange=Ie(function(Pt){v.vcFired=!0,m.on("versionchange").fire(Pt)}),Ot.onclose=Ie(function(){m.close({disableAutoOpen:!1})}),V&&(Et=m._deps,St=X,wo(Dt=Et.indexedDB)||St===br||Nl(Dt,Et.IDBKeyRange).put({name:St}).catch(yt)),Q()},Z)}).catch(function(Q){switch(Q?.name){case"UnknownError":if(0<v.PR1398_maxLoop)return v.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),B();break;case"VersionError":if(0<R)return R=0,B()}return Lt.reject(Q)})}var K,nt=v.dbReadyResolve,$=null,V=!1;return Lt.race([E,(typeof navigator>"u"?Lt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function Z(){return indexedDB.databases().finally(Q)}K=setInterval(Z,100),Z()}).finally(function(){return clearInterval(K)}):Promise.resolve()).then(B)]).then(function(){return P(),v.onReadyBeingFired=[],Lt.resolve(kl(function(){return m.on.ready.fire(m.vip)})).then(function Q(){var Z;if(0<v.onReadyBeingFired.length)return Z=v.onReadyBeingFired.reduce(An,yt),v.onReadyBeingFired=[],Lt.resolve(kl(function(){return Z(m.vip)})).then(Q)})}).finally(function(){v.openCanceller===E&&(v.onReadyBeingFired=null,v.isBeingOpened=!1)}).catch(function(Q){v.dbOpenError=Q;try{$&&$.abort()}catch{}return E===v.openCanceller&&m._close(),ke(Q)}).finally(function(){v.openComplete=!0,nt()}).then(function(){var Q;return V&&(Q={},m.tables.forEach(function(Z){Z.schema.indexes.forEach(function(X){X.name&&(Q["idb://".concat(m.name,"/").concat(Z.name,"/").concat(X.name)]=new Tn(-1/0,[[[]]]))}),Q["idb://".concat(m.name,"/").concat(Z.name,"/")]=Q["idb://".concat(m.name,"/").concat(Z.name,"/:dels")]=new Tn(-1/0,[[[]]])}),Cn(Ea).fire(Q),Il(Q,!0)),m})}function Rr(m){function v(O){return m.next(O)}var x=R(v),E=R(function(O){return m.throw(O)});function R(O){return function(B){var B=O(B),K=B.value;return B.done?K:K&&typeof K.then=="function"?K.then(x,E):u(K)?Promise.all(K).then(x,E):x(K)}}return R(v)()}function fs(m,v,x){for(var E=u(m)?m.slice():[m],R=0;R<x;++R)E.push(v);return E}var _d={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(m){return i(i({},m),{table:function(E){var x=m.table(E),E=x.schema,R={},O=[];function P(Q,Z,X){var it=dn(Q),Y=R[it]=R[it]||[],st=Q==null?0:typeof Q=="string"?1:Q.length,ot=0<Z,it=i(i({},X),{name:ot?"".concat(it,"(virtual-from:").concat(X.name,")"):X.name,lowLevelIndex:X,isVirtual:ot,keyTail:Z,keyLength:st,extractKey:Ta(Q),unique:!ot&&X.unique});return Y.push(it),it.isPrimaryKey||O.push(it),1<st&&P(st===2?Q[0]:Q.slice(0,st-1),Z+1,X),Y.sort(function(pt,St){return pt.keyTail-St.keyTail}),it}var B=P(E.primaryKey.keyPath,0,E.primaryKey);R[":id"]=[B];for(var K=0,nt=E.indexes;K<nt.length;K++){var $=nt[K];P($.keyPath,0,$)}function V(Q){var Z,X=Q.query.index;return X.isVirtual?i(i({},Q),{query:{index:X.lowLevelIndex,range:(Z=Q.query.range,X=X.keyTail,{type:Z.type===1?2:Z.type,lower:fs(Z.lower,Z.lowerOpen?m.MAX_KEY:m.MIN_KEY,X),lowerOpen:!0,upper:fs(Z.upper,Z.upperOpen?m.MIN_KEY:m.MAX_KEY,X),upperOpen:!0})}}):Q}return i(i({},x),{schema:i(i({},E),{primaryKey:B,indexes:O,getIndexByKeyPath:function(Q){return(Q=R[dn(Q)])&&Q[0]}}),count:function(Q){return x.count(V(Q))},query:function(Q){return x.query(V(Q))},openCursor:function(Q){var Z=Q.query.index,X=Z.keyTail,Y=Z.keyLength;return Z.isVirtual?x.openCursor(V(Q)).then(function(ot){return ot&&st(ot)}):x.openCursor(Q);function st(ot){return Object.create(ot,{continue:{value:function(it){it!=null?ot.continue(fs(it,Q.reverse?m.MAX_KEY:m.MIN_KEY,X)):Q.unique?ot.continue(ot.key.slice(0,Y).concat(Q.reverse?m.MIN_KEY:m.MAX_KEY,X)):ot.continue()}},continuePrimaryKey:{value:function(it,pt){ot.continuePrimaryKey(fs(it,m.MAX_KEY,X),pt)}},primaryKey:{get:function(){return ot.primaryKey}},key:{get:function(){var it=ot.key;return Y===1?it[0]:it.slice(0,Y)}},value:{get:function(){return ot.value}}})}}})}})}};function Eo(m,v,x,E){return x=x||{},E=E||"",c(m).forEach(function(R){var O,P,B;y(v,R)?(O=m[R],P=v[R],typeof O=="object"&&typeof P=="object"&&O&&P?(B=qt(O))!==qt(P)?x[E+R]=v[R]:B==="Object"?Eo(O,P,x,E+R+"."):O!==P&&(x[E+R]=v[R]):O!==P&&(x[E+R]=v[R])):x[E+R]=void 0}),c(v).forEach(function(R){y(m,R)||(x[E+R]=v[R])}),x}function _o(m,v){return v.type==="delete"?v.keys:v.keys||v.values.map(m.extractKey)}var du={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(m){return i(i({},m),{table:function(v){var x=m.table(v),E=x.schema.primaryKey;return i(i({},x),{mutate:function(R){var O=jt.trans,P=O.table(v).hook,B=P.deleting,K=P.creating,nt=P.updating;switch(R.type){case"add":if(K.fire===yt)break;return O._promise("readwrite",function(){return $(R)},!0);case"put":if(K.fire===yt&&nt.fire===yt)break;return O._promise("readwrite",function(){return $(R)},!0);case"delete":if(B.fire===yt)break;return O._promise("readwrite",function(){return $(R)},!0);case"deleteRange":if(B.fire===yt)break;return O._promise("readwrite",function(){return(function V(Q,Z,X){return x.query({trans:Q,values:!1,query:{index:E,range:Z},limit:X}).then(function(Y){var st=Y.result;return $({type:"delete",keys:st,trans:Q}).then(function(ot){return 0<ot.numFailures?Promise.reject(ot.failures[0]):st.length<X?{failures:[],numFailures:0,lastResult:void 0}:V(Q,i(i({},Z),{lower:st[st.length-1],lowerOpen:!0}),X)})})})(R.trans,R.range,1e4)},!0)}return x.mutate(R);function $(V){var Q,Z,X,Y=jt.trans,st=V.keys||_o(E,V);if(st)return(V=V.type==="add"||V.type==="put"?i(i({},V),{keys:st}):i({},V)).type!=="delete"&&(V.values=a([],V.values)),V.keys&&(V.keys=a([],V.keys)),Q=x,X=st,((Z=V).type==="add"?Promise.resolve([]):Q.getMany({trans:Z.trans,keys:X,cache:"immutable"})).then(function(ot){var it=st.map(function(pt,St){var Dt,Ot,Et,Ut=ot[St],Pt={onerror:null,onsuccess:null};return V.type==="delete"?B.fire.call(Pt,pt,Ut,Y):V.type==="add"||Ut===void 0?(Dt=K.fire.call(Pt,pt,V.values[St],Y),pt==null&&Dt!=null&&(V.keys[St]=pt=Dt,E.outbound||H(V.values[St],E.keyPath,pt))):(Dt=Eo(Ut,V.values[St]),(Ot=nt.fire.call(Pt,Dt,pt,Ut,Y))&&(Et=V.values[St],Object.keys(Ot).forEach(function(_t){y(Et,_t)?Et[_t]=Ot[_t]:H(Et,_t,Ot[_t])}))),Pt});return x.mutate(V).then(function(pt){for(var St=pt.failures,Dt=pt.results,Ot=pt.numFailures,pt=pt.lastResult,Et=0;Et<st.length;++Et){var Ut=(Dt||st)[Et],Pt=it[Et];Ut==null?Pt.onerror&&Pt.onerror(St[Et]):Pt.onsuccess&&Pt.onsuccess(V.type==="put"&&ot[Et]?V.values[Et]:Ut)}return{failures:St,results:Dt,numFailures:Ot,lastResult:pt}}).catch(function(pt){return it.forEach(function(St){return St.onerror&&St.onerror(pt)}),Promise.reject(pt)})});throw new Error("Keys missing")}}})}})}};function Ul(m,v,x){try{if(!v||v.keys.length<m.length)return null;for(var E=[],R=0,O=0;R<v.keys.length&&O<m.length;++R)he(v.keys[R],m[O])===0&&(E.push(x?At(v.values[R]):v.values[R]),++O);return E.length===m.length?E:null}catch{return null}}var fu={stack:"dbcore",level:-1,create:function(m){return{table:function(v){var x=m.table(v);return i(i({},x),{getMany:function(E){var R;return E.cache?(R=Ul(E.keys,E.trans._cache,E.cache==="clone"))?Lt.resolve(R):x.getMany(E).then(function(O){return E.trans._cache={keys:E.keys,values:E.cache==="clone"?At(O):O},O}):x.getMany(E)},mutate:function(E){return E.type!=="add"&&(E.trans._cache=null),x.mutate(E)}})}}}};function Gs(m,v){return m.trans.mode==="readonly"&&!!m.subscr&&!m.trans.explicit&&m.trans.db._options.cache!=="disabled"&&!v.schema.primaryKey.outbound}function pu(m,v){switch(m){case"query":return v.values&&!v.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Cd={stack:"dbcore",level:0,name:"Observability",create:function(m){var v=m.schema.name,x=new Tn(m.MIN_KEY,m.MAX_KEY);return i(i({},m),{transaction:function(E,R,O){if(jt.subscr&&R!=="readonly")throw new kt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(jt.querier));return m.transaction(E,R,O)},table:function(E){function R(st){var Y,st=st.query;return[Y=st.index,new Tn((Y=(st=st.range).lower)!=null?Y:m.MIN_KEY,(Y=st.upper)!=null?Y:m.MAX_KEY)]}var O=m.table(E),P=O.schema,B=P.primaryKey,K=P.indexes,nt=B.extractKey,$=B.outbound,V=B.autoIncrement&&K.filter(function(X){return X.compound&&X.keyPath.includes(B.keyPath)}),Q=i(i({},O),{mutate:function(X){function Y(zt){return zt="idb://".concat(v,"/").concat(E,"/").concat(zt),St[zt]||(St[zt]=new Tn)}var st,ot,it,pt=X.trans,St=X.mutatedParts||(X.mutatedParts={}),Dt=Y(""),Ot=Y(":dels"),Et=X.type,Pt=X.type==="deleteRange"?[X.range]:X.type==="delete"?[X.keys]:X.values.length<50?[_o(B,X).filter(function(zt){return zt}),X.values]:[],Ut=Pt[0],Pt=Pt[1],_t=X.trans._cache;return u(Ut)?(Dt.addKeys(Ut),(Et=Et==="delete"||Ut.length===Pt.length?Ul(Ut,_t):null)||Ot.addKeys(Ut),(Et||Pt)&&(st=Y,ot=Et,it=Pt,P.indexes.forEach(function(zt){var ee=st(zt.name||"");function fe(se){return se!=null?zt.extractKey(se):null}function Yt(se){zt.multiEntry&&u(se)?se.forEach(function(Le){return ee.addKey(Le)}):ee.addKey(se)}(ot||it).forEach(function(se,De){var $n=ot&&fe(ot[De]),De=it&&fe(it[De]);he($n,De)!==0&&($n!=null&&Yt($n),De!=null)&&Yt(De)})}))):Ut?(Pt={from:(_t=Ut.lower)!=null?_t:m.MIN_KEY,to:(Et=Ut.upper)!=null?Et:m.MAX_KEY},Ot.add(Pt),Dt.add(Pt)):(Dt.add(x),Ot.add(x),P.indexes.forEach(function(zt){return Y(zt.name).add(x)})),O.mutate(X).then(function(zt){return!Ut||X.type!=="add"&&X.type!=="put"||(Dt.addKeys(zt.results),V&&V.forEach(function(ee){for(var fe=X.values.map(function($n){return ee.extractKey($n)}),Yt=ee.keyPath.findIndex(function($n){return $n===B.keyPath}),se=0,Le=zt.results.length;se<Le;++se)fe[se][Yt]=zt.results[se];Y(ee.name).addKeys(fe)})),pt.mutatedParts=So(pt.mutatedParts||{},St),zt})}}),Z={get:function(X){return[B,new Tn(X.key)]},getMany:function(X){return[B,new Tn().addKeys(X.keys)]},count:R,query:R,openCursor:R};return c(Z).forEach(function(X){Q[X]=function(Y){var st=jt.subscr,ot=!!st,it=Gs(jt,O)&&pu(X,Y)?Y.obsSet={}:st;if(ot){var pt,st=function(Pt){return Pt="idb://".concat(v,"/").concat(E,"/").concat(Pt),it[Pt]||(it[Pt]=new Tn)},St=st(""),Dt=st(":dels"),ot=Z[X](Y),Ot=ot[0],ot=ot[1];if((X==="query"&&Ot.isPrimaryKey&&!Y.values?Dt:st(Ot.name||"")).add(ot),!Ot.isPrimaryKey){if(X!=="count")return pt=X==="query"&&$&&Y.values&&O.query(i(i({},Y),{values:!1})),O[X].apply(this,arguments).then(function(Pt){if(X==="query"){if($&&Y.values)return pt.then(function(fe){return fe=fe.result,St.addKeys(fe),Pt});var _t=Y.values?Pt.result.map(nt):Pt.result;(Y.values?St:Dt).addKeys(_t)}else{var zt,ee;if(X==="openCursor")return ee=Y.values,(zt=Pt)&&Object.create(zt,{key:{get:function(){return Dt.addKey(zt.primaryKey),zt.key}},primaryKey:{get:function(){var fe=zt.primaryKey;return Dt.addKey(fe),fe}},value:{get:function(){return ee&&St.addKey(zt.primaryKey),zt.value}}})}return Pt});Dt.add(x)}}return O[X].apply(this,arguments)}}),Q}})}};function mu(m,v,x){var E;return x.numFailures===0?v:v.type==="deleteRange"||(E=v.keys?v.keys.length:"values"in v&&v.values?v.values.length:1,x.numFailures===E)?null:(E=i({},v),u(E.keys)&&(E.keys=E.keys.filter(function(R,O){return!(O in x.failures)})),"values"in E&&u(E.values)&&(E.values=E.values.filter(function(R,O){return!(O in x.failures)})),E)}function Co(m,v){return x=m,((E=v).lower===void 0||(E.lowerOpen?0<he(x,E.lower):0<=he(x,E.lower)))&&(x=m,(E=v).upper===void 0||(E.upperOpen?he(x,E.upper)<0:he(x,E.upper)<=0));var x,E}function zl(m,v,x,E,R,O){var P,B,K,nt,$,V;return!x||x.length===0||(P=v.query.index,B=P.multiEntry,K=v.query.range,nt=E.schema.primaryKey.extractKey,$=P.extractKey,V=(P.lowLevelIndex||P).extractKey,(E=x.reduce(function(Q,Z){var X=Q,Y=[];if(Z.type==="add"||Z.type==="put")for(var st=new Tn,ot=Z.values.length-1;0<=ot;--ot){var it,pt=Z.values[ot],St=nt(pt);!st.hasKey(St)&&(it=$(pt),B&&u(it)?it.some(function(Pt){return Co(Pt,K)}):Co(it,K))&&(st.addKey(St),Y.push(pt))}switch(Z.type){case"add":var Dt=new Tn().addKeys(v.values?Q.map(function(_t){return nt(_t)}):Q),X=Q.concat(v.values?Y.filter(function(_t){return _t=nt(_t),!Dt.hasKey(_t)&&(Dt.addKey(_t),!0)}):Y.map(function(_t){return nt(_t)}).filter(function(_t){return!Dt.hasKey(_t)&&(Dt.addKey(_t),!0)}));break;case"put":var Ot=new Tn().addKeys(Z.values.map(function(_t){return nt(_t)}));X=Q.filter(function(_t){return!Ot.hasKey(v.values?nt(_t):_t)}).concat(v.values?Y:Y.map(function(_t){return nt(_t)}));break;case"delete":var Et=new Tn().addKeys(Z.keys);X=Q.filter(function(_t){return!Et.hasKey(v.values?nt(_t):_t)});break;case"deleteRange":var Ut=Z.range;X=Q.filter(function(_t){return!Co(nt(_t),Ut)})}return X},m))===m)?m:(E.sort(function(Q,Z){return he(V(Q),V(Z))||he(nt(Q),nt(Z))}),v.limit&&v.limit<1/0&&(E.length>v.limit?E.length=v.limit:m.length===v.limit&&E.length<v.limit&&(R.dirty=!0)),O?Object.freeze(E):E)}function Da(m,v){return he(m.lower,v.lower)===0&&he(m.upper,v.upper)===0&&!!m.lowerOpen==!!v.lowerOpen&&!!m.upperOpen==!!v.upperOpen}function Mr(m,v){return((x,E,R,O)=>{if(x===void 0)return E!==void 0?-1:0;if(E===void 0)return 1;if((x=he(x,E))===0){if(R&&O)return 0;if(R)return 1;if(O)return-1}return x})(m.lower,v.lower,m.lowerOpen,v.lowerOpen)<=0&&0<=((x,E,R,O)=>{if(x===void 0)return E!==void 0?1:0;if(E===void 0)return-1;if((x=he(x,E))===0){if(R&&O)return 0;if(R)return-1;if(O)return 1}return x})(m.upper,v.upper,m.upperOpen,v.upperOpen)}function Td(m,v,x,E){m.subscribers.add(x),E.addEventListener("abort",function(){var R,O;m.subscribers.delete(x),m.subscribers.size===0&&(R=m,O=v,setTimeout(function(){R.subscribers.size===0&&vt(O,R)},3e3))})}var To={stack:"dbcore",level:0,name:"Cache",create:function(m){var v=m.schema.name;return i(i({},m),{transaction:function(x,E,R){var O,P,B=m.transaction(x,E,R);return E==="readwrite"&&(R=(O=new AbortController).signal,B.addEventListener("abort",(P=function(K){return function(){if(O.abort(),E==="readwrite"){for(var nt=new Set,$=0,V=x;$<V.length;$++){var Q=V[$],Z=qs["idb://".concat(v,"/").concat(Q)];if(Z){var X=m.table(Q),Y=Z.optimisticOps.filter(function(zt){return zt.trans===B});if(B._explicit&&K&&B.mutatedParts)for(var st=0,ot=Object.values(Z.queries.query);st<ot.length;st++)for(var it=0,pt=(Ot=ot[st]).slice();it<pt.length;it++)Bl((Et=pt[it]).obsSet,B.mutatedParts)&&(vt(Ot,Et),Et.subscribers.forEach(function(zt){return nt.add(zt)}));else if(0<Y.length){Z.optimisticOps=Z.optimisticOps.filter(function(zt){return zt.trans!==B});for(var St=0,Dt=Object.values(Z.queries.query);St<Dt.length;St++)for(var Ot,Et,Ut,Pt=0,_t=(Ot=Dt[St]).slice();Pt<_t.length;Pt++)(Et=_t[Pt]).res!=null&&B.mutatedParts&&(K&&!Et.dirty?(Ut=Object.isFrozen(Et.res),Ut=zl(Et.res,Et.req,Y,X,Et,Ut),Et.dirty?(vt(Ot,Et),Et.subscribers.forEach(function(zt){return nt.add(zt)})):Ut!==Et.res&&(Et.res=Ut,Et.promise=Lt.resolve({result:Ut}))):(Et.dirty&&vt(Ot,Et),Et.subscribers.forEach(function(zt){return nt.add(zt)})))}}}nt.forEach(function(zt){return zt()})}}})(!1),{signal:R}),B.addEventListener("error",P(!1),{signal:R}),B.addEventListener("complete",P(!0),{signal:R})),B},table:function(x){var E=m.table(x),R=E.schema.primaryKey;return i(i({},E),{mutate:function(O){var P,B=jt.trans;return!R.outbound&&B.db._options.cache!=="disabled"&&!B.explicit&&B.idbtrans.mode==="readwrite"&&(P=qs["idb://".concat(v,"/").concat(x)])?(B=E.mutate(O),O.type!=="add"&&O.type!=="put"||!(50<=O.values.length||_o(R,O).some(function(K){return K==null}))?(P.optimisticOps.push(O),O.mutatedParts&&Ao(O.mutatedParts),B.then(function(K){0<K.numFailures&&(vt(P.optimisticOps,O),(K=mu(0,O,K))&&P.optimisticOps.push(K),O.mutatedParts)&&Ao(O.mutatedParts)}),B.catch(function(){vt(P.optimisticOps,O),O.mutatedParts&&Ao(O.mutatedParts)})):B.then(function(K){var nt=mu(0,i(i({},O),{values:O.values.map(function($,V){var Q;return K.failures[V]?$:(H(Q=(Q=R.keyPath)!=null&&Q.includes(".")?At($):i({},$),R.keyPath,K.results[V]),Q)})}),K);P.optimisticOps.push(nt),queueMicrotask(function(){return O.mutatedParts&&Ao(O.mutatedParts)})}),B):E.mutate(O)},query:function(O){var P,B,K,nt,$,V,Q;return Gs(jt,E)&&pu("query",O)?(P=((K=jt.trans)==null?void 0:K.db._options.cache)==="immutable",B=(K=jt).requery,K=K.signal,V=((Z,X,Y,st)=>{var ot=qs["idb://".concat(Z,"/").concat(X)];if(!ot)return[];if(!(Z=ot.queries[Y]))return[null,!1,ot,null];var it=Z[(st.query?st.query.index.name:null)||""];if(!it)return[null,!1,ot,null];switch(Y){case"query":var pt=it.find(function(St){return St.req.limit===st.limit&&St.req.values===st.values&&Da(St.req.query.range,st.query.range)});return pt?[pt,!0,ot,it]:[it.find(function(St){return("limit"in St.req?St.req.limit:1/0)>=st.limit&&(!st.values||St.req.values)&&Mr(St.req.query.range,st.query.range)}),!1,ot,it];case"count":return pt=it.find(function(St){return Da(St.req.query.range,st.query.range)}),[pt,!!pt,ot,it]}})(v,x,"query",O),Q=V[0],nt=V[2],$=V[3],Q&&V[1]?Q.obsSet=O.obsSet:(V=E.query(O).then(function(Z){var X=Z.result;if(Q&&(Q.res=X),P){for(var Y=0,st=X.length;Y<st;++Y)Object.freeze(X[Y]);Object.freeze(X)}else Z.result=At(X);return Z}).catch(function(Z){return $&&Q&&vt($,Q),Promise.reject(Z)}),Q={obsSet:O.obsSet,promise:V,subscribers:new Set,type:"query",req:O,dirty:!1},$?$.push(Q):($=[Q],(nt=nt||(qs["idb://".concat(v,"/").concat(x)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[O.query.index.name||""]=$)),Td(Q,$,B,K),Q.promise.then(function(Z){return{result:zl(Z.result,O,nt?.optimisticOps,E,Q,P)}})):E.query(O)}})}})}};function Dr(m,v){return new Proxy(m,{get:function(x,E,R){return E==="db"?v:Reflect.get(x,E,R)}})}Ge.prototype.version=function(m){if(isNaN(m)||m<.1)throw new kt.Type("Given version is not a positive number");if(m=Math.round(10*m)/10,this.idbdb||this._state.isBeingOpened)throw new kt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,m);var v=this._versions,x=v.filter(function(E){return E._cfg.version===m})[0];return x||(x=new this.Version(m),v.push(x),v.sort(Dl),x.stores({}),this._state.autoSchema=!1),x},Ge.prototype._whenReady=function(m){var v=this;return this.idbdb&&(this._state.openComplete||jt.letThrough||this._vip)?m():new Lt(function(x,E){if(v._state.openComplete)return E(new kt.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return void E(new kt.DatabaseClosed);v.open().catch(yt)}v._state.dbReadyPromise.then(x,E)}).then(m)},Ge.prototype.use=function(R){var v=R.stack,x=R.create,E=R.level,R=R.name,O=(R&&this.unuse({stack:v,name:R}),this._middlewares[v]||(this._middlewares[v]=[]));return O.push({stack:v,create:x,level:E??10,name:R}),O.sort(function(P,B){return P.level-B.level}),this},Ge.prototype.unuse=function(m){var v=m.stack,x=m.name,E=m.create;return v&&this._middlewares[v]&&(this._middlewares[v]=this._middlewares[v].filter(function(R){return E?R.create!==E:!!x&&R.name!==x})),this},Ge.prototype.open=function(){var m=this;return yi(kn,function(){return Ed(m)})},Ge.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var m=this._state,v=Ps.indexOf(this);if(0<=v&&Ps.splice(v,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}m.isBeingOpened||(m.dbReadyPromise=new Lt(function(x){m.dbReadyResolve=x}),m.openCanceller=new Lt(function(x,E){m.cancelOpen=E}))},Ge.prototype.close=function(v){var v=(v===void 0?{disableAutoOpen:!0}:v).disableAutoOpen,x=this._state;v?(x.isBeingOpened&&x.cancelOpen(new kt.DatabaseClosed),this._close(),x.autoOpen=!1,x.dbOpenError=new kt.DatabaseClosed):(this._close(),x.autoOpen=this._options.autoOpen||x.isBeingOpened,x.openComplete=!1,x.dbOpenError=null)},Ge.prototype.delete=function(m){var v=this,x=(m===void 0&&(m={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),E=this._state;return new Lt(function(R,O){function P(){v.close(m);var B=v._deps.indexedDB.deleteDatabase(v.name);B.onsuccess=Ie(function(){var K,nt,$;K=v._deps,nt=v.name,wo($=K.indexedDB)||nt===br||Nl($,K.IDBKeyRange).delete(nt).catch(yt),R()}),B.onerror=vi(O),B.onblocked=v._fireOnBlocked}if(x)throw new kt.InvalidArgument("Invalid closeOptions argument to db.delete()");E.isBeingOpened?E.dbReadyPromise.then(P):P()})},Ge.prototype.backendDB=function(){return this.idbdb},Ge.prototype.isOpen=function(){return this.idbdb!==null},Ge.prototype.hasBeenClosed=function(){var m=this._state.dbOpenError;return m&&m.name==="DatabaseClosed"},Ge.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ge.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ge.prototype,"tables",{get:function(){var m=this;return c(this._allTables).map(function(v){return m._allTables[v]})},enumerable:!1,configurable:!0}),Ge.prototype.transaction=function(){var m=(function(v,x,E){var R=arguments.length;if(R<2)throw new kt.InvalidArgument("Too few arguments");for(var O=new Array(R-1);--R;)O[R-1]=arguments[R];return E=O.pop(),[v,Tt(O),E]}).apply(this,arguments);return this._transaction.apply(this,m)},Ge.prototype._transaction=function(m,v,x){var E,R,O=this,P=jt.trans,B=(P&&P.db===this&&m.indexOf("!")===-1||(P=null),m.indexOf("?")!==-1);m=m.replace("!","").replace("?","");try{if(R=v.map(function(nt){if(nt=nt instanceof O.Table?nt.name:nt,typeof nt!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return nt}),m=="r"||m===Yi)E=Yi;else{if(m!="rw"&&m!=us)throw new kt.InvalidArgument("Invalid transaction mode: "+m);E=us}if(P){if(P.mode===Yi&&E===us){if(!B)throw new kt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");P=null}P&&R.forEach(function(nt){if(P&&P.storeNames.indexOf(nt)===-1){if(!B)throw new kt.SubTransaction("Table "+nt+" not included in parent transaction.");P=null}}),B&&P&&!P.active&&(P=null)}}catch(nt){return P?P._promise(null,function($,V){V(nt)}):ke(nt)}var K=(function nt($,V,Q,Z,X){return Lt.resolve().then(function(){var it=jt.transless||jt,Y=$._createTransaction(V,Q,$._dbSchema,Z),it=(Y.explicit=!0,{trans:Y,transless:it});if(Z)Y.idbtrans=Z.idbtrans;else try{Y.create(),Y.idbtrans._explicit=!0,$._state.PR1398_maxLoop=3}catch(pt){return pt.name===re.InvalidState&&$.isOpen()&&0<--$._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$.close({disableAutoOpen:!1}),$.open().then(function(){return nt($,V,Q,null,X)})):ke(pt)}var st,ot=U(X),it=(ot&&an(),Lt.follow(function(){var pt;(st=X.call(Y,Y))&&(ot?(pt=Zn.bind(null,null),st.then(pt,pt)):typeof st.next=="function"&&typeof st.throw=="function"&&(st=Rr(st)))},it));return(st&&typeof st.then=="function"?Lt.resolve(st).then(function(pt){return Y.active?pt:ke(new kt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):it.then(function(){return st})).then(function(pt){return Z&&Y._resolve(),Y._completion.then(function(){return pt})}).catch(function(pt){return Y._reject(pt),ke(pt)})})}).bind(null,this,E,R,P,x);return P?P._promise(E,K,"lock"):jt.trans?yi(jt.transless,function(){return O._whenReady(K)}):this._whenReady(K)},Ge.prototype.table=function(m){if(y(this._allTables,m))return this._allTables[m];throw new kt.InvalidTable("Table ".concat(m," does not exist"))};var Pi=Ge;function Ge(m,v){var x,E,R,O,P,B=this,K=(this._middlewares={},this.verno=0,Ge.dependencies),K=(this._options=v=i({addons:Ge.addons,autoOpen:!0,indexedDB:K.indexedDB,IDBKeyRange:K.IDBKeyRange,cache:"cloned"},v),this._deps={indexedDB:v.indexedDB,IDBKeyRange:v.IDBKeyRange},v.addons),nt=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:yt,dbReadyPromise:null,cancelOpen:yt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:v.autoOpen}),$=(nt.dbReadyPromise=new Lt(function(V){nt.dbReadyResolve=V}),nt.openCanceller=new Lt(function(V,Q){nt.cancelOpen=Q}),this._state=nt,this.name=m,this.on=xr(this,"populate","blocked","versionchange","close",{ready:[An,yt]}),this.once=function(V,Q){var Z=function(){for(var X=[],Y=0;Y<arguments.length;Y++)X[Y]=arguments[Y];B.on(V).unsubscribe(Z),Q.apply(B,X)};return B.on(V,Z)},this.on.ready.subscribe=k(this.on.ready.subscribe,function(V){return function(Q,Z){Ge.vip(function(){var X,Y=B._state;Y.openComplete?(Y.dbOpenError||Lt.resolve().then(Q),Z&&V(Q)):Y.onReadyBeingFired?(Y.onReadyBeingFired.push(Q),Z&&V(Q)):(V(Q),X=B,Z||V(function st(){X.on.ready.unsubscribe(Q),X.on.ready.unsubscribe(st)}))})}}),this.Collection=(x=this,_n(xd.prototype,function(st,Y){this.db=x;var Z=El,X=null;if(Y)try{Z=Y()}catch(it){X=it}var Y=st._ctx,st=Y.table,ot=st.hook.reading.fire;this._ctx={table:st,index:Y.index,isPrimKey:!Y.index||st.schema.primKey.keyPath&&Y.index===st.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:X,or:Y.or,valueMapper:ot!==le?ot:null}})),this.Table=(E=this,_n(_l.prototype,function(V,Q,Z){this.db=E,this._tx=Z,this.name=V,this.schema=Q,this.hook=E._allTables[V]?E._allTables[V].hook:xr(null,{creating:[Wn,yt],reading:[Mt,le],updating:[si,yt],deleting:[On,yt]})})),this.Transaction=(R=this,_n(Ml.prototype,function(V,Q,Z,X,Y){var st=this;V!=="readonly"&&Q.forEach(function(ot){ot=(ot=Z[ot])==null?void 0:ot.yProps,ot&&(Q=Q.concat(ot.map(function(it){return it.updatesTable})))}),this.db=R,this.mode=V,this.storeNames=Q,this.schema=Z,this.chromeTransactionDurability=X,this.idbtrans=null,this.on=xr(this,"complete","error","abort"),this.parent=Y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Lt(function(ot,it){st._resolve=ot,st._reject=it}),this._completion.then(function(){st.active=!1,st.on.complete.fire()},function(ot){var it=st.active;return st.active=!1,st.on.error.fire(ot),st.parent?st.parent._reject(ot):it&&st.idbtrans&&st.idbtrans.abort(),ke(ot)})})),this.Version=(O=this,_n(Ad.prototype,function(V){this.db=O,this._cfg={version:V,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(P=this,_n(Fs.prototype,function(V,Q,Z){if(this.db=P,this._ctx={table:V,index:Q===":id"?null:Q,or:Z},this._cmp=this._ascending=he,this._descending=function(X,Y){return he(Y,X)},this._max=function(X,Y){return 0<he(X,Y)?X:Y},this._min=function(X,Y){return he(X,Y)<0?X:Y},this._IDBKeyRange=P._deps.IDBKeyRange,!this._IDBKeyRange)throw new kt.MissingAPI})),this.on("versionchange",function(V){0<V.newVersion?console.warn("Another connection wants to upgrade database '".concat(B.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(B.name,"'. Closing db now to resume the delete request.")),B.close({disableAutoOpen:!1})}),this.on("blocked",function(V){!V.newVersion||V.newVersion<V.oldVersion?console.warn("Dexie.delete('".concat(B.name,"') was blocked")):console.warn("Upgrade '".concat(B.name,"' blocked by other connection holding version ").concat(V.oldVersion/10))}),this._maxKey=Ca(v.IDBKeyRange),this._createTransaction=function(V,Q,Z,X){return new B.Transaction(V,Q,Z,B._options.chromeTransactionDurability,X)},this._fireOnBlocked=function(V){B.on("blocked").fire(V),Ps.filter(function(Q){return Q.name===B.name&&Q!==B&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire(V)})},this.use(fu),this.use(To),this.use(Cd),this.use(_d),this.use(du),new Proxy(this,{get:function(V,Q,Z){var X;return Q==="_vip"||(Q==="table"?function(Y){return Dr(B.table(Y),$)}:(X=Reflect.get(V,Q,Z))instanceof _l?Dr(X,$):Q==="tables"?X.map(function(Y){return Dr(Y,$)}):Q==="_createTransaction"?function(){return Dr(X.apply(this,arguments),$)}:X)}}));this.vip=$,K.forEach(function(V){return V(B)})}var Oa,Vs=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",gu=(Ro.prototype.subscribe=function(m,v,x){return this._subscribe(m&&typeof m!="function"?m:{next:m,error:v,complete:x})},Ro.prototype[Vs]=function(){return this},Ro);function Ro(m){this._subscribe=m}try{Oa={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Oa={indexedDB:null,IDBKeyRange:null}}function yu(m){var v,x=!1,E=new gu(function(R){var O=U(m),P,B=!1,K={},nt={},$={get closed(){return B},unsubscribe:function(){B||(B=!0,P&&P.abort(),V&&Cn.storagemutated.unsubscribe(Z))}},V=(R.start&&R.start($),!1),Q=function(){return cs(X)},Z=function(Y){So(K,Y),Bl(nt,K)&&Q()},X=function(){var Y,st,ot;!B&&Oa.indexedDB&&(K={},Y={},P&&P.abort(),P=new AbortController,ot=(it=>{var pt=rs();try{O&&an();var St=ze(m,it);return St=O?St.finally(Zn):St}finally{pt&&Oi()}})(st={subscr:Y,signal:P.signal,requery:Q,querier:m,trans:null}),Promise.resolve(ot).then(function(it){x=!0,v=it,B||st.signal.aborted||(K={},(pt=>{for(var St in pt)if(y(pt,St))return;return 1})(nt=Y)||V||(Cn(Ea,Z),V=!0),cs(function(){return!B&&R.next&&R.next(it)}))},function(it){x=!1,["DatabaseClosedError","AbortError"].includes(it?.name)||B||cs(function(){B||R.error&&R.error(it)})}))};return setTimeout(Q,0),$});return E.hasValue=function(){return x},E.getValue=function(){return v},E}var Ks=Pi;function Hl(m){var v=ps;try{ps=!0,Cn.storagemutated.fire(m),Il(m,!0)}finally{ps=v}}w(Ks,i(i({},J),{delete:function(m){return new Ks(m,{addons:[]}).delete()},exists:function(m){return new Ks(m,{addons:[]}).open().then(function(v){return v.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(m){try{return v=Ks.dependencies,x=v.indexedDB,v=v.IDBKeyRange,(wo(x)?Promise.resolve(x.databases()).then(function(E){return E.map(function(R){return R.name}).filter(function(R){return R!==br})}):Nl(x,v).toCollection().primaryKeys()).then(m)}catch{return ke(new kt.MissingAPI)}var v,x},defineClass:function(){return function(m){d(this,m)}},ignoreTransaction:function(m){return jt.trans?yi(jt.transless,m):m()},vip:kl,async:function(m){return function(){try{var v=Rr(m.apply(this,arguments));return v&&typeof v.then=="function"?v:Lt.resolve(v)}catch(x){return ke(x)}}},spawn:function(m,v,x){try{var E=Rr(m.apply(x,v||[]));return E&&typeof E.then=="function"?E:Lt.resolve(E)}catch(R){return ke(R)}},currentTransaction:{get:function(){return jt.trans||null}},waitFor:function(m,v){return m=Lt.resolve(typeof m=="function"?Ks.ignoreTransaction(m):m).timeout(v||6e4),jt.trans?jt.trans.waitFor(m):m},Promise:Lt,debug:{get:function(){return En},set:function(m){nu(m)}},derive:A,extend:d,props:w,override:k,Events:xr,on:Cn,liveQuery:yu,extendObservabilitySet:So,getByKeyPath:z,setByKeyPath:H,delByKeyPath:function(m,v){typeof v=="string"?H(m,v,void 0):"length"in v&&[].map.call(v,function(x){H(m,x,void 0)})},shallowClone:ct,deepClone:At,getObjectDiff:Eo,cmp:he,asap:F,minKey:-1/0,addons:[],connections:Ps,errnames:re,dependencies:Oa,cache:qs,semVer:"4.3.0",version:"4.3.0".split(".").map(function(m){return parseInt(m)}).reduce(function(m,v,x){return m+v/Math.pow(10,2*x)})})),Ks.maxKey=Ca(Ks.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Cn(Ea,function(m){ps||(m=new CustomEvent(Us,{detail:m}),ps=!0,dispatchEvent(m),ps=!1)}),addEventListener(Us,function(m){m=m.detail,ps||Hl(m)}));var Na,ps=!1,Kn=function(){};return typeof BroadcastChannel<"u"&&((Kn=function(){(Na=new BroadcastChannel(Us)).onmessage=function(m){return m.data&&Hl(m.data)}})(),typeof Na.unref=="function"&&Na.unref(),Cn(Ea,function(m){ps||Na.postMessage(m)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(m){if(!Pi.disableBfCache&&m.persisted){En&&console.debug("Dexie: handling persisted pagehide"),Na?.close();for(var v=0,x=Ps;v<x.length;v++)x[v].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(m){!Pi.disableBfCache&&m.persisted&&(En&&console.debug("Dexie: handling persisted pageshow"),Kn(),Hl({all:new Tn(-1/0,[[]])}))})),Lt.rejectionMapper=function(m,v){return!m||m instanceof wt||m instanceof TypeError||m instanceof SyntaxError||!m.name||!He[m.name]?m:(v=new He[m.name](v||m.message,m),"stack"in m&&_(v,"stack",{get:function(){return this.inner.stack}}),v)},nu(En),i(Pi,Object.freeze({__proto__:null,Dexie:Pi,Entity:su,PropModification:Aa,RangeSet:Tn,add:function(m){return new Aa({add:m})},cmp:he,default:Pi,liveQuery:yu,mergeRanges:Hs,rangesOverlap:cu,remove:function(m){return new Aa({remove:m})},replacePrefix:function(m,v){return new Aa({replacePrefix:[m,v]})}}),{default:Pi}),Pi})})(jh)),jh.exports}var _C=EC();const Zp=Cv(_C),Y0=Symbol.for("Dexie"),$h=globalThis[Y0]||(globalThis[Y0]=Zp);if(Zp.semVer!==$h.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Zp.semVer} and ${$h.semVer}`);const{liveQuery:dR,mergeRanges:fR,rangesOverlap:pR,RangeSet:mR,cmp:gR,Entity:yR,PropModification:bR,replacePrefix:vR,add:wR,remove:xR,DexieYProvider:SR}=$h,Lm=new $h("WiseMarkDB");Lm.version(1).stores({pdfs:"hash, filename, size, blob"});async function Cw(r){const t=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}async function Pm(r,t,e,i){await Lm.pdfs.put({hash:r,filename:t,size:e,blob:i})}async function CC(r){const t=await Lm.pdfs.get(r);return t?{data:t.blob,filename:t.filename,size:t.size}:null}async function TC(r){if(!r?.pdf_hash)return null;try{const{data:t}=await Yn.getPdf(r.id),e=(t instanceof ArrayBuffer,t),i=r.file_size??e?.byteLength??0;return await Pm(r.pdf_hash,r.filename||"",i,e),{data:e,filename:r.filename||"",size:i}}catch{const t=await CC(r.pdf_hash);return t||null}}const Ss=["#f59e0b","#3b82f6","#10b981","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316"];function Cp(r){if(!r)return null;const t=new Date(r);return Number.isNaN(t.getTime())?null:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}function RC(){const{projectId:r}=ym(),t=ya(),e=vl(),[i,a]=I.useState(!1),[l,c]=I.useState(""),[u,d]=I.useState(null),[f,p]=I.useState(""),[y,w]=I.useState(!1),[S,_]=I.useState(""),[A,C]=I.useState(null),[M,N]=I.useState(""),[k,j]=I.useState(null),[F,z]=I.useState(Ss[0]),H=I.useRef(null),ct=I.useRef(null),dt=I.useRef(null),[Tt,xt]=I.useState(0),{data:Nt,isLoading:At}=pa({queryKey:["project",r],queryFn:async()=>{const{data:Mt}=await Kh.get(r);return Mt},enabled:!!r}),{data:Rt,isLoading:qt}=pa({queryKey:["documents",r],queryFn:async()=>{const{data:Mt}=await Yn.list({project:r});return Mt},enabled:!!r}),G=Array.isArray(Rt)?Rt:Rt?.results??[],tt=Pc({mutationFn:({id:Mt,name:de})=>Kh.update(Mt,{name:de}),onSuccess:()=>{e.invalidateQueries({queryKey:["project",r]}),e.invalidateQueries({queryKey:["projects"]}),w(!1)}}),vt=Pc({mutationFn:({id:Mt,filename:de})=>Yn.update(Mt,{filename:de}),onSuccess:()=>{e.invalidateQueries({queryKey:["documents",r]}),d(null),p("")}}),Xt=Pc({mutationFn:Mt=>Yn.delete(Mt),onSuccess:()=>e.invalidateQueries({queryKey:["documents",r]})}),Ct=async Mt=>{const de=Mt.target.files?.[0];if(!de||!de.type.includes("pdf"))return;c(""),C(de);const Wn=de.name.replace(/\.pdf$/i,"")||de.name;N(Wn),z(Ss[G.length%Ss.length]),j(null),H.current=null;try{const On=await de.arrayBuffer(),si=await Cw(On),Di={arrayBuffer:On,hash:si,size:de.size};j(Di),H.current={...Di,suggestedName:Wn}}catch(On){c(On.message||"Could not read file"),C(null),N("")}},U=()=>{C(null),N(""),j(null),z(Ss[0]),c(""),H.current=null,xt(Mt=>Mt+1)},J=()=>{dt.current?.click()},ft=async Mt=>{Mt.preventDefault();const de=r,On=ct.current?.value?.trim()||M?.trim()||H.current?.suggestedName?.trim()||"",si=H.current||k;if(!de){c("Project not found.");return}if(!On){c("Please enter a name for the PDF.");return}if(!si||!si.hash||!si.arrayBuffer){c("File data missing. Please close and select the file again.");return}const Di=On.toLowerCase().endsWith(".pdf")?On:`${On}.pdf`;c(""),a(!0);try{const An=new FormData;An.append("project",String(de)),An.append("filename",Di),An.append("color",F),An.append("file",new Blob([si.arrayBuffer]),Di),await Yn.createWithFile(An),await Pm(si.hash,Di,si.size,si.arrayBuffer),e.invalidateQueries({queryKey:["documents",de]}),C(null),N(""),j(null),H.current=null,xt(En=>En+1)}catch(An){const En=An.response?.data?.detail||typeof An.response?.data=="object"&&Object.values(An.response?.data||{}).flat().join(" ")||An.message||"Upload failed";c(String(En))}finally{a(!1)}},wt=Mt=>{d(Mt.id),p(Mt.filename||"")},Bt=()=>{if(u==null||!f.trim()){d(null);return}vt.mutate({id:u,filename:f.trim()})},Ft=()=>{d(null),p("")},It=()=>{_(Nt?.name??""),w(!0)},re=()=>{const Mt=S.trim();if(!Mt||Mt===Nt?.name){w(!1);return}tt.mutate({id:r,name:Mt})},Kt=()=>{w(!1),_("")},kt=ba(Mt=>Mt.logout),{data:He}=pa({queryKey:["me"],queryFn:async()=>{const{data:Mt}=await fl.me();return Mt}}),yt=(He?.email?.[0]||He?.username?.[0]||"?").toUpperCase(),le=Nt?.color&&Ss.includes(Nt.color)?Nt.color:Nt?Ss[Nt.id%Ss.length]:Ss[0];return At||!Nt?D.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:D.jsx(Ds,{className:"w-8 h-8 animate-spin text-slate-400"})}):D.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif",color:"#1e293b"},children:[D.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap",rel:"stylesheet"}),D.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:()=>t("/app"),className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Back to projects",children:D.jsx(rd,{className:"w-4 h-4"})}),D.jsx("div",{className:"w-6 h-6 rounded-md bg-slate-700 flex items-center justify-center text-white text-xs font-semibold",style:{fontFamily:"'DM Sans', sans-serif"},children:"W"}),D.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:()=>{kt(),t("/login",{replace:!0})},className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:D.jsx(Nm,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:()=>t("/app/settings"),className:"w-8 h-8 rounded-full bg-slate-700 text-white flex items-center justify-center text-[13px] font-semibold hover:bg-slate-600 transition-colors cursor-pointer",title:"Account settings",children:yt})]})]}),D.jsxs("div",{className:"max-w-[720px] mx-auto px-6 py-10",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsxs("div",{className:"flex items-start justify-between mb-2",children:[D.jsx("div",{className:"flex items-center gap-2 min-w-0",children:y?D.jsxs(D.Fragment,{children:[D.jsx("input",{type:"text",value:S,onChange:Mt=>_(Mt.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900 min-w-0 flex-1 max-w-md text-[28px]",style:{fontFamily:"'Instrument Serif', serif",fontWeight:700,letterSpacing:"0.01em"},autoFocus:!0,onKeyDown:Mt=>{Mt.key==="Enter"&&re(),Mt.key==="Escape"&&Kt()}}),D.jsx("button",{type:"button",onClick:re,className:"p-2 text-green-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Save",children:D.jsx($0,{className:"w-5 h-5"})}),D.jsx("button",{type:"button",onClick:Kt,className:"p-2 text-slate-500 hover:bg-slate-100 rounded-lg shrink-0",title:"Cancel",children:D.jsx(Wp,{className:"w-5 h-5"})})]}):D.jsxs(D.Fragment,{children:[D.jsx("h1",{className:"m-0 text-[28px] text-slate-950 truncate",style:{fontFamily:"'Instrument Serif', serif",fontWeight:700,letterSpacing:"0.01em"},children:Nt.name}),D.jsx("button",{type:"button",onClick:It,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Edit project name",children:D.jsx(Yp,{className:"w-4 h-4"})})]})}),D.jsxs("button",{type:"button",onClick:J,disabled:i,className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors hover:bg-slate-700 shrink-0 disabled:opacity-70",style:{background:"#1e293b",fontFamily:"'DM Sans', sans-serif"},children:[D.jsx(Qp,{className:"w-4 h-4"}),"Add PDF"]})]}),D.jsx("div",{className:"flex items-center gap-3 text-xs text-slate-400 mb-6 uppercase",style:{fontFamily:"'JetBrains Mono', monospace",letterSpacing:"0.08em"},children:D.jsxs("span",{children:[G.length," document",G.length!==1?"s":""]})}),D.jsx("input",{ref:dt,type:"file",accept:".pdf",onChange:Ct,className:"hidden","aria-hidden":"true",tabIndex:-1},Tt),l&&D.jsx("p",{className:"text-sm text-red-600 mb-4",children:l}),i&&D.jsxs("p",{className:"flex items-center gap-2 text-sm text-slate-600 mb-4",children:[D.jsx(Ds,{className:"w-4 h-4 animate-spin"})," Uploading..."]}),qt?D.jsxs("div",{className:"flex items-center gap-2 text-slate-500 py-12",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx(Ds,{className:"w-5 h-5 animate-spin"})," Loading PDFs"]}):G.length===0?D.jsxs("div",{className:"rounded-xl border border-slate-200 p-8 text-center text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx(_w,{className:"w-12 h-12 mx-auto mb-3 text-slate-400"}),D.jsx("p",{children:"No PDFs in this project yet. Add a PDF above."})]}):D.jsx("ul",{className:"space-y-2",children:G.map(Mt=>D.jsx("li",{className:"rounded-xl border border-slate-200 bg-white overflow-hidden transition-all duration-200 hover:shadow-[0_4px_12px_rgba(71,85,105,0.08)] hover:-translate-y-px cursor-pointer",children:u===Mt.id?D.jsxs("div",{className:"flex items-center gap-2 px-5 py-3",children:[D.jsx("input",{type:"text",value:f,onChange:de=>p(de.target.value),className:"flex-1 min-w-0 border border-slate-200 rounded-lg px-3 py-2 text-slate-900",autoFocus:!0,onKeyDown:de=>{de.key==="Enter"&&Bt(),de.key==="Escape"&&Ft()}}),D.jsx("button",{type:"button",onClick:Bt,className:"p-2.5 text-green-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Save",children:D.jsx($0,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:Ft,className:"p-2.5 text-slate-500 hover:bg-slate-100 rounded-lg shrink-0",title:"Cancel",children:D.jsx(Wp,{className:"w-4 h-4"})})]}):D.jsxs("div",{className:"flex items-center gap-4 px-5 py-3 cursor-pointer",onClick:()=>t(`/document/${Mt.id}`),children:[D.jsx("div",{className:"shrink-0 rounded-sm",style:{width:4,height:40,background:Mt.color&&Ss.includes(Mt.color)?Mt.color:le}}),D.jsxs("div",{className:"flex-1 min-w-0 py-1 flex flex-col items-start gap-0.5",children:[D.jsx("span",{className:"text-base font-normal text-slate-900 truncate block w-full",style:{fontFamily:"'Instrument Serif', serif"},children:Mt.filename}),D.jsxs("span",{className:"text-xs text-slate-400 block",style:{fontFamily:"'JetBrains Mono', monospace"},children:[Mt.file_size!=null&&`${(Mt.file_size/1024).toFixed(1)} KB`,Mt.file_size!=null&&Cp(Mt.created_at)&&"  ",Cp(Mt.created_at)?`Uploaded ${Cp(Mt.created_at)}`:null]})]}),D.jsx("button",{type:"button",onClick:de=>{de.stopPropagation(),wt(Mt)},className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Rename",children:D.jsx(Yp,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:de=>{de.stopPropagation(),confirm("Delete this PDF?")&&Xt.mutate(Mt.id)},className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg shrink-0",title:"Delete",children:D.jsx(km,{className:"w-4 h-4"})})]})},Mt.id))})]}),A&&D.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4 bg-slate-950/40 backdrop-blur-sm",onClick:U,children:D.jsxs("div",{className:"rounded-xl bg-white border border-slate-200 shadow-xl w-full max-w-md p-6",onClick:Mt=>Mt.stopPropagation(),children:[D.jsx("h2",{className:"m-0 text-xl font-normal text-slate-900 mb-4",style:{fontFamily:"'Instrument Serif', serif"},children:"Name this PDF"}),k?D.jsxs("div",{className:"space-y-4",children:[l&&D.jsx("p",{className:"text-sm text-red-600 bg-red-50 rounded-lg px-3 py-2",children:l}),D.jsx("input",{ref:ct,type:"text",value:M,onChange:Mt=>N(Mt.target.value),placeholder:"Document name",className:"w-full border border-slate-200 rounded-lg px-3 py-2.5 text-slate-900",autoFocus:!0,disabled:i}),D.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mb-2 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Colour"}),D.jsx("div",{className:"flex gap-2",children:Ss.map(Mt=>D.jsx("button",{type:"button",onClick:()=>z(Mt),disabled:i,className:"w-7 h-7 rounded-full shrink-0 transition-all border-2 border-transparent focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:opacity-60",style:{background:Mt,borderColor:F===Mt?"#1e293b":"transparent",outline:F===Mt?"2px solid #fff":"none",outlineOffset:-4}},Mt))}),D.jsxs("div",{className:"flex justify-end gap-3 pt-2",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx("button",{type:"button",onClick:U,disabled:i,className:"px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:"Cancel"}),D.jsx("button",{type:"button",onClick:Mt=>{Mt.preventDefault(),ft(Mt)},disabled:i||!M.trim(),className:"px-4 py-2 text-sm font-medium rounded-lg text-white hover:bg-slate-700",style:{background:"#1e293b"},children:i?D.jsxs("span",{className:"inline-flex items-center gap-2",children:[D.jsx(Ds,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Upload & save"})]})]}):D.jsxs("div",{className:"flex items-center gap-2 text-slate-600 py-4",children:[D.jsx(Ds,{className:"w-5 h-5 animate-spin shrink-0"}),D.jsx("span",{children:"Reading file..."})]})]})})]})}const pi={yellow:{key:"yellow",label:"Yellow",name:"Key Metrics",hex:"#EAB308",rgba:"rgba(254, 243, 199, 0.5)",rgbaSoft:"rgba(234,179,8,0.18)",rgbaHover:"rgba(234,179,8,0.38)",solid:"#fbbf24"},green:{key:"green",label:"Green",name:"Competitive Advantages",hex:"#22C55E",rgba:"rgba(209, 250, 229, 0.5)",rgbaSoft:"rgba(34,197,94,0.18)",rgbaHover:"rgba(34,197,94,0.38)",solid:"#10b981"},blue:{key:"blue",label:"Blue",name:"Management Questions",hex:"#3B82F6",rgba:"rgba(219, 234, 254, 0.5)",rgbaSoft:"rgba(59,130,246,0.18)",rgbaHover:"rgba(59,130,246,0.38)",solid:"#3b82f6"},pink:{key:"pink",label:"Pink",name:"Investment Risks",hex:"#EC4899",rgba:"rgba(252, 231, 243, 0.5)",rgbaSoft:"rgba(236,72,153,0.18)",rgbaHover:"rgba(236,72,153,0.38)",solid:"#ec4899"},orange:{key:"orange",label:"Orange",name:"Commercial DD",hex:"#F97316",rgba:"rgba(254, 215, 170, 0.5)",rgbaSoft:"rgba(249,115,22,0.18)",rgbaHover:"rgba(249,115,22,0.38)",solid:"#f59e0b"}},da=Object.keys(pi);function Rs(r,t={}){return t&&typeof t[r]=="string"&&t[r].trim()?t[r].trim():pi[r]&&pi[r].name||r}const ei=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Jp=[.001,0,0,.001,0,0],Tp=1.35,Ci={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},nr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Ic="pdfjs_internal_editor_",oe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},we={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},MC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},tm={TRIANGLES:1,LATTICE:2},wn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Fh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},bn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},el={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},od={ERRORS:0,WARNINGS:1,INFOS:5},Uc={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},_c={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},DC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let ld=od.WARNINGS;function OC(r){Number.isInteger(r)&&(ld=r)}function NC(){return ld}function cd(r){ld>=od.INFOS&&console.info(`Info: ${r}`)}function ne(r){ld>=od.WARNINGS&&console.warn(`Warning: ${r}`)}function Me(r){throw new Error(r)}function Re(r,t){r||Me(t)}function kC(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Tw(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"&&(e.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),e.tryConvertEncoding))try{r=IC(r)}catch{}const i=t?URL.parse(r,t):URL.parse(r);return kC(i)?i:null}function Rw(r,t,e=!1){const i=URL.parse(r);return i?(i.hash=t,i.href):e&&Tw(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function ie(r,t,e,i=!1){return Object.defineProperty(r,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const io=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class Q0 extends io{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Rp extends io{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class em extends io{constructor(t){super(t,"InvalidPDFException")}}class Xh extends io{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class LC extends io{constructor(t){super(t,"FormatError")}}class rr extends io{constructor(t){super(t,"AbortException")}}function PC(r){(typeof r!="object"||r?.length===void 0)&&Me("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const i=[];for(let a=0;a<t;a+=e){const l=Math.min(a+e,t),c=r.subarray(a,l);i.push(String.fromCharCode.apply(null,c))}return i.join("")}function ud(r){typeof r!="string"&&Me("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=r.charCodeAt(i)&255;return e}function BC(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function jC(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function FC(){try{return new Function(""),!0}catch{return!1}}class Sn{static get isLittleEndian(){return ie(this,"isLittleEndian",jC())}static get isEvalSupported(){return ie(this,"isEvalSupported",FC())}static get isOffscreenCanvasSupported(){return ie(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ie(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ie(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ie(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return ie(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return ie(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Mp=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class Ht{static makeHexColor(t,e,i){return`#${Mp[t]}${Mp[e]}${Mp[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const a=t[i],l=t[i+1];t[i]=a*e[0]+l*e[2]+e[4],t[i+1]=a*e[1]+l*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5];for(let p=0;p<6;p+=2){const y=t[i+p],w=t[i+p+1];t[i+p]=y*a+w*c+d,t[i+p+1]=y*l+w*u+f}}static applyInverseTransform(t,e){const i=t[0],a=t[1],l=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-a*e[2]+e[2]*e[5]-e[4]*e[3])/l,t[1]=(-i*e[1]+a*e[0]+e[4]*e[1]-e[5]*e[0])/l}static axialAlignedBoundingBox(t,e,i){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5],p=t[0],y=t[1],w=t[2],S=t[3];let _=a*p+d,A=_,C=a*w+d,M=C,N=u*y+f,k=N,j=u*S+f,F=j;if(l!==0||c!==0){const z=l*p,H=l*w,ct=c*y,dt=c*S;_+=ct,M+=ct,C+=dt,A+=dt,N+=z,F+=z,j+=H,k+=H}i[0]=Math.min(i[0],_,C,A,M),i[1]=Math.min(i[1],N,j,k,F),i[2]=Math.max(i[2],_,C,A,M),i[3]=Math.max(i[3],N,j,k,F)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],a=t[1],l=t[2],c=t[3],u=i**2+a**2,d=i*l+a*c,f=l**2+c**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-d**2));e[0]=Math.sqrt(p+y||1),e[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>a)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return l>c?null:[i,l,a,c]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,a,l){l[0]=Math.min(l[0],t,i),l[1]=Math.min(l[1],e,a),l[2]=Math.max(l[2],t,i),l[3]=Math.max(l[3],e,a)}static#t(t,e,i,a,l,c,u,d,f,p){if(f<=0||f>=1)return;const y=1-f,w=f*f,S=w*f,_=y*(y*(y*t+3*f*e)+3*w*i)+S*a,A=y*(y*(y*l+3*f*c)+3*w*u)+S*d;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],A),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],A)}static#e(t,e,i,a,l,c,u,d,f,p,y,w){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,i,a,l,c,u,d,-y/p,w);return}const S=p**2-4*y*f;if(S<0)return;const _=Math.sqrt(S),A=2*f;this.#t(t,e,i,a,l,c,u,d,(-p+_)/A,w),this.#t(t,e,i,a,l,c,u,d,(-p-_)/A,w)}static bezierBoundingBox(t,e,i,a,l,c,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,i,l,u,e,a,c,d,3*(-t+3*(i-l)+u),6*(t-2*i+l),3*(i-t),f),this.#e(t,i,l,u,e,a,c,d,3*(-e+3*(a-c)+d),6*(e-2*a+c),3*(a-e),f)}}function IC(r){return decodeURIComponent(escape(r))}let Dp=null,W0=null;function UC(r){return Dp||(Dp=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,W0=new Map([["","t"]])),r.replaceAll(Dp,(t,e,i)=>e?e.normalize("NFKC"):W0.get(i))}function Mw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),PC(r)}const sl="pdfjs_internal_id_";function zC(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,a,...l]=e;if(!r(i)&&!Number.isInteger(i)||!t(a))return!1;const c=l.length;let u=!0;switch(a.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const d of l)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Un(r,t,e){return Math.min(Math.max(r,t),e)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});class zc{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function a(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(zc.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&e.push({str:c}),!!l.children)for(const d of l.children)a(d)}return a(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Dw{static setupStorage(t,e,i,a,l){const c=a.getValue(e,{value:null});switch(i.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(c.value===i.attributes.xfaOn?t.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{a.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of i.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:a,linkService:l}){const{attributes:c}=e,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${a}`);for(const[d,f]of Object.entries(c))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(t,c.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,a=t.xfaHtml,l=t.intent||"display",c=document.createElement(a.name);a.attributes&&this.setAttributes({html:c,element:a,intent:l,linkService:i});const u=l!=="richText",d=t.div;if(d.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=y}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const y=document.createTextNode(a.value);c.append(y),u&&zc.shouldBuildText(a.name)&&f.push(y)}return{textDivs:f}}const p=[[a,-1,c]];for(;p.length>0;){const[y,w,S]=p.at(-1);if(w+1===y.children.length){p.pop();continue}const _=y.children[++p.at(-1)[1]];if(_===null)continue;const{name:A}=_;if(A==="#text"){const M=document.createTextNode(_.value);f.push(M),S.append(M);continue}const C=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,A):document.createElement(A);if(S.append(C),_.attributes&&this.setAttributes({html:C,element:_,storage:e,intent:l,linkService:i}),_.children?.length>0)p.push([_,-1,C]);else if(_.value){const M=document.createTextNode(_.value);u&&zc.shouldBuildText(A)&&f.push(M),C.append(M)}}for(const y of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const la="http://www.w3.org/2000/svg";class pl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Wc(r,t="text"){if(Nc(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}i(new Error(a.statusText))}},a.send(null)})}class Zc{constructor({viewBox:t,userUnit:e,scale:i,rotation:a,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=a,this.offsetX=l,this.offsetY=c,i*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,w,S;switch(a%=360,a<0&&(a+=360),a){case 180:p=-1,y=0,w=0,S=1;break;case 90:p=0,y=1,w=1,S=0;break;case 270:p=0,y=-1,w=-1,S=0;break;case 0:p=1,y=0,w=0,S=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(w=-w,S=-S);let _,A,C,M;p===0?(_=Math.abs(f-t[1])*i+l,A=Math.abs(d-t[0])*i+c,C=(t[3]-t[1])*i,M=(t[2]-t[0])*i):(_=Math.abs(d-t[0])*i+l,A=Math.abs(f-t[1])*i+c,C=(t[2]-t[0])*i,M=(t[3]-t[1])*i),this.transform=[p*i,y*i,w*i,S*i,_-p*i*d-w*i*f,A-y*i*d-S*i*f],this.width=C,this.height=M}get rawDims(){const t=this.viewBox;return ie(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:a=this.offsetY,dontFlip:l=!1}={}){return new Zc({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}convertToViewportPoint(t,e){const i=[t,e];return Ht.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];Ht.applyTransform(e,this.transform);const i=[t[2],t[3]];return Ht.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return Ht.applyInverseTransform(i,this.transform),i}}class Bm extends io{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function hd(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function jm(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function HC(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function qC(r,t="document.pdf"){if(typeof r!="string")return t;if(hd(r))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(r);if(!i)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},l=/\.pdf$/i,c=i.pathname.split("/").at(-1);if(l.test(c))return a(c);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const f of u)if(l.test(f))return a(f);const d=Array.from(i.searchParams.keys()).reverse();for(const f of d)if(l.test(f))return a(f)}if(i.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(d)return a(d[0])}return t}class Z0{started=Object.create(null);times=[];time(t){t in this.started&&ne(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ne(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:a,end:l}of this.times)t.push(`${i.padEnd(e)} ${l-a}ms
`);return t.join("")}}function Nc(r,t){const e=t?URL.parse(r,t):URL.parse(r);return e?.protocol==="http:"||e?.protocol==="https:"}function $i(r){r.preventDefault()}function nn(r){r.preventDefault(),r.stopPropagation()}function GC(r){console.log("Deprecated API usage: "+r)}class nm{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let l=parseInt(e[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(e[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=p,u+=y):f==="+"&&(c-=p,u-=y),new Date(Date.UTC(i,a,l,c,u,d))}}function VC(r,{scale:t=1,rotation:e=0}){const{width:i,height:a}=r.attributes.style,l=[0,0,parseInt(i),parseInt(a)];return new Zc({viewBox:l,userUnit:1,scale:t,rotation:e})}function Jc(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ne(`Not a valid color format: "${r}"`),[0,0,0])}function KC(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;r.set(e,Jc(i))}t.remove()}function Ze(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform();return[t,e,i,a,l,c]}function As(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform().invertSelf();return[t,e,i,a,l,c]}function eo(r,t,e=!1,i=!0){if(t instanceof Zc){const{pageWidth:a,pageHeight:l}=t.rawDims,{style:c}=r,u=Sn.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(c.width=p,c.height=y):(c.width=y,c.height=p)}i&&r.setAttribute("data-main-rotation",t.rotation)}class Os{constructor(){const{pixelRatio:t}=Os;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,a,l=-1){let c=1/0,u=1/0,d=1/0;i=Os.capPixels(i,l),i>0&&(c=Math.sqrt(i/(t*e))),a!==-1&&(u=a/t,d=a/e);const f=Math.min(c,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const im=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class $C{static get isDarkMode(){return ie(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class XC{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),ie(this,"commentForegroundColor",Jc(i))}}function YC(r,t,e,i){i=Math.min(Math.max(i??1,0),1);const a=255*(1-i);return r=Math.round(r*i+a),t=Math.round(t*i+a),e=Math.round(e*i+a),[r,t,e]}function J0(r,t){const e=r[0]/255,i=r[1]/255,a=r[2]/255,l=Math.max(e,i,a),c=Math.min(e,i,a),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const d=l-c;switch(t[1]=u<.5?d/(l+c):d/(2-l-c),l){case e:t[0]=((i-a)/d+(i<a?6:0))*60;break;case i:t[0]=((a-e)/d+2)*60;break;case a:t[0]=((e-i)/d+4)*60;break}}t[2]=u}function sm(r,t){const e=r[0],i=r[1],a=r[2],l=(1-Math.abs(2*a-1))*i,c=l*(1-Math.abs(e/60%2-1)),u=a-l/2;switch(Math.floor(e/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function tv(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function ev(r,t,e){sm(r,e),e.map(tv);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];sm(t,e),e.map(tv);const a=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>a?(i+.05)/(a+.05):(a+.05)/(i+.05)}const nv=new Map;function QC(r,t){const e=r[0]+r[1]*256+r[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=nv.get(e);if(i)return i;const a=new Float32Array(9),l=a.subarray(0,3),c=a.subarray(3,6);J0(r,c);const u=a.subarray(6,9);J0(t,u);const d=u[2]<.5,f=d?12:4.5;if(c[2]=d?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),ev(c,u,l)<f){let p,y;d?(p=c[2],y=1):(p=0,y=c[2]);const w=.005;for(;y-p>w;){const S=c[2]=(p+y)/2;d===ev(c,u,l)<f?p=S:y=S}c[2]=d?y:p}return sm(c,l),i=Ht.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),nv.set(e,i),i}function Ow({html:r,dir:t,className:e},i){const a=document.createDocumentFragment();if(typeof r=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=r.split(/(?:\r\n?|\n)/);for(let u=0,d=c.length;u<d;++u){const f=c[u];l.append(document.createTextNode(f)),u<d-1&&l.append(document.createElement("br"))}a.append(l)}else Dw.render({xfaHtml:r,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",e),i.append(a)}function Nw(r){const t=new Path2D;if(!r)return t;for(let e=0,i=r.length;e<i;)switch(r[e++]){case _c.moveTo:t.moveTo(r[e++],r[e++]);break;case _c.lineTo:t.lineTo(r[e++],r[e++]);break;case _c.curveTo:t.bezierCurveTo(r[e++],r[e++],r[e++],r[e++],r[e++],r[e++]);break;case _c.quadraticCurveTo:t.quadraticCurveTo(r[e++],r[e++],r[e++],r[e++]);break;case _c.closePath:t.closePath();break;default:ne(`Unrecognized drawing path operator: ${r[e-1]}`);break}return t}class Ce{static#t=null;static#e=null;static#i=null;static#n=0;static#s=[];get pagesNumber(){return Ce.#n}set pagesNumber(t){Ce.#n!==t&&(Ce.#n=t,t===0&&(Ce.#e=null,Ce.#t=null))}addListener(t){Ce.#s.push(t)}removeListener(t){const e=Ce.#s.indexOf(t);e>=0&&Ce.#s.splice(e,1)}#r(){for(const t of Ce.#s)t()}#a(t){if(Ce.#e)return;const e=Ce.#n,i=new Uint32Array(3*e),a=Ce.#e=i.subarray(0,e),l=Ce.#t=i.subarray(e,2*e);if(t)for(let c=0;c<e;c++)a[c]=l[c]=c+1;Ce.#i=i.subarray(2*e)}movePages(t,e,i){this.#a(!0);const a=Ce.#e,l=Ce.#t;Ce.#i.set(l);const c=e.length,u=new Uint32Array(c);let d=0;for(let S=0;S<c;S++){const _=e[S]-1;u[S]=a[_],_<i&&(d+=1)}const f=Ce.#n;let p=i-d;const y=f-c;p=Un(p,0,y);for(let S=0,_=0;S<f;S++)t.has(S+1)||(a[_++]=a[S]);a.copyWithin(p+c,p,y),a.set(u,p);let w=!1;for(let S=0,_=f;S<_;S++){const A=a[S];w||=A!==S+1,l[A-1]=S+1}this.#r(),w||(this.pagesNumber=0)}hasBeenAltered(){return Ce.#e!==null}getPageMappingForSaving(){return{pageIndices:Ce.#t?Ce.#t.map(t=>t-1):null}}getPrevPageNumber(t){return Ce.#i[Ce.#e[t-1]-1]}getPageNumber(t){return Ce.#t?.[t-1]??t}getPageId(t){return Ce.#e?.[t-1]??t}static get instance(){return ie(this,"instance",new Ce)}getMapping(){return Ce.#e.subarray(0,this.pagesNumber)}}class Bc{#t=null;#e=null;#i;#n=null;#s=null;#r=null;#a=null;#o=null;static#c=null;constructor(t){this.#i=t,Bc.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",$i,{signal:e}),t.addEventListener("pointerdown",Bc.#l,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const a=this.#i.toolbarPosition;if(a){const{style:l}=t,c=this.#i._uiManager.direction==="ltr"?1-a[0]:a[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,nn(t)}#h(t){this.#i._focusEventsAllowed=!0,nn(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",$i,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",Bc.#c[t]),this.#f(i)&&i.addEventListener("click",a=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#g),this.#s=t}addComment(t,e=null){if(this.#r)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const a=this.#a=this.#g;e?(this.#n.insertBefore(i,e),this.#n.insertBefore(a,e)):this.#n.append(i,a),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#g)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#g)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#a?.remove(),this.#a=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const a=this.#n.querySelector(i);a&&t==="comment"&&this.addComment(e,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class WC{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",$i,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#s(t,e){let i=0,a=0;for(const l of t){const c=l.y+l.height;if(c<i)continue;const u=l.x+(e?l.width:0);if(c>i){a=u,i=c;continue}e?u>a&&(a=u):u<a&&(a=u)}return[e?1-a:a,i]}show(t,e,i){const[a,l]=this.#s(e,i),{style:c}=this.#e||=this.#n();t.append(this.#e),c.insetInlineEnd=`${100*a}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,i,a){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",e);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",i);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",$i,{signal:u}),l.addEventListener("click",a,{signal:u})),this.#t.append(l)}}function kw(r,t,e){for(const i of e)t.addEventListener(i,r[i].bind(r))}class Te{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(Te.#e||=new Set).add(t)}static setPointer(t,e){Te.#t||=e,Te.#n??=t}static setTimeStamp(t){Te.#i=t}static isSamePointerId(t){return Te.#t===t}static isSamePointerIdOrRemove(t){return Te.#t===t?!0:(Te.#e?.delete(t),!1)}static isSamePointerType(t){return Te.#n===t}static isInitializedAndDifferentPointerType(t){return Te.#n!==null&&!Te.isSamePointerType(t)}static isSameTimeStamp(t){return Te.#i===t}static isUsingMultiplePointers(){return Te.#e?.size>=1}static clearPointerType(){Te.#n=null}static clearPointerIds(){Te.#t=NaN,Te.#e=null}static clearTimeStamp(){Te.#i=NaN}}class ZC{#t=0;get id(){return`${Ic}${this.#t++}`}}class Fm{#t=Mw();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const l=a.decode().then(()=>(i.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ie(this,"_isSVGFittingCanvas",l)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof e=="string"?(i.url=e,a=await Wc(e,"blob")):e instanceof File?a=i.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const l=Fm._isSVGFittingCanvas,c=new FileReader,u=new Image,d=new Promise((f,p)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,f()},c.onload=async()=>{const y=i.svgUrl=c.result;u.src=await l?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=p});c.readAsDataURL(a),await d}else i.bitmap=await createImageBitmap(a);i.refCounter=1}catch(a){ne(a),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:a,type:l}=t;return this.#n(`${e}_${i}_${a}_${l}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),i={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const a=new OffscreenCanvas(i.width,i.height);a.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=a.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class JC{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:a,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:e,post:i,type:l};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(d);return}if(c&&this.#t[this.#n].type===l){u&&(d.undo=this.#t[this.#n].undo),this.#t[this.#n]=d;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class tu{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Sn.platform;for(const[i,a,l={}]of t)for(const c of i){const u=c.startsWith("mac+");e&&u?(this.callbacks.set(c.slice(4),{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1))):!e&&!u&&(this.callbacks.set(c,{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:a,options:{bubbles:l=!1,args:c=[],checker:u=null}}=i;u&&!u(t,e)||(a.bind(t,...c,e)(),l||nn(e))}}class Im{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return KC(t),ie(this,"_colors",t)}convert(t){const e=Jc(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,a]of this._colors)if(a.every((l,c)=>l===e[c]))return Im._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?Ht.makeHexColor(...e):t}}class or{#t=new AbortController;#e=null;#i=null;#n=new Map;#s=new Map;#r=null;#a=null;#o=null;#c=new JC;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#A=null;#w=null;#C=null;#x=!1;#_=null;#D=new ZC;#R=!1;#M=!1;#j=!1;#N=null;#L=null;#F=null;#P=null;#G=null;#T=oe.NONE;#S=new Set;#k=null;#I=null;#z=null;#$=null;#K=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#B=null;#V=null;#Z=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=or.prototype,e=c=>c.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),i=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return ie(this,"_keyboardManager",new tu([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:e}]]))}constructor(t,e,i,a,l,c,u,d,f,p,y,w,S,_,A,C){const M=this._signal=this.#t.signal;this.#V=t,this.#Z=e,this.#J=i,this.#r=a,this.#l=l,this.#I=c,this.#K=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:M}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:M}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:M}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:M}),u._on("setpreference",this.onSetPreference.bind(this),{signal:M}),u._on("switchannotationeditorparams",N=>this.updateParams(N.type,N.value),{signal:M}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:M}),window.addEventListener("pointerdown",()=>{this.#M=!0},{capture:!0,signal:M}),window.addEventListener("pointerup",()=>{this.#M=!1},{capture:!0,signal:M}),this.#rt(),this.#dt(),this.#et(),this.#a=d.annotationStorage,this.#E=d.filterFactory,this.#z=f,this.#C=p||null,this.#y=y,this.#v=w,this.#b=S,this.#G=_||null,this.viewParameters={realScale:pl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=A||null,this._supportsPinchToZoom=C!==!1,l?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#p.clear(),this.#P?.clear(),this.#e=null,this.#S.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#I?.destroy(),this.#_?.hide(),this.#_=null,this.#F?.destroy(),this.#F=null,this.#i=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#B&&(clearTimeout(this.#B),this.#B=null),this._editorUndoBar?.destroy(),this.#K=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return ie(this,"hcmFilter",this.#z?this.#E.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return ie(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return ie(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return ie(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[a,l]of t){const c=a.endsWith("_HCM");if(i&&c){e.set(a.replace("_HCM",""),l);continue}!i&&!c&&e.set(a,l)}return ie(this,"highlightColors",e)}get highlightColorNames(){return ie(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,a){this.#l?.showDialog(this,t,e,i,a)}selectComment(t,e){this.#s.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}deleteComment(t,e){const i=()=>{t.comment=e},a=()=>{this._editorUndoBar?.show(i,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:a,undo:i,mustExec:!0})}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#s.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),a=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",a),e())};this._eventBus.on("editorsrendered",a),await i}getSignature(t){this.#I?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#I}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=e)}onPagesEdited({pagesMapper:t}){for(const a of this.#n.values())a.updatePageIndex(t.getPrevPageNumber(a.pageIndex+1)-1);const e=this.#s,i=this.#s=new Map;for(const[a,l]of e){const c=t.getPrevPageNumber(a+1)-1;if(c===-1){l.destroy();continue}i.set(c,l),l.updatePageIndex(c)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const i of this.#s.values()){const{x:a,y:l,width:c,height:u}=i.div.getBoundingClientRect();if(t>=a&&t<=a+c&&e>=l&&e<=l+u)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*pl.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#s.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u}=i,d=i.toString(),p=this.#W(i).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;i.empty();const w=this.#tt(p),S=this.#T===oe.NONE,_=()=>{const A=w?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u,text:d});S&&this.showAllEditors("highlight",!0,!0),e&&A?.editComment()};if(S){this.switchToMode(oe.HIGHLIGHT,_);return}_()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#W(t).closest(".textLayer"),a=this.getSelectionBoxes(i);a&&(this.#_||=new WC(this),this.#_.show(i,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#a)return null;const e=`${Ic}${t}`,i=this.#a.getRawValue(e);return i&&this.#a.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#k&&(this.#_?.hide(),this.#k=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#k)return;const a=this.#W(t).closest(".textLayer");if(!a){this.#k&&(this.#_?.hide(),this.#k=null,this.#O({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#k=e,this.#O({hasSelectedText:!0}),!(this.#T!==oe.HIGHLIGHT&&this.#T!==oe.NONE)&&(this.#T===oe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#x=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===oe.HIGHLIGHT?this.#tt(a):null;if(l?.toggleDrawing(),this.#M){const c=new AbortController,u=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else l?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(t=""){this.#T===oe.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#S)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#N)return;this.#N=new AbortController;const t=this.combinedSignal(this.#N);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#N?.abort(),this.#N=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#S){const a=i.serialize(!0);a&&e.push(a)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const l of e.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(l){ne(`paste: "${l.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const a=this.currentLayer;try{const l=[];for(const d of i){const f=await a.deserialize(d);if(!f)return;l.push(f)}const c=()=>{for(const d of l)this.#nt(d);this.#it(l)},u=()=>{for(const d of l)d.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){ne(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==oe.NONE&&!this.isEditorHandlingKeyboard&&or._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([i,a])=>this.#X[i]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#T===oe.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#q([[we.HIGHLIGHT_FREE,!0]]))}#q(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#O({isEditing:this.#T!==oe.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#q(e.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#s.get(this.#f)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#s.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,a=!1,l=!1,c=!1){if(this.#T!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===oe.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===oe.NONE){this.setEditingState(!1),this.#pt();for(const u of this.#n.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const u of this.#n.values())u.addStandaloneCommentButton();t===oe.SIGNATURE&&await this.#I?.loadSignatures(),i&&Te.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#s.values())u.updateMode(t);if(t===oe.POPUP){this.#i||=await this.#K.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#n.values()){const{annotationElementId:p,hasComment:y,deleted:w}=f;p&&u.add(p),y&&!w&&d.push(f.getData())}for(const f of this.#i){const{id:p,popupRef:y,contentsObj:w}=f;y&&w?.str&&!u.has(p)&&!this.#g.has(p)&&d.push(f)}this.#l?.showSidebar(d)}if(!e){a&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const u of this.#n.values())u.uid===e?(this.setSelected(u),c?u.editComment():l?u.enterInEditMode():u.focus()):u.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case we.CREATE:this.currentLayer.addNewEditor(e);return;case we.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#$||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#S)i.updateParams(t,e);else for(const i of this.#u)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const l of this.#n.values())l.editorType===t&&l.show(e);(this.#$?.get(we.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#q([[we.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#j!==t){this.#j=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#P?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#q(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#S);return t}updateUI(t){this.#mt===t&&this.#q(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#q(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#S.has(t)){this.#S.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#S.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#S)e!==t&&e.unselect();this.#S.clear(),this.#S.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#S.has(t)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(t){t.unselect(),this.#S.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#S],i=()=>{this._editorUndoBar?.show(a,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},a=()=>{for(const l of e)this.#nt(l)};this.addCommands({cmd:i,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#S)e.unselect();this.#S.clear();for(const e of t)e.isEmpty()||(this.#S.add(e),e.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#S)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==oe.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#S)t.unselect();this.#S.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[a,l]=this.#H,c=[...this.#S],u=1e3;this.#B&&clearTimeout(this.#B),this.#B=setTimeout(()=>{this.#B=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(a,l),d.translationDone())},undo:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(-a,-l),d.translationDone())},mustExec:!1})},u);for(const d of c)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#S)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let e=!1;for(const[{x:a,y:l,pageIndex:c},u]of t)u.newX=a,u.newY=l,u.newPageIndex=c,e||=a!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!e)return!1;const i=(a,l,c,u)=>{if(this.#n.has(a.id)){const d=this.#s.get(u);d?a._setParentAndPosition(d,l,c):(a.pageIndex=u,a.x=l,a.y=c)}};return this.addCommands({cmd:()=>{for(const[a,{newX:l,newY:c,newPageIndex:u}]of t)i(a,l,c,u)},undo:()=>{for(const[a,{savedX:l,savedY:c,savedPageIndex:u}]of t)i(a,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#m)for(const i of this.#m.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==oe.NONE}get imageManager(){return ie(this,"imageManager",new Fm)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:a,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,w)=>({x:(p-a)/c,y:1-(f+y-i)/l,width:w/c,height:y/l});break;case"180":u=(f,p,y,w)=>({x:1-(f+y-i)/l,y:1-(p+w-a)/c,width:y/l,height:w/c});break;case"270":u=(f,p,y,w)=>({x:1-(p+w-a)/c,y:(f-i)/l,width:w/c,height:y/l});break;default:u=(f,p,y,w)=>({x:(f-i)/l,y:(p-a)/c,width:y/l,height:w/c});break}const d=[];for(let f=0,p=e.rangeCount;f<p;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x:w,y:S,width:_,height:A}of y.getClientRects())_===0||A===0||d.push(u(w,S,_,A))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#a.getRawValue(e);i&&(this.#T===oe.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const a=this.#P?.get(t);a&&(a.setCanvas(e,i),this.#P.delete(t))}addMissingCanvas(t,e){(this.#P||=new Map).set(t,e)}}class Ms{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Ms.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Ms._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Ms.#f.missing),e.setAttribute("data-l10n-id",Ms.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",$i,{signal:i}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#a=!0,a(l))},{signal:i}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Ms._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:a,cancel:l=!1}){i&&(this.#l=i,this.#d=a),!(this.#t===t&&this.#e===e)&&(l||(this.#t=t,this.#e=e),this.#m())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#s=null,this.#o?.remove(),this.#o=null}async#m(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Ms.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",Ms.#f[`${this.#g}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const a=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:l})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class wh{#t=null;#e=null;#i=!1;#n=null;#s=null;#r=null;#a=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const a=this.#n.commentButtonColor;a&&(i.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#n.parent.boundingClientRect;return[(t-a)/c,(e+i-l)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#n._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",$i,{signal:i}),e&&(t.addEventListener("focusin",l=>{this.#n._focusEventsAllowed=!1,nn(l)},{capture:!0,signal:i}),t.addEventListener("focusout",l=>{this.#n._focusEventsAllowed=!0,nn(l)},{capture:!0,signal:i})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#i=!0,a(l))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,a;if(e)[i,a]=e;else{[i,a]=this.#n.commentButtonPosition;const{width:p,height:y,x:w,y:S}=this.#n;i=w+i*p,a=S+a*y}const l=this.#n.parent.boundingClientRect,{x:c,y:u,width:d,height:f}=l;this.#n._uiManager.editComment(this.#n,c+i*d,u+a*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#a===""}isEmpty(){return this.#a===null}hasBeenEdited(){return this.isDeleted()||this.#a!==this.#s}serialize(){return this.data}get data(){return{text:this.#a,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#a&&(this.#r=null),t===null){this.#a="",this.#c=!0;return}this.#a=t,this.#o=new Date,this.#c=!1}restoreData({text:t,richText:e,date:i}){this.#a=t,this.#r=e,this.#o=i,this.#c=!1}setInitialText(t,e=null){this.#s=t,this.data=t,this.#o=null,this.#r=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#a="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class dd{#t;#e=!1;#i=null;#n;#s;#r;#a;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:a=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#i=i,this.#n=e,this.#s=a,this.#r=l,this.#a=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Os.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,l=AbortSignal.any([this.#c,a.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(nn(f),d(f))},u),c.addEventListener("pointerup",d,u),c.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:a,capture:!1,passive:!1};l.addEventListener("touchmove",this.#g.bind(this),c);const u=this.#m.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",nn,c),l.addEventListener("pointermove",nn,c),l.addEventListener("pointercancel",nn,c),l.addEventListener("pointerup",nn,c),this.#s?.()}if(nn(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;nn(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:a,screenY:l}=e,{screenX:c,screenY:u}=i,d=this.#l,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:w}=d,S=y-f,_=w-p,A=c-a,C=u-l,M=Math.hypot(A,C)||1,N=Math.hypot(S,_)||1;if(!this.#e&&Math.abs(N-M)<=dd.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=l,d.touch1X=c,d.touch1Y=u,!this.#e){this.#e=!0;return}const k=[(a+c)/2,(l+u)/2];this.#r?.(k,N,M)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#a?.()),this.#l&&(nn(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Wt{#t=null;#e=null;#i=null;#n=null;#s=null;#r=!1;#a=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#A=0;#w=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#x=!1;#_=Wt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Im;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Wt.prototype._resizeWithKeyboard,e=or.TRANSLATE_SMALL,i=or.TRANSLATE_BIG;return ie(this,"_resizerKeyboardManager",new tu([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Wt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,a],this.pageTranslation=[l,c];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ie(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new tT({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Wt._l10n??=t,Wt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Wt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Wt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Me("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(t){this.#x=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#B(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,a){const[l,c]=this.parentDimensions;[i,a]=this.screenToPageTranslation(i,a),this.x=(t+i)/l,this.y=(e+a)/c,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,a]=this.parentDimensions;this.setAt(t*i,e*a,this.width*i,this.height*a),this._onTranslated()}#D([t,e],i,a){[i,a]=this.screenToPageTranslation(i,a),this.x+=i/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#D(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[a,l]}=this;if(this.x+=t/a,this.y+=e/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:w}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,w)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[d,f]=this.getBaseTranslation();c+=d,u+=f;const{style:p}=i;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Wt,a=i/t,l=i/e;switch(this.rotation){case 90:return[-a,l];case 180:return[a,l];case 270:return[a,-l];default:return[-a,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,a]}=this;let{x:l,y:c,width:u,height:d}=this;if(u*=i,d*=a,l*=i,c*=a,this._mustFixPosition)switch(t){case 0:l=Un(l,0,i-u),c=Un(c,0,a-d);break;case 90:l=Un(l,0,i-d),c=Un(c,u,a);break;case 180:l=Un(l,u,i),c=Un(c,d,a);break;case 270:l=Un(l,d,i),c=Un(c,0,a-u);break}this.x=l/=i,this.y=c/=a;const[f,p]=this.getBaseTranslation();l+=f,c+=p,e.left=`${(100*l).toFixed(2)}%`,e.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Wt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Wt.#R(t,e,360-this.parentRotation)}#M(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",i),a.setAttribute("data-resizer-name",i),a.addEventListener("pointerdown",this.#N.bind(this,i),{signal:e}),a.addEventListener("contextmenu",$i,{signal:e}),a.tabIndex=-1}this.div.prepend(this.#c)}#N(t,e){e.preventDefault();const{isMac:i}=Sn.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#P.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",nn,{passive:!1,signal:c}),window.addEventListener("contextmenu",$i,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#F()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#L(t,e,i,a){this.width=i,this.height=a,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:a}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,d=this.height;l===t&&c===e&&u===i&&d===a||this.addCommands({cmd:this.#L.bind(this,l,c,u,d),undo:this.#L.bind(this,t,e,i,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#P(t,e){const[i,a]=this.parentDimensions,l=this.x,c=this.y,u=this.width,d=this.height,f=Wt.MIN_SIZE/i,p=Wt.MIN_SIZE/a,y=this.#M(this.rotation),w=(G,tt)=>[y[0]*G+y[2]*tt,y[1]*G+y[3]*tt],S=this.#M(360-this.rotation),_=(G,tt)=>[S[0]*G+S[2]*tt,S[1]*G+S[3]*tt];let A,C,M=!1,N=!1;switch(t){case"topLeft":M=!0,A=(G,tt)=>[0,0],C=(G,tt)=>[G,tt];break;case"topMiddle":A=(G,tt)=>[G/2,0],C=(G,tt)=>[G/2,tt];break;case"topRight":M=!0,A=(G,tt)=>[G,0],C=(G,tt)=>[0,tt];break;case"middleRight":N=!0,A=(G,tt)=>[G,tt/2],C=(G,tt)=>[0,tt/2];break;case"bottomRight":M=!0,A=(G,tt)=>[G,tt],C=(G,tt)=>[0,0];break;case"bottomMiddle":A=(G,tt)=>[G/2,tt],C=(G,tt)=>[G/2,0];break;case"bottomLeft":M=!0,A=(G,tt)=>[0,tt],C=(G,tt)=>[G,0];break;case"middleLeft":N=!0,A=(G,tt)=>[0,tt/2],C=(G,tt)=>[G,tt/2];break}const k=A(u,d),j=C(u,d);let F=w(...j);const z=Wt._round(l+F[0]),H=Wt._round(c+F[1]);let ct=1,dt=1,Tt,xt;if(e.fromKeyboard)({deltaX:Tt,deltaY:xt}=e);else{const{screenX:G,screenY:tt}=e,[vt,Xt]=this.#l;[Tt,xt]=this.screenToPageTranslation(G-vt,tt-Xt),this.#l[0]=G,this.#l[1]=tt}if([Tt,xt]=_(Tt/i,xt/a),M){const G=Math.hypot(u,d);ct=dt=Math.max(Math.min(Math.hypot(j[0]-k[0]-Tt,j[1]-k[1]-xt)/G,1/u,1/d),f/u,p/d)}else N?ct=Un(Math.abs(j[0]-k[0]-Tt),f,1)/u:dt=Un(Math.abs(j[1]-k[1]-xt),p,1)/d;const Nt=Wt._round(u*ct),At=Wt._round(d*dt);F=w(...C(Nt,At));const Rt=z-F[0],qt=H-F[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=Nt,this.height=At,this.x=Rt,this.y=qt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Bc(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Ms.initialize(Wt._l10n),this.#i=new Ms(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new wh(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#s){this._uiManager.isEditingMode()&&this.#s.classList.remove("hidden");return}this.hasComment&&(this.#s=this.#n.renderForStandalone(),this.div.append(this.#s))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#s=null}hideStandaloneCommentButton(){this.#s?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:t,text:e,date:i,deleted:a}}=this.#n;return{text:e,richText:t,date:i,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new wh(this),typeof t=="object"&&t!==null?this.#n.restoreData(t):this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#n||=new wh(this),this.#n.setInitialText(t,i),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new wh(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[a,l]=this.getInitialTranslation();return this.translate(a,l),kw(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new dd({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,i){let l=.7*(i/e)+1-.7;if(l===1)return;const c=this.#M(this.rotation),u=(z,H)=>[c[0]*z+c[2]*H,c[1]*z+c[3]*H],[d,f]=this.parentDimensions,p=this.x,y=this.y,w=this.width,S=this.height,_=Wt.MIN_SIZE/d,A=Wt.MIN_SIZE/f;l=Math.max(Math.min(l,1/w,1/S),_/w,A/S);const C=Wt._round(w*l),M=Wt._round(S*l);if(C===w&&M===S)return;this.#u||=[p,y,w,S];const N=u(w/2,S/2),k=Wt._round(p+N[0]),j=Wt._round(y+N[1]),F=u(C/2,M/2);this.x=k-F[0],this.y=j-F[1],this.width=C,this.height=M,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=Sn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#I(t);return}this.#k(t)}#k(t){const{isMac:e}=Sn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#I(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const a=new AbortController,l=this._uiManager.combinedSignal(a),c={capture:!0,passive:!1,signal:l},u=f=>{a.abort(),this.#a=null,this.#m=!1,this._uiManager.endDragSession()||this.#k(f),i&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#A=t.clientY,this.#a=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:w}=f;if(w!==this.#a){nn(f);return}const[S,_]=this.screenToPageTranslation(p-this.#E,y-this.#A);this.#E=p,this.#A=y,this._uiManager.dragSelectedEditors(S,_)},c),window.addEventListener("touchmove",nn,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),nn(f)},c));const d=f=>{if(!this.#a||this.#a===f.pointerId){u(f);return}nn(f)};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const a=this.parentScale,[l,c]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,p=e/a,y=this.x*l,w=this.y*c,S=this.width*l,_=this.height*c;switch(i){case 0:return[y+f+u,c-w-p-_+d,y+f+S+u,c-w-p+d];case 90:return[y+p+u,c-w+f+d,y+p+_+u,c-w+f+S+d];case 180:return[y-f-S+u,c-w+p+d,y-f+u,c-w+p+_+d];case 270:return[y-p-_+u,c-w-f-S+d,y-p+u,c-w-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,a,l,c]=t,u=l-i,d=c-a;switch(this.rotation){case 0:return[i,e-c,u,d];case 90:return[i,e-a,d,u];case 180:return[l,e-a,u,d];case 270:return[l,e-c,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Wt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:a,deleted:l,richText:c},uid:u,pageIndex:d,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:i||p,popupRef:!l,color:e,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:a}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return e<c&&a>0&&t<l&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[l,c]=a.pageDimensions,[u,d,f,p]=a.getRectInCurrentCoords(t.rect,c);return a.x=u/l,a.y=d/c,a.width=f/l,a.height=p/c,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#B(),this.removeEditToolbar(),this.#w){for(const t of this.#w.values())clearTimeout(t);this.#w=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,a,l,c]=this.getPDFRect();return[Wt._round(i+(l-i)*t),Wt._round(a+(c-a)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const c=this.#$.bind(this),u=this.#K.bind(this),d=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,p),{signal:d}),f.setAttribute("data-l10n-id",Wt._l10nResizer[p])}}const i=this.#e[0];let a=0;for(const c of e){if(c===i)break;a++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==a){if(l<a)for(let u=0;u<a-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>a)for(let u=0;u<l-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of e){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Wt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#$(t){Wt._resizerKeyboardManager.exec(this,t)}#K(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#B()}#X(t){this.#g=this.#v?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#P(this.#g,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#w||=new Map;const{action:i}=t;let a=this.#w.get(i);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#w.delete(i),this.#w.size===0&&(this.#w=null)},Wt._telemetryTimeout),this.#w.set(i,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class tT extends Wt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const iv=3285377520,Gi=4294901760,Es=65535;class Lw{constructor(t){this.h1=t?t&4294967295:iv,this.h2=t?t&4294967295:iv}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let A=0,C=t.length;A<C;A++){const M=t.charCodeAt(A);M<=255?e[i++]=M:(e[i++]=M>>>8,e[i++]=M&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=i>>2,l=i-a*4,c=new Uint32Array(e.buffer,0,a);let u=0,d=0,f=this.h1,p=this.h2;const y=3432918353,w=461845907,S=y&Es,_=w&Es;for(let A=0;A<a;A++)A&1?(u=c[A],u=u*y&Gi|u*S&Es,u=u<<15|u>>>17,u=u*w&Gi|u*_&Es,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=c[A],d=d*y&Gi|d*S&Es,d=d<<15|d>>>17,d=d*w&Gi|d*_&Es,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=e[a*4+2]<<16;case 2:u^=e[a*4+1]<<8;case 1:u^=e[a*4],u=u*y&Gi|u*S&Es,u=u<<15|u>>>17,u=u*w&Gi|u*_&Es,a&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Gi|t*36045&Es,e=e*4283543511&Gi|((e<<16|t>>>16)*2950163797&Gi)>>>16,t^=e>>>1,t=t*444984403&Gi|t*60499&Es,e=e*3301882366&Gi|((e<<16|t>>>16)*3120437893&Gi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const am=Object.freeze({map:null,hash:"",transfer:void 0});class Um{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof Wt&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#n.values())if(i instanceof Wt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let a=!1;if(i!==void 0)for(const[l,c]of Object.entries(e))i[l]!==c&&(a=!0,i[l]=c);else a=!0,this.#n.set(t,e);a&&this.#s(),e instanceof Wt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Pw(this)}get serializable(){if(this.#n.size===0)return am;const t=new Map,e=new Lw,i=[],a=Object.create(null);let l=!1;for(const[c,u]of this.#n){const d=u instanceof Wt?u.serialize(!1,a):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(t.set(c,d),e.update(`${c}:${JSON.stringify(d)}`),l||=!!d.bitmap)}if(l)for(const c of t.values())c.bitmap&&i.push(c.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:am}get editorStats(){let t=null;const e=new Map;let i=0,a=0;for(const l of this.#n.values()){if(!(l instanceof Wt)){l.popup&&(l.popup.deleted?a+=1:i+=1);continue}l.isCommentDeleted?a+=1:l.hasEditedComment&&(i+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;e.has(u)||e.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,p]of Object.entries(c)){if(f==="type")continue;let y=d.get(f);y||(y=new Map,d.set(f,y));const w=y.get(p)??0;y.set(p,w+1)}}if((a>0||i>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:i}),!t)return null;for(const[l,c]of e)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#i?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Pw extends Um{#t;constructor(t){super();const{map:e,hash:i,transfer:a}=t.serializable,l=structuredClone(e,a?{transfer:a}:null);this.#t={map:l,hash:i,transfer:a}}get print(){Me("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return ie(this,"modifiedIds",{ids:new Set,hash:""})}}class eT{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Re(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:l,style:c}=t,u=new FontFace(a,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),i?.(t)}catch{ne(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Me("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(a){throw ne(`Failed to load font '${i.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const a=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return ie(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return ie(this,"isSyncFontLoadingSupported",ei||Sn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Re(!a.done,"completeRequest() cannot be called twice."),a.done=!0;i.length>0&&i[0].done;){const l=i.shift();setTimeout(l.callback,0)}}const{loadingRequests:i}=this,a={done:!1,complete:e,callback:t};return i.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ie(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(j,F){return j.charCodeAt(F)<<24|j.charCodeAt(F+1)<<16|j.charCodeAt(F+2)<<8|j.charCodeAt(F+3)&255}function a(j,F,z,H){const ct=j.substring(0,F),dt=j.substring(F+z);return ct+H+dt}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function p(j,F){if(++f>30){ne("Load test font never loaded."),F();return}if(d.font="30px "+j,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(p.bind(null,j,F))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=a(w,976,y.length,y);const _=16,A=1482184792;let C=i(w,_);for(l=0,c=y.length-3;l<c;l+=4)C=C-A+i(y,l)|0;l<y.length&&(C=C-A+i(y+"XXX",l)|0),w=a(w,_,4,BC(C));const M=`url(data:font/opentype;base64,${btoa(w)});`,N=`@font-face {font-family:"${y}";src:${M}}`;this.insertRule(N);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const j of[t.loadedName,y]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=j,k.append(F)}this._document.body.append(k),p(y,()=>{k.remove(),e.complete()})}}class nT{#t;constructor(t,e=null,i,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let a;try{a=t.get(i)}catch(c){ne(`getPathGenerator - ignoring character: "${c}".`)}const l=Nw(a?.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){ie(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){ie(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class ol{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let a=0;for(const f of ol.strings){const p=e.encode(t[f]);i[f]=p,a+=4+p.length}const l=new ArrayBuffer(a),c=new Uint8Array(l),u=new DataView(l);let d=0;for(const f of ol.strings){const p=i[f],y=p.length;u.setUint32(d,y),c.set(p,d+4),d+=4+y}return Re(d===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Re(t<ol.strings.length,"Invalid string index");let e=0;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class ll{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let a=0;for(const w of ll.strings){const S=e.encode(t[w]);i[w]=S,a+=4+S.length}a+=4;let l,c,u=1+a;t.style&&(l=e.encode(t.style.style),c=e.encode(t.style.weight),u+=4+l.length+4+c.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,a=0;for(const w of ll.strings){const S=i[w],_=S.length;a+=4+_,p.setUint32(y,_),f.set(S,y+4),y+=4+_}return p.setUint32(y-a-4,a),t.style&&(p.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length,p.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Re(y<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Re(t<ll.strings.length,"Invalid string index");let e=5;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const a=this.#e.getUint32(t),l=this.#i.decode(new Uint8Array(this.#t,t+4,a));return{style:i,weight:l}}}class Fe{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#s=this.#n+1+6;#r;#a;#o;constructor({data:t,extra:e}){this.#r=t,this.#a=new TextDecoder,this.#o=new DataView(this.#r),e&&Object.assign(this,e)}#c(t){Re(t<Fe.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,a=this.#o.getUint8(e)>>i&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Re(t<Fe.numbers.length,"Invalid number index"),this.#o.getFloat64(Fe.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Fe.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<4;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Fe.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<6;a++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Fe.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<3;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Re(t<Fe.strings.length,"Invalid string index");let e=Fe.#s+4;for(let l=0;l<t;l++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),a=new Uint8Array(i);return a.set(new Uint8Array(this.#r,e+4,i)),this.#a.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);if(l!==0)return new Uint8Array(this.#r,t+4,l)}clearData(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,l).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);if(a===0)return null;const l=new Uint8Array(a);return l.set(new Uint8Array(this.#r,t+4,a)),new ol(l.buffer)}get systemFontInfo(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const a=new Uint8Array(i);return a.set(new Uint8Array(this.#r,t+4,i)),new ll(a.buffer)}static write(t){const e=t.systemFontInfo?ll.write(t.systemFontInfo):null,i=t.cssFontInfo?ol.write(t.cssFontInfo):null,a=new TextEncoder,l={};let c=0;for(const A of Fe.strings)l[A]=a.encode(t[A]),c+=4+l[A].length;const u=Fe.#s+4+c+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;const w=Fe.bools.length;let S=0,_=0;for(let A=0;A<w;A++){const C=t[Fe.bools[A]];S|=(C===void 0?0:C?2:1)<<_,_+=2,(_===8||A===w-1)&&(p.setUint8(y++,S),S=0,_=0)}Re(y===Fe.#t,"FontInfo.write: Boolean properties offset mismatch");for(const A of Fe.numbers)p.setFloat64(y,t[A]),y+=8;if(Re(y===Fe.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const A of t.bbox)p.setInt16(y,A,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Re(y===Fe.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const A of t.fontMatrix)p.setFloat64(y,A,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Re(y===Fe.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const A of t.defaultVMetrics)p.setInt16(y,A,!0),y+=2}else p.setUint8(y++,0),y+=6;Re(y===Fe.#s,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Fe.#s,0),y+=4;for(const A of Fe.strings){const C=l[A],M=C.length;p.setUint32(y,M),f.set(C,y+4),y+=4+M}if(p.setUint32(Fe.#s,y-Fe.#s-4),!e)p.setUint32(y,0),y+=4;else{const A=e.byteLength;p.setUint32(y,A),Re(y+4+A<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),y+4),y+=4+A}if(!i)p.setUint32(y,0),y+=4;else{const A=i.byteLength;p.setUint32(y,A),Re(y+4+A<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+A}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Re(y<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(y)}}class Mn{static#t=0;static#e=1;static#i=2;static#n=3;static#s=4;static#r=8;static#a=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,a=[],l=[],c=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],c=t[3],e===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,d=t[1],a=t[2],l=t[3],u=t[4]||[],i=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(a.length/2),y=Math.floor(l.length/3),w=c.length,S=u.length;let _=0;for(const F of u)_+=1,_=Math.ceil(_/4)*4,_+=4+F.coords.length*4,_+=4+F.colors.length*4,F.verticesPerRow!==void 0&&(_+=4);const A=20+p*8+y*3+w*8+(i?16:0)+(f?3:0)+_,C=new ArrayBuffer(A),M=new DataView(C),N=new Uint8Array(C);M.setUint8(Mn.#t,e),M.setUint8(Mn.#e,i?1:0),M.setUint8(Mn.#i,f?1:0),M.setUint8(Mn.#n,d),M.setUint32(Mn.#s,p,!0),M.setUint32(Mn.#r,y,!0),M.setUint32(Mn.#a,w,!0),M.setUint32(Mn.#o,S,!0);let k=20;new Float32Array(C,k,p*2).set(a),k+=p*8,N.set(l,k),k+=y*3;for(const[F,z]of c)M.setFloat32(k,F,!0),k+=4,M.setUint32(k,parseInt(z.slice(1),16),!0),k+=4;if(i)for(const F of i)M.setFloat32(k,F,!0),k+=4;f&&(N.set(f,k),k+=3);for(let F=0;F<u.length;F++){const z=u[F];M.setUint8(k,z.type),k+=1,k=Math.ceil(k/4)*4,M.setUint32(k,z.coords.length,!0),k+=4,new Int32Array(C,k,z.coords.length).set(z.coords),k+=z.coords.length*4,M.setUint32(k,z.colors.length,!0),k+=4,new Int32Array(C,k,z.colors.length).set(z.colors),k+=z.colors.length*4,z.verticesPerRow!==void 0&&(M.setUint32(k,z.verticesPerRow,!0),k+=4)}return C}getIR(){const t=this.view,e=this.data[Mn.#t],i=!!this.data[Mn.#e],a=!!this.data[Mn.#i],l=t.getUint32(Mn.#s,!0),c=t.getUint32(Mn.#r,!0),u=t.getUint32(Mn.#a,!0),d=t.getUint32(Mn.#o,!0);let f=20;const p=new Float32Array(this.buffer,f,l*2);f+=l*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const w=[];for(let C=0;C<u;++C){const M=t.getFloat32(f,!0);f+=4;const N=t.getUint32(f,!0);f+=4,w.push([M,`#${N.toString(16).padStart(6,"0")}`])}let S=null;if(i){S=[];for(let C=0;C<4;++C)S.push(t.getFloat32(f,!0)),f+=4}let _=null;a&&(_=new Uint8Array(this.buffer,f,3),f+=3);const A=[];for(let C=0;C<d;++C){const M=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const N=t.getUint32(f,!0);f+=4;const k=new Int32Array(this.buffer,f,N);f+=N*4;const j=t.getUint32(f,!0);f+=4;const F=new Int32Array(this.buffer,f,j);f+=j*4;const z={type:M,coords:k,colors:F};M===tm.LATTICE&&(z.verticesPerRow=t.getUint32(f,!0),f+=4),A.push(z)}if(e===1)return["RadialAxial","axial",S,w,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",S,w,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(e===3){const C=this.data[Mn.#n];let M=null;if(p.length>0){let N=p[0],k=p[0],j=p[1],F=p[1];for(let z=0;z<p.length;z+=2){const H=p[z],ct=p[z+1];N=N>H?H:N,j=j>ct?ct:j,k=k<H?H:k,F=F<ct?ct:F}M=[N,j,k,F]}return["Mesh",C,p,y,A,M,S,_]}throw new Error(`Unsupported pattern kind: ${e}`)}}class iT{static write(t){let e,i;return Sn.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}#t;constructor(t){this.#t=t}get path(){return Sn.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function sT(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(ei)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function aT(r){if(ei&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return ud(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function xh(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const rm=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,rT=r=>typeof r=="object"&&typeof r?.name=="string",oT=zC.bind(null,rm,rT);class lT{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,i)})}addEventListener(t,e,i=null){let a=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,e);a=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(e,a)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Sh={DATA:1,ERROR:2},yn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function sv(){}function di(r){if(r instanceof rr||r instanceof em||r instanceof Q0||r instanceof Xh||r instanceof Rp)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Me('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new rr(r.message);case"InvalidPDFException":return new em(r.message);case"PasswordException":return new Q0(r.message,r.code);case"ResponseException":return new Xh(r.message,r.status,r.missing);case"UnknownErrorException":return new Rp(r.message,r.details)}return new Rp(r.message,r.toString())}class kc{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,a=this.callbackCapabilities[i];if(!a)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Sh.DATA)a.resolve(t.data);else if(t.callback===Sh.ERROR)a.reject(di(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,a=t.sourceName,l=this.comObj;Promise.try(e,t.data).then(function(c){l.postMessage({sourceName:i,targetName:a,callback:Sh.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:i,targetName:a,callback:Sh.ERROR,callbackId:t.callbackId,reason:di(c)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const a=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[a]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},i)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,e,i,a){const l=this.streamId++,c=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:e,desiredSize:f.desiredSize},a),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,d.postMessage({sourceName:c,targetName:u,stream:yn.PULL,streamId:l,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Re(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,d.postMessage({sourceName:c,targetName:u,stream:yn.CANCEL,streamId:l,reason:di(f)}),p.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],d={enqueue(f,p=1,y){if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=p,w>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:a,stream:yn.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:yn.CLOSE,streamId:e}),delete c.streamSinks[e])},error(f){Re(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:yn.ERROR,streamId:e,reason:di(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:yn.START_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:yn.START_COMPLETE,streamId:e,reason:di(f)})})}#n(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case yn.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(di(t.reason));break;case yn.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(di(t.reason));break;case yn.PULL:if(!u){l.postMessage({sourceName:i,targetName:a,stream:yn.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||sv).then(function(){l.postMessage({sourceName:i,targetName:a,stream:yn.PULL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:yn.PULL_COMPLETE,streamId:e,reason:di(f)})});break;case yn.ENQUEUE:if(Re(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case yn.CLOSE:if(Re(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#s(c,e);break;case yn.ERROR:Re(c,"error should have stream controller"),c.controller.error(di(t.reason)),this.#s(c,e);break;case yn.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(di(t.reason)),this.#s(c,e);break;case yn.CANCEL:if(!u)break;const d=di(t.reason);Promise.try(u.onCancel||sv,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:yn.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:yn.CANCEL_COMPLETE,streamId:e,reason:di(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Bw{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Me("Abstract method `_createCanvas` called.")}}class cT extends Bw{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class jw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class av extends jw{async _fetch(t){const e=await Wc(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):ud(e)}}class Fw{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,a,l){return"none"}destroy(t=!1){}}class uT extends Fw{#t;#e;#i;#n;#s;#r;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#s=e}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(la,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#s.createElementNS(la,"defs"),t.append(i),i.append(this.#i),this.#s.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=d[y]/255;const p=f.join(",");return[p,p,p]}const[e,i,a]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let d=0;d<256;d++)l[d]=e[d]/255,c[d]=i[d]/255,u[d]=a[d]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(hd(e)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Rw(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,a,l]=this.#d(t),c=t.length===1?i:`${i}${a}${l}`;if(e=this.#o.get(c),e)return this.#o.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#a++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(c,d);const f=this.#m(u);return this.#p(i,a,l,f),d}addHCMFilter(t,e){const i=`${t}-${e}`,a="base";let l=this.#c.get(a);if(l?.key===i||(l?(l.filter?.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},this.#c.set(a,l)),!t||!e))return l.url;const c=this.#v(t);t=Ht.makeHexColor(...c);const u=this.#v(e);if(e=Ht.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return l.url;const d=new Array(256);for(let S=0;S<=255;S++){const _=S/255;d[S]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const f=d.join(","),p=`g_${this.#n}_hcm_filter`,y=l.filter=this.#m(p);this.#p(f,f,f,y),this.#g(y);const w=(S,_)=>{const A=c[S]/255,C=u[S]/255,M=new Array(_+1);for(let N=0;N<=_;N++)M[N]=A+N/_*(C-A);return M.join(",")};return this.#p(w(0,5),w(1,5),w(2,5),y),l.url=this.#h(p),l.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),a=`alpha_${i}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_alpha_map_${this.#a++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#y(i,u),c}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,a;if(t?([i]=this.#d([t]),a=`luminosity_${i}`):a="luminosity",e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_luminosity_map_${this.#a++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#f(u),t&&this.#y(i,u),c}addHighlightHCMFilter(t,e,i,a,l){const c=`${e}-${i}-${a}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!e||!i))return u.url;const[d,f]=[e,i].map(this.#v.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[w,S]=[a,l].map(this.#v.bind(this));y<p&&([p,y,w,S]=[y,p,S,w]),this.#l.style.color="";const _=(M,N,k)=>{const j=new Array(256),F=(y-p)/k,z=M/255,H=(N-M)/(255*k);let ct=0;for(let dt=0;dt<=k;dt++){const Tt=Math.round(p+dt*F),xt=z+dt*H;for(let Nt=ct;Nt<=Tt;Nt++)j[Nt]=xt;ct=Tt+1}for(let dt=ct;dt<256;dt++)j[dt]=j[ct-1];return j.join(",")},A=`g_${this.#n}_hcm_${t}_filter`,C=u.filter=this.#m(A);return this.#g(C),this.#p(_(w[0],S[0],5),_(w[1],S[1],5),_(w[2],S[2],5),C),u.url=this.#h(A),u.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#a=0)}#f(t){const e=this.#s.createElementNS(la,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#s.createElementNS(la,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#m(t){const e=this.#s.createElementNS(la,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,i){const a=this.#s.createElementNS(la,e);a.setAttribute("type","discrete"),a.setAttribute("tableValues",i),t.append(a)}#p(t,e,i,a){const l=this.#s.createElementNS(la,"feComponentTransfer");a.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",e),this.#u(l,"feFuncB",i)}#y(t,e){const i=this.#s.createElementNS(la,"feComponentTransfer");e.append(i),this.#u(i,"feFuncA",t)}#v(t){return this.#l.style.color=t,Jc(getComputedStyle(this.#l).getPropertyValue("color"))}}class Iw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class rv extends Iw{async _fetch(t){const e=await Wc(t,"arraybuffer");return new Uint8Array(e)}}class Uw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class ov extends Uw{async _fetch(t){const e=await Wc(t,"arraybuffer");return new Uint8Array(e)}}ei&&ne("Please use the `legacy` build in Node.js environments.");async function zm(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class hT extends Fw{}class dT extends Bw{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class fT extends jw{async _fetch(t){return zm(t)}}class pT extends Iw{async _fetch(t){return zm(t)}}class mT extends Uw{async _fetch(t){return zm(t)}}const tl="__forcedDependency",{floor:lv,ceil:cv}=Math;function Ah(r,t,e,i,a,l){r[t*4+0]=Math.min(r[t*4+0],e),r[t*4+1]=Math.min(r[t*4+1],i),r[t*4+2]=Math.max(r[t*4+2],a),r[t*4+3]=Math.max(r[t*4+3],l)}const om=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class gT{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===om}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Eh=(r,t)=>{if(!r)return;let e=r.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},r.set(t,e)),e};class yT{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[tl]:[]};#i=new Map;#n=[];#s=[];#r=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,e,i=!1){this.#f=t.width,this.#g=t.height,this.#y(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const i=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(i),this.#u=new Uint32Array(i),e&&e.length>0?(this.#u.set(e),this.#u.fill(om,e.length)):this.#u.fill(om)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[tl]:{__proto__:this.#e[tl]}},this.#a={__proto__:this.#a},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const i=this.#n.pop();return i!==void 0&&(Eh(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(Eh(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#s.push(t),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(Eh(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#r.push(Ht.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#i.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(tl,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(tl,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,a,l,c){const u=Ht.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];Ht.axialAlignedBoundingBox([i,l,a,c],u,d);const f=Ht.intersect(this.#a,d);return f?(this.#a[0]=f[0],this.#a[1]=f[1],this.#a[2]=f[2],this.#a[3]=f[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,i,a,l,c){const u=this.#a;if(u[0]===1/0)return this;const d=Ht.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(u[0]===-1/0)return Ht.axialAlignedBoundingBox([i,l,a,c],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return Ht.axialAlignedBoundingBox([i,l,a,c],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,i,a=1,l=0,c=0,u){const d=i.bbox;let f,p;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(i),f!==!1&&(p=[0,0,0,0],Ht.axialAlignedBoundingBox(d,i.fontMatrix,p),(a!==1||l!==0||c!==0)&&Ht.scaleMinMax([a,0,0,-a,l,c],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return d&&p&&f===void 0&&(f=p[0]<=l-y.actualBoundingBoxLeft&&p[2]>=l+y.actualBoundingBoxRight&&p[1]<=c-y.actualBoundingBoxAscent&&p[3]>=c+y.actualBoundingBoxDescent,this.#h.set(i,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,l-y.actualBoundingBoxLeft,l+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#f,this.#a[2]),this.#o[3]=Math.min(this.#g,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,a=this.#t,l=this.#e;for(const c of e)c in this.#t?i.add(a[c]):c in l&&l[c].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[tl]),this.#p){const i=Eh(this.#p,t),{dependencies:a}=i;this.#l.forEach(a.add,a),this.#n.forEach(a.add,a),this.#s.forEach(a.add,a),a.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=lv(this.#o[0]*256/this.#f),a=lv(this.#o[1]*256/this.#g),l=cv(this.#o[2]*256/this.#f),c=cv(this.#o[3]*256/this.#g);Ah(this.#m,t,i,a,l,c);for(const u of this.#l)u!==t&&Ah(this.#m,u,i,a,l,c);for(const u of this.#n)u!==t&&Ah(this.#m,u,i,a,l,c);for(const u of this.#s)u!==t&&Ah(this.#m,u,i,a,l,c);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const a of i)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new gT(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class Yh{#t;#e;#i;#n=0;#s=0;constructor(t,e,i){if(t instanceof Yh&&t.#i===!!i)return t;this.#t=t,this.#e=e,this.#i=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,a,l,c){return this.#i||this.#t.recordClipBox(this.#e,e,i,a,l,c),this}recordBBox(t,e,i,a,l,c){return this.#i||this.#t.recordBBox(this.#e,e,i,a,l,c),this}recordCharacterBBox(t,e,i,a,l,c,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,i,a,l,c,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Vi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},zn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function lm(r,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,i),r.clip(a)}class Hm{isModifyingCurrentTransform(){return!1}getPattern(){Me("Abstract method `getPattern` called.")}}class bT extends Hm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,a=this._p0,l=this._p1;if(e&&(a=a.slice(),l=l.slice(),Ht.applyTransform(a,e),Ht.applyTransform(l,e)),this._type==="axial")i=t.createLinearGradient(a[0],a[1],l[0],l[1]);else if(this._type==="radial"){let c=this._r0,u=this._r1;if(e){const d=new Float32Array(2);Ht.singularValueDecompose2dScale(e,d),c*=d[0],u*=d[0]}i=t.createRadialGradient(a[0],a[1],c,l[0],l[1],u)}for(const c of this._colorStops)i.addColorStop(c[0],c[1]);return i}getPattern(t,e,i,a){let l;if(a===zn.STROKE||a===zn.FILL){if(this.isOriginBased()){let w=Ht.transform(i,e.baseTransform);this.matrix&&(w=Ht.transform(w,this.matrix));const S=.001,_=Math.hypot(w[0],w[1]),A=Math.hypot(w[2],w[3]),C=(w[0]*w[2]+w[1]*w[3])/(_*A);if(Math.abs(C)<S)if(this.isRadial()){if(Math.abs(_-A)<S)return this._createGradient(t,w)}else return this._createGradient(t,w)}const c=e.current.getClippedPathBoundingBox(a,Ze(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),i=Ht.transform(i,[1,0,0,1,c[0],c[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),lm(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(i);l.setTransform(y)}else lm(t,this._bbox),l=this._createGradient(t);return l}}function Op(r,t,e,i,a,l,c,u){const d=t.coords,f=t.colors,p=r.data,y=r.width*4;let w;d[e+1]>d[i+1]&&(w=e,e=i,i=w,w=l,l=c,c=w),d[i+1]>d[a+1]&&(w=i,i=a,a=w,w=c,c=u,u=w),d[e+1]>d[i+1]&&(w=e,e=i,i=w,w=l,l=c,c=w);const S=(d[e]+t.offsetX)*t.scaleX,_=(d[e+1]+t.offsetY)*t.scaleY,A=(d[i]+t.offsetX)*t.scaleX,C=(d[i+1]+t.offsetY)*t.scaleY,M=(d[a]+t.offsetX)*t.scaleX,N=(d[a+1]+t.offsetY)*t.scaleY;if(_>=N)return;const k=f[l],j=f[l+1],F=f[l+2],z=f[c],H=f[c+1],ct=f[c+2],dt=f[u],Tt=f[u+1],xt=f[u+2],Nt=Math.round(_),At=Math.round(N);let Rt,qt,G,tt,vt,Xt,Ct,U;for(let J=Nt;J<=At;J++){if(J<C){const It=J<_?0:(_-J)/(_-C);Rt=S-(S-A)*It,qt=k-(k-z)*It,G=j-(j-H)*It,tt=F-(F-ct)*It}else{let It;J>N?It=1:C===N?It=0:It=(C-J)/(C-N),Rt=A-(A-M)*It,qt=z-(z-dt)*It,G=H-(H-Tt)*It,tt=ct-(ct-xt)*It}let ft;J<_?ft=0:J>N?ft=1:ft=(_-J)/(_-N),vt=S-(S-M)*ft,Xt=k-(k-dt)*ft,Ct=j-(j-Tt)*ft,U=F-(F-xt)*ft;const wt=Math.round(Math.min(Rt,vt)),Bt=Math.round(Math.max(Rt,vt));let Ft=y*J+wt*4;for(let It=wt;It<=Bt;It++)ft=(Rt-It)/(Rt-vt),ft<0?ft=0:ft>1&&(ft=1),p[Ft++]=qt-(qt-Xt)*ft|0,p[Ft++]=G-(G-Ct)*ft|0,p[Ft++]=tt-(tt-U)*ft|0,p[Ft++]=255}}function vT(r,t,e){const i=t.coords,a=t.colors;let l,c;switch(t.type){case tm.LATTICE:const u=t.verticesPerRow,d=Math.floor(i.length/u)-1,f=u-1;for(l=0;l<d;l++){let p=l*u;for(let y=0;y<f;y++,p++)Op(r,e,i[p],i[p+1],i[p+u],a[p],a[p+1],a[p+u]),Op(r,e,i[p+u+1],i[p+1],i[p+u],a[p+u+1],a[p+1],a[p+u])}break;case tm.TRIANGLES:for(l=0,c=i.length;l<c;l+=3)Op(r,e,i[l],i[l+1],i[l+2],a[l],a[l+1],a[l+2]);break;default:throw new Error("illegal figure")}}class wT extends Hm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),w=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),S=f/y,_=p/w,A={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/S,scaleY:1/_},C=y+4,M=w+4,N=i.getCanvas("mesh",C,M),k=N.context,j=k.createImageData(y,w);if(e){const z=j.data;for(let H=0,ct=z.length;H<ct;H+=4)z[H]=e[0],z[H+1]=e[1],z[H+2]=e[2],z[H+3]=255}for(const z of this._figures)vT(j,z,A);return k.putImageData(j,2,2),{canvas:N.canvas,offsetX:u-2*S,offsetY:d-2*_,scaleX:S,scaleY:_}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,a){lm(t,this._bbox);const l=new Float32Array(2);if(a===zn.SHADING)Ht.singularValueDecompose2dScale(Ze(t),l);else if(this.matrix){Ht.singularValueDecompose2dScale(this.matrix,l);const[u,d]=l;Ht.singularValueDecompose2dScale(e.baseTransform,l),l[0]*=u,l[1]*=d}else Ht.singularValueDecompose2dScale(e.baseTransform,l);const c=this._createMeshCanvas(l,a===zn.SHADING?null:this._background,e.cachedCanvases);return a!==zn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class xT extends Hm{getPattern(){return"hotpink"}}function ST(r){switch(r[0]){case"RadialAxial":return new bT(r);case"Mesh":return new wT(r);case"Dummy":return new xT}throw new Error(`Unknown IR type: ${r[0]}`)}const uv={COLORED:1,UNCOLORED:2};class qm{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=a}createPatternCanvas(t,e){const{bbox:i,operatorList:a,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),cd("TilingType: "+c);const y=i[0],w=i[1],S=i[2],_=i[3],A=S-y,C=_-w,M=new Float32Array(2);Ht.singularValueDecompose2dScale(this.matrix,M);const[N,k]=M;Ht.singularValueDecompose2dScale(this.baseTransform,M);const j=N*M[0],F=k*M[1];let z=A,H=C,ct=!1,dt=!1;const Tt=Math.ceil(f*j),xt=Math.ceil(p*F),Nt=Math.ceil(A*j),At=Math.ceil(C*F);Tt>=Nt?z=f:ct=!0,xt>=At?H=p:dt=!0;const Rt=this.getSizeAndScale(z,this.ctx.canvas.width,j),qt=this.getSizeAndScale(H,this.ctx.canvas.height,F),G=t.cachedCanvases.getCanvas("pattern",Rt.size,qt.size),tt=G.context,vt=d.createCanvasGraphics(tt,e);if(vt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(vt,l,u),tt.translate(-Rt.scale*y,-qt.scale*w),vt.transform(0,Rt.scale,0,0,qt.scale,0,0),tt.save(),vt.dependencyTracker?.save(),this.clipBbox(vt,y,w,S,_),vt.baseTransform=Ze(vt.ctx),vt.executeOperatorList(a),vt.endDrawing(),vt.dependencyTracker?.restore(),tt.restore(),ct||dt){const Xt=G.canvas;ct&&(z=f),dt&&(H=p);const Ct=this.getSizeAndScale(z,this.ctx.canvas.width,j),U=this.getSizeAndScale(H,this.ctx.canvas.height,F),J=Ct.size,ft=U.size,wt=t.cachedCanvases.getCanvas("pattern-workaround",J,ft),Bt=wt.context,Ft=ct?Math.floor(A/f):0,It=dt?Math.floor(C/p):0;for(let re=0;re<=Ft;re++)for(let Kt=0;Kt<=It;Kt++)Bt.drawImage(Xt,J*re,ft*Kt,J,ft,0,0,J,ft);return{canvas:wt.canvas,scaleX:Ct.scale,scaleY:U.scale,offsetX:y,offsetY:w}}return{canvas:G.canvas,scaleX:Rt.scale,scaleY:qt.scale,offsetX:y,offsetY:w}}getSizeAndScale(t,e,i){const a=Math.max(qm.MAX_PATTERN_SIZE,e);let l=Math.ceil(t*i);return l>=a?l=a:i=l/t,{scale:i,size:l}}clipBbox(t,e,i,a,l){const c=a-e,u=l-i;t.ctx.rect(e,i,c,u),Ht.axialAlignedBoundingBox([e,i,a,l],Ze(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const a=t.ctx,l=t.current;switch(e){case uv.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;a.fillStyle=l.fillColor=c,a.strokeStyle=l.strokeColor=u;break;case uv.UNCOLORED:a.fillStyle=a.strokeStyle=i,l.fillColor=l.strokeColor=i;break;default:throw new LC(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,a,l){let c=i;a!==zn.SHADING&&(c=Ht.transform(c,e.baseTransform),this.matrix&&(c=Ht.transform(c,this.matrix)));const u=this.createPatternCanvas(e,l);let d=new DOMMatrix(c);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function AT({src:r,srcPos:t=0,dest:e,width:i,height:a,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=Sn.isLittleEndian?4278190080:255,[d,f]=c?[l,u]:[u,l],p=i>>3,y=i&7,w=r.length;e=new Uint32Array(e.buffer);let S=0;for(let _=0;_<a;_++){for(const C=t+p;t<C;t++){const M=t<w?r[t]:255;e[S++]=M&128?f:d,e[S++]=M&64?f:d,e[S++]=M&32?f:d,e[S++]=M&16?f:d,e[S++]=M&8?f:d,e[S++]=M&4?f:d,e[S++]=M&2?f:d,e[S++]=M&1?f:d}if(y===0)continue;const A=t<w?r[t++]:255;for(let C=0;C<y;C++)e[S++]=A&1<<7-C?f:d}return{srcPos:t,destPos:S}}const hv=16,dv=100,ET=15,fv=10,fi=16,Np=new DOMMatrix,Ri=new Float32Array(2),al=new Float32Array([1/0,1/0,-1/0,-1/0]);function _T(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},r.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},r.transform=function(e,i,a,l,c,u){t.transform(e,i,a,l,c,u),this.__originalTransform(e,i,a,l,c,u)},r.setTransform=function(e,i,a,l,c,u){t.setTransform(e,i,a,l,c,u),this.__originalSetTransform(e,i,a,l,c,u)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},r.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},r.bezierCurveTo=function(e,i,a,l,c,u){t.bezierCurveTo(e,i,a,l,c,u),this.__originalBezierCurveTo(e,i,a,l,c,u)},r.rect=function(e,i,a,l){t.rect(e,i,a,l),this.__originalRect(e,i,a,l)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class CT{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,i)):(a=this.canvasFactory.create(e,i),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function _h(r,t,e,i,a,l,c,u,d,f){const[p,y,w,S,_,A]=Ze(r);if(y===0&&w===0){const N=c*p+_,k=Math.round(N),j=u*S+A,F=Math.round(j),z=(c+d)*p+_,H=Math.abs(Math.round(z)-k)||1,ct=(u+f)*S+A,dt=Math.abs(Math.round(ct)-F)||1;return r.setTransform(Math.sign(p),0,0,Math.sign(S),k,F),r.drawImage(t,e,i,a,l,0,0,H,dt),r.setTransform(p,y,w,S,_,A),[H,dt]}if(p===0&&S===0){const N=u*w+_,k=Math.round(N),j=c*y+A,F=Math.round(j),z=(u+f)*w+_,H=Math.abs(Math.round(z)-k)||1,ct=(c+d)*y+A,dt=Math.abs(Math.round(ct)-F)||1;return r.setTransform(0,Math.sign(y),Math.sign(w),0,k,F),r.drawImage(t,e,i,a,l,0,0,dt,H),r.setTransform(p,y,w,S,_,A),[dt,H]}r.drawImage(t,e,i,a,l,c,u,d,f);const C=Math.hypot(p,y),M=Math.hypot(w,S);return[C*d,M*f]}class pv{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Jp;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=wn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=al.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=zn.FILL,e=null){const i=this.minMax.slice();if(t===zn.STROKE){e||Me("Stroke bounding box must include transform."),Ht.singularValueDecompose2dScale(e,Ri);const a=Ri[0]*this.lineWidth/2,l=Ri[1]*this.lineWidth/2;i[0]-=a,i[1]-=l,i[2]+=a,i[3]+=l}return i}updateClipFromPath(){const t=Ht.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(al,0)}getClippedPathBoundingBox(t=zn.FILL,e=null){return Ht.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function mv(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,i=t.width,a=e%fi,l=(e-a)/fi,c=a===0?l:l+1,u=r.createImageData(i,fi);let d=0,f;const p=t.data,y=u.data;let w,S,_,A;if(t.kind===Fh.GRAYSCALE_1BPP){const C=p.byteLength,M=new Uint32Array(y.buffer,0,y.byteLength>>2),N=M.length,k=i+7>>3,j=4294967295,F=Sn.isLittleEndian?4278190080:255;for(w=0;w<c;w++){for(_=w<l?fi:a,f=0,S=0;S<_;S++){const z=C-d;let H=0;const ct=z>k?i:z*8-7,dt=ct&-8;let Tt=0,xt=0;for(;H<dt;H+=8)xt=p[d++],M[f++]=xt&128?j:F,M[f++]=xt&64?j:F,M[f++]=xt&32?j:F,M[f++]=xt&16?j:F,M[f++]=xt&8?j:F,M[f++]=xt&4?j:F,M[f++]=xt&2?j:F,M[f++]=xt&1?j:F;for(;H<ct;H++)Tt===0&&(xt=p[d++],Tt=128),M[f++]=xt&Tt?j:F,Tt>>=1}for(;f<N;)M[f++]=0;r.putImageData(u,0,w*fi)}}else if(t.kind===Fh.RGBA_32BPP){for(S=0,A=i*fi*4,w=0;w<l;w++)y.set(p.subarray(d,d+A)),d+=A,r.putImageData(u,0,S),S+=fi;w<c&&(A=i*a*4,y.set(p.subarray(d,d+A)),r.putImageData(u,0,S))}else if(t.kind===Fh.RGB_24BPP)for(_=fi,A=i*_,w=0;w<c;w++){for(w>=l&&(_=a,A=i*_),f=0,S=A;S--;)y[f++]=p[d++],y[f++]=p[d++],y[f++]=p[d++],y[f++]=255;r.putImageData(u,0,w*fi)}else throw new Error(`bad image kind: ${t.kind}`)}function gv(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,a=e%fi,l=(e-a)/fi,c=a===0?l:l+1,u=r.createImageData(i,fi);let d=0;const f=t.data,p=u.data;for(let y=0;y<c;y++){const w=y<l?fi:a;({srcPos:d}=AT({src:f,srcPos:d,dest:p,width:i,height:w,nonBlackColor:0})),r.putImageData(u,0,y*fi)}}function Cc(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)r[i]!==void 0&&(t[i]=r[i]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function Ch(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function yv(r,t){if(t)return!0;Ht.singularValueDecompose2dScale(r,Ri);const e=Math.fround(Os.pixelRatio*pl.PDF_TO_CSS_UNITS);return Ri[0]<=e&&Ri[1]<=e}const TT=["butt","round","square"],RT=["miter","round","bevel"],MT={},bv={};class cl{constructor(t,e,i,a,l,{optionalContentConfig:c,markedContentStack:u=null},d,f,p){this.ctx=t,this.current=new pv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=a,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new CT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:a=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,i){const d=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...Ze(this.compositeCtx))}this.ctx.save(),Ch(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Ze(this.ctx)}executeOperatorList(t,e,i,a,l){const c=t.argsArray,u=t.fnArray;let d=e||0;const f=c.length;if(f===d)return d;const p=f-d>fv&&typeof i=="function",y=p?Date.now()+ET:0;let w=0;const S=this.commonObjs,_=this.objs;let A,C;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,i),d;if(!l||l(d))if(A=u[d],C=c[d]??null,A!==Uc.dependency)C===null?this[A](d):this[A](d,...C);else for(const M of C){this.dependencyTracker?.recordNamedData(M,d);const N=M.startsWith("g_")?S:_;if(!N.has(M))return N.get(M,i),d}if(d++,d===f)return d;if(p&&++w>fv){if(Date.now()>y)return i(),d;w=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,a=t.height??t.displayHeight;let l=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),u=i,d=a,f="prescale1",p,y;for(;l>2&&u>1||c>2&&d>1;){let w=u,S=d;l>2&&u>1&&(w=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/w),c>2&&d>1&&(S=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/S),p=this.cachedCanvases.getCanvas(f,w,S),y=p.context,y.clearRect(0,0,w,S),y.drawImage(t,0,0,u,d,0,0,w,S),t=p.canvas,u=w,d=S,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const i=this.ctx,{width:a,height:l}=e,c=this.current.fillColor,u=this.current.patternFill,d=Ze(i);let f,p,y,w;if((e.bitmap||e.data)&&e.count>1){const Tt=e.bitmap||e.data.buffer;p=JSON.stringify(u?d:[d.slice(0,4),c]),f=this._cachedBitmapsMap.get(Tt),f||(f=new Map,this._cachedBitmapsMap.set(Tt,f));const xt=f.get(p);if(xt&&!u){const Nt=Math.round(Math.min(d[0],d[2])+d[4]),At=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Vi.transformAndFill),{canvas:xt,offsetX:Nt,offsetY:At}}y=xt}y||(w=this.cachedCanvases.getCanvas("maskCanvas",a,l),gv(w.context,e));let S=Ht.transform(d,[1/a,0,0,-1/l,0,0]);S=Ht.transform(S,[1,0,0,1,0,-l]);const _=al.slice();Ht.axialAlignedBoundingBox([0,0,a,l],S,_);const[A,C,M,N]=_,k=Math.round(M-A)||1,j=Math.round(N-C)||1,F=this.cachedCanvases.getCanvas("fillCanvas",k,j),z=F.context,H=A,ct=C;z.translate(-H,-ct),z.transform(...S),y||(y=this._scaleImage(w.canvas,As(z)),y=y.img,f&&u&&f.set(p,y)),z.imageSmoothingEnabled=yv(Ze(z),e.interpolate),_h(z,y,0,0,y.width,y.height,0,0,a,l),z.globalCompositeOperation="source-in";const dt=Ht.transform(As(z),[1,0,0,1,-H,-ct]);return z.fillStyle=u?c.getPattern(i,this,dt,zn.FILL,t):c,z.fillRect(0,0,a,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,F.canvas)),this.dependencyTracker?.recordDependencies(t,Vi.transformAndFill),{canvas:F.canvas,offsetX:Math.round(H),offsetY:Math.round(ct)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=TT[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=RT[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(e),a.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,a]of e)switch(i){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(a,e,i);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),Cc(this.suspendedCtx,c),_T(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Cc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,a){const l=a[0],c=a[1],u=a[2]-l,d=a[3]-c;u===0||d===0||(this.genericComposeSMask(e.context,i,u,d,e.subtype,e.backdrop,e.transferMap,l,c,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,a,l,c,u,d,f,p,y){let w=t.canvas,S=d-p,_=f-y;if(c)if(S<0||_<0||S+i>w.width||_+a>w.height){const C=this.cachedCanvases.getCanvas("maskExtension",i,a),M=C.context;M.drawImage(w,-S,-_),M.globalCompositeOperation="destination-atop",M.fillStyle=c,M.fillRect(0,0,i,a),M.globalCompositeOperation="source-over",w=C.canvas,S=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(S,_,i,a),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(S,_,i,a),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const A=new Path2D;A.rect(d,f,i,a),e.clip(A),e.globalCompositeOperation="destination-in",e.drawImage(w,S,_,i,a,d,f,i,a),e.restore()}save(t){this.inSMaskMode&&Cc(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Cc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,a,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,a,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,a){let[l]=i;if(!a){l||=i[0]=new Path2D,this[e](t,l);return}if(this.dependencyTracker!==null){const c=e===Uc.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-c,a[2]+c,a[1]-c,a[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=i[0]=Nw(l)),Ht.axialAlignedBoundingBox(a,Ze(this.ctx),this.current.minMax),this[e](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const a=this.ctx,l=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=l.getPattern(a,this,As(a),zn.STROKE,t),c){const u=new Path2D;u.addPath(e,a.getTransform().invertSelf().multiplySelf(c)),e=u}this.rescaleAndStroke(e,!1),a.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Vi.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(zn.STROKE,Ze(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const a=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=l.getPattern(a,this,As(a),zn.FILL,t),f){const p=new Path2D;p.addPath(e,a.getTransform().invertSelf().multiplySelf(f)),e=p}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(e,"evenodd"),this.pendingEOFill=!1):a.fill(e)),this.dependencyTracker?.recordDependencies(t,Vi.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Vi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=MT}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=bv}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;e!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(e!==void 0){const a=new Path2D,l=i.getTransform().invertSelf();for(const{transform:c,x:u,y:d,fontSize:f,path:p}of e)p&&a.addPath(p,new DOMMatrix(c).preMultiplySelf(l).translate(u,d).scale(f,-f));i.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const a=this.commonObjs.get(e),l=this.current;if(!a)throw new Error(`Can't find font for ${e}`);if(l.fontMatrix=a.fontMatrix||Jp,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),i<0?(i=-i,l.fontDirection=-1):l.fontDirection=1,this.current.font=a,this.current.fontSize=i,a.isType3Font)return;const c=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${c}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let p=i;i<hv?p=hv:i>dv&&(p=dv),this.current.fontSizeScale=i/p,this.ctx.font=`${f} ${d} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const a=new Path2D;return a.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),a}paintChar(t,e,i,a,l,c){const u=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,y=d.fontSize/d.fontSizeScale,w=p&wn.FILL_STROKE_MASK,S=!!(p&wn.ADD_TO_PATH_FLAG),_=d.patternFill&&!f.missingFile,A=d.patternStroke&&!f.missingFile;let C;if((f.disableFontFace||S||_||A)&&!f.missingFile&&(C=f.getPathGenerator(this.commonObjs,e)),C&&(f.disableFontFace||_||A)){u.save(),u.translate(i,a),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let M;if(w===wn.FILL||w===wn.FILL_STROKE)if(l){M=u.getTransform(),u.setTransform(...l);const N=this.#i(C,M,l);u.fill(N)}else u.fill(C);if(w===wn.STROKE||w===wn.FILL_STROKE)if(c){M||=u.getTransform(),u.setTransform(...c);const{a:N,b:k,c:j,d:F}=M,z=Ht.inverseTransform(c),H=Ht.transform([N,k,j,F,0,0],z);Ht.singularValueDecompose2dScale(H,Ri),u.lineWidth*=Math.max(Ri[0],Ri[1])/y,u.stroke(this.#i(C,M,c))}else u.lineWidth/=y,u.stroke(C);u.restore()}else(w===wn.FILL||w===wn.FILL_STROKE)&&(u.fillText(e,i,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a,()=>u.measureText(e))),(w===wn.STROKE||w===wn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a,()=>u.measureText(e)).recordDependencies(t,Vi.stroke),u.strokeText(e,i,a));S&&((this.pendingTextPaths||=[]).push({transform:Ze(u),x:i,y:a,fontSize:y,path:C}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){i=!0;break}return ie(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Vi.showText).resetBBox(t),this.current.textRenderingMode&wn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,a=i.font;if(a.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const l=i.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=i.fontSizeScale,d=i.charSpacing,f=i.wordSpacing,p=i.fontDirection,y=i.textHScale*p,w=e.length,S=a.vertical,_=S?1:-1,A=a.defaultVMetrics,C=l*i.fontMatrix[0],M=i.textRenderingMode===wn.FILL&&!a.disableFontFace&&!i.patternFill;c.save(),i.textMatrix&&c.transform(...i.textMatrix),c.translate(i.x,i.y+i.textRise),p>0?c.scale(y,-1):c.scale(y,1);let N,k;const j=i.textRenderingMode&wn.FILL_STROKE_MASK,F=j===wn.FILL||j===wn.FILL_STROKE,z=j===wn.STROKE||j===wn.FILL_STROKE;if(F&&i.patternFill){c.save();const xt=i.fillColor.getPattern(c,this,As(c),zn.FILL,t);N=Ze(c),c.restore(),c.fillStyle=xt}if(z&&i.patternStroke){c.save();const xt=i.strokeColor.getPattern(c,this,As(c),zn.STROKE,t);k=Ze(c),c.restore(),c.strokeStyle=xt}let H=i.lineWidth;const ct=i.textMatrixScale;if(ct===0||H===0?z&&(H=this.getSinglePixelWidth()):H/=ct,u!==1&&(c.scale(u,u),H/=u),c.lineWidth=H,a.isInvalidPDFjsFont){const xt=[];let Nt=0;for(const Rt of e)xt.push(Rt.unicode),Nt+=Rt.width;const At=xt.join("");if(c.fillText(At,0,0),this.dependencyTracker!==null){const Rt=c.measureText(At);this.dependencyTracker.recordBBox(t,this.ctx,-Rt.actualBoundingBoxLeft,Rt.actualBoundingBoxRight,-Rt.actualBoundingBoxAscent,Rt.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=Nt*C*y,c.restore(),this.compose();return}let dt=0,Tt;for(Tt=0;Tt<w;++Tt){const xt=e[Tt];if(typeof xt=="number"){dt+=_*xt*l/1e3;continue}let Nt=!1;const At=(xt.isSpace?f:0)+d,Rt=xt.fontChar,qt=xt.accent;let G,tt,vt=xt.width;if(S){const U=xt.vmetric||A,J=-(xt.vmetric?U[1]:vt*.5)*C,ft=U[2]*C;vt=U?-U[0]:vt,G=J/u,tt=(dt+ft)/u}else G=dt/u,tt=0;let Xt;if(a.remeasure&&vt>0){Xt=c.measureText(Rt);const U=Xt.width*1e3/l*u;if(vt<U&&this.isFontSubpixelAAEnabled){const J=vt/U;Nt=!0,c.save(),c.scale(J,1),G/=J}else vt!==U&&(G+=(vt-U)/2e3*l/u)}if(this.contentVisible&&(xt.isInFont||a.missingFile)){if(M&&!qt)c.fillText(Rt,G,tt),this.dependencyTracker?.recordCharacterBBox(t,c,Xt?{bbox:null}:a,l/u,G,tt,()=>Xt??c.measureText(Rt));else if(this.paintChar(t,Rt,G,tt,N,k),qt){const U=G+l*qt.offset.x/u,J=tt-l*qt.offset.y/u;this.paintChar(t,qt.fontChar,U,J,N,k)}}const Ct=S?vt*C-At*p:vt*C+At*p;dt+=Ct,Nt&&c.restore()}S?i.y-=dt:i.x+=dt*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,a=this.current,l=a.font,c=a.fontSize,u=a.fontDirection,d=l.vertical?1:-1,f=a.charSpacing,p=a.wordSpacing,y=a.textHScale*u,w=a.fontMatrix||Jp,S=e.length,_=a.textRenderingMode===wn.INVISIBLE;let A,C,M,N;if(_||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),a.textMatrix&&i.transform(...a.textMatrix),i.translate(a.x,a.y+a.textRise),i.scale(y,u);const k=this.dependencyTracker;for(this.dependencyTracker=k?new Yh(k,t):null,A=0;A<S;++A){if(C=e[A],typeof C=="number"){N=d*C*c/1e3,this.ctx.translate(N,0),a.x+=N*y;continue}const j=(C.isSpace?p:0)+f,F=l.charProcOperatorList[C.operatorListId];F?this.contentVisible&&(this.save(),i.scale(c,c),i.transform(...w),this.executeOperatorList(F),this.restore()):ne(`Type3 character "${C.operatorListId}" is not available.`);const z=[C.width,0];Ht.applyTransform(z,w),M=z[0]*c+j,i.translate(M,0),a.x+=M*y}i.restore(),k&&(this.dependencyTracker=k)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,a,l,c,u){const d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,c,l,u).recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const a=this.baseTransform||Ze(this.ctx),l={createCanvasGraphics:(c,u)=>new cl(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Yh(this.dependencyTracker,u,!0):null)};i=new qm(e,this.ctx,l,a)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let a;return this.cachedPatterns.has(e)?a=this.cachedPatterns.get(e):(a=ST(this.getObject(t,e)),this.cachedPatterns.set(e,a)),i&&(a.matrix=i),a}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const a=this._getPattern(t,e);i.fillStyle=a.getPattern(i,this,As(i),zn.SHADING,t);const l=As(i);if(l){const{width:c,height:u}=i.canvas,d=al.slice();Ht.axialAlignedBoundingBox([0,0,c,u],l,d);const[f,p,y,w]=d;this.ctx.fillRect(f,p,y-f,w-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Vi.transform).recordDependencies(t,Vi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Me("Should not call beginInlineImage")}beginImageData(){Me("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Ze(this.ctx),i)){Ht.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[a,l,c,u]=i,d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||cd("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const a=Ze(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let l=al.slice();Ht.axialAlignedBoundingBox(e.bbox,Ze(i),l);const c=[0,0,i.canvas.width,i.canvas.height];l=Ht.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),d=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),p=Math.max(Math.ceil(l[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const w=this.cachedCanvases.getCanvas(y,f,p),S=w.context;S.translate(-u,-d),S.transform(...a);let _=new Path2D;const[A,C,M,N]=e.bbox;if(_.rect(A,C,M-A,N-C),e.matrix){const k=new Path2D;k.addPath(_,new DOMMatrix(e.matrix)),_=k}S.clip(_),e.smask&&this.smaskStack.push({canvas:w.canvas,context:S,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,d),i.save()),Cc(i,S),this.ctx=S,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Ze(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=al.slice();Ht.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l,c),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,e,i,a,l,c){if(this.#t(),Ch(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],d=i[3]-i[1];if(c&&this.annotationCanvasMap){a=a.slice(),a[4]-=i[0],a[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=d,Ht.singularValueDecompose2dScale(Ze(this.ctx),Ri);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:w,context:S}=this.annotationCanvas;this.annotationCanvasMap.set(e,w),this.annotationCanvas.savedCtx=this.ctx,this.ctx=S,this.ctx.save(),this.ctx.setTransform(Ri[0],0,0,-Ri[1],0,d*Ri[1]),Ch(this.ctx)}else{Ch(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],u,d),this.ctx.clip(f)}}this.current=new pv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const a=this.ctx,l=this._createMaskCanvas(t,e),c=l.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,a=0,l=0,c,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=Ze(d);d.transform(i,a,l,c,0,0);const p=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,w=u.length;y<w;y+=2){const S=Ht.transform(f,[i,a,l,c,u[y],u[y+1]]);d.drawImage(p.canvas,S[4],S[5]),this.dependencyTracker?.recordBBox(t,this.ctx,S[4],S[4]+p.canvas.width,S[5],S[5]+p.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Vi.transformAndFill);for(const c of e){const{data:u,width:d,height:f,transform:p}=c,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),w=y.context;w.save();const S=this.getObject(t,u,c);gv(w,S),w.globalCompositeOperation="source-in",w.fillStyle=l?a.getPattern(w,this,As(i),zn.FILL,t):a,w.fillRect(0,0,d,f),w.restore(),i.save(),i.transform(...p),i.scale(1,-1),_h(i,y.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,d,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,a,l){if(!this.contentVisible)return;const c=this.getObject(t,e);if(!c){ne("Dependent image isn't ready yet");return}const u=c.width,d=c.height,f=[];for(let p=0,y=l.length;p<y;p+=2)f.push({transform:[i,0,0,a,l[p],l[p+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:a}=t,l=this.cachedCanvases.getCanvas("inlineImage",i,a),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(e,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,a=e.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/i,-1/a);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,a).context;mv(p,e),u=this.applyTransferMapsToCanvas(p)}const d=this._scaleImage(u,As(l));l.imageSmoothingEnabled=yv(Ze(l),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,i,-a,0).recordDependencies(t,Vi.imageXObject).recordOperation(t),_h(l,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,i,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const a=this.ctx;let l;if(e.bitmap)l=e.bitmap;else{const c=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;mv(f,e),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of i)a.save(),a.transform(...c.transform),a.scale(1,-1),_h(a,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Vi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const l=this.ctx;this.pendingClip?(a||(this.pendingClip===bv?l.clip(e,"evenodd"):l.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Ze(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:a,d:l}=this.ctx.getTransform();let c,u;if(i===0&&a===0){const d=Math.abs(e),f=Math.abs(l);if(d===f)if(t===0)c=u=1/d;else{const p=d*t;c=u=p<1?1/p:1}else if(t===0)c=1/d,u=1/f;else{const p=d*t,y=f*t;c=p<1?1/p:1,u=y<1?1/y:1}}else{const d=Math.abs(e*l-i*a),f=Math.hypot(e,i),p=Math.hypot(a,l);if(t===0)c=p/d,u=f/d;else{const y=t*d;c=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:a}}=this,[l,c]=this.getScaleForStroking();if(l===c){i.lineWidth=(a||1)*l,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(l,c),Np.a=1/l,Np.d=1/c;const d=new Path2D;if(d.addPath(t,Np),u.length>0){const f=Math.max(l,c);i.setLineDash(u.map(p=>p/f)),i.lineDashOffset/=f}i.lineWidth=a||1,i.stroke(d),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const r in Uc)cl.prototype[r]!==void 0&&(cl.prototype[Uc[r]]=cl.prototype[r]);class ul{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class DT{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const nl=Symbol("INTERNAL");class OT{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:a,rbGroups:l}){this.#t=!!(t&Ci.DISPLAY),this.#e=!!(t&Ci.PRINT),this.name=e,this.intent=i,this.usage=a,this.rbGroups=l}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==nl&&Me("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class NT{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=Ci.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new OT(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(nl,!1);for(const i of t.on)this.#e.get(i)._setVisible(nl,!0);for(const i of t.off)this.#e.get(i)._setVisible(nl,!1);this.#i=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let a=1;a<e;a++){const l=t[a];let c;if(Array.isArray(l))c=this.#s(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return ne(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return cd("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ne(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ne(`Unknown optional content policy ${t.policy}.`),!0}return ne(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const a=this.#e.get(t);if(!a){ne(`Optional content group not found: ${t}`);return}if(i&&e&&a.rbGroups.length)for(const l of a.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(nl,!1,!0);a._setVisible(nl,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":i=a;continue}const l=this.#e.get(a);if(l)switch(i){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!l.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Lw;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class fd{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,e,i){this._source=t,this.#t=e,this.#e=i}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Re(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new this.#e(this,t,e);return this._rangeReaders.add(i),i}cancelAllRequests(t){this._fullReader?.cancel(t);for(const e of new Set(this._rangeReaders))e.cancel(t)}}class pd{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){Me("Abstract method `read` called")}cancel(t){Me("Abstract method `cancel` called")}}class md{_stream=null;constructor(t,e,i){this._stream=t}async read(){Me("Abstract method `read` called")}cancel(t){Me("Abstract method `cancel` called")}}function vv(r){return r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer}class kT extends fd{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,LT,PT);const{pdfDataRangeTransport:e}=t,{initialData:i,progressiveDone:a}=e;if(i?.length>0){const l=vv(i);this._queuedChunks.push(l)}this._progressiveDone=a,e.addRangeListener((l,c)=>{this.#t(l,c)}),e.addProgressListener((l,c)=>{c!==void 0&&this._fullReader?.onProgress?.({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this.#t(void 0,l)}),e.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),e.transportReady()}#t(t,e){const i=vv(e);if(t===void 0)this._fullReader?this._fullReader._enqueue(i):this._queuedChunks.push(i);else{const a=this._rangeReaders.keys().find(l=>l._begin===t);Re(a,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),a._enqueue(i)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onDone=()=>this._rangeReaders.delete(i),this._source.pdfDataRangeTransport.requestDataRange(t,e)),i}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class LT extends pd{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:e,disableRange:i,disableStream:a}=t._source,{length:l,contentDispositionFilename:c}=e;this._queuedChunks=t._queuedChunks||[];for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._done=t._progressiveDone,this._contentLength=l,this._isStreamingSupported=!a,this._isRangeSupported=!i,jm(c)&&(this._filename=c),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class PT extends md{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,e,i){super(t,e,i),this._begin=e}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function BT(r){let t=!0,e=i("filename\\*","i").exec(r);if(e){e=e[1];let p=u(e);return p=unescape(p),p=d(p),p=f(p),l(p)}if(e=c(r),e){const p=f(e);return l(p)}if(e=i("filename","i").exec(r),e){e=e[1];let p=u(e);return p=f(p),l(p)}function i(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function a(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const w=new TextDecoder(p,{fatal:!0}),S=ud(y);y=w.decode(S),t=!1}catch{}}return y}function l(p){return t&&/[\x80-\xff]/.test(p)&&(p=a("utf-8",p),t&&(p=a("iso-8859-1",p))),p}function c(p){const y=[];let w;const S=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(w=S.exec(p))!==null;){let[,A,C,M]=w;if(A=parseInt(A,10),A in y){if(A===0)break;continue}y[A]=[C,M]}const _=[];for(let A=0;A<y.length&&A in y;++A){let[C,M]=y[A];M=u(M),C&&(M=unescape(M),A===0&&(M=d(M))),_.push(M)}return _.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let w=0;w<y.length;++w){const S=y[w].indexOf('"');S!==-1&&(y[w]=y[w].slice(0,S),y.length=w+1),y[w]=y[w].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function d(p){const y=p.indexOf("'");if(y===-1)return p;const w=p.slice(0,y),_=p.slice(y+1).replace(/^[^']*'/,"");return a(w,_)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,w,S,_){if(S==="q"||S==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(A,C){return String.fromCharCode(parseInt(C,16))}),a(w,_);try{_=atob(_)}catch{}return a(w,_)})}return""}function zw(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const i in t){const a=t[i];a!==void 0&&e.append(i,a)}return e}function gd(r){return URL.parse(r)?.origin??null}function Hw({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:i}){const a={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(r.get("Content-Length"),10);return!Number.isInteger(l)||(a.suggestedLength=l,l<=2*e)||i||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function qw(r){const t=r.get("Content-Disposition");if(t){let e=BT(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(jm(e))return e}return null}function yd(r,t){return new Xh(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function Gw(r,t){if(r!==t)throw new Error(`Expected range response-origin "${r}" to match "${t}".`)}function Vw(r,t,e,i){return fetch(r,{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"})}function Kw(r,t){if(r!==200&&r!==206)throw yd(r,t)}function $w(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ne(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class jT extends fd{_responseOrigin=null;constructor(t){super(t,FT,IT),this.isHttp=/^https?:/i.test(t.url),this.headers=zw(this.isHttp,t.httpHeaders)}}class FT extends pd{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:a,rangeChunkSize:l,url:c,withCredentials:u}=t._source;this._contentLength=a,this._isStreamingSupported=!i,this._isRangeSupported=!e;const d=new Headers(t.headers);Vw(c,d,u,this._abortController).then(f=>{t._responseOrigin=gd(f.url),Kw(f.status,c),this._reader=f.body.getReader();const p=f.headers,{allowRangeRequests:y,suggestedLength:w}=Hw({responseHeaders:p,isHttp:t.isHttp,rangeChunkSize:l,disableRange:e});this._isRangeSupported=y,this._contentLength=w||this._contentLength,this._filename=qw(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new rr("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:$w(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class IT extends md{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const{url:a,withCredentials:l}=t._source,c=new Headers(t.headers);c.append("Range",`bytes=${e}-${i-1}`),Vw(a,c,l,this._abortController).then(u=>{const d=gd(u.url);Gw(d,t._responseOrigin),Kw(u.status,a),this._reader=u.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:$w(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const kp=200,wv=206;function UT(r){return typeof r!="string"?r:ud(r).buffer}class zT extends fd{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,HT,qT),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=zw(this.isHttp,t.httpHeaders)}_request(t){const e=new XMLHttpRequest,i={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(e,i),e.open("GET",this.url),e.withCredentials=this._source.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.validateStatus=a=>a===wv||a===kp):i.validateStatus=a=>a===kp,e.responseType="arraybuffer",Re(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>t.onError(e.status),e.onreadystatechange=this.#i.bind(this,e),e.onprogress=this.#e.bind(this,e),e.send(null),e}#e(t,e){this.#t.get(t)?.onProgress?.(e)}#i(t,e){const i=this.#t.get(t);if(!i||(t.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){i.onError(t.status);return}const a=t.status||kp;if(!i.validateStatus(a)){i.onError(t.status);return}const l=UT(t.response);if(a===wv){const c=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(c)?i.onDone(l):(ne('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone(l):i.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onClosed=()=>this._rangeReaders.delete(i)),i}}class HT extends pd{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:e}=t._source;this._contentLength=e,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:this.#n.bind(this)})}#t(){const t=this._stream,{disableRange:e,rangeChunkSize:i}=t._source,a=this._fullRequestXhr;t._responseOrigin=gd(a.responseURL);const l=a.getAllResponseHeaders(),c=new Headers(l?l.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[p,...y]=f.split(": ");return[p,y.join(": ")]}):[]),{allowRangeRequests:u,suggestedLength:d}=Hw({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:i,disableRange:e});u&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=qw(c),this._isRangeSupported&&t._abortRequest(a),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}#i(t){this._storedError=yd(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class qT extends md{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,e,i){super(t,e,i),this._requestXhr=t._request({begin:e,end:i,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:null})}#t(){const t=gd(this._requestXhr?.responseURL);try{Gw(t,this._stream._responseOrigin)}catch(e){this._storedError=e,this.#i(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#i(t){this._storedError??=yd(t,this._stream.url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const GT=/^[a-z][a-z0-9\-+.]+:/i;function VT(r){if(GT.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}function Xw(r){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(r):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(r)}function Yw(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ne(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class KT extends fd{constructor(t){super(t,$T,XT),this.url=VT(t.url),Re(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class $T extends pd{_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:a,rangeChunkSize:l}=t._source;this._contentLength=a,this._isStreamingSupported=!i,this._isRangeSupported=!e;const c=t.url,u=process.getBuiltinModule("fs");u.promises.lstat(c).then(d=>{const f=u.createReadStream(c),p=Xw(f);this._reader=p.getReader();const{size:y}=d;y<=2*l&&(this._isRangeSupported=!1),this._contentLength=y,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new rr("Streaming is disabled.")),this._headersCapability.resolve()}).catch(d=>{d.code==="ENOENT"&&(d=yd(0,c.href)),this._headersCapability.reject(d)})}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Yw(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class XT extends md{_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const a=t.url,l=process.getBuiltinModule("fs");try{const c=l.createReadStream(a,{start:e,end:i-1}),u=Xw(c);this._reader=u.getReader(),this._readCapability.resolve()}catch(c){this._readCapability.reject(c)}}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:Yw(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const Tc=Symbol("INITIAL_DATA");class Qw{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Tc}}get(t,e=null){if(e){const a=this.#e(t);return a.promise.then(()=>e(a.data)),null}const i=this.#t[t];if(!i||i.data===Tc)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Tc}delete(t){const e=this.#t[t];return!e||e.data===Tc?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Tc&&(yield[t,e])}}}const YT=1e5,xv=30;class Ti{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#a=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#A=null;static#w=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=i.scale*Os.pixelRatio,this.#d=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:l,pageX:c,pageY:u}=i.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#o=a,this.#a=l,Ti.#M(),e.style.setProperty("--min-font-size",Ti.#A),eo(e,i),this.#t.promise.finally(()=>{Ti.#w.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Sn.platform;return ie(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),Ti.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Os.pixelRatio,a=t.rotation;if(a!==this.#d&&(e?.(),this.#d=a,eo(this.#l,{rotation:a})),i!==this.#h){e?.(),this.#h=i;const l={div:null,properties:null,ctx:Ti.#D(this.#s)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#_(l)}}cancel(){const t=new rr("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#C(t){if(this.#i)return;this.#r.ctx??=Ti.#D(this.#s);const e=this.#u,i=this.#g;for(const a of t){if(e.length>YT){ne("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(this.#e.ariaHidden=!0),l.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(a.str),this.#x(a)}}#x(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const a=Ht.transform(this.#y,t.transform);let l=Math.atan2(a[1],a[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#n&&c.fontSubstitution||c.fontFamily;u=Ti.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*Ti.#j(u,c,this.#s);let p,y;l===0?(p=a[4],y=a[5]-f):(p=a[4]+f*Math.sin(l),y=a[5]-f*Math.cos(l));const w=e.style;w.left=`${(100*p/this.#o).toFixed(2)}%`,w.top=`${(100*y/this.#a).toFixed(2)}%`,w.setProperty("--font-height",`${d.toFixed(2)}px`),w.fontFamily=u,i.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(i.angle=l*(180/Math.PI));let S=!1;if(t.str.length>1)S=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),A=Math.abs(t.transform[3]);_!==A&&Math.max(_,A)/Math.min(_,A)>1.5&&(S=!0)}if(S&&(i.canvasWidth=c.vertical?t.height:t.width),this.#p.set(e,i),this.#r.div=e,this.#r.properties=i,this.#_(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#_(t){const{div:e,properties:i,ctx:a}=t,{style:l}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=l,{canvasWidth:u,fontSize:d}=i;Ti.#R(a,d*this.#h,c);const{width:f}=a.measureText(e.textContent);f>0&&l.setProperty("--scale-x",u*this.#h/f)}i.angle!==0&&l.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#w.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#D(t=null){let e=this.#b.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#R(t,e,i){const a=this.#E.get(t);e===a.size&&i===a.family||(t.font=`${e}px ${i}`,a.size=e,a.family=i)}static#M(){if(this.#A!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#A=t.getBoundingClientRect().height,t.remove()}static#j(t,e,i){const a=this.#v.get(t);if(a)return a;const l=this.#D(i);l.canvas.width=l.canvas.height=xv,this.#R(l,xv,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,d=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+d):(Sn.platform.isFirefox&&ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}}const QT=100;function Ww(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new Gm,{docId:e}=t,i=r.url?sT(r.url):null,a=r.data?aT(r.data):null,l=r.httpHeaders||null,c=r.withCredentials===!0,u=r.password??null,d=r.range instanceof Zw?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let p=r.worker instanceof Hc?r.worker:null;const y=r.verbosity,w=typeof r.docBaseUrl=="string"&&!hd(r.docBaseUrl)?r.docBaseUrl:null,S=xh(r.cMapUrl),_=r.cMapPacked!==!1,A=r.CMapReaderFactory||(ei?fT:av),C=xh(r.iccUrl),M=xh(r.standardFontDataUrl),N=r.StandardFontDataFactory||(ei?pT:rv),k=xh(r.wasmUrl),j=r.WasmFactory||(ei?mT:ov),F=r.stopAtErrors!==!0,z=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,H=r.isEvalSupported!==!1,ct=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!ei,dt=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!ei&&(Sn.platform.isFirefox||!globalThis.chrome),Tt=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,xt=typeof r.disableFontFace=="boolean"?r.disableFontFace:ei,Nt=r.fontExtraProperties===!0,At=r.enableXfa===!0,Rt=r.ownerDocument||globalThis.document,qt=r.disableRange===!0,G=r.disableStream===!0,tt=r.disableAutoFetch===!0,vt=r.pdfBug===!0,Xt=r.CanvasFactory||(ei?dT:cT),Ct=r.FilterFactory||(ei?hT:uT),U=r.enableHWA===!0,J=r.useWasm!==!1,ft=d?d.length:r.length??NaN,wt=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!ei&&!xt,Bt=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(A===av&&N===rv&&j===ov&&S&&M&&k&&Nc(S,document.baseURI)&&Nc(M,document.baseURI)&&Nc(k,document.baseURI)),Ft=null;OC(y);const It={canvasFactory:new Xt({ownerDocument:Rt,enableHWA:U}),filterFactory:new Ct({docId:e,ownerDocument:Rt}),cMapReaderFactory:Bt?null:new A({baseUrl:S,isCompressed:_}),standardFontDataFactory:Bt?null:new N({baseUrl:M}),wasmFactory:Bt?null:new j({baseUrl:k})};p||(p=Hc.create({verbosity:y,port:ul.workerPort}),t._worker=p);const re={docId:e,apiVersion:"5.4.624",data:a,password:u,disableAutoFetch:tt,rangeChunkSize:f,length:ft,docBaseUrl:w,enableXfa:At,evaluatorOptions:{maxImageSize:z,disableFontFace:xt,ignoreErrors:F,isEvalSupported:H,isOffscreenCanvasSupported:ct,isImageDecoderSupported:dt,canvasMaxAreaInBytes:Tt,fontExtraProperties:Nt,useSystemFonts:wt,useWasm:J,useWorkerFetch:Bt,cMapUrl:S,iccUrl:C,standardFontDataUrl:M,wasmUrl:k}},Kt={ownerDocument:Rt,pdfBug:vt,styleElement:Ft,enableHWA:U,loadingParams:{disableAutoFetch:tt,enableXfa:At}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const kt=p.messageHandler.sendWithPromise("GetDocRequest",re,a?[a.buffer]:null);let He;if(d)He=new kT({pdfDataRangeTransport:d,disableRange:qt,disableStream:G});else if(!a){if(!i)throw new Error("getDocument - no `url` parameter provided.");const yt=Nc(i)?jT:ei?KT:zT;He=new yt({url:i,length:ft,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:qt,disableStream:G})}return kt.then(yt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const le=new kc(e,yt,p.port),Mt=new JT(le,t,He,Kt,It);t._transport=Mt,le.send("Ready",null)})}).catch(t._capability.reject),t}class Gm{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Gm.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Zw{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#s=[];constructor(t,e,i=!1,a=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=a}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Me("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class WT{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class ZT{#t=!1;#e=Ce.instance;constructor(t,e,i,a=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=a?new Z0:null,this._pdfBug=a,this.commonObjs=i.commonObjs,this.objs=new Qw,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:a=0,dontFlip:l=!1}={}){return new Zc({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:a="display",annotationMode:l=nr.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:w=!1,recordOperations:S=!1,operationsFilter:_=null}){this._stats?.time("Overall");const A=this._transport.getRenderingIntent(a,l,y,w),{renderingIntent:C,cacheKey:M}=A;this.#t=!1,d||=this._transport.getOptionalContentConfig(C);let N=this._intentStates.get(M);N||(N=Object.create(null),this._intentStates.set(M,N)),N.streamReaderCancelTimeout&&(clearTimeout(N.streamReaderCancelTimeout),N.streamReaderCancelTimeout=null);const k=!!(C&Ci.PRINT);N.displayReadyCapability||(N.displayReadyCapability=Promise.withResolvers(),N.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(A));const j=!!(this._pdfBug&&globalThis.StepperManager?.enabled),F=!this.recordedBBoxes&&(S||j),z=dt=>{if(N.renderTasks.delete(H),F){const Tt=H.gfx?.dependencyTracker.take();Tt&&(H.stepper&&H.stepper.setOperatorBBoxes(Tt,H.gfx.dependencyTracker.takeDebugMetadata()),S&&(this.recordedBBoxes=Tt))}k&&(this.#t=!0),this.#i(),dt?(H.capability.reject(dt),this._abortOperatorList({intentState:N,reason:dt instanceof Error?dt:new Error(dt)})):H.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},H=new rl({callback:z,params:{canvas:e,canvasContext:t,dependencyTracker:F?new yT(e,N.operatorList.length,j):null,viewport:i,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:N.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:_});(N.renderTasks||=new Set).add(H);const ct=H.task;return Promise.all([N.displayReadyCapability.promise,d]).then(([dt,Tt])=>{if(this.destroyed){z();return}if(this._stats?.time("Rendering"),!(Tt.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");H.initializeGraphics({transparency:dt,optionalContentConfig:Tt}),H.operatorListChanged()}).catch(z),ct}getOperatorList({intent:t="display",annotationMode:e=nr.ENABLE,printAnnotationStorage:i=null,isEditing:a=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const c=this._transport.getRenderingIntent(t,e,i,a,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>zc.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,a){function l(){c.read().then(function({value:d,done:f}){if(f){i(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),l()},a)}const c=e.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#i();return t&&e&&(this._stats&&=new Z0),e}#i(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,a=t.length;i<a;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#i()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:a}){const{map:l,transfer:c}=i,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:l,modifiedIds:a},c).getReader(),f=this._intentStates.get(e);f.streamReader=d;const p=()=>{d.read().then(({value:y,done:w})=>{if(w){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const w of f.renderTasks)w.operatorListChanged();this.#i()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Bm){let a=QT;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new rr(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,l]of this._intentStates)if(l===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var ir,ts,ua,Kr,Wh,$r,Xr,ii,Ih,Jw,tx,Lc,hl,Uh;const Ye=class Ye{constructor({name:t=null,port:e=null,verbosity:i=NC()}={}){ws(this,ii);ws(this,ir,Promise.withResolvers());ws(this,ts,null);ws(this,ua,null);ws(this,Kr,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Xe(Ye,Xr).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Xe(Ye,Xr).set(e,this),xs(this,ii,Jw).call(this,e)}else xs(this,ii,tx).call(this)}get promise(){return Xe(this,ir).promise}get port(){return Xe(this,ua)}get messageHandler(){return Xe(this,ts)}destroy(){this.destroyed=!0,Xe(this,Kr)?.terminate(),hi(this,Kr,null),Xe(Ye,Xr).delete(Xe(this,ua)),hi(this,ua,null),Xe(this,ts)?.destroy(),hi(this,ts,null)}static create(t){const e=Xe(this,Xr).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Ye(t)}static get workerSrc(){if(ul.workerSrc)return ul.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ie(this,"_setupFakeWorkerGlobal",(async()=>Xe(this,hl,Uh)?Xe(this,hl,Uh):(await import(this.workerSrc)).WorkerMessageHandler)())}};ir=new WeakMap,ts=new WeakMap,ua=new WeakMap,Kr=new WeakMap,Wh=new WeakMap,$r=new WeakMap,Xr=new WeakMap,ii=new WeakSet,Ih=function(){Xe(this,ir).resolve(),Xe(this,ts).send("configure",{verbosity:this.verbosity})},Jw=function(t){hi(this,ua,t),hi(this,ts,new kc("main","worker",t)),Xe(this,ts).on("ready",()=>{}),xs(this,ii,Ih).call(this)},tx=function(){if(Xe(Ye,$r)||Xe(Ye,hl,Uh)){xs(this,ii,Lc).call(this);return}let{workerSrc:t}=Ye;try{Ye._isSameOrigin(window.location,t)||(t=Ye._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new kc("main","worker",e),a=()=>{l.abort(),i.destroy(),e.terminate(),this.destroyed?Xe(this,ir).reject(new Error("Worker was destroyed")):xs(this,ii,Lc).call(this)},l=new AbortController;e.addEventListener("error",()=>{Xe(this,Kr)||a()},{signal:l.signal}),i.on("test",u=>{if(l.abort(),this.destroyed||!u){a();return}hi(this,ts,i),hi(this,ua,e),hi(this,Kr,e),xs(this,ii,Ih).call(this)}),i.on("ready",u=>{if(l.abort(),this.destroyed){a();return}try{c()}catch{xs(this,ii,Lc).call(this)}});const c=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};c();return}catch{cd("The worker has been disabled.")}xs(this,ii,Lc).call(this)},Lc=function(){Xe(Ye,$r)||(ne("Setting up fake worker."),hi(Ye,$r,!0)),Ye._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Xe(this,ir).reject(new Error("Worker was destroyed"));return}const e=new lT;hi(this,ua,e);const i=`fake${Jb(Ye,Wh)._++}`,a=new kc(i+"_worker",i,e);t.setup(a,e),hi(this,ts,new kc(i,i+"_worker",e)),xs(this,ii,Ih).call(this)}).catch(t=>{Xe(this,ir).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},hl=new WeakSet,Uh=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},ws(Ye,hl),ws(Ye,Wh,0),ws(Ye,$r,!1),ws(Ye,Xr,new WeakMap),ei&&(hi(Ye,$r,!0),ul.workerSrc||="./pdf.worker.mjs"),Ye._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const a=new URL(e,i);return i.origin===a.origin},Ye._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Ye.fromPort=t=>{if(GC("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Ye.create(t)};let Hc=Ye;class JT{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#i=null;#n=new Map;#s=new Map;#r=new Map;#a=null;#o=Ce.instance;constructor(t,e,i,a,l){this.messageHandler=t,this.loadingTask=e,this.#i=i,this.commonObjs=new Qw,this.fontLoader=new eT({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.enableHWA=a.enableHWA,this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const t=new Map,e=new Map;for(let i=0,a=this.#o.pagesNumber;i<a;i++){const l=this.#o.getPrevPageNumber(i+1)-1,c=this.#n.get(l);c&&t.set(i,c);const u=this.#s.get(l);u&&e.set(i,u)}this.#n=t,this.#s=e}#l(t,e=null){const i=this.#e.get(t);if(i)return i;const a=this.messageHandler.sendWithPromise(t,e);return this.#e.set(t,a),a}#d({loaded:t,total:e}){this.loadingTask.onProgress?.({loaded:t,total:e,percent:Un(Math.round(t/e*100),0,100)})}get annotationStorage(){return ie(this,"annotationStorage",new Um)}getRenderingIntent(t,e=nr.ENABLE,i=null,a=!1,l=!1){let c=Ci.DISPLAY,u=am;switch(t){case"any":c=Ci.ANY;break;case"display":break;case"print":c=Ci.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${t}`)}const d=c&Ci.PRINT&&i instanceof Pw?i:this.annotationStorage;switch(e){case nr.DISABLE:c+=Ci.ANNOTATIONS_DISABLE;break;case nr.ENABLE:break;case nr.ENABLE_FORMS:c+=Ci.ANNOTATIONS_FORMS;break;case nr.ENABLE_STORAGE:c+=Ci.ANNOTATIONS_STORAGE,u=d.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(c+=Ci.IS_EDITING),l&&(c+=Ci.OPLIST);const{ids:f,hash:p}=d.modifiedIds,y=[c,u.hash,p];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#n.values())t.push(i._destroy());this.#n.clear(),this.#s.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ti.cleanup(),this.#i?.cancelAllRequests(new rr("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,a)=>{Re(this.#i,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#i.getFullReader(),this.#t.onProgress=l=>this.#d(l),a.onPull=()=>{this.#t.read().then(function({value:l,done:c}){if(c){a.close();return}Re(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{this.#t.cancel(l),a.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async i=>{await this.#t.headersReady;const{isStreamingSupported:a,isRangeSupported:l,contentLength:c}=this.#t;return a&&l&&(this.#t.onProgress=null),{isStreamingSupported:a,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(i,a)=>{Re(this.#i,"GetRangeReader - no `BasePDFStream` instance available.");const l=this.#i.getRangeReader(i.begin,i.end);if(!l){a.close();return}a.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){a.close();return}Re(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{a.error(c)})},a.onCancel=c=>{l.cancel(c),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this.#o.pagesNumber=i.numPages,this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new WT(i,this))}),t.on("DocException",i=>{e._capability.reject(di(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw di(i);const a=l=>{l instanceof Error?this.#a.reject(l):this.#a.resolve({password:l})};e.onPassword(a,i.code)}catch(a){this.#a.reject(a)}return this.#a.promise}),t.on("DataLoaded",i=>{this.#d({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#n.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,a,l])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(a){case"Font":if("error"in l){const y=l.error;ne(`Error during font loading: ${y}`),this.commonObjs.resolve(i,y);break}const c=new Fe(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,w)=>globalThis.FontInspector.fontAdded(y,w):null,d=new nT(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:f}=l;Re(f,"The imageRef must be defined.");for(const y of this.#n.values())for(const[,w]of y.objs)if(w?.ref===f)return w.dataLen?(this.commonObjs.resolve(i,structuredClone(w)),w.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new iT(l));break;case"Image":this.commonObjs.resolve(i,l);break;case"Pattern":const p=new Mn(l);this.commonObjs.resolve(i,p.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([i,a,l,c])=>{if(this.destroyed)return;const u=this.#n.get(a);if(!u.objs.has(i)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(i,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",i=>{this.destroyed||this.#d(i)}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[i.type];if(!a)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#o.getPageId(t)-1,a=this.#s.get(e);if(a)return a;const l=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(c=>{if(this.destroyed)throw new Error("Transport destroyed");c.refStr&&this.#r.set(c.refStr,i);const u=new ZT(e,c,this,this._params.pdfBug);return this.#n.set(e,u),u});return this.#s.set(e,l),l}async getPageIndex(t){if(!rm(t))throw new Error("Invalid pageIndex request.");const e=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#o.getPageNumber(e+1)-1}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(t+1)-1,intent:e})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#l("GetOptionalContentConfig").then(e=>new NT(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#e.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new DT(a[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:a[2]}));return this.#e.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#n.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ti.cleanup()}}cachedPageNumber(t){if(!rm(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,i=this.#r.get(e);return i>=0?this.#o.getPageNumber(i+1):null}}class t2{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this._internalRenderTask;return t.form||t.canvas&&e?.size>0}}class rl{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:a,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:w=null,enableHWA:S=!1,operationsFilter:_=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=a,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=y,this.pageColors=w,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new t2(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=S,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=_}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(rl.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");rl.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:a,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new cl(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:a,viewport:i,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),rl.#e.delete(this._canvas),t||=new Bm(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),rl.#e.delete(this._canvas),this.callback())))}}const e2="5.4.624",n2="384c6208b";let ex=class Cs{#t=null;#e=null;#i;#n=null;#s=!1;#r=!1;#a=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return ie(this,"_keyboardManager",new tu([[["Escape","mac+Escape"],Cs.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Cs.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Cs.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Cs.prototype._moveToPrevious],[["Home","mac+Home"],Cs.prototype._moveToBeginning],[["End","mac+End"],Cs.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#a=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Cs.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",$i,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[i,a]of this.#l.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",a),l.title=i,l.setAttribute("data-l10n-id",Cs.#d[i]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=a,l.ariaSelected=a===this.#i,l.addEventListener("click",this.#f.bind(this,a),{signal:e}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:we.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#n.lastElementChild?.focus()}#g(t){Cs._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#s=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}};class qc{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,qc.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:i}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=i||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",qc.#n[t]),a.addEventListener("input",()=>{this.#i.updateParams(e,a.value)},{signal:this.#i._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Sv(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function Rc(r){return Math.max(0,Math.min(255,255*r))}class Av{static CMYK_G([t,e,i,a]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Rc(t),[t,t,t]}static G_HTML([t]){const e=Sv(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Rc)}static RGB_HTML(t){return`#${t.map(Sv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,i+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,i,a]){return[Rc(1-Math.min(1,t+a)),Rc(1-Math.min(1,i+a)),Rc(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const a=1-t,l=1-e,c=1-i,u=Math.min(a,l,c);return["CMYK",a,l,c,u]}}class i2{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),i||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Me("Abstract method `_createSVG` called.")}}class Qh extends i2{_createSVG(t){return document.createElementNS(la,t)}}const s2=9,no=new WeakSet,a2=new Date().getTimezoneOffset()*60*1e3;class Lp{static create(t){switch(t.data.annotationType){case bn.LINK:return new Vm(t);case bn.TEXT:return new o2(t);case bn.WIDGET:switch(t.data.fieldType){case"Tx":return new l2(t);case"Btn":return t.data.radioButton?new nx(t):t.data.checkBox?new u2(t):new h2(t);case"Ch":return new d2(t);case"Sig":return new c2(t)}return new so(t);case bn.POPUP:return new cm(t);case bn.FREETEXT:return new ix(t);case bn.LINE:return new p2(t);case bn.SQUARE:return new m2(t);case bn.CIRCLE:return new g2(t);case bn.POLYLINE:return new sx(t);case bn.CARET:return new b2(t);case bn.INK:return new Km(t);case bn.POLYGON:return new y2(t);case bn.HIGHLIGHT:return new ax(t);case bn.UNDERLINE:return new v2(t);case bn.SQUIGGLY:return new w2(t);case bn.STRIKEOUT:return new x2(t);case bn.STAMP:return new rx(t);case bn.FILEATTACHMENT:return new S2(t);default:return new Je(t)}}}class Je{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Je._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:a}=this.data;let l=-1/0,c=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>c?(c=e[u+1],l=e[u+2]):e[u+1]===c&&(l=Math.max(l,e[u+2]));return[l,c]}if(i?.length>=1){for(const u of i)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>c?(c=u[d+1],l=u[d]):u[d+1]===c&&(l=Math.max(l,u[d]));if(l!==1/0)return[l,c]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-l)/i,t[1]=100*(t[1]-c)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Ic}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Ic}${e.id}`,{id:e.id,annotationType:e.annotationType,page:this.parent.page,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#n(e);let a=this.#i?.popup||this.popup;!a&&i?.text&&(this._createPopup(i),a=this.#i.popup),a&&(a.updateEdited(t),i?.deleted&&(a.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:i,rotation:a},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:d}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/l}%`,e.top=`${100*(c-t[3]+d)/c}%`,a===0?(e.width=`${100*(t[2]-t[0])/l}%`,e.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(a)}_createContainer(t){const{data:e,parent:{page:i,viewport:a}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",e.id),!(this instanceof so)&&!(this instanceof Vm)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(l.title=e.alternativeText),e.noRotate&&l.classList.add("norotate"),!e.rect||this instanceof cm){const{rotation:A}=e;return!e.hasOwnCanvas&&A!==0&&this.setRotation(A,l),l}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){c.borderWidth=`${e.borderStyle.width}px`;const A=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(A>0||C>0){const N=`calc(${A}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;c.borderRadius=N}else if(this instanceof nx){const N=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;c.borderRadius=N}switch(e.borderStyle.style){case el.SOLID:c.borderStyle="solid";break;case el.DASHED:c.borderStyle="dashed";break;case el.BEVELED:ne("Unimplemented border style: beveled");break;case el.INSET:ne("Unimplemented border style: inset");break;case el.UNDERLINE:c.borderBottomStyle="solid";break}const M=e.borderColor||null;M?(this.#e=!0,c.borderColor=Ht.makeHexColor(M[0]|0,M[1]|0,M[2]|0)):c.borderWidth=0}const f=Ht.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:y,pageX:w,pageY:S}=a.rawDims;c.left=`${100*(f[0]-w)/p}%`,c.top=`${100*(f[1]-S)/y}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(c.width=`${100*u/p}%`,c.height=`${100*d/y}%`):this.setRotation(_,l),l}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:a}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),e.style.width=`${100*l/i}%`,e.style.height=`${100*c/a}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,a)=>{const l=a.detail[e],c=l[0],u=l.slice(1);a.target.style[i]=Av[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:Av[`${c}_rgb`](u)})};return ie(this,"_commonActions",{display:e=>{const{display:i}=e.detail,a=i%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const a of Object.keys(e.detail))(t[a]||i[a])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[a,l]of Object.entries(e)){const c=i[a];if(c){const u={detail:{[a]:l},target:t};c(u),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,a,l]=this.data.rect.map(A=>Math.fround(A));if(t.length===8){const[A,C,M,N]=t.subarray(2,6);if(a===A&&l===C&&e===M&&i===N)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:A,borderWidth:C}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${A}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const d=a-e,f=l-i,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const w=p.createElement("defs");y.append(w);const S=p.createElement("clipPath"),_=`clippath_${this.data.id}`;S.setAttribute("id",_),S.setAttribute("clipPathUnits","objectBoundingBox"),w.append(S);for(let A=2,C=t.length;A<C;A+=8){const M=t[A],N=t[A+1],k=t[A+2],j=t[A+3],F=p.createElement("rect"),z=(k-e)/d,H=(l-N)/f,ct=(M-k)/d,dt=(N-j)/f;F.setAttribute("x",z),F.setAttribute("y",H),F.setAttribute("width",ct),F.setAttribute("height",dt),S.append(F),u?.push(`<rect vector-effect="non-scaling-stroke" x="${z}" y="${H}" width="${ct}" height="${dt}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${_})`}_createPopup(t=null){const{data:e}=this;let i,a;t?(i={str:t.text},a=t.date):(i=e.contentsObj,a=e.modificationDate),this.#i=new cm({data:{color:e.color,titleObj:e.titleObj,modificationDate:a,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Me("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:l,id:c,exportValues:u}of a){if(l===-1||c===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!no.has(f)){ne(`_getElementsByName - element not allowed: ${c}`);continue}i.push({id:c,exportValue:d,domElement:f})}return i}for(const a of document.getElementsByName(t)){const{exportValue:l}=a,c=a.getAttribute("data-element-id");c!==e&&no.has(a)&&i.push({id:c,exportValue:l,domElement:a})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class r2 extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Vm extends Je{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let a=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),a=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(i,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=i,this.container.append(i)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",a=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,a),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(e.actions)){const l=i.get(a);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:a}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:a,refs:l,include:c}=e,u=[];if(a.length!==0||l.length!==0){const p=new Set(l);for(const y of a){const w=this._fieldObjects[y]||[];for(const{id:S}of w)p.add(S)}for(const y of Object.values(this._fieldObjects))for(const w of y)p.has(w.id)===c&&u.push(w)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const S=p.defaultValue||"";d.setValue(y,{value:S});break}case"checkbox":case"radiobutton":{const S=p.defaultValue===p.exportValues;d.setValue(y,{value:S});break}case"combobox":case"listbox":{const S=p.defaultValue||"";d.setValue(y,{value:S});break}default:continue}const w=document.querySelector(`[data-element-id="${y}"]`);if(w){if(!no.has(w)){ne(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class o2 extends Je{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class so extends Je{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Sn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,a,l){i.includes("mouse")?t.addEventListener(i,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(i,c=>{if(i==="blur"){if(!e.focused||!c.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c)}})})}_setEventListeners(t,e,i,a){for(const[l,c]of i)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,l,c,a),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":Ht.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||s2,l=t.style;let c;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(Tp*a))||1,y=f/p;c=Math.min(a,d(y/Tp))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(a,d(f/Tp))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=Ht.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(l.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class l2 extends so{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,a){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[e]=i),l.setValue(c.id,{[a]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let l=a.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),no.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,w=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",_=>{t.setValue(e,{value:_.target.value}),this.setPropertyOnSiblings(i,"value",_.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",_=>{const A=this.data.defaultFieldValue??"";i.value=d.userValue=A,d.formattedValue=null});let S=_=>{const{formattedValue:A}=d;A!=null&&(_.target.value=A),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",A=>{if(d.focused)return;const{target:C}=A;if(w&&(C.type=p,y&&(C.step=y)),d.userValue){const M=d.userValue;if(w)if(p==="time"){const N=new Date(M),k=[N.getHours(),N.getMinutes(),N.getSeconds()];C.value=k.map(j=>j.toString().padStart(2,"0")).join(":")}else C.value=new Date(M-a2).toISOString().split(p==="date"?"T":".",1)[0];else C.value=M}d.lastCommittedValue=C.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",A=>{this.showElementAndHideCanvas(A.target);const C={value(M){d.userValue=M.detail.value??"",w||t.setValue(e,{value:d.userValue.toString()}),M.target.value=d.userValue},formattedValue(M){const{formattedValue:N}=M.detail;d.formattedValue=N,N!=null&&M.target!==document.activeElement&&(M.target.value=N);const k={formattedValue:N};w&&(k.value=N),t.setValue(e,k)},selRange(M){M.target.setSelectionRange(...M.detail.selRange)},charLimit:M=>{const{charLimit:N}=M.detail,{target:k}=M;if(N===0){k.removeAttribute("maxLength");return}k.setAttribute("maxLength",N);let j=d.userValue;!j||j.length<=N||(j=j.slice(0,N),k.value=d.userValue=j,t.setValue(e,{value:j}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:j,willCommit:!0,commitKey:1,selStart:k.selectionStart,selEnd:k.selectionEnd}}))}};this._dispatchEventFromSandbox(C,A)}),i.addEventListener("keydown",A=>{d.commitKey=1;let C=-1;if(A.key==="Escape"?C=0:A.key==="Enter"&&!this.data.multiLine?C=2:A.key==="Tab"&&(d.commitKey=3),C===-1)return;const{value:M}=A.target;d.lastCommittedValue!==M&&(d.lastCommittedValue=M,d.userValue=M,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,willCommit:!0,commitKey:C,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}))});const _=S;S=null,i.addEventListener("blur",A=>{if(!d.focused||!A.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:C}=A;let{value:M}=C;if(w){if(M&&p==="time"){const N=M.split(":").map(k=>parseInt(k,10));M=new Date(2e3,0,1,N[0],N[1],N[2]||0).valueOf(),C.step=""}else M.includes("T")||(M=`${M}T00:00`),M=new Date(M).valueOf();C.type="text"}d.userValue=M,d.lastCommittedValue!==M&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,willCommit:!0,commitKey:d.commitKey,selStart:A.target.selectionStart,selEnd:A.target.selectionEnd}}),_(A)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",A=>{d.lastCommittedValue=null;const{data:C,target:M}=A,{value:N,selectionStart:k,selectionEnd:j}=M;let F=k,z=j;switch(A.inputType){case"deleteWordBackward":{const H=N.substring(0,k).match(/\w*[^\w]*$/);H&&(F-=H[0].length);break}case"deleteWordForward":{const H=N.substring(k).match(/^[^\w]*\w*/);H&&(z+=H[0].length);break}case"deleteContentBackward":k===j&&(F-=1);break;case"deleteContentForward":k===j&&(z+=1);break}A.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:N,change:C||"",willCommit:!1,selStart:F,selEnd:z}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],A=>A.target.value)}if(S&&i.addEventListener("blur",S),this.data.comb){const A=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${A}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class c2 extends so{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class u2 extends so{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(i,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return no.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.setAttribute("exportValue",e.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i)){const p=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue||"Off";c.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(i,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class nx extends so{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(i,{value:a})),a)for(const c of this._getElementsByName(e.fieldName,i))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(no.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue;c.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const c=e.buttonValue;l.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const p=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const w=p&&y.id===i;y.domElement&&(y.domElement.checked=w),t.setValue(y.id,{value:w})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class h2 extends Vm{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class d2 extends so{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");no.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const w of a.options)w.selected=w.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,i.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),l=!1),a.append(y)}let c=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),a.prepend(p),c=()=>{p.remove(),a.removeEventListener("input",c),c=null},a.addEventListener("input",c)}const u=p=>{const y=p?"value":"textContent",{options:w,multiple:S}=a;return S?Array.prototype.filter.call(w,_=>_.selected).map(_=>_[y]):w.selectedIndex===-1?null:w[w.selectedIndex][y]};let d=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,w=>({displayValue:w.textContent,exportValue:w.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",p=>{const y={value(w){c?.();const S=w.detail.value,_=new Set(Array.isArray(S)?S:[S]);for(const A of a.options)A.selected=_.has(A.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(w){a.multiple=!0},remove(w){const S=a.options,_=w.detail.remove;S[_].selected=!1,a.remove(_),S.length>0&&Array.prototype.findIndex.call(S,C=>C.selected)===-1&&(S[0].selected=!0),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},clear(w){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(w){const{index:S,displayValue:_,exportValue:A}=w.detail.insert,C=a.children[S],M=document.createElement("option");M.textContent=_,M.value=A,C?C.before(M):a.append(M),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},items(w){const{items:S}=w.detail;for(;a.length!==0;)a.remove(0);for(const _ of S){const{displayValue:A,exportValue:C}=_,M=document.createElement("option");M.textContent=A,M.value=C,a.append(M)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},indices(w){const S=new Set(w.detail.indices);for(const _ of w.target.options)_.selected=S.has(_.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(w){w.target.disabled=!w.detail.editable}};this._dispatchEventFromSandbox(y,p)}),a.addEventListener("input",p=>{const y=u(!0),w=u(!1);t.setValue(e,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:w,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):a.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class cm extends Je{constructor(t){const{data:e,elements:i,parent:a}=t,l=!!a._commentManager;if(super(t,{isRenderable:!l&&Je._hasPopupData(e)}),this.elements=i,l&&Je._hasPopupData(e)){const c=this.popup=this.#t();for(const u of i)u.popup=c}else this.popup=null}#t(){return new f2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const a of this.elements)a.popup=e,a.container.ariaHasPopup="dialog",i.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(a=>`${sl}${a}`).join(",")),this.container}}class f2{#t=null;#e=this.#G.bind(this);#i=this.#I.bind(this);#n=this.#k.bind(this);#s=this.#S.bind(this);#r=null;#a=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#A=null;#w=null;#C=!1;#x=null;#_=null;constructor({container:t,color:e,elements:i,titleObj:a,modificationDate:l,contentsObj:c,richText:u,parent:d,rect:f,parentRect:p,open:y,commentManager:w=null}){this.#a=t,this.#A=a,this.#o=c,this.#E=u,this.#d=d,this.#r=e,this.#b=f,this.#h=p,this.#l=i,this.#t=w,this.#x=i[0],this.#c=nm.toDateObject(l),this.trigger=i.flatMap(S=>S.getElementsToTriggerPopup()),w||(this.#D(),this.#a.hidden=!0,y&&this.#S())}#D(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const e of this.trigger)e.addEventListener("click",this.#s,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#x.container.after(this.#p);return}if(this.#y||this.#R(),!this.#y)return;const{signal:t}=this.#m=new AbortController,e=this.#x.hasOwnCommentButton,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#x.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#x.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#M(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#M(){if(this.#x.extraPopupElement&&!this.#x.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#y,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#j(){this.#x.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#x.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}=this.#x.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#x.commentText,this.#_}set comment(t){t!==this.comment&&(this.#x.commentText=this.#_=t)}focus(){this.#x.container?.focus()}get parentBoundingClientRect(){return this.#x.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#x.layer.getBoundingClientRect();return[(t-a)/c,(e+i-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#v||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:l,y:c,width:u,height:d}=a;this.#t.showDialog(null,this,l+e*u,c+i*d,{...t,parentDimensions:a})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#r){const i=t.style.outlineColor=Ht.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#A?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#A}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}Ow({html:this.#N||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#a.append(t)}get#N(){const t=this.#E,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#L(){return this.#N?.attributes?.style?.fontSize||0}get#F(){return this.#N?.attributes?.style?.color||null}#P(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))e.push({name:"span",value:l,attributes:a});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#S()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#_=null):e&&(e.deleted?this.remove():(this.#j(),this.#_=e.text)),t&&(this.#y=null,this.#R(),this.#M());return}if(i||e?.deleted){this.remove();return}this.#D(),this.#w||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),e&&e.text&&(this.#E=this.#P(e.text),this.#c=nm.toDateObject(e.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#E}=this.#w,this.#w=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:a,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const _ of this.#l)if(!u||Ht.intersect(_.data.rect,u)!==null){u=_.data.rect,c=!0;break}const d=Ht.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=c?u[2]-u[0]+5:0,y=d[0]+p,w=d[1];this.#u=[100*(y-a)/e,100*(w-l)/i];const{style:S}=this.#a;S.left=`${this.#u[0]}%`,S.top=`${this.#u[1]}%`}#S(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#k(),this.#a.addEventListener("click",this.#s),this.#a.addEventListener("keydown",this.#e)):(this.#I(),this.#a.removeEventListener("click",this.#s),this.#a.removeEventListener("keydown",this.#e))}#k(){this.#g||this.render(),this.isVisible?this.#f&&this.#a.classList.add("focused"):(this.#T(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#I(){this.#a.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#a.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#C&&(this.#g||this.#k(),this.#C=!1,this.#a.hidden=!1))}get isVisible(){return this.#t?!1:this.#a.hidden===!1}}class ix extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=oe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class p2 extends Je{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class m2 extends Je{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",e-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class g2 extends Je{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",e/2),c.setAttribute("cy",i/2),c.setAttribute("rx",e/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class sx extends Je{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:a},width:l,height:c}=this;if(!e)return this.container;const u=this.svgFactory.create(l,c,!0);let d=[];for(let p=0,y=e.length;p<y;p+=2){const w=e[p]-t[0],S=t[3]-e[p+1];d.push(`${w},${S}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class y2 extends sx{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class b2 extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Km extends Je{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?oe.HIGHLIGHT:oe.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:a,popupRef:l}}=this,{transform:c,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",a.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let y=0,w=i.length;y<w;y++){const S=this.svgFactory.createElement(this.svgElementName);this.#e.push(S),S.setAttribute("points",i[y].join(",")),p.append(S)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:a}=t,l=this.#t;if(e>=0&&l.setAttribute("stroke-width",e||1),i)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",i[c].join(","));if(a){const{transform:c,width:u,height:d}=this.#i(this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class ax extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=oe.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class v2 extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class w2 extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class x2 extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class rx extends Je{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=oe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class S2 extends Je{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:a}=Sn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class $m{#t=null;#e=null;#i=null;#n=new Map;#s=null;#r=null;#a=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:a,page:l,viewport:c,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:p}){this.div=t,this.#t=e,this.#e=i,this.#s=u||null,this.#r=f||null,this.#i=p||new Um,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,i=this.div;eo(i,this.viewport);const a=new Map,l=[],c={data:null,layer:i,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Qh,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const d=u.annotationType===bn.POPUP;if(d){const y=a.get(u.id);if(!y)continue;if(!this._commentManager){l.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=Lp.create(c);if(!f.isRenderable)continue;if(!d&&(this.#a.push(f),u.popupRef)){const y=a.get(u.popupRef);y?y.push(f):a.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const d=c.elements=a.get(u.id);c.data=u;const f=Lp.create(c);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${sl}${u.id}`,u.hidden&&(p.style.visibility="hidden"),d.at(-1).container.after(p)}this.#l()}async#c(){if(this.#a.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:i,data:{id:a}}of this.#a){const l=i.id=`${sl}${a}`;t.push(this.#s?.getAriaAttributes(l).then(c=>{if(c)for(const[u,d]of c)i.setAttribute(u,d)}))}}this.#a.sort(({data:{rect:[i,a,l,c]}},{data:{rect:[u,d,f,p]}})=>{if(i===l&&a===c)return 1;if(u===f&&d===p)return-1;const y=c,w=a,S=(a+c)/2,_=p,A=d,C=(d+p)/2;if(S>=_&&C<=w)return-1;if(C>=y&&S<=A)return 1;const M=(i+l)/2,N=(u+f)/2;return M-N});const e=document.createDocumentFragment();for(const i of this.#a)e.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&e.append(i.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const i of this.#a)this.#t.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#r,svgFactory:new Qh,parent:this};for(const i of t){i.borderStyle||=$m._defaultBorderStyle,e.data=i;const a=Lp.create(e);a.isRenderable&&(a.render(),a.contentElement.id=`${sl}${i.id}`,this.#a.push(a))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,eo(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const a=t.querySelector(`[data-annotation-id="${e}"]`);if(!a)continue;i.className="annotationContent";const{firstChild:l}=a;l?l.nodeName==="CANVAS"?l.replaceWith(i):l.classList.contains("annotationContent")?l.after(i):l.before(i):a.append(i);const c=this.#n.get(e);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,a.id,i),c._hasNoCanvas=!1):c.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:a}=t,l=new r2({data:{id:i,rect:t.getPDFRect(),rotation:a},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return l.render(),l.contentElement.id=`${sl}${i}`,l.createOrUpdatePopup(),this.#a.push(l),l}removeAnnotation(t){const e=this.#a.findIndex(a=>a.data.id===t);if(e<0)return;const[i]=this.#a.splice(e,1);this.#t?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return ie(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:el.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Th=/\r\n?|\n/g;class Dn extends Wt{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Dn.prototype,e=l=>l.isEmpty(),i=or.TRANSLATE_SMALL,a=or.TRANSLATE_BIG;return ie(this,"_keyboardManager",new tu([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:e}]]))}static _type="freetext";static _editorType=oe.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Dn._defaultColor||Wt._defaultLineColor,this.#n=t.fontSize||Dn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){Wt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case we.FREETEXT_SIZE:Dn._defaultFontSize=e;break;case we.FREETEXT_COLOR:Dn._defaultColor=e;break}}updateParams(t,e){switch(t){case we.FREETEXT_SIZE:this.#s(e);break;case we.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[we.FREETEXT_SIZE,Dn._defaultFontSize],[we.FREETEXT_COLOR,Dn._defaultColor||Wt._defaultLineColor]]}get propertiesToUpdate(){return[[we.FREETEXT_SIZE,this.#n],[we.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new qc(this),[["colorPicker",this._colorPicker]]}get colorType(){return we.FREETEXT_COLOR}#s(t){const e=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#n)*this.parentScale),this.#n=a,this.#o()},i=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const e=a=>{this.color=a,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Dn._internalPadding*t,-(Dn._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Dn.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#a().trimEnd();if(t===e)return;const i=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Dn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,p]=this.pageDimensions,[y,w]=this.pageTranslation;let S,_;switch(this.rotation){case 0:S=t+(c[0]-y)/f,_=e+this.height-(c[1]-w)/p;break;case 90:S=t+(c[0]-y)/f,_=e-(c[1]-w)/p,[u,d]=[d,-u];break;case 180:S=t-this.width+(c[0]-y)/f,_=e-(c[1]-w)/p,[u,d]=[-u,-d];break;case 270:S=t+(c[0]-y-this.height*p)/f,_=e+(c[1]-w-this.width*f)/p,[u,d]=[-d,u];break}this.setAt(S*a,_*l,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Th,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const a=Dn.#h(e.getData("text")||"").replaceAll(Th,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:d}=c,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const S=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(Th,"")),S!==this.editorDiv){let _=f;for(const A of this.editorDiv.childNodes){if(A===S){_=p;continue}_.push(Dn.#c(A))}}f.push(u.nodeValue.slice(0,d).replaceAll(Th,""))}else if(u===this.editorDiv){let S=f,_=0;for(const A of this.editorDiv.childNodes)_++===d&&(S=p),S.push(Dn.#c(A))}this.#t=`${f.join(`
`)}${a}${p.join(`
`)}`,this.#l();const y=new Range;let w=Math.sumPrecise(f.map(S=>S.length));for(const{firstChild:S}of this.editorDiv.childNodes)if(S.nodeType===Node.TEXT_NODE){const _=S.nodeValue.length;if(w<=_){y.setStart(S,w),y.setEnd(S,w);break}w-=_}l.removeAllRanges(),l.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Dn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let a=null;if(t instanceof ix){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:f,id:p,popupRef:y,richText:w,contentsObj:S,creationDate:_,modificationDate:A},textContent:C,textPosition:M,parent:{page:{pageNumber:N}}}=t;if(!C||C.length===0)return null;a=t={annotationType:oe.FREETEXT,color:Array.from(u),fontSize:c,value:C.join(`
`),position:M,pageIndex:N-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:S?.str||null,richText:w,creationDate:_,modificationDate:A}}const l=await super.deserialize(t,e,i);return l.#n=t.fontSize,l.color=Ht.makeHexColor(...t.color),l.#t=Dn.#h(t.value),l._initialData=a,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Wt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((c,u)=>c!==a[u])||t.pageIndex!==l}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const a of this.#t.split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),e.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Gt{static PRECISION=1e-4;toSVGPath(){Me("Abstract method `toSVGPath` must be implemented.")}get box(){Me("Abstract getter `box` must be implemented.")}serialize(t,e){Me("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u]*a,c[u+1]=i+t[u+1]*l;return c}static _rescaleAndSwap(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u+1]*a,c[u+1]=i+t[u]*l;return c}static _translate(t,e,i,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l],a[l+1]=i+t[l+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,a,l){switch(l){case 90:return[1-e/i,t/a];case 180:return[1-t/i,1-e/a];case 270:return[e/i,1-t/a];default:return[t/i,e/a]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,a,l,c){return[(t+5*i)/6,(e+5*a)/6,(5*i+l)/6,(5*a+c)/6,(i+l)/2,(a+c)/2]}}class Vr{#t;#e=[];#i;#n;#s=[];#r=new Float32Array(18);#a;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=Vr.#g+Vr.#m;constructor({x:t,y:e},i,a,l,c,u=0){this.#t=i,this.#h=l*a,this.#n=c,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=Vr.#g*a,this.#c=Vr.#u*a,this.#d=a,this.#f.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#p(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,a,l,c]=this.#t;return[(this.#a+(t[0]-e[0])/2-i)/l,(this.#o+(t[1]-e[1])/2-a)/c,(this.#a+(e[0]-t[0])/2-i)/l,(this.#o+(e[1]-t[1])/2-a)/c]}add({x:t,y:e}){this.#a=t,this.#o=e;const[i,a,l,c]=this.#t;let[u,d,f,p]=this.#r.subarray(8,12);const y=t-f,w=e-p,S=Math.hypot(y,w);if(S<this.#c)return!1;const _=S-this.#l,A=_/S,C=A*y,M=A*w;let N=u,k=d;u=f,d=p,f+=C,p+=M,this.#f?.push(t,e);const j=-M/_,F=C/_,z=j*this.#h,H=F*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+z,p+H],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-z,p-H],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([u+z,d+H],2),this.#s.push(NaN,NaN,NaN,NaN,(u+z-i)/l,(d+H-a)/c),this.#r.set([u-z,d-H],14),this.#e.push(NaN,NaN,NaN,NaN,(u-z-i)/l,(d-H-a)/c)),this.#r.set([N,k,u,d,f,p],6),!this.isEmpty()):(this.#r.set([N,k,u,d,f,p],6),Math.abs(Math.atan2(k-d,N-u)-Math.atan2(M,C))<Math.PI/2?([u,d,f,p]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((u+f)/2-i)/l,((d+p)/2-a)/c),[u,d,N,k]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((N+u)/2-i)/l,((k+d)/2-a)/c),!0):([N,k,u,d,f,p]=this.#r.subarray(0,6),this.#s.push(((N+5*u)/6-i)/l,((k+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+p)/6-a)/c,((u+f)/2-i)/l,((d+p)/2-a)/c),[f,p,u,d,N,k]=this.#r.subarray(12,18),this.#e.push(((N+5*u)/6-i)/l,((k+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+p)/6-a)/c,((u+f)/2-i)/l,((d+p)/2-a)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?i.push(`L${t[a+4]} ${t[a+5]}`):i.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#b(i);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?i.push(`L${e[a+4]} ${e[a+5]}`):i.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return this.#v(i),i.join(" ")}#y(){const[t,e,i,a]=this.#t,[l,c,u,d]=this.#p();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/a} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/a} L${l} ${c} L${u} ${d} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/a} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/a} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,i,a,l]=this.#t,c=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[d,f,p,y]=this.#p();t.push(`L${(c[0]-e)/a} ${(c[1]-i)/l} L${d} ${f} L${p} ${y} L${(u[0]-e)/a} ${(u[1]-i)/l}`)}newFreeDrawOutline(t,e,i,a,l,c){return new ox(t,e,i,a,l,c)}getOutlines(){const t=this.#s,e=this.#e,i=this.#r,[a,l,c,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let y=0,w=d.length-2;y<w;y+=2)d[y]=(this.#f[y]-a)/c,d[y+1]=(this.#f[y+1]-l)/u;if(d[d.length-2]=(this.#a-a)/c,d[d.length-1]=(this.#o-l)/u,isNaN(i[6])&&!this.isEmpty())return this.#E(d);const f=new Float32Array(this.#s.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#w(f,p);for(let y=e.length-6;y>=6;y-=6)for(let w=0;w<6;w+=2){if(isNaN(e[y+w])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[y+w],f[p+1]=e[y+w+1],p+=2}return this.#A(f,p),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#n)}#E(t){const e=this.#r,[i,a,l,c]=this.#t,[u,d,f,p]=this.#p(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-i)/l,(e[3]-a)/c,NaN,NaN,NaN,NaN,(e[4]-i)/l,(e[5]-a)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-i)/l,(e[17]-a)/c,NaN,NaN,NaN,NaN,(e[14]-i)/l,(e[15]-a)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#i,this.#n)}#A(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#w(t,e){const i=this.#r.subarray(4,6),a=this.#r.subarray(16,18),[l,c,u,d]=this.#t,[f,p,y,w]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-c)/d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,w,NaN,NaN,NaN,NaN,(a[0]-l)/u,(a[1]-c)/d],e),e+=24}}class ox extends Gt{#t;#e=new Float32Array(4);#i;#n;#s;#r;#a;constructor(t,e,i,a,l,c){super(),this.#a=t,this.#s=e,this.#t=i,this.#r=a,this.#i=l,this.#n=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,d,f,p]=this.#e;for(let y=0,w=t.length;y<w;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-d)/p;for(let y=0,w=e.length;y<w;y+=2)e[y]=(e[y]-u)/f,e[y+1]=(e[y+1]-d)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,i=this.#a.length;e<i;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,a],l){const c=i-t,u=a-e;let d,f;switch(l){case 0:d=Gt._rescale(this.#a,t,a,c,-u),f=Gt._rescale(this.#s,t,a,c,-u);break;case 90:d=Gt._rescaleAndSwap(this.#a,t,e,c,u),f=Gt._rescaleAndSwap(this.#s,t,e,c,u);break;case 180:d=Gt._rescale(this.#a,i,e,-c,u),f=Gt._rescale(this.#s,i,e,-c,u);break;case 270:d=Gt._rescaleAndSwap(this.#a,i,a,-c,-u),f=Gt._rescaleAndSwap(this.#s,i,a,-c,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#a;let i=e[4],a=e[5];const l=[i,a,i,a];let c=i,u=a,d=i,f=a;const p=t?Math.max:Math.min,y=new Float32Array(4);for(let S=6,_=e.length;S<_;S+=6){const A=e[S+4],C=e[S+5];isNaN(e[S])?(Ht.pointBoundingBox(A,C,l),u>C?(c=A,u=C):u===C&&(c=p(c,A)),f<C?(d=A,f=C):f===C&&(d=p(d,A))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,Ht.bezierBoundingBox(i,a,...e.slice(S,S+6),y),Ht.rectBoundingBox(y[0],y[1],y[2],y[3],l),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=p(c,y[0])),f<y[3]?(d=y[2],f=y[3]):f===y[3]&&(d=p(d,y[2]))),i=A,a=C}const w=this.#e;w[0]=l[0]-this.#i,w[1]=l[1]-this.#i,w[2]=l[2]-l[0]+2*this.#i,w[3]=l[3]-l[1]+2*this.#i,this.firstPoint=[c,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,i,a,l,c=0){return new Vr(t,e,i,a,l,c)}getNewOutline(t,e){const[i,a,l,c]=this.#e,[u,d,f,p]=this.#t,y=l*f,w=c*p,S=i*f+u,_=a*p+d,A=this.newOutliner({x:this.#s[0]*y+S,y:this.#s[1]*w+_},this.#t,this.#r,t,this.#n,e??this.#i);for(let C=2;C<this.#s.length;C+=2)A.add({x:this.#s[C]*y+S,y:this.#s[C+1]*w+_});return A.getOutlines()}}class um{#t;#e;#i;#n=[];#s=[];constructor(t,e=0,i=0,a=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:A,y:C,width:M,height:N}of t){const k=Math.floor((A-e)/c)*c,j=Math.ceil((A+M+e)/c)*c,F=Math.floor((C-e)/c)*c,z=Math.ceil((C+N+e)/c)*c,H=[k,F,z,!0],ct=[j,F,z,!1];this.#n.push(H,ct),Ht.rectBoundingBox(k,F,j,z,l)}const u=l[2]-l[0]+2*i,d=l[3]-l[1]+2*i,f=l[0]-i,p=l[1]-i;let y=a?-1/0:1/0,w=1/0;const S=this.#n.at(a?-1:-2),_=[S[0],S[2]];for(const A of this.#n){const[C,M,N,k]=A;!k&&a?M<w?(w=M,y=C):M===w&&(y=Math.max(y,C)):k&&!a&&(M<w?(w=M,y=C):M===w&&(y=Math.min(y,C))),A[0]=(C-f)/u,A[1]=(M-p)/d,A[2]=(N-p)/d}this.#t=new Float32Array([f,p,u,d]),this.#e=[y,w],this.#i=_}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],i=new Set;for(const c of t){const[u,d,f]=c;e.push([u,d,c],[u,f,c])}e.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=e.length;c<u;c+=2){const d=e[c][2],f=e[c+1][2];d.push(f),f.push(d),i.add(d),i.add(f)}const a=[];let l;for(;i.size>0;){const c=i.values().next().value;let[u,d,f,p,y]=c;i.delete(c);let w=u,S=d;for(l=[u,f],a.push(l);;){let _;if(i.has(p))_=p;else if(i.has(y))_=y;else break;i.delete(_),[u,d,f,p,y]=_,w!==u&&(l.push(w,S,u,S===d?d:f),w=u),S=S===d?f:d}l.push(w,S)}return new A2(a,this.#t,this.#e,this.#i)}#a(t){const e=this.#s;let i=0,a=e.length-1;for(;i<=a;){const l=i+a>>1,c=e[l][0];if(c===t)return l;c<t?i=l+1:a=l-1}return a+1}#o([,t,e]){const i=this.#a(t);this.#s.splice(i,0,[t,e])}#c([,t,e]){const i=this.#a(t);for(let a=i;a<this.#s.length;a++){const[l,c]=this.#s[a];if(l!==t)break;if(l===t&&c===e){this.#s.splice(a,1);return}}for(let a=i-1;a>=0;a--){const[l,c]=this.#s[a];if(l!==t)break;if(l===t&&c===e){this.#s.splice(a,1);return}}}#l(t){const[e,i,a]=t,l=[[e,i,a]],c=this.#a(a);for(let u=0;u<c;u++){const[d,f]=this.#s[u];for(let p=0,y=l.length;p<y;p++){const[,w,S]=l[p];if(!(f<=w||S<=d)){if(w>=d){if(S>f)l[p][1]=f;else{if(y===1)return[];l.splice(p,1),p--,y--}continue}l[p][2]=d,S>f&&l.push([e,f,S])}}}return l}}class A2 extends Gt{#t;#e;constructor(t,e,i,a){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=a}toSVGPath(){const t=[];for(const e of this.#e){let[i,a]=e;t.push(`M${i} ${a}`);for(let l=2;l<e.length;l+=2){const c=e[l],u=e[l+1];c===i?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${c}`),i=c)}t.push("Z")}return t.join(" ")}serialize([t,e,i,a],l){const c=[],u=i-t,d=a-e;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=a-f[y+1]*d;c.push(p)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class hm extends Vr{newFreeDrawOutline(t,e,i,a,l,c){return new E2(t,e,i,a,l,c)}}class E2 extends ox{newOutliner(t,e,i,a,l,c=0){return new hm(t,e,i,a,l,c)}}class cn extends Wt{#t=null;#e=0;#i;#n=null;#s=null;#r=null;#a=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=oe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=cn.prototype;return ie(this,"_keyboardManager",new tu([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||cn._defaultColor,this.#p=t.thickness||cn._defaultThickness,this.opacity=t.opacity||cn._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#x()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#x(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new um(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new um(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:a}=this.#r;this.#g=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const a=1.5;if(this.#r=t.getNewOutline(this.#p/2+a,.0025),e>=0)this.#d=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:cn.#_(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:cn.#_(this.#r.box,y),path:{d:this.#r.toSVGPath()}})}const[l,c,u,d]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=d;break;case 90:{const[y,w]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*w/y,this.height=d*y/w;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=d;break;case 270:{const[y,w]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*w/y,this.height=d*y/w;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/d];const{lastPoint:p}=this.#r;this.#g=[(p[0]-l)/u,(p[1]-c)/d]}static initialize(t,e){Wt.initialize(t,e),cn._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case we.HIGHLIGHT_COLOR:cn._defaultColor=e;break;case we.HIGHLIGHT_THICKNESS:cn._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case we.HIGHLIGHT_COLOR:this.#E(e);break;case we.HIGHLIGHT_THICKNESS:this.#A(e);break}}static get defaultPropertiesToUpdate(){return[[we.HIGHLIGHT_COLOR,cn._defaultColor],[we.HIGHLIGHT_THICKNESS,cn._defaultThickness]]}get propertiesToUpdate(){return[[we.HIGHLIGHT_COLOR,this.color||cn._defaultColor],[we.HIGHLIGHT_THICKNESS,this.#p||cn._defaultThickness],[we.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#s?.updateColor(this.color),super.onUpdatedColor()}#E(t){const e=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},i=this.color,a=this.opacity;this.addCommands({cmd:e.bind(this,t,cn._defaultOpacity),undo:e.bind(this,i,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#A(t){const e=this.#p,i=a=>{this.#p=a,this.#w(a)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new ex({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#M())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#x(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#x(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#w(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#x(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#_([t,e,i,a],l){switch(l){case 90:return[1-e-a,t,a,i];case 180:return[1-t-i,1-e-a,i,a];case 270:return[e,1-t-i,a,i]}return[t,e,i,a]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=cn.#_(this.#l.box,t)):i=cn.#_([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#m,{bbox:cn.#_(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),kw(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#D(t){cn._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#M(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[t,e]=this.pageDimensions,[i,a]=this.pageTranslation,l=this.#i,c=new Float32Array(l.length*8);let u=0;for(const{x:d,y:f,width:p,height:y}of l){const w=d*t+i,S=(1-f)*e+a;c[u]=c[u+4]=w,c[u+1]=c[u+3]=S,c[u+2]=c[u+6]=w+p*t,c[u+5]=c[u+7]=S-y*e,u+=8}return c}#N(t){return this.#l.serialize(t,this.#M())}static startHighlighting(t,e,{target:i,x:a,y:l}){const{x:c,y:u,width:d,height:f}=i.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),w=S=>{p.abort(),this.#F(t,S)};window.addEventListener("blur",w,{signal:y}),window.addEventListener("pointerup",w,{signal:y}),window.addEventListener("pointerdown",nn,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",$i,{signal:y}),i.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new hm({x:a,y:l},[c,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let a=null;if(t instanceof ax){const{data:{quadPoints:_,rect:A,rotation:C,id:M,color:N,opacity:k,popupRef:j,richText:F,contentsObj:z,creationDate:H,modificationDate:ct},parent:{page:{pageNumber:dt}}}=t;a=t={annotationType:oe.HIGHLIGHT,color:Array.from(N),opacity:k,quadPoints:_,boxes:null,pageIndex:dt-1,rect:A.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,popupRef:j,richText:F,comment:z?.str||null,creationDate:H,modificationDate:ct}}else if(t instanceof Km){const{data:{inkLists:_,rect:A,rotation:C,id:M,color:N,borderStyle:{rawWidth:k},popupRef:j,richText:F,contentsObj:z,creationDate:H,modificationDate:ct},parent:{page:{pageNumber:dt}}}=t;a=t={annotationType:oe.HIGHLIGHT,color:Array.from(N),thickness:k,inkLists:_,boxes:null,pageIndex:dt-1,rect:A.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,popupRef:j,richText:F,comment:z?.str||null,creationDate:H,modificationDate:ct}}const{color:l,quadPoints:c,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,i);f.color=Ht.makeHexColor(...l),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[p,y]=f.pageDimensions,[w,S]=f.pageTranslation;if(c){const _=f.#i=[];for(let A=0;A<c.length;A+=8)_.push({x:(c[A]-w)/p,y:1-(c[A+1]-S)/y,width:(c[A+2]-c[A])/p,height:(c[A+1]-c[A+5])/y});f.#v(),f.#x(),f.rotate(f.rotation)}else if(u){f.#h=!0;const _=u[0],A={x:_[0]-w,y:y-(_[1]-S)},C=new hm(A,[0,0,p,y],1,f.#p/2,!0,.001);for(let k=0,j=_.length;k<j;k+=2)A.x=_[k]-w,A.y=y-(_[k+1]-S),C.add(A);const{id:M,clipPathId:N}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);f.#b({highlightOutlines:C.getOutlines(),highlightId:M,clipPathId:N}),f.#x(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Wt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#N(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#P(i)?null:(i.id=this.annotationElementId,i)}#P(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,a)=>i!==e[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class lx{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Me("Not implemented")}}class _e extends Wt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#s=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#a(t,this.parent),this.#h(t.box)}#a(t,e){const{id:i}=e.drawLayer.draw(_e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[a,l]of Object.entries(e))i.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){Me("Not implemented")}static get typesMap(){Me("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(_e.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,a]of this.typesMap)t.push([i,e[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,a]of this.constructor.typesMap)t.push([i,e[a]]);return t}_updateProperty(t,e,i){const a=this._drawingOptions,l=a[e],c=u=>{a.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#a(this.#t,t)}}#l([t,e,i,a]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(c/l),a*(l/c)];case 180:return[1-t,1-e,i,a];case 270:return[1-e,t,i*(c/l),a*(l/c)];default:return[t,e,i,a]}}#d(){const{x:t,y:e,width:i,height:a,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(l/c),a*(c/l)];case 180:return[1-t,1-e,i,a];case 270:return[e,1-t,i*(l/c),a*(c/l)];default:return[t,e,i,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:i,height:a,rotation:l,parentRotation:c,parentDimensions:[u,d]}=this;switch((l*4+c)/90){case 1:return[1-e-a,t,a,i];case 2:return[1-t-i,1-e-a,i,a];case 3:return[e,1-t-i,a,i];case 4:return[t,e-i*(u/d),a*(d/u),i*(u/d)];case 5:return[1-e,t,i*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-e,a*(d/u),i*(u/d)];case 7:return[e-i*(u/d),1-t-a*(d/u),i*(u/d),a*(d/u)];case 8:return[t-i,e-a,i,a];case 9:return[1-e,t-i,a,i];case 10:return[1-t,1-e,i,a];case 11:return[e-a,1-t,a,i];case 12:return[t-a*(d/u),e,a*(d/u),i*(u/d)];case 13:return[1-e-i*(u/d),t-a*(d/u),i*(u/d),a*(d/u)];case 14:return[1-t,1-e-i*(u/d),a*(d/u),i*(u/d)];case 15:return[e,1-t,i*(u/d),a*(d/u)];default:return[t,e,i,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const a=document.createElement("div");return i.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,a,l){Me("Not implemented")}static startDrawing(t,e,i,a){const{target:l,offsetX:c,offsetY:u,pointerId:d,pointerType:f}=a;if(Te.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=t,{width:y,height:w}=l.getBoundingClientRect(),S=_e.#n=new AbortController,_=t.combinedSignal(S);if(Te.setPointer(f,d),window.addEventListener("pointerup",A=>{Te.isSamePointerIdOrRemove(A.pointerId)&&this._endDraw(A)},{signal:_}),window.addEventListener("pointercancel",A=>{Te.isSamePointerIdOrRemove(A.pointerId)&&this._currentParent.endDrawingSession()},{signal:_}),window.addEventListener("pointerdown",A=>{Te.isSamePointerType(A.pointerType)&&(Te.initializeAndAddPointerId(A.pointerId),_e.#i.isCancellable()&&(_e.#i.removeLastElement(),_e.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",$i,{signal:_}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),l.addEventListener("touchmove",A=>{Te.isSameTimeStamp(A.timeStamp)&&nn(A)},{signal:_}),t.toggleDrawing(),e._editorUndoBar?.hide(),_e.#i){t.drawLayer.updateProperties(this._currentDrawId,_e.#i.startNew(c,u,y,w,p));return}e.updateUIForDefaultProperties(this),_e.#i=this.createDrawerInstance(c,u,y,w,p),_e.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(_e.#s.toSVGProperties(),_e.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Te.isSameTimeStamp(t.timeStamp),!_e.#i)return;const{offsetX:e,offsetY:i,pointerId:a}=t;if(Te.isSamePointerId(a)){if(Te.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,_e.#i.add(e,i)),Te.setTimeStamp(t.timeStamp),nn(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_e.#i=null,_e.#s=null,Te.clearTimeStamp()),_e.#n&&(_e.#n.abort(),_e.#n=null,Te.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,_e.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=_e.#i,a=this._currentDrawId,l=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(a,i.setLastElement(l))},undo:()=>{e.drawLayer.updateProperties(a,i.removeLastElement())},mustExec:!1,type:we.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(we.DRAW_STEP),!_e.#i.isEmpty()){const{pageDimensions:[i,a],scale:l}=e,c=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:_e.#i.getOutlines(i*l,a*l,l,this._INNER_MARGIN),drawingOptions:_e.#s,mustBeCommitted:!t});return this._cleanup(!0),c}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,a,l,c){Me("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:u}}=e.viewport,d=this.deserializeDraw(c,u,a,l,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#r({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[a,l]=this.pageDimensions;return this.#t.serialize([e,i,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class _2{#t=new Float64Array(6);#e;#i;#n;#s;#r;#a="";#o=0;#c=new eu;#l;#d;constructor(t,e,i,a,l,c){this.#l=i,this.#d=a,this.#n=l,this.#s=c,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#h(t,e){return Gt._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#h(t,e);const[i,a,l,c]=this.#t.subarray(2,6),u=t-l,d=e-c;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([l,c,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,a,l,c,t,e],0),this.#e.push(...Gt.createBezierPoints(i,a,l,c,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,a,l){this.#l=i,this.#d=a,this.#n=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:c,points:this.#r}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#a="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:a}=this.#i[t];this.#e=i,this.#r=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=Gt.svgRound(this.#e[4]),e=Gt.svgRound(this.#e[5]);if(this.#r.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#r.length<=6){const a=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,a)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const a=Gt.svgRound(this.#e[10]),l=Gt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${a} ${l}`,this.#o=12,this.#a}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let a=this.#o,l=this.#e.length;a<l;a+=6){const[c,u,d,f,p,y]=this.#e.slice(a,a+6).map(Gt.svgRound);i.push(`C${c} ${u} ${d} ${f} ${p} ${y}`)}return this.#a+=i.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,i,a){const l=this.#i.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#i,t,e,i,this.#n,this.#s,a),this.#t=null,this.#e=null,this.#i=null,this.#a=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class eu extends Gt{#t;#e=0;#i;#n;#s;#r;#a;#o;#c;build(t,e,i,a,l,c,u){this.#s=e,this.#r=i,this.#a=a,this.#o=l,this.#c=c,this.#i=u??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${Gt.svgRound(e[4])} ${Gt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Gt.svgRound(e[10])} ${Gt.svgRound(e[11])}`);continue}for(let i=6,a=e.length;i<a;i+=6){const[l,c,u,d,f,p]=e.subarray(i,i+6).map(Gt.svgRound);t.push(`C${l} ${c} ${u} ${d} ${f} ${p}`)}}return t.join("")}serialize([t,e,i,a],l){const c=[],u=[],[d,f,p,y]=this.#d();let w,S,_,A,C,M,N,k,j;switch(this.#o){case 0:j=Gt._rescale,w=t,S=e+a,_=i,A=-a,C=t+d*i,M=e+(1-f-y)*a,N=t+(d+p)*i,k=e+(1-f)*a;break;case 90:j=Gt._rescaleAndSwap,w=t,S=e,_=i,A=a,C=t+f*i,M=e+d*a,N=t+(f+y)*i,k=e+(d+p)*a;break;case 180:j=Gt._rescale,w=t+i,S=e,_=-i,A=a,C=t+(1-d-p)*i,M=e+f*a,N=t+(1-d)*i,k=e+(f+y)*a;break;case 270:j=Gt._rescaleAndSwap,w=t+i,S=e+a,_=-i,A=-a,C=t+(1-f-y)*i,M=e+(1-d-p)*a,N=t+(1-f)*i,k=e+(1-d)*a;break}for(const{line:F,points:z}of this.#n)c.push(j(F,w,S,_,A,l?new Array(F.length):null)),u.push(j(z,w,S,_,A,l?new Array(z.length):null));return{lines:c,points:u,rect:[C,M,N,k]}}static deserialize(t,e,i,a,l,{paths:{lines:c,points:u},rotation:d,thickness:f}){const p=[];let y,w,S,_,A;switch(d){case 0:A=Gt._rescale,y=-t/i,w=e/a+1,S=1/i,_=-1/a;break;case 90:A=Gt._rescaleAndSwap,y=-e/a,w=-t/i,S=1/a,_=1/i;break;case 180:A=Gt._rescale,y=t/i+1,w=-e/a,S=-1/i,_=1/a;break;case 270:A=Gt._rescaleAndSwap,y=e/a+1,w=t/i+1,S=-1/a,_=-1/i;break}if(!c){c=[];for(const M of u){const N=M.length;if(N===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,M[0],M[1]]));continue}if(N===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,M[0],M[1],NaN,NaN,NaN,NaN,M[2],M[3]]));continue}const k=new Float32Array(3*(N-2));c.push(k);let[j,F,z,H]=M.subarray(0,4);k.set([NaN,NaN,NaN,NaN,j,F],0);for(let ct=4;ct<N;ct+=2){const dt=M[ct],Tt=M[ct+1];k.set(Gt.createBezierPoints(j,F,z,H,dt,Tt),(ct-2)*3),[j,F,z,H]=[z,H,dt,Tt]}}}for(let M=0,N=c.length;M<N;M++)p.push({line:A(c[M].map(k=>k??NaN),y,w,S,_),points:A(u[M].map(k=>k??NaN),y,w,S,_)});const C=new this.prototype.constructor;return C.build(p,i,a,1,d,f,l),C}#l(t=this.#c){const e=this.#i+t/2*this.#a;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#d(){const[t,e,i,a]=this.#t,[l,c]=this.#l(0);return[t+l,e+c,i-2*l,a-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#n){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)Ht.pointBoundingBox(a[u],a[u+1],t);continue}let l=a[4],c=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,p,y,w,S,_]=a.subarray(u,u+6);Ht.bezierBoundingBox(l,c,f,p,y,w,S,_,t),l=S,c=_}}const[e,i]=this.#l();t[0]=Un(t[0]-e,0,1),t[1]=Un(t[1]-i,0,1),t[2]=Un(t[2]+e,0,1),t[3]=Un(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[a,l]=this.#l(),[c,u]=[a-e,l-i],d=this.#t;return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateParentDimensions([t,e],i){const[a,l]=this.#l();this.#s=t,this.#r=e,this.#a=i;const[c,u]=this.#l(),d=c-a,f=u-l,p=this.#t;return p[0]-=d,p[1]-=f,p[2]+=2*d,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Gt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,a=0,l=0,c=0,u=0,d=0;switch(this.#e){case 90:a=e/t,l=-t/e,u=t;break;case 180:i=-1,c=-1,u=t,d=e;break;case 270:a=-e/t,l=t/e,d=e;break;default:return""}return`matrix(${i} ${a} ${l} ${c} ${Gt.svgRound(u)} ${Gt.svgRound(d)})`}getPathResizingSVGProperties([t,e,i,a]){const[l,c]=this.#l(),[u,d,f,p]=this.#t;if(Math.abs(f-l)<=Gt.PRECISION||Math.abs(p-c)<=Gt.PRECISION){const A=t+i/2-(u+f/2),C=e+a/2-(d+p/2);return{path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${A} ${C})`}}}const y=(i-2*l)/(f-2*l),w=(a-2*c)/(p-2*c),S=f/i,_=p/a;return{path:{"transform-origin":`${Gt.svgRound(u)} ${Gt.svgRound(d)}`,transform:`${this.rotationTransform} scale(${S} ${_}) translate(${Gt.svgRound(l)} ${Gt.svgRound(c)}) scale(${y} ${w}) translate(${Gt.svgRound(-l)} ${Gt.svgRound(-c)})`}}}getPathResizedSVGProperties([t,e,i,a]){const[l,c]=this.#l(),u=this.#t,[d,f,p,y]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=a,Math.abs(p-l)<=Gt.PRECISION||Math.abs(y-c)<=Gt.PRECISION){const C=t+i/2-(d+p/2),M=e+a/2-(f+y/2);for(const{line:N,points:k}of this.#n)Gt._translate(N,C,M,N),Gt._translate(k,C,M,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const w=(i-2*l)/(p-2*l),S=(a-2*c)/(y-2*c),_=-w*(d+l)+t+l,A=-S*(f+c)+e+c;if(w!==1||S!==1||_!==0||A!==0)for(const{line:C,points:M}of this.#n)Gt._rescale(C,_,A,w,S,C),Gt._rescale(M,_,A,w,S,M);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[a,l]=i,c=this.#t,u=t-c[0],d=e-c[1];if(this.#s===a&&this.#r===l)for(const{line:f,points:p}of this.#n)Gt._translate(f,u,d,f),Gt._translate(p,u,d,p);else{const f=this.#s/a,p=this.#r/l;this.#s=a,this.#r=l;for(const{line:y,points:w}of this.#n)Gt._rescale(y,u,d,f,p,y),Gt._rescale(w,u,d,f,p,w);c[2]*=f,c[3]*=p}return c[0]=t,c[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t[0])} ${Gt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class bd extends lx{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Wt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new bd(this._viewParameters);return t.updateAll(this),t}}class Xm extends _e{static _type="ink";static _editorType=oe.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Wt.initialize(t,e),this._defaultDrawingOptions=new bd(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return ie(this,"typesMap",new Map([[we.INK_THICKNESS,"stroke-width"],[we.INK_COLOR,"stroke"],[we.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,a,l){return new _2(t,e,i,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,a,l,c){return eu.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){let a=null;if(t instanceof Km){const{data:{inkLists:c,rect:u,rotation:d,id:f,color:p,opacity:y,borderStyle:{rawWidth:w},popupRef:S,richText:_,contentsObj:A,creationDate:C,modificationDate:M},parent:{page:{pageNumber:N}}}=t;a=t={annotationType:oe.INK,color:Array.from(p),thickness:w,opacity:y,paths:{points:c},boxes:null,pageIndex:N-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:S,richText:_,comment:A?.str||null,creationDate:C,modificationDate:M}}const l=await super.deserialize(t,e,i);return l._initialData=a,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new qc(this),[["colorPicker",this._colorPicker]]}get colorType(){return we.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=Xm.getDefaultDrawingOptions({stroke:Ht.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:Wt._colorManager.convert(a),opacity:l,thickness:c,paths:{lines:e,points:i}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==e[u])||t.thickness!==i||t.opacity!==a||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class dm extends eu{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Rh=8,Mc=3;class il{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,a){return i-=t,a-=e,i===0?a>0?0:4:i===1?a+6:2-a}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const p=(-f+d-u+16)%8,y=this.#i[2*p],w=this.#i[2*p+1];if(t[(i+y)*e+(a+w)]!==0)return p}return-1}static#s(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const p=(f+d+u+16)%8,y=this.#i[2*p],w=this.#i[2*p+1];if(t[(i+y)*e+(a+w)]!==0)return p}return-1}static#r(t,e,i,a){const l=t.length,c=new Int32Array(l);for(let p=0;p<l;p++)c[p]=t[p]<=a?1:0;for(let p=1;p<i-1;p++)c[p*e]=c[p*e+e-1]=0;for(let p=0;p<e;p++)c[p]=c[e*i-1-p]=0;let u=1,d;const f=[];for(let p=1;p<i-1;p++){d=1;for(let y=1;y<e-1;y++){const w=p*e+y,S=c[w];if(S===0)continue;let _=p,A=y;if(S===1&&c[w-1]===0)u+=1,A-=1;else if(S>=1&&c[w+1]===0)u+=1,A+=1,S>1&&(d=S);else{S!==1&&(d=Math.abs(S));continue}const C=[y,p],M=A===y+1,N={isHole:M,points:C,id:u,parent:0};f.push(N);let k;for(const xt of f)if(xt.id===d){k=xt;break}k?k.isHole?N.parent=M?k.parent:d:N.parent=M?d:k.parent:N.parent=M?d:0;const j=this.#n(c,e,p,y,_,A,0);if(j===-1){c[w]=-u,c[w]!==1&&(d=Math.abs(c[w]));continue}let F=this.#i[2*j],z=this.#i[2*j+1];const H=p+F,ct=y+z;_=H,A=ct;let dt=p,Tt=y;for(;;){const xt=this.#s(c,e,dt,Tt,_,A,1);F=this.#i[2*xt],z=this.#i[2*xt+1];const Nt=dt+F,At=Tt+z;C.push(At,Nt);const Rt=dt*e+Tt;if(c[Rt+1]===0?c[Rt]=-u:c[Rt]===1&&(c[Rt]=u),Nt===p&&At===y&&dt===H&&Tt===ct){c[w]!==1&&(d=Math.abs(c[w]));break}else _=dt,A=Tt,dt=Nt,Tt=At}}}return f}static#a(t,e,i,a){if(i-e<=4){for(let H=e;H<i-2;H+=2)a.push(t[H],t[H+1]);return}const l=t[e],c=t[e+1],u=t[i-4]-l,d=t[i-3]-c,f=Math.hypot(u,d),p=u/f,y=d/f,w=p*c-y*l,S=d/u,_=1/f,A=Math.atan(S),C=Math.cos(A),M=Math.sin(A),N=_*(Math.abs(C)+Math.abs(M)),k=_*(1-N+N**2),j=Math.max(Math.atan(Math.abs(M+C)*k),Math.atan(Math.abs(M-C)*k));let F=0,z=e;for(let H=e+2;H<i-2;H+=2){const ct=Math.abs(w-p*t[H+1]+y*t[H]);ct>F&&(z=H,F=ct)}F>(f*j)**2?(this.#a(t,e,z+2,a),this.#a(t,z,i,a)):a.push(l,c)}static#o(t){const e=[],i=t.length;return this.#a(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,a,l,c){const u=new Float32Array(c**2),d=-2*a**2,f=c>>1;for(let A=0;A<c;A++){const C=(A-f)**2;for(let M=0;M<c;M++)u[A*c+M]=Math.exp((C+(M-f)**2)/d)}const p=new Float32Array(256),y=-2*l**2;for(let A=0;A<256;A++)p[A]=Math.exp(A**2/y);const w=t.length,S=new Uint8Array(w),_=new Uint32Array(256);for(let A=0;A<i;A++)for(let C=0;C<e;C++){const M=A*e+C,N=t[M];let k=0,j=0;for(let z=0;z<c;z++){const H=A+z-f;if(!(H<0||H>=i))for(let ct=0;ct<c;ct++){const dt=C+ct-f;if(dt<0||dt>=e)continue;const Tt=t[H*e+dt],xt=u[z*c+ct]*p[Math.abs(Tt-N)];k+=Tt*xt,j+=xt}}const F=S[M]=Math.round(k/j);_[F]++}return[S,_]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let a=-1/0,l=1/0;for(let u=0,d=i.length;u<d;u++){const f=i[u]=t[u<<2];a=Math.max(a,f),l=Math.min(l,f)}const c=255/(a-l);for(let u=0,d=i.length;u<d;u++)i[u]=(i[u]-l)*c;return i}static#h(t){let e,i=-1/0,a=-1/0;const l=t.findIndex(d=>d!==0);let c=l,u=l;for(e=l;e<256;e++){const d=t[e];d>i&&(e-c>a&&(a=e-c,u=e-1),i=d,c=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:a}=t,{maxDim:l}=this.#t;let c=i,u=a;if(i>l||a>l){let w=i,S=a,_=Math.log2(Math.max(i,a)/l);const A=Math.floor(_);_=_===A?A-1:A;for(let M=0;M<_;M++){c=Math.ceil(w/2),u=Math.ceil(S/2);const N=new OffscreenCanvas(c,u);N.getContext("2d").drawImage(t,0,0,w,S,0,0,c,u),w=c,S=u,t!==e&&t.close(),t=N.transferToImageBitmap()}const C=Math.min(l/c,l/u);c=Math.round(c*C),u=Math.round(u*C)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const p=f.getImageData(0,0,c,u).data;return[this.#d(p),c,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:a},l,c,u,d){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,w=p.font=`${i} ${a} ${y}px ${e}`,{actualBoundingBoxLeft:S,actualBoundingBoxRight:_,actualBoundingBoxAscent:A,actualBoundingBoxDescent:C,fontBoundingBoxAscent:M,fontBoundingBoxDescent:N,width:k}=p.measureText(t),j=1.5,F=Math.ceil(Math.max(Math.abs(S)+Math.abs(_)||0,k)*j),z=Math.ceil(Math.max(Math.abs(A)+Math.abs(C)||y,Math.abs(M)+Math.abs(N)||y)*j);f=new OffscreenCanvas(F,z),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=w,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,F,z),p.fillStyle="black",p.fillText(t,F*(j-1)/2,z*(3-j)/2);const H=this.#d(p.getImageData(0,0,F,z).data),ct=this.#l(H),dt=this.#h(ct),Tt=this.#r(H,F,z,dt);return this.processDrawnLines({lines:{curves:Tt,width:F,height:z},pageWidth:l,pageHeight:c,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,i,a,l){const[c,u,d]=this.#f(t),[f,p]=this.#c(c,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(p),w=this.#r(f,u,d,y);return this.processDrawnLines({lines:{curves:w,width:u,height:d},pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:c,areContours:u}){a%180!==0&&([e,i]=[i,e]);const{curves:d,width:f,height:p}=t,y=t.thickness??0,w=[],S=Math.min(e/f,i/p),_=S/e,A=S/i,C=[];for(const{points:N}of d){const k=c?this.#o(N):N;if(!k)continue;C.push(k);const j=k.length,F=new Float32Array(j),z=new Float32Array(3*(j===2?2:j-2));if(w.push({line:z,points:F}),j===2){F[0]=k[0]*_,F[1]=k[1]*A,z.set([NaN,NaN,NaN,NaN,F[0],F[1]],0);continue}let[H,ct,dt,Tt]=k;H*=_,ct*=A,dt*=_,Tt*=A,F.set([H,ct,dt,Tt],0),z.set([NaN,NaN,NaN,NaN,H,ct],0);for(let xt=4;xt<j;xt+=2){const Nt=F[xt]=k[xt]*_,At=F[xt+1]=k[xt+1]*A;z.set(Gt.createBezierPoints(H,ct,dt,Tt,Nt,At),(xt-2)*3),[H,ct,dt,Tt]=[dt,Tt,Nt,At]}}if(w.length===0)return null;const M=u?new dm:new eu;return M.build(w,e,i,1,a,u?0:y,l),{outline:M,newCurves:C,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:a,height:l}){let c=1/0,u=-1/0,d=0;for(const k of t){d+=k.length;for(let j=2,F=k.length;j<F;j++){const z=k[j]-k[j-2];c=Math.min(c,z),u=Math.max(u,z)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=Rh+Mc*p,w=new Uint32Array(y);let S=0;w[S++]=y*Uint32Array.BYTES_PER_ELEMENT+(d-2*p)*f.BYTES_PER_ELEMENT,w[S++]=0,w[S++]=a,w[S++]=l,w[S++]=e?0:1,w[S++]=Math.max(0,Math.floor(i??0)),w[S++]=p,w[S++]=f.BYTES_PER_ELEMENT;for(const k of t)w[S++]=k.length-2,w[S++]=k[0],w[S++]=k[1];const _=new CompressionStream("deflate-raw"),A=_.writable.getWriter();await A.ready,A.write(w);const C=f.prototype.constructor;for(const k of t){const j=new C(k.length-2);for(let F=2,z=k.length;F<z;F++)j[F-2]=k[F]-k[F-2];A.write(j)}A.close();const M=await new Response(_.readable).arrayBuffer();return new Uint8Array(M).toBase64()}static async decompressSignature(t){try{const e=Uint8Array.fromBase64(t),{readable:i,writable:a}=new DecompressionStream("deflate-raw"),l=a.getWriter();await l.ready,l.write(e).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const k of i)c||=new Uint8Array(new Uint32Array(k.buffer,0,4)[0]),c.set(k,u),u+=k.length;const d=new Uint32Array(c.buffer,0,c.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=d[2],y=d[3],w=d[4]===0,S=d[5],_=d[6],A=d[7],C=[],M=(Rh+Mc*_)*Uint32Array.BYTES_PER_ELEMENT;let N;switch(A){case Int8Array.BYTES_PER_ELEMENT:N=new Int8Array(c.buffer,M);break;case Int16Array.BYTES_PER_ELEMENT:N=new Int16Array(c.buffer,M);break;case Int32Array.BYTES_PER_ELEMENT:N=new Int32Array(c.buffer,M);break}u=0;for(let k=0;k<_;k++){const j=d[Mc*k+Rh],F=new Float32Array(j+2);C.push(F);for(let z=0;z<Mc-1;z++)F[z]=d[Mc*k+Rh+z+1];for(let z=0;z<j;z++)F[z+2]=F[z]+N[u++]}return{areContours:w,thickness:S,outlines:C,width:p,height:y}}catch(e){return ne(`decompressSignature: ${e}`),null}}}class Ym extends lx{constructor(){super(),super.updateProperties({fill:Wt._defaultLineColor,"stroke-width":0})}clone(){const t=new Ym;return t.updateAll(this),t}}class Qm extends bd{constructor(t){super(t),super.updateProperties({stroke:Wt._defaultLineColor,"stroke-width":1})}clone(){const t=new Qm(this._viewParameters);return t.updateAll(this),t}}class Ts extends _e{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=oe.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Wt.initialize(t,e),this._defaultDrawingOptions=new Ym,this._defaultDrawnSignatureOptions=new Qm(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return ie(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:a,mustSmooth:l,areContours:c,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:p,pageHeight:y},rotation:w}=this.parent.viewport,S=il.processDrawnLines({lines:a,pageWidth:p,pageHeight:y,rotation:w,innerMargin:Ts._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(S,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:a,height:l}=this.#i,c=Math.max(a,l),u=il.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:i,width:a,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,a){const{x:l,y:c}=this,{outline:u}=this.#i=t;this.#t=u instanceof dm,this.description=i;let d;this.#t?d=Ts.getDefaultDrawingOptions():(d=Ts._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let p=e/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return il.process(t,e,i,a,Ts._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:a},rotation:l}=this.parent.viewport;return il.extractContoursFromText(t,e,i,a,l,Ts._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return il.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:Ts._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Ts.getDefaultDrawingOptions():(this._drawingOptions=Ts._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(l),t?(l.paths={lines:e,points:i},l.uuid=this.#n,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,i,a,l,c){return c.areContours?dm.deserialize(t,e,i,a,l,c):eu.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){const a=await super.deserialize(t,e,i);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#n=t.uuid,a}}class C2 extends Wt{#t=null;#e=null;#i=null;#n=null;#s=null;#r="";#a=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=oe.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Wt.initialize(t,e)}static isHandlingMimeForPasting(t){return im.includes(t)}static paste(t,e){e.pasteEditor({mode:oe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:a,width:l,height:c,channels:a.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#h(i,!0)).finally(()=>this.#f());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=im.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#s||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,a&&(this.#t=a),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:e,height:i}=this.#t;const[a,l]=this.pageDimensions,c=.75;if(this.width)e=this.width*a,i=this.height*l;else if(e>c*a||i>c*l){const d=Math.min(c*a/e,c*l/i);e*=d,i*=d}this._uiManager.enableWaiting(!1);const u=this.#a=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/a,this.height=i/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:a,height:l}=this.#t,c=new Os;let u=this.#t,d=a,f=l,p=null;if(e){if(a>e||l>e){const z=Math.min(e/a,e/l);d=Math.floor(a*z),f=Math.floor(l*z)}p=document.createElement("canvas");const w=p.width=Math.ceil(d*c.sx),S=p.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(w,S));const _=p.getContext("2d");_.filter=this._uiManager.hcmFilter;let A="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":$C.isDarkMode&&(A="#8f8f9d",C="#42414d");const M=15,N=M*c.sx,k=M*c.sy,j=new OffscreenCanvas(N*2,k*2),F=j.getContext("2d");F.fillStyle=A,F.fillRect(0,0,N*2,k*2),F.fillStyle=C,F.fillRect(0,0,N,k),F.fillRect(N,k,N,k),_.fillStyle=_.createPattern(j,"repeat"),_.fillRect(0,0,w,S),_.drawImage(u,0,0,u.width,u.height,0,0,w,S)}let y=null;if(i){let w,S;if(c.symmetric&&u.width<t&&u.height<t)w=u.width,S=u.height;else if(u=this.#t,a>t||l>t){const C=Math.min(t/a,t/l);w=Math.floor(a*C),S=Math.floor(l*C),this.#l||(u=this.#u(w,S))}const A=new OffscreenCanvas(w,S).getContext("2d",{willReadFrequently:!0});A.drawImage(u,0,0,u.width,u.height,0,0,w,S),y={width:w,height:S,data:A.getImageData(0,0,w,S).data}}return{canvas:p,width:d,height:f,imageData:y}}#u(t,e){const{width:i,height:a}=this.#t;let l=i,c=a,u=this.#t;for(;l>2*t||c>2*e;){const d=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*e&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(l,c);p.getContext("2d").drawImage(u,0,0,d,f,0,0,l,c),u=p.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:i,height:a}=this,l=new Os,c=Math.ceil(i*t*l.sx),u=Math.ceil(a*e*l.sy),d=this.#a;if(!d||d.width===c&&d.height===u)return;d.width=c,d.height=u;const f=this.#l?this.#t:this.#u(c,u),p=d.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,a=Math.round(this.width*e*pl.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*pl.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let a=null,l=!1;if(t instanceof rx){const{data:{rect:A,rotation:C,id:M,structParent:N,popupRef:k,richText:j,contentsObj:F,creationDate:z,modificationDate:H},container:ct,parent:{page:{pageNumber:dt}},canvas:Tt}=t;let xt,Nt;Tt?(delete t.canvas,{id:xt,bitmap:Nt}=i.imageManager.getFromCanvas(ct.id,Tt),Tt.remove()):(l=!0,t._hasNoCanvas=!0);const At=(await e._structTree.getAriaAttributes(`${sl}${M}`))?.get("aria-label")||"";a=t={annotationType:oe.STAMP,bitmapId:xt,bitmap:Nt,pageIndex:dt-1,rect:A.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,accessibilityData:{decorative:!1,altText:At},isSvg:!1,structParent:N,popupRef:k,richText:j,comment:F?.str||null,creationDate:z,modificationDate:H}}const c=await super.deserialize(t,e,i),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:w}=t;l?(i.addMissingCanvas(t.id,c),c.#o=!0):p&&i.imageManager.isValidId(p)?(c.#e=p,d&&(c.#t=d)):c.#n=f,c.#l=y;const[S,_]=c.pageDimensions;return c.width=(u[2]-u[0])/S,c.height=(u[3]-u[1])/_,w&&(c.altTextData=w),c._initialData=a,t.comment&&c.setCommentData(t),c.#d=!!a,c}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(i);return u.isSame?null:(u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const c=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:c,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return i}#v(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,a=t.pageIndex===e,l=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class ca{#t;#e=!1;#i=null;#n=null;#s=null;#r=new Map;#a=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([Dn,Xm,C2,cn,Ts].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:a,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:d,viewport:f,l10n:p}){const y=[...ca.#p.values()];if(!ca._initialized){ca._initialized=!0;for(const w of y)w.initialize(p,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=e,this.div=i,this.#t=l,this.#i=c,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===oe.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#w(),t){case oe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case oe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case oe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===oe.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of ca.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#y(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const i of this.#y)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#u.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#i;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#u.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const a=await this.deserialize(i);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const a=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:d,timeStamp:f}=l,p=this.#m;if(f-p>500){this.#m=f;return}this.#m=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const w=document.elementsFromPoint(u,d);if(y.toggle("getElements",!1),!this.div.contains(w[0]))return;let S;const _=new RegExp(`^${Ic}[0-9]+$`);for(const C of w)if(_.test(C.id)){S=C.id;break}if(!S)return;const A=this.#r.get(S);A?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),A.dblclick(l))},{signal:a,capture:!0})}const t=this.#i,e=[];if(t){const a=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=l.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const a of ca.#p.values())i.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:i}=Sn.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),cn.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),Wt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#r.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#b(){return ca.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const e=this.#b;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:i,offsetY:a}=this.#A(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:i,y:a,uiManager:this.#u,isCentered:!0,...e});c&&this.add(c)}async deserialize(t){return await ca.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,i={}){const a=this.getNextId(),l=this.#E({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...i});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:t,y:e,width:i,height:a}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,e),u=Math.min(window.innerWidth,t+i),d=Math.min(window.innerHeight,e+a),f=(l+u)/2-t,p=(c+d)/2-e,[y,w]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:w}}addNewEditor(t={}){this.createAndAddNewEditor(this.#A(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=Sn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#u.getMode();if(i===oe.STAMP||i===oe.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===oe.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=Sn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const i=this.#u.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,e,i){const a=this.#u.findParent(e,i);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#w(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,eo(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#w();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,eo(this.div,{rotation:i}),e!==i)for(const a of this.#r.values())a.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class In{#t=null;#e=new Map;#i=new Map;static#n=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return ie(this,"_svgFactory",new Qh)}static#s(t,[e,i,a,l]){const{style:c}=t;c.top=`${100*i}%`,c.left=`${100*e}%`,c.width=`${100*a}%`,c.height=`${100*l}%`}#r(){const t=In._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const i=In._svgFactory.createElement("clipPath");t.append(i);const a=`clip_${e}`;i.setAttribute("id",a),i.setAttribute("clipPathUnits","objectBoundingBox");const l=In._svgFactory.createElement("use");return i.append(l),l.setAttribute("href",`#${e}`),l.classList.add("clip"),a}#o(t,e){for(const[i,a]of Object.entries(e))a===null?t.removeAttribute(i):t.setAttribute(i,a)}draw(t,e=!1,i=!1){const a=In.#n++,l=this.#r(),c=In._svgFactory.createElement("defs");l.append(c);const u=In._svgFactory.createElement("path");c.append(u);const d=`path_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(a,u);const f=i?this.#a(c,d):null,p=In._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(l,t),this.#e.set(a,l),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=In.#n++,a=this.#r(),l=In._svgFactory.createElement("defs");a.append(l);const c=In._svgFactory.createElement("path");l.append(c);const u=`path_${i}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const y=In._svgFactory.createElement("mask");l.append(y),d=`mask_${i}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const w=In._svgFactory.createElement("rect");y.append(w),w.setAttribute("width","1"),w.setAttribute("height","1"),w.setAttribute("fill","white");const S=In._svgFactory.createElement("use");y.append(S),S.setAttribute("href",`#${u}`),S.setAttribute("stroke","none"),S.setAttribute("fill","black"),S.setAttribute("fill-rule","nonzero"),S.classList.add("mask")}const f=In._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const p=f.cloneNode();return a.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(i,a),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:a,rootClass:l,path:c}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#o(u,i),a&&In.#s(u,a),l){const{classList:d}=u;for(const[f,p]of Object.entries(l))d.toggle(f,p)}if(c){const f=u.firstElementChild.firstElementChild;this.#o(f,c)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:um};globalThis.pdfjsLib={AbortException:rr,AnnotationEditorLayer:ca,AnnotationEditorParamsType:we,AnnotationEditorType:oe,AnnotationEditorUIManager:or,AnnotationLayer:$m,AnnotationMode:nr,AnnotationType:bn,applyOpacity:YC,build:n2,ColorPicker:ex,createValidAbsoluteUrl:Tw,CSSConstants:XC,DOMSVGFactory:Qh,DrawLayer:In,FeatureTest:Sn,fetchData:Wc,findContrastColor:QC,getDocument:Ww,getFilenameFromUrl:HC,getPdfFilenameFromUrl:qC,getRGB:Jc,getUuid:Mw,getXfaPageViewport:VC,GlobalWorkerOptions:ul,ImageKind:Fh,InvalidPDFException:em,isDataScheme:hd,isPdfFile:jm,isValidExplicitDest:oT,MathClamp:Un,noContextMenu:$i,normalizeUnicode:UC,OPS:Uc,OutputScale:Os,PagesMapper:Ce,PasswordResponses:DC,PDFDataRangeTransport:Zw,PDFDateString:nm,PDFWorker:Hc,PermissionFlag:MC,PixelsPerInch:pl,RenderingCancelledException:Bm,renderRichText:Ow,ResponseException:Xh,setLayerDimensions:eo,shadow:ie,SignatureExtractor:il,stopEvent:nn,SupportedImageMimeTypes:im,TextLayer:Ti,TouchManager:dd,updateUrlHash:Rw,Util:Ht,VerbosityLevel:od,version:e2,XfaLayer:Dw};ul.workerSrc=new URL("/static/frontend/assets/pdf.worker-BA9kU3Pw.mjs",import.meta.url).toString();const T2=()=>typeof window<"u"&&window.devicePixelRatio||1;function R2(r,t){const e=Math.sqrt(t[2]*t[2]+t[3]*t[3]),i=Math.sqrt(t[0]*t[0]+t[1]*t[1]),a=e,l=a,c=typeof r.width=="number"&&r.width>0?r.width*i:(r.str?.length||1)*l*.5,u=t[4],d=t[5]-a*.85;return{x:u,y:d,w:c,h:l}}function M2(r,t,e){const a=(typeof document<"u"?document.createElement("canvas"):null)?.getContext("2d"),l=[];let c=0,u=-999;const d=4;let f=0;return r.items.forEach(p=>{if(!p.str||p.str.trim()==="")return;const y=Ht.transform(t.transform,p.transform),w=R2(p,y);Math.abs(w.y-u)>d&&(c+=1,u=w.y);const S=w.h,_=typeof p.width=="number"&&p.width>0?p.width*e:w.w,A=p.str.split(/(\s+)/);if(!a||A.length===0){l.push({id:f++,text:p.str,x:w.x,y:w.y,w:w.w,h:w.h,fontSize:w.h,lineIndex:c});return}a.font=`${S}px sans-serif`;const C=A.map(j=>({text:j,measured:a.measureText(j).width,isSpace:/^\s+$/.test(j)||j===""})),M=C.reduce((j,F)=>j+F.measured,0),N=M>0?_/M:1;let k=0;C.forEach(j=>{const F=j.measured*N;if(j.text===""||j.isSpace){k+=F;return}l.push({id:f,text:j.text,x:w.x+k,y:w.y,w:F,h:S,fontSize:S,lineIndex:c}),f+=1,k+=F})}),l}function cx(r){const t={};return r.forEach(e=>{const i=e.lineIndex??Math.round(e.y/4)*4;t[i]||(t[i]=[]),t[i].push(e)}),Object.values(t)}function Ev(r,t,e){let l=null,c=1/0;for(const u of r){if(!(e>=u.y-6&&e<=u.y+u.h+6))continue;if(t>=u.x-4&&t<=u.x+u.w+4)return u;const p=t<u.x?u.x-t:t-(u.x+u.w);p<c&&p<40&&(c=p,l=u)}return l}function D2(r){if(!r.length)return"";let t="";for(let e=0;e<r.length;e++){const i=r[e];if(e>0){const a=r[e-1];Math.abs(i.y-a.y)<6?i.x-(a.x+a.w)>1&&(t+=" "):t+=" "}t+=i.text}return t.trim()}function O2(r){if(!r?.length)return r||[];const t=[...r].sort((e,i)=>(e.y||0)-(i.y||0));return t.map((e,i)=>{const a=e.y||0,l=Math.max(0,e.height??e.h??4),c=a+l,u=t[i+1];if(!u)return{...e};const d=u.y||0;if(c<=d)return{...e};const f=Math.max(1,d-a);return{...e,height:f}})}function N2(r,t){return r.length?cx(r).map(i=>{const a=Math.min(...i.map(y=>y.x)),l=Math.max(...i.map(y=>y.x+y.w)),c=i.map(y=>y.y),u=c.sort((y,w)=>y-w)[Math.floor(c.length/2)],d=Math.max(...i.map(y=>y.h)),f=2;return{x:(a-1)/t,y:(u-f)/t,width:(l-a+2)/t,height:(d+f+3)/t}}):[]}function k2({pdfData:r,scale:t,highlights:e=[],hoveredHighlightId:i=null,activeHighlightId:a=null,selectionForPicker:l=null,onSelectionComplete:c,onNumPages:u,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y}){const[w,S]=I.useState(null),[_,A]=I.useState(0),[C,M]=I.useState(!0);return I.useEffect(()=>{if(!r)return;let N=!1;return(async()=>{M(!0);try{const j=r.slice(0),F=await Ww({data:j}).promise;N||(S(F),A(F.numPages),u?.(F.numPages))}catch(j){console.error("Failed to load PDF",j)}N||M(!1)})(),()=>{N=!0}},[r,u]),C?D.jsx("div",{className:"flex items-center justify-center h-full",children:D.jsx(Ds,{className:"w-6 h-6 text-slate-400 animate-spin"})}):w?D.jsx("div",{className:"flex flex-col items-center py-6 gap-4",children:Array.from({length:_},(N,k)=>D.jsx(L2,{pdf:w,pageNumber:k+1,scale:t,pageHighlights:e.filter(j=>j.page_number===k+1),hoveredHighlightId:i,activeHighlightId:a,selectionForPicker:l,onSelectionComplete:c,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y},k))}):null}function L2({pdf:r,pageNumber:t,scale:e,pageHighlights:i,hoveredHighlightId:a,activeHighlightId:l,selectionForPicker:c,onSelectionComplete:u,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y}){const w=I.useRef(null),S=I.useRef(null),_=I.useRef(null),A=I.useRef(null),[C,M]=I.useState({width:0,height:0}),[N,k]=I.useState([]),[j,F]=I.useState(null),[z,H]=I.useState(null),[ct,dt]=I.useState(!1),Tt=I.useRef(null),xt=I.useRef(null),Nt=I.useCallback(()=>{xt.current&&clearTimeout(xt.current),xt.current=setTimeout(()=>{f?.(),xt.current=null},1e3)},[f]),At=I.useCallback(Ct=>{xt.current&&(clearTimeout(xt.current),xt.current=null),d?.(Ct)},[d]);I.useEffect(()=>()=>{xt.current&&clearTimeout(xt.current)},[]),I.useEffect(()=>{let Ct=!1;return(async()=>{const J=await r.getPage(t),ft=T2(),wt=J.getViewport({scale:e}),Bt=J.getViewport({scale:e*ft}),Ft=S.current;if(!Ft||Ct)return;const It=Ft.getContext("2d",{alpha:!1});It.imageSmoothingEnabled=!0,It.imageSmoothingQuality="high",Ft.width=Bt.width,Ft.height=Bt.height,Ft.style.width=`${wt.width}px`,Ft.style.height=`${wt.height}px`,M({width:wt.width,height:wt.height}),await J.render({canvasContext:It,viewport:Bt}).promise;const re=await J.getTextContent();if(Ct)return;const Kt=M2(re,wt,e);k(Kt);const kt=_.current;!kt||Ct||(kt.innerHTML="",kt.style.width=`${wt.width}px`,kt.style.height=`${wt.height}px`,Kt.forEach(He=>{const yt=document.createElement("span");yt.textContent=He.text,yt.style.position="absolute",yt.style.left=`${He.x}px`,yt.style.top=`${He.y}px`,yt.style.width=`${He.w}px`,yt.style.height=`${He.h}px`,yt.style.fontSize=`${He.fontSize}px`,yt.style.fontFamily="sans-serif",yt.style.color="transparent",yt.style.whiteSpace="pre",yt.style.pointerEvents="none",yt.style.lineHeight="1",kt.appendChild(yt)}))})(),()=>{Ct=!0}},[r,t,e]);const Rt=I.useMemo(()=>{if(c&&c.pageNumber===t){const J=Math.min(c.spanStart,c.spanEnd),ft=Math.max(c.spanStart,c.spanEnd);return N.filter(wt=>wt.id>=J&&wt.id<=ft)}if(j==null||z==null)return[];const Ct=Math.min(j,z),U=Math.max(j,z);return N.filter(J=>J.id>=Ct&&J.id<=U)},[N,c,t,j,z]);I.useEffect(()=>{c===null&&Tt.current?.pageNumber===t&&(F(null),H(null)),Tt.current=c},[c,t]);const qt=I.useCallback((Ct,U)=>{const J=w.current?.getBoundingClientRect();return J?{x:Ct-J.left,y:U-J.top}:{x:0,y:0}},[]),G=I.useCallback(Ct=>{if(Ct.button!==0||!N.length)return;const{x:U,y:J}=qt(Ct.clientX,Ct.clientY),ft=Ev(N,U,J);ft?(F(ft.id),H(ft.id),dt(!0)):(F(null),H(null))},[N,qt]),tt=I.useCallback(Ct=>{if(!ct)return;const{x:U,y:J}=qt(Ct.clientX,Ct.clientY),ft=Ev(N,U,J);ft&&H(ft.id)},[ct,N,qt]),vt=I.useCallback(Ct=>{if(Ct.button!==0||!ct)return;if(dt(!1),Rt.length<2){F(null),H(null);return}if(!u)return;const U=w.current?.getBoundingClientRect();if(!U)return;const J={rects:N2(Rt,e)},ft=D2(Rt),wt=Rt[Rt.length-1],Bt={x:U.left+(wt.x+wt.w/2),y:U.top+(wt.y-8)};u({pageNumber:t,position_data:J,highlighted_text:ft,spanStart:Math.min(j,z),spanEnd:Math.max(j,z),pickerPosition:Bt})},[ct,Rt,j,z,e,t,u]);I.useEffect(()=>{const Ct=A.current||w.current;if(Ct)return Ct.addEventListener("mousedown",G),Ct.addEventListener("mousemove",tt),Ct.addEventListener("mouseup",vt),Ct.addEventListener("mouseleave",vt),()=>{Ct.removeEventListener("mousedown",G),Ct.removeEventListener("mousemove",tt),Ct.removeEventListener("mouseup",vt),Ct.removeEventListener("mouseleave",vt)}},[G,tt,vt]);const Xt=I.useMemo(()=>cx(Rt),[Rt]);return D.jsxs("div",{ref:w,"data-page":t,className:"relative shadow-lg bg-white overflow-hidden select-none",style:{width:C.width||0,height:C.height||0,cursor:"text"},title:"Drag to highlight text",children:[D.jsx("canvas",{ref:S,className:"block w-full h-full",style:{display:"block"}}),D.jsxs("div",{ref:A,className:"absolute inset-0",style:{pointerEvents:"auto"},children:[i.map(Ct=>{const U=Ct.position_data?.rects||[],J=O2(U),ft=pi[Ct.color]||pi.yellow,wt=a!=null&&String(Ct.id)===String(a),Bt=l!=null&&String(Ct.id)===String(l),Ft=wt||Bt?ft.rgbaHover??ft.rgba:ft.rgbaSoft??ft.rgba,It=p||y;let re=null;if(J.length>0){const Kt=Math.min(...J.map(le=>le.x))*e,kt=Math.min(...J.map(le=>le.y))*e,He=Math.max(...J.map(le=>(le.x||0)+(le.width||0)))*e,yt=Math.max(...J.map(le=>(le.y||0)+(le.height||4)))*e;re={left:Kt,top:kt,width:He-Kt,height:yt-kt}}return re?D.jsxs("div",{className:"absolute rounded-sm transition-colors duration-150 group",style:{left:re.left,top:re.top,width:re.width,height:re.height,pointerEvents:"auto"},onMouseEnter:()=>At(Ct.id),onMouseLeave:Nt,children:[J.map((Kt,kt)=>D.jsx("div",{className:"absolute rounded-sm transition-colors duration-150",style:{left:(Kt.x||0)*e-re.left,top:(Kt.y||0)*e-re.top,width:Math.max(0,(Kt.width||0)*e),height:Math.max(4,(Kt.height||0)*e),backgroundColor:Ft,pointerEvents:"none"}},kt)),It&&wt&&re&&D.jsxs("div",{className:"absolute flex items-center gap-0.5 rounded-md border border-slate-200 bg-white shadow-sm z-10",style:{left:0,bottom:"100%",marginBottom:4},onMouseEnter:()=>At(Ct.id),onMouseLeave:Nt,children:[p&&D.jsx("button",{type:"button",onClick:Kt=>{Kt.stopPropagation(),p(Ct.id,Kt)},className:"p-1.5 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-l-md transition-colors",title:"Edit note","aria-label":"Edit note",children:D.jsx(Yp,{className:"w-3.5 h-3.5",strokeWidth:2})}),y&&D.jsx("button",{type:"button",onClick:Kt=>{Kt.stopPropagation(),y(Ct.id)},className:"p-1.5 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded-r-md transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:D.jsx(km,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]},Ct.id):null}),Xt.map((Ct,U)=>{const J=Math.min(...Ct.map(Kt=>Kt.x)),ft=Math.max(...Ct.map(Kt=>Kt.x+Kt.w)),wt=Ct.map(Kt=>Kt.y).sort((Kt,kt)=>Kt-kt),Bt=wt[Math.floor(wt.length/2)],Ft=Math.max(...Ct.map(Kt=>Kt.h)),It=2;return D.jsx("div",{className:"absolute rounded-sm pointer-events-none",style:{left:`${J-1}px`,top:`${Bt-It}px`,width:`${ft-J+2}px`,height:`${Ft+It+3}px`,backgroundColor:"rgba(59, 130, 246, 0.2)"}},U)})]}),D.jsx("div",{ref:_,className:"absolute inset-0 overflow-hidden pointer-events-none","aria-hidden":!0})]})}function P2({highlights:r,colorLabels:t,documentColorKeys:e,activeHighlightId:i,onScrollToPage:a,onHighlightClick:l,onHighlightHover:c,onHighlightHoverEnd:u,onClearActive:d,documentId:f,onHighlightNoteUpdate:p,onHighlightDelete:y,openEditForHighlightId:w,onClearOpenEditForHighlightId:S}){const _=e?.length>0?e:da,[A,C]=I.useState("all"),[M,N]=I.useState(!1),[k,j]=I.useState(""),[F,z]=I.useState(null),[H,ct]=I.useState("");I.useEffect(()=>{if(w==null||!r?.length)return;const At=r.find(Rt=>String(Rt.id)===String(w));At&&(z(At.id),ct(At.note?.content??"")),S?.()},[w,r,S]);const dt=I.useMemo(()=>{let At=r||[];if(A!=="all"&&(At=At.filter(Rt=>Rt.color===A)),k.trim()){const Rt=k.trim().toLowerCase();At=At.filter(qt=>qt.highlighted_text&&qt.highlighted_text.toLowerCase().includes(Rt)||qt.note?.content&&qt.note.content.toLowerCase().includes(Rt))}return At},[r,A,k]),Tt=At=>{z(At.id),ct(At.note?.content??"")},xt=async()=>{if(F==null||!f||!p){z(null);return}await p(F,H.trim()||""),z(null)},Nt=()=>{z(null),ct("")};return D.jsxs("div",{className:`w-80 shrink-0 flex flex-col border-l ${sr.default} ${ma.surface}`,children:[D.jsxs("div",{className:`px-4 pt-5 pb-0 border-b ${sr.default}`,children:[D.jsx("h2",{className:`text-[15px] font-semibold ${Jt.heading} mb-1`,children:"Annotations"}),D.jsxs("p",{className:`text-xs ${Jt.muted} mb-4`,children:[dt.length," highlight",dt.length!==1?"s":"",r?.length!==dt.length&&` of ${r?.length||0}`]}),D.jsxs("div",{className:"space-y-2 mb-4",children:[D.jsx("div",{children:D.jsx("button",{type:"button",onClick:()=>{C("all"),d?.()},className:`text-[11px] font-semibold px-3 py-1 rounded-full border cursor-pointer transition-colors ${A==="all"?"bg-slate-900 text-white border-slate-900":`border-slate-200 ${Jt.secondary} hover:bg-slate-50`}`,children:"All"})}),D.jsxs("div",{children:[D.jsxs("button",{type:"button",onClick:()=>N(At=>!At),className:`flex items-center gap-1.5 text-[11px] font-semibold ${Jt.secondary} hover:text-slate-800 transition-colors`,children:[M?D.jsx(V_,{className:"w-3.5 h-3.5 shrink-0"}):D.jsx(q_,{className:"w-3.5 h-3.5 shrink-0"}),"Categories"]}),!M&&D.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1.5",children:_.map(At=>{const Rt=(r||[]).filter(vt=>vt.color===At).length,qt=pi[At];if(!qt)return null;const G=Rs(At,t),tt=A===At;return D.jsxs("button",{type:"button",onClick:()=>{C(tt?"all":At),d?.()},className:`text-[11px] font-semibold px-2.5 py-1 rounded-full border cursor-pointer transition-colors flex items-center gap-1.5 ${tt?"border-transparent":`border-slate-200 ${Jt.secondary} hover:bg-slate-50`}`,style:tt?{backgroundColor:`${qt.hex??qt.solid}25`,color:qt.hex??qt.solid}:void 0,children:[D.jsx("span",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:qt.hex??qt.solid,opacity:1}}),D.jsx("span",{children:G}),D.jsxs("span",{className:tt?"opacity-80":Jt.muted,children:["(",Rt,")"]})]},At)})})]})]}),D.jsxs("div",{className:"relative mb-4",children:[D.jsx(cC,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400",strokeWidth:2}),D.jsx("input",{type:"text",placeholder:"Search highlights...",value:k,onChange:At=>j(At.target.value),className:`w-full pl-8 pr-3 py-1.5 text-xs border ${sr.default} rounded-lg bg-slate-50 outline-none ${Jt.body} placeholder:${Jt.muted}`})]})]}),D.jsx("div",{className:"flex-1 overflow-auto px-3 pb-5",children:r?.length?dt.length?D.jsx("ul",{className:"space-y-1.5",children:dt.map(At=>{const Rt=pi[At.color]||pi.yellow,qt=At.note?.content,G=i!=null&&String(At.id)===String(i);return D.jsx("li",{children:D.jsxs("div",{role:"button",tabIndex:0,className:`w-full text-left rounded-[10px] p-3 transition-all cursor-pointer border ${G?"border-slate-300":"border-transparent hover:border-slate-200"} hover:bg-slate-50`,onClick:()=>{l?.(At.id),a?.(At.page_number)},onKeyDown:tt=>{tt.target.tagName==="TEXTAREA"||tt.target.tagName==="INPUT"||tt.target.isContentEditable||(tt.key==="Enter"||tt.key===" ")&&(tt.preventDefault(),l?.(At.id),a?.(At.page_number))},onMouseEnter:()=>c?.(At.id),onMouseLeave:u,children:[D.jsxs("div",{className:"flex gap-2.5",children:[D.jsx("div",{className:"w-0.5 min-h-9 shrink-0 rounded-full transition-opacity",style:{backgroundColor:Rt.hex??Rt.solid,opacity:G?1:.6}}),D.jsx("div",{className:"flex-1 min-w-0",children:D.jsx("p",{className:`text-xs leading-snug ${Jt.body} line-clamp-3`,children:At.highlighted_text||"(No text captured)"})})]}),F===At.id?D.jsxs("div",{className:"mt-2 pl-3.5 space-y-1.5",children:[D.jsx("textarea",{value:H,onChange:tt=>ct(tt.target.value),placeholder:"Add a comment...",rows:2,className:`w-full text-[11.5px] border ${sr.default} rounded-lg px-2 py-1.5 resize-none outline-none focus:ring-1 focus:ring-slate-300 ${Jt.body}`}),D.jsxs("div",{className:"flex gap-1.5",children:[D.jsx("button",{type:"button",onClick:xt,className:"text-[11px] font-medium px-2 py-1 rounded bg-slate-800 text-white hover:bg-slate-700",children:"Save"}),D.jsx("button",{type:"button",onClick:Nt,className:"text-[11px] font-medium px-2 py-1 rounded text-slate-600 hover:bg-slate-100",children:"Cancel"})]})]}):D.jsxs(D.Fragment,{children:[qt&&D.jsx("p",{className:`text-[11.5px] ${Jt.muted} mt-2 pl-3.5 leading-snug italic`,children:qt}),f&&p&&D.jsx("button",{type:"button",onClick:()=>Tt(At),className:"mt-1.5 pl-3.5 text-[11px] text-slate-500 hover:text-slate-700",children:qt?"Edit comment":"Add comment"})]}),D.jsxs("div",{className:"mt-2 pl-3.5 flex items-center gap-2 flex-wrap",children:[D.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:Rt.hex??Rt.solid,backgroundColor:`${Rt.hex??Rt.solid}12`},children:Rs(At.color,t)}),D.jsxs("span",{className:"text-[10px] text-slate-400",children:["p.",At.page_number]}),f&&y&&D.jsx("button",{type:"button",onClick:tt=>{tt.stopPropagation(),y(At.id)},className:"ml-auto p-1 rounded text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:D.jsx(km,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]})},At.id)})}):D.jsx("div",{className:`py-6 text-center ${Jt.muted} text-sm`,children:"No matching highlights."}):D.jsxs("div",{className:`py-8 text-center ${Jt.muted} text-sm`,children:[D.jsx(_w,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),D.jsx("p",{children:"No highlights yet."}),D.jsx("p",{className:"mt-1 text-xs",children:"Select text on the document to create your first highlight."})]})})]})}const Pp=[{colorKey:"yellow",color:"#FBBF24",shortcut:"1"},{colorKey:"green",color:"#34D399",shortcut:"2"},{colorKey:"blue",color:"#60A5FA",shortcut:"3"},{colorKey:"pink",color:"#F472B6",shortcut:"4"},{colorKey:"orange",color:"#FB923C",shortcut:"5"}];function B2({position:r,onSelect:t,onClose:e,colorLabels:i,documentColorKeys:a}){const l=I.useRef(null),c=I.useRef(null),[u,d]=I.useState(null),[f,p]=I.useState(""),[y,w]=I.useState(!1),[S,_]=I.useState(!1),A=a?.length>0?a.map(F=>Pp.find(z=>z.colorKey===F)).filter(Boolean):Pp,C=A.length>0?A:Pp,M=I.useCallback(F=>Rs(F,i),[i]);I.useEffect(()=>{y&&c.current&&c.current.focus()},[y]);const N=I.useCallback(F=>{d(F.colorKey),y||(t(F.colorKey,""),_(!0),setTimeout(()=>e(),400))},[y,t,e]),k=I.useCallback(()=>{u&&(t(u,f.trim()||void 0),_(!0),setTimeout(()=>e(),400))},[u,f,t,e]);if(I.useEffect(()=>{const F=z=>{if(z.key==="Escape"){e();return}if(!y){const H=parseInt(z.key,10);if(H>=1&&H<=C.length){const ct=C[H-1];ct&&N(ct)}}y&&z.key==="Enter"&&(z.metaKey||z.ctrlKey)&&(z.preventDefault(),k())};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[y,u,f,e,N,k,C]),I.useEffect(()=>{const F=z=>{l.current&&!l.current.contains(z.target)&&e()};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[e]),I.useEffect(()=>{p(""),d(null),w(!1),_(!1)},[r]),!r)return null;const j=u?C.find(F=>F.colorKey===u):null;return D.jsx("div",{ref:l,className:"fixed z-[1000]",style:{left:r.x,top:r.y-48,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:S?D.jsxs("div",{className:"flex items-center gap-2 rounded-[10px] px-3.5 py-2 bg-white border border-slate-200 shadow-md",children:[D.jsx("div",{className:"flex h-[18px] w-[18px] items-center justify-center rounded-full",style:{background:j?.color??"#64748b"},children:D.jsx("svg",{width:"10",height:"10",viewBox:"0 0 12 12",fill:"none",children:D.jsx("path",{d:"M2 6L5 9L10 3",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),D.jsx("span",{className:"text-[13px] font-medium text-slate-800",children:"Saved"})]}):D.jsxs("div",{className:"overflow-hidden rounded-xl bg-white border border-slate-200 shadow-lg",style:{width:y?280:"auto",transition:"width 0.2s cubic-bezier(0.16, 1, 0.3, 1)"},children:[D.jsxs("div",{className:"flex items-center gap-0.5 p-1.5",children:[C.map((F,z)=>D.jsx("button",{type:"button",onClick:()=>N(F),className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 hover:bg-slate-100",style:{background:u===F.colorKey?`${F.color}25`:"transparent"},children:D.jsx("div",{className:"h-4 w-4 rounded-full transition-[box-shadow,transform] duration-150",style:{background:F.color,boxShadow:u===F.colorKey?`0 0 0 2px ${F.color}80`:"none",transform:u===F.colorKey?"scale(1.15)":"scale(1)"}})},F.colorKey)),D.jsx("div",{className:"mx-0.5 h-4 w-px bg-slate-200"}),D.jsx("button",{type:"button",onClick:()=>w(!y),title:"Add note",className:`flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 ${y?"bg-slate-100":"hover:bg-slate-100"}`,children:D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",children:[D.jsx("path",{d:"M13 2.5H3C2.72386 2.5 2.5 2.72386 2.5 3V13C2.5 13.2761 2.72386 13.5 3 13.5H10L13.5 10V3C13.5 2.72386 13.2761 2.5 13 2.5Z",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),D.jsx("path",{d:"M5.5 6H10.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),D.jsx("path",{d:"M5.5 8.5H8.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),D.jsx("path",{d:"M10 13.5V10H13.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),D.jsx("button",{type:"button",onClick:e,className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 bg-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-700 transition-colors duration-150",children:D.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:D.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]}),y&&D.jsxs("div",{className:"px-2 pb-2 border-t border-slate-100 pt-2",style:{animation:"expandIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[!j&&D.jsx("div",{className:"px-1.5 pb-2 pt-1 text-[11px] text-slate-500",children:"Pick a category above, then add your note"}),j&&D.jsxs("div",{className:"flex items-center gap-1.5 px-1.5 pb-2 pt-0.5",children:[D.jsx("div",{className:"h-2 w-2 rounded-full shrink-0",style:{background:j.color}}),D.jsx("span",{className:"text-[11px] font-medium text-slate-600",children:M(j.colorKey)})]}),D.jsx("textarea",{ref:c,value:f,onChange:F=>p(F.target.value),placeholder:"Add a note...",rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200"}),D.jsx("div",{className:"mt-1.5 flex items-center justify-end",children:D.jsx("button",{type:"button",onClick:k,disabled:!j,className:"rounded-lg border-0 px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-default transition-colors",children:"Save"})})]})]})})}const Mh="color_label_";function j2({colorLabels:r={},documentId:t,onSave:e,onClose:i}){const a=vl(),l=I.useRef(null),[c,u]=I.useState(()=>Object.keys(r||{}).length>0?Object.keys(r):[...da]);I.useEffect(()=>{const C=Object.keys(r||{});u(C.length>0?C:[...da])},[t,r]);const d=Pc({mutationFn:C=>Yn.update(t,C),onSuccess:()=>{a.invalidateQueries({queryKey:["document",t]}),e?.()},onError:C=>{console.error("Failed to save color labels",C?.response?.data??C)}}),f=C=>{u(M=>M.filter(N=>N!==C))},p=C=>{c.includes(C)||u(M=>[...M,C].sort((N,k)=>da.indexOf(N)-da.indexOf(k)))},y=da.filter(C=>!c.includes(C)),w=c.length<5&&y.length>0,S=C=>{if(C.preventDefault(),!t)return;const M=l.current;if(!M)return;const N={};c.forEach(k=>{const j=M.elements.namedItem(Mh+k),F=j&&"value"in j?String(j.value).trim():"";N[k]=F}),d.mutate({color_labels:N})},_=C=>{C.target===C.currentTarget&&i()},A=D.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40",onClick:_,children:D.jsxs("div",{role:"dialog","aria-modal":"true",className:`relative z-10 ${ma.surface} rounded-xl shadow-xl border ${sr.default} w-full max-w-md mx-4 overflow-hidden max-h-[90vh] flex flex-col`,onClick:C=>C.stopPropagation(),onMouseDown:C=>C.stopPropagation(),children:[D.jsx("div",{className:"px-5 pt-5 pb-2 border-b border-slate-200 shrink-0",children:D.jsx("h3",{className:`text-base font-semibold ${Jt.heading}`,children:"Colours in this document"})}),D.jsxs("form",{ref:l,onSubmit:S,className:"p-5 space-y-4 overflow-auto flex-1 min-h-0",children:[c.map(C=>{const M=pi[C],N=M?.name||C,k=(r&&r[C])??"";return D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("div",{className:"h-8 w-8 rounded-full shrink-0 border-2 border-slate-200",style:{backgroundColor:M?.hex??M?.solid}}),D.jsxs("div",{className:"flex-1 min-w-0",children:[D.jsxs("label",{className:`text-xs ${Jt.muted} block mb-0.5`,htmlFor:Mh+C,children:[M?.label??C," (default: ",N,")"]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("input",{id:Mh+C,name:Mh+C,type:"text",defaultValue:k,placeholder:N,className:`w-full rounded-lg border ${sr.default} px-3 py-2 text-sm ${Jt.body} placeholder:${Jt.muted} outline-none focus:ring-2 focus:ring-slate-300`}),D.jsx("button",{type:"button",onMouseDown:j=>{j.preventDefault(),j.stopPropagation(),f(C)},onClick:j=>{j.preventDefault(),j.stopPropagation(),f(C)},className:"shrink-0 p-2 rounded-lg text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors select-none",title:"Remove this colour from the document","aria-label":"Remove colour",children:D.jsx(Wp,{className:"w-4 h-4 pointer-events-none",strokeWidth:2})})]})]})]},C)}),w&&D.jsxs("div",{className:"pt-2 border-t border-slate-200",children:[D.jsx("p",{className:`text-xs ${Jt.muted} mb-2`,children:"Add a colour"}),D.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(C=>{const M=pi[C];return D.jsxs("button",{type:"button",onClick:()=>p(C),className:"flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 transition-colors",children:[D.jsx("span",{className:"h-5 w-5 rounded-full border border-slate-200 shrink-0",style:{backgroundColor:M?.hex??M?.solid}}),D.jsx("span",{children:M?.label??C}),D.jsx(oC,{className:"w-4 h-4 text-slate-400",strokeWidth:2})]},C)})})]}),c.length===0&&D.jsx("p",{className:`text-sm ${Jt.muted}`,children:"No colours in this document. Add one above to use for highlights."}),d.isError&&D.jsx("p",{className:"text-sm text-red-600",children:d.error?.response?.data?.detail??d.error?.message??"Failed to save. Try again."}),D.jsxs("div",{className:"flex justify-end gap-2 pt-2 shrink-0",children:[D.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancel"}),D.jsx("button",{type:"submit",className:to,disabled:d.isPending,children:d.isPending?"Saving":"Save"})]})]})]})});return typeof document>"u"||!document.body?A:fA.createPortal(A,document.body)}function F2({position:r,initialValue:t="",onSave:e,onClose:i}){const[a,l]=I.useState(t),c=I.useRef(null),u=I.useRef(null);return I.useEffect(()=>{l(t)},[t,r]),I.useEffect(()=>{u.current?.focus()},[r]),I.useEffect(()=>{const d=f=>{f.key==="Escape"&&i(),f.key==="Enter"&&(f.metaKey||f.ctrlKey)&&(f.preventDefault(),e(a.trim()))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[a,e,i]),I.useEffect(()=>{const d=f=>{c.current&&!c.current.contains(f.target)&&i()};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[i]),r?D.jsxs("div",{ref:c,className:"fixed z-[1001] w-64 rounded-xl border border-slate-200 bg-white p-3 shadow-lg",style:{left:r.x,top:r.y+6,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[D.jsx("textarea",{ref:u,value:a,onChange:d=>l(d.target.value),placeholder:"Add a note...",rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200 mb-2"}),D.jsxs("div",{className:"flex items-center justify-end gap-2",children:[D.jsx("button",{type:"button",onClick:i,className:"rounded-lg px-2.5 py-1.5 text-xs font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Cancel"}),D.jsx("button",{type:"button",onClick:()=>e(a.trim()),className:"rounded-lg px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 transition-colors",children:"Save"})]})]}):null}function I2(){const{id:r}=ym(),t=ya(),e=vl(),[i,a]=I.useState(null),[l,c]=I.useState(!1),[u,d]=I.useState(!0),[f,p]=I.useState(1.3),[y,w]=I.useState(!0),[S,_]=I.useState(null),[A,C]=I.useState(null),[M,N]=I.useState(null),[k,j]=I.useState(null),[F,z]=I.useState(null),[H,ct]=I.useState(0),[dt,Tt]=I.useState(1),[xt,Nt]=I.useState(!1),[At,Rt]=I.useState(null),[qt,G]=I.useState(null),{data:tt,isLoading:vt,isError:Xt}=pa({queryKey:["document",r],queryFn:async()=>{const{data:yt}=await Yn.get(r);return yt},enabled:!!r}),Ct=I.useMemo(()=>{const yt=Object.keys(tt?.color_labels||{});return yt.length>0?yt:[...da]},[tt?.color_labels]);I.useEffect(()=>{if(!tt||!r)return;let yt=!1;return(async()=>{d(!0);try{const Mt=await TC(tt);yt||(Mt?a(Mt.data):c(!0))}finally{yt||d(!1)}})(),()=>{yt=!0}},[tt,r]);const{data:U=[]}=pa({queryKey:["highlights",r],queryFn:async()=>{const{data:yt}=await Yn.highlights(r);return yt},enabled:!!r}),J=I.useCallback(async yt=>{if(r)try{await Yn.createHighlight(r,yt),e.invalidateQueries({queryKey:["highlights",r]}),N(null),j(null),z(null)}catch(le){console.error("Failed to save highlight",le)}},[r,e]),ft=I.useCallback(yt=>{N({page_number:yt.pageNumber,position_data:yt.position_data,highlighted_text:yt.highlighted_text}),j(yt.pickerPosition),z({pageNumber:yt.pageNumber,spanStart:yt.spanStart,spanEnd:yt.spanEnd})},[]),wt=I.useCallback((yt,le)=>{M&&J({...M,color:yt,comment:le})},[M,J]),Bt=I.useCallback(()=>{N(null),j(null),z(null)},[]),Ft=I.useCallback(yt=>{Tt(yt),window.document.getElementById("pdf-scroll-container")?.querySelector(`[data-page="${yt}"]`)?.scrollIntoView({behavior:"smooth",block:"start"})},[]),It=I.useCallback(yt=>{C(le=>le!=null&&String(le)===String(yt)?null:yt)},[]),re=I.useCallback(yt=>ct(yt??0),[]),Kt=I.useCallback(()=>{if(dt<=1)return;const yt=dt-1;Tt(yt),Ft(yt)},[dt,Ft]),kt=I.useCallback(()=>{if(dt>=H)return;const yt=dt+1;Tt(yt),Ft(yt)},[dt,H,Ft]),He=async yt=>{const le=yt.target.files?.[0];if(!le||!tt||!r)return;const Mt=await le.arrayBuffer(),de=await Cw(Mt);if(de!==tt.pdf_hash){alert("This file does not match the original document.");return}try{const Wn=new FormData;Wn.append("file",new Blob([Mt],{type:"application/pdf"}),le.name||tt.filename||"document.pdf"),await Yn.uploadPdf(r,Wn)}catch(Wn){const On=Wn.response?.data?.detail??Wn.message??"Upload failed";alert(typeof On=="string"?On:JSON.stringify(On));return}await Pm(de,tt.filename||le.name,le.size,Mt),a(Mt),c(!1)};return r?vt||u?D.jsx("div",{className:`${Qr} flex items-center justify-center min-h-[50vh]`,children:D.jsx(Ds,{className:`w-8 h-8 ${Jt.muted} animate-spin`})}):Xt||!tt&&!vt?D.jsxs("div",{className:`${Qr} flex flex-col items-center justify-center min-h-[50vh]`,children:[D.jsx("h2",{className:`text-lg font-semibold ${Jt.heading} mb-2`,children:"Document not found"}),D.jsx("p",{className:`text-sm ${Jt.secondary} mb-4`,children:"It may have been deleted or you dont have access to it."}),D.jsx("button",{type:"button",onClick:()=>t(tt?.project?`/project/${tt.project}`:"/"),className:to,children:"Back to project"})]}):l?D.jsxs("div",{className:`${Qr} flex flex-col items-center justify-center`,children:[D.jsx(Qp,{className:`w-12 h-12 ${Jt.muted} mb-4`}),D.jsx("h2",{className:`text-lg font-semibold ${Jt.heading} mb-2`,children:"PDF needed on this device"}),D.jsxs("p",{className:`text-sm ${Jt.secondary} mb-4 text-center max-w-sm`,children:["Upload the same file to open ",D.jsx("strong",{children:tt?.filename}),"."]}),D.jsxs("label",{className:`${to} inline-flex items-center gap-2`,children:[D.jsx(Qp,{className:"w-4 h-4"})," Upload PDF",D.jsx("input",{type:"file",accept:".pdf",onChange:He,className:"hidden"})]}),D.jsx("button",{type:"button",onClick:()=>t(tt?.project?`/project/${tt.project}`:"/"),className:`mt-4 text-sm ${Jt.muted} hover:underline`,children:"Back to project"})]}):D.jsxs("div",{className:`h-screen flex flex-col ${ma.page} overflow-hidden`,children:[D.jsxs("header",{className:`${Aw} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("button",{type:"button",onClick:()=>t(tt?.project?`/project/${tt.project}`:"/"),className:Oc,title:"Back to project",children:D.jsx(rd,{className:"w-4 h-4"})}),D.jsx("p",{className:`text-sm font-medium ${Jt.heading} truncate max-w-xs`,children:tt?.filename})]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:()=>Nt(!0),className:Oc,title:"Customise topic names",children:D.jsx(hC,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:()=>t(`/document/${r}/summary`),className:Oc,title:"Summary",children:D.jsx($_,{className:"w-4 h-4"})}),D.jsx("div",{className:V0}),D.jsxs("div",{className:`flex items-center gap-1 ${ma.muted} rounded-lg px-1 py-0.5`,children:[D.jsx("button",{type:"button",onClick:()=>p(yt=>Math.max(.5,yt-.1)),className:`p-1.5 ${Jt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:D.jsx(bC,{className:"w-3.5 h-3.5"})}),D.jsxs("span",{className:`text-xs ${Jt.secondary} w-12 text-center`,children:[Math.round(f*100),"%"]}),D.jsx("button",{type:"button",onClick:()=>p(yt=>Math.min(3,yt+.1)),className:`p-1.5 ${Jt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:D.jsx(gC,{className:"w-3.5 h-3.5"})})]}),D.jsx("div",{className:V0}),D.jsx("button",{type:"button",onClick:()=>w(yt=>!yt),className:Oc,title:y?"Close annotations":"Open annotations",children:y?D.jsx(nC,{className:"w-4 h-4"}):D.jsx(sC,{className:"w-4 h-4"})})]})]}),D.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[D.jsxs("div",{className:"flex-1 overflow-auto flex flex-col relative pb-14",id:"pdf-scroll-container",children:[i&&D.jsx(k2,{pdfData:i,scale:f,highlights:U,hoveredHighlightId:S,activeHighlightId:A,selectionForPicker:F,onSelectionComplete:ft,onNumPages:re,onHighlightHover:_,onHighlightHoverEnd:()=>_(null),onHighlightEdit:(yt,le)=>{const Mt=le?.target?.getBoundingClientRect?.();Mt?G({highlightId:yt,x:Mt.left+Mt.width/2,y:Mt.bottom}):(Rt(yt),w(!0))},onHighlightDelete:async yt=>{r&&(await Yn.deleteHighlight(r,yt),e.invalidateQueries({queryKey:["highlights",r]}),String(A)===String(yt)&&C(null),String(S)===String(yt)&&_(null))}}),k&&D.jsx(B2,{position:k,onSelect:wt,onClose:Bt,colorLabels:tt?.color_labels,documentColorKeys:Ct}),qt&&D.jsx(F2,{position:{x:qt.x,y:qt.y},initialValue:(U||[]).find(yt=>String(yt.id)===String(qt.highlightId))?.note?.content??"",onSave:async yt=>{r&&(await Yn.updateHighlight(r,qt.highlightId,{note:yt}),e.invalidateQueries({queryKey:["highlights",r]}),G(null))},onClose:()=>G(null)}),xt&&D.jsx(j2,{colorLabels:tt?.color_labels||{},documentId:r,onSave:()=>{e.invalidateQueries({queryKey:["document",r]}),Nt(!1)},onClose:()=>Nt(!1)})]}),y&&D.jsx(P2,{highlights:U,colorLabels:tt?.color_labels,documentColorKeys:Ct,activeHighlightId:A,onScrollToPage:Ft,onHighlightClick:It,onHighlightHover:_,onHighlightHoverEnd:()=>_(null),onClearActive:()=>C(null),documentId:r,openEditForHighlightId:At,onClearOpenEditForHighlightId:()=>Rt(null),onHighlightNoteUpdate:async(yt,le)=>{r&&(await Yn.updateHighlight(r,yt,{note:le}),e.invalidateQueries({queryKey:["highlights",r]}))},onHighlightDelete:async yt=>{r&&(await Yn.deleteHighlight(r,yt),e.invalidateQueries({queryKey:["highlights",r]}),String(A)===String(yt)&&C(null),String(S)===String(yt)&&_(null))}})]}),H>0&&D.jsxs("div",{className:`fixed bottom-0 left-0 z-10 flex items-center justify-center gap-2 border-t border-slate-200 bg-white py-2.5 shadow-[0_-2px_8px_rgba(0,0,0,0.06)] ${y?"right-80":"right-0"}`,children:[D.jsx("button",{type:"button",onClick:Kt,disabled:dt<=1,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""}),D.jsxs("span",{className:"min-w-[80px] text-center text-xs text-slate-500",children:["Page ",dt," of ",H]}),D.jsx("button",{type:"button",onClick:kt,disabled:dt>=H,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""})]})]}):(t("/",{replace:!0}),null)}const Dh="sequence",Oh="topic";function U2(){const{id:r}=ym(),t=ya(),[e,i]=I.useState(Dh),{data:a,isLoading:l,isError:c}=pa({queryKey:["document",r],queryFn:async()=>{const{data:y}=await Yn.get(r);return y},enabled:!!r}),{data:u=[]}=pa({queryKey:["highlights",r],queryFn:async()=>{const{data:y}=await Yn.highlights(r);return y},enabled:!!r}),d=a?.color_labels||{},f=I.useMemo(()=>{const y=[...u||[]];return e===Dh?(y.sort((w,S)=>w.page_number!==S.page_number?w.page_number-S.page_number:new Date(w.created_at)-new Date(S.created_at)),y):(y.sort((w,S)=>{const _=Rs(w.color,d),A=Rs(S.color,d);return _!==A?_.localeCompare(A):w.page_number!==S.page_number?w.page_number-S.page_number:new Date(w.created_at)-new Date(S.created_at)}),y)},[u,e,d]),p=I.useMemo(()=>{if(e!==Oh)return[];const y={};return(u||[]).forEach(w=>{const S=Rs(w.color,d);y[S]||(y[S]=[]),y[S].push(w)}),da.forEach(w=>{const S=Rs(w,d);y[S]&&y[S].sort((_,A)=>_.page_number!==A.page_number?_.page_number-A.page_number:new Date(_.created_at)-new Date(A.created_at))}),da.map(w=>({topic:Rs(w,d),colorKey:w,items:y[Rs(w,d)]||[]})).filter(w=>w.items.length>0)},[u,e,d]);return r?l?D.jsx("div",{className:`${Qr} flex items-center justify-center min-h-[50vh]`,children:D.jsx(Ds,{className:`w-8 h-8 ${Jt.muted} animate-spin`})}):c||!a?D.jsxs("div",{className:`${Qr} flex flex-col items-center justify-center min-h-[50vh]`,children:[D.jsx("h2",{className:`text-lg font-semibold ${Jt.heading} mb-2`,children:"Document not found"}),D.jsx("button",{type:"button",onClick:()=>t(a?.project?`/project/${a.project}`:"/"),className:to,children:"Back to project"})]}):D.jsxs("div",{className:`min-h-screen flex flex-col ${ma.page}`,children:[D.jsxs("header",{className:`${Aw} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("button",{type:"button",onClick:()=>t(`/document/${r}`),className:Oc,children:D.jsx(rd,{className:"w-4 h-4"})}),D.jsxs("div",{children:[D.jsx("h1",{className:`text-sm font-semibold ${Jt.heading}`,children:"Summary"}),D.jsx("p",{className:`text-xs ${Jt.muted} truncate max-w-[200px]`,children:a.filename})]})]}),D.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 p-0.5 bg-slate-50",children:[D.jsxs("button",{type:"button",onClick:()=>i(Dh),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===Dh?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[D.jsx(Z_,{className:"w-3.5 h-3.5"}),"Sequence"]}),D.jsxs("button",{type:"button",onClick:()=>i(Oh),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===Oh?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[D.jsx(Q_,{className:"w-3.5 h-3.5"}),"Topic"]})]})]}),D.jsx("main",{className:"flex-1 overflow-auto p-6 max-w-3xl mx-auto w-full",children:u?.length?e===Oh&&p.length>0?D.jsx("div",{className:"space-y-8",children:p.map(({topic:y,colorKey:w,items:S})=>{const _=pi[w]||pi.yellow;return D.jsxs("section",{children:[D.jsxs("h2",{className:"text-sm font-semibold text-slate-800 mb-3 pb-2 border-b border-slate-200 flex items-center gap-2",children:[D.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:_.hex??_.solid}}),y,D.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:["(",S.length,")"]})]}),D.jsx("ul",{className:"space-y-3",children:S.map(A=>D.jsxs("li",{className:`rounded-lg border ${sr.default} ${ma.surface} p-4`,children:[D.jsx("p",{className:`text-sm ${Jt.body} leading-snug`,children:A.highlighted_text||"(No text captured)"}),A.note?.content&&D.jsx("p",{className:`text-xs ${Jt.muted} mt-2 italic`,children:A.note.content}),D.jsxs("p",{className:`text-[11px] ${Jt.muted} mt-2`,children:["p.",A.page_number]})]},A.id))})]},y)})}):D.jsx("ul",{className:"space-y-3",children:f.map(y=>{const w=pi[y.color]||pi.yellow,S=Rs(y.color,d);return D.jsxs("li",{className:`rounded-lg border ${sr.default} ${ma.surface} p-4 flex gap-3`,children:[D.jsx("div",{className:"w-1 min-h-8 rounded-full shrink-0",style:{backgroundColor:w.hex??w.solid}}),D.jsxs("div",{className:"min-w-0 flex-1",children:[D.jsx("p",{className:`text-sm ${Jt.body} leading-snug`,children:y.highlighted_text||"(No text captured)"}),y.note?.content&&D.jsx("p",{className:`text-xs ${Jt.muted} mt-2 italic`,children:y.note.content}),D.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[D.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:w.hex??w.solid,backgroundColor:`${w.hex??w.solid}18`},children:S}),D.jsxs("span",{className:`text-[11px] ${Jt.muted}`,children:["p.",y.page_number]})]})]})]},y.id)})}):D.jsxs("div",{className:`py-12 text-center ${Jt.muted} text-sm`,children:[D.jsx("p",{children:"No highlights yet."}),D.jsx("p",{className:"mt-1",children:"Select text in the document to create highlights, then return here for a summary."}),D.jsx("button",{type:"button",onClick:()=>t(`/document/${r}`),className:`${to} mt-4`,children:"Open document"})]})})]}):(t("/",{replace:!0}),null)}function z2({onClose:r,onConfirm:t,isDeleting:e}){return D.jsx("div",{className:"fixed inset-0 bg-slate-950/40 backdrop-blur-sm flex items-center justify-center z-[1000]",onClick:r,children:D.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-[400px] mx-4 shadow-xl",onClick:i=>i.stopPropagation(),children:[D.jsx("h3",{className:"m-0 text-lg font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"Delete account?"}),D.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-600",style:{fontFamily:"'DM Sans', sans-serif"},children:"This will permanently delete your account and all your data. This cannot be undone."}),D.jsxs("div",{className:"flex justify-end gap-2",children:[D.jsx("button",{type:"button",onClick:r,disabled:e,className:"px-4 py-2 text-sm font-medium border border-slate-200 rounded-lg bg-white text-slate-600 hover:bg-slate-50",children:"Cancel"}),D.jsx("button",{type:"button",onClick:t,disabled:e,className:"px-4 py-2 text-sm font-medium rounded-lg text-white bg-red-600 hover:bg-red-700 disabled:opacity-70",children:e?D.jsxs(D.Fragment,{children:[D.jsx(Ds,{className:"w-4 h-4 animate-spin inline-block mr-1.5 align-middle"}),"Deleting"]}):"Delete account"})]})]})})}function H2(){const r=ya(),t=ba(p=>p.logout),[e,i]=I.useState(!1),[a,l]=I.useState(!1),[c,u]=I.useState(""),d=()=>{t(),r("/login",{replace:!0})},f=async()=>{u(""),l(!0);try{await fl.deleteAccount(),t(),r("/",{replace:!0})}catch(p){u(p.response?.data?.detail||p.message||"Something went wrong."),l(!1)}};return D.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&display=swap",rel:"stylesheet"}),D.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:()=>r("/app"),className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Back to projects",children:D.jsx(rd,{className:"w-4 h-4"})}),D.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),D.jsx("button",{type:"button",onClick:d,className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:D.jsx(Nm,{className:"w-4 h-4"})})]}),D.jsxs("div",{className:"max-w-[560px] mx-auto px-6 py-10",children:[D.jsx("h1",{className:"m-0 text-[28px] font-normal text-slate-950 tracking-tight",style:{fontFamily:"'Instrument Serif', serif"},children:"Account settings"}),D.jsxs("section",{className:"mt-8 p-6 bg-white border border-slate-200 rounded-xl",children:[D.jsx("h2",{className:"text-base font-semibold text-slate-800 mb-1",children:"Delete account"}),D.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Permanently delete your account and all your projects and documents."}),D.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-4 py-2 text-sm font-medium rounded-lg text-red-600 border border-red-200 bg-white hover:bg-red-50",children:"Delete account"})]}),c&&D.jsx("p",{className:"mt-4 text-sm text-red-600",children:c})]}),e&&D.jsx(z2,{onClose:()=>!a&&i(!1),onConfirm:f,isDeleting:a})]})}const q2=new jA({defaultOptions:{queries:{staleTime:3e4,retry:1}}});function Dc({children:r}){return ba(e=>e.token)?r:D.jsx(Hh,{to:"/login",replace:!0})}function _v({children:r}){return ba(e=>e.token)?D.jsx(Hh,{to:"/app",replace:!0}):r}function G2(){return D.jsx(FA,{client:q2,children:D.jsx(iA,{children:D.jsxs(kS,{children:[D.jsx(_s,{path:"/login",element:D.jsx(_v,{children:D.jsx(k_,{})})}),D.jsx(_s,{path:"/register",element:D.jsx(_v,{children:D.jsx(L_,{})})}),D.jsx(_s,{path:"/",element:D.jsx(Hh,{to:"/app",replace:!0})}),D.jsx(_s,{path:"/app",element:D.jsx(Dc,{children:D.jsx(SC,{})})}),D.jsx(_s,{path:"/app/settings",element:D.jsx(Dc,{children:D.jsx(H2,{})})}),D.jsx(_s,{path:"/project/:projectId",element:D.jsx(Dc,{children:D.jsx(RC,{})})}),D.jsx(_s,{path:"/document/:id",element:D.jsx(Dc,{children:D.jsx(I2,{})})}),D.jsx(_s,{path:"/document/:id/summary",element:D.jsx(Dc,{children:D.jsx(U2,{})})}),D.jsx(_s,{path:"*",element:D.jsx(Hh,{to:"/app",replace:!0})})]})})})}B1.createRoot(document.getElementById("root")).render(D.jsx(I.StrictMode,{children:D.jsx(G2,{})}));
