var Qb=r=>{throw TypeError(r)};var dp=(r,t,e)=>t.has(r)||Qb("Cannot "+e);var Ke=(r,t,e)=>(dp(r,t,"read from private field"),e?e.call(r):t.get(r)),bs=(r,t,e)=>t.has(r)?Qb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),oi=(r,t,e,i)=>(dp(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),vs=(r,t,e)=>(dp(r,t,"access private method"),e);var Wb=(r,t,e,i)=>({set _(a){oi(r,t,a,e)},get _(){return Ke(r,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=e(a);fetch(a.href,l)}})();var C1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ev(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var fp={exports:{}},vc={};var Zb;function T1(){if(Zb)return vc;Zb=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var u in a)u!=="key"&&(l[u]=a[u])}else l=a;return a=l.ref,{$$typeof:r,type:i,key:c,ref:a!==void 0?a:null,props:l}}return vc.Fragment=t,vc.jsx=e,vc.jsxs=e,vc}var Jb;function R1(){return Jb||(Jb=1,fp.exports=T1()),fp.exports}var D=R1(),pp={exports:{}},ae={};var t0;function M1(){if(t0)return ae;t0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),w=Symbol.iterator;function A(U){return U===null||typeof U!="object"?null:(U=w&&U[w]||U["@@iterator"],typeof U=="function"?U:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,C={};function M(U,J,mt){this.props=U,this.context=J,this.refs=C,this.updater=mt||_}M.prototype.isReactComponent={},M.prototype.setState=function(U,J){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,J,"setState")},M.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function N(){}N.prototype=M.prototype;function k(U,J,mt){this.props=U,this.context=J,this.refs=C,this.updater=mt||_}var j=k.prototype=new N;j.constructor=k,S(j,M.prototype),j.isPureReactComponent=!0;var F=Array.isArray;function z(){}var H={H:null,A:null,T:null,S:null},ut=Object.prototype.hasOwnProperty;function ft(U,J,mt){var xt=mt.ref;return{$$typeof:r,type:U,key:J,ref:xt!==void 0?xt:null,props:mt}}function _t(U,J){return ft(U.type,J,U.props)}function ct(U){return typeof U=="object"&&U!==null&&U.$$typeof===r}function Rt(U){var J={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(mt){return J[mt]})}var Lt=/\/+/g;function Bt(U,J){return typeof U=="object"&&U!==null&&U.key!=null?Rt(""+U.key):J.toString(36)}function $t(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(z,z):(U.status="pending",U.then(function(J){U.status==="pending"&&(U.status="fulfilled",U.value=J)},function(J){U.status==="pending"&&(U.status="rejected",U.reason=J)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function G(U,J,mt,xt,It){var Ut=typeof U;(Ut==="undefined"||Ut==="boolean")&&(U=null);var Ot=!1;if(U===null)Ot=!0;else switch(Ut){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(U.$$typeof){case r:case t:Ot=!0;break;case p:return Ot=U._init,G(Ot(U._payload),J,mt,xt,It)}}if(Ot)return It=It(U),Ot=xt===""?"."+Bt(U,0):xt,F(It)?(mt="",Ot!=null&&(mt=Ot.replace(Lt,"$&/")+"/"),G(It,J,mt,"",function(kt){return kt})):It!=null&&(ct(It)&&(It=_t(It,mt+(It.key==null||U&&U.key===It.key?"":(""+It.key).replace(Lt,"$&/")+"/")+Ot)),J.push(It)),1;Ot=0;var Tt=xt===""?".":xt+":";if(F(U))for(var jt=0;jt<U.length;jt++)xt=U[jt],Ut=Tt+Bt(xt,jt),Ot+=G(xt,J,mt,Ut,It);else if(jt=A(U),typeof jt=="function")for(U=jt.call(U),jt=0;!(xt=U.next()).done;)xt=xt.value,Ut=Tt+Bt(xt,jt++),Ot+=G(xt,J,mt,Ut,It);else if(Ut==="object"){if(typeof U.then=="function")return G($t(U),J,mt,xt,It);throw J=String(U),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function st(U,J,mt){if(U==null)return U;var xt=[],It=0;return G(U,xt,"","",function(Ut){return J.call(mt,Ut,It++)}),xt}function wt(U){if(U._status===-1){var J=U._result;J=J(),J.then(function(mt){(U._status===0||U._status===-1)&&(U._status=1,U._result=mt)},function(mt){(U._status===0||U._status===-1)&&(U._status=2,U._result=mt)}),U._status===-1&&(U._status=0,U._result=J)}if(U._status===1)return U._result.default;throw U._result}var Xt=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)},Ct={map:st,forEach:function(U,J,mt){st(U,function(){J.apply(this,arguments)},mt)},count:function(U){var J=0;return st(U,function(){J++}),J},toArray:function(U){return st(U,function(J){return J})||[]},only:function(U){if(!ct(U))throw Error("React.Children.only expected to receive a single React element child.");return U}};return ae.Activity=y,ae.Children=Ct,ae.Component=M,ae.Fragment=e,ae.Profiler=a,ae.PureComponent=k,ae.StrictMode=i,ae.Suspense=d,ae.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,ae.__COMPILER_RUNTIME={__proto__:null,c:function(U){return H.H.useMemoCache(U)}},ae.cache=function(U){return function(){return U.apply(null,arguments)}},ae.cacheSignal=function(){return null},ae.cloneElement=function(U,J,mt){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var xt=S({},U.props),It=U.key;if(J!=null)for(Ut in J.key!==void 0&&(It=""+J.key),J)!ut.call(J,Ut)||Ut==="key"||Ut==="__self"||Ut==="__source"||Ut==="ref"&&J.ref===void 0||(xt[Ut]=J[Ut]);var Ut=arguments.length-2;if(Ut===1)xt.children=mt;else if(1<Ut){for(var Ot=Array(Ut),Tt=0;Tt<Ut;Tt++)Ot[Tt]=arguments[Tt+2];xt.children=Ot}return ft(U.type,It,xt)},ae.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},ae.createElement=function(U,J,mt){var xt,It={},Ut=null;if(J!=null)for(xt in J.key!==void 0&&(Ut=""+J.key),J)ut.call(J,xt)&&xt!=="key"&&xt!=="__self"&&xt!=="__source"&&(It[xt]=J[xt]);var Ot=arguments.length-2;if(Ot===1)It.children=mt;else if(1<Ot){for(var Tt=Array(Ot),jt=0;jt<Ot;jt++)Tt[jt]=arguments[jt+2];It.children=Tt}if(U&&U.defaultProps)for(xt in Ot=U.defaultProps,Ot)It[xt]===void 0&&(It[xt]=Ot[xt]);return ft(U,Ut,It)},ae.createRef=function(){return{current:null}},ae.forwardRef=function(U){return{$$typeof:u,render:U}},ae.isValidElement=ct,ae.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:wt}},ae.memo=function(U,J){return{$$typeof:f,type:U,compare:J===void 0?null:J}},ae.startTransition=function(U){var J=H.T,mt={};H.T=mt;try{var xt=U(),It=H.S;It!==null&&It(mt,xt),typeof xt=="object"&&xt!==null&&typeof xt.then=="function"&&xt.then(z,Xt)}catch(Ut){Xt(Ut)}finally{J!==null&&mt.types!==null&&(J.types=mt.types),H.T=J}},ae.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},ae.use=function(U){return H.H.use(U)},ae.useActionState=function(U,J,mt){return H.H.useActionState(U,J,mt)},ae.useCallback=function(U,J){return H.H.useCallback(U,J)},ae.useContext=function(U){return H.H.useContext(U)},ae.useDebugValue=function(){},ae.useDeferredValue=function(U,J){return H.H.useDeferredValue(U,J)},ae.useEffect=function(U,J){return H.H.useEffect(U,J)},ae.useEffectEvent=function(U){return H.H.useEffectEvent(U)},ae.useId=function(){return H.H.useId()},ae.useImperativeHandle=function(U,J,mt){return H.H.useImperativeHandle(U,J,mt)},ae.useInsertionEffect=function(U,J){return H.H.useInsertionEffect(U,J)},ae.useLayoutEffect=function(U,J){return H.H.useLayoutEffect(U,J)},ae.useMemo=function(U,J){return H.H.useMemo(U,J)},ae.useOptimistic=function(U,J){return H.H.useOptimistic(U,J)},ae.useReducer=function(U,J,mt){return H.H.useReducer(U,J,mt)},ae.useRef=function(U){return H.H.useRef(U)},ae.useState=function(U){return H.H.useState(U)},ae.useSyncExternalStore=function(U,J,mt){return H.H.useSyncExternalStore(U,J,mt)},ae.useTransition=function(){return H.H.useTransition()},ae.version="19.2.4",ae}var e0;function dm(){return e0||(e0=1,pp.exports=M1()),pp.exports}var I=dm();const mh=Ev(I);var mp={exports:{}},wc={},gp={exports:{}},yp={};var n0;function D1(){return n0||(n0=1,(function(r){function t(G,st){var wt=G.length;G.push(st);t:for(;0<wt;){var Xt=wt-1>>>1,Ct=G[Xt];if(0<a(Ct,st))G[Xt]=st,G[wt]=Ct,wt=Xt;else break t}}function e(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var st=G[0],wt=G.pop();if(wt!==st){G[0]=wt;t:for(var Xt=0,Ct=G.length,U=Ct>>>1;Xt<U;){var J=2*(Xt+1)-1,mt=G[J],xt=J+1,It=G[xt];if(0>a(mt,wt))xt<Ct&&0>a(It,mt)?(G[Xt]=It,G[xt]=wt,Xt=xt):(G[Xt]=mt,G[J]=wt,Xt=J);else if(xt<Ct&&0>a(It,wt))G[Xt]=It,G[xt]=wt,Xt=xt;else break t}}return st}function a(G,st){var wt=G.sortIndex-st.sortIndex;return wt!==0?wt:G.id-st.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;r.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();r.unstable_now=function(){return c.now()-u}}var d=[],f=[],p=1,y=null,w=3,A=!1,_=!1,S=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function j(G){for(var st=e(f);st!==null;){if(st.callback===null)i(f);else if(st.startTime<=G)i(f),st.sortIndex=st.expirationTime,t(d,st);else break;st=e(f)}}function F(G){if(S=!1,j(G),!_)if(e(d)!==null)_=!0,z||(z=!0,Rt());else{var st=e(f);st!==null&&$t(F,st.startTime-G)}}var z=!1,H=-1,ut=5,ft=-1;function _t(){return C?!0:!(r.unstable_now()-ft<ut)}function ct(){if(C=!1,z){var G=r.unstable_now();ft=G;var st=!0;try{t:{_=!1,S&&(S=!1,N(H),H=-1),A=!0;var wt=w;try{e:{for(j(G),y=e(d);y!==null&&!(y.expirationTime>G&&_t());){var Xt=y.callback;if(typeof Xt=="function"){y.callback=null,w=y.priorityLevel;var Ct=Xt(y.expirationTime<=G);if(G=r.unstable_now(),typeof Ct=="function"){y.callback=Ct,j(G),st=!0;break e}y===e(d)&&i(d),j(G)}else i(d);y=e(d)}if(y!==null)st=!0;else{var U=e(f);U!==null&&$t(F,U.startTime-G),st=!1}}break t}finally{y=null,w=wt,A=!1}st=void 0}}finally{st?Rt():z=!1}}}var Rt;if(typeof k=="function")Rt=function(){k(ct)};else if(typeof MessageChannel<"u"){var Lt=new MessageChannel,Bt=Lt.port2;Lt.port1.onmessage=ct,Rt=function(){Bt.postMessage(null)}}else Rt=function(){M(ct,0)};function $t(G,st){H=M(function(){G(r.unstable_now())},st)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(G){G.callback=null},r.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ut=0<G?Math.floor(1e3/G):5},r.unstable_getCurrentPriorityLevel=function(){return w},r.unstable_next=function(G){switch(w){case 1:case 2:case 3:var st=3;break;default:st=w}var wt=w;w=st;try{return G()}finally{w=wt}},r.unstable_requestPaint=function(){C=!0},r.unstable_runWithPriority=function(G,st){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var wt=w;w=G;try{return st()}finally{w=wt}},r.unstable_scheduleCallback=function(G,st,wt){var Xt=r.unstable_now();switch(typeof wt=="object"&&wt!==null?(wt=wt.delay,wt=typeof wt=="number"&&0<wt?Xt+wt:Xt):wt=Xt,G){case 1:var Ct=-1;break;case 2:Ct=250;break;case 5:Ct=1073741823;break;case 4:Ct=1e4;break;default:Ct=5e3}return Ct=wt+Ct,G={id:p++,callback:st,priorityLevel:G,startTime:wt,expirationTime:Ct,sortIndex:-1},wt>Xt?(G.sortIndex=wt,t(f,G),e(d)===null&&G===e(f)&&(S?(N(H),H=-1):S=!0,$t(F,wt-Xt))):(G.sortIndex=Ct,t(d,G),_||A||(_=!0,z||(z=!0,Rt()))),G},r.unstable_shouldYield=_t,r.unstable_wrapCallback=function(G){var st=w;return function(){var wt=w;w=st;try{return G.apply(this,arguments)}finally{w=wt}}}})(yp)),yp}var i0;function O1(){return i0||(i0=1,gp.exports=D1()),gp.exports}var bp={exports:{}},Vn={};var s0;function N1(){if(s0)return Vn;s0=1;var r=dm();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(d,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:p}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Vn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Vn.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(d,f,null,p)},Vn.flushSync=function(d){var f=c.T,p=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=f,i.p=p,i.d.f()}},Vn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Vn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Vn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),w=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:w,fetchPriority:A}):p==="script"&&i.d.X(d,{crossOrigin:y,integrity:w,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Vn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Vn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);i.d.L(d,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Vn.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Vn.requestFormReset=function(d){i.d.r(d)},Vn.unstable_batchedUpdates=function(d,f){return d(f)},Vn.useFormState=function(d,f,p){return c.H.useFormState(d,f,p)},Vn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Vn.version="19.2.4",Vn}var a0;function _v(){if(a0)return bp.exports;a0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),bp.exports=N1(),bp.exports}var r0;function k1(){if(r0)return wc;r0=1;var r=O1(),t=dm(),e=_v();function i(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,o=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(o=s.return),n=s.return;while(n)}return s.tag===3?o:null}function c(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function u(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function d(n){if(l(n)!==n)throw Error(i(188))}function f(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(i(188));return s!==n?null:n}for(var o=n,h=s;;){var g=o.return;if(g===null)break;var b=g.alternate;if(b===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===o)return d(g),n;if(b===h)return d(g),s;b=b.sibling}throw Error(i(188))}if(o.return!==h.return)o=g,h=b;else{for(var T=!1,L=g.child;L;){if(L===o){T=!0,o=g,h=b;break}if(L===h){T=!0,h=g,o=b;break}L=L.sibling}if(!T){for(L=b.child;L;){if(L===o){T=!0,o=b,h=g;break}if(L===h){T=!0,h=b,o=g;break}L=L.sibling}if(!T)throw Error(i(189))}}if(o.alternate!==h)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:s}function p(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=p(n),s!==null)return s;n=n.sibling}return null}var y=Object.assign,w=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),ft=Symbol.for("react.activity"),_t=Symbol.for("react.memo_cache_sentinel"),ct=Symbol.iterator;function Rt(n){return n===null||typeof n!="object"?null:(n=ct&&n[ct]||n["@@iterator"],typeof n=="function"?n:null)}var Lt=Symbol.for("react.client.reference");function Bt(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===Lt?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case S:return"Fragment";case M:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case z:return"SuspenseList";case ft:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case _:return"Portal";case k:return n.displayName||"Context";case N:return(n._context.displayName||"Context")+".Consumer";case j:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case H:return s=n.displayName||null,s!==null?s:Bt(n.type)||"Memo";case ut:s=n._payload,n=n._init;try{return Bt(n(s))}catch{}}return null}var $t=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,wt={pending:!1,data:null,method:null,action:null},Xt=[],Ct=-1;function U(n){return{current:n}}function J(n){0>Ct||(n.current=Xt[Ct],Xt[Ct]=null,Ct--)}function mt(n,s){Ct++,Xt[Ct]=n.current,n.current=s}var xt=U(null),It=U(null),Ut=U(null),Ot=U(null);function Tt(n,s){switch(mt(Ut,s),mt(It,n),mt(xt,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?vb(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=vb(s),n=wb(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}J(xt),mt(xt,n)}function jt(){J(xt),J(It),J(Ut)}function kt(n){n.memoizedState!==null&&mt(Ot,n);var s=xt.current,o=wb(s,n.type);s!==o&&(mt(It,n),mt(xt,o))}function we(n){It.current===n&&(J(xt),J(It)),Ot.current===n&&(J(Ot),mc._currentValue=wt)}var pt,he;function ge(n){if(pt===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);pt=s&&s[1]||"",he=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pt+n+he}var An=!1;function Gi(n,s){if(!n||An)return"";An=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var vt=function(){throw Error()};if(Object.defineProperty(vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(vt,[])}catch(dt){var lt=dt}Reflect.construct(n,[],vt)}else{try{vt.call()}catch(dt){lt=dt}n.call(vt.prototype)}}else{try{throw Error()}catch(dt){lt=dt}(vt=n())&&typeof vt.catch=="function"&&vt.catch(function(){})}}catch(dt){if(dt&&lt&&typeof dt.stack=="string")return[dt.stack,lt.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=h.DetermineComponentFrameRoot(),T=b[0],L=b[1];if(T&&L){var q=T.split(`
`),rt=L.split(`
`);for(g=h=0;h<q.length&&!q[h].includes("DetermineComponentFrameRoot");)h++;for(;g<rt.length&&!rt[g].includes("DetermineComponentFrameRoot");)g++;if(h===q.length||g===rt.length)for(h=q.length-1,g=rt.length-1;1<=h&&0<=g&&q[h]!==rt[g];)g--;for(;1<=h&&0<=g;h--,g--)if(q[h]!==rt[g]){if(h!==1||g!==1)do if(h--,g--,0>g||q[h]!==rt[g]){var yt=`
`+q[h].replace(" at new "," at ");return n.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",n.displayName)),yt}while(1<=h&&0<=g);break}}}finally{An=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?ge(o):""}function ar(n,s){switch(n.tag){case 26:case 27:case 5:return ge(n.type);case 16:return ge("Lazy");case 13:return n.child!==s&&s!==null?ge("Suspense Fallback"):ge("Suspense");case 19:return ge("SuspenseList");case 0:case 15:return Gi(n.type,!1);case 11:return Gi(n.type.render,!1);case 1:return Gi(n.type,!0);case 31:return ge("Activity");default:return""}}function tu(n){try{var s="",o=null;do s+=ar(n,o),o=n,n=n.return;while(n);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var bl=Object.prototype.hasOwnProperty,rr=r.unstable_scheduleCallback,ti=r.unstable_cancelCallback,eu=r.unstable_shouldYield,or=r.unstable_requestPaint,In=r.unstable_now,lr=r.unstable_getCurrentPriorityLevel,Un=r.unstable_ImmediatePriority,ns=r.unstable_UserBlockingPriority,pa=r.unstable_NormalPriority,cr=r.unstable_LowPriority,eo=r.unstable_IdlePriority,no=r.log,Ms=r.unstable_setDisableYieldValue,is=null,Mn=null;function Dn(n){if(typeof no=="function"&&Ms(n),Mn&&typeof Mn.setStrictMode=="function")try{Mn.setStrictMode(is,n)}catch{}}var Ft=Math.clz32?Math.clz32:io,ur=Math.log,Ds=Math.LN2;function io(n){return n>>>=0,n===0?32:31-(ur(n)/Ds|0)|0}var Nt=256,ma=262144,hr=4194304;function Vi(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function dr(n,s,o){var h=n.pendingLanes;if(h===0)return 0;var g=0,b=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var L=h&134217727;return L!==0?(h=L&~b,h!==0?g=Vi(h):(T&=L,T!==0?g=Vi(T):o||(o=L&~n,o!==0&&(g=Vi(o))))):(L=h&~b,L!==0?g=Vi(L):T!==0?g=Vi(T):o||(o=h&~n,o!==0&&(g=Vi(o)))),g===0?0:s!==0&&s!==g&&(s&b)===0&&(b=g&-g,o=s&-s,b>=o||b===32&&(o&4194048)!==0)?s:g}function Os(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function bd(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function nu(){var n=hr;return hr<<=1,(hr&62914560)===0&&(hr=4194304),n}function ss(n){for(var s=[],o=0;31>o;o++)s.push(n);return s}function Ti(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function vl(n,s,o,h,g,b){var T=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var L=n.entanglements,q=n.expirationTimes,rt=n.hiddenUpdates;for(o=T&~o;0<o;){var yt=31-Ft(o),vt=1<<yt;L[yt]=0,q[yt]=-1;var lt=rt[yt];if(lt!==null)for(rt[yt]=null,yt=0;yt<lt.length;yt++){var dt=lt[yt];dt!==null&&(dt.lane&=-536870913)}o&=~vt}h!==0&&fr(n,h,0),b!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=b&~(T&~s))}function fr(n,s,o){n.pendingLanes|=s,n.suspendedLanes&=~s;var h=31-Ft(s);n.entangledLanes|=s,n.entanglements[h]=n.entanglements[h]|1073741824|o&261930}function Ie(n,s){var o=n.entangledLanes|=s;for(n=n.entanglements;o;){var h=31-Ft(o),g=1<<h;g&s|n[h]&s&&(n[h]|=s),o&=~g}}function nn(n,s){var o=s&-s;return o=(o&42)!==0?1:wl(o),(o&(n.suspendedLanes|s))!==0?0:o}function wl(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function ga(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function pr(){var n=st.p;return n!==0?n:(n=window.event,n===void 0?32:qb(n.type))}function mr(n,s){var o=st.p;try{return st.p=n,s()}finally{st.p=o}}var as=Math.random().toString(36).slice(2),ze="__reactFiber$"+as,sn="__reactProps$"+as,Xn="__reactContainer$"+as,ya="__reactEvents$"+as,vd="__reactListeners$"+as,rs="__reactHandles$"+as,xl="__reactResources$"+as,fi="__reactMarker$"+as;function so(n){delete n[ze],delete n[sn],delete n[ya],delete n[vd],delete n[rs]}function os(n){var s=n[ze];if(s)return s;for(var o=n.parentNode;o;){if(s=o[Xn]||o[ze]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(n=Tb(n);n!==null;){if(o=n[ze])return o;n=Tb(n)}return s}n=o,o=n.parentNode}return null}function ke(n){if(n=n[ze]||n[Xn]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function pi(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(i(33))}function zn(n){var s=n[xl];return s||(s=n[xl]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function an(n){n[fi]=!0}var Ns=new Set,gr={};function $i(n,s){ls(n,s),ls(n+"Capture",s)}function ls(n,s){for(gr[n]=s,n=0;n<s.length;n++)Ns.add(s[n])}var ks=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Al={},yr={};function iu(n){return bl.call(yr,n)?!0:bl.call(Al,n)?!1:ks.test(n)?yr[n]=!0:(Al[n]=!0,!1)}function ce(n,s,o){if(iu(s))if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+o)}}function br(n,s,o){if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+o)}}function Ri(n,s,o,h){if(h===null)n.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(s,o,""+h)}}function On(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function ba(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function su(n,s,o){var h=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,b=h.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return g.call(this)},set:function(T){o=""+T,b.call(this,T)}}),Object.defineProperty(n,s,{enumerable:h.enumerable}),{getValue:function(){return o},setValue:function(T){o=""+T},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function ao(n){if(!n._valueTracker){var s=ba(n)?"checked":"value";n._valueTracker=su(n,s,""+n[s])}}function Sl(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return n&&(h=ba(n)?n.checked?"true":"false":n.value),n=h,n!==o?(s.setValue(n),!0):!1}function Se(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var vr=/[\n"\\]/g;function Sn(n){return n.replace(vr,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function cs(n,s,o,h,g,b,T,L){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),s!=null?T==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+On(s)):n.value!==""+On(s)&&(n.value=""+On(s)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),s!=null?wr(n,T,On(s)):o!=null?wr(n,T,On(o)):h!=null&&n.removeAttribute("value"),g==null&&b!=null&&(n.defaultChecked=!!b),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?n.name=""+On(L):n.removeAttribute("name")}function ro(n,s,o,h,g,b,T,L){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.type=b),s!=null||o!=null){if(!(b!=="submit"&&b!=="reset"||s!=null)){ao(n);return}o=o!=null?""+On(o):"",s=s!=null?""+On(s):o,L||s===n.value||(n.value=s),n.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,n.checked=L?n.checked:!!h,n.defaultChecked=!!h,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),ao(n)}function wr(n,s,o){s==="number"&&Se(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Ki(n,s,o,h){if(n=n.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<n.length;o++)g=s.hasOwnProperty("$"+n[o].value),n[o].selected!==g&&(n[o].selected=g),g&&h&&(n[o].defaultSelected=!0)}else{for(o=""+On(o),s=null,g=0;g<n.length;g++){if(n[g].value===o){n[g].selected=!0,h&&(n[g].defaultSelected=!0);return}s!==null||n[g].disabled||(s=n[g])}s!==null&&(s.selected=!0)}}function El(n,s,o){if(s!=null&&(s=""+On(s),s!==n.value&&(n.value=s),o==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=o!=null?""+On(o):""}function xr(n,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(i(92));if($t(h)){if(1<h.length)throw Error(i(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=On(s),n.defaultValue=o,h=n.textContent,h===o&&h!==""&&h!==null&&(n.value=h),ao(n)}function Ls(n,s){if(s){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=s;return}}n.textContent=s}var wd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ye(n,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":h?n.setProperty(s,o):typeof o!="number"||o===0||wd.has(s)?s==="float"?n.cssFloat=o:n[s]=(""+o).trim():n[s]=o+"px"}function _l(n,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(n=n.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?n.setProperty(h,""):h==="float"?n.cssFloat="":n[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&o[g]!==h&&ye(n,g,h)}else for(var b in s)s.hasOwnProperty(b)&&ye(n,b,s[b])}function Cl(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var xd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Yn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xi(n){return Yn.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ei(){}var Mi=null;function oo(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ps=null,He=null;function mi(n){var s=ke(n);if(s&&(n=s.stateNode)){var o=n[sn]||null;t:switch(n=s.stateNode,s.type){case"input":if(cs(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Sn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==n&&h.form===n.form){var g=h[sn]||null;if(!g)throw Error(i(90));cs(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===n.form&&Sl(h)}break t;case"textarea":El(n,o.value,o.defaultValue);break t;case"select":s=o.value,s!=null&&Ki(n,!!o.multiple,s,!1)}}}var Bs=!1;function va(n,s,o){if(Bs)return n(s,o);Bs=!0;try{var h=n(s);return h}finally{if(Bs=!1,(Ps!==null||He!==null)&&(Ku(),Ps&&(s=Ps,n=He,He=Ps=null,mi(s),n)))for(s=0;s<n.length;s++)mi(n[s])}}function js(n,s){var o=n.stateNode;if(o===null)return null;var h=o[sn]||null;if(h===null)return null;o=h[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break t;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var En=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tl=!1;if(En)try{var Hn={};Object.defineProperty(Hn,"passive",{get:function(){Tl=!0}}),window.addEventListener("test",Hn,Hn),window.removeEventListener("test",Hn,Hn)}catch{Tl=!1}var Di=null,lo=null,wa=null;function xa(){if(wa)return wa;var n,s=lo,o=s.length,h,g="value"in Di?Di.value:Di.textContent,b=g.length;for(n=0;n<o&&s[n]===g[n];n++);var T=o-n;for(h=1;h<=T&&s[o-h]===g[b-h];h++);return wa=g.slice(n,1<h?1-h:void 0)}function Aa(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function Ar(){return!0}function au(){return!1}function un(n){function s(o,h,g,b,T){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=b,this.target=T,this.currentTarget=null;for(var L in n)n.hasOwnProperty(L)&&(o=n[L],this[L]=o?o(b):b[L]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Ar:au,this.isPropagationStopped=au,this}return y(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ar)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ar)},persist:function(){},isPersistent:Ar}),s}var Fs={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},co=un(Fs),us=y({},Fs,{view:0,detail:0}),uo=un(us),Sr,Rl,Er,ho=y({},us,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Is,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Er&&(Er&&n.type==="mousemove"?(Sr=n.screenX-Er.screenX,Rl=n.screenY-Er.screenY):Rl=Sr=0,Er=n),Sr)},movementY:function(n){return"movementY"in n?n.movementY:Rl}}),fo=un(ho),Ml=y({},ho,{dataTransfer:0}),ru=un(Ml),po=y({},us,{relatedTarget:0}),Sa=un(po),mo=y({},Fs,{animationName:0,elapsedTime:0,pseudoElement:0}),ou=un(mo),Ad=y({},Fs,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Ea=un(Ad),Dl=y({},Fs,{data:0}),go=un(Dl),Ol={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _r(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=_n[n])?!!s[n]:!1}function Is(){return _r}var lu=y({},us,{key:function(n){if(n.key){var s=Ol[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Aa(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Nl[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Is,charCode:function(n){return n.type==="keypress"?Aa(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Aa(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),yo=un(lu),cu=y({},ho,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),kl=un(cu),bo=y({},us,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Is}),Ll=un(bo),Us=y({},Fs,{propertyName:0,elapsedTime:0,pseudoElement:0}),Pl=un(Us),Bl=y({},ho,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),vo=un(Bl),jl=y({},Fs,{newState:0,oldState:0}),uu=un(jl),Sd=[9,13,27,32],Cr=En&&"CompositionEvent"in window,hs=null;En&&"documentMode"in document&&(hs=document.documentMode);var Ed=En&&"TextEvent"in window&&!hs,wo=En&&(!Cr||hs&&8<hs&&11>=hs),xo=" ",hu=!1;function Fl(n,s){switch(n){case"keyup":return Sd.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function du(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var zs=!1;function fu(n,s){switch(n){case"compositionend":return du(s);case"keypress":return s.which!==32?null:(hu=!0,xo);case"textInput":return n=s.data,n===xo&&hu?null:n;default:return null}}function _d(n,s){if(zs)return n==="compositionend"||!Cr&&Fl(n,s)?(n=xa(),wa=lo=Di=null,zs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return wo&&s.locale!=="ko"?null:s.data;default:return null}}var pu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ao(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!pu[n.type]:s==="textarea"}function Il(n,s,o,h){Ps?He?He.push(h):He=[h]:Ps=h,s=th(s,"onChange"),0<s.length&&(o=new co("onChange","change",null,o,h),n.push({event:o,listeners:s}))}var _a=null,Tr=null;function Cd(n){fb(n,0)}function So(n){var s=pi(n);if(Sl(s))return n}function Rr(n,s){if(n==="change")return s}var Oi=!1;if(En){var qe;if(En){var Ca="oninput"in document;if(!Ca){var Hs=document.createElement("div");Hs.setAttribute("oninput","return;"),Ca=typeof Hs.oninput=="function"}qe=Ca}else qe=!1;Oi=qe&&(!document.documentMode||9<document.documentMode)}function mu(){_a&&(_a.detachEvent("onpropertychange",Eo),Tr=_a=null)}function Eo(n){if(n.propertyName==="value"&&So(Tr)){var s=[];Il(s,Tr,n,oo(n)),va(Cd,s)}}function gu(n,s,o){n==="focusin"?(mu(),_a=s,Tr=o,_a.attachEvent("onpropertychange",Eo)):n==="focusout"&&mu()}function qs(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return So(Tr)}function Ul(n,s){if(n==="click")return So(s)}function Ta(n,s){if(n==="input"||n==="change")return So(s)}function ds(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var qn=typeof Object.is=="function"?Object.is:ds;function m(n,s){if(qn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var o=Object.keys(n),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!bl.call(s,g)||!qn(n[g],s[g]))return!1}return!0}function v(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function x(n,s){var o=v(n);n=0;for(var h;o;){if(o.nodeType===3){if(h=n+o.textContent.length,n<=s&&h>=s)return{node:o,offset:s-n};n=h}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=v(o)}}function E(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?E(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function R(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=Se(n.document);s instanceof n.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)n=s.contentWindow;else break;s=Se(n.document)}return s}function O(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var P=En&&"documentMode"in document&&11>=document.documentMode,B=null,$=null,et=null,K=!1;function V(n,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;K||B==null||B!==Se(h)||(h=B,"selectionStart"in h&&O(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),et&&m(et,h)||(et=h,h=th($,"onSelect"),0<h.length&&(s=new co("onSelect","select",null,s,o),n.push({event:s,listeners:h}),s.target=B)))}function Q(n,s){var o={};return o[n.toLowerCase()]=s.toLowerCase(),o["Webkit"+n]="webkit"+s,o["Moz"+n]="moz"+s,o}var Z={animationend:Q("Animation","AnimationEnd"),animationiteration:Q("Animation","AnimationIteration"),animationstart:Q("Animation","AnimationStart"),transitionrun:Q("Transition","TransitionRun"),transitionstart:Q("Transition","TransitionStart"),transitioncancel:Q("Transition","TransitionCancel"),transitionend:Q("Transition","TransitionEnd")},X={},Y={};En&&(Y=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function it(n){if(X[n])return X[n];if(!Z[n])return n;var s=Z[n],o;for(o in s)if(s.hasOwnProperty(o)&&o in Y)return X[n]=s[o];return n}var ot=it("animationend"),nt=it("animationiteration"),gt=it("animationstart"),At=it("transitionrun"),Mt=it("transitionstart"),Dt=it("transitioncancel"),St=it("transitionend"),zt=new Map,Pt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pt.push("scrollEnd");function Et(n,s){zt.set(n,s),$i(s,[n])}var Ht=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},ee=[],ue=0,Yt=0;function se(){for(var n=ue,s=Yt=ue=0;s<n;){var o=ee[s];ee[s++]=null;var h=ee[s];ee[s++]=null;var g=ee[s];ee[s++]=null;var b=ee[s];if(ee[s++]=null,h!==null&&g!==null){var T=h.pending;T===null?g.next=g:(g.next=T.next,T.next=g),h.pending=g}b!==0&&fs(o,g,b)}}function Le(n,s,o,h){ee[ue++]=n,ee[ue++]=s,ee[ue++]=o,ee[ue++]=h,Yt|=h,n.lanes|=h,n=n.alternate,n!==null&&(n.lanes|=h)}function Gn(n,s,o,h){return Le(n,s,o,h),Ra(n)}function De(n,s){return Le(n,null,null,s),Ra(n)}function fs(n,s,o){n.lanes|=o;var h=n.alternate;h!==null&&(h.lanes|=o);for(var g=!1,b=n.return;b!==null;)b.childLanes|=o,h=b.alternate,h!==null&&(h.childLanes|=o),b.tag===22&&(n=b.stateNode,n===null||n._visibility&1||(g=!0)),n=b,b=b.return;return n.tag===3?(b=n.stateNode,g&&s!==null&&(g=31-Ft(o),n=b.hiddenUpdates,h=n[g],h===null?n[g]=[s]:h.push(s),s.lane=o|536870912),b):null}function Ra(n){if(50<lc)throw lc=0,Bf=null,Error(i(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var _o={};function cx(n,s,o,h){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gi(n,s,o,h){return new cx(n,s,o,h)}function Td(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Gs(n,s){var o=n.alternate;return o===null?(o=gi(n.tag,s,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=s,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,s=n.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Ym(n,s){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,s=o.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function yu(n,s,o,h,g,b){var T=0;if(h=n,typeof n=="function")Td(n)&&(T=1);else if(typeof n=="string")T=p1(n,o,xt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case ft:return n=gi(31,o,s,g),n.elementType=ft,n.lanes=b,n;case S:return Mr(o.children,g,b,s);case C:T=8,g|=24;break;case M:return n=gi(12,o,s,g|2),n.elementType=M,n.lanes=b,n;case F:return n=gi(13,o,s,g),n.elementType=F,n.lanes=b,n;case z:return n=gi(19,o,s,g),n.elementType=z,n.lanes=b,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case k:T=10;break t;case N:T=9;break t;case j:T=11;break t;case H:T=14;break t;case ut:T=16,h=null;break t}T=29,o=Error(i(130,n===null?"null":typeof n,"")),h=null}return s=gi(T,o,s,g),s.elementType=n,s.type=h,s.lanes=b,s}function Mr(n,s,o,h){return n=gi(7,n,h,s),n.lanes=o,n}function Rd(n,s,o){return n=gi(6,n,null,s),n.lanes=o,n}function Qm(n){var s=gi(18,null,null,0);return s.stateNode=n,s}function Md(n,s,o){return s=gi(4,n.children!==null?n.children:[],n.key,s),s.lanes=o,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var Wm=new WeakMap;function Ni(n,s){if(typeof n=="object"&&n!==null){var o=Wm.get(n);return o!==void 0?o:(s={value:n,source:s,stack:tu(s)},Wm.set(n,s),s)}return{value:n,source:s,stack:tu(s)}}var Co=[],To=0,bu=null,zl=0,ki=[],Li=0,Ma=null,ps=1,ms="";function Vs(n,s){Co[To++]=zl,Co[To++]=bu,bu=n,zl=s}function Zm(n,s,o){ki[Li++]=ps,ki[Li++]=ms,ki[Li++]=Ma,Ma=n;var h=ps;n=ms;var g=32-Ft(h)-1;h&=~(1<<g),o+=1;var b=32-Ft(s)+g;if(30<b){var T=g-g%5;b=(h&(1<<T)-1).toString(32),h>>=T,g-=T,ps=1<<32-Ft(s)+g|o<<g|h,ms=b+n}else ps=1<<b|o<<g|h,ms=n}function Dd(n){n.return!==null&&(Vs(n,1),Zm(n,1,0))}function Od(n){for(;n===bu;)bu=Co[--To],Co[To]=null,zl=Co[--To],Co[To]=null;for(;n===Ma;)Ma=ki[--Li],ki[Li]=null,ms=ki[--Li],ki[Li]=null,ps=ki[--Li],ki[Li]=null}function Jm(n,s){ki[Li++]=ps,ki[Li++]=ms,ki[Li++]=Ma,ps=s.id,ms=s.overflow,Ma=n}var Nn=null,Ge=null,be=!1,Da=null,Pi=!1,Nd=Error(i(519));function Oa(n){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Hl(Ni(s,n)),Nd}function tg(n){var s=n.stateNode,o=n.type,h=n.memoizedProps;switch(s[ze]=n,s[sn]=h,o){case"dialog":fe("cancel",s),fe("close",s);break;case"iframe":case"object":case"embed":fe("load",s);break;case"video":case"audio":for(o=0;o<uc.length;o++)fe(uc[o],s);break;case"source":fe("error",s);break;case"img":case"image":case"link":fe("error",s),fe("load",s);break;case"details":fe("toggle",s);break;case"input":fe("invalid",s),ro(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":fe("invalid",s);break;case"textarea":fe("invalid",s),xr(s,h.value,h.defaultValue,h.children)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||yb(s.textContent,o)?(h.popover!=null&&(fe("beforetoggle",s),fe("toggle",s)),h.onScroll!=null&&fe("scroll",s),h.onScrollEnd!=null&&fe("scrollend",s),h.onClick!=null&&(s.onclick=ei),s=!0):s=!1,s||Oa(n,!0)}function eg(n){for(Nn=n.return;Nn;)switch(Nn.tag){case 5:case 31:case 13:Pi=!1;return;case 27:case 3:Pi=!0;return;default:Nn=Nn.return}}function Ro(n){if(n!==Nn)return!1;if(!be)return eg(n),be=!0,!1;var s=n.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Wf(n.type,n.memoizedProps)),o=!o),o&&Ge&&Oa(n),eg(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Ge=Cb(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Ge=Cb(n)}else s===27?(s=Ge,Va(n.type)?(n=np,np=null,Ge=n):Ge=s):Ge=Nn?ji(n.stateNode.nextSibling):null;return!0}function Dr(){Ge=Nn=null,be=!1}function kd(){var n=Da;return n!==null&&(ai===null?ai=n:ai.push.apply(ai,n),Da=null),n}function Hl(n){Da===null?Da=[n]:Da.push(n)}var Ld=U(null),Or=null,$s=null;function Na(n,s,o){mt(Ld,s._currentValue),s._currentValue=o}function Ks(n){n._currentValue=Ld.current,J(Ld)}function Pd(n,s,o){for(;n!==null;){var h=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),n===o)break;n=n.return}}function Bd(n,s,o,h){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var b=g.dependencies;if(b!==null){var T=g.child;b=b.firstContext;t:for(;b!==null;){var L=b;b=g;for(var q=0;q<s.length;q++)if(L.context===s[q]){b.lanes|=o,L=b.alternate,L!==null&&(L.lanes|=o),Pd(b.return,o,n),h||(T=null);break t}b=L.next}}else if(g.tag===18){if(T=g.return,T===null)throw Error(i(341));T.lanes|=o,b=T.alternate,b!==null&&(b.lanes|=o),Pd(T,o,n),T=null}else T=g.child;if(T!==null)T.return=g;else for(T=g;T!==null;){if(T===n){T=null;break}if(g=T.sibling,g!==null){g.return=T.return,T=g;break}T=T.return}g=T}}function Mo(n,s,o,h){n=null;for(var g=s,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var T=g.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var L=g.type;qn(g.pendingProps.value,T.value)||(n!==null?n.push(L):n=[L])}}else if(g===Ot.current){if(T=g.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(mc):n=[mc])}g=g.return}n!==null&&Bd(s,n,o,h),s.flags|=262144}function vu(n){for(n=n.firstContext;n!==null;){if(!qn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Nr(n){Or=n,$s=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function kn(n){return ng(Or,n)}function wu(n,s){return Or===null&&Nr(n),ng(n,s)}function ng(n,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},$s===null){if(n===null)throw Error(i(308));$s=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else $s=$s.next=s;return o}var ux=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(o,h){n.push(h)}};this.abort=function(){s.aborted=!0,n.forEach(function(o){return o()})}},hx=r.unstable_scheduleCallback,dx=r.unstable_NormalPriority,hn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function jd(){return{controller:new ux,data:new Map,refCount:0}}function ql(n){n.refCount--,n.refCount===0&&hx(dx,function(){n.controller.abort()})}var Gl=null,Fd=0,Do=0,Oo=null;function fx(n,s){if(Gl===null){var o=Gl=[];Fd=0,Do=Hf(),Oo={status:"pending",value:void 0,then:function(h){o.push(h)}}}return Fd++,s.then(ig,ig),s}function ig(){if(--Fd===0&&Gl!==null){Oo!==null&&(Oo.status="fulfilled");var n=Gl;Gl=null,Do=0,Oo=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function px(n,s){var o=[],h={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return n.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),h}var sg=G.S;G.S=function(n,s){zy=In(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&fx(n,s),sg!==null&&sg(n,s)};var kr=U(null);function Id(){var n=kr.current;return n!==null?n:Ue.pooledCache}function xu(n,s){s===null?mt(kr,kr.current):mt(kr,s.pool)}function ag(){var n=Id();return n===null?null:{parent:hn._currentValue,pool:n}}var No=Error(i(460)),Ud=Error(i(474)),Au=Error(i(542)),Su={then:function(){}};function rg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function og(n,s,o){switch(o=n[o],o===void 0?n.push(s):o!==s&&(s.then(ei,ei),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,cg(n),n;default:if(typeof s.status=="string")s.then(ei,ei);else{if(n=Ue,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=s,n.status="pending",n.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,cg(n),n}throw Pr=s,No}}function Lr(n){try{var s=n._init;return s(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Pr=o,No):o}}var Pr=null;function lg(){if(Pr===null)throw Error(i(459));var n=Pr;return Pr=null,n}function cg(n){if(n===No||n===Au)throw Error(i(483))}var ko=null,Vl=0;function Eu(n){var s=Vl;return Vl+=1,ko===null&&(ko=[]),og(ko,n,s)}function $l(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function _u(n,s){throw s.$$typeof===w?Error(i(525)):(n=Object.prototype.toString.call(s),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function ug(n){function s(tt,W){if(n){var at=tt.deletions;at===null?(tt.deletions=[W],tt.flags|=16):at.push(W)}}function o(tt,W){if(!n)return null;for(;W!==null;)s(tt,W),W=W.sibling;return null}function h(tt){for(var W=new Map;tt!==null;)tt.key!==null?W.set(tt.key,tt):W.set(tt.index,tt),tt=tt.sibling;return W}function g(tt,W){return tt=Gs(tt,W),tt.index=0,tt.sibling=null,tt}function b(tt,W,at){return tt.index=at,n?(at=tt.alternate,at!==null?(at=at.index,at<W?(tt.flags|=67108866,W):at):(tt.flags|=67108866,W)):(tt.flags|=1048576,W)}function T(tt){return n&&tt.alternate===null&&(tt.flags|=67108866),tt}function L(tt,W,at,bt){return W===null||W.tag!==6?(W=Rd(at,tt.mode,bt),W.return=tt,W):(W=g(W,at),W.return=tt,W)}function q(tt,W,at,bt){var Qt=at.type;return Qt===S?yt(tt,W,at.props.children,bt,at.key):W!==null&&(W.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===ut&&Lr(Qt)===W.type)?(W=g(W,at.props),$l(W,at),W.return=tt,W):(W=yu(at.type,at.key,at.props,null,tt.mode,bt),$l(W,at),W.return=tt,W)}function rt(tt,W,at,bt){return W===null||W.tag!==4||W.stateNode.containerInfo!==at.containerInfo||W.stateNode.implementation!==at.implementation?(W=Md(at,tt.mode,bt),W.return=tt,W):(W=g(W,at.children||[]),W.return=tt,W)}function yt(tt,W,at,bt,Qt){return W===null||W.tag!==7?(W=Mr(at,tt.mode,bt,Qt),W.return=tt,W):(W=g(W,at),W.return=tt,W)}function vt(tt,W,at){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Rd(""+W,tt.mode,at),W.return=tt,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case A:return at=yu(W.type,W.key,W.props,null,tt.mode,at),$l(at,W),at.return=tt,at;case _:return W=Md(W,tt.mode,at),W.return=tt,W;case ut:return W=Lr(W),vt(tt,W,at)}if($t(W)||Rt(W))return W=Mr(W,tt.mode,at,null),W.return=tt,W;if(typeof W.then=="function")return vt(tt,Eu(W),at);if(W.$$typeof===k)return vt(tt,wu(tt,W),at);_u(tt,W)}return null}function lt(tt,W,at,bt){var Qt=W!==null?W.key:null;if(typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint")return Qt!==null?null:L(tt,W,""+at,bt);if(typeof at=="object"&&at!==null){switch(at.$$typeof){case A:return at.key===Qt?q(tt,W,at,bt):null;case _:return at.key===Qt?rt(tt,W,at,bt):null;case ut:return at=Lr(at),lt(tt,W,at,bt)}if($t(at)||Rt(at))return Qt!==null?null:yt(tt,W,at,bt,null);if(typeof at.then=="function")return lt(tt,W,Eu(at),bt);if(at.$$typeof===k)return lt(tt,W,wu(tt,at),bt);_u(tt,at)}return null}function dt(tt,W,at,bt,Qt){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return tt=tt.get(at)||null,L(W,tt,""+bt,Qt);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case A:return tt=tt.get(bt.key===null?at:bt.key)||null,q(W,tt,bt,Qt);case _:return tt=tt.get(bt.key===null?at:bt.key)||null,rt(W,tt,bt,Qt);case ut:return bt=Lr(bt),dt(tt,W,at,bt,Qt)}if($t(bt)||Rt(bt))return tt=tt.get(at)||null,yt(W,tt,bt,Qt,null);if(typeof bt.then=="function")return dt(tt,W,at,Eu(bt),Qt);if(bt.$$typeof===k)return dt(tt,W,at,wu(W,bt),Qt);_u(W,bt)}return null}function Vt(tt,W,at,bt){for(var Qt=null,xe=null,Kt=W,le=W=0,me=null;Kt!==null&&le<at.length;le++){Kt.index>le?(me=Kt,Kt=null):me=Kt.sibling;var Ae=lt(tt,Kt,at[le],bt);if(Ae===null){Kt===null&&(Kt=me);break}n&&Kt&&Ae.alternate===null&&s(tt,Kt),W=b(Ae,W,le),xe===null?Qt=Ae:xe.sibling=Ae,xe=Ae,Kt=me}if(le===at.length)return o(tt,Kt),be&&Vs(tt,le),Qt;if(Kt===null){for(;le<at.length;le++)Kt=vt(tt,at[le],bt),Kt!==null&&(W=b(Kt,W,le),xe===null?Qt=Kt:xe.sibling=Kt,xe=Kt);return be&&Vs(tt,le),Qt}for(Kt=h(Kt);le<at.length;le++)me=dt(Kt,tt,le,at[le],bt),me!==null&&(n&&me.alternate!==null&&Kt.delete(me.key===null?le:me.key),W=b(me,W,le),xe===null?Qt=me:xe.sibling=me,xe=me);return n&&Kt.forEach(function(Qa){return s(tt,Qa)}),be&&Vs(tt,le),Qt}function Jt(tt,W,at,bt){if(at==null)throw Error(i(151));for(var Qt=null,xe=null,Kt=W,le=W=0,me=null,Ae=at.next();Kt!==null&&!Ae.done;le++,Ae=at.next()){Kt.index>le?(me=Kt,Kt=null):me=Kt.sibling;var Qa=lt(tt,Kt,Ae.value,bt);if(Qa===null){Kt===null&&(Kt=me);break}n&&Kt&&Qa.alternate===null&&s(tt,Kt),W=b(Qa,W,le),xe===null?Qt=Qa:xe.sibling=Qa,xe=Qa,Kt=me}if(Ae.done)return o(tt,Kt),be&&Vs(tt,le),Qt;if(Kt===null){for(;!Ae.done;le++,Ae=at.next())Ae=vt(tt,Ae.value,bt),Ae!==null&&(W=b(Ae,W,le),xe===null?Qt=Ae:xe.sibling=Ae,xe=Ae);return be&&Vs(tt,le),Qt}for(Kt=h(Kt);!Ae.done;le++,Ae=at.next())Ae=dt(Kt,tt,le,Ae.value,bt),Ae!==null&&(n&&Ae.alternate!==null&&Kt.delete(Ae.key===null?le:Ae.key),W=b(Ae,W,le),xe===null?Qt=Ae:xe.sibling=Ae,xe=Ae);return n&&Kt.forEach(function(_1){return s(tt,_1)}),be&&Vs(tt,le),Qt}function je(tt,W,at,bt){if(typeof at=="object"&&at!==null&&at.type===S&&at.key===null&&(at=at.props.children),typeof at=="object"&&at!==null){switch(at.$$typeof){case A:t:{for(var Qt=at.key;W!==null;){if(W.key===Qt){if(Qt=at.type,Qt===S){if(W.tag===7){o(tt,W.sibling),bt=g(W,at.props.children),bt.return=tt,tt=bt;break t}}else if(W.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===ut&&Lr(Qt)===W.type){o(tt,W.sibling),bt=g(W,at.props),$l(bt,at),bt.return=tt,tt=bt;break t}o(tt,W);break}else s(tt,W);W=W.sibling}at.type===S?(bt=Mr(at.props.children,tt.mode,bt,at.key),bt.return=tt,tt=bt):(bt=yu(at.type,at.key,at.props,null,tt.mode,bt),$l(bt,at),bt.return=tt,tt=bt)}return T(tt);case _:t:{for(Qt=at.key;W!==null;){if(W.key===Qt)if(W.tag===4&&W.stateNode.containerInfo===at.containerInfo&&W.stateNode.implementation===at.implementation){o(tt,W.sibling),bt=g(W,at.children||[]),bt.return=tt,tt=bt;break t}else{o(tt,W);break}else s(tt,W);W=W.sibling}bt=Md(at,tt.mode,bt),bt.return=tt,tt=bt}return T(tt);case ut:return at=Lr(at),je(tt,W,at,bt)}if($t(at))return Vt(tt,W,at,bt);if(Rt(at)){if(Qt=Rt(at),typeof Qt!="function")throw Error(i(150));return at=Qt.call(at),Jt(tt,W,at,bt)}if(typeof at.then=="function")return je(tt,W,Eu(at),bt);if(at.$$typeof===k)return je(tt,W,wu(tt,at),bt);_u(tt,at)}return typeof at=="string"&&at!==""||typeof at=="number"||typeof at=="bigint"?(at=""+at,W!==null&&W.tag===6?(o(tt,W.sibling),bt=g(W,at),bt.return=tt,tt=bt):(o(tt,W),bt=Rd(at,tt.mode,bt),bt.return=tt,tt=bt),T(tt)):o(tt,W)}return function(tt,W,at,bt){try{Vl=0;var Qt=je(tt,W,at,bt);return ko=null,Qt}catch(Kt){if(Kt===No||Kt===Au)throw Kt;var xe=gi(29,Kt,null,tt.mode);return xe.lanes=bt,xe.return=tt,xe}}}var Br=ug(!0),hg=ug(!1),ka=!1;function zd(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Hd(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function La(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Pa(n,s,o){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,(Ee&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=Ra(n),fs(n,null,o),s}return Le(n,h,s,o),Ra(n)}function Kl(n,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ie(n,o)}}function qd(n,s){var o=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};b===null?g=b=T:b=b.next=T,o=o.next}while(o!==null);b===null?g=b=s:b=b.next=s}else g=b=s;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:h.shared,callbacks:h.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=s:n.next=s,o.lastBaseUpdate=s}var Gd=!1;function Xl(){if(Gd){var n=Oo;if(n!==null)throw n}}function Yl(n,s,o,h){Gd=!1;var g=n.updateQueue;ka=!1;var b=g.firstBaseUpdate,T=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var q=L,rt=q.next;q.next=null,T===null?b=rt:T.next=rt,T=q;var yt=n.alternate;yt!==null&&(yt=yt.updateQueue,L=yt.lastBaseUpdate,L!==T&&(L===null?yt.firstBaseUpdate=rt:L.next=rt,yt.lastBaseUpdate=q))}if(b!==null){var vt=g.baseState;T=0,yt=rt=q=null,L=b;do{var lt=L.lane&-536870913,dt=lt!==L.lane;if(dt?(pe&lt)===lt:(h&lt)===lt){lt!==0&&lt===Do&&(Gd=!0),yt!==null&&(yt=yt.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});t:{var Vt=n,Jt=L;lt=s;var je=o;switch(Jt.tag){case 1:if(Vt=Jt.payload,typeof Vt=="function"){vt=Vt.call(je,vt,lt);break t}vt=Vt;break t;case 3:Vt.flags=Vt.flags&-65537|128;case 0:if(Vt=Jt.payload,lt=typeof Vt=="function"?Vt.call(je,vt,lt):Vt,lt==null)break t;vt=y({},vt,lt);break t;case 2:ka=!0}}lt=L.callback,lt!==null&&(n.flags|=64,dt&&(n.flags|=8192),dt=g.callbacks,dt===null?g.callbacks=[lt]:dt.push(lt))}else dt={lane:lt,tag:L.tag,payload:L.payload,callback:L.callback,next:null},yt===null?(rt=yt=dt,q=vt):yt=yt.next=dt,T|=lt;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;dt=L,L=dt.next,dt.next=null,g.lastBaseUpdate=dt,g.shared.pending=null}}while(!0);yt===null&&(q=vt),g.baseState=q,g.firstBaseUpdate=rt,g.lastBaseUpdate=yt,b===null&&(g.shared.lanes=0),Ua|=T,n.lanes=T,n.memoizedState=vt}}function dg(n,s){if(typeof n!="function")throw Error(i(191,n));n.call(s)}function fg(n,s){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)dg(o[n],s)}var Lo=U(null),Cu=U(0);function pg(n,s){n=na,mt(Cu,n),mt(Lo,s),na=n|s.baseLanes}function Vd(){mt(Cu,na),mt(Lo,Lo.current)}function $d(){na=Cu.current,J(Lo),J(Cu)}var yi=U(null),Bi=null;function Ba(n){var s=n.alternate;mt(rn,rn.current&1),mt(yi,n),Bi===null&&(s===null||Lo.current!==null||s.memoizedState!==null)&&(Bi=n)}function Kd(n){mt(rn,rn.current),mt(yi,n),Bi===null&&(Bi=n)}function mg(n){n.tag===22?(mt(rn,rn.current),mt(yi,n),Bi===null&&(Bi=n)):ja()}function ja(){mt(rn,rn.current),mt(yi,yi.current)}function bi(n){J(yi),Bi===n&&(Bi=null),J(rn)}var rn=U(0);function Tu(n){for(var s=n;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||tp(o)||ep(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Xs=0,oe=null,Pe=null,dn=null,Ru=!1,Po=!1,jr=!1,Mu=0,Ql=0,Bo=null,mx=0;function Je(){throw Error(i(321))}function Xd(n,s){if(s===null)return!1;for(var o=0;o<s.length&&o<n.length;o++)if(!qn(n[o],s[o]))return!1;return!0}function Yd(n,s,o,h,g,b){return Xs=b,oe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,G.H=n===null||n.memoizedState===null?Zg:hf,jr=!1,b=o(h,g),jr=!1,Po&&(b=yg(s,o,h,g)),gg(n),b}function gg(n){G.H=Jl;var s=Pe!==null&&Pe.next!==null;if(Xs=0,dn=Pe=oe=null,Ru=!1,Ql=0,Bo=null,s)throw Error(i(300));n===null||fn||(n=n.dependencies,n!==null&&vu(n)&&(fn=!0))}function yg(n,s,o,h){oe=n;var g=0;do{if(Po&&(Bo=null),Ql=0,Po=!1,25<=g)throw Error(i(301));if(g+=1,dn=Pe=null,n.updateQueue!=null){var b=n.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}G.H=Jg,b=s(o,h)}while(Po);return b}function gx(){var n=G.H,s=n.useState()[0];return s=typeof s.then=="function"?Wl(s):s,n=n.useState()[0],(Pe!==null?Pe.memoizedState:null)!==n&&(oe.flags|=1024),s}function Qd(){var n=Mu!==0;return Mu=0,n}function Wd(n,s,o){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~o}function Zd(n){if(Ru){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Ru=!1}Xs=0,dn=Pe=oe=null,Po=!1,Ql=Mu=0,Bo=null}function Qn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dn===null?oe.memoizedState=dn=n:dn=dn.next=n,dn}function on(){if(Pe===null){var n=oe.alternate;n=n!==null?n.memoizedState:null}else n=Pe.next;var s=dn===null?oe.memoizedState:dn.next;if(s!==null)dn=s,Pe=n;else{if(n===null)throw oe.alternate===null?Error(i(467)):Error(i(310));Pe=n,n={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},dn===null?oe.memoizedState=dn=n:dn=dn.next=n}return dn}function Du(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Wl(n){var s=Ql;return Ql+=1,Bo===null&&(Bo=[]),n=og(Bo,n,s),s=oe,(dn===null?s.memoizedState:dn.next)===null&&(s=s.alternate,G.H=s===null||s.memoizedState===null?Zg:hf),n}function Ou(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Wl(n);if(n.$$typeof===k)return kn(n)}throw Error(i(438,String(n)))}function Jd(n){var s=null,o=oe.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=oe.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Du(),oe.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(n),h=0;h<n;h++)o[h]=_t;return s.index++,o}function Ys(n,s){return typeof s=="function"?s(n):s}function Nu(n){var s=on();return tf(s,Pe,n)}function tf(n,s,o){var h=n.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=o;var g=n.baseQueue,b=h.pending;if(b!==null){if(g!==null){var T=g.next;g.next=b.next,b.next=T}s.baseQueue=g=b,h.pending=null}if(b=n.baseState,g===null)n.memoizedState=b;else{s=g.next;var L=T=null,q=null,rt=s,yt=!1;do{var vt=rt.lane&-536870913;if(vt!==rt.lane?(pe&vt)===vt:(Xs&vt)===vt){var lt=rt.revertLane;if(lt===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null}),vt===Do&&(yt=!0);else if((Xs&lt)===lt){rt=rt.next,lt===Do&&(yt=!0);continue}else vt={lane:0,revertLane:rt.revertLane,gesture:null,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},q===null?(L=q=vt,T=b):q=q.next=vt,oe.lanes|=lt,Ua|=lt;vt=rt.action,jr&&o(b,vt),b=rt.hasEagerState?rt.eagerState:o(b,vt)}else lt={lane:vt,revertLane:rt.revertLane,gesture:rt.gesture,action:rt.action,hasEagerState:rt.hasEagerState,eagerState:rt.eagerState,next:null},q===null?(L=q=lt,T=b):q=q.next=lt,oe.lanes|=vt,Ua|=vt;rt=rt.next}while(rt!==null&&rt!==s);if(q===null?T=b:q.next=L,!qn(b,n.memoizedState)&&(fn=!0,yt&&(o=Oo,o!==null)))throw o;n.memoizedState=b,n.baseState=T,n.baseQueue=q,h.lastRenderedState=b}return g===null&&(h.lanes=0),[n.memoizedState,h.dispatch]}function ef(n){var s=on(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var h=o.dispatch,g=o.pending,b=s.memoizedState;if(g!==null){o.pending=null;var T=g=g.next;do b=n(b,T.action),T=T.next;while(T!==g);qn(b,s.memoizedState)||(fn=!0),s.memoizedState=b,s.baseQueue===null&&(s.baseState=b),o.lastRenderedState=b}return[b,h]}function bg(n,s,o){var h=oe,g=on(),b=be;if(b){if(o===void 0)throw Error(i(407));o=o()}else o=s();var T=!qn((Pe||g).memoizedState,o);if(T&&(g.memoizedState=o,fn=!0),g=g.queue,af(xg.bind(null,h,g,n),[n]),g.getSnapshot!==s||T||dn!==null&&dn.memoizedState.tag&1){if(h.flags|=2048,jo(9,{destroy:void 0},wg.bind(null,h,g,o,s),null),Ue===null)throw Error(i(349));b||(Xs&127)!==0||vg(h,s,o)}return o}function vg(n,s,o){n.flags|=16384,n={getSnapshot:s,value:o},s=oe.updateQueue,s===null?(s=Du(),oe.updateQueue=s,s.stores=[n]):(o=s.stores,o===null?s.stores=[n]:o.push(n))}function wg(n,s,o,h){s.value=o,s.getSnapshot=h,Ag(s)&&Sg(n)}function xg(n,s,o){return o(function(){Ag(s)&&Sg(n)})}function Ag(n){var s=n.getSnapshot;n=n.value;try{var o=s();return!qn(n,o)}catch{return!0}}function Sg(n){var s=De(n,2);s!==null&&ri(s,n,2)}function nf(n){var s=Qn();if(typeof n=="function"){var o=n;if(n=o(),jr){Dn(!0);try{o()}finally{Dn(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:n},s}function Eg(n,s,o,h){return n.baseState=o,tf(n,Pe,typeof h=="function"?h:Ys)}function yx(n,s,o,h,g){if(Pu(n))throw Error(i(485));if(n=s.action,n!==null){var b={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){b.listeners.push(T)}};G.T!==null?o(!0):b.isTransition=!1,h(b),o=s.pending,o===null?(b.next=s.pending=b,_g(s,b)):(b.next=o.next,s.pending=o.next=b)}}function _g(n,s){var o=s.action,h=s.payload,g=n.state;if(s.isTransition){var b=G.T,T={};G.T=T;try{var L=o(g,h),q=G.S;q!==null&&q(T,L),Cg(n,s,L)}catch(rt){sf(n,s,rt)}finally{b!==null&&T.types!==null&&(b.types=T.types),G.T=b}}else try{b=o(g,h),Cg(n,s,b)}catch(rt){sf(n,s,rt)}}function Cg(n,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){Tg(n,s,h)},function(h){return sf(n,s,h)}):Tg(n,s,o)}function Tg(n,s,o){s.status="fulfilled",s.value=o,Rg(s),n.state=o,s=n.pending,s!==null&&(o=s.next,o===s?n.pending=null:(o=o.next,s.next=o,_g(n,o)))}function sf(n,s,o){var h=n.pending;if(n.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,Rg(s),s=s.next;while(s!==h)}n.action=null}function Rg(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function Mg(n,s){return s}function Dg(n,s){if(be){var o=Ue.formState;if(o!==null){t:{var h=oe;if(be){if(Ge){e:{for(var g=Ge,b=Pi;g.nodeType!==8;){if(!b){g=null;break e}if(g=ji(g.nextSibling),g===null){g=null;break e}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){Ge=ji(g.nextSibling),h=g.data==="F!";break t}}Oa(h)}h=!1}h&&(s=o[0])}}return o=Qn(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Mg,lastRenderedState:s},o.queue=h,o=Yg.bind(null,oe,h),h.dispatch=o,h=nf(!1),b=uf.bind(null,oe,!1,h.queue),h=Qn(),g={state:s,dispatch:null,action:n,pending:null},h.queue=g,o=yx.bind(null,oe,g,b,o),g.dispatch=o,h.memoizedState=n,[s,o,!1]}function Og(n){var s=on();return Ng(s,Pe,n)}function Ng(n,s,o){if(s=tf(n,s,Mg)[0],n=Nu(Ys)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Wl(s)}catch(T){throw T===No?Au:T}else h=s;s=on();var g=s.queue,b=g.dispatch;return o!==s.memoizedState&&(oe.flags|=2048,jo(9,{destroy:void 0},bx.bind(null,g,o),null)),[h,b,n]}function bx(n,s){n.action=s}function kg(n){var s=on(),o=Pe;if(o!==null)return Ng(s,o,n);on(),s=s.memoizedState,o=on();var h=o.queue.dispatch;return o.memoizedState=n,[s,h,!1]}function jo(n,s,o,h){return n={tag:n,create:o,deps:h,inst:s,next:null},s=oe.updateQueue,s===null&&(s=Du(),oe.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=n.next=n:(h=o.next,o.next=n,n.next=h,s.lastEffect=n),n}function Lg(){return on().memoizedState}function ku(n,s,o,h){var g=Qn();oe.flags|=n,g.memoizedState=jo(1|s,{destroy:void 0},o,h===void 0?null:h)}function Lu(n,s,o,h){var g=on();h=h===void 0?null:h;var b=g.memoizedState.inst;Pe!==null&&h!==null&&Xd(h,Pe.memoizedState.deps)?g.memoizedState=jo(s,b,o,h):(oe.flags|=n,g.memoizedState=jo(1|s,b,o,h))}function Pg(n,s){ku(8390656,8,n,s)}function af(n,s){Lu(2048,8,n,s)}function vx(n){oe.flags|=4;var s=oe.updateQueue;if(s===null)s=Du(),oe.updateQueue=s,s.events=[n];else{var o=s.events;o===null?s.events=[n]:o.push(n)}}function Bg(n){var s=on().memoizedState;return vx({ref:s,nextImpl:n}),function(){if((Ee&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function jg(n,s){return Lu(4,2,n,s)}function Fg(n,s){return Lu(4,4,n,s)}function Ig(n,s){if(typeof s=="function"){n=n();var o=s(n);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function Ug(n,s,o){o=o!=null?o.concat([n]):null,Lu(4,4,Ig.bind(null,s,n),o)}function rf(){}function zg(n,s){var o=on();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&Xd(s,h[1])?h[0]:(o.memoizedState=[n,s],n)}function Hg(n,s){var o=on();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&Xd(s,h[1]))return h[0];if(h=n(),jr){Dn(!0);try{n()}finally{Dn(!1)}}return o.memoizedState=[h,s],h}function of(n,s,o){return o===void 0||(Xs&1073741824)!==0&&(pe&261930)===0?n.memoizedState=s:(n.memoizedState=o,n=qy(),oe.lanes|=n,Ua|=n,o)}function qg(n,s,o,h){return qn(o,s)?o:Lo.current!==null?(n=of(n,o,h),qn(n,s)||(fn=!0),n):(Xs&42)===0||(Xs&1073741824)!==0&&(pe&261930)===0?(fn=!0,n.memoizedState=o):(n=qy(),oe.lanes|=n,Ua|=n,s)}function Gg(n,s,o,h,g){var b=st.p;st.p=b!==0&&8>b?b:8;var T=G.T,L={};G.T=L,uf(n,!1,s,o);try{var q=g(),rt=G.S;if(rt!==null&&rt(L,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var yt=px(q,h);Zl(n,s,yt,xi(n))}else Zl(n,s,h,xi(n))}catch(vt){Zl(n,s,{then:function(){},status:"rejected",reason:vt},xi())}finally{st.p=b,T!==null&&L.types!==null&&(T.types=L.types),G.T=T}}function wx(){}function lf(n,s,o,h){if(n.tag!==5)throw Error(i(476));var g=Vg(n).queue;Gg(n,g,s,wt,o===null?wx:function(){return $g(n),o(h)})}function Vg(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:wt,baseState:wt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:wt},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ys,lastRenderedState:o},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function $g(n){var s=Vg(n);s.next===null&&(s=n.alternate.memoizedState),Zl(n,s.next.queue,{},xi())}function cf(){return kn(mc)}function Kg(){return on().memoizedState}function Xg(){return on().memoizedState}function xx(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var o=xi();n=La(o);var h=Pa(s,n,o);h!==null&&(ri(h,s,o),Kl(h,s,o)),s={cache:jd()},n.payload=s;return}s=s.return}}function Ax(n,s,o){var h=xi();o={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Pu(n)?Qg(s,o):(o=Gn(n,s,o,h),o!==null&&(ri(o,n,h),Wg(o,s,h)))}function Yg(n,s,o){var h=xi();Zl(n,s,o,h)}function Zl(n,s,o,h){var g={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Pu(n))Qg(s,g);else{var b=n.alternate;if(n.lanes===0&&(b===null||b.lanes===0)&&(b=s.lastRenderedReducer,b!==null))try{var T=s.lastRenderedState,L=b(T,o);if(g.hasEagerState=!0,g.eagerState=L,qn(L,T))return Le(n,s,g,0),Ue===null&&se(),!1}catch{}if(o=Gn(n,s,g,h),o!==null)return ri(o,n,h),Wg(o,s,h),!0}return!1}function uf(n,s,o,h){if(h={lane:2,revertLane:Hf(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Pu(n)){if(s)throw Error(i(479))}else s=Gn(n,o,h,2),s!==null&&ri(s,n,2)}function Pu(n){var s=n.alternate;return n===oe||s!==null&&s===oe}function Qg(n,s){Po=Ru=!0;var o=n.pending;o===null?s.next=s:(s.next=o.next,o.next=s),n.pending=s}function Wg(n,s,o){if((o&4194048)!==0){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ie(n,o)}}var Jl={readContext:kn,use:Ou,useCallback:Je,useContext:Je,useEffect:Je,useImperativeHandle:Je,useLayoutEffect:Je,useInsertionEffect:Je,useMemo:Je,useReducer:Je,useRef:Je,useState:Je,useDebugValue:Je,useDeferredValue:Je,useTransition:Je,useSyncExternalStore:Je,useId:Je,useHostTransitionStatus:Je,useFormState:Je,useActionState:Je,useOptimistic:Je,useMemoCache:Je,useCacheRefresh:Je};Jl.useEffectEvent=Je;var Zg={readContext:kn,use:Ou,useCallback:function(n,s){return Qn().memoizedState=[n,s===void 0?null:s],n},useContext:kn,useEffect:Pg,useImperativeHandle:function(n,s,o){o=o!=null?o.concat([n]):null,ku(4194308,4,Ig.bind(null,s,n),o)},useLayoutEffect:function(n,s){return ku(4194308,4,n,s)},useInsertionEffect:function(n,s){ku(4,2,n,s)},useMemo:function(n,s){var o=Qn();s=s===void 0?null:s;var h=n();if(jr){Dn(!0);try{n()}finally{Dn(!1)}}return o.memoizedState=[h,s],h},useReducer:function(n,s,o){var h=Qn();if(o!==void 0){var g=o(s);if(jr){Dn(!0);try{o(s)}finally{Dn(!1)}}}else g=s;return h.memoizedState=h.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},h.queue=n,n=n.dispatch=Ax.bind(null,oe,n),[h.memoizedState,n]},useRef:function(n){var s=Qn();return n={current:n},s.memoizedState=n},useState:function(n){n=nf(n);var s=n.queue,o=Yg.bind(null,oe,s);return s.dispatch=o,[n.memoizedState,o]},useDebugValue:rf,useDeferredValue:function(n,s){var o=Qn();return of(o,n,s)},useTransition:function(){var n=nf(!1);return n=Gg.bind(null,oe,n.queue,!0,!1),Qn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,o){var h=oe,g=Qn();if(be){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),Ue===null)throw Error(i(349));(pe&127)!==0||vg(h,s,o)}g.memoizedState=o;var b={value:o,getSnapshot:s};return g.queue=b,Pg(xg.bind(null,h,b,n),[n]),h.flags|=2048,jo(9,{destroy:void 0},wg.bind(null,h,b,o,s),null),o},useId:function(){var n=Qn(),s=Ue.identifierPrefix;if(be){var o=ms,h=ps;o=(h&~(1<<32-Ft(h)-1)).toString(32)+o,s="_"+s+"R_"+o,o=Mu++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=mx++,s="_"+s+"r_"+o.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:cf,useFormState:Dg,useActionState:Dg,useOptimistic:function(n){var s=Qn();s.memoizedState=s.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=uf.bind(null,oe,!0,o),o.dispatch=s,[n,s]},useMemoCache:Jd,useCacheRefresh:function(){return Qn().memoizedState=xx.bind(null,oe)},useEffectEvent:function(n){var s=Qn(),o={impl:n};return s.memoizedState=o,function(){if((Ee&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},hf={readContext:kn,use:Ou,useCallback:zg,useContext:kn,useEffect:af,useImperativeHandle:Ug,useInsertionEffect:jg,useLayoutEffect:Fg,useMemo:Hg,useReducer:Nu,useRef:Lg,useState:function(){return Nu(Ys)},useDebugValue:rf,useDeferredValue:function(n,s){var o=on();return qg(o,Pe.memoizedState,n,s)},useTransition:function(){var n=Nu(Ys)[0],s=on().memoizedState;return[typeof n=="boolean"?n:Wl(n),s]},useSyncExternalStore:bg,useId:Kg,useHostTransitionStatus:cf,useFormState:Og,useActionState:Og,useOptimistic:function(n,s){var o=on();return Eg(o,Pe,n,s)},useMemoCache:Jd,useCacheRefresh:Xg};hf.useEffectEvent=Bg;var Jg={readContext:kn,use:Ou,useCallback:zg,useContext:kn,useEffect:af,useImperativeHandle:Ug,useInsertionEffect:jg,useLayoutEffect:Fg,useMemo:Hg,useReducer:ef,useRef:Lg,useState:function(){return ef(Ys)},useDebugValue:rf,useDeferredValue:function(n,s){var o=on();return Pe===null?of(o,n,s):qg(o,Pe.memoizedState,n,s)},useTransition:function(){var n=ef(Ys)[0],s=on().memoizedState;return[typeof n=="boolean"?n:Wl(n),s]},useSyncExternalStore:bg,useId:Kg,useHostTransitionStatus:cf,useFormState:kg,useActionState:kg,useOptimistic:function(n,s){var o=on();return Pe!==null?Eg(o,Pe,n,s):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Jd,useCacheRefresh:Xg};Jg.useEffectEvent=Bg;function df(n,s,o,h){s=n.memoizedState,o=o(h,s),o=o==null?s:y({},s,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var ff={enqueueSetState:function(n,s,o){n=n._reactInternals;var h=xi(),g=La(h);g.payload=s,o!=null&&(g.callback=o),s=Pa(n,g,h),s!==null&&(ri(s,n,h),Kl(s,n,h))},enqueueReplaceState:function(n,s,o){n=n._reactInternals;var h=xi(),g=La(h);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=Pa(n,g,h),s!==null&&(ri(s,n,h),Kl(s,n,h))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var o=xi(),h=La(o);h.tag=2,s!=null&&(h.callback=s),s=Pa(n,h,o),s!==null&&(ri(s,n,o),Kl(s,n,o))}};function ty(n,s,o,h,g,b,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,b,T):s.prototype&&s.prototype.isPureReactComponent?!m(o,h)||!m(g,b):!0}function ey(n,s,o,h){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==n&&ff.enqueueReplaceState(s,s.state,null)}function Fr(n,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(n=n.defaultProps){o===s&&(o=y({},o));for(var g in n)o[g]===void 0&&(o[g]=n[g])}return o}function ny(n){Ht(n)}function iy(n){console.error(n)}function sy(n){Ht(n)}function Bu(n,s){try{var o=n.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function ay(n,s,o){try{var h=n.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function pf(n,s,o){return o=La(o),o.tag=3,o.payload={element:null},o.callback=function(){Bu(n,s)},o}function ry(n){return n=La(n),n.tag=3,n}function oy(n,s,o,h){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var b=h.value;n.payload=function(){return g(b)},n.callback=function(){ay(s,o,h)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){ay(s,o,h),typeof g!="function"&&(za===null?za=new Set([this]):za.add(this));var L=h.stack;this.componentDidCatch(h.value,{componentStack:L!==null?L:""})})}function Sx(n,s,o,h,g){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&Mo(s,o,g,!0),o=yi.current,o!==null){switch(o.tag){case 31:case 13:return Bi===null?Xu():o.alternate===null&&tn===0&&(tn=3),o.flags&=-257,o.flags|=65536,o.lanes=g,h===Su?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),If(n,h,g)),!1;case 22:return o.flags|=65536,h===Su?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),If(n,h,g)),!1}throw Error(i(435,o.tag))}return If(n,h,g),Xu(),!1}if(be)return s=yi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==Nd&&(n=Error(i(422),{cause:h}),Hl(Ni(n,o)))):(h!==Nd&&(s=Error(i(423),{cause:h}),Hl(Ni(s,o))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,h=Ni(h,o),g=pf(n.stateNode,h,g),qd(n,g),tn!==4&&(tn=2)),!1;var b=Error(i(520),{cause:h});if(b=Ni(b,o),oc===null?oc=[b]:oc.push(b),tn!==4&&(tn=2),s===null)return!0;h=Ni(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,n=g&-g,o.lanes|=n,n=pf(o.stateNode,h,n),qd(o,n),!1;case 1:if(s=o.type,b=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(za===null||!za.has(b))))return o.flags|=65536,g&=-g,o.lanes|=g,g=ry(g),oy(g,n,o,h),qd(o,g),!1}o=o.return}while(o!==null);return!1}var mf=Error(i(461)),fn=!1;function Ln(n,s,o,h){s.child=n===null?hg(s,null,o,h):Br(s,n.child,o,h)}function ly(n,s,o,h,g){o=o.render;var b=s.ref;if("ref"in h){var T={};for(var L in h)L!=="ref"&&(T[L]=h[L])}else T=h;return Nr(s),h=Yd(n,s,o,T,b,g),L=Qd(),n!==null&&!fn?(Wd(n,s,g),Qs(n,s,g)):(be&&L&&Dd(s),s.flags|=1,Ln(n,s,h,g),s.child)}function cy(n,s,o,h,g){if(n===null){var b=o.type;return typeof b=="function"&&!Td(b)&&b.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=b,uy(n,s,b,h,g)):(n=yu(o.type,null,h,s,s.mode,g),n.ref=s.ref,n.return=s,s.child=n)}if(b=n.child,!Sf(n,g)){var T=b.memoizedProps;if(o=o.compare,o=o!==null?o:m,o(T,h)&&n.ref===s.ref)return Qs(n,s,g)}return s.flags|=1,n=Gs(b,h),n.ref=s.ref,n.return=s,s.child=n}function uy(n,s,o,h,g){if(n!==null){var b=n.memoizedProps;if(m(b,h)&&n.ref===s.ref)if(fn=!1,s.pendingProps=h=b,Sf(n,g))(n.flags&131072)!==0&&(fn=!0);else return s.lanes=n.lanes,Qs(n,s,g)}return gf(n,s,o,h,g)}function hy(n,s,o,h){var g=h.children,b=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(b=b!==null?b.baseLanes|o:o,n!==null){for(h=s.child=n.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~b}else h=0,s.child=null;return dy(n,s,b,o,h)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&xu(s,b!==null?b.cachePool:null),b!==null?pg(s,b):Vd(),mg(s);else return h=s.lanes=536870912,dy(n,s,b!==null?b.baseLanes|o:o,o,h)}else b!==null?(xu(s,b.cachePool),pg(s,b),ja(),s.memoizedState=null):(n!==null&&xu(s,null),Vd(),ja());return Ln(n,s,g,o),s.child}function tc(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function dy(n,s,o,h,g){var b=Id();return b=b===null?null:{parent:hn._currentValue,pool:b},s.memoizedState={baseLanes:o,cachePool:b},n!==null&&xu(s,null),Vd(),mg(s),n!==null&&Mo(n,s,h,!0),s.childLanes=g,null}function ju(n,s){return s=Iu({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function fy(n,s,o){return Br(s,n.child,null,o),n=ju(s,s.pendingProps),n.flags|=2,bi(s),s.memoizedState=null,n}function Ex(n,s,o){var h=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(be){if(h.mode==="hidden")return n=ju(s,h),s.lanes=536870912,tc(null,n);if(Kd(s),(n=Ge)?(n=_b(n,Pi),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Ma!==null?{id:ps,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},o=Qm(n),o.return=s,s.child=o,Nn=s,Ge=null)):n=null,n===null)throw Oa(s);return s.lanes=536870912,null}return ju(s,h)}var b=n.memoizedState;if(b!==null){var T=b.dehydrated;if(Kd(s),g)if(s.flags&256)s.flags&=-257,s=fy(n,s,o);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(i(558));else if(fn||Mo(n,s,o,!1),g=(o&n.childLanes)!==0,fn||g){if(h=Ue,h!==null&&(T=nn(h,o),T!==0&&T!==b.retryLane))throw b.retryLane=T,De(n,T),ri(h,n,T),mf;Xu(),s=fy(n,s,o)}else n=b.treeContext,Ge=ji(T.nextSibling),Nn=s,be=!0,Da=null,Pi=!1,n!==null&&Jm(s,n),s=ju(s,h),s.flags|=4096;return s}return n=Gs(n.child,{mode:h.mode,children:h.children}),n.ref=s.ref,s.child=n,n.return=s,n}function Fu(n,s){var o=s.ref;if(o===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(s.flags|=4194816)}}function gf(n,s,o,h,g){return Nr(s),o=Yd(n,s,o,h,void 0,g),h=Qd(),n!==null&&!fn?(Wd(n,s,g),Qs(n,s,g)):(be&&h&&Dd(s),s.flags|=1,Ln(n,s,o,g),s.child)}function py(n,s,o,h,g,b){return Nr(s),s.updateQueue=null,o=yg(s,h,o,g),gg(n),h=Qd(),n!==null&&!fn?(Wd(n,s,b),Qs(n,s,b)):(be&&h&&Dd(s),s.flags|=1,Ln(n,s,o,b),s.child)}function my(n,s,o,h,g){if(Nr(s),s.stateNode===null){var b=_o,T=o.contextType;typeof T=="object"&&T!==null&&(b=kn(T)),b=new o(h,b),s.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=ff,s.stateNode=b,b._reactInternals=s,b=s.stateNode,b.props=h,b.state=s.memoizedState,b.refs={},zd(s),T=o.contextType,b.context=typeof T=="object"&&T!==null?kn(T):_o,b.state=s.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(df(s,o,T,h),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(T=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),T!==b.state&&ff.enqueueReplaceState(b,b.state,null),Yl(s,h,b,g),Xl(),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(n===null){b=s.stateNode;var L=s.memoizedProps,q=Fr(o,L);b.props=q;var rt=b.context,yt=o.contextType;T=_o,typeof yt=="object"&&yt!==null&&(T=kn(yt));var vt=o.getDerivedStateFromProps;yt=typeof vt=="function"||typeof b.getSnapshotBeforeUpdate=="function",L=s.pendingProps!==L,yt||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(L||rt!==T)&&ey(s,b,h,T),ka=!1;var lt=s.memoizedState;b.state=lt,Yl(s,h,b,g),Xl(),rt=s.memoizedState,L||lt!==rt||ka?(typeof vt=="function"&&(df(s,o,vt,h),rt=s.memoizedState),(q=ka||ty(s,o,q,h,lt,rt,T))?(yt||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=rt),b.props=h,b.state=rt,b.context=T,h=q):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{b=s.stateNode,Hd(n,s),T=s.memoizedProps,yt=Fr(o,T),b.props=yt,vt=s.pendingProps,lt=b.context,rt=o.contextType,q=_o,typeof rt=="object"&&rt!==null&&(q=kn(rt)),L=o.getDerivedStateFromProps,(rt=typeof L=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(T!==vt||lt!==q)&&ey(s,b,h,q),ka=!1,lt=s.memoizedState,b.state=lt,Yl(s,h,b,g),Xl();var dt=s.memoizedState;T!==vt||lt!==dt||ka||n!==null&&n.dependencies!==null&&vu(n.dependencies)?(typeof L=="function"&&(df(s,o,L,h),dt=s.memoizedState),(yt=ka||ty(s,o,yt,h,lt,dt,q)||n!==null&&n.dependencies!==null&&vu(n.dependencies))?(rt||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,dt,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,dt,q)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=dt),b.props=h,b.state=dt,b.context=q,h=yt):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),h=!1)}return b=h,Fu(n,s),h=(s.flags&128)!==0,b||h?(b=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:b.render(),s.flags|=1,n!==null&&h?(s.child=Br(s,n.child,null,g),s.child=Br(s,null,o,g)):Ln(n,s,o,g),s.memoizedState=b.state,n=s.child):n=Qs(n,s,g),n}function gy(n,s,o,h){return Dr(),s.flags|=256,Ln(n,s,o,h),s.child}var yf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function bf(n){return{baseLanes:n,cachePool:ag()}}function vf(n,s,o){return n=n!==null?n.childLanes&~o:0,s&&(n|=wi),n}function yy(n,s,o){var h=s.pendingProps,g=!1,b=(s.flags&128)!==0,T;if((T=b)||(T=n!==null&&n.memoizedState===null?!1:(rn.current&2)!==0),T&&(g=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,n===null){if(be){if(g?Ba(s):ja(),(n=Ge)?(n=_b(n,Pi),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Ma!==null?{id:ps,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},o=Qm(n),o.return=s,s.child=o,Nn=s,Ge=null)):n=null,n===null)throw Oa(s);return ep(n)?s.lanes=32:s.lanes=536870912,null}var L=h.children;return h=h.fallback,g?(ja(),g=s.mode,L=Iu({mode:"hidden",children:L},g),h=Mr(h,g,o,null),L.return=s,h.return=s,L.sibling=h,s.child=L,h=s.child,h.memoizedState=bf(o),h.childLanes=vf(n,T,o),s.memoizedState=yf,tc(null,h)):(Ba(s),wf(s,L))}var q=n.memoizedState;if(q!==null&&(L=q.dehydrated,L!==null)){if(b)s.flags&256?(Ba(s),s.flags&=-257,s=xf(n,s,o)):s.memoizedState!==null?(ja(),s.child=n.child,s.flags|=128,s=null):(ja(),L=h.fallback,g=s.mode,h=Iu({mode:"visible",children:h.children},g),L=Mr(L,g,o,null),L.flags|=2,h.return=s,L.return=s,h.sibling=L,s.child=h,Br(s,n.child,null,o),h=s.child,h.memoizedState=bf(o),h.childLanes=vf(n,T,o),s.memoizedState=yf,s=tc(null,h));else if(Ba(s),ep(L)){if(T=L.nextSibling&&L.nextSibling.dataset,T)var rt=T.dgst;T=rt,h=Error(i(419)),h.stack="",h.digest=T,Hl({value:h,source:null,stack:null}),s=xf(n,s,o)}else if(fn||Mo(n,s,o,!1),T=(o&n.childLanes)!==0,fn||T){if(T=Ue,T!==null&&(h=nn(T,o),h!==0&&h!==q.retryLane))throw q.retryLane=h,De(n,h),ri(T,n,h),mf;tp(L)||Xu(),s=xf(n,s,o)}else tp(L)?(s.flags|=192,s.child=n.child,s=null):(n=q.treeContext,Ge=ji(L.nextSibling),Nn=s,be=!0,Da=null,Pi=!1,n!==null&&Jm(s,n),s=wf(s,h.children),s.flags|=4096);return s}return g?(ja(),L=h.fallback,g=s.mode,q=n.child,rt=q.sibling,h=Gs(q,{mode:"hidden",children:h.children}),h.subtreeFlags=q.subtreeFlags&65011712,rt!==null?L=Gs(rt,L):(L=Mr(L,g,o,null),L.flags|=2),L.return=s,h.return=s,h.sibling=L,s.child=h,tc(null,h),h=s.child,L=n.child.memoizedState,L===null?L=bf(o):(g=L.cachePool,g!==null?(q=hn._currentValue,g=g.parent!==q?{parent:q,pool:q}:g):g=ag(),L={baseLanes:L.baseLanes|o,cachePool:g}),h.memoizedState=L,h.childLanes=vf(n,T,o),s.memoizedState=yf,tc(n.child,h)):(Ba(s),o=n.child,n=o.sibling,o=Gs(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,n!==null&&(T=s.deletions,T===null?(s.deletions=[n],s.flags|=16):T.push(n)),s.child=o,s.memoizedState=null,o)}function wf(n,s){return s=Iu({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function Iu(n,s){return n=gi(22,n,null,s),n.lanes=0,n}function xf(n,s,o){return Br(s,n.child,null,o),n=wf(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function by(n,s,o){n.lanes|=s;var h=n.alternate;h!==null&&(h.lanes|=s),Pd(n.return,s,o)}function Af(n,s,o,h,g,b){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g,treeForkCount:b}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=h,T.tail=o,T.tailMode=g,T.treeForkCount=b)}function vy(n,s,o){var h=s.pendingProps,g=h.revealOrder,b=h.tail;h=h.children;var T=rn.current,L=(T&2)!==0;if(L?(T=T&1|2,s.flags|=128):T&=1,mt(rn,T),Ln(n,s,h,o),h=be?zl:0,!L&&n!==null&&(n.flags&128)!==0)t:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&by(n,o,s);else if(n.tag===19)by(n,o,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break t;for(;n.sibling===null;){if(n.return===null||n.return===s)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)n=o.alternate,n!==null&&Tu(n)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),Af(s,!1,g,o,b,h);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(n=g.alternate,n!==null&&Tu(n)===null){s.child=g;break}n=g.sibling,g.sibling=o,o=g,g=n}Af(s,!0,o,null,b,h);break;case"together":Af(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function Qs(n,s,o){if(n!==null&&(s.dependencies=n.dependencies),Ua|=s.lanes,(o&s.childLanes)===0)if(n!==null){if(Mo(n,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(i(153));if(s.child!==null){for(n=s.child,o=Gs(n,n.pendingProps),s.child=o,o.return=s;n.sibling!==null;)n=n.sibling,o=o.sibling=Gs(n,n.pendingProps),o.return=s;o.sibling=null}return s.child}function Sf(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&vu(n)))}function _x(n,s,o){switch(s.tag){case 3:Tt(s,s.stateNode.containerInfo),Na(s,hn,n.memoizedState.cache),Dr();break;case 27:case 5:kt(s);break;case 4:Tt(s,s.stateNode.containerInfo);break;case 10:Na(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Kd(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(Ba(s),s.flags|=128,null):(o&s.child.childLanes)!==0?yy(n,s,o):(Ba(s),n=Qs(n,s,o),n!==null?n.sibling:null);Ba(s);break;case 19:var g=(n.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(Mo(n,s,o,!1),h=(o&s.childLanes)!==0),g){if(h)return vy(n,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),mt(rn,rn.current),h)break;return null;case 22:return s.lanes=0,hy(n,s,o,s.pendingProps);case 24:Na(s,hn,n.memoizedState.cache)}return Qs(n,s,o)}function wy(n,s,o){if(n!==null)if(n.memoizedProps!==s.pendingProps)fn=!0;else{if(!Sf(n,o)&&(s.flags&128)===0)return fn=!1,_x(n,s,o);fn=(n.flags&131072)!==0}else fn=!1,be&&(s.flags&1048576)!==0&&Zm(s,zl,s.index);switch(s.lanes=0,s.tag){case 16:t:{var h=s.pendingProps;if(n=Lr(s.elementType),s.type=n,typeof n=="function")Td(n)?(h=Fr(n,h),s.tag=1,s=my(null,s,n,h,o)):(s.tag=0,s=gf(null,s,n,h,o));else{if(n!=null){var g=n.$$typeof;if(g===j){s.tag=11,s=ly(null,s,n,h,o);break t}else if(g===H){s.tag=14,s=cy(null,s,n,h,o);break t}}throw s=Bt(n)||n,Error(i(306,s,""))}}return s;case 0:return gf(n,s,s.type,s.pendingProps,o);case 1:return h=s.type,g=Fr(h,s.pendingProps),my(n,s,h,g,o);case 3:t:{if(Tt(s,s.stateNode.containerInfo),n===null)throw Error(i(387));h=s.pendingProps;var b=s.memoizedState;g=b.element,Hd(n,s),Yl(s,h,null,o);var T=s.memoizedState;if(h=T.cache,Na(s,hn,h),h!==b.cache&&Bd(s,[hn],o,!0),Xl(),h=T.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=b,s.memoizedState=b,s.flags&256){s=gy(n,s,h,o);break t}else if(h!==g){g=Ni(Error(i(424)),s),Hl(g),s=gy(n,s,h,o);break t}else for(n=s.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Ge=ji(n.firstChild),Nn=s,be=!0,Da=null,Pi=!0,o=hg(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Dr(),h===g){s=Qs(n,s,o);break t}Ln(n,s,h,o)}s=s.child}return s;case 26:return Fu(n,s),n===null?(o=Ob(s.type,null,s.pendingProps,null))?s.memoizedState=o:be||(o=s.type,n=s.pendingProps,h=eh(Ut.current).createElement(o),h[ze]=s,h[sn]=n,Pn(h,o,n),an(h),s.stateNode=h):s.memoizedState=Ob(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return kt(s),n===null&&be&&(h=s.stateNode=Rb(s.type,s.pendingProps,Ut.current),Nn=s,Pi=!0,g=Ge,Va(s.type)?(np=g,Ge=ji(h.firstChild)):Ge=g),Ln(n,s,s.pendingProps.children,o),Fu(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&be&&((g=h=Ge)&&(h=e1(h,s.type,s.pendingProps,Pi),h!==null?(s.stateNode=h,Nn=s,Ge=ji(h.firstChild),Pi=!1,g=!0):g=!1),g||Oa(s)),kt(s),g=s.type,b=s.pendingProps,T=n!==null?n.memoizedProps:null,h=b.children,Wf(g,b)?h=null:T!==null&&Wf(g,T)&&(s.flags|=32),s.memoizedState!==null&&(g=Yd(n,s,gx,null,null,o),mc._currentValue=g),Fu(n,s),Ln(n,s,h,o),s.child;case 6:return n===null&&be&&((n=o=Ge)&&(o=n1(o,s.pendingProps,Pi),o!==null?(s.stateNode=o,Nn=s,Ge=null,n=!0):n=!1),n||Oa(s)),null;case 13:return yy(n,s,o);case 4:return Tt(s,s.stateNode.containerInfo),h=s.pendingProps,n===null?s.child=Br(s,null,h,o):Ln(n,s,h,o),s.child;case 11:return ly(n,s,s.type,s.pendingProps,o);case 7:return Ln(n,s,s.pendingProps,o),s.child;case 8:return Ln(n,s,s.pendingProps.children,o),s.child;case 12:return Ln(n,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,Na(s,s.type,h.value),Ln(n,s,h.children,o),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,Nr(s),g=kn(g),h=h(g),s.flags|=1,Ln(n,s,h,o),s.child;case 14:return cy(n,s,s.type,s.pendingProps,o);case 15:return uy(n,s,s.type,s.pendingProps,o);case 19:return vy(n,s,o);case 31:return Ex(n,s,o);case 22:return hy(n,s,o,s.pendingProps);case 24:return Nr(s),h=kn(hn),n===null?(g=Id(),g===null&&(g=Ue,b=jd(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=o),g=b),s.memoizedState={parent:h,cache:g},zd(s),Na(s,hn,g)):((n.lanes&o)!==0&&(Hd(n,s),Yl(s,null,null,o),Xl()),g=n.memoizedState,b=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Na(s,hn,h)):(h=b.cache,Na(s,hn,h),h!==g.cache&&Bd(s,[hn],o,!0))),Ln(n,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Ws(n){n.flags|=4}function Ef(n,s,o,h,g){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if(Ky())n.flags|=8192;else throw Pr=Su,Ud}else n.flags&=-16777217}function xy(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Bb(s))if(Ky())n.flags|=8192;else throw Pr=Su,Ud}function Uu(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?nu():536870912,n.lanes|=s,zo|=s)}function ec(n,s){if(!be)switch(n.tailMode){case"hidden":s=n.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function Ve(n){var s=n.alternate!==null&&n.alternate.child===n.child,o=0,h=0;if(s)for(var g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=h,n.childLanes=o,s}function Cx(n,s,o){var h=s.pendingProps;switch(Od(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ve(s),null;case 1:return Ve(s),null;case 3:return o=s.stateNode,h=null,n!==null&&(h=n.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),Ks(hn),jt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Ro(s)?Ws(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,kd())),Ve(s),null;case 26:var g=s.type,b=s.memoizedState;return n===null?(Ws(s),b!==null?(Ve(s),xy(s,b)):(Ve(s),Ef(s,g,null,h,o))):b?b!==n.memoizedState?(Ws(s),Ve(s),xy(s,b)):(Ve(s),s.flags&=-16777217):(n=n.memoizedProps,n!==h&&Ws(s),Ve(s),Ef(s,g,n,h,o)),null;case 27:if(we(s),o=Ut.current,g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Ws(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Ve(s),null}n=xt.current,Ro(s)?tg(s):(n=Rb(g,h,o),s.stateNode=n,Ws(s))}return Ve(s),null;case 5:if(we(s),g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Ws(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return Ve(s),null}if(b=xt.current,Ro(s))tg(s);else{var T=eh(Ut.current);switch(b){case 1:b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":b=T.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof h.is=="string"?T.createElement("select",{is:h.is}):T.createElement("select"),h.multiple?b.multiple=!0:h.size&&(b.size=h.size);break;default:b=typeof h.is=="string"?T.createElement(g,{is:h.is}):T.createElement(g)}}b[ze]=s,b[sn]=h;t:for(T=s.child;T!==null;){if(T.tag===5||T.tag===6)b.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===s)break t;for(;T.sibling===null;){if(T.return===null||T.return===s)break t;T=T.return}T.sibling.return=T.return,T=T.sibling}s.stateNode=b;t:switch(Pn(b,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&Ws(s)}}return Ve(s),Ef(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,o),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==h&&Ws(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(i(166));if(n=Ut.current,Ro(s)){if(n=s.stateNode,o=s.memoizedProps,h=null,g=Nn,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}n[ze]=s,n=!!(n.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||yb(n.nodeValue,o)),n||Oa(s,!0)}else n=eh(n).createTextNode(h),n[ze]=s,s.stateNode=n}return Ve(s),null;case 31:if(o=s.memoizedState,n===null||n.memoizedState!==null){if(h=Ro(s),o!==null){if(n===null){if(!h)throw Error(i(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[ze]=s}else Dr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ve(s),n=!1}else o=kd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return s.flags&256?(bi(s),s):(bi(s),null);if((s.flags&128)!==0)throw Error(i(558))}return Ve(s),null;case 13:if(h=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=Ro(s),h!==null&&h.dehydrated!==null){if(n===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[ze]=s}else Dr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Ve(s),g=!1}else g=kd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(bi(s),s):(bi(s),null)}return bi(s),(s.flags&128)!==0?(s.lanes=o,s):(o=h!==null,n=n!==null&&n.memoizedState!==null,o&&(h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),b=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==g&&(h.flags|=2048)),o!==n&&o&&(s.child.flags|=8192),Uu(s,s.updateQueue),Ve(s),null);case 4:return jt(),n===null&&$f(s.stateNode.containerInfo),Ve(s),null;case 10:return Ks(s.type),Ve(s),null;case 19:if(J(rn),h=s.memoizedState,h===null)return Ve(s),null;if(g=(s.flags&128)!==0,b=h.rendering,b===null)if(g)ec(h,!1);else{if(tn!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(b=Tu(n),b!==null){for(s.flags|=128,ec(h,!1),n=b.updateQueue,s.updateQueue=n,Uu(s,n),s.subtreeFlags=0,n=o,o=s.child;o!==null;)Ym(o,n),o=o.sibling;return mt(rn,rn.current&1|2),be&&Vs(s,h.treeForkCount),s.child}n=n.sibling}h.tail!==null&&In()>Vu&&(s.flags|=128,g=!0,ec(h,!1),s.lanes=4194304)}else{if(!g)if(n=Tu(b),n!==null){if(s.flags|=128,g=!0,n=n.updateQueue,s.updateQueue=n,Uu(s,n),ec(h,!0),h.tail===null&&h.tailMode==="hidden"&&!b.alternate&&!be)return Ve(s),null}else 2*In()-h.renderingStartTime>Vu&&o!==536870912&&(s.flags|=128,g=!0,ec(h,!1),s.lanes=4194304);h.isBackwards?(b.sibling=s.child,s.child=b):(n=h.last,n!==null?n.sibling=b:s.child=b,h.last=b)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=In(),n.sibling=null,o=rn.current,mt(rn,g?o&1|2:o&1),be&&Vs(s,h.treeForkCount),n):(Ve(s),null);case 22:case 23:return bi(s),$d(),h=s.memoizedState!==null,n!==null?n.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&(Ve(s),s.subtreeFlags&6&&(s.flags|=8192)):Ve(s),o=s.updateQueue,o!==null&&Uu(s,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),n!==null&&J(kr),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Ks(hn),Ve(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function Tx(n,s){switch(Od(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return Ks(hn),jt(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return we(s),null;case 31:if(s.memoizedState!==null){if(bi(s),s.alternate===null)throw Error(i(340));Dr()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(bi(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Dr()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return J(rn),null;case 4:return jt(),null;case 10:return Ks(s.type),null;case 22:case 23:return bi(s),$d(),n!==null&&J(kr),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return Ks(hn),null;case 25:return null;default:return null}}function Ay(n,s){switch(Od(s),s.tag){case 3:Ks(hn),jt();break;case 26:case 27:case 5:we(s);break;case 4:jt();break;case 31:s.memoizedState!==null&&bi(s);break;case 13:bi(s);break;case 19:J(rn);break;case 10:Ks(s.type);break;case 22:case 23:bi(s),$d(),n!==null&&J(kr);break;case 24:Ks(hn)}}function nc(n,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var g=h.next;o=g;do{if((o.tag&n)===n){h=void 0;var b=o.create,T=o.inst;h=b(),T.destroy=h}o=o.next}while(o!==g)}}catch(L){Ne(s,s.return,L)}}function Fa(n,s,o){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var b=g.next;h=b;do{if((h.tag&n)===n){var T=h.inst,L=T.destroy;if(L!==void 0){T.destroy=void 0,g=s;var q=o,rt=L;try{rt()}catch(yt){Ne(g,q,yt)}}}h=h.next}while(h!==b)}}catch(yt){Ne(s,s.return,yt)}}function Sy(n){var s=n.updateQueue;if(s!==null){var o=n.stateNode;try{fg(s,o)}catch(h){Ne(n,n.return,h)}}}function Ey(n,s,o){o.props=Fr(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(h){Ne(n,s,h)}}function ic(n,s){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var h=n.stateNode;break;case 30:h=n.stateNode;break;default:h=n.stateNode}typeof o=="function"?n.refCleanup=o(h):o.current=h}}catch(g){Ne(n,s,g)}}function gs(n,s){var o=n.ref,h=n.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(g){Ne(n,s,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Ne(n,s,g)}else o.current=null}function _y(n){var s=n.type,o=n.memoizedProps,h=n.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break t;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(g){Ne(n,n.return,g)}}function _f(n,s,o){try{var h=n.stateNode;Yx(h,n.type,o,s),h[sn]=s}catch(g){Ne(n,n.return,g)}}function Cy(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Va(n.type)||n.tag===4}function Cf(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Cy(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Va(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Tf(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(n),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=ei));else if(h!==4&&(h===27&&Va(n.type)&&(o=n.stateNode,s=null),n=n.child,n!==null))for(Tf(n,s,o),n=n.sibling;n!==null;)Tf(n,s,o),n=n.sibling}function zu(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?o.insertBefore(n,s):o.appendChild(n);else if(h!==4&&(h===27&&Va(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(zu(n,s,o),n=n.sibling;n!==null;)zu(n,s,o),n=n.sibling}function Ty(n){var s=n.stateNode,o=n.memoizedProps;try{for(var h=n.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Pn(s,h,o),s[ze]=n,s[sn]=o}catch(b){Ne(n,n.return,b)}}var Zs=!1,pn=!1,Rf=!1,Ry=typeof WeakSet=="function"?WeakSet:Set,Cn=null;function Rx(n,s){if(n=n.containerInfo,Yf=lh,n=R(n),O(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else t:{o=(o=n.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break t}var T=0,L=-1,q=-1,rt=0,yt=0,vt=n,lt=null;e:for(;;){for(var dt;vt!==o||g!==0&&vt.nodeType!==3||(L=T+g),vt!==b||h!==0&&vt.nodeType!==3||(q=T+h),vt.nodeType===3&&(T+=vt.nodeValue.length),(dt=vt.firstChild)!==null;)lt=vt,vt=dt;for(;;){if(vt===n)break e;if(lt===o&&++rt===g&&(L=T),lt===b&&++yt===h&&(q=T),(dt=vt.nextSibling)!==null)break;vt=lt,lt=vt.parentNode}vt=dt}o=L===-1||q===-1?null:{start:L,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(Qf={focusedElem:n,selectionRange:o},lh=!1,Cn=s;Cn!==null;)if(s=Cn,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Cn=n;else for(;Cn!==null;){switch(s=Cn,b=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)g=n[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&b!==null){n=void 0,o=s,g=b.memoizedProps,b=b.memoizedState,h=o.stateNode;try{var Vt=Fr(o.type,g);n=h.getSnapshotBeforeUpdate(Vt,b),h.__reactInternalSnapshotBeforeUpdate=n}catch(Jt){Ne(o,o.return,Jt)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,o=n.nodeType,o===9)Jf(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Jf(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=s.sibling,n!==null){n.return=s.return,Cn=n;break}Cn=s.return}}function My(n,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:ta(n,o),h&4&&nc(5,o);break;case 1:if(ta(n,o),h&4)if(n=o.stateNode,s===null)try{n.componentDidMount()}catch(T){Ne(o,o.return,T)}else{var g=Fr(o.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(g,s,n.__reactInternalSnapshotBeforeUpdate)}catch(T){Ne(o,o.return,T)}}h&64&&Sy(o),h&512&&ic(o,o.return);break;case 3:if(ta(n,o),h&64&&(n=o.updateQueue,n!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{fg(n,s)}catch(T){Ne(o,o.return,T)}}break;case 27:s===null&&h&4&&Ty(o);case 26:case 5:ta(n,o),s===null&&h&4&&_y(o),h&512&&ic(o,o.return);break;case 12:ta(n,o);break;case 31:ta(n,o),h&4&&Ny(n,o);break;case 13:ta(n,o),h&4&&ky(n,o),h&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=jx.bind(null,o),i1(n,o))));break;case 22:if(h=o.memoizedState!==null||Zs,!h){s=s!==null&&s.memoizedState!==null||pn,g=Zs;var b=pn;Zs=h,(pn=s)&&!b?ea(n,o,(o.subtreeFlags&8772)!==0):ta(n,o),Zs=g,pn=b}break;case 30:break;default:ta(n,o)}}function Dy(n){var s=n.alternate;s!==null&&(n.alternate=null,Dy(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&so(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var $e=null,ni=!1;function Js(n,s,o){for(o=o.child;o!==null;)Oy(n,s,o),o=o.sibling}function Oy(n,s,o){if(Mn&&typeof Mn.onCommitFiberUnmount=="function")try{Mn.onCommitFiberUnmount(is,o)}catch{}switch(o.tag){case 26:pn||gs(o,s),Js(n,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:pn||gs(o,s);var h=$e,g=ni;Va(o.type)&&($e=o.stateNode,ni=!1),Js(n,s,o),dc(o.stateNode),$e=h,ni=g;break;case 5:pn||gs(o,s);case 6:if(h=$e,g=ni,$e=null,Js(n,s,o),$e=h,ni=g,$e!==null)if(ni)try{($e.nodeType===9?$e.body:$e.nodeName==="HTML"?$e.ownerDocument.body:$e).removeChild(o.stateNode)}catch(b){Ne(o,s,b)}else try{$e.removeChild(o.stateNode)}catch(b){Ne(o,s,b)}break;case 18:$e!==null&&(ni?(n=$e,Sb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Yo(n)):Sb($e,o.stateNode));break;case 4:h=$e,g=ni,$e=o.stateNode.containerInfo,ni=!0,Js(n,s,o),$e=h,ni=g;break;case 0:case 11:case 14:case 15:Fa(2,o,s),pn||Fa(4,o,s),Js(n,s,o);break;case 1:pn||(gs(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&Ey(o,s,h)),Js(n,s,o);break;case 21:Js(n,s,o);break;case 22:pn=(h=pn)||o.memoizedState!==null,Js(n,s,o),pn=h;break;default:Js(n,s,o)}}function Ny(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Yo(n)}catch(o){Ne(s,s.return,o)}}}function ky(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Yo(n)}catch(o){Ne(s,s.return,o)}}function Mx(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new Ry),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new Ry),s;default:throw Error(i(435,n.tag))}}function Hu(n,s){var o=Mx(n);s.forEach(function(h){if(!o.has(h)){o.add(h);var g=Fx.bind(null,n,h);h.then(g,g)}})}function ii(n,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h],b=n,T=s,L=T;t:for(;L!==null;){switch(L.tag){case 27:if(Va(L.type)){$e=L.stateNode,ni=!1;break t}break;case 5:$e=L.stateNode,ni=!1;break t;case 3:case 4:$e=L.stateNode.containerInfo,ni=!0;break t}L=L.return}if($e===null)throw Error(i(160));Oy(b,T,g),$e=null,ni=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Ly(s,n),s=s.sibling}var Yi=null;function Ly(n,s){var o=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ii(s,n),si(n),h&4&&(Fa(3,n,n.return),nc(3,n),Fa(5,n,n.return));break;case 1:ii(s,n),si(n),h&512&&(pn||o===null||gs(o,o.return)),h&64&&Zs&&(n=n.updateQueue,n!==null&&(h=n.callbacks,h!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var g=Yi;if(ii(s,n),si(n),h&512&&(pn||o===null||gs(o,o.return)),h&4){var b=o!==null?o.memoizedState:null;if(h=n.memoizedState,o===null)if(h===null)if(n.stateNode===null){t:{h=n.type,o=n.memoizedProps,g=g.ownerDocument||g;e:switch(h){case"title":b=g.getElementsByTagName("title")[0],(!b||b[fi]||b[ze]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(h),g.head.insertBefore(b,g.querySelector("head > title"))),Pn(b,h,o),b[ze]=n,an(b),h=b;break t;case"link":var T=Lb("link","href",g).get(h+(o.href||""));if(T){for(var L=0;L<T.length;L++)if(b=T[L],b.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&b.getAttribute("rel")===(o.rel==null?null:o.rel)&&b.getAttribute("title")===(o.title==null?null:o.title)&&b.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(L,1);break e}}b=g.createElement(h),Pn(b,h,o),g.head.appendChild(b);break;case"meta":if(T=Lb("meta","content",g).get(h+(o.content||""))){for(L=0;L<T.length;L++)if(b=T[L],b.getAttribute("content")===(o.content==null?null:""+o.content)&&b.getAttribute("name")===(o.name==null?null:o.name)&&b.getAttribute("property")===(o.property==null?null:o.property)&&b.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&b.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(L,1);break e}}b=g.createElement(h),Pn(b,h,o),g.head.appendChild(b);break;default:throw Error(i(468,h))}b[ze]=n,an(b),h=b}n.stateNode=h}else Pb(g,n.type,n.stateNode);else n.stateNode=kb(g,h,n.memoizedProps);else b!==h?(b===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):b.count--,h===null?Pb(g,n.type,n.stateNode):kb(g,h,n.memoizedProps)):h===null&&n.stateNode!==null&&_f(n,n.memoizedProps,o.memoizedProps)}break;case 27:ii(s,n),si(n),h&512&&(pn||o===null||gs(o,o.return)),o!==null&&h&4&&_f(n,n.memoizedProps,o.memoizedProps);break;case 5:if(ii(s,n),si(n),h&512&&(pn||o===null||gs(o,o.return)),n.flags&32){g=n.stateNode;try{Ls(g,"")}catch(Vt){Ne(n,n.return,Vt)}}h&4&&n.stateNode!=null&&(g=n.memoizedProps,_f(n,g,o!==null?o.memoizedProps:g)),h&1024&&(Rf=!0);break;case 6:if(ii(s,n),si(n),h&4){if(n.stateNode===null)throw Error(i(162));h=n.memoizedProps,o=n.stateNode;try{o.nodeValue=h}catch(Vt){Ne(n,n.return,Vt)}}break;case 3:if(sh=null,g=Yi,Yi=nh(s.containerInfo),ii(s,n),Yi=g,si(n),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Yo(s.containerInfo)}catch(Vt){Ne(n,n.return,Vt)}Rf&&(Rf=!1,Py(n));break;case 4:h=Yi,Yi=nh(n.stateNode.containerInfo),ii(s,n),si(n),Yi=h;break;case 12:ii(s,n),si(n);break;case 31:ii(s,n),si(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Hu(n,h)));break;case 13:ii(s,n),si(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Gu=In()),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Hu(n,h)));break;case 22:g=n.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,rt=Zs,yt=pn;if(Zs=rt||g,pn=yt||q,ii(s,n),pn=yt,Zs=rt,si(n),h&8192)t:for(s=n.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||q||Zs||pn||Ir(n)),o=null,s=n;;){if(s.tag===5||s.tag===26){if(o===null){q=o=s;try{if(b=q.stateNode,g)T=b.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{L=q.stateNode;var vt=q.memoizedProps.style,lt=vt!=null&&vt.hasOwnProperty("display")?vt.display:null;L.style.display=lt==null||typeof lt=="boolean"?"":(""+lt).trim()}}catch(Vt){Ne(q,q.return,Vt)}}}else if(s.tag===6){if(o===null){q=s;try{q.stateNode.nodeValue=g?"":q.memoizedProps}catch(Vt){Ne(q,q.return,Vt)}}}else if(s.tag===18){if(o===null){q=s;try{var dt=q.stateNode;g?Eb(dt,!0):Eb(q.stateNode,!1)}catch(Vt){Ne(q,q.return,Vt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break t;for(;s.sibling===null;){if(s.return===null||s.return===n)break t;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=n.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,Hu(n,o))));break;case 19:ii(s,n),si(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Hu(n,h)));break;case 30:break;case 21:break;default:ii(s,n),si(n)}}function si(n){var s=n.flags;if(s&2){try{for(var o,h=n.return;h!==null;){if(Cy(h)){o=h;break}h=h.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,b=Cf(n);zu(n,b,g);break;case 5:var T=o.stateNode;o.flags&32&&(Ls(T,""),o.flags&=-33);var L=Cf(n);zu(n,L,T);break;case 3:case 4:var q=o.stateNode.containerInfo,rt=Cf(n);Tf(n,rt,q);break;default:throw Error(i(161))}}catch(yt){Ne(n,n.return,yt)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function Py(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;Py(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function ta(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)My(n,s.alternate,s),s=s.sibling}function Ir(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:Fa(4,s,s.return),Ir(s);break;case 1:gs(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&Ey(s,s.return,o),Ir(s);break;case 27:dc(s.stateNode);case 26:case 5:gs(s,s.return),Ir(s);break;case 22:s.memoizedState===null&&Ir(s);break;case 30:Ir(s);break;default:Ir(s)}n=n.sibling}}function ea(n,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=n,b=s,T=b.flags;switch(b.tag){case 0:case 11:case 15:ea(g,b,o),nc(4,b);break;case 1:if(ea(g,b,o),h=b,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(rt){Ne(h,h.return,rt)}if(h=b,g=h.updateQueue,g!==null){var L=h.stateNode;try{var q=g.shared.hiddenCallbacks;if(q!==null)for(g.shared.hiddenCallbacks=null,g=0;g<q.length;g++)dg(q[g],L)}catch(rt){Ne(h,h.return,rt)}}o&&T&64&&Sy(b),ic(b,b.return);break;case 27:Ty(b);case 26:case 5:ea(g,b,o),o&&h===null&&T&4&&_y(b),ic(b,b.return);break;case 12:ea(g,b,o);break;case 31:ea(g,b,o),o&&T&4&&Ny(g,b);break;case 13:ea(g,b,o),o&&T&4&&ky(g,b);break;case 22:b.memoizedState===null&&ea(g,b,o),ic(b,b.return);break;case 30:break;default:ea(g,b,o)}s=s.sibling}}function Mf(n,s){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&ql(o))}function Df(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&ql(n))}function Qi(n,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)By(n,s,o,h),s=s.sibling}function By(n,s,o,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:Qi(n,s,o,h),g&2048&&nc(9,s);break;case 1:Qi(n,s,o,h);break;case 3:Qi(n,s,o,h),g&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&ql(n)));break;case 12:if(g&2048){Qi(n,s,o,h),n=s.stateNode;try{var b=s.memoizedProps,T=b.id,L=b.onPostCommit;typeof L=="function"&&L(T,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(q){Ne(s,s.return,q)}}else Qi(n,s,o,h);break;case 31:Qi(n,s,o,h);break;case 13:Qi(n,s,o,h);break;case 23:break;case 22:b=s.stateNode,T=s.alternate,s.memoizedState!==null?b._visibility&2?Qi(n,s,o,h):sc(n,s):b._visibility&2?Qi(n,s,o,h):(b._visibility|=2,Fo(n,s,o,h,(s.subtreeFlags&10256)!==0||!1)),g&2048&&Mf(T,s);break;case 24:Qi(n,s,o,h),g&2048&&Df(s.alternate,s);break;default:Qi(n,s,o,h)}}function Fo(n,s,o,h,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var b=n,T=s,L=o,q=h,rt=T.flags;switch(T.tag){case 0:case 11:case 15:Fo(b,T,L,q,g),nc(8,T);break;case 23:break;case 22:var yt=T.stateNode;T.memoizedState!==null?yt._visibility&2?Fo(b,T,L,q,g):sc(b,T):(yt._visibility|=2,Fo(b,T,L,q,g)),g&&rt&2048&&Mf(T.alternate,T);break;case 24:Fo(b,T,L,q,g),g&&rt&2048&&Df(T.alternate,T);break;default:Fo(b,T,L,q,g)}s=s.sibling}}function sc(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=n,h=s,g=h.flags;switch(h.tag){case 22:sc(o,h),g&2048&&Mf(h.alternate,h);break;case 24:sc(o,h),g&2048&&Df(h.alternate,h);break;default:sc(o,h)}s=s.sibling}}var ac=8192;function Io(n,s,o){if(n.subtreeFlags&ac)for(n=n.child;n!==null;)jy(n,s,o),n=n.sibling}function jy(n,s,o){switch(n.tag){case 26:Io(n,s,o),n.flags&ac&&n.memoizedState!==null&&m1(o,Yi,n.memoizedState,n.memoizedProps);break;case 5:Io(n,s,o);break;case 3:case 4:var h=Yi;Yi=nh(n.stateNode.containerInfo),Io(n,s,o),Yi=h;break;case 22:n.memoizedState===null&&(h=n.alternate,h!==null&&h.memoizedState!==null?(h=ac,ac=16777216,Io(n,s,o),ac=h):Io(n,s,o));break;default:Io(n,s,o)}}function Fy(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function rc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Cn=h,Uy(h,n)}Fy(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Iy(n),n=n.sibling}function Iy(n){switch(n.tag){case 0:case 11:case 15:rc(n),n.flags&2048&&Fa(9,n,n.return);break;case 3:rc(n);break;case 12:rc(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,qu(n)):rc(n);break;default:rc(n)}}function qu(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Cn=h,Uy(h,n)}Fy(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:Fa(8,s,s.return),qu(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,qu(s));break;default:qu(s)}n=n.sibling}}function Uy(n,s){for(;Cn!==null;){var o=Cn;switch(o.tag){case 0:case 11:case 15:Fa(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:ql(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Cn=h;else t:for(o=n;Cn!==null;){h=Cn;var g=h.sibling,b=h.return;if(Dy(h),h===o){Cn=null;break t}if(g!==null){g.return=b,Cn=g;break t}Cn=b}}}var Dx={getCacheForType:function(n){var s=kn(hn),o=s.data.get(n);return o===void 0&&(o=n(),s.data.set(n,o)),o},cacheSignal:function(){return kn(hn).controller.signal}},Ox=typeof WeakMap=="function"?WeakMap:Map,Ee=0,Ue=null,de=null,pe=0,Oe=0,vi=null,Ia=!1,Uo=!1,Of=!1,na=0,tn=0,Ua=0,Ur=0,Nf=0,wi=0,zo=0,oc=null,ai=null,kf=!1,Gu=0,zy=0,Vu=1/0,$u=null,za=null,yn=0,Ha=null,Ho=null,ia=0,Lf=0,Pf=null,Hy=null,lc=0,Bf=null;function xi(){return(Ee&2)!==0&&pe!==0?pe&-pe:G.T!==null?Hf():pr()}function qy(){if(wi===0)if((pe&536870912)===0||be){var n=ma;ma<<=1,(ma&3932160)===0&&(ma=262144),wi=n}else wi=536870912;return n=yi.current,n!==null&&(n.flags|=32),wi}function ri(n,s,o){(n===Ue&&(Oe===2||Oe===9)||n.cancelPendingCommit!==null)&&(qo(n,0),qa(n,pe,wi,!1)),Ti(n,o),((Ee&2)===0||n!==Ue)&&(n===Ue&&((Ee&2)===0&&(Ur|=o),tn===4&&qa(n,pe,wi,!1)),ys(n))}function Gy(n,s,o){if((Ee&6)!==0)throw Error(i(327));var h=!o&&(s&127)===0&&(s&n.expiredLanes)===0||Os(n,s),g=h?Lx(n,s):Ff(n,s,!0),b=h;do{if(g===0){Uo&&!h&&qa(n,s,0,!1);break}else{if(o=n.current.alternate,b&&!Nx(o)){g=Ff(n,s,!1),b=!1;continue}if(g===2){if(b=s,n.errorRecoveryDisabledLanes&b)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;t:{var L=n;g=oc;var q=L.current.memoizedState.isDehydrated;if(q&&(qo(L,T).flags|=256),T=Ff(L,T,!1),T!==2){if(Of&&!q){L.errorRecoveryDisabledLanes|=b,Ur|=b,g=4;break t}b=ai,ai=g,b!==null&&(ai===null?ai=b:ai.push.apply(ai,b))}g=T}if(b=!1,g!==2)continue}}if(g===1){qo(n,0),qa(n,s,0,!0);break}t:{switch(h=n,b=g,b){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:qa(h,s,wi,!Ia);break t;case 2:ai=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=Gu+300-In(),10<g)){if(qa(h,s,wi,!Ia),dr(h,0,!0)!==0)break t;ia=s,h.timeoutHandle=xb(Vy.bind(null,h,o,ai,$u,kf,s,wi,Ur,zo,Ia,b,"Throttled",-0,0),g);break t}Vy(h,o,ai,$u,kf,s,wi,Ur,zo,Ia,b,null,-0,0)}}break}while(!0);ys(n)}function Vy(n,s,o,h,g,b,T,L,q,rt,yt,vt,lt,dt){if(n.timeoutHandle=-1,vt=s.subtreeFlags,vt&8192||(vt&16785408)===16785408){vt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ei},jy(s,b,vt);var Vt=(b&62914560)===b?Gu-In():(b&4194048)===b?zy-In():0;if(Vt=g1(vt,Vt),Vt!==null){ia=b,n.cancelPendingCommit=Vt(Jy.bind(null,n,s,b,o,h,g,T,L,q,yt,vt,null,lt,dt)),qa(n,b,T,!rt);return}}Jy(n,s,b,o,h,g,T,L,q)}function Nx(n){for(var s=n;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var g=o[h],b=g.getSnapshot;g=g.value;try{if(!qn(b(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function qa(n,s,o,h){s&=~Nf,s&=~Ur,n.suspendedLanes|=s,n.pingedLanes&=~s,h&&(n.warmLanes|=s),h=n.expirationTimes;for(var g=s;0<g;){var b=31-Ft(g),T=1<<b;h[b]=-1,g&=~T}o!==0&&fr(n,o,s)}function Ku(){return(Ee&6)===0?(cc(0),!1):!0}function jf(){if(de!==null){if(Oe===0)var n=de.return;else n=de,$s=Or=null,Zd(n),ko=null,Vl=0,n=de;for(;n!==null;)Ay(n.alternate,n),n=n.return;de=null}}function qo(n,s){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,Zx(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),ia=0,jf(),Ue=n,de=o=Gs(n.current,null),pe=s,Oe=0,vi=null,Ia=!1,Uo=Os(n,s),Of=!1,zo=wi=Nf=Ur=Ua=tn=0,ai=oc=null,kf=!1,(s&8)!==0&&(s|=s&32);var h=n.entangledLanes;if(h!==0)for(n=n.entanglements,h&=s;0<h;){var g=31-Ft(h),b=1<<g;s|=n[g],h&=~b}return na=s,se(),o}function $y(n,s){oe=null,G.H=Jl,s===No||s===Au?(s=lg(),Oe=3):s===Ud?(s=lg(),Oe=4):Oe=s===mf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,vi=s,de===null&&(tn=1,Bu(n,Ni(s,n.current)))}function Ky(){var n=yi.current;return n===null?!0:(pe&4194048)===pe?Bi===null:(pe&62914560)===pe||(pe&536870912)!==0?n===Bi:!1}function Xy(){var n=G.H;return G.H=Jl,n===null?Jl:n}function Yy(){var n=G.A;return G.A=Dx,n}function Xu(){tn=4,Ia||(pe&4194048)!==pe&&yi.current!==null||(Uo=!0),(Ua&134217727)===0&&(Ur&134217727)===0||Ue===null||qa(Ue,pe,wi,!1)}function Ff(n,s,o){var h=Ee;Ee|=2;var g=Xy(),b=Yy();(Ue!==n||pe!==s)&&($u=null,qo(n,s)),s=!1;var T=tn;t:do try{if(Oe!==0&&de!==null){var L=de,q=vi;switch(Oe){case 8:jf(),T=6;break t;case 3:case 2:case 9:case 6:yi.current===null&&(s=!0);var rt=Oe;if(Oe=0,vi=null,Go(n,L,q,rt),o&&Uo){T=0;break t}break;default:rt=Oe,Oe=0,vi=null,Go(n,L,q,rt)}}kx(),T=tn;break}catch(yt){$y(n,yt)}while(!0);return s&&n.shellSuspendCounter++,$s=Or=null,Ee=h,G.H=g,G.A=b,de===null&&(Ue=null,pe=0,se()),T}function kx(){for(;de!==null;)Qy(de)}function Lx(n,s){var o=Ee;Ee|=2;var h=Xy(),g=Yy();Ue!==n||pe!==s?($u=null,Vu=In()+500,qo(n,s)):Uo=Os(n,s);t:do try{if(Oe!==0&&de!==null){s=de;var b=vi;e:switch(Oe){case 1:Oe=0,vi=null,Go(n,s,b,1);break;case 2:case 9:if(rg(b)){Oe=0,vi=null,Wy(s);break}s=function(){Oe!==2&&Oe!==9||Ue!==n||(Oe=7),ys(n)},b.then(s,s);break t;case 3:Oe=7;break t;case 4:Oe=5;break t;case 7:rg(b)?(Oe=0,vi=null,Wy(s)):(Oe=0,vi=null,Go(n,s,b,7));break;case 5:var T=null;switch(de.tag){case 26:T=de.memoizedState;case 5:case 27:var L=de;if(T?Bb(T):L.stateNode.complete){Oe=0,vi=null;var q=L.sibling;if(q!==null)de=q;else{var rt=L.return;rt!==null?(de=rt,Yu(rt)):de=null}break e}}Oe=0,vi=null,Go(n,s,b,5);break;case 6:Oe=0,vi=null,Go(n,s,b,6);break;case 8:jf(),tn=6;break t;default:throw Error(i(462))}}Px();break}catch(yt){$y(n,yt)}while(!0);return $s=Or=null,G.H=h,G.A=g,Ee=o,de!==null?0:(Ue=null,pe=0,se(),tn)}function Px(){for(;de!==null&&!eu();)Qy(de)}function Qy(n){var s=wy(n.alternate,n,na);n.memoizedProps=n.pendingProps,s===null?Yu(n):de=s}function Wy(n){var s=n,o=s.alternate;switch(s.tag){case 15:case 0:s=py(o,s,s.pendingProps,s.type,void 0,pe);break;case 11:s=py(o,s,s.pendingProps,s.type.render,s.ref,pe);break;case 5:Zd(s);default:Ay(o,s),s=de=Ym(s,na),s=wy(o,s,na)}n.memoizedProps=n.pendingProps,s===null?Yu(n):de=s}function Go(n,s,o,h){$s=Or=null,Zd(s),ko=null,Vl=0;var g=s.return;try{if(Sx(n,g,s,o,pe)){tn=1,Bu(n,Ni(o,n.current)),de=null;return}}catch(b){if(g!==null)throw de=g,b;tn=1,Bu(n,Ni(o,n.current)),de=null;return}s.flags&32768?(be||h===1?n=!0:Uo||(pe&536870912)!==0?n=!1:(Ia=n=!0,(h===2||h===9||h===3||h===6)&&(h=yi.current,h!==null&&h.tag===13&&(h.flags|=16384))),Zy(s,n)):Yu(s)}function Yu(n){var s=n;do{if((s.flags&32768)!==0){Zy(s,Ia);return}n=s.return;var o=Cx(s.alternate,s,na);if(o!==null){de=o;return}if(s=s.sibling,s!==null){de=s;return}de=s=n}while(s!==null);tn===0&&(tn=5)}function Zy(n,s){do{var o=Tx(n.alternate,n);if(o!==null){o.flags&=32767,de=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(n=n.sibling,n!==null)){de=n;return}de=n=o}while(n!==null);tn=6,de=null}function Jy(n,s,o,h,g,b,T,L,q){n.cancelPendingCommit=null;do Qu();while(yn!==0);if((Ee&6)!==0)throw Error(i(327));if(s!==null){if(s===n.current)throw Error(i(177));if(b=s.lanes|s.childLanes,b|=Yt,vl(n,o,b,T,L,q),n===Ue&&(de=Ue=null,pe=0),Ho=s,Ha=n,ia=o,Lf=b,Pf=g,Hy=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Ix(pa,function(){return sb(),null})):(n.callbackNode=null,n.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=G.T,G.T=null,g=st.p,st.p=2,T=Ee,Ee|=4;try{Rx(n,s,o)}finally{Ee=T,st.p=g,G.T=h}}yn=1,tb(),eb(),nb()}}function tb(){if(yn===1){yn=0;var n=Ha,s=Ho,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var h=st.p;st.p=2;var g=Ee;Ee|=4;try{Ly(s,n);var b=Qf,T=R(n.containerInfo),L=b.focusedElem,q=b.selectionRange;if(T!==L&&L&&L.ownerDocument&&E(L.ownerDocument.documentElement,L)){if(q!==null&&O(L)){var rt=q.start,yt=q.end;if(yt===void 0&&(yt=rt),"selectionStart"in L)L.selectionStart=rt,L.selectionEnd=Math.min(yt,L.value.length);else{var vt=L.ownerDocument||document,lt=vt&&vt.defaultView||window;if(lt.getSelection){var dt=lt.getSelection(),Vt=L.textContent.length,Jt=Math.min(q.start,Vt),je=q.end===void 0?Jt:Math.min(q.end,Vt);!dt.extend&&Jt>je&&(T=je,je=Jt,Jt=T);var tt=x(L,Jt),W=x(L,je);if(tt&&W&&(dt.rangeCount!==1||dt.anchorNode!==tt.node||dt.anchorOffset!==tt.offset||dt.focusNode!==W.node||dt.focusOffset!==W.offset)){var at=vt.createRange();at.setStart(tt.node,tt.offset),dt.removeAllRanges(),Jt>je?(dt.addRange(at),dt.extend(W.node,W.offset)):(at.setEnd(W.node,W.offset),dt.addRange(at))}}}}for(vt=[],dt=L;dt=dt.parentNode;)dt.nodeType===1&&vt.push({element:dt,left:dt.scrollLeft,top:dt.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<vt.length;L++){var bt=vt[L];bt.element.scrollLeft=bt.left,bt.element.scrollTop=bt.top}}lh=!!Yf,Qf=Yf=null}finally{Ee=g,st.p=h,G.T=o}}n.current=s,yn=2}}function eb(){if(yn===2){yn=0;var n=Ha,s=Ho,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var h=st.p;st.p=2;var g=Ee;Ee|=4;try{My(n,s.alternate,s)}finally{Ee=g,st.p=h,G.T=o}}yn=3}}function nb(){if(yn===4||yn===3){yn=0,or();var n=Ha,s=Ho,o=ia,h=Hy;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?yn=5:(yn=0,Ho=Ha=null,ib(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(za=null),ga(o),s=s.stateNode,Mn&&typeof Mn.onCommitFiberRoot=="function")try{Mn.onCommitFiberRoot(is,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=G.T,g=st.p,st.p=2,G.T=null;try{for(var b=n.onRecoverableError,T=0;T<h.length;T++){var L=h[T];b(L.value,{componentStack:L.stack})}}finally{G.T=s,st.p=g}}(ia&3)!==0&&Qu(),ys(n),g=n.pendingLanes,(o&261930)!==0&&(g&42)!==0?n===Bf?lc++:(lc=0,Bf=n):lc=0,cc(0)}}function ib(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,ql(s)))}function Qu(){return tb(),eb(),nb(),sb()}function sb(){if(yn!==5)return!1;var n=Ha,s=Lf;Lf=0;var o=ga(ia),h=G.T,g=st.p;try{st.p=32>o?32:o,G.T=null,o=Pf,Pf=null;var b=Ha,T=ia;if(yn=0,Ho=Ha=null,ia=0,(Ee&6)!==0)throw Error(i(331));var L=Ee;if(Ee|=4,Iy(b.current),By(b,b.current,T,o),Ee=L,cc(0,!1),Mn&&typeof Mn.onPostCommitFiberRoot=="function")try{Mn.onPostCommitFiberRoot(is,b)}catch{}return!0}finally{st.p=g,G.T=h,ib(n,s)}}function ab(n,s,o){s=Ni(o,s),s=pf(n.stateNode,s,2),n=Pa(n,s,2),n!==null&&(Ti(n,2),ys(n))}function Ne(n,s,o){if(n.tag===3)ab(n,n,o);else for(;s!==null;){if(s.tag===3){ab(s,n,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(za===null||!za.has(h))){n=Ni(o,n),o=ry(2),h=Pa(s,o,2),h!==null&&(oy(o,h,s,n),Ti(h,2),ys(h));break}}s=s.return}}function If(n,s,o){var h=n.pingCache;if(h===null){h=n.pingCache=new Ox;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(o)||(Of=!0,g.add(o),n=Bx.bind(null,n,s,o),s.then(n,n))}function Bx(n,s,o){var h=n.pingCache;h!==null&&h.delete(s),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Ue===n&&(pe&o)===o&&(tn===4||tn===3&&(pe&62914560)===pe&&300>In()-Gu?(Ee&2)===0&&qo(n,0):Nf|=o,zo===pe&&(zo=0)),ys(n)}function rb(n,s){s===0&&(s=nu()),n=De(n,s),n!==null&&(Ti(n,s),ys(n))}function jx(n){var s=n.memoizedState,o=0;s!==null&&(o=s.retryLane),rb(n,o)}function Fx(n,s){var o=0;switch(n.tag){case 31:case 13:var h=n.stateNode,g=n.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=n.stateNode;break;case 22:h=n.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(s),rb(n,o)}function Ix(n,s){return rr(n,s)}var Wu=null,Vo=null,Uf=!1,Zu=!1,zf=!1,Ga=0;function ys(n){n!==Vo&&n.next===null&&(Vo===null?Wu=Vo=n:Vo=Vo.next=n),Zu=!0,Uf||(Uf=!0,zx())}function cc(n,s){if(!zf&&Zu){zf=!0;do for(var o=!1,h=Wu;h!==null;){if(n!==0){var g=h.pendingLanes;if(g===0)var b=0;else{var T=h.suspendedLanes,L=h.pingedLanes;b=(1<<31-Ft(42|n)+1)-1,b&=g&~(T&~L),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(o=!0,ub(h,b))}else b=pe,b=dr(h,h===Ue?b:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(b&3)===0||Os(h,b)||(o=!0,ub(h,b));h=h.next}while(o);zf=!1}}function Ux(){ob()}function ob(){Zu=Uf=!1;var n=0;Ga!==0&&Wx()&&(n=Ga);for(var s=In(),o=null,h=Wu;h!==null;){var g=h.next,b=lb(h,s);b===0?(h.next=null,o===null?Wu=g:o.next=g,g===null&&(Vo=o)):(o=h,(n!==0||(b&3)!==0)&&(Zu=!0)),h=g}yn!==0&&yn!==5||cc(n),Ga!==0&&(Ga=0)}function lb(n,s){for(var o=n.suspendedLanes,h=n.pingedLanes,g=n.expirationTimes,b=n.pendingLanes&-62914561;0<b;){var T=31-Ft(b),L=1<<T,q=g[T];q===-1?((L&o)===0||(L&h)!==0)&&(g[T]=bd(L,s)):q<=s&&(n.expiredLanes|=L),b&=~L}if(s=Ue,o=pe,o=dr(n,n===s?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h=n.callbackNode,o===0||n===s&&(Oe===2||Oe===9)||n.cancelPendingCommit!==null)return h!==null&&h!==null&&ti(h),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Os(n,o)){if(s=o&-o,s===n.callbackPriority)return s;switch(h!==null&&ti(h),ga(o)){case 2:case 8:o=ns;break;case 32:o=pa;break;case 268435456:o=eo;break;default:o=pa}return h=cb.bind(null,n),o=rr(o,h),n.callbackPriority=s,n.callbackNode=o,s}return h!==null&&h!==null&&ti(h),n.callbackPriority=2,n.callbackNode=null,2}function cb(n,s){if(yn!==0&&yn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Qu()&&n.callbackNode!==o)return null;var h=pe;return h=dr(n,n===Ue?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h===0?null:(Gy(n,h,s),lb(n,In()),n.callbackNode!=null&&n.callbackNode===o?cb.bind(null,n):null)}function ub(n,s){if(Qu())return null;Gy(n,s,!0)}function zx(){Jx(function(){(Ee&6)!==0?rr(Un,Ux):ob()})}function Hf(){if(Ga===0){var n=Do;n===0&&(n=Nt,Nt<<=1,(Nt&261888)===0&&(Nt=256)),Ga=n}return Ga}function hb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Xi(""+n)}function db(n,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,n.id&&o.setAttribute("form",n.id),s.parentNode.insertBefore(o,s),n=new FormData(n),o.parentNode.removeChild(o),n}function Hx(n,s,o,h,g){if(s==="submit"&&o&&o.stateNode===g){var b=hb((g[sn]||null).action),T=h.submitter;T&&(s=(s=T[sn]||null)?hb(s.formAction):T.getAttribute("formAction"),s!==null&&(b=s,T=null));var L=new co("action","action",null,h,g);n.push({event:L,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ga!==0){var q=T?db(g,T):new FormData(g);lf(o,{pending:!0,data:q,method:g.method,action:b},null,q)}}else typeof b=="function"&&(L.preventDefault(),q=T?db(g,T):new FormData(g),lf(o,{pending:!0,data:q,method:g.method,action:b},b,q))},currentTarget:g}]})}}for(var qf=0;qf<Pt.length;qf++){var Gf=Pt[qf],qx=Gf.toLowerCase(),Gx=Gf[0].toUpperCase()+Gf.slice(1);Et(qx,"on"+Gx)}Et(ot,"onAnimationEnd"),Et(nt,"onAnimationIteration"),Et(gt,"onAnimationStart"),Et("dblclick","onDoubleClick"),Et("focusin","onFocus"),Et("focusout","onBlur"),Et(At,"onTransitionRun"),Et(Mt,"onTransitionStart"),Et(Dt,"onTransitionCancel"),Et(St,"onTransitionEnd"),ls("onMouseEnter",["mouseout","mouseover"]),ls("onMouseLeave",["mouseout","mouseover"]),ls("onPointerEnter",["pointerout","pointerover"]),ls("onPointerLeave",["pointerout","pointerover"]),$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$i("onBeforeInput",["compositionend","keypress","textInput","paste"]),$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var uc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Vx=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(uc));function fb(n,s){s=(s&4)!==0;for(var o=0;o<n.length;o++){var h=n[o],g=h.event;h=h.listeners;t:{var b=void 0;if(s)for(var T=h.length-1;0<=T;T--){var L=h[T],q=L.instance,rt=L.currentTarget;if(L=L.listener,q!==b&&g.isPropagationStopped())break t;b=L,g.currentTarget=rt;try{b(g)}catch(yt){Ht(yt)}g.currentTarget=null,b=q}else for(T=0;T<h.length;T++){if(L=h[T],q=L.instance,rt=L.currentTarget,L=L.listener,q!==b&&g.isPropagationStopped())break t;b=L,g.currentTarget=rt;try{b(g)}catch(yt){Ht(yt)}g.currentTarget=null,b=q}}}}function fe(n,s){var o=s[ya];o===void 0&&(o=s[ya]=new Set);var h=n+"__bubble";o.has(h)||(pb(s,n,2,!1),o.add(h))}function Vf(n,s,o){var h=0;s&&(h|=4),pb(o,n,h,s)}var Ju="_reactListening"+Math.random().toString(36).slice(2);function $f(n){if(!n[Ju]){n[Ju]=!0,Ns.forEach(function(o){o!=="selectionchange"&&(Vx.has(o)||Vf(o,!1,n),Vf(o,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[Ju]||(s[Ju]=!0,Vf("selectionchange",!1,s))}}function pb(n,s,o,h){switch(qb(s)){case 2:var g=v1;break;case 8:g=w1;break;default:g=op}o=g.bind(null,s,o,n),g=void 0,!Tl||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?n.addEventListener(s,o,{capture:!0,passive:g}):n.addEventListener(s,o,!0):g!==void 0?n.addEventListener(s,o,{passive:g}):n.addEventListener(s,o,!1)}function Kf(n,s,o,h,g){var b=h;if((s&1)===0&&(s&2)===0&&h!==null)t:for(;;){if(h===null)return;var T=h.tag;if(T===3||T===4){var L=h.stateNode.containerInfo;if(L===g)break;if(T===4)for(T=h.return;T!==null;){var q=T.tag;if((q===3||q===4)&&T.stateNode.containerInfo===g)return;T=T.return}for(;L!==null;){if(T=os(L),T===null)return;if(q=T.tag,q===5||q===6||q===26||q===27){h=b=T;continue t}L=L.parentNode}}h=h.return}va(function(){var rt=b,yt=oo(o),vt=[];t:{var lt=zt.get(n);if(lt!==void 0){var dt=co,Vt=n;switch(n){case"keypress":if(Aa(o)===0)break t;case"keydown":case"keyup":dt=yo;break;case"focusin":Vt="focus",dt=Sa;break;case"focusout":Vt="blur",dt=Sa;break;case"beforeblur":case"afterblur":dt=Sa;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=fo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=ru;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=Ll;break;case ot:case nt:case gt:dt=ou;break;case St:dt=Pl;break;case"scroll":case"scrollend":dt=uo;break;case"wheel":dt=vo;break;case"copy":case"cut":case"paste":dt=Ea;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=kl;break;case"toggle":case"beforetoggle":dt=uu}var Jt=(s&4)!==0,je=!Jt&&(n==="scroll"||n==="scrollend"),tt=Jt?lt!==null?lt+"Capture":null:lt;Jt=[];for(var W=rt,at;W!==null;){var bt=W;if(at=bt.stateNode,bt=bt.tag,bt!==5&&bt!==26&&bt!==27||at===null||tt===null||(bt=js(W,tt),bt!=null&&Jt.push(hc(W,bt,at))),je)break;W=W.return}0<Jt.length&&(lt=new dt(lt,Vt,null,o,yt),vt.push({event:lt,listeners:Jt}))}}if((s&7)===0){t:{if(lt=n==="mouseover"||n==="pointerover",dt=n==="mouseout"||n==="pointerout",lt&&o!==Mi&&(Vt=o.relatedTarget||o.fromElement)&&(os(Vt)||Vt[Xn]))break t;if((dt||lt)&&(lt=yt.window===yt?yt:(lt=yt.ownerDocument)?lt.defaultView||lt.parentWindow:window,dt?(Vt=o.relatedTarget||o.toElement,dt=rt,Vt=Vt?os(Vt):null,Vt!==null&&(je=l(Vt),Jt=Vt.tag,Vt!==je||Jt!==5&&Jt!==27&&Jt!==6)&&(Vt=null)):(dt=null,Vt=rt),dt!==Vt)){if(Jt=fo,bt="onMouseLeave",tt="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(Jt=kl,bt="onPointerLeave",tt="onPointerEnter",W="pointer"),je=dt==null?lt:pi(dt),at=Vt==null?lt:pi(Vt),lt=new Jt(bt,W+"leave",dt,o,yt),lt.target=je,lt.relatedTarget=at,bt=null,os(yt)===rt&&(Jt=new Jt(tt,W+"enter",Vt,o,yt),Jt.target=at,Jt.relatedTarget=je,bt=Jt),je=bt,dt&&Vt)e:{for(Jt=$x,tt=dt,W=Vt,at=0,bt=tt;bt;bt=Jt(bt))at++;bt=0;for(var Qt=W;Qt;Qt=Jt(Qt))bt++;for(;0<at-bt;)tt=Jt(tt),at--;for(;0<bt-at;)W=Jt(W),bt--;for(;at--;){if(tt===W||W!==null&&tt===W.alternate){Jt=tt;break e}tt=Jt(tt),W=Jt(W)}Jt=null}else Jt=null;dt!==null&&mb(vt,lt,dt,Jt,!1),Vt!==null&&je!==null&&mb(vt,je,Vt,Jt,!0)}}t:{if(lt=rt?pi(rt):window,dt=lt.nodeName&&lt.nodeName.toLowerCase(),dt==="select"||dt==="input"&&lt.type==="file")var xe=Rr;else if(Ao(lt))if(Oi)xe=Ta;else{xe=qs;var Kt=gu}else dt=lt.nodeName,!dt||dt.toLowerCase()!=="input"||lt.type!=="checkbox"&&lt.type!=="radio"?rt&&Cl(rt.elementType)&&(xe=Rr):xe=Ul;if(xe&&(xe=xe(n,rt))){Il(vt,xe,o,yt);break t}Kt&&Kt(n,lt,rt),n==="focusout"&&rt&&lt.type==="number"&&rt.memoizedProps.value!=null&&wr(lt,"number",lt.value)}switch(Kt=rt?pi(rt):window,n){case"focusin":(Ao(Kt)||Kt.contentEditable==="true")&&(B=Kt,$=rt,et=null);break;case"focusout":et=$=B=null;break;case"mousedown":K=!0;break;case"contextmenu":case"mouseup":case"dragend":K=!1,V(vt,o,yt);break;case"selectionchange":if(P)break;case"keydown":case"keyup":V(vt,o,yt)}var le;if(Cr)t:{switch(n){case"compositionstart":var me="onCompositionStart";break t;case"compositionend":me="onCompositionEnd";break t;case"compositionupdate":me="onCompositionUpdate";break t}me=void 0}else zs?Fl(n,o)&&(me="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(me="onCompositionStart");me&&(wo&&o.locale!=="ko"&&(zs||me!=="onCompositionStart"?me==="onCompositionEnd"&&zs&&(le=xa()):(Di=yt,lo="value"in Di?Di.value:Di.textContent,zs=!0)),Kt=th(rt,me),0<Kt.length&&(me=new go(me,n,null,o,yt),vt.push({event:me,listeners:Kt}),le?me.data=le:(le=du(o),le!==null&&(me.data=le)))),(le=Ed?fu(n,o):_d(n,o))&&(me=th(rt,"onBeforeInput"),0<me.length&&(Kt=new go("onBeforeInput","beforeinput",null,o,yt),vt.push({event:Kt,listeners:me}),Kt.data=le)),Hx(vt,n,rt,o,yt)}fb(vt,s)})}function hc(n,s,o){return{instance:n,listener:s,currentTarget:o}}function th(n,s){for(var o=s+"Capture",h=[];n!==null;){var g=n,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=js(n,o),g!=null&&h.unshift(hc(n,g,b)),g=js(n,s),g!=null&&h.push(hc(n,g,b))),n.tag===3)return h;n=n.return}return[]}function $x(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function mb(n,s,o,h,g){for(var b=s._reactName,T=[];o!==null&&o!==h;){var L=o,q=L.alternate,rt=L.stateNode;if(L=L.tag,q!==null&&q===h)break;L!==5&&L!==26&&L!==27||rt===null||(q=rt,g?(rt=js(o,b),rt!=null&&T.unshift(hc(o,rt,q))):g||(rt=js(o,b),rt!=null&&T.push(hc(o,rt,q)))),o=o.return}T.length!==0&&n.push({event:s,listeners:T})}var Kx=/\r\n?/g,Xx=/\u0000|\uFFFD/g;function gb(n){return(typeof n=="string"?n:""+n).replace(Kx,`
`).replace(Xx,"")}function yb(n,s){return s=gb(s),gb(n)===s}function Be(n,s,o,h,g,b){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||Ls(n,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&Ls(n,""+h);break;case"className":br(n,"class",h);break;case"tabIndex":br(n,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":br(n,o,h);break;case"style":_l(n,h,b);break;case"data":if(s!=="object"){br(n,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){n.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Xi(""+h),n.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(o==="formAction"?(s!=="input"&&Be(n,s,"name",g.name,g,null),Be(n,s,"formEncType",g.formEncType,g,null),Be(n,s,"formMethod",g.formMethod,g,null),Be(n,s,"formTarget",g.formTarget,g,null)):(Be(n,s,"encType",g.encType,g,null),Be(n,s,"method",g.method,g,null),Be(n,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Xi(""+h),n.setAttribute(o,h);break;case"onClick":h!=null&&(n.onclick=ei);break;case"onScroll":h!=null&&fe("scroll",n);break;case"onScrollEnd":h!=null&&fe("scrollend",n);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":n.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){n.removeAttribute("xlink:href");break}o=Xi(""+h),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""+h):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":h===!0?n.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,h):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?n.setAttribute(o,h):n.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?n.removeAttribute(o):n.setAttribute(o,h);break;case"popover":fe("beforetoggle",n),fe("toggle",n),ce(n,"popover",h);break;case"xlinkActuate":Ri(n,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Ri(n,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Ri(n,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Ri(n,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Ri(n,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Ri(n,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Ri(n,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Ri(n,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Ri(n,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":ce(n,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=xd.get(o)||o,ce(n,o,h))}}function Xf(n,s,o,h,g,b){switch(o){case"style":_l(n,h,b);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof h=="string"?Ls(n,h):(typeof h=="number"||typeof h=="bigint")&&Ls(n,""+h);break;case"onScroll":h!=null&&fe("scroll",n);break;case"onScrollEnd":h!=null&&fe("scrollend",n);break;case"onClick":h!=null&&(n.onclick=ei);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!gr.hasOwnProperty(o))t:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),b=n[sn]||null,b=b!=null?b[o]:null,typeof b=="function"&&n.removeEventListener(s,b,g),typeof h=="function")){typeof b!="function"&&b!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(s,h,g);break t}o in n?n[o]=h:h===!0?n.setAttribute(o,""):ce(n,o,h)}}}function Pn(n,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":fe("error",n),fe("load",n);var h=!1,g=!1,b;for(b in o)if(o.hasOwnProperty(b)){var T=o[b];if(T!=null)switch(b){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Be(n,s,b,T,o,null)}}g&&Be(n,s,"srcSet",o.srcSet,o,null),h&&Be(n,s,"src",o.src,o,null);return;case"input":fe("invalid",n);var L=b=T=g=null,q=null,rt=null;for(h in o)if(o.hasOwnProperty(h)){var yt=o[h];if(yt!=null)switch(h){case"name":g=yt;break;case"type":T=yt;break;case"checked":q=yt;break;case"defaultChecked":rt=yt;break;case"value":b=yt;break;case"defaultValue":L=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(i(137,s));break;default:Be(n,s,h,yt,o,null)}}ro(n,b,L,q,rt,T,g,!1);return;case"select":fe("invalid",n),h=T=b=null;for(g in o)if(o.hasOwnProperty(g)&&(L=o[g],L!=null))switch(g){case"value":b=L;break;case"defaultValue":T=L;break;case"multiple":h=L;default:Be(n,s,g,L,o,null)}s=b,o=T,n.multiple=!!h,s!=null?Ki(n,!!h,s,!1):o!=null&&Ki(n,!!h,o,!0);return;case"textarea":fe("invalid",n),b=g=h=null;for(T in o)if(o.hasOwnProperty(T)&&(L=o[T],L!=null))switch(T){case"value":h=L;break;case"defaultValue":g=L;break;case"children":b=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(i(91));break;default:Be(n,s,T,L,o,null)}xr(n,h,g,b);return;case"option":for(q in o)o.hasOwnProperty(q)&&(h=o[q],h!=null)&&(q==="selected"?n.selected=h&&typeof h!="function"&&typeof h!="symbol":Be(n,s,q,h,o,null));return;case"dialog":fe("beforetoggle",n),fe("toggle",n),fe("cancel",n),fe("close",n);break;case"iframe":case"object":fe("load",n);break;case"video":case"audio":for(h=0;h<uc.length;h++)fe(uc[h],n);break;case"image":fe("error",n),fe("load",n);break;case"details":fe("toggle",n);break;case"embed":case"source":case"link":fe("error",n),fe("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(rt in o)if(o.hasOwnProperty(rt)&&(h=o[rt],h!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Be(n,s,rt,h,o,null)}return;default:if(Cl(s)){for(yt in o)o.hasOwnProperty(yt)&&(h=o[yt],h!==void 0&&Xf(n,s,yt,h,o,void 0));return}}for(L in o)o.hasOwnProperty(L)&&(h=o[L],h!=null&&Be(n,s,L,h,o,null))}function Yx(n,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,T=null,L=null,q=null,rt=null,yt=null;for(dt in o){var vt=o[dt];if(o.hasOwnProperty(dt)&&vt!=null)switch(dt){case"checked":break;case"value":break;case"defaultValue":q=vt;default:h.hasOwnProperty(dt)||Be(n,s,dt,null,h,vt)}}for(var lt in h){var dt=h[lt];if(vt=o[lt],h.hasOwnProperty(lt)&&(dt!=null||vt!=null))switch(lt){case"type":b=dt;break;case"name":g=dt;break;case"checked":rt=dt;break;case"defaultChecked":yt=dt;break;case"value":T=dt;break;case"defaultValue":L=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(i(137,s));break;default:dt!==vt&&Be(n,s,lt,dt,h,vt)}}cs(n,T,L,q,rt,yt,b,g);return;case"select":dt=T=L=lt=null;for(b in o)if(q=o[b],o.hasOwnProperty(b)&&q!=null)switch(b){case"value":break;case"multiple":dt=q;default:h.hasOwnProperty(b)||Be(n,s,b,null,h,q)}for(g in h)if(b=h[g],q=o[g],h.hasOwnProperty(g)&&(b!=null||q!=null))switch(g){case"value":lt=b;break;case"defaultValue":L=b;break;case"multiple":T=b;default:b!==q&&Be(n,s,g,b,h,q)}s=L,o=T,h=dt,lt!=null?Ki(n,!!o,lt,!1):!!h!=!!o&&(s!=null?Ki(n,!!o,s,!0):Ki(n,!!o,o?[]:"",!1));return;case"textarea":dt=lt=null;for(L in o)if(g=o[L],o.hasOwnProperty(L)&&g!=null&&!h.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:Be(n,s,L,null,h,g)}for(T in h)if(g=h[T],b=o[T],h.hasOwnProperty(T)&&(g!=null||b!=null))switch(T){case"value":lt=g;break;case"defaultValue":dt=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==b&&Be(n,s,T,g,h,b)}El(n,lt,dt);return;case"option":for(var Vt in o)lt=o[Vt],o.hasOwnProperty(Vt)&&lt!=null&&!h.hasOwnProperty(Vt)&&(Vt==="selected"?n.selected=!1:Be(n,s,Vt,null,h,lt));for(q in h)lt=h[q],dt=o[q],h.hasOwnProperty(q)&&lt!==dt&&(lt!=null||dt!=null)&&(q==="selected"?n.selected=lt&&typeof lt!="function"&&typeof lt!="symbol":Be(n,s,q,lt,h,dt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Jt in o)lt=o[Jt],o.hasOwnProperty(Jt)&&lt!=null&&!h.hasOwnProperty(Jt)&&Be(n,s,Jt,null,h,lt);for(rt in h)if(lt=h[rt],dt=o[rt],h.hasOwnProperty(rt)&&lt!==dt&&(lt!=null||dt!=null))switch(rt){case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(i(137,s));break;default:Be(n,s,rt,lt,h,dt)}return;default:if(Cl(s)){for(var je in o)lt=o[je],o.hasOwnProperty(je)&&lt!==void 0&&!h.hasOwnProperty(je)&&Xf(n,s,je,void 0,h,lt);for(yt in h)lt=h[yt],dt=o[yt],!h.hasOwnProperty(yt)||lt===dt||lt===void 0&&dt===void 0||Xf(n,s,yt,lt,h,dt);return}}for(var tt in o)lt=o[tt],o.hasOwnProperty(tt)&&lt!=null&&!h.hasOwnProperty(tt)&&Be(n,s,tt,null,h,lt);for(vt in h)lt=h[vt],dt=o[vt],!h.hasOwnProperty(vt)||lt===dt||lt==null&&dt==null||Be(n,s,vt,lt,h,dt)}function bb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function Qx(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,o=performance.getEntriesByType("resource"),h=0;h<o.length;h++){var g=o[h],b=g.transferSize,T=g.initiatorType,L=g.duration;if(b&&L&&bb(T)){for(T=0,L=g.responseEnd,h+=1;h<o.length;h++){var q=o[h],rt=q.startTime;if(rt>L)break;var yt=q.transferSize,vt=q.initiatorType;yt&&bb(vt)&&(q=q.responseEnd,T+=yt*(q<L?1:(L-rt)/(q-rt)))}if(--h,s+=8*(b+T)/(g.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Yf=null,Qf=null;function eh(n){return n.nodeType===9?n:n.ownerDocument}function vb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function wb(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Wf(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Zf=null;function Wx(){var n=window.event;return n&&n.type==="popstate"?n===Zf?!1:(Zf=n,!0):(Zf=null,!1)}var xb=typeof setTimeout=="function"?setTimeout:void 0,Zx=typeof clearTimeout=="function"?clearTimeout:void 0,Ab=typeof Promise=="function"?Promise:void 0,Jx=typeof queueMicrotask=="function"?queueMicrotask:typeof Ab<"u"?function(n){return Ab.resolve(null).then(n).catch(t1)}:xb;function t1(n){setTimeout(function(){throw n})}function Va(n){return n==="head"}function Sb(n,s){var o=s,h=0;do{var g=o.nextSibling;if(n.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(h===0){n.removeChild(g),Yo(s);return}h--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")h++;else if(o==="html")dc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,dc(o);for(var b=o.firstChild;b;){var T=b.nextSibling,L=b.nodeName;b[fi]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&b.rel.toLowerCase()==="stylesheet"||o.removeChild(b),b=T}}else o==="body"&&dc(n.ownerDocument.body);o=g}while(o);Yo(s)}function Eb(n,s){var o=n;n=0;do{var h=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=h}while(o)}function Jf(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Jf(o),so(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function e1(n,s,o,h){for(;n.nodeType===1;){var g=o;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(h){if(!n[fi])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(b=n.getAttribute("rel"),b==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(b!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(b=n.getAttribute("src"),(b!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===b)return n}else return n;if(n=ji(n.nextSibling),n===null)break}return null}function n1(n,s,o){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=ji(n.nextSibling),n===null))return null;return n}function _b(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=ji(n.nextSibling),n===null))return null;return n}function tp(n){return n.data==="$?"||n.data==="$~"}function ep(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function i1(n,s){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||o.readyState!=="loading")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),n._reactRetry=h}}function ji(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var np=null;function Cb(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(s===0)return ji(n.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}n=n.nextSibling}return null}function Tb(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return n;s--}else o!=="/$"&&o!=="/&"||s++}n=n.previousSibling}return null}function Rb(n,s,o){switch(s=eh(o),n){case"html":if(n=s.documentElement,!n)throw Error(i(452));return n;case"head":if(n=s.head,!n)throw Error(i(453));return n;case"body":if(n=s.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function dc(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);so(n)}var Fi=new Map,Mb=new Set;function nh(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var sa=st.d;st.d={f:s1,r:a1,D:r1,C:o1,L:l1,m:c1,X:h1,S:u1,M:d1};function s1(){var n=sa.f(),s=Ku();return n||s}function a1(n){var s=ke(n);s!==null&&s.tag===5&&s.type==="form"?$g(s):sa.r(n)}var $o=typeof document>"u"?null:document;function Db(n,s,o){var h=$o;if(h&&typeof s=="string"&&s){var g=Sn(s);g='link[rel="'+n+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Mb.has(g)||(Mb.add(g),n={rel:n,crossOrigin:o,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),Pn(s,"link",n),an(s),h.head.appendChild(s)))}}function r1(n){sa.D(n),Db("dns-prefetch",n,null)}function o1(n,s){sa.C(n,s),Db("preconnect",n,s)}function l1(n,s,o){sa.L(n,s,o);var h=$o;if(h&&n&&s){var g='link[rel="preload"][as="'+Sn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Sn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Sn(o.imageSizes)+'"]')):g+='[href="'+Sn(n)+'"]';var b=g;switch(s){case"style":b=Ko(n);break;case"script":b=Xo(n)}Fi.has(b)||(n=y({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:n,as:s},o),Fi.set(b,n),h.querySelector(g)!==null||s==="style"&&h.querySelector(fc(b))||s==="script"&&h.querySelector(pc(b))||(s=h.createElement("link"),Pn(s,"link",n),an(s),h.head.appendChild(s)))}}function c1(n,s){sa.m(n,s);var o=$o;if(o&&n){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Sn(h)+'"][href="'+Sn(n)+'"]',b=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Xo(n)}if(!Fi.has(b)&&(n=y({rel:"modulepreload",href:n},s),Fi.set(b,n),o.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(pc(b)))return}h=o.createElement("link"),Pn(h,"link",n),an(h),o.head.appendChild(h)}}}function u1(n,s,o){sa.S(n,s,o);var h=$o;if(h&&n){var g=zn(h).hoistableStyles,b=Ko(n);s=s||"default";var T=g.get(b);if(!T){var L={loading:0,preload:null};if(T=h.querySelector(fc(b)))L.loading=5;else{n=y({rel:"stylesheet",href:n,"data-precedence":s},o),(o=Fi.get(b))&&ip(n,o);var q=T=h.createElement("link");an(q),Pn(q,"link",n),q._p=new Promise(function(rt,yt){q.onload=rt,q.onerror=yt}),q.addEventListener("load",function(){L.loading|=1}),q.addEventListener("error",function(){L.loading|=2}),L.loading|=4,ih(T,s,h)}T={type:"stylesheet",instance:T,count:1,state:L},g.set(b,T)}}}function h1(n,s){sa.X(n,s);var o=$o;if(o&&n){var h=zn(o).hoistableScripts,g=Xo(n),b=h.get(g);b||(b=o.querySelector(pc(g)),b||(n=y({src:n,async:!0},s),(s=Fi.get(g))&&sp(n,s),b=o.createElement("script"),an(b),Pn(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function d1(n,s){sa.M(n,s);var o=$o;if(o&&n){var h=zn(o).hoistableScripts,g=Xo(n),b=h.get(g);b||(b=o.querySelector(pc(g)),b||(n=y({src:n,async:!0,type:"module"},s),(s=Fi.get(g))&&sp(n,s),b=o.createElement("script"),an(b),Pn(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function Ob(n,s,o,h){var g=(g=Ut.current)?nh(g):null;if(!g)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Ko(o.href),o=zn(g).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Ko(o.href);var b=zn(g).hoistableStyles,T=b.get(n);if(T||(g=g.ownerDocument||g,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(n,T),(b=g.querySelector(fc(n)))&&!b._p&&(T.instance=b,T.state.loading=5),Fi.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Fi.set(n,o),b||f1(g,n,o,T.state))),s&&h===null)throw Error(i(528,""));return T}if(s&&h!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Xo(o),o=zn(g).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Ko(n){return'href="'+Sn(n)+'"'}function fc(n){return'link[rel="stylesheet"]['+n+"]"}function Nb(n){return y({},n,{"data-precedence":n.precedence,precedence:null})}function f1(n,s,o,h){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=n.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Pn(s,"link",o),an(s),n.head.appendChild(s))}function Xo(n){return'[src="'+Sn(n)+'"]'}function pc(n){return"script[async]"+n}function kb(n,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=n.querySelector('style[data-href~="'+Sn(o.href)+'"]');if(h)return s.instance=h,an(h),h;var g=y({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(n.ownerDocument||n).createElement("style"),an(h),Pn(h,"style",g),ih(h,o.precedence,n),s.instance=h;case"stylesheet":g=Ko(o.href);var b=n.querySelector(fc(g));if(b)return s.state.loading|=4,s.instance=b,an(b),b;h=Nb(o),(g=Fi.get(g))&&ip(h,g),b=(n.ownerDocument||n).createElement("link"),an(b);var T=b;return T._p=new Promise(function(L,q){T.onload=L,T.onerror=q}),Pn(b,"link",h),s.state.loading|=4,ih(b,o.precedence,n),s.instance=b;case"script":return b=Xo(o.src),(g=n.querySelector(pc(b)))?(s.instance=g,an(g),g):(h=o,(g=Fi.get(b))&&(h=y({},o),sp(h,g)),n=n.ownerDocument||n,g=n.createElement("script"),an(g),Pn(g,"link",h),n.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,ih(h,o.precedence,n));return s.instance}function ih(n,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,b=g,T=0;T<h.length;T++){var L=h[T];if(L.dataset.precedence===s)b=L;else if(b!==g)break}b?b.parentNode.insertBefore(n,b.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(n,s.firstChild))}function ip(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function sp(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var sh=null;function Lb(n,s,o){if(sh===null){var h=new Map,g=sh=new Map;g.set(o,h)}else g=sh,h=g.get(o),h||(h=new Map,g.set(o,h));if(h.has(n))return h;for(h.set(n,null),o=o.getElementsByTagName(n),g=0;g<o.length;g++){var b=o[g];if(!(b[fi]||b[ze]||n==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var T=b.getAttribute(s)||"";T=n+T;var L=h.get(T);L?L.push(b):h.set(T,[b])}}return h}function Pb(n,s,o){n=n.ownerDocument||n,n.head.insertBefore(o,s==="title"?n.querySelector("head > title"):null)}function p1(n,s,o){if(o===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(n=s.disabled,typeof s.precedence=="string"&&n==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Bb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function m1(n,s,o,h){if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Ko(h.href),b=s.querySelector(fc(g));if(b){s=b._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=ah.bind(n),s.then(n,n)),o.state.loading|=4,o.instance=b,an(b);return}b=s.ownerDocument||s,h=Nb(h),(g=Fi.get(g))&&ip(h,g),b=b.createElement("link"),an(b);var T=b;T._p=new Promise(function(L,q){T.onload=L,T.onerror=q}),Pn(b,"link",h),o.instance=b}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=ah.bind(n),s.addEventListener("load",o),s.addEventListener("error",o))}}var ap=0;function g1(n,s){return n.stylesheets&&n.count===0&&oh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var h=setTimeout(function(){if(n.stylesheets&&oh(n,n.stylesheets),n.unsuspend){var b=n.unsuspend;n.unsuspend=null,b()}},6e4+s);0<n.imgBytes&&ap===0&&(ap=62500*Qx());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&oh(n,n.stylesheets),n.unsuspend)){var b=n.unsuspend;n.unsuspend=null,b()}},(n.imgBytes>ap?50:800)+s);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function ah(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)oh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var rh=null;function oh(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,rh=new Map,s.forEach(y1,n),rh=null,ah.call(n))}function y1(n,s){if(!(s.state.loading&4)){var o=rh.get(n);if(o)var h=o.get(null);else{o=new Map,rh.set(n,o);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var T=g[b];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),h=T)}h&&o.set(null,h)}g=s.instance,T=g.getAttribute("data-precedence"),b=o.get(T)||h,b===h&&o.set(null,g),o.set(T,g),this.count++,h=ah.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),b?b.parentNode.insertBefore(g,b.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),s.state.loading|=4}}var mc={$$typeof:k,Provider:null,Consumer:null,_currentValue:wt,_currentValue2:wt,_threadCount:0};function b1(n,s,o,h,g,b,T,L,q){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ss(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ss(0),this.hiddenUpdates=ss(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function jb(n,s,o,h,g,b,T,L,q,rt,yt,vt){return n=new b1(n,s,o,T,q,rt,yt,vt,L),s=1,b===!0&&(s|=24),b=gi(3,null,null,s),n.current=b,b.stateNode=n,s=jd(),s.refCount++,n.pooledCache=s,s.refCount++,b.memoizedState={element:h,isDehydrated:o,cache:s},zd(b),n}function Fb(n){return n?(n=_o,n):_o}function Ib(n,s,o,h,g,b){g=Fb(g),h.context===null?h.context=g:h.pendingContext=g,h=La(s),h.payload={element:o},b=b===void 0?null:b,b!==null&&(h.callback=b),o=Pa(n,h,s),o!==null&&(ri(o,n,s),Kl(o,n,s))}function Ub(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<s?o:s}}function rp(n,s){Ub(n,s),(n=n.alternate)&&Ub(n,s)}function zb(n){if(n.tag===13||n.tag===31){var s=De(n,67108864);s!==null&&ri(s,n,67108864),rp(n,67108864)}}function Hb(n){if(n.tag===13||n.tag===31){var s=xi();s=wl(s);var o=De(n,s);o!==null&&ri(o,n,s),rp(n,s)}}var lh=!0;function v1(n,s,o,h){var g=G.T;G.T=null;var b=st.p;try{st.p=2,op(n,s,o,h)}finally{st.p=b,G.T=g}}function w1(n,s,o,h){var g=G.T;G.T=null;var b=st.p;try{st.p=8,op(n,s,o,h)}finally{st.p=b,G.T=g}}function op(n,s,o,h){if(lh){var g=lp(h);if(g===null)Kf(n,s,h,ch,o),Gb(n,h);else if(A1(g,n,s,o,h))h.stopPropagation();else if(Gb(n,h),s&4&&-1<x1.indexOf(n)){for(;g!==null;){var b=ke(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var T=Vi(b.pendingLanes);if(T!==0){var L=b;for(L.pendingLanes|=2,L.entangledLanes|=2;T;){var q=1<<31-Ft(T);L.entanglements[1]|=q,T&=~q}ys(b),(Ee&6)===0&&(Vu=In()+500,cc(0))}}break;case 31:case 13:L=De(b,2),L!==null&&ri(L,b,2),Ku(),rp(b,2)}if(b=lp(h),b===null&&Kf(n,s,h,ch,o),b===g)break;g=b}g!==null&&h.stopPropagation()}else Kf(n,s,h,null,o)}}function lp(n){return n=oo(n),cp(n)}var ch=null;function cp(n){if(ch=null,n=os(n),n!==null){var s=l(n);if(s===null)n=null;else{var o=s.tag;if(o===13){if(n=c(s),n!==null)return n;n=null}else if(o===31){if(n=u(s),n!==null)return n;n=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return ch=n,null}function qb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(lr()){case Un:return 2;case ns:return 8;case pa:case cr:return 32;case eo:return 268435456;default:return 32}default:return 32}}var up=!1,$a=null,Ka=null,Xa=null,gc=new Map,yc=new Map,Ya=[],x1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Gb(n,s){switch(n){case"focusin":case"focusout":$a=null;break;case"dragenter":case"dragleave":Ka=null;break;case"mouseover":case"mouseout":Xa=null;break;case"pointerover":case"pointerout":gc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":yc.delete(s.pointerId)}}function bc(n,s,o,h,g,b){return n===null||n.nativeEvent!==b?(n={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:b,targetContainers:[g]},s!==null&&(s=ke(s),s!==null&&zb(s)),n):(n.eventSystemFlags|=h,s=n.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),n)}function A1(n,s,o,h,g){switch(s){case"focusin":return $a=bc($a,n,s,o,h,g),!0;case"dragenter":return Ka=bc(Ka,n,s,o,h,g),!0;case"mouseover":return Xa=bc(Xa,n,s,o,h,g),!0;case"pointerover":var b=g.pointerId;return gc.set(b,bc(gc.get(b)||null,n,s,o,h,g)),!0;case"gotpointercapture":return b=g.pointerId,yc.set(b,bc(yc.get(b)||null,n,s,o,h,g)),!0}return!1}function Vb(n){var s=os(n.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){n.blockedOn=s,mr(n.priority,function(){Hb(o)});return}}else if(s===31){if(s=u(o),s!==null){n.blockedOn=s,mr(n.priority,function(){Hb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function uh(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var o=lp(n.nativeEvent);if(o===null){o=n.nativeEvent;var h=new o.constructor(o.type,o);Mi=h,o.target.dispatchEvent(h),Mi=null}else return s=ke(o),s!==null&&zb(s),n.blockedOn=o,!1;s.shift()}return!0}function $b(n,s,o){uh(n)&&o.delete(s)}function S1(){up=!1,$a!==null&&uh($a)&&($a=null),Ka!==null&&uh(Ka)&&(Ka=null),Xa!==null&&uh(Xa)&&(Xa=null),gc.forEach($b),yc.forEach($b)}function hh(n,s){n.blockedOn===s&&(n.blockedOn=null,up||(up=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,S1)))}var dh=null;function Kb(n){dh!==n&&(dh=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){dh===n&&(dh=null);for(var s=0;s<n.length;s+=3){var o=n[s],h=n[s+1],g=n[s+2];if(typeof h!="function"){if(cp(h||o)===null)continue;break}var b=ke(o);b!==null&&(n.splice(s,3),s-=3,lf(b,{pending:!0,data:g,method:o.method,action:h},h,g))}}))}function Yo(n){function s(q){return hh(q,n)}$a!==null&&hh($a,n),Ka!==null&&hh(Ka,n),Xa!==null&&hh(Xa,n),gc.forEach(s),yc.forEach(s);for(var o=0;o<Ya.length;o++){var h=Ya[o];h.blockedOn===n&&(h.blockedOn=null)}for(;0<Ya.length&&(o=Ya[0],o.blockedOn===null);)Vb(o),o.blockedOn===null&&Ya.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var g=o[h],b=o[h+1],T=g[sn]||null;if(typeof b=="function")T||Kb(o);else if(T){var L=null;if(b&&b.hasAttribute("formAction")){if(g=b,T=b[sn]||null)L=T.formAction;else if(cp(g)!==null)continue}else L=T.action;typeof L=="function"?o[h+1]=L:(o.splice(h,3),h-=3),Kb(o)}}}function Xb(){function n(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(T){return g=T})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),h||setTimeout(o,20)}function o(){if(!h&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){h=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function hp(n){this._internalRoot=n}fh.prototype.render=hp.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,h=xi();Ib(o,h,n,s,null,null)},fh.prototype.unmount=hp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;Ib(n.current,2,null,n,null,null),Ku(),s[Xn]=null}};function fh(n){this._internalRoot=n}fh.prototype.unstable_scheduleHydration=function(n){if(n){var s=pr();n={blockedOn:null,target:n,priority:s};for(var o=0;o<Ya.length&&s!==0&&s<Ya[o].priority;o++);Ya.splice(o,0,n),o===0&&Vb(n)}};var Yb=t.version;if(Yb!=="19.2.4")throw Error(i(527,Yb,"19.2.4"));st.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(s),n=n!==null?p(n):null,n=n===null?null:n.stateNode,n};var E1={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var ph=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ph.isDisabled&&ph.supportsFiber)try{is=ph.inject(E1),Mn=ph}catch{}}return wc.createRoot=function(n,s){if(!a(n))throw Error(i(299));var o=!1,h="",g=ny,b=iy,T=sy;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),s=jb(n,1,!1,null,null,o,h,null,g,b,T,Xb),n[Xn]=s.current,$f(n),new hp(s)},wc.hydrateRoot=function(n,s,o){if(!a(n))throw Error(i(299));var h=!1,g="",b=ny,T=iy,L=sy,q=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(L=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),s=jb(n,1,!0,s,o??null,h,g,q,b,T,L,Xb),s.context=Fb(null),o=s.current,h=xi(),h=wl(h),g=La(h),g.callback=null,Pa(o,g,h),o=h,s.current.lanes=o,Ti(s,o),ys(s),n[Xn]=s.current,$f(n),new fh(s)},wc.version="19.2.4",wc}var o0;function L1(){if(o0)return mp.exports;o0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),mp.exports=k1(),mp.exports}var P1=L1();var l0="popstate";function B1(r={}){function t(i,a){let{pathname:l,search:c,hash:u}=i.location;return Pp("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(i,a){return typeof a=="string"?a:Lc(a)}return F1(t,e,null,r)}function Qe(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function Ji(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function j1(){return Math.random().toString(36).substring(2,10)}function c0(r,t){return{usr:r.state,key:r.key,idx:t}}function Pp(r,t,e=null,i){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?dl(t):t,state:e,key:t&&t.key||i||j1()}}function Lc({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function dl(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let i=r.indexOf("?");i>=0&&(t.search=r.substring(i),r=r.substring(0,i)),r&&(t.pathname=r)}return t}function F1(r,t,e,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,u="POP",d=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function y(){u="POP";let C=p(),M=C==null?null:C-f;f=C,d&&d({action:u,location:S.location,delta:M})}function w(C,M){u="PUSH";let N=Pp(S.location,C,M);f=p()+1;let k=c0(N,f),j=S.createHref(N);try{c.pushState(k,"",j)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;a.location.assign(j)}l&&d&&d({action:u,location:S.location,delta:1})}function A(C,M){u="REPLACE";let N=Pp(S.location,C,M);f=p();let k=c0(N,f),j=S.createHref(N);c.replaceState(k,"",j),l&&d&&d({action:u,location:S.location,delta:0})}function _(C){return I1(C)}let S={get action(){return u},get location(){return r(a,c)},listen(C){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(l0,y),d=C,()=>{a.removeEventListener(l0,y),d=null}},createHref(C){return t(a,C)},createURL:_,encodeLocation(C){let M=_(C);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:w,replace:A,go(C){return c.go(C)}};return S}function I1(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Qe(e,"No window.location.(origin|href) available to create URL");let i=typeof r=="string"?r:Lc(r);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function Cv(r,t,e="/"){return U1(r,t,e,!1)}function U1(r,t,e,i){let a=typeof t=="string"?dl(t):t,l=ha(a.pathname||"/",e);if(l==null)return null;let c=Tv(r);z1(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let f=Z1(l);u=Q1(c[d],f,i)}return u}function Tv(r,t=[],e=[],i="",a=!1){let l=(c,u,d=a,f)=>{let p={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(i)&&d)return;Qe(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length)}let y=ca([i,p.relativePath]),w=e.concat(p);c.children&&c.children.length>0&&(Qe(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),Tv(c.children,t,w,y,d)),!(c.path==null&&!c.index)&&t.push({path:y,score:X1(y,c.index),routesMeta:w})};return r.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let d of Rv(c.path))l(c,u,!0,d)}),t}function Rv(r){let t=r.split("/");if(t.length===0)return[];let[e,...i]=t,a=e.endsWith("?"),l=e.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=Rv(i.join("/")),u=[];return u.push(...c.map(d=>d===""?l:[l,d].join("/"))),a&&u.push(...c),u.map(d=>r.startsWith("/")&&d===""?"/":d)}function z1(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:Y1(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var H1=/^:[\w-]+$/,q1=3,G1=2,V1=1,$1=10,K1=-2,u0=r=>r==="*";function X1(r,t){let e=r.split("/"),i=e.length;return e.some(u0)&&(i+=K1),t&&(i+=G1),e.filter(a=>!u0(a)).reduce((a,l)=>a+(H1.test(l)?q1:l===""?V1:$1),i)}function Y1(r,t){return r.length===t.length&&r.slice(0,-1).every((i,a)=>i===t[a])?r[r.length-1]-t[t.length-1]:0}function Q1(r,t,e=!1){let{routesMeta:i}=r,a={},l="/",c=[];for(let u=0;u<i.length;++u){let d=i[u],f=u===i.length-1,p=l==="/"?t:t.slice(l.length)||"/",y=Uh({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},p),w=d.route;if(!y&&f&&e&&!i[i.length-1].route.index&&(y=Uh({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!y)return null;Object.assign(a,y.params),c.push({params:a,pathname:ca([l,y.pathname]),pathnameBase:nA(ca([l,y.pathnameBase])),route:w}),y.pathnameBase!=="/"&&(l=ca([l,y.pathnameBase]))}return c}function Uh(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,i]=W1(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:i.reduce((f,{paramName:p,isOptional:y},w)=>{if(p==="*"){let _=u[w]||"";c=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const A=u[w];return y&&!A?f[p]=void 0:f[p]=(A||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:r}}function W1(r,t=!1,e=!0){Ji(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let i=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(i.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function Z1(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ji(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function ha(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=r.charAt(e);return i&&i!=="/"?null:r.slice(e)||"/"}var J1=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function tA(r,t="/"){let{pathname:e,search:i="",hash:a=""}=typeof r=="string"?dl(r):r,l;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?l=h0(e.substring(1),"/"):l=h0(e,t)):l=t,{pathname:l,search:iA(i),hash:sA(a)}}function h0(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function vp(r,t,e,i){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function eA(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function fm(r){let t=eA(r);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function pm(r,t,e,i=!1){let a;typeof r=="string"?a=dl(r):(a={...r},Qe(!a.pathname||!a.pathname.includes("?"),vp("?","pathname","search",a)),Qe(!a.pathname||!a.pathname.includes("#"),vp("#","pathname","hash",a)),Qe(!a.search||!a.search.includes("#"),vp("#","search","hash",a)));let l=r===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=e;else{let y=t.length-1;if(!i&&c.startsWith("..")){let w=c.split("/");for(;w[0]==="..";)w.shift(),y-=1;a.pathname=w.join("/")}u=y>=0?t[y]:"/"}let d=tA(a,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||p)&&(d.pathname+="/"),d}var ca=r=>r.join("/").replace(/\/\/+/g,"/"),nA=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),iA=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,sA=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,aA=class{constructor(r,t,e,i=!1){this.status=r,this.statusText=t||"",this.internal=i,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function rA(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function oA(r){return r.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var Mv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Dv(r,t){let e=r;if(typeof e!="string"||!J1.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let i=e,a=!1;if(Mv)try{let l=new URL(window.location.href),c=e.startsWith("//")?new URL(l.protocol+e):new URL(e),u=ha(c.pathname,t);c.origin===l.origin&&u!=null?e=u+c.search+c.hash:a=!0}catch{Ji(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Ov=["POST","PUT","PATCH","DELETE"];new Set(Ov);var lA=["GET",...Ov];new Set(lA);var fl=I.createContext(null);fl.displayName="DataRouter";var Wh=I.createContext(null);Wh.displayName="DataRouterState";var cA=I.createContext(!1),Nv=I.createContext({isTransitioning:!1});Nv.displayName="ViewTransition";var uA=I.createContext(new Map);uA.displayName="Fetchers";var hA=I.createContext(null);hA.displayName="Await";var Ci=I.createContext(null);Ci.displayName="Navigation";var Hc=I.createContext(null);Hc.displayName="Location";var ts=I.createContext({outlet:null,matches:[],isDataRoute:!1});ts.displayName="Route";var mm=I.createContext(null);mm.displayName="RouteError";var kv="REACT_ROUTER_ERROR",dA="REDIRECT",fA="ROUTE_ERROR_RESPONSE";function pA(r){if(r.startsWith(`${kv}:${dA}:{`))try{let t=JSON.parse(r.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function mA(r){if(r.startsWith(`${kv}:${fA}:{`))try{let t=JSON.parse(r.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new aA(t.status,t.statusText,t.data)}catch{}}function gA(r,{relative:t}={}){Qe(pl(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=I.useContext(Ci),{hash:a,pathname:l,search:c}=qc(r,{relative:t}),u=l;return e!=="/"&&(u=l==="/"?e:ca([e,l])),i.createHref({pathname:u,search:c,hash:a})}function pl(){return I.useContext(Hc)!=null}function ir(){return Qe(pl(),"useLocation() may be used only in the context of a <Router> component."),I.useContext(Hc).location}var Lv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Pv(r){I.useContext(Ci).static||I.useLayoutEffect(r)}function fa(){let{isDataRoute:r}=I.useContext(ts);return r?MA():yA()}function yA(){Qe(pl(),"useNavigate() may be used only in the context of a <Router> component.");let r=I.useContext(fl),{basename:t,navigator:e}=I.useContext(Ci),{matches:i}=I.useContext(ts),{pathname:a}=ir(),l=JSON.stringify(fm(i)),c=I.useRef(!1);return Pv(()=>{c.current=!0}),I.useCallback((d,f={})=>{if(Ji(c.current,Lv),!c.current)return;if(typeof d=="number"){e.go(d);return}let p=pm(d,JSON.parse(l),a,f.relative==="path");r==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:ca([t,p.pathname])),(f.replace?e.replace:e.push)(p,f.state,f)},[t,e,l,a,r])}I.createContext(null);function gm(){let{matches:r}=I.useContext(ts),t=r[r.length-1];return t?t.params:{}}function qc(r,{relative:t}={}){let{matches:e}=I.useContext(ts),{pathname:i}=ir(),a=JSON.stringify(fm(e));return I.useMemo(()=>pm(r,JSON.parse(a),i,t==="path"),[r,a,i,t])}function bA(r,t){return Bv(r,t)}function Bv(r,t,e,i,a){Qe(pl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=I.useContext(Ci),{matches:c}=I.useContext(ts),u=c[c.length-1],d=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",y=u&&u.route;{let N=y&&y.path||"";Fv(f,!y||N.endsWith("*")||N.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${N}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${N}"> to <Route path="${N==="/"?"*":`${N}/*`}">.`)}let w=ir(),A;if(t){let N=typeof t=="string"?dl(t):t;Qe(p==="/"||N.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${N.pathname}" was given in the \`location\` prop.`),A=N}else A=w;let _=A.pathname||"/",S=_;if(p!=="/"){let N=p.replace(/^\//,"").split("/");S="/"+_.replace(/^\//,"").split("/").slice(N.length).join("/")}let C=Cv(r,{pathname:S});Ji(y||C!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),Ji(C==null||C[C.length-1].route.element!==void 0||C[C.length-1].route.Component!==void 0||C[C.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let M=SA(C&&C.map(N=>Object.assign({},N,{params:Object.assign({},d,N.params),pathname:ca([p,l.encodeLocation?l.encodeLocation(N.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathname]),pathnameBase:N.pathnameBase==="/"?p:ca([p,l.encodeLocation?l.encodeLocation(N.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:N.pathnameBase])})),c,e,i,a);return t&&M?I.createElement(Hc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},M):M}function vA(){let r=RA(),t=rA(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",r),c=I.createElement(I.Fragment,null,I.createElement("p",null," Hey developer "),I.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",I.createElement("code",{style:l},"ErrorBoundary")," or"," ",I.createElement("code",{style:l},"errorElement")," prop on your route.")),I.createElement(I.Fragment,null,I.createElement("h2",null,"Unexpected Application Error!"),I.createElement("h3",{style:{fontStyle:"italic"}},t),e?I.createElement("pre",{style:a},e):null,c)}var wA=I.createElement(vA,null),jv=class extends I.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.onError?this.props.onError(r,t):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const e=mA(r.digest);e&&(r=e)}let t=r!==void 0?I.createElement(ts.Provider,{value:this.props.routeContext},I.createElement(mm.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?I.createElement(xA,{error:r},t):t}};jv.contextType=cA;var wp=new WeakMap;function xA({children:r,error:t}){let{basename:e}=I.useContext(Ci);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=pA(t.digest);if(i){let a=wp.get(t);if(a)throw a;let l=Dv(i.location,e);if(Mv&&!wp.get(t))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw wp.set(t,c),c}return I.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return r}function AA({routeContext:r,match:t,children:e}){let i=I.useContext(fl);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),I.createElement(ts.Provider,{value:r},e)}function SA(r,t=[],e=null,i=null,a=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let l=r,c=e?.errors;if(c!=null){let p=l.findIndex(y=>y.route.id&&c?.[y.route.id]!==void 0);Qe(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,p+1))}let u=!1,d=-1;if(e)for(let p=0;p<l.length;p++){let y=l[p];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=p),y.route.id){let{loaderData:w,errors:A}=e,_=y.route.loader&&!w.hasOwnProperty(y.route.id)&&(!A||A[y.route.id]===void 0);if(y.route.lazy||_){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}let f=e&&i?(p,y)=>{i(p,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:oA(e.matches),errorInfo:y})}:void 0;return l.reduceRight((p,y,w)=>{let A,_=!1,S=null,C=null;e&&(A=c&&y.route.id?c[y.route.id]:void 0,S=y.route.errorElement||wA,u&&(d<0&&w===0?(Fv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,C=null):d===w&&(_=!0,C=y.route.hydrateFallbackElement||null)));let M=t.concat(l.slice(0,w+1)),N=()=>{let k;return A?k=S:_?k=C:y.route.Component?k=I.createElement(y.route.Component,null):y.route.element?k=y.route.element:k=p,I.createElement(AA,{match:y,routeContext:{outlet:p,matches:M,isDataRoute:e!=null},children:k})};return e&&(y.route.ErrorBoundary||y.route.errorElement||w===0)?I.createElement(jv,{location:e.location,revalidation:e.revalidation,component:S,error:A,children:N(),routeContext:{outlet:null,matches:M,isDataRoute:!0},onError:f}):N()},null)}function ym(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function EA(r){let t=I.useContext(fl);return Qe(t,ym(r)),t}function _A(r){let t=I.useContext(Wh);return Qe(t,ym(r)),t}function CA(r){let t=I.useContext(ts);return Qe(t,ym(r)),t}function bm(r){let t=CA(r),e=t.matches[t.matches.length-1];return Qe(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function TA(){return bm("useRouteId")}function RA(){let r=I.useContext(mm),t=_A("useRouteError"),e=bm("useRouteError");return r!==void 0?r:t.errors?.[e]}function MA(){let{router:r}=EA("useNavigate"),t=bm("useNavigate"),e=I.useRef(!1);return Pv(()=>{e.current=!0}),I.useCallback(async(a,l={})=>{Ji(e.current,Lv),e.current&&(typeof a=="number"?await r.navigate(a):await r.navigate(a,{fromRouteId:t,...l}))},[r,t])}var d0={};function Fv(r,t,e){!t&&!d0[r]&&(d0[r]=!0,Ji(!1,e))}I.memo(DA);function DA({routes:r,future:t,state:e,onError:i}){return Bv(r,void 0,e,i,t)}function zh({to:r,replace:t,state:e,relative:i}){Qe(pl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=I.useContext(Ci);Ji(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=I.useContext(ts),{pathname:c}=ir(),u=fa(),d=pm(r,fm(l),c,i==="path"),f=JSON.stringify(d);return I.useEffect(()=>{u(JSON.parse(f),{replace:t,state:e,relative:i})},[u,f,i,t,e]),null}function As(r){Qe(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function OA({basename:r="/",children:t=null,location:e,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){Qe(!pl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=r.replace(/^\/*/,"/"),d=I.useMemo(()=>({basename:u,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[u,a,l,c]);typeof e=="string"&&(e=dl(e));let{pathname:f="/",search:p="",hash:y="",state:w=null,key:A="default"}=e,_=I.useMemo(()=>{let S=ha(f,u);return S==null?null:{location:{pathname:S,search:p,hash:y,state:w,key:A},navigationType:i}},[u,f,p,y,w,A,i]);return Ji(_!=null,`<Router basename="${u}"> is not able to match the URL "${f}${p}${y}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:I.createElement(Ci.Provider,{value:d},I.createElement(Hc.Provider,{children:t,value:_}))}function NA({children:r,location:t}){return bA(Bp(r),t)}function Bp(r,t=[]){let e=[];return I.Children.forEach(r,(i,a)=>{if(!I.isValidElement(i))return;let l=[...t,a];if(i.type===I.Fragment){e.push.apply(e,Bp(i.props.children,l));return}Qe(i.type===As,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qe(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Bp(i.props.children,l)),e.push(c)}),e}var Oh="get",Nh="application/x-www-form-urlencoded";function Zh(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function kA(r){return Zh(r)&&r.tagName.toLowerCase()==="button"}function LA(r){return Zh(r)&&r.tagName.toLowerCase()==="form"}function PA(r){return Zh(r)&&r.tagName.toLowerCase()==="input"}function BA(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function jA(r,t){return r.button===0&&(!t||t==="_self")&&!BA(r)}var gh=null;function FA(){if(gh===null)try{new FormData(document.createElement("form"),0),gh=!1}catch{gh=!0}return gh}var IA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function xp(r){return r!=null&&!IA.has(r)?(Ji(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Nh}"`),null):r}function UA(r,t){let e,i,a,l,c;if(LA(r)){let u=r.getAttribute("action");i=u?ha(u,t):null,e=r.getAttribute("method")||Oh,a=xp(r.getAttribute("enctype"))||Nh,l=new FormData(r)}else if(kA(r)||PA(r)&&(r.type==="submit"||r.type==="image")){let u=r.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=r.getAttribute("formaction")||u.getAttribute("action");if(i=d?ha(d,t):null,e=r.getAttribute("formmethod")||u.getAttribute("method")||Oh,a=xp(r.getAttribute("formenctype"))||xp(u.getAttribute("enctype"))||Nh,l=new FormData(u,r),!FA()){let{name:f,type:p,value:y}=r;if(p==="image"){let w=f?`${f}.`:"";l.append(`${w}x`,"0"),l.append(`${w}y`,"0")}else f&&l.append(f,y)}}else{if(Zh(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Oh,i=null,a=Nh,c=r}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:e.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function vm(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function zA(r,t,e,i){let a=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${i}`:a.pathname=`${a.pathname}.${i}`:a.pathname==="/"?a.pathname=`_root.${i}`:t&&ha(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function HA(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function qA(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function GA(r,t,e){let i=await Promise.all(r.map(async a=>{let l=t.routes[a.route.id];if(l){let c=await HA(l,e);return c.links?c.links():[]}return[]}));return XA(i.flat(1).filter(qA).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function f0(r,t,e,i,a,l){let c=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return l==="assets"?t.filter((d,f)=>c(d,f)||u(d,f)):l==="data"?t.filter((d,f)=>{let p=i.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(c(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function VA(r,t,{includeHydrateFallback:e}={}){return $A(r.map(i=>{let a=t.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function $A(r){return[...new Set(r)]}function KA(r){let t={},e=Object.keys(r).sort();for(let i of e)t[i]=r[i];return t}function XA(r,t){let e=new Set;return new Set(t),r.reduce((i,a)=>{let l=JSON.stringify(KA(a));return e.has(l)||(e.add(l),i.push({key:l,link:a})),i},[])}function Iv(){let r=I.useContext(fl);return vm(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function YA(){let r=I.useContext(Wh);return vm(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var wm=I.createContext(void 0);wm.displayName="FrameworkContext";function Uv(){let r=I.useContext(wm);return vm(r,"You must render this element inside a <HydratedRouter> element"),r}function QA(r,t){let e=I.useContext(wm),[i,a]=I.useState(!1),[l,c]=I.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:p,onTouchStart:y}=t,w=I.useRef(null);I.useEffect(()=>{if(r==="render"&&c(!0),r==="viewport"){let S=M=>{M.forEach(N=>{c(N.isIntersecting)})},C=new IntersectionObserver(S,{threshold:.5});return w.current&&C.observe(w.current),()=>{C.disconnect()}}},[r]),I.useEffect(()=>{if(i){let S=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(S)}}},[i]);let A=()=>{a(!0)},_=()=>{a(!1),c(!1)};return e?r!=="intent"?[l,w,{}]:[l,w,{onFocus:xc(u,A),onBlur:xc(d,_),onMouseEnter:xc(f,A),onMouseLeave:xc(p,_),onTouchStart:xc(y,A)}]:[!1,w,{}]}function xc(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function WA({page:r,...t}){let{router:e}=Iv(),i=I.useMemo(()=>Cv(e.routes,r,e.basename),[e.routes,r,e.basename]);return i?I.createElement(JA,{page:r,matches:i,...t}):null}function ZA(r){let{manifest:t,routeModules:e}=Uv(),[i,a]=I.useState([]);return I.useEffect(()=>{let l=!1;return GA(r,t,e).then(c=>{l||a(c)}),()=>{l=!0}},[r,t,e]),i}function JA({page:r,matches:t,...e}){let i=ir(),{future:a,manifest:l,routeModules:c}=Uv(),{basename:u}=Iv(),{loaderData:d,matches:f}=YA(),p=I.useMemo(()=>f0(r,t,f,l,i,"data"),[r,t,f,l,i]),y=I.useMemo(()=>f0(r,t,f,l,i,"assets"),[r,t,f,l,i]),w=I.useMemo(()=>{if(r===i.pathname+i.search+i.hash)return[];let S=new Set,C=!1;if(t.forEach(N=>{let k=l.routes[N.route.id];!k||!k.hasLoader||(!p.some(j=>j.route.id===N.route.id)&&N.route.id in d&&c[N.route.id]?.shouldRevalidate||k.hasClientLoader?C=!0:S.add(N.route.id))}),S.size===0)return[];let M=zA(r,u,a.unstable_trailingSlashAwareDataRequests,"data");return C&&S.size>0&&M.searchParams.set("_routes",t.filter(N=>S.has(N.route.id)).map(N=>N.route.id).join(",")),[M.pathname+M.search]},[u,a.unstable_trailingSlashAwareDataRequests,d,i,l,p,t,r,c]),A=I.useMemo(()=>VA(y,l),[y,l]),_=ZA(y);return I.createElement(I.Fragment,null,w.map(S=>I.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...e})),A.map(S=>I.createElement("link",{key:S,rel:"modulepreload",href:S,...e})),_.map(({key:S,link:C})=>I.createElement("link",{key:S,nonce:e.nonce,...C,crossOrigin:C.crossOrigin??e.crossOrigin})))}function tS(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var eS=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{eS&&(window.__reactRouterVersion="7.13.0")}catch{}function nS({basename:r,children:t,unstable_useTransitions:e,window:i}){let a=I.useRef();a.current==null&&(a.current=B1({window:i,v5Compat:!0}));let l=a.current,[c,u]=I.useState({action:l.action,location:l.location}),d=I.useCallback(f=>{e===!1?u(f):I.startTransition(()=>u(f))},[e]);return I.useLayoutEffect(()=>l.listen(d),[l,d]),I.createElement(OA,{basename:r,children:t,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:e})}var zv=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Jh=I.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:u,target:d,to:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w,...A},_){let{basename:S,unstable_useTransitions:C}=I.useContext(Ci),M=typeof f=="string"&&zv.test(f),N=Dv(f,S);f=N.to;let k=gA(f,{relative:a}),[j,F,z]=QA(i,A),H=rS(f,{replace:c,state:u,target:d,preventScrollReset:p,relative:a,viewTransition:y,unstable_defaultShouldRevalidate:w,unstable_useTransitions:C});function ut(_t){t&&t(_t),_t.defaultPrevented||H(_t)}let ft=I.createElement("a",{...A,...z,href:N.absoluteURL||k,onClick:N.isExternal||l?t:ut,ref:tS(_,F),target:d,"data-discover":!M&&e==="render"?"true":void 0});return j&&!M?I.createElement(I.Fragment,null,ft,I.createElement(WA,{page:k})):ft});Jh.displayName="Link";var iS=I.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:u,children:d,...f},p){let y=qc(c,{relative:f.relative}),w=ir(),A=I.useContext(Wh),{navigator:_,basename:S}=I.useContext(Ci),C=A!=null&&hS(y)&&u===!0,M=_.encodeLocation?_.encodeLocation(y).pathname:y.pathname,N=w.pathname,k=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;e||(N=N.toLowerCase(),k=k?k.toLowerCase():null,M=M.toLowerCase()),k&&S&&(k=ha(k,S)||k);const j=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let F=N===M||!a&&N.startsWith(M)&&N.charAt(j)==="/",z=k!=null&&(k===M||!a&&k.startsWith(M)&&k.charAt(M.length)==="/"),H={isActive:F,isPending:z,isTransitioning:C},ut=F?t:void 0,ft;typeof i=="function"?ft=i(H):ft=[i,F?"active":null,z?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let _t=typeof l=="function"?l(H):l;return I.createElement(Jh,{...f,"aria-current":ut,className:ft,ref:p,style:_t,to:c,viewTransition:u},typeof d=="function"?d(H):d)});iS.displayName="NavLink";var sS=I.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:a,state:l,method:c=Oh,action:u,onSubmit:d,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w,...A},_)=>{let{unstable_useTransitions:S}=I.useContext(Ci),C=cS(),M=uS(u,{relative:f}),N=c.toLowerCase()==="get"?"get":"post",k=typeof u=="string"&&zv.test(u),j=F=>{if(d&&d(F),F.defaultPrevented)return;F.preventDefault();let z=F.nativeEvent.submitter,H=z?.getAttribute("formmethod")||c,ut=()=>C(z||F.currentTarget,{fetcherKey:t,method:H,navigate:e,replace:a,state:l,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w});S&&e!==!1?I.startTransition(()=>ut()):ut()};return I.createElement("form",{ref:_,method:N,action:M,onSubmit:i?d:j,...A,"data-discover":!k&&r==="render"?"true":void 0})});sS.displayName="Form";function aS(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Hv(r){let t=I.useContext(fl);return Qe(t,aS(r)),t}function rS(r,{target:t,replace:e,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let f=fa(),p=ir(),y=qc(r,{relative:l});return I.useCallback(w=>{if(jA(w,t)){w.preventDefault();let A=e!==void 0?e:Lc(p)===Lc(y),_=()=>f(r,{replace:A,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u});d?I.startTransition(()=>_()):_()}},[p,f,y,e,i,t,r,a,l,c,u,d])}var oS=0,lS=()=>`__${String(++oS)}__`;function cS(){let{router:r}=Hv("useSubmit"),{basename:t}=I.useContext(Ci),e=TA(),i=r.fetch,a=r.navigate;return I.useCallback(async(l,c={})=>{let{action:u,method:d,encType:f,formData:p,body:y}=UA(l,t);if(c.navigate===!1){let w=c.fetcherKey||lS();await i(w,e,c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,flushSync:c.flushSync})}else await a(c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:e,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,t,e])}function uS(r,{relative:t}={}){let{basename:e}=I.useContext(Ci),i=I.useContext(ts);Qe(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...qc(r||".",{relative:t})},c=ir();if(r==null){l.search=c.search;let u=new URLSearchParams(l.search),d=u.getAll("index");if(d.some(p=>p==="")){u.delete("index"),d.filter(y=>y).forEach(y=>u.append("index",y));let p=u.toString();l.search=p?`?${p}`:""}}return(!r||r===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(l.pathname=l.pathname==="/"?e:ca([e,l.pathname])),Lc(l)}function hS(r,{relative:t}={}){let e=I.useContext(Nv);Qe(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Hv("useViewTransitionState"),a=qc(r,{relative:t});if(!e.isTransitioning)return!1;let l=ha(e.currentLocation.pathname,i)||e.currentLocation.pathname,c=ha(e.nextLocation.pathname,i)||e.nextLocation.pathname;return Uh(a.pathname,c)!=null||Uh(a.pathname,l)!=null}var dS=_v(),ml=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},fS={setTimeout:(r,t)=>setTimeout(r,t),clearTimeout:r=>clearTimeout(r),setInterval:(r,t)=>setInterval(r,t),clearInterval:r=>clearInterval(r)},pS=class{#t=fS;#e=!1;setTimeoutProvider(r){this.#t=r}setTimeout(r,t){return this.#t.setTimeout(r,t)}clearTimeout(r){this.#t.clearTimeout(r)}setInterval(r,t){return this.#t.setInterval(r,t)}clearInterval(r){this.#t.clearInterval(r)}},zr=new pS;function mS(r){setTimeout(r,0)}var Xr=typeof window>"u"||"Deno"in globalThis;function Zn(){}function gS(r,t){return typeof r=="function"?r(t):r}function jp(r){return typeof r=="number"&&r>=0&&r!==1/0}function qv(r,t){return Math.max(r+(t||0)-Date.now(),0)}function Ja(r,t){return typeof r=="function"?r(t):r}function Hi(r,t){return typeof r=="function"?r(t):r}function p0(r,t){const{type:e="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:u}=r;if(c){if(i){if(t.queryHash!==xm(c,t.options))return!1}else if(!Pc(t.queryKey,c))return!1}if(e!=="all"){const d=t.isActive();if(e==="active"&&!d||e==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||a&&a!==t.state.fetchStatus||l&&!l(t))}function m0(r,t){const{exact:e,status:i,predicate:a,mutationKey:l}=r;if(l){if(!t.options.mutationKey)return!1;if(e){if(Yr(t.options.mutationKey)!==Yr(l))return!1}else if(!Pc(t.options.mutationKey,l))return!1}return!(i&&t.state.status!==i||a&&!a(t))}function xm(r,t){return(t?.queryKeyHashFn||Yr)(r)}function Yr(r){return JSON.stringify(r,(t,e)=>Fp(e)?Object.keys(e).sort().reduce((i,a)=>(i[a]=e[a],i),{}):e)}function Pc(r,t){return r===t?!0:typeof r!=typeof t?!1:r&&t&&typeof r=="object"&&typeof t=="object"?Object.keys(t).every(e=>Pc(r[e],t[e])):!1}var yS=Object.prototype.hasOwnProperty;function Gv(r,t,e=0){if(r===t)return r;if(e>500)return t;const i=g0(r)&&g0(t);if(!i&&!(Fp(r)&&Fp(t)))return t;const l=(i?r:Object.keys(r)).length,c=i?t:Object.keys(t),u=c.length,d=i?new Array(u):{};let f=0;for(let p=0;p<u;p++){const y=i?p:c[p],w=r[y],A=t[y];if(w===A){d[y]=w,(i?p<l:yS.call(r,y))&&f++;continue}if(w===null||A===null||typeof w!="object"||typeof A!="object"){d[y]=A;continue}const _=Gv(w,A,e+1);d[y]=_,_===w&&f++}return l===u&&f===l?r:d}function Hh(r,t){if(!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}function g0(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Fp(r){if(!y0(r))return!1;const t=r.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!y0(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function y0(r){return Object.prototype.toString.call(r)==="[object Object]"}function bS(r){return new Promise(t=>{zr.setTimeout(t,r)})}function Ip(r,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(r,t):e.structuralSharing!==!1?Gv(r,t):t}function vS(r,t,e=0){const i=[...r,t];return e&&i.length>e?i.slice(1):i}function wS(r,t,e=0){const i=[t,...r];return e&&i.length>e?i.slice(0,-1):i}var Am=Symbol();function Vv(r,t){return!r.queryFn&&t?.initialPromise?()=>t.initialPromise:!r.queryFn||r.queryFn===Am?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function Sm(r,t){return typeof r=="function"?r(...t):!!r}function xS(r,t,e){let i=!1,a;return Object.defineProperty(r,"signal",{enumerable:!0,get:()=>(a??=t(),i||(i=!0,a.aborted?e():a.addEventListener("abort",e,{once:!0})),a)}),r}var AS=class extends ml{#t;#e;#i;constructor(){super(),this.#i=r=>{if(!Xr&&window.addEventListener){const t=()=>r();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(r){this.#i=r,this.#e?.(),this.#e=r(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(r){this.#t!==r&&(this.#t=r,this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(t=>{t(r)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},Em=new AS;function Up(){let r,t;const e=new Promise((a,l)=>{r=a,t=l});e.status="pending",e.catch(()=>{});function i(a){Object.assign(e,a),delete e.resolve,delete e.reject}return e.resolve=a=>{i({status:"fulfilled",value:a}),r(a)},e.reject=a=>{i({status:"rejected",reason:a}),t(a)},e}var SS=mS;function ES(){let r=[],t=0,e=u=>{u()},i=u=>{u()},a=SS;const l=u=>{t?r.push(u):a(()=>{e(u)})},c=()=>{const u=r;r=[],u.length&&a(()=>{i(()=>{u.forEach(d=>{e(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{l(()=>{u(...d)})},schedule:l,setNotifyFunction:u=>{e=u},setBatchNotifyFunction:u=>{i=u},setScheduler:u=>{a=u}}}var vn=ES(),_S=class extends ml{#t=!0;#e;#i;constructor(){super(),this.#i=r=>{if(!Xr&&window.addEventListener){const t=()=>r(!0),e=()=>r(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",e,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(r){this.#i=r,this.#e?.(),this.#e=r(this.setOnline.bind(this))}setOnline(r){this.#t!==r&&(this.#t=r,this.listeners.forEach(e=>{e(r)}))}isOnline(){return this.#t}},qh=new _S;function CS(r){return Math.min(1e3*2**r,3e4)}function $v(r){return(r??"online")==="online"?qh.isOnline():!0}var zp=class extends Error{constructor(r){super("CancelledError"),this.revert=r?.revert,this.silent=r?.silent}};function Kv(r){let t=!1,e=0,i;const a=Up(),l=()=>a.status!=="pending",c=S=>{if(!l()){const C=new zp(S);w(C),r.onCancel?.(C)}},u=()=>{t=!0},d=()=>{t=!1},f=()=>Em.isFocused()&&(r.networkMode==="always"||qh.isOnline())&&r.canRun(),p=()=>$v(r.networkMode)&&r.canRun(),y=S=>{l()||(i?.(),a.resolve(S))},w=S=>{l()||(i?.(),a.reject(S))},A=()=>new Promise(S=>{i=C=>{(l()||f())&&S(C)},r.onPause?.()}).then(()=>{i=void 0,l()||r.onContinue?.()}),_=()=>{if(l())return;let S;const C=e===0?r.initialPromise:void 0;try{S=C??r.fn()}catch(M){S=Promise.reject(M)}Promise.resolve(S).then(y).catch(M=>{if(l())return;const N=r.retry??(Xr?0:3),k=r.retryDelay??CS,j=typeof k=="function"?k(e,M):k,F=N===!0||typeof N=="number"&&e<N||typeof N=="function"&&N(e,M);if(t||!F){w(M);return}e++,r.onFail?.(e,M),bS(j).then(()=>f()?void 0:A()).then(()=>{t?w(M):_()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:u,continueRetry:d,canStart:p,start:()=>(p()?_():A().then(_),a)}}var Xv=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),jp(this.gcTime)&&(this.#t=zr.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Xr?1/0:300*1e3))}clearGcTimeout(){this.#t&&(zr.clearTimeout(this.#t),this.#t=void 0)}},TS=class extends Xv{#t;#e;#i;#n;#s;#r;#a;constructor(r){super(),this.#a=!1,this.#r=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.#n=r.client,this.#i=this.#n.getQueryCache(),this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.#t=v0(this.options),this.state=r.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(r){if(this.options={...this.#r,...r},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=v0(this.options);t.data!==void 0&&(this.setState(b0(t.data,t.dataUpdatedAt)),this.#t=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#i.remove(this)}setData(r,t){const e=Ip(this.state.data,r,this.options);return this.#o({data:e,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),e}setState(r,t){this.#o({type:"setState",state:r,setStateOptions:t})}cancel(r){const t=this.#s?.promise;return this.#s?.cancel(r),t?t.then(Zn).catch(Zn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(r=>Hi(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Am||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>Ja(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!qv(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(t=>t!==r),this.observers.length||(this.#s&&(this.#a?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#i.notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#o({type:"invalidate"})}async fetch(r,t){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(r&&this.setOptions(r),!this.options.queryFn){const u=this.observers.find(d=>d.options.queryFn);u&&this.setOptions(u.options)}const e=new AbortController,i=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(this.#a=!0,e.signal)})},a=()=>{const u=Vv(this.options,t),f=(()=>{const p={client:this.#n,queryKey:this.queryKey,meta:this.meta};return i(p),p})();return this.#a=!1,this.options.persister?this.options.persister(u,f,this):u(f)},c=(()=>{const u={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:a};return i(u),u})();this.options.behavior?.onFetch(c,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&this.#o({type:"fetch",meta:c.fetchOptions?.meta}),this.#s=Kv({initialPromise:t?.initialPromise,fn:c.fetchFn,onCancel:u=>{u instanceof zp&&u.revert&&this.setState({...this.#e,fetchStatus:"idle"}),e.abort()},onFail:(u,d)=>{this.#o({type:"failed",failureCount:u,error:d})},onPause:()=>{this.#o({type:"pause"})},onContinue:()=>{this.#o({type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0});try{const u=await this.#s.start();if(u===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(u),this.#i.config.onSuccess?.(u,this),this.#i.config.onSettled?.(u,this.state.error,this),u}catch(u){if(u instanceof zp){if(u.silent)return this.#s.promise;if(u.revert){if(this.state.data===void 0)throw u;return this.state.data}}throw this.#o({type:"error",error:u}),this.#i.config.onError?.(u,this),this.#i.config.onSettled?.(this.state.data,u,this),u}finally{this.scheduleGc()}}#o(r){const t=e=>{switch(r.type){case"failed":return{...e,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...e,fetchStatus:"paused"};case"continue":return{...e,fetchStatus:"fetching"};case"fetch":return{...e,...Yv(e.data,this.options),fetchMeta:r.meta??null};case"success":const i={...e,...b0(r.data,r.dataUpdatedAt),dataUpdateCount:e.dataUpdateCount+1,...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=r.manual?i:void 0,i;case"error":const a=r.error;return{...e,error:a,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...e,isInvalidated:!0};case"setState":return{...e,...r.state}}};this.state=t(this.state),vn.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#i.notify({query:this,type:"updated",action:r})})}};function Yv(r,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:$v(t.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function b0(r,t){return{data:r,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function v0(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=t!==void 0,i=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var RS=class extends ml{constructor(r,t){super(),this.options=t,this.#t=r,this.#o=null,this.#a=Up(),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#i=void 0;#n=void 0;#s;#r;#a;#o;#c;#l;#d;#h;#f;#g;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),w0(this.#e,this.options)?this.#u():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Hp(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Hp(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#E(),this.#S(),this.#e.removeObserver(this)}setOptions(r){const t=this.options,e=this.#e;if(this.options=this.#t.defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Hi(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#e.setOptions(this.options),t._defaulted&&!Hh(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const i=this.hasListeners();i&&x0(this.#e,e,this.options,t)&&this.#u(),this.updateResult(),i&&(this.#e!==e||Hi(this.options.enabled,this.#e)!==Hi(t.enabled,this.#e)||Ja(this.options.staleTime,this.#e)!==Ja(t.staleTime,this.#e))&&this.#p();const a=this.#y();i&&(this.#e!==e||Hi(this.options.enabled,this.#e)!==Hi(t.enabled,this.#e)||a!==this.#g)&&this.#v(a)}getOptimisticResult(r){const t=this.#t.getQueryCache().build(this.#t,r),e=this.createResult(t,r);return DS(this,e)&&(this.#n=e,this.#r=this.options,this.#s=this.#e.state),e}getCurrentResult(){return this.#n}trackResult(r,t){return new Proxy(r,{get:(e,i)=>(this.trackProp(i),t?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,i))})}trackProp(r){this.#m.add(r)}getCurrentQuery(){return this.#e}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const t=this.#t.defaultQueryOptions(r),e=this.#t.getQueryCache().build(this.#t,t);return e.fetch().then(()=>this.createResult(e,t))}fetch(r){return this.#u({...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#u(r){this.#w();let t=this.#e.fetch(this.options,r);return r?.throwOnError||(t=t.catch(Zn)),t}#p(){this.#E();const r=Ja(this.options.staleTime,this.#e);if(Xr||this.#n.isStale||!jp(r))return;const e=qv(this.#n.dataUpdatedAt,r)+1;this.#h=zr.setTimeout(()=>{this.#n.isStale||this.updateResult()},e)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#v(r){this.#S(),this.#g=r,!(Xr||Hi(this.options.enabled,this.#e)===!1||!jp(this.#g)||this.#g===0)&&(this.#f=zr.setInterval(()=>{(this.options.refetchIntervalInBackground||Em.isFocused())&&this.#u()},this.#g))}#b(){this.#p(),this.#v(this.#y())}#E(){this.#h&&(zr.clearTimeout(this.#h),this.#h=void 0)}#S(){this.#f&&(zr.clearInterval(this.#f),this.#f=void 0)}createResult(r,t){const e=this.#e,i=this.options,a=this.#n,l=this.#s,c=this.#r,d=r!==e?r.state:this.#i,{state:f}=r;let p={...f},y=!1,w;if(t._optimisticResults){const ut=this.hasListeners(),ft=!ut&&w0(r,t),_t=ut&&x0(r,e,t,i);(ft||_t)&&(p={...p,...Yv(f.data,r.options)}),t._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:A,errorUpdatedAt:_,status:S}=p;w=p.data;let C=!1;if(t.placeholderData!==void 0&&w===void 0&&S==="pending"){let ut;a?.isPlaceholderData&&t.placeholderData===c?.placeholderData?(ut=a.data,C=!0):ut=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,ut!==void 0&&(S="success",w=Ip(a?.data,ut,t),y=!0)}if(t.select&&w!==void 0&&!C)if(a&&w===l?.data&&t.select===this.#c)w=this.#l;else try{this.#c=t.select,w=t.select(w),w=Ip(a?.data,w,t),this.#l=w,this.#o=null}catch(ut){this.#o=ut}this.#o&&(A=this.#o,w=this.#l,_=Date.now(),S="error");const M=p.fetchStatus==="fetching",N=S==="pending",k=S==="error",j=N&&M,F=w!==void 0,H={status:S,fetchStatus:p.fetchStatus,isPending:N,isSuccess:S==="success",isError:k,isInitialLoading:j,isLoading:j,data:w,dataUpdatedAt:p.dataUpdatedAt,error:A,errorUpdatedAt:_,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:M,isRefetching:M&&!N,isLoadingError:k&&!F,isPaused:p.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:k&&F,isStale:_m(r,t),refetch:this.refetch,promise:this.#a,isEnabled:Hi(t.enabled,r)!==!1};if(this.options.experimental_prefetchInRender){const ut=H.data!==void 0,ft=H.status==="error"&&!ut,_t=Lt=>{ft?Lt.reject(H.error):ut&&Lt.resolve(H.data)},ct=()=>{const Lt=this.#a=H.promise=Up();_t(Lt)},Rt=this.#a;switch(Rt.status){case"pending":r.queryHash===e.queryHash&&_t(Rt);break;case"fulfilled":(ft||H.data!==Rt.value)&&ct();break;case"rejected":(!ft||H.error!==Rt.reason)&&ct();break}}return H}updateResult(){const r=this.#n,t=this.createResult(this.#e,this.options);if(this.#s=this.#e.state,this.#r=this.options,this.#s.data!==void 0&&(this.#d=this.#e),Hh(t,r))return;this.#n=t;const e=()=>{if(!r)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#n).some(c=>{const u=c;return this.#n[u]!==r[u]&&l.has(u)})};this.#C({listeners:e()})}#w(){const r=this.#t.getQueryCache().build(this.#t,this.options);if(r===this.#e)return;const t=this.#e;this.#e=r,this.#i=r.state,this.hasListeners()&&(t?.removeObserver(this),r.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#C(r){vn.batch(()=>{r.listeners&&this.listeners.forEach(t=>{t(this.#n)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function MS(r,t){return Hi(t.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&t.retryOnMount===!1)}function w0(r,t){return MS(r,t)||r.state.data!==void 0&&Hp(r,t,t.refetchOnMount)}function Hp(r,t,e){if(Hi(t.enabled,r)!==!1&&Ja(t.staleTime,r)!=="static"){const i=typeof e=="function"?e(r):e;return i==="always"||i!==!1&&_m(r,t)}return!1}function x0(r,t,e,i){return(r!==t||Hi(i.enabled,r)===!1)&&(!e.suspense||r.state.status!=="error")&&_m(r,e)}function _m(r,t){return Hi(t.enabled,r)!==!1&&r.isStaleByTime(Ja(t.staleTime,r))}function DS(r,t){return!Hh(r.getCurrentResult(),t)}function A0(r){return{onFetch:(t,e)=>{const i=t.options,a=t.fetchOptions?.meta?.fetchMore?.direction,l=t.state.data?.pages||[],c=t.state.data?.pageParams||[];let u={pages:[],pageParams:[]},d=0;const f=async()=>{let p=!1;const y=_=>{xS(_,()=>t.signal,()=>p=!0)},w=Vv(t.options,t.fetchOptions),A=async(_,S,C)=>{if(p)return Promise.reject();if(S==null&&_.pages.length)return Promise.resolve(_);const N=(()=>{const z={client:t.client,queryKey:t.queryKey,pageParam:S,direction:C?"backward":"forward",meta:t.options.meta};return y(z),z})(),k=await w(N),{maxPages:j}=t.options,F=C?wS:vS;return{pages:F(_.pages,k,j),pageParams:F(_.pageParams,S,j)}};if(a&&l.length){const _=a==="backward",S=_?OS:S0,C={pages:l,pageParams:c},M=S(i,C);u=await A(C,M,_)}else{const _=r??l.length;do{const S=d===0?c[0]??i.initialPageParam:S0(i,u);if(d>0&&S==null)break;u=await A(u,S),d++}while(d<_)}return u};t.options.persister?t.fetchFn=()=>t.options.persister?.(f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e):t.fetchFn=f}}}function S0(r,{pages:t,pageParams:e}){const i=t.length-1;return t.length>0?r.getNextPageParam(t[i],t,e[i],e):void 0}function OS(r,{pages:t,pageParams:e}){return t.length>0?r.getPreviousPageParam?.(t[0],t,e[0],e):void 0}var NS=class extends Xv{#t;#e;#i;#n;constructor(r){super(),this.#t=r.client,this.mutationId=r.mutationId,this.#i=r.mutationCache,this.#e=[],this.state=r.state||Qv(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){this.#e.includes(r)||(this.#e.push(r),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){this.#e=this.#e.filter(t=>t!==r),this.scheduleGc(),this.#i.notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#i.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(r){const t=()=>{this.#s({type:"continue"})},e={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#n=Kv({fn:()=>this.options.mutationFn?this.options.mutationFn(r,e):Promise.reject(new Error("No mutationFn found")),onFail:(l,c)=>{this.#s({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#i.canRun(this)});const i=this.state.status==="pending",a=!this.#n.canStart();try{if(i)t();else{this.#s({type:"pending",variables:r,isPaused:a}),this.#i.config.onMutate&&await this.#i.config.onMutate(r,this,e);const c=await this.options.onMutate?.(r,e);c!==this.state.context&&this.#s({type:"pending",context:c,variables:r,isPaused:a})}const l=await this.#n.start();return await this.#i.config.onSuccess?.(l,r,this.state.context,this,e),await this.options.onSuccess?.(l,r,this.state.context,e),await this.#i.config.onSettled?.(l,null,this.state.variables,this.state.context,this,e),await this.options.onSettled?.(l,null,r,this.state.context,e),this.#s({type:"success",data:l}),l}catch(l){try{await this.#i.config.onError?.(l,r,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onError?.(l,r,this.state.context,e)}catch(c){Promise.reject(c)}try{await this.#i.config.onSettled?.(void 0,l,this.state.variables,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onSettled?.(void 0,l,r,this.state.context,e)}catch(c){Promise.reject(c)}throw this.#s({type:"error",error:l}),l}finally{this.#i.runNext(this)}}#s(r){const t=e=>{switch(r.type){case"failed":return{...e,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...e,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:r.error,failureCount:e.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=t(this.state),vn.batch(()=>{this.#e.forEach(e=>{e.onMutationUpdate(r)}),this.#i.notify({mutation:this,type:"updated",action:r})})}};function Qv(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var kS=class extends ml{constructor(r={}){super(),this.config=r,this.#t=new Set,this.#e=new Map,this.#i=0}#t;#e;#i;build(r,t,e){const i=new NS({client:r,mutationCache:this,mutationId:++this.#i,options:r.defaultMutationOptions(t),state:e});return this.add(i),i}add(r){this.#t.add(r);const t=yh(r);if(typeof t=="string"){const e=this.#e.get(t);e?e.push(r):this.#e.set(t,[r])}this.notify({type:"added",mutation:r})}remove(r){if(this.#t.delete(r)){const t=yh(r);if(typeof t=="string"){const e=this.#e.get(t);if(e)if(e.length>1){const i=e.indexOf(r);i!==-1&&e.splice(i,1)}else e[0]===r&&this.#e.delete(t)}}this.notify({type:"removed",mutation:r})}canRun(r){const t=yh(r);if(typeof t=="string"){const i=this.#e.get(t)?.find(a=>a.state.status==="pending");return!i||i===r}else return!0}runNext(r){const t=yh(r);return typeof t=="string"?this.#e.get(t)?.find(i=>i!==r&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){vn.batch(()=>{this.#t.forEach(r=>{this.notify({type:"removed",mutation:r})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(r){const t={exact:!0,...r};return this.getAll().find(e=>m0(t,e))}findAll(r={}){return this.getAll().filter(t=>m0(r,t))}notify(r){vn.batch(()=>{this.listeners.forEach(t=>{t(r)})})}resumePausedMutations(){const r=this.getAll().filter(t=>t.state.isPaused);return vn.batch(()=>Promise.all(r.map(t=>t.continue().catch(Zn))))}};function yh(r){return r.options.scope?.id}var LS=class extends ml{#t;#e=void 0;#i;#n;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),Hh(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#i,observer:this}),e?.mutationKey&&this.options.mutationKey&&Yr(e.mutationKey)!==Yr(this.options.mutationKey)?this.reset():this.#i?.state.status==="pending"&&this.#i.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#i?.removeObserver(this)}onMutationUpdate(t){this.#s(),this.#r(t)}getCurrentResult(){return this.#e}reset(){this.#i?.removeObserver(this),this.#i=void 0,this.#s(),this.#r()}mutate(t,e){return this.#n=e,this.#i?.removeObserver(this),this.#i=this.#t.getMutationCache().build(this.#t,this.options),this.#i.addObserver(this),this.#i.execute(t)}#s(){const t=this.#i?.state??Qv();this.#e={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#r(t){vn.batch(()=>{if(this.#n&&this.hasListeners()){const e=this.#e.variables,i=this.#e.context,a={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#n.onSuccess?.(t.data,e,i,a)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(t.data,null,e,i,a)}catch(l){Promise.reject(l)}}else if(t?.type==="error"){try{this.#n.onError?.(t.error,e,i,a)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(void 0,t.error,e,i,a)}catch(l){Promise.reject(l)}}}this.listeners.forEach(e=>{e(this.#e)})})}},PS=class extends ml{constructor(r={}){super(),this.config=r,this.#t=new Map}#t;build(r,t,e){const i=t.queryKey,a=t.queryHash??xm(i,t);let l=this.get(a);return l||(l=new TS({client:r,queryKey:i,queryHash:a,options:r.defaultQueryOptions(t),state:e,defaultOptions:r.getQueryDefaults(i)}),this.add(l)),l}add(r){this.#t.has(r.queryHash)||(this.#t.set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const t=this.#t.get(r.queryHash);t&&(r.destroy(),t===r&&this.#t.delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){vn.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return this.#t.get(r)}getAll(){return[...this.#t.values()]}find(r){const t={exact:!0,...r};return this.getAll().find(e=>p0(t,e))}findAll(r={}){const t=this.getAll();return Object.keys(r).length>0?t.filter(e=>p0(r,e)):t}notify(r){vn.batch(()=>{this.listeners.forEach(t=>{t(r)})})}onFocus(){vn.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){vn.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},BS=class{#t;#e;#i;#n;#s;#r;#a;#o;constructor(r={}){this.#t=r.queryCache||new PS,this.#e=r.mutationCache||new kS,this.#i=r.defaultOptions||{},this.#n=new Map,this.#s=new Map,this.#r=0}mount(){this.#r++,this.#r===1&&(this.#a=Em.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#o=qh.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#r--,this.#r===0&&(this.#a?.(),this.#a=void 0,this.#o?.(),this.#o=void 0)}isFetching(r){return this.#t.findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return this.#e.findAll({...r,status:"pending"}).length}getQueryData(r){const t=this.defaultQueryOptions({queryKey:r});return this.#t.get(t.queryHash)?.state.data}ensureQueryData(r){const t=this.defaultQueryOptions(r),e=this.#t.build(this,t),i=e.state.data;return i===void 0?this.fetchQuery(r):(r.revalidateIfStale&&e.isStaleByTime(Ja(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(r){return this.#t.findAll(r).map(({queryKey:t,state:e})=>{const i=e.data;return[t,i]})}setQueryData(r,t,e){const i=this.defaultQueryOptions({queryKey:r}),l=this.#t.get(i.queryHash)?.state.data,c=gS(t,l);if(c!==void 0)return this.#t.build(this,i).setData(c,{...e,manual:!0})}setQueriesData(r,t,e){return vn.batch(()=>this.#t.findAll(r).map(({queryKey:i})=>[i,this.setQueryData(i,t,e)]))}getQueryState(r){const t=this.defaultQueryOptions({queryKey:r});return this.#t.get(t.queryHash)?.state}removeQueries(r){const t=this.#t;vn.batch(()=>{t.findAll(r).forEach(e=>{t.remove(e)})})}resetQueries(r,t){const e=this.#t;return vn.batch(()=>(e.findAll(r).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...r},t)))}cancelQueries(r,t={}){const e={revert:!0,...t},i=vn.batch(()=>this.#t.findAll(r).map(a=>a.cancel(e)));return Promise.all(i).then(Zn).catch(Zn)}invalidateQueries(r,t={}){return vn.batch(()=>(this.#t.findAll(r).forEach(e=>{e.invalidate()}),r?.refetchType==="none"?Promise.resolve():this.refetchQueries({...r,type:r?.refetchType??r?.type??"active"},t)))}refetchQueries(r,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},i=vn.batch(()=>this.#t.findAll(r).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,e);return e.throwOnError||(l=l.catch(Zn)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(Zn)}fetchQuery(r){const t=this.defaultQueryOptions(r);t.retry===void 0&&(t.retry=!1);const e=this.#t.build(this,t);return e.isStaleByTime(Ja(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(Zn).catch(Zn)}fetchInfiniteQuery(r){return r.behavior=A0(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(Zn).catch(Zn)}ensureInfiniteQueryData(r){return r.behavior=A0(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return qh.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#i}setDefaultOptions(r){this.#i=r}setQueryDefaults(r,t){this.#n.set(Yr(r),{queryKey:r,defaultOptions:t})}getQueryDefaults(r){const t=[...this.#n.values()],e={};return t.forEach(i=>{Pc(r,i.queryKey)&&Object.assign(e,i.defaultOptions)}),e}setMutationDefaults(r,t){this.#s.set(Yr(r),{mutationKey:r,defaultOptions:t})}getMutationDefaults(r){const t=[...this.#s.values()],e={};return t.forEach(i=>{Pc(r,i.mutationKey)&&Object.assign(e,i.defaultOptions)}),e}defaultQueryOptions(r){if(r._defaulted)return r;const t={...this.#i.queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return t.queryHash||(t.queryHash=xm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Am&&(t.enabled=!1),t}defaultMutationOptions(r){return r?._defaulted?r:{...this.#i.mutations,...r?.mutationKey&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},Wv=I.createContext(void 0),gl=r=>{const t=I.useContext(Wv);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},jS=({client:r,children:t})=>(I.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),D.jsx(Wv.Provider,{value:r,children:t})),Zv=I.createContext(!1),FS=()=>I.useContext(Zv);Zv.Provider;function IS(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var US=I.createContext(IS()),zS=()=>I.useContext(US),HS=(r,t,e)=>{const i=e?.state.error&&typeof r.throwOnError=="function"?Sm(r.throwOnError,[e.state.error,e]):r.throwOnError;(r.suspense||r.experimental_prefetchInRender||i)&&(t.isReset()||(r.retryOnMount=!1))},qS=r=>{I.useEffect(()=>{r.clearReset()},[r])},GS=({result:r,errorResetBoundary:t,throwOnError:e,query:i,suspense:a})=>r.isError&&!t.isReset()&&!r.isFetching&&i&&(a&&r.data===void 0||Sm(e,[r.error,i])),VS=r=>{if(r.suspense){const e=a=>a==="static"?a:Math.max(a??1e3,1e3),i=r.staleTime;r.staleTime=typeof i=="function"?(...a)=>e(i(...a)):e(i),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3))}},$S=(r,t)=>r.isLoading&&r.isFetching&&!t,KS=(r,t)=>r?.suspense&&t.isPending,E0=(r,t,e)=>t.fetchOptimistic(r).catch(()=>{e.clearReset()});function XS(r,t,e){const i=FS(),a=zS(),l=gl(),c=l.defaultQueryOptions(r);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c);const u=l.getQueryCache().get(c.queryHash);c._optimisticResults=i?"isRestoring":"optimistic",VS(c),HS(c,a,u),qS(a);const d=!l.getQueryCache().get(c.queryHash),[f]=I.useState(()=>new t(l,c)),p=f.getOptimisticResult(c),y=!i&&r.subscribed!==!1;if(I.useSyncExternalStore(I.useCallback(w=>{const A=y?f.subscribe(vn.batchCalls(w)):Zn;return f.updateResult(),A},[f,y]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),I.useEffect(()=>{f.setOptions(c)},[c,f]),KS(c,p))throw E0(c,f,a);if(GS({result:p,errorResetBoundary:a,throwOnError:c.throwOnError,query:u,suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!Xr&&$S(p,i)&&(d?E0(c,f,a):u?.promise)?.catch(Zn).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function tr(r,t){return XS(r,RS)}function Nc(r,t){const e=gl(),[i]=I.useState(()=>new LS(e,r));I.useEffect(()=>{i.setOptions(r)},[i,r]);const a=I.useSyncExternalStore(I.useCallback(c=>i.subscribe(vn.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=I.useCallback((c,u)=>{i.mutate(c,u).catch(Zn)},[i]);if(a.error&&Sm(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}const _0=r=>{let t;const e=new Set,i=(f,p)=>{const y=typeof f=="function"?f(t):f;if(!Object.is(y,t)){const w=t;t=p??(typeof y!="object"||y===null)?y:Object.assign({},t,y),e.forEach(A=>A(t,w))}},a=()=>t,u={setState:i,getState:a,getInitialState:()=>d,subscribe:f=>(e.add(f),()=>e.delete(f))},d=t=r(i,a,u);return u},YS=(r=>r?_0(r):_0),QS=r=>r;function WS(r,t=QS){const e=mh.useSyncExternalStore(r.subscribe,mh.useCallback(()=>t(r.getState()),[r,t]),mh.useCallback(()=>t(r.getInitialState()),[r,t]));return mh.useDebugValue(e),e}const C0=r=>{const t=YS(r),e=i=>WS(t,i);return Object.assign(e,t),e},ZS=(r=>r?C0(r):C0);function JS(r,t){let e;try{e=r()}catch{return}return{getItem:a=>{var l;const c=d=>d===null?null:JSON.parse(d,void 0),u=(l=e.getItem(a))!=null?l:null;return u instanceof Promise?u.then(c):c(u)},setItem:(a,l)=>e.setItem(a,JSON.stringify(l,void 0)),removeItem:a=>e.removeItem(a)}}const qp=r=>t=>{try{const e=r(t);return e instanceof Promise?e:{then(i){return qp(i)(e)},catch(i){return this}}}catch(e){return{then(i){return this},catch(i){return qp(i)(e)}}}},tE=(r,t)=>(e,i,a)=>{let l={storage:JS(()=>window.localStorage),partialize:C=>C,version:0,merge:(C,M)=>({...M,...C}),...t},c=!1,u=0;const d=new Set,f=new Set;let p=l.storage;if(!p)return r((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),e(...C)},i,a);const y=()=>{const C=l.partialize({...i()});return p.setItem(l.name,{state:C,version:l.version})},w=a.setState;a.setState=(C,M)=>(w(C,M),y());const A=r((...C)=>(e(...C),y()),i,a);a.getInitialState=()=>A;let _;const S=()=>{var C,M;if(!p)return;const N=++u;c=!1,d.forEach(j=>{var F;return j((F=i())!=null?F:A)});const k=((M=l.onRehydrateStorage)==null?void 0:M.call(l,(C=i())!=null?C:A))||void 0;return qp(p.getItem.bind(p))(l.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==l.version){if(l.migrate){const F=l.migrate(j.state,j.version);return F instanceof Promise?F.then(z=>[!0,z]):[!0,F]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var F;if(N!==u)return;const[z,H]=j;if(_=l.merge(H,(F=i())!=null?F:A),e(_,!0),z)return y()}).then(()=>{N===u&&(k?.(_,void 0),_=i(),c=!0,f.forEach(j=>j(_)))}).catch(j=>{N===u&&k?.(void 0,j)})};return a.persist={setOptions:C=>{l={...l,...C},C.storage&&(p=C.storage)},clearStorage:()=>{p?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>S(),hasHydrated:()=>c,onHydrate:C=>(d.add(C),()=>{d.delete(C)}),onFinishHydration:C=>(f.add(C),()=>{f.delete(C)})},l.skipHydration||S(),_||A},eE=tE,sr=ZS(eE(r=>({token:null,setToken:t=>r({token:t}),logout:()=>r({token:null})}),{name:"wisemark-auth",partialize:r=>({token:r.token})}));function Jv(r,t){return function(){return r.apply(t,arguments)}}const{toString:nE}=Object.prototype,{getPrototypeOf:Cm}=Object,{iterator:td,toStringTag:tw}=Symbol,ed=(r=>t=>{const e=nE.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),es=r=>(r=r.toLowerCase(),t=>ed(t)===r),nd=r=>t=>typeof t===r,{isArray:yl}=Array,ul=nd("undefined");function Gc(r){return r!==null&&!ul(r)&&r.constructor!==null&&!ul(r.constructor)&&hi(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const ew=es("ArrayBuffer");function iE(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&ew(r.buffer),t}const sE=nd("string"),hi=nd("function"),nw=nd("number"),Vc=r=>r!==null&&typeof r=="object",aE=r=>r===!0||r===!1,kh=r=>{if(ed(r)!=="object")return!1;const t=Cm(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(tw in r)&&!(td in r)},rE=r=>{if(!Vc(r)||Gc(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},oE=es("Date"),lE=es("File"),cE=es("Blob"),uE=es("FileList"),hE=r=>Vc(r)&&hi(r.pipe),dE=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||hi(r.append)&&((t=ed(r))==="formdata"||t==="object"&&hi(r.toString)&&r.toString()==="[object FormData]"))},fE=es("URLSearchParams"),[pE,mE,gE,yE]=["ReadableStream","Request","Response","Headers"].map(es),bE=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function $c(r,t,{allOwnKeys:e=!1}={}){if(r===null||typeof r>"u")return;let i,a;if(typeof r!="object"&&(r=[r]),yl(r))for(i=0,a=r.length;i<a;i++)t.call(null,r[i],i,r);else{if(Gc(r))return;const l=e?Object.getOwnPropertyNames(r):Object.keys(r),c=l.length;let u;for(i=0;i<c;i++)u=l[i],t.call(null,r[u],u,r)}}function iw(r,t){if(Gc(r))return null;t=t.toLowerCase();const e=Object.keys(r);let i=e.length,a;for(;i-- >0;)if(a=e[i],t===a.toLowerCase())return a;return null}const Hr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,sw=r=>!ul(r)&&r!==Hr;function Gp(){const{caseless:r,skipUndefined:t}=sw(this)&&this||{},e={},i=(a,l)=>{if(l==="__proto__"||l==="constructor"||l==="prototype")return;const c=r&&iw(e,l)||l;kh(e[c])&&kh(a)?e[c]=Gp(e[c],a):kh(a)?e[c]=Gp({},a):yl(a)?e[c]=a.slice():(!t||!ul(a))&&(e[c]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&$c(arguments[a],i);return e}const vE=(r,t,e,{allOwnKeys:i}={})=>($c(t,(a,l)=>{e&&hi(a)?Object.defineProperty(r,l,{value:Jv(a,e),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(r,l,{value:a,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:i}),r),wE=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),xE=(r,t,e,i)=>{r.prototype=Object.create(t.prototype,i),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},AE=(r,t,e,i)=>{let a,l,c;const u={};if(t=t||{},r==null)return t;do{for(a=Object.getOwnPropertyNames(r),l=a.length;l-- >0;)c=a[l],(!i||i(c,r,t))&&!u[c]&&(t[c]=r[c],u[c]=!0);r=e!==!1&&Cm(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},SE=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const i=r.indexOf(t,e);return i!==-1&&i===e},EE=r=>{if(!r)return null;if(yl(r))return r;let t=r.length;if(!nw(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},_E=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Cm(Uint8Array)),CE=(r,t)=>{const i=(r&&r[td]).call(r);let a;for(;(a=i.next())&&!a.done;){const l=a.value;t.call(r,l[0],l[1])}},TE=(r,t)=>{let e;const i=[];for(;(e=r.exec(t))!==null;)i.push(e);return i},RE=es("HTMLFormElement"),ME=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,i,a){return i.toUpperCase()+a}),T0=(({hasOwnProperty:r})=>(t,e)=>r.call(t,e))(Object.prototype),DE=es("RegExp"),aw=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),i={};$c(e,(a,l)=>{let c;(c=t(a,l,r))!==!1&&(i[l]=c||a)}),Object.defineProperties(r,i)},OE=r=>{aw(r,(t,e)=>{if(hi(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const i=r[e];if(hi(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},NE=(r,t)=>{const e={},i=a=>{a.forEach(l=>{e[l]=!0})};return yl(r)?i(r):i(String(r).split(t)),e},kE=()=>{},LE=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t;function PE(r){return!!(r&&hi(r.append)&&r[tw]==="FormData"&&r[td])}const BE=r=>{const t=new Array(10),e=(i,a)=>{if(Vc(i)){if(t.indexOf(i)>=0)return;if(Gc(i))return i;if(!("toJSON"in i)){t[a]=i;const l=yl(i)?[]:{};return $c(i,(c,u)=>{const d=e(c,a+1);!ul(d)&&(l[u]=d)}),t[a]=void 0,l}}return i};return e(r,0)},jE=es("AsyncFunction"),FE=r=>r&&(Vc(r)||hi(r))&&hi(r.then)&&hi(r.catch),rw=((r,t)=>r?setImmediate:t?((e,i)=>(Hr.addEventListener("message",({source:a,data:l})=>{a===Hr&&l===e&&i.length&&i.shift()()},!1),a=>{i.push(a),Hr.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",hi(Hr.postMessage)),IE=typeof queueMicrotask<"u"?queueMicrotask.bind(Hr):typeof process<"u"&&process.nextTick||rw,UE=r=>r!=null&&hi(r[td]),ht={isArray:yl,isArrayBuffer:ew,isBuffer:Gc,isFormData:dE,isArrayBufferView:iE,isString:sE,isNumber:nw,isBoolean:aE,isObject:Vc,isPlainObject:kh,isEmptyObject:rE,isReadableStream:pE,isRequest:mE,isResponse:gE,isHeaders:yE,isUndefined:ul,isDate:oE,isFile:lE,isBlob:cE,isRegExp:DE,isFunction:hi,isStream:hE,isURLSearchParams:fE,isTypedArray:_E,isFileList:uE,forEach:$c,merge:Gp,extend:vE,trim:bE,stripBOM:wE,inherits:xE,toFlatObject:AE,kindOf:ed,kindOfTest:es,endsWith:SE,toArray:EE,forEachEntry:CE,matchAll:TE,isHTMLForm:RE,hasOwnProperty:T0,hasOwnProp:T0,reduceDescriptors:aw,freezeMethods:OE,toObjectSet:NE,toCamelCase:ME,noop:kE,toFiniteNumber:LE,findKey:iw,global:Hr,isContextDefined:sw,isSpecCompliantForm:PE,toJSONObject:BE,isAsyncFn:jE,isThenable:FE,setImmediate:rw,asap:IE,isIterable:UE};let te=class ow extends Error{static from(t,e,i,a,l,c){const u=new ow(t.message,e||t.code,i,a,l);return u.cause=t,u.name=t.name,c&&Object.assign(u,c),u}constructor(t,e,i,a,l){super(t),this.name="AxiosError",this.isAxiosError=!0,e&&(this.code=e),i&&(this.config=i),a&&(this.request=a),l&&(this.response=l,this.status=l.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ht.toJSONObject(this.config),code:this.code,status:this.status}}};te.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";te.ERR_BAD_OPTION="ERR_BAD_OPTION";te.ECONNABORTED="ECONNABORTED";te.ETIMEDOUT="ETIMEDOUT";te.ERR_NETWORK="ERR_NETWORK";te.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";te.ERR_DEPRECATED="ERR_DEPRECATED";te.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";te.ERR_BAD_REQUEST="ERR_BAD_REQUEST";te.ERR_CANCELED="ERR_CANCELED";te.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";te.ERR_INVALID_URL="ERR_INVALID_URL";const zE=null;function Vp(r){return ht.isPlainObject(r)||ht.isArray(r)}function lw(r){return ht.endsWith(r,"[]")?r.slice(0,-2):r}function R0(r,t,e){return r?r.concat(t).map(function(a,l){return a=lw(a),!e&&l?"["+a+"]":a}).join(e?".":""):t}function HE(r){return ht.isArray(r)&&!r.some(Vp)}const qE=ht.toFlatObject(ht,{},null,function(t){return/^is[A-Z]/.test(t)});function id(r,t,e){if(!ht.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=ht.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,C){return!ht.isUndefined(C[S])});const i=e.metaTokens,a=e.visitor||p,l=e.dots,c=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&ht.isSpecCompliantForm(t);if(!ht.isFunction(a))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(ht.isDate(_))return _.toISOString();if(ht.isBoolean(_))return _.toString();if(!d&&ht.isBlob(_))throw new te("Blob is not supported. Use a Buffer instead.");return ht.isArrayBuffer(_)||ht.isTypedArray(_)?d&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function p(_,S,C){let M=_;if(_&&!C&&typeof _=="object"){if(ht.endsWith(S,"{}"))S=i?S:S.slice(0,-2),_=JSON.stringify(_);else if(ht.isArray(_)&&HE(_)||(ht.isFileList(_)||ht.endsWith(S,"[]"))&&(M=ht.toArray(_)))return S=lw(S),M.forEach(function(k,j){!(ht.isUndefined(k)||k===null)&&t.append(c===!0?R0([S],j,l):c===null?S:S+"[]",f(k))}),!1}return Vp(_)?!0:(t.append(R0(C,S,l),f(_)),!1)}const y=[],w=Object.assign(qE,{defaultVisitor:p,convertValue:f,isVisitable:Vp});function A(_,S){if(!ht.isUndefined(_)){if(y.indexOf(_)!==-1)throw Error("Circular reference detected in "+S.join("."));y.push(_),ht.forEach(_,function(M,N){(!(ht.isUndefined(M)||M===null)&&a.call(t,M,ht.isString(N)?N.trim():N,S,w))===!0&&A(M,S?S.concat(N):[N])}),y.pop()}}if(!ht.isObject(r))throw new TypeError("data must be an object");return A(r),t}function M0(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Tm(r,t){this._pairs=[],r&&id(r,this,t)}const cw=Tm.prototype;cw.append=function(t,e){this._pairs.push([t,e])};cw.toString=function(t){const e=t?function(i){return t.call(this,i,M0)}:M0;return this._pairs.map(function(a){return e(a[0])+"="+e(a[1])},"").join("&")};function GE(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function uw(r,t,e){if(!t)return r;const i=e&&e.encode||GE,a=ht.isFunction(e)?{serialize:e}:e,l=a&&a.serialize;let c;if(l?c=l(t,a):c=ht.isURLSearchParams(t)?t.toString():new Tm(t,a).toString(i),c){const u=r.indexOf("#");u!==-1&&(r=r.slice(0,u)),r+=(r.indexOf("?")===-1?"?":"&")+c}return r}class D0{constructor(){this.handlers=[]}use(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ht.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Rm={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},VE=typeof URLSearchParams<"u"?URLSearchParams:Tm,$E=typeof FormData<"u"?FormData:null,KE=typeof Blob<"u"?Blob:null,XE={isBrowser:!0,classes:{URLSearchParams:VE,FormData:$E,Blob:KE},protocols:["http","https","file","blob","url","data"]},Mm=typeof window<"u"&&typeof document<"u",$p=typeof navigator=="object"&&navigator||void 0,YE=Mm&&(!$p||["ReactNative","NativeScript","NS"].indexOf($p.product)<0),QE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",WE=Mm&&window.location.href||"http://localhost",ZE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Mm,hasStandardBrowserEnv:YE,hasStandardBrowserWebWorkerEnv:QE,navigator:$p,origin:WE},Symbol.toStringTag,{value:"Module"})),Kn={...ZE,...XE};function JE(r,t){return id(r,new Kn.classes.URLSearchParams,{visitor:function(e,i,a,l){return Kn.isNode&&ht.isBuffer(e)?(this.append(i,e.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function t_(r){return ht.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function e_(r){const t={},e=Object.keys(r);let i;const a=e.length;let l;for(i=0;i<a;i++)l=e[i],t[l]=r[l];return t}function hw(r){function t(e,i,a,l){let c=e[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=l>=e.length;return c=!c&&ht.isArray(a)?a.length:c,d?(ht.hasOwnProp(a,c)?a[c]=[a[c],i]:a[c]=i,!u):((!a[c]||!ht.isObject(a[c]))&&(a[c]=[]),t(e,i,a[c],l)&&ht.isArray(a[c])&&(a[c]=e_(a[c])),!u)}if(ht.isFormData(r)&&ht.isFunction(r.entries)){const e={};return ht.forEachEntry(r,(i,a)=>{t(t_(i),a,e,0)}),e}return null}function n_(r,t,e){if(ht.isString(r))try{return(t||JSON.parse)(r),ht.trim(r)}catch(i){if(i.name!=="SyntaxError")throw i}return(e||JSON.stringify)(r)}const Kc={transitional:Rm,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const i=e.getContentType()||"",a=i.indexOf("application/json")>-1,l=ht.isObject(t);if(l&&ht.isHTMLForm(t)&&(t=new FormData(t)),ht.isFormData(t))return a?JSON.stringify(hw(t)):t;if(ht.isArrayBuffer(t)||ht.isBuffer(t)||ht.isStream(t)||ht.isFile(t)||ht.isBlob(t)||ht.isReadableStream(t))return t;if(ht.isArrayBufferView(t))return t.buffer;if(ht.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(i.indexOf("application/x-www-form-urlencoded")>-1)return JE(t,this.formSerializer).toString();if((u=ht.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return id(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return l||a?(e.setContentType("application/json",!1),n_(t)):t}],transformResponse:[function(t){const e=this.transitional||Kc.transitional,i=e&&e.forcedJSONParsing,a=this.responseType==="json";if(ht.isResponse(t)||ht.isReadableStream(t))return t;if(t&&ht.isString(t)&&(i&&!this.responseType||a)){const c=!(e&&e.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?te.from(u,te.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Kn.classes.FormData,Blob:Kn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ht.forEach(["delete","get","head","post","put","patch"],r=>{Kc.headers[r]={}});const i_=ht.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),s_=r=>{const t={};let e,i,a;return r&&r.split(`
`).forEach(function(c){a=c.indexOf(":"),e=c.substring(0,a).trim().toLowerCase(),i=c.substring(a+1).trim(),!(!e||t[e]&&i_[e])&&(e==="set-cookie"?t[e]?t[e].push(i):t[e]=[i]:t[e]=t[e]?t[e]+", "+i:i)}),t},O0=Symbol("internals");function Ac(r){return r&&String(r).trim().toLowerCase()}function Lh(r){return r===!1||r==null?r:ht.isArray(r)?r.map(Lh):String(r)}function a_(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=e.exec(r);)t[i[1]]=i[2];return t}const r_=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Ap(r,t,e,i,a){if(ht.isFunction(i))return i.call(this,t,e);if(a&&(t=e),!!ht.isString(t)){if(ht.isString(i))return t.indexOf(i)!==-1;if(ht.isRegExp(i))return i.test(t)}}function o_(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,i)=>e.toUpperCase()+i)}function l_(r,t){const e=ht.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(r,i+e,{value:function(a,l,c){return this[i].call(this,t,a,l,c)},configurable:!0})})}let di=class{constructor(t){t&&this.set(t)}set(t,e,i){const a=this;function l(u,d,f){const p=Ac(d);if(!p)throw new Error("header name must be a non-empty string");const y=ht.findKey(a,p);(!y||a[y]===void 0||f===!0||f===void 0&&a[y]!==!1)&&(a[y||d]=Lh(u))}const c=(u,d)=>ht.forEach(u,(f,p)=>l(f,p,d));if(ht.isPlainObject(t)||t instanceof this.constructor)c(t,e);else if(ht.isString(t)&&(t=t.trim())&&!r_(t))c(s_(t),e);else if(ht.isObject(t)&&ht.isIterable(t)){let u={},d,f;for(const p of t){if(!ht.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?ht.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}c(u,e)}else t!=null&&l(e,t,i);return this}get(t,e){if(t=Ac(t),t){const i=ht.findKey(this,t);if(i){const a=this[i];if(!e)return a;if(e===!0)return a_(a);if(ht.isFunction(e))return e.call(this,a,i);if(ht.isRegExp(e))return e.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Ac(t),t){const i=ht.findKey(this,t);return!!(i&&this[i]!==void 0&&(!e||Ap(this,this[i],i,e)))}return!1}delete(t,e){const i=this;let a=!1;function l(c){if(c=Ac(c),c){const u=ht.findKey(i,c);u&&(!e||Ap(i,i[u],u,e))&&(delete i[u],a=!0)}}return ht.isArray(t)?t.forEach(l):l(t),a}clear(t){const e=Object.keys(this);let i=e.length,a=!1;for(;i--;){const l=e[i];(!t||Ap(this,this[l],l,t,!0))&&(delete this[l],a=!0)}return a}normalize(t){const e=this,i={};return ht.forEach(this,(a,l)=>{const c=ht.findKey(i,l);if(c){e[c]=Lh(a),delete e[l];return}const u=t?o_(l):String(l).trim();u!==l&&delete e[l],e[u]=Lh(a),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return ht.forEach(this,(i,a)=>{i!=null&&i!==!1&&(e[a]=t&&ht.isArray(i)?i.join(", "):i)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const i=new this(t);return e.forEach(a=>i.set(a)),i}static accessor(t){const i=(this[O0]=this[O0]={accessors:{}}).accessors,a=this.prototype;function l(c){const u=Ac(c);i[u]||(l_(a,c),i[u]=!0)}return ht.isArray(t)?t.forEach(l):l(t),this}};di.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ht.reduceDescriptors(di.prototype,({value:r},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(i){this[e]=i}}});ht.freezeMethods(di);function Sp(r,t){const e=this||Kc,i=t||e,a=di.from(i.headers);let l=i.data;return ht.forEach(r,function(u){l=u.call(e,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function dw(r){return!!(r&&r.__CANCEL__)}let Xc=class extends te{constructor(t,e,i){super(t??"canceled",te.ERR_CANCELED,e,i),this.name="CanceledError",this.__CANCEL__=!0}};function fw(r,t,e){const i=e.config.validateStatus;!e.status||!i||i(e.status)?r(e):t(new te("Request failed with status code "+e.status,[te.ERR_BAD_REQUEST,te.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function c_(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function u_(r,t){r=r||10;const e=new Array(r),i=new Array(r);let a=0,l=0,c;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=i[l];c||(c=f),e[a]=d,i[a]=f;let y=l,w=0;for(;y!==a;)w+=e[y++],y=y%r;if(a=(a+1)%r,a===l&&(l=(l+1)%r),f-c<t)return;const A=p&&f-p;return A?Math.round(w*1e3/A):void 0}}function h_(r,t){let e=0,i=1e3/t,a,l;const c=(f,p=Date.now())=>{e=p,a=null,l&&(clearTimeout(l),l=null),r(...f)};return[(...f)=>{const p=Date.now(),y=p-e;y>=i?c(f,p):(a=f,l||(l=setTimeout(()=>{l=null,c(a)},i-y)))},()=>a&&c(a)]}const Gh=(r,t,e=3)=>{let i=0;const a=u_(50,250);return h_(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,d=c-i,f=a(d),p=c<=u;i=c;const y={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-c)/f:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};r(y)},e)},N0=(r,t)=>{const e=r!=null;return[i=>t[0]({lengthComputable:e,total:r,loaded:i}),t[1]]},k0=r=>(...t)=>ht.asap(()=>r(...t)),d_=Kn.hasStandardBrowserEnv?((r,t)=>e=>(e=new URL(e,Kn.origin),r.protocol===e.protocol&&r.host===e.host&&(t||r.port===e.port)))(new URL(Kn.origin),Kn.navigator&&/(msie|trident)/i.test(Kn.navigator.userAgent)):()=>!0,f_=Kn.hasStandardBrowserEnv?{write(r,t,e,i,a,l,c){if(typeof document>"u")return;const u=[`${r}=${encodeURIComponent(t)}`];ht.isNumber(e)&&u.push(`expires=${new Date(e).toUTCString()}`),ht.isString(i)&&u.push(`path=${i}`),ht.isString(a)&&u.push(`domain=${a}`),l===!0&&u.push("secure"),ht.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(r){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+r+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(r){this.write(r,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function p_(r){return typeof r!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function m_(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function pw(r,t,e){let i=!p_(t);return r&&(i||e==!1)?m_(r,t):t}const L0=r=>r instanceof di?{...r}:r;function Qr(r,t){t=t||{};const e={};function i(f,p,y,w){return ht.isPlainObject(f)&&ht.isPlainObject(p)?ht.merge.call({caseless:w},f,p):ht.isPlainObject(p)?ht.merge({},p):ht.isArray(p)?p.slice():p}function a(f,p,y,w){if(ht.isUndefined(p)){if(!ht.isUndefined(f))return i(void 0,f,y,w)}else return i(f,p,y,w)}function l(f,p){if(!ht.isUndefined(p))return i(void 0,p)}function c(f,p){if(ht.isUndefined(p)){if(!ht.isUndefined(f))return i(void 0,f)}else return i(void 0,p)}function u(f,p,y){if(y in t)return i(f,p);if(y in r)return i(void 0,f)}const d={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(f,p,y)=>a(L0(f),L0(p),y,!0)};return ht.forEach(Object.keys({...r,...t}),function(p){if(p==="__proto__"||p==="constructor"||p==="prototype")return;const y=ht.hasOwnProp(d,p)?d[p]:a,w=y(r[p],t[p],p);ht.isUndefined(w)&&y!==u||(e[p]=w)}),e}const mw=r=>{const t=Qr({},r);let{data:e,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:l,headers:c,auth:u}=t;if(t.headers=c=di.from(c),t.url=uw(pw(t.baseURL,t.url,t.allowAbsoluteUrls),r.params,r.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),ht.isFormData(e)){if(Kn.hasStandardBrowserEnv||Kn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(ht.isFunction(e.getHeaders)){const d=e.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,y])=>{f.includes(p.toLowerCase())&&c.set(p,y)})}}if(Kn.hasStandardBrowserEnv&&(i&&ht.isFunction(i)&&(i=i(t)),i||i!==!1&&d_(t.url))){const d=a&&l&&f_.read(l);d&&c.set(a,d)}return t},g_=typeof XMLHttpRequest<"u",y_=g_&&function(r){return new Promise(function(e,i){const a=mw(r);let l=a.data;const c=di.from(a.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=a,p,y,w,A,_;function S(){A&&A(),_&&_(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let C=new XMLHttpRequest;C.open(a.method.toUpperCase(),a.url,!0),C.timeout=a.timeout;function M(){if(!C)return;const k=di.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),F={data:!u||u==="text"||u==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:k,config:r,request:C};fw(function(H){e(H),S()},function(H){i(H),S()},F),C=null}"onloadend"in C?C.onloadend=M:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(M)},C.onabort=function(){C&&(i(new te("Request aborted",te.ECONNABORTED,r,C)),C=null)},C.onerror=function(j){const F=j&&j.message?j.message:"Network Error",z=new te(F,te.ERR_NETWORK,r,C);z.event=j||null,i(z),C=null},C.ontimeout=function(){let j=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const F=a.transitional||Rm;a.timeoutErrorMessage&&(j=a.timeoutErrorMessage),i(new te(j,F.clarifyTimeoutError?te.ETIMEDOUT:te.ECONNABORTED,r,C)),C=null},l===void 0&&c.setContentType(null),"setRequestHeader"in C&&ht.forEach(c.toJSON(),function(j,F){C.setRequestHeader(F,j)}),ht.isUndefined(a.withCredentials)||(C.withCredentials=!!a.withCredentials),u&&u!=="json"&&(C.responseType=a.responseType),f&&([w,_]=Gh(f,!0),C.addEventListener("progress",w)),d&&C.upload&&([y,A]=Gh(d),C.upload.addEventListener("progress",y),C.upload.addEventListener("loadend",A)),(a.cancelToken||a.signal)&&(p=k=>{C&&(i(!k||k.type?new Xc(null,r,C):k),C.abort(),C=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const N=c_(a.url);if(N&&Kn.protocols.indexOf(N)===-1){i(new te("Unsupported protocol "+N+":",te.ERR_BAD_REQUEST,r));return}C.send(l||null)})},b_=(r,t)=>{const{length:e}=r=r?r.filter(Boolean):[];if(t||e){let i=new AbortController,a;const l=function(f){if(!a){a=!0,u();const p=f instanceof Error?f:this.reason;i.abort(p instanceof te?p:new Xc(p instanceof Error?p.message:p))}};let c=t&&setTimeout(()=>{c=null,l(new te(`timeout of ${t}ms exceeded`,te.ETIMEDOUT))},t);const u=()=>{r&&(c&&clearTimeout(c),c=null,r.forEach(f=>{f.unsubscribe?f.unsubscribe(l):f.removeEventListener("abort",l)}),r=null)};r.forEach(f=>f.addEventListener("abort",l));const{signal:d}=i;return d.unsubscribe=()=>ht.asap(u),d}},v_=function*(r,t){let e=r.byteLength;if(e<t){yield r;return}let i=0,a;for(;i<e;)a=i+t,yield r.slice(i,a),i=a},w_=async function*(r,t){for await(const e of x_(r))yield*v_(e,t)},x_=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:e,value:i}=await t.read();if(e)break;yield i}}finally{await t.cancel()}},P0=(r,t,e,i)=>{const a=w_(r,t);let l=0,c,u=d=>{c||(c=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await a.next();if(f){u(),d.close();return}let y=p.byteLength;if(e){let w=l+=y;e(w)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),a.return()}},{highWaterMark:2})},B0=64*1024,{isFunction:bh}=ht,A_=(({Request:r,Response:t})=>({Request:r,Response:t}))(ht.global),{ReadableStream:j0,TextEncoder:F0}=ht.global,I0=(r,...t)=>{try{return!!r(...t)}catch{return!1}},S_=r=>{r=ht.merge.call({skipUndefined:!0},A_,r);const{fetch:t,Request:e,Response:i}=r,a=t?bh(t):typeof fetch=="function",l=bh(e),c=bh(i);if(!a)return!1;const u=a&&bh(j0),d=a&&(typeof F0=="function"?(_=>S=>_.encode(S))(new F0):async _=>new Uint8Array(await new e(_).arrayBuffer())),f=l&&u&&I0(()=>{let _=!1;const S=new e(Kn.origin,{body:new j0,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!S}),p=c&&u&&I0(()=>ht.isReadableStream(new i("").body)),y={stream:p&&(_=>_.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(_=>{!y[_]&&(y[_]=(S,C)=>{let M=S&&S[_];if(M)return M.call(S);throw new te(`Response type '${_}' is not supported`,te.ERR_NOT_SUPPORT,C)})});const w=async _=>{if(_==null)return 0;if(ht.isBlob(_))return _.size;if(ht.isSpecCompliantForm(_))return(await new e(Kn.origin,{method:"POST",body:_}).arrayBuffer()).byteLength;if(ht.isArrayBufferView(_)||ht.isArrayBuffer(_))return _.byteLength;if(ht.isURLSearchParams(_)&&(_=_+""),ht.isString(_))return(await d(_)).byteLength},A=async(_,S)=>{const C=ht.toFiniteNumber(_.getContentLength());return C??w(S)};return async _=>{let{url:S,method:C,data:M,signal:N,cancelToken:k,timeout:j,onDownloadProgress:F,onUploadProgress:z,responseType:H,headers:ut,withCredentials:ft="same-origin",fetchOptions:_t}=mw(_),ct=t||fetch;H=H?(H+"").toLowerCase():"text";let Rt=b_([N,k&&k.toAbortSignal()],j),Lt=null;const Bt=Rt&&Rt.unsubscribe&&(()=>{Rt.unsubscribe()});let $t;try{if(z&&f&&C!=="get"&&C!=="head"&&($t=await A(ut,M))!==0){let U=new e(S,{method:"POST",body:M,duplex:"half"}),J;if(ht.isFormData(M)&&(J=U.headers.get("content-type"))&&ut.setContentType(J),U.body){const[mt,xt]=N0($t,Gh(k0(z)));M=P0(U.body,B0,mt,xt)}}ht.isString(ft)||(ft=ft?"include":"omit");const G=l&&"credentials"in e.prototype,st={..._t,signal:Rt,method:C.toUpperCase(),headers:ut.normalize().toJSON(),body:M,duplex:"half",credentials:G?ft:void 0};Lt=l&&new e(S,st);let wt=await(l?ct(Lt,_t):ct(S,st));const Xt=p&&(H==="stream"||H==="response");if(p&&(F||Xt&&Bt)){const U={};["status","statusText","headers"].forEach(It=>{U[It]=wt[It]});const J=ht.toFiniteNumber(wt.headers.get("content-length")),[mt,xt]=F&&N0(J,Gh(k0(F),!0))||[];wt=new i(P0(wt.body,B0,mt,()=>{xt&&xt(),Bt&&Bt()}),U)}H=H||"text";let Ct=await y[ht.findKey(y,H)||"text"](wt,_);return!Xt&&Bt&&Bt(),await new Promise((U,J)=>{fw(U,J,{data:Ct,headers:di.from(wt.headers),status:wt.status,statusText:wt.statusText,config:_,request:Lt})})}catch(G){throw Bt&&Bt(),G&&G.name==="TypeError"&&/Load failed|fetch/i.test(G.message)?Object.assign(new te("Network Error",te.ERR_NETWORK,_,Lt,G&&G.response),{cause:G.cause||G}):te.from(G,G&&G.code,_,Lt,G&&G.response)}}},E_=new Map,gw=r=>{let t=r&&r.env||{};const{fetch:e,Request:i,Response:a}=t,l=[i,a,e];let c=l.length,u=c,d,f,p=E_;for(;u--;)d=l[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:S_(t)),p=f;return f};gw();const Dm={http:zE,xhr:y_,fetch:{get:gw}};ht.forEach(Dm,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const U0=r=>`- ${r}`,__=r=>ht.isFunction(r)||r===null||r===!1;function C_(r,t){r=ht.isArray(r)?r:[r];const{length:e}=r;let i,a;const l={};for(let c=0;c<e;c++){i=r[c];let u;if(a=i,!__(i)&&(a=Dm[(u=String(i)).toLowerCase()],a===void 0))throw new te(`Unknown adapter '${u}'`);if(a&&(ht.isFunction(a)||(a=a.get(t))))break;l[u||"#"+c]=a}if(!a){const c=Object.entries(l).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=e?c.length>1?`since :
`+c.map(U0).join(`
`):" "+U0(c[0]):"as no adapter specified";throw new te("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a}const yw={getAdapter:C_,adapters:Dm};function Ep(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Xc(null,r)}function z0(r){return Ep(r),r.headers=di.from(r.headers),r.data=Sp.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),yw.getAdapter(r.adapter||Kc.adapter,r)(r).then(function(i){return Ep(r),i.data=Sp.call(r,r.transformResponse,i),i.headers=di.from(i.headers),i},function(i){return dw(i)||(Ep(r),i&&i.response&&(i.response.data=Sp.call(r,r.transformResponse,i.response),i.response.headers=di.from(i.response.headers))),Promise.reject(i)})}const bw="1.13.5",sd={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{sd[r]=function(i){return typeof i===r||"a"+(t<1?"n ":" ")+r}});const H0={};sd.transitional=function(t,e,i){function a(l,c){return"[Axios v"+bw+"] Transitional option '"+l+"'"+c+(i?". "+i:"")}return(l,c,u)=>{if(t===!1)throw new te(a(c," has been removed"+(e?" in "+e:"")),te.ERR_DEPRECATED);return e&&!H0[c]&&(H0[c]=!0,console.warn(a(c," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(l,c,u):!0}};sd.spelling=function(t){return(e,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function T_(r,t,e){if(typeof r!="object")throw new te("options must be an object",te.ERR_BAD_OPTION_VALUE);const i=Object.keys(r);let a=i.length;for(;a-- >0;){const l=i[a],c=t[l];if(c){const u=r[l],d=u===void 0||c(u,l,r);if(d!==!0)throw new te("option "+l+" must be "+d,te.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new te("Unknown option "+l,te.ERR_BAD_OPTION)}}const Ph={assertOptions:T_,validators:sd},Ii=Ph.validators;let Kr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new D0,response:new D0}}async request(t,e){try{return await this._request(t,e)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?l&&!String(i.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+l):i.stack=l}catch{}}throw i}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Qr(this.defaults,e);const{transitional:i,paramsSerializer:a,headers:l}=e;i!==void 0&&Ph.assertOptions(i,{silentJSONParsing:Ii.transitional(Ii.boolean),forcedJSONParsing:Ii.transitional(Ii.boolean),clarifyTimeoutError:Ii.transitional(Ii.boolean),legacyInterceptorReqResOrdering:Ii.transitional(Ii.boolean)},!1),a!=null&&(ht.isFunction(a)?e.paramsSerializer={serialize:a}:Ph.assertOptions(a,{encode:Ii.function,serialize:Ii.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Ph.assertOptions(e,{baseUrl:Ii.spelling("baseURL"),withXsrfToken:Ii.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let c=l&&ht.merge(l.common,l[e.method]);l&&ht.forEach(["delete","get","head","post","put","patch","common"],_=>{delete l[_]}),e.headers=di.concat(c,l);const u=[];let d=!0;this.interceptors.request.forEach(function(S){if(typeof S.runWhen=="function"&&S.runWhen(e)===!1)return;d=d&&S.synchronous;const C=e.transitional||Rm;C&&C.legacyInterceptorReqResOrdering?u.unshift(S.fulfilled,S.rejected):u.push(S.fulfilled,S.rejected)});const f=[];this.interceptors.response.forEach(function(S){f.push(S.fulfilled,S.rejected)});let p,y=0,w;if(!d){const _=[z0.bind(this),void 0];for(_.unshift(...u),_.push(...f),w=_.length,p=Promise.resolve(e);y<w;)p=p.then(_[y++],_[y++]);return p}w=u.length;let A=e;for(;y<w;){const _=u[y++],S=u[y++];try{A=_(A)}catch(C){S.call(this,C);break}}try{p=z0.call(this,A)}catch(_){return Promise.reject(_)}for(y=0,w=f.length;y<w;)p=p.then(f[y++],f[y++]);return p}getUri(t){t=Qr(this.defaults,t);const e=pw(t.baseURL,t.url,t.allowAbsoluteUrls);return uw(e,t.params,t.paramsSerializer)}};ht.forEach(["delete","get","head","options"],function(t){Kr.prototype[t]=function(e,i){return this.request(Qr(i||{},{method:t,url:e,data:(i||{}).data}))}});ht.forEach(["post","put","patch"],function(t){function e(i){return function(l,c,u){return this.request(Qr(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Kr.prototype[t]=e(),Kr.prototype[t+"Form"]=e(!0)});let R_=class vw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(l){e=l});const i=this;this.promise.then(a=>{if(!i._listeners)return;let l=i._listeners.length;for(;l-- >0;)i._listeners[l](a);i._listeners=null}),this.promise.then=a=>{let l;const c=new Promise(u=>{i.subscribe(u),l=u}).then(a);return c.cancel=function(){i.unsubscribe(l)},c},t(function(l,c,u){i.reason||(i.reason=new Xc(l,c,u),e(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=i=>{t.abort(i)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new vw(function(a){t=a}),cancel:t}}};function M_(r){return function(e){return r.apply(null,e)}}function D_(r){return ht.isObject(r)&&r.isAxiosError===!0}const Kp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Kp).forEach(([r,t])=>{Kp[t]=r});function ww(r){const t=new Kr(r),e=Jv(Kr.prototype.request,t);return ht.extend(e,Kr.prototype,t,{allOwnKeys:!0}),ht.extend(e,t,null,{allOwnKeys:!0}),e.create=function(a){return ww(Qr(r,a))},e}const cn=ww(Kc);cn.Axios=Kr;cn.CanceledError=Xc;cn.CancelToken=R_;cn.isCancel=dw;cn.VERSION=bw;cn.toFormData=id;cn.AxiosError=te;cn.Cancel=cn.CanceledError;cn.all=function(t){return Promise.all(t)};cn.spread=M_;cn.isAxiosError=D_;cn.mergeConfig=Qr;cn.AxiosHeaders=di;cn.formToJSON=r=>hw(ht.isHTMLForm(r)?new FormData(r):r);cn.getAdapter=yw.getAdapter;cn.HttpStatusCode=Kp;cn.default=cn;const{Axios:G2,AxiosError:V2,CanceledError:$2,isCancel:K2,CancelToken:X2,VERSION:Y2,all:Q2,Cancel:W2,isAxiosError:Z2,spread:J2,toFormData:tR,AxiosHeaders:eR,HttpStatusCode:nR,formToJSON:iR,getAdapter:sR,mergeConfig:aR}=cn,Ye=cn.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});Ye.interceptors.request.use(r=>{const t=sr.getState().token;return t&&(r.headers.Authorization=`Token ${t}`),r.data instanceof FormData&&delete r.headers["Content-Type"],r});Ye.interceptors.response.use(r=>r,r=>(r.response?.status===401&&sr.getState().logout(),Promise.reject(r)));const Bc={login:(r,t)=>Ye.post("/auth/login/",{email:r,password:t}),register:r=>Ye.post("/auth/register/",r),logout:()=>Ye.post("/auth/logout/"),me:()=>Ye.get("/auth/me/"),deleteAccount:()=>Ye.post("/auth/me/delete/")},Vh={list:()=>Ye.get("/projects/"),get:r=>Ye.get(`/projects/${r}/`),create:r=>Ye.post("/projects/",r),update:(r,t)=>Ye.patch(`/projects/${r}/`,t),delete:r=>Ye.delete(`/projects/${r}/`)},$n={list:r=>Ye.get("/documents/",{params:r}),get:r=>Ye.get(`/documents/${r}/`),create:r=>Ye.post("/documents/",r),createWithFile:r=>Ye.post("/documents/",r),getPdf:r=>Ye.get(`/documents/${r}/pdf/`,{responseType:"arraybuffer"}),uploadPdf:(r,t)=>Ye.post(`/documents/${r}/upload_pdf/`,t),update:(r,t)=>Ye.patch(`/documents/${r}/`,t),delete:r=>Ye.delete(`/documents/${r}/`),highlights:r=>Ye.get(`/documents/${r}/highlights/`),createHighlight:(r,t)=>Ye.post(`/documents/${r}/highlights/`,t),updateHighlight:(r,t,e)=>Ye.patch(`/documents/${r}/highlights/${t}/`,e),deleteHighlight:(r,t)=>Ye.delete(`/documents/${r}/highlights/${t}/`)},O_={page:"bg-slate-50",surface:"bg-white",muted:"bg-slate-100"},Zt={body:"text-slate-800",heading:"text-slate-900",secondary:"text-slate-600",muted:"text-slate-500"},Zi={default:"border-slate-200"},ua="min-h-screen p-6",xw="bg-white border-b border-slate-200",da="bg-slate-800 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-slate-700 cursor-pointer",tl="p-2 rounded-lg text-slate-600 hover:bg-slate-100 cursor-pointer",q0="w-px h-6 bg-slate-200",_i=O_;function N_(){const r=fa(),t=sr(y=>y.setToken),[e,i]=I.useState(""),[a,l]=I.useState(""),[c,u]=I.useState(""),[d,f]=I.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{const{data:w}=await Bc.login(e,a);t(w.token),r("/",{replace:!0})}catch(w){u(w.response?.data?.detail||w.response?.data?.email?.[0]||"Login failed")}finally{f(!1)}};return D.jsx("div",{className:`${ua} ${_i.page} flex items-center justify-center`,children:D.jsxs("div",{className:"w-full max-w-sm",children:[D.jsx("h1",{className:`text-2xl font-semibold ${Zt.heading} mb-6`,children:"Sign in"}),D.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&D.jsx("p",{className:"text-sm text-red-600",children:c}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Zt.secondary}`,children:"Email"}),D.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Zt.secondary}`,children:"Password"}),D.jsx("input",{type:"password",value:a,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"current-password"})]}),D.jsx("button",{type:"submit",disabled:d,className:da,children:d?"Signing in...":"Sign in"})]}),D.jsxs("p",{className:`mt-4 text-sm ${Zt.muted}`,children:["No account? ",D.jsx(Jh,{to:"/register",className:"text-slate-700 underline",children:"Register"})]})]})})}function k_(){const r=fa(),t=sr(y=>y.setToken),[e,i]=I.useState(""),[a,l]=I.useState(""),[c,u]=I.useState(""),[d,f]=I.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{await Bc.register({email:e,password:a});const{data:w}=await Bc.login(e,a);t(w.token),r("/",{replace:!0})}catch(w){const A=w.response?.data;u(A?.email?.[0]||A?.password?.[0]||"Registration failed")}finally{f(!1)}};return D.jsx("div",{className:`${ua} ${_i.page} flex items-center justify-center`,children:D.jsxs("div",{className:"w-full max-w-sm",children:[D.jsx("h1",{className:`text-2xl font-semibold ${Zt.heading} mb-6`,children:"Create account"}),D.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&D.jsx("p",{className:"text-sm text-red-600",children:c}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Zt.secondary}`,children:"Email"}),D.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),D.jsxs("label",{className:"flex flex-col gap-1",children:[D.jsx("span",{className:`text-sm ${Zt.secondary}`,children:"Password"}),D.jsx("input",{type:"password",value:a,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"new-password"})]}),D.jsx("button",{type:"submit",disabled:d,className:da,children:d?"Creating account...":"Register"})]}),D.jsxs("p",{className:`mt-4 text-sm ${Zt.muted}`,children:["Already have an account? ",D.jsx(Jh,{to:"/login",className:"text-slate-700 underline",children:"Sign in"})]})]})})}const Aw=(...r)=>r.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();const L_=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const P_=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase());const G0=r=>{const t=P_(r);return t.charAt(0).toUpperCase()+t.slice(1)};var B_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const j_=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const F_=I.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:c,...u},d)=>I.createElement("svg",{ref:d,...B_,width:t,height:t,stroke:r,strokeWidth:i?Number(e)*24/Number(t):e,className:Aw("lucide",a),...!l&&!j_(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>I.createElement(f,p)),...Array.isArray(l)?l:[l]]));const xn=(r,t)=>{const e=I.forwardRef(({className:i,...a},l)=>I.createElement(F_,{ref:l,iconNode:t,className:Aw(`lucide-${L_(G0(r))}`,`lucide-${r}`,i),...a}));return e.displayName=G0(r),e};const I_=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],ad=xn("arrow-left",I_);const U_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],V0=xn("check",U_);const z_=[["path",{d:"M11 21a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1",key:"likhh7"}],["path",{d:"M16 16a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1",key:"17ky3x"}],["path",{d:"M21 6a2 2 0 0 0-.586-1.414l-2-2A2 2 0 0 0 17 2h-3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1z",key:"1hyeo0"}]],H_=xn("file-stack",z_);const q_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Sw=xn("file-text",q_);const G_=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],V_=xn("layers",G_);const $_=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],K_=xn("list-ordered",$_);const X_=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Ts=xn("loader-circle",X_);const Y_=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Ew=xn("log-out",Y_);const Q_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],W_=xn("panel-right-close",Q_);const Z_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],J_=xn("panel-right-open",Z_);const tC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Xp=xn("pencil",tC);const eC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],nC=xn("plus",eC);const iC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],sC=xn("search",iC);const aC=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],rC=xn("settings-2",aC);const oC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Om=xn("trash-2",oC);const lC=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Yp=xn("upload",lC);const cC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Qp=xn("x",cC);const uC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],hC=xn("zoom-in",uC);const dC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],fC=xn("zoom-out",dC),sl=["#f59e0b","#3b82f6","#10b981","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316"];function pC(r){if(!r)return"";const t=new Date(r);if(Number.isNaN(t.getTime()))return"";const e=new Date,i=e-t,a=Math.floor(i/6e4),l=Math.floor(i/36e5),c=Math.floor(i/864e5);return a<1?"Just now":a<60?`${a} min ago`:l<24?`${l} hour${l===1?"":"s"} ago`:c===1?"Yesterday":c<7?`${c} days ago`:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:t.getFullYear()!==e.getFullYear()?"numeric":void 0})}function mC({project:r,onOpen:t}){const[e,i]=I.useState(!1),a=r.document_count??0,l=r.annotation_count??0,c=r.color&&sl.includes(r.color)?r.color:sl[r.id%sl.length];return D.jsxs("div",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onClick:()=>t(r.id),role:"button",tabIndex:0,onKeyDown:u=>u.key==="Enter"&&t(r.id),className:"flex items-center gap-4 rounded-xl border border-slate-200 bg-white px-5 py-5 cursor-pointer transition-all duration-200",style:{boxShadow:e?"0 4px 12px rgba(71,85,105,0.08)":"0 1px 3px rgba(0,0,0,0.04)",transform:e?"translateY(-1px)":"none",background:e?"#f8fafc":"#fff"},children:[D.jsx("div",{className:"shrink-0 rounded-sm",style:{width:4,height:48,background:c}}),D.jsxs("div",{className:"flex-1 min-w-0",children:[D.jsx("div",{className:"text-base font-normal text-slate-900 truncate",style:{fontFamily:"'Instrument Serif', serif"},children:r.name}),D.jsxs("div",{className:"flex items-center gap-3 mt-1 text-[13px] text-slate-400",style:{fontFamily:"'JetBrains Mono', monospace"},children:[D.jsxs("span",{className:"flex items-center gap-1",children:[D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-400",children:[D.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),D.jsx("polyline",{points:"14 2 14 8 20 8"})]}),a," ",a===1?"doc":"docs"]}),D.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),D.jsxs("span",{className:"flex items-center gap-1",children:[D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-400",children:[D.jsx("path",{d:"M12 20h9"}),D.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"})]}),l," ",l===1?"annotation":"annotations"]})]})]}),D.jsx("div",{className:"text-[13px] text-slate-400 whitespace-nowrap shrink-0",style:{fontFamily:"'JetBrains Mono', monospace"},children:pC(r.updated_at)}),D.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:e?"#475569":"#cbd5e1",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 transition-colors",children:D.jsx("polyline",{points:"9 18 15 12 9 6"})})]})}function gC({onClose:r,onCreate:t,isPending:e}){const[i,a]=I.useState(""),[l,c]=I.useState(sl[0]),u=()=>{const d=i.trim();d&&(t(d,l),a(""),c(sl[0]))};return D.jsx("div",{className:"fixed inset-0 bg-slate-950/40 backdrop-blur-sm flex items-center justify-center z-[1000]",onClick:r,children:D.jsxs("div",{className:"bg-white rounded-xl p-8 w-full max-w-[420px] shadow-xl mx-4",onClick:d=>d.stopPropagation(),children:[D.jsx("h2",{className:"m-0 text-xl font-normal text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"New project"}),D.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:"Group related deal documents together."}),D.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mb-1.5 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Project name"}),D.jsx("input",{type:"text",value:i,onChange:d=>a(d.target.value),placeholder:"e.g. Meridian Healthcare CIM",autoFocus:!0,className:"w-full px-3.5 py-2.5 text-[15px] border border-slate-200 rounded-lg outline-none text-slate-800 focus:border-slate-600 transition-colors box-border",style:{fontFamily:"'DM Sans', sans-serif"}}),D.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mt-5 mb-2 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Colour"}),D.jsx("div",{className:"flex gap-2",children:sl.map(d=>D.jsx("button",{type:"button",onClick:()=>c(d),className:"w-7 h-7 rounded-full shrink-0 transition-all border-2 border-transparent focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2",style:{background:d,borderColor:l===d?"#1e293b":"transparent",outline:l===d?"2px solid #fff":"none",outlineOffset:-4}},d))}),D.jsxs("div",{className:"flex justify-end gap-2.5 mt-7",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium border border-slate-200 rounded-lg bg-white text-slate-500 hover:bg-slate-50",children:"Cancel"}),D.jsx("button",{type:"button",onClick:u,disabled:!i.trim()||e,className:"px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors disabled:bg-slate-300 disabled:cursor-default hover:bg-slate-700",style:{background:i.trim()&&!e?"#1e293b":"#cbd5e1"},children:e?"Creating":"Create project"})]})]})})}function yC(){const r=fa(),t=gl(),e=sr(N=>N.logout),[i,a]=I.useState(!1),[l,c]=I.useState(""),{data:u}=tr({queryKey:["me"],queryFn:async()=>{const{data:N}=await Bc.me();return N}}),{data:d,isLoading:f}=tr({queryKey:["projects"],queryFn:async()=>{const{data:N}=await Vh.list();return N}}),p=Array.isArray(d)?d:d?.results??[],y=p.filter(N=>N.name.toLowerCase().includes(l.toLowerCase())),w=p.reduce((N,k)=>N+(k.document_count??0),0),A=p.reduce((N,k)=>N+(k.annotation_count??0),0),_=Nc({mutationFn:({name:N,color:k})=>Vh.create({name:N.trim(),color:k}),onSuccess:()=>{t.invalidateQueries({queryKey:["projects"]}),a(!1)}}),S=(N,k)=>{_.mutate({name:N,color:k})},C=()=>{e(),r("/login",{replace:!0})},M=(u?.email?.[0]||u?.username?.[0]||"?").toUpperCase();return D.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif",color:"#1e293b"},children:[D.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap",rel:"stylesheet"}),D.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("div",{className:"w-6 h-6 rounded-md bg-slate-700 flex items-center justify-center text-white text-xs font-semibold",style:{fontFamily:"'DM Sans', sans-serif"},children:"W"}),D.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:C,className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:D.jsx(Ew,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:()=>r("/app/settings"),className:"w-8 h-8 rounded-full bg-slate-700 text-white flex items-center justify-center text-[13px] font-semibold hover:bg-slate-600 transition-colors",style:{fontFamily:"'DM Sans', sans-serif"},title:"Account settings",children:M})]})]}),D.jsxs("div",{className:"max-w-[720px] mx-auto px-6 py-10",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsxs("div",{className:"flex items-start justify-between mb-2",children:[D.jsx("h1",{className:"m-0 text-[28px] font-normal text-slate-950 tracking-tight",style:{fontFamily:"'Instrument Serif', serif"},children:"Projects"}),D.jsxs("button",{type:"button",onClick:()=>a(!0),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors hover:bg-slate-700",style:{background:"#1e293b",fontFamily:"'DM Sans', sans-serif"},children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[D.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),D.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New project"]})]}),D.jsxs("div",{className:"flex items-center gap-3 text-[13px] text-slate-400 mb-6 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:[D.jsxs("span",{children:[p.length," project",p.length!==1?"s":""]}),D.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),D.jsxs("span",{children:[w," document",w!==1?"s":""]}),D.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),D.jsxs("span",{children:[A," annotation",A!==1?"s":""]})]}),p.length>3&&D.jsxs("div",{className:"relative mb-4",children:[D.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#94a3b8",strokeWidth:"2",className:"absolute left-3 top-1/2 -translate-y-1/2",children:[D.jsx("circle",{cx:"11",cy:"11",r:"8"}),D.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),D.jsx("input",{type:"text",placeholder:"Search projects",value:l,onChange:N=>c(N.target.value),className:"w-full py-2.5 pl-9 pr-3.5 text-sm border border-slate-200 rounded-lg outline-none text-slate-800 bg-white box-border",style:{fontFamily:"'DM Sans', sans-serif"}})]}),f?D.jsxs("div",{className:"flex items-center gap-2 text-slate-500 py-12",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx(Ts,{className:"w-5 h-5 animate-spin"}),"Loading projects"]}):D.jsx("div",{className:"flex flex-col gap-2",children:y.map(N=>D.jsx(mC,{project:N,onOpen:k=>r(`/project/${k}`)},N.id))}),!f&&y.length===0&&l&&D.jsxs("div",{className:"text-center py-12 text-slate-500 text-sm",style:{fontFamily:"'DM Sans', sans-serif"},children:['No projects match "',l,'"']}),!f&&p.length===0&&D.jsxs("div",{className:"text-center py-16 text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto mb-4",children:D.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),D.jsx("div",{className:"text-base font-medium text-slate-600 mb-1.5",children:"No projects yet"}),D.jsx("div",{className:"text-sm text-slate-500",children:"Create a project to start organising your deal documents."})]})]}),i&&D.jsx(gC,{onClose:()=>a(!1),onCreate:S,isPending:_.isPending})]})}var Bh={exports:{}},bC=Bh.exports,$0;function vC(){return $0||($0=1,(function(r,t){((e,i)=>{r.exports=i()})(bC,function(){var e=function(m,v){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(x,E){x.__proto__=E}:function(x,E){for(var R in E)Object.prototype.hasOwnProperty.call(E,R)&&(x[R]=E[R])}))(m,v)},i=function(){return(i=Object.assign||function(m){for(var v,x=1,E=arguments.length;x<E;x++)for(var R in v=arguments[x])Object.prototype.hasOwnProperty.call(v,R)&&(m[R]=v[R]);return m}).apply(this,arguments)};function a(m,v,x){for(var E,R=0,O=v.length;R<O;R++)!E&&R in v||((E=E||Array.prototype.slice.call(v,0,R))[R]=v[R]);return m.concat(E||Array.prototype.slice.call(v))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:C1,c=Object.keys,u=Array.isArray;function d(m,v){return typeof v=="object"&&c(v).forEach(function(x){m[x]=v[x]}),m}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var f=Object.getPrototypeOf,p={}.hasOwnProperty;function y(m,v){return p.call(m,v)}function w(m,v){typeof v=="function"&&(v=v(f(m))),(typeof Reflect>"u"?c:Reflect.ownKeys)(v).forEach(function(x){_(m,x,v[x])})}var A=Object.defineProperty;function _(m,v,x,E){A(m,v,d(x&&y(x,"get")&&typeof x.get=="function"?{get:x.get,set:x.set,configurable:!0}:{value:x,configurable:!0,writable:!0},E))}function S(m){return{from:function(v){return m.prototype=Object.create(v.prototype),_(m.prototype,"constructor",m),{extend:w.bind(null,m.prototype)}}}}var C=Object.getOwnPropertyDescriptor,M=[].slice;function N(m,v,x){return M.call(m,v,x)}function k(m,v){return v(m)}function j(m){if(!m)throw new Error("Assertion Failed")}function F(m){l.setImmediate?setImmediate(m):setTimeout(m,0)}function z(m,v){if(typeof v=="string"&&y(m,v))return m[v];if(!v)return m;if(typeof v!="string"){for(var x=[],E=0,R=v.length;E<R;++E){var O=z(m,v[E]);x.push(O)}return x}var P,B=v.indexOf(".");return B===-1||(P=m[v.substr(0,B)])==null?void 0:z(P,v.substr(B+1))}function H(m,v,x){if(m&&v!==void 0&&!("isFrozen"in Object&&Object.isFrozen(m)))if(typeof v!="string"&&"length"in v){j(typeof x!="string"&&"length"in x);for(var E=0,R=v.length;E<R;++E)H(m,v[E],x[E])}else{var O,P,B=v.indexOf(".");B!==-1?(O=v.substr(0,B),(B=v.substr(B+1))===""?x===void 0?u(m)&&!isNaN(parseInt(O))?m.splice(O,1):delete m[O]:m[O]=x:H(P=(P=m[O])&&y(m,O)?P:m[O]={},B,x)):x===void 0?u(m)&&!isNaN(parseInt(v))?m.splice(v,1):delete m[v]:m[v]=x}}function ut(m){var v,x={};for(v in m)y(m,v)&&(x[v]=m[v]);return x}var ft=[].concat;function _t(m){return ft.apply([],m)}var J="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(_t([8,16,32,64].map(function(m){return["Int","Uint","Float"].map(function(v){return v+m+"Array"})}))).filter(function(m){return l[m]}),ct=new Set(J.map(function(m){return l[m]})),Rt=null;function Lt(m){return Rt=new WeakMap,m=(function v(x){if(!x||typeof x!="object")return x;var E=Rt.get(x);if(E)return E;if(u(x)){E=[],Rt.set(x,E);for(var R=0,O=x.length;R<O;++R)E.push(v(x[R]))}else if(ct.has(x.constructor))E=x;else{var P,B=f(x);for(P in E=B===Object.prototype?{}:Object.create(B),Rt.set(x,E),x)y(x,P)&&(E[P]=v(x[P]))}return E})(m),Rt=null,m}var Bt={}.toString;function $t(m){return Bt.call(m).slice(8,-1)}var G=typeof Symbol<"u"?Symbol.iterator:"@@iterator",st=typeof G=="symbol"?function(m){var v;return m!=null&&(v=m[G])&&v.apply(m)}:function(){return null};function wt(m,v){v=m.indexOf(v),0<=v&&m.splice(v,1)}var Xt={};function Ct(m){var v,x,E,R;if(arguments.length===1){if(u(m))return m.slice();if(this===Xt&&typeof m=="string")return[m];if(R=st(m))for(x=[];!(E=R.next()).done;)x.push(E.value);else{if(m==null)return[m];if(typeof(v=m.length)!="number")return[m];for(x=new Array(v);v--;)x[v]=m[v]}}else for(v=arguments.length,x=new Array(v);v--;)x[v]=arguments[v];return x}var U=typeof Symbol<"u"?function(m){return m[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},J=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Un=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(J),mt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function xt(m,v){this.name=m,this.message=v}function It(m,v){return m+". Errors: "+Object.keys(v).map(function(x){return v[x].toString()}).filter(function(x,E,R){return R.indexOf(x)===E}).join(`
`)}function Ut(m,v,x,E){this.failures=v,this.failedKeys=E,this.successCount=x,this.message=It(m,v)}function Ot(m,v){this.name="BulkError",this.failures=Object.keys(v).map(function(x){return v[x]}),this.failuresByPos=v,this.message=It(m,this.failures)}S(xt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),S(Ut).from(xt),S(Ot).from(xt);var Tt=Un.reduce(function(m,v){return m[v]=v+"Error",m},{}),jt=xt,kt=Un.reduce(function(m,v){var x=v+"Error";function E(R,O){this.name=x,R?typeof R=="string"?(this.message="".concat(R).concat(O?`
 `+O:""),this.inner=O||null):typeof R=="object"&&(this.message="".concat(R.name," ").concat(R.message),this.inner=R):(this.message=mt[v]||x,this.inner=null)}return S(E).from(jt),m[v]=E,m},{}),we=(kt.Syntax=SyntaxError,kt.Type=TypeError,kt.Range=RangeError,J.reduce(function(m,v){return m[v+"Error"]=kt[v],m},{}));J=Un.reduce(function(m,v){return["Syntax","Type","Range"].indexOf(v)===-1&&(m[v+"Error"]=kt[v]),m},{});function pt(){}function he(m){return m}function ge(m,v){return m==null||m===he?v:function(x){return v(m(x))}}function An(m,v){return function(){m.apply(this,arguments),v.apply(this,arguments)}}function Gi(m,v){return m===pt?v:function(){var x=m.apply(this,arguments),E=(x!==void 0&&(arguments[0]=x),this.onsuccess),R=this.onerror,O=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return E&&(this.onsuccess=this.onsuccess?An(E,this.onsuccess):E),R&&(this.onerror=this.onerror?An(R,this.onerror):R),O!==void 0?O:x}}function ar(m,v){return m===pt?v:function(){m.apply(this,arguments);var x=this.onsuccess,E=this.onerror;this.onsuccess=this.onerror=null,v.apply(this,arguments),x&&(this.onsuccess=this.onsuccess?An(x,this.onsuccess):x),E&&(this.onerror=this.onerror?An(E,this.onerror):E)}}function tu(m,v){return m===pt?v:function(R){var E=m.apply(this,arguments),R=(d(R,E),this.onsuccess),O=this.onerror,P=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return R&&(this.onsuccess=this.onsuccess?An(R,this.onsuccess):R),O&&(this.onerror=this.onerror?An(O,this.onerror):O),E===void 0?P===void 0?void 0:P:d(E,P)}}function bl(m,v){return m===pt?v:function(){return v.apply(this,arguments)!==!1&&m.apply(this,arguments)}}function rr(m,v){return m===pt?v:function(){var x=m.apply(this,arguments);if(x&&typeof x.then=="function"){for(var E=this,R=arguments.length,O=new Array(R);R--;)O[R]=arguments[R];return x.then(function(){return v.apply(E,O)})}return v.apply(this,arguments)}}J.ModifyError=Ut,J.DexieError=xt,J.BulkError=Ot;var ti=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function eu(m){ti=m}var or={},In=100,lr=typeof Promise>"u"?[]:(Un=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[lr=crypto.subtle.digest("SHA-512",new Uint8Array([0])),f(lr),Un]:[Un,f(Un),Un]),Un=lr[0],Hs=lr[1],Hs=Hs&&Hs.then,ns=Un&&Un.constructor,pa=!!lr[2],cr=function(m,v){ur.push([m,v]),no&&(queueMicrotask(nu),no=!1)},eo=!0,no=!0,Ms=[],is=[],Mn=he,Dn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pt,pgp:!1,env:{},finalize:pt},Ft=Dn,ur=[],Ds=0,io=[];function Nt(m){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var v=this._PSD=Ft;if(typeof m!="function"){if(m!==or)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Vi(this,this._value)}else this._state=null,this._value=null,++v.ref,(function x(E,R){try{R(function(O){if(E._state===null){if(O===E)throw new TypeError("A promise cannot be resolved with itself.");var P=E._lib&&ss();O&&typeof O.then=="function"?x(E,function(B,$){O instanceof Nt?O._then(B,$):O.then(B,$)}):(E._state=!0,E._value=O,dr(E)),P&&Ti()}},Vi.bind(null,E))}catch(O){Vi(E,O)}})(this,m)}var ma={get:function(){var m=Ft,v=mr;function x(E,R){var O=this,P=!m.global&&(m!==Ft||v!==mr),B=P&&!Xn(),$=new Nt(function(et,K){Os(O,new hr(so(E,m,P,B),so(R,m,P,B),et,K,m))});return this._consoleTask&&($._consoleTask=this._consoleTask),$}return x.prototype=or,x},set:function(m){_(this,"then",m&&m.prototype===or?ma:{get:function(){return m},set:ma.set})}};function hr(m,v,x,E,R){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof v=="function"?v:null,this.resolve=x,this.reject=E,this.psd=R}function Vi(m,v){var x,E;is.push(v),m._state===null&&(x=m._lib&&ss(),v=Mn(v),m._state=!1,m._value=v,E=m,Ms.some(function(R){return R._value===E._value})||Ms.push(E),dr(m),x)&&Ti()}function dr(m){var v=m._listeners;m._listeners=[];for(var x=0,E=v.length;x<E;++x)Os(m,v[x]);var R=m._PSD;--R.ref||R.finalize(),Ds===0&&(++Ds,cr(function(){--Ds==0&&vl()},[]))}function Os(m,v){if(m._state===null)m._listeners.push(v);else{var x=m._state?v.onFulfilled:v.onRejected;if(x===null)return(m._state?v.resolve:v.reject)(m._value);++v.psd.ref,++Ds,cr(bd,[x,m,v])}}function bd(m,v,x){try{var E,R=v._value;!v._state&&is.length&&(is=[]),E=ti&&v._consoleTask?v._consoleTask.run(function(){return m(R)}):m(R),v._state||is.indexOf(R)!==-1||(O=>{for(var P=Ms.length;P;)if(Ms[--P]._value===O._value)return Ms.splice(P,1)})(v),x.resolve(E)}catch(O){x.reject(O)}finally{--Ds==0&&vl(),--x.psd.ref||x.psd.finalize()}}function nu(){fi(Dn,function(){ss()&&Ti()})}function ss(){var m=eo;return no=eo=!1,m}function Ti(){var m,v,x;do for(;0<ur.length;)for(m=ur,ur=[],x=m.length,v=0;v<x;++v){var E=m[v];E[0].apply(null,E[1])}while(0<ur.length);no=eo=!0}function vl(){for(var m=Ms,v=(Ms=[],m.forEach(function(E){E._PSD.onunhandled.call(null,E._value,E)}),io.slice(0)),x=v.length;x;)v[--x]()}function fr(m){return new Nt(or,!1,m)}function Ie(m,v){var x=Ft;return function(){var E=ss(),R=Ft;try{return rs(x,!0),m.apply(this,arguments)}catch(O){v&&v(O)}finally{rs(R,!1),E&&Ti()}}}w(Nt.prototype,{then:ma,_then:function(m,v){Os(this,new hr(null,null,m,v,Ft))},catch:function(m){var v,x;return arguments.length===1?this.then(null,m):(v=m,x=arguments[1],typeof v=="function"?this.then(null,function(E){return(E instanceof v?x:fr)(E)}):this.then(null,function(E){return(E&&E.name===v?x:fr)(E)}))},finally:function(m){return this.then(function(v){return Nt.resolve(m()).then(function(){return v})},function(v){return Nt.resolve(m()).then(function(){return fr(v)})})},timeout:function(m,v){var x=this;return m<1/0?new Nt(function(E,R){var O=setTimeout(function(){return R(new kt.Timeout(v))},m);x.then(E,R).finally(clearTimeout.bind(null,O))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&_(Nt.prototype,Symbol.toStringTag,"Dexie.Promise"),Dn.env=xl(),w(Nt,{all:function(){var m=Ct.apply(null,arguments).map(ya);return new Nt(function(v,x){m.length===0&&v([]);var E=m.length;m.forEach(function(R,O){return Nt.resolve(R).then(function(P){m[O]=P,--E||v(m)},x)})})},resolve:function(m){return m instanceof Nt?m:m&&typeof m.then=="function"?new Nt(function(v,x){m.then(v,x)}):new Nt(or,!0,m)},reject:fr,race:function(){var m=Ct.apply(null,arguments).map(ya);return new Nt(function(v,x){m.map(function(E){return Nt.resolve(E).then(v,x)})})},PSD:{get:function(){return Ft},set:function(m){return Ft=m}},totalEchoes:{get:function(){return mr}},newPSD:ze,usePSD:fi,scheduler:{get:function(){return cr},set:function(m){cr=m}},rejectionMapper:{get:function(){return Mn},set:function(m){Mn=m}},follow:function(m,v){return new Nt(function(x,E){return ze(function(R,O){var P=Ft;P.unhandleds=[],P.onunhandled=O,P.finalize=An(function(){var B,$=this;B=function(){$.unhandleds.length===0?R():O($.unhandleds[0])},io.push(function et(){B(),io.splice(io.indexOf(et),1)}),++Ds,cr(function(){--Ds==0&&vl()},[])},P.finalize),m()},v,x,E)})}}),ns&&(ns.allSettled&&_(Nt,"allSettled",function(){var m=Ct.apply(null,arguments).map(ya);return new Nt(function(v){m.length===0&&v([]);var x=m.length,E=new Array(x);m.forEach(function(R,O){return Nt.resolve(R).then(function(P){return E[O]={status:"fulfilled",value:P}},function(P){return E[O]={status:"rejected",reason:P}}).then(function(){return--x||v(E)})})})}),ns.any&&typeof AggregateError<"u"&&_(Nt,"any",function(){var m=Ct.apply(null,arguments).map(ya);return new Nt(function(v,x){m.length===0&&x(new AggregateError([]));var E=m.length,R=new Array(E);m.forEach(function(O,P){return Nt.resolve(O).then(function(B){return v(B)},function(B){R[P]=B,--E||x(new AggregateError(R))})})})}),ns.withResolvers)&&(Nt.withResolvers=ns.withResolvers);var nn={awaits:0,echoes:0,id:0},wl=0,ga=[],pr=0,mr=0,as=0;function ze(m,P,x,E){var R=Ft,O=Object.create(R),P=(O.parent=R,O.ref=0,O.global=!1,O.id=++as,Dn.env,O.env=pa?{Promise:Nt,PromiseProp:{value:Nt,configurable:!0,writable:!0},all:Nt.all,race:Nt.race,allSettled:Nt.allSettled,any:Nt.any,resolve:Nt.resolve,reject:Nt.reject}:{},P&&d(O,P),++R.ref,O.finalize=function(){--this.parent.ref||this.parent.finalize()},fi(O,m,x,E));return O.ref===0&&O.finalize(),P}function sn(){return nn.id||(nn.id=++wl),++nn.awaits,nn.echoes+=In,nn.id}function Xn(){return!!nn.awaits&&(--nn.awaits==0&&(nn.id=0),nn.echoes=nn.awaits*In,!0)}function ya(m){return nn.echoes&&m&&m.constructor===ns?(sn(),m.then(function(v){return Xn(),v},function(v){return Xn(),ke(v)})):m}function vd(){var m=ga[ga.length-1];ga.pop(),rs(m,!1)}function rs(m,v){var x,E,R=Ft;(v?!nn.echoes||pr++&&m===Ft:!pr||--pr&&m===Ft)||queueMicrotask(v?(function(O){++mr,nn.echoes&&--nn.echoes!=0||(nn.echoes=nn.awaits=nn.id=0),ga.push(Ft),rs(O,!0)}).bind(null,m):vd),m!==Ft&&(Ft=m,R===Dn&&(Dn.env=xl()),pa)&&(x=Dn.env.Promise,E=m.env,R.global||m.global)&&(Object.defineProperty(l,"Promise",E.PromiseProp),x.all=E.all,x.race=E.race,x.resolve=E.resolve,x.reject=E.reject,E.allSettled&&(x.allSettled=E.allSettled),E.any)&&(x.any=E.any)}function xl(){var m=l.Promise;return pa?{Promise:m,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:m.all,race:m.race,allSettled:m.allSettled,any:m.any,resolve:m.resolve,reject:m.reject}:{}}function fi(m,v,x,E,R){var O=Ft;try{return rs(m,!0),v(x,E,R)}finally{rs(O,!1)}}function so(m,v,x,E){return typeof m!="function"?m:function(){var R=Ft;x&&sn(),rs(v,!0);try{return m.apply(this,arguments)}finally{rs(R,!1),E&&queueMicrotask(Xn)}}}function os(m){Promise===ns&&nn.echoes===0?pr===0?m():enqueueNativeMicroTask(m):setTimeout(m,0)}(""+Hs).indexOf("[native code]")===-1&&(sn=Xn=pt);var ke=Nt.reject,pi="",zn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",an="String expected.",Ns=[],gr="__dbnames",$i="readonly",ls="readwrite";function ks(m,v){return m?v?function(){return m.apply(this,arguments)&&v.apply(this,arguments)}:m:v}var Al={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function yr(m){return typeof m!="string"||/\./.test(m)?function(v){return v}:function(v){return v[m]===void 0&&m in v&&delete(v=Lt(v))[m],v}}function iu(){throw kt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ce(m,v){try{var x=br(m),E=br(v);if(x!==E)return x==="Array"?1:E==="Array"?-1:x==="binary"?1:E==="binary"?-1:x==="string"?1:E==="string"?-1:x==="Date"?1:E!=="Date"?NaN:-1;switch(x){case"number":case"Date":case"string":return v<m?1:m<v?-1:0;case"binary":for(var R=Ri(m),O=Ri(v),P=R.length,B=O.length,$=P<B?P:B,et=0;et<$;++et)if(R[et]!==O[et])return R[et]<O[et]?-1:1;return P===B?0:P<B?-1:1;case"Array":for(var K=m,V=v,Q=K.length,Z=V.length,X=Q<Z?Q:Z,Y=0;Y<X;++Y){var it=ce(K[Y],V[Y]);if(it!==0)return it}return Q===Z?0:Q<Z?-1:1}}catch{}return NaN}function br(m){var v=typeof m;return v=="object"&&(ArrayBuffer.isView(m)||(v=$t(m))==="ArrayBuffer")?"binary":v}function Ri(m){return m instanceof Uint8Array?m:ArrayBuffer.isView(m)?new Uint8Array(m.buffer,m.byteOffset,m.byteLength):new Uint8Array(m)}function On(m,v,x){var E=m.schema.yProps;return E?(v&&0<x.numFailures&&(v=v.filter(function(R,O){return!x.failures[O]})),Promise.all(E.map(function(R){return R=R.updatesTable,v?m.db.table(R).where("k").anyOf(v).delete():m.db.table(R).clear()})).then(function(){return x})):x}su.prototype.execute=function(m){var v=this["@@propmod"];if(v.add!==void 0){var x=v.add;if(u(x))return a(a([],u(m)?m:[],!0),x).sort();if(typeof x=="number")return(Number(m)||0)+x;if(typeof x=="bigint")try{return BigInt(m)+x}catch{return BigInt(0)+x}throw new TypeError("Invalid term ".concat(x))}if(v.remove!==void 0){var E=v.remove;if(u(E))return u(m)?m.filter(function(R){return!E.includes(R)}).sort():[];if(typeof E=="number")return Number(m)-E;if(typeof E=="bigint")try{return BigInt(m)-E}catch{return BigInt(0)-E}throw new TypeError("Invalid subtrahend ".concat(E))}return x=(x=v.replacePrefix)==null?void 0:x[0],x&&typeof m=="string"&&m.startsWith(x)?v.replacePrefix[1]+m.substring(x.length):m};var ba=su;function su(m){this["@@propmod"]=m}function ao(m,v){for(var x=c(v),E=x.length,R=!1,O=0;O<E;++O){var P=x[O],B=v[P],$=z(m,P);B instanceof ba?(H(m,P,B.execute($)),R=!0):$!==B&&(H(m,P,B),R=!0)}return R}Se.prototype._trans=function(m,v,x){var E=this._tx||Ft.trans,R=this.name,O=ti&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(m==="readonly"?"read":"write"," ").concat(this.name));function P(et,K,V){if(V.schema[R])return v(V.idbtrans,V);throw new kt.NotFound("Table "+R+" not part of transaction")}var B=ss();try{var $=E&&E.db._novip===this.db._novip?E===Ft.trans?E._promise(m,P,x):ze(function(){return E._promise(m,P,x)},{trans:E,transless:Ft.transless||Ft}):(function et(K,V,Q,Z){if(K.idbdb&&(K._state.openComplete||Ft.letThrough||K._vip)){var X=K._createTransaction(V,Q,K._dbSchema);try{X.create(),K._state.PR1398_maxLoop=3}catch(Y){return Y.name===Tt.InvalidState&&K.isOpen()&&0<--K._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),K.close({disableAutoOpen:!1}),K.open().then(function(){return et(K,V,Q,Z)})):ke(Y)}return X._promise(V,function(Y,it){return ze(function(){return Ft.trans=X,Z(Y,it,X)})}).then(function(Y){if(V==="readwrite")try{X.idbtrans.commit()}catch{}return V==="readonly"?Y:X._completion.then(function(){return Y})})}if(K._state.openComplete)return ke(new kt.DatabaseClosed(K._state.dbOpenError));if(!K._state.isBeingOpened){if(!K._state.autoOpen)return ke(new kt.DatabaseClosed);K.open().catch(pt)}return K._state.dbReadyPromise.then(function(){return et(K,V,Q,Z)})})(this.db,m,[this.name],P);return O&&($._consoleTask=O,$=$.catch(function(et){return console.trace(et),ke(et)})),$}finally{B&&Ti()}},Se.prototype.get=function(m,v){var x=this;return m&&m.constructor===Object?this.where(m).first(v):m==null?ke(new kt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(E){return x.core.get({trans:E,key:m}).then(function(R){return x.hook.reading.fire(R)})}).then(v)},Se.prototype.where=function(m){if(typeof m=="string")return new this.db.WhereClause(this,m);if(u(m))return new this.db.WhereClause(this,"[".concat(m.join("+"),"]"));var v=c(m);if(v.length===1)return this.where(v[0]).equals(m[v[0]]);var x=this.schema.indexes.concat(this.schema.primKey).filter(function(B){if(B.compound&&v.every(function(et){return 0<=B.keyPath.indexOf(et)})){for(var $=0;$<v.length;++$)if(v.indexOf(B.keyPath[$])===-1)return!1;return!0}return!1}).sort(function(B,$){return B.keyPath.length-$.keyPath.length})[0];if(x&&this.db._maxKey!==pi)return P=x.keyPath.slice(0,v.length),this.where(P).equals(P.map(function(B){return m[B]}));!x&&ti&&console.warn("The query ".concat(JSON.stringify(m)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(v.join("+"),"]"));var E=this.schema.idxByName;function R(B,$){return ce(B,$)===0}var P=v.reduce(function(K,$){var et=K[0],K=K[1],V=E[$],Q=m[$];return[et||V,et||!V?ks(K,V&&V.multi?function(Z){return Z=z(Z,$),u(Z)&&Z.some(function(X){return R(Q,X)})}:function(Z){return R(Q,z(Z,$))}):K]},[null,null]),O=P[0],P=P[1];return O?this.where(O.name).equals(m[O.keyPath]).filter(P):x?this.filter(P):this.where(v).equals("")},Se.prototype.filter=function(m){return this.toCollection().and(m)},Se.prototype.count=function(m){return this.toCollection().count(m)},Se.prototype.offset=function(m){return this.toCollection().offset(m)},Se.prototype.limit=function(m){return this.toCollection().limit(m)},Se.prototype.each=function(m){return this.toCollection().each(m)},Se.prototype.toArray=function(m){return this.toCollection().toArray(m)},Se.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Se.prototype.orderBy=function(m){return new this.db.Collection(new this.db.WhereClause(this,u(m)?"[".concat(m.join("+"),"]"):m))},Se.prototype.reverse=function(){return this.toCollection().reverse()},Se.prototype.mapToClass=function(m){for(var v=this.db,x=this.name,E=((this.schema.mappedClass=m).prototype instanceof iu&&(m=(P=>{var B=K,$=P;if(typeof $!="function"&&$!==null)throw new TypeError("Class extends value "+String($)+" is not a constructor or null");function et(){this.constructor=B}function K(){return P!==null&&P.apply(this,arguments)||this}return e(B,$),B.prototype=$===null?Object.create($):(et.prototype=$.prototype,new et),Object.defineProperty(K.prototype,"db",{get:function(){return v},enumerable:!1,configurable:!0}),K.prototype.table=function(){return x},K})(m)),new Set),R=m.prototype;R;R=f(R))Object.getOwnPropertyNames(R).forEach(function(P){return E.add(P)});function O(P){if(!P)return P;var B,$=Object.create(m.prototype);for(B in P)if(!E.has(B))try{$[B]=P[B]}catch{}return $}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=O,this.hook("reading",O),m},Se.prototype.defineClass=function(){return this.mapToClass(function(m){d(this,m)})},Se.prototype.add=function(m,v){var x=this,E=this.schema.primKey,R=E.auto,O=E.keyPath,P=m;return O&&R&&(P=yr(O)(m)),this._trans("readwrite",function(B){return x.core.mutate({trans:B,type:"add",keys:v!=null?[v]:null,values:[P]})}).then(function(B){return B.numFailures?Nt.reject(B.failures[0]):B.lastResult}).then(function(B){if(O)try{H(m,O,B)}catch{}return B})},Se.prototype.upsert=function(m,v){var x=this,E=this.schema.primKey.keyPath;return this._trans("readwrite",function(R){return x.core.get({trans:R,key:m}).then(function(O){var P=O??{};return ao(P,v),E&&H(P,E,m),x.core.mutate({trans:R,type:"put",values:[P],keys:[m],upsert:!0,updates:{keys:[m],changeSpecs:[v]}}).then(function(B){return B.numFailures?Nt.reject(B.failures[0]):!!O})})})},Se.prototype.update=function(m,v){return typeof m!="object"||u(m)?this.where(":id").equals(m).modify(v):(m=z(m,this.schema.primKey.keyPath))===void 0?ke(new kt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(m).modify(v)},Se.prototype.put=function(m,v){var x=this,E=this.schema.primKey,R=E.auto,O=E.keyPath,P=m;return O&&R&&(P=yr(O)(m)),this._trans("readwrite",function(B){return x.core.mutate({trans:B,type:"put",values:[P],keys:v!=null?[v]:null})}).then(function(B){return B.numFailures?Nt.reject(B.failures[0]):B.lastResult}).then(function(B){if(O)try{H(m,O,B)}catch{}return B})},Se.prototype.delete=function(m){var v=this;return this._trans("readwrite",function(x){return v.core.mutate({trans:x,type:"delete",keys:[m]}).then(function(E){return On(v,[m],E)}).then(function(E){return E.numFailures?Nt.reject(E.failures[0]):void 0})})},Se.prototype.clear=function(){var m=this;return this._trans("readwrite",function(v){return m.core.mutate({trans:v,type:"deleteRange",range:Al}).then(function(x){return On(m,null,x)})}).then(function(v){return v.numFailures?Nt.reject(v.failures[0]):void 0})},Se.prototype.bulkGet=function(m){var v=this;return this._trans("readonly",function(x){return v.core.getMany({keys:m,trans:x}).then(function(E){return E.map(function(R){return v.hook.reading.fire(R)})})})},Se.prototype.bulkAdd=function(m,v,x){var E=this,R=Array.isArray(v)?v:void 0,O=(x=x||(R?void 0:v))?x.allKeys:void 0;return this._trans("readwrite",function(P){var B=E.schema.primKey,et=B.auto,B=B.keyPath;if(B&&R)throw new kt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(R&&R.length!==m.length)throw new kt.InvalidArgument("Arguments objects and keys must have the same length");var $=m.length,et=B&&et?m.map(yr(B)):m;return E.core.mutate({trans:P,type:"add",keys:R,values:et,wantResults:O}).then(function(K){var V=K.numFailures,Q=K.failures;if(V===0)return O?K.results:K.lastResult;throw new Ot("".concat(E.name,".bulkAdd(): ").concat(V," of ").concat($," operations failed"),Q)})})},Se.prototype.bulkPut=function(m,v,x){var E=this,R=Array.isArray(v)?v:void 0,O=(x=x||(R?void 0:v))?x.allKeys:void 0;return this._trans("readwrite",function(P){var B=E.schema.primKey,et=B.auto,B=B.keyPath;if(B&&R)throw new kt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(R&&R.length!==m.length)throw new kt.InvalidArgument("Arguments objects and keys must have the same length");var $=m.length,et=B&&et?m.map(yr(B)):m;return E.core.mutate({trans:P,type:"put",keys:R,values:et,wantResults:O}).then(function(K){var V=K.numFailures,Q=K.failures;if(V===0)return O?K.results:K.lastResult;throw new Ot("".concat(E.name,".bulkPut(): ").concat(V," of ").concat($," operations failed"),Q)})})},Se.prototype.bulkUpdate=function(m){var v=this,x=this.core,E=m.map(function(P){return P.key}),R=m.map(function(P){return P.changes}),O=[];return this._trans("readwrite",function(P){return x.getMany({trans:P,keys:E,cache:"clone"}).then(function(B){var $=[],et=[],K=(m.forEach(function(V,Q){var Z=V.key,X=V.changes,Y=B[Q];if(Y){for(var it=0,ot=Object.keys(X);it<ot.length;it++){var nt=ot[it],gt=X[nt];if(nt===v.schema.primKey.keyPath){if(ce(gt,Z)!==0)throw new kt.Constraint("Cannot update primary key in bulkUpdate()")}else H(Y,nt,gt)}O.push(Q),$.push(Z),et.push(Y)}}),$.length);return x.mutate({trans:P,type:"put",keys:$,values:et,updates:{keys:E,changeSpecs:R}}).then(function(V){var Q=V.numFailures,Z=V.failures;if(Q===0)return K;for(var X=0,Y=Object.keys(Z);X<Y.length;X++){var it,ot=Y[X],nt=O[Number(ot)];nt!=null&&(it=Z[ot],delete Z[ot],Z[nt]=it)}throw new Ot("".concat(v.name,".bulkUpdate(): ").concat(Q," of ").concat(K," operations failed"),Z)})})})},Se.prototype.bulkDelete=function(m){var v=this,x=m.length;return this._trans("readwrite",function(E){return v.core.mutate({trans:E,type:"delete",keys:m}).then(function(R){return On(v,m,R)})}).then(function(E){var R=E.numFailures,O=E.failures;if(R===0)return E.lastResult;throw new Ot("".concat(v.name,".bulkDelete(): ").concat(R," of ").concat(x," operations failed"),O)})};var Sl=Se;function Se(){}function vr(m){function v(P,B){if(B){for(var $=arguments.length,et=new Array($-1);--$;)et[$-1]=arguments[$];return x[P].subscribe.apply(null,et),m}if(typeof P=="string")return x[P]}var x={};v.addEventType=O;for(var E=1,R=arguments.length;E<R;++E)O(arguments[E]);return v;function O(P,B,$){var et,K;if(typeof P!="object")return B=B||bl,K={subscribers:[],fire:$=$||pt,subscribe:function(V){K.subscribers.indexOf(V)===-1&&(K.subscribers.push(V),K.fire=B(K.fire,V))},unsubscribe:function(V){K.subscribers=K.subscribers.filter(function(Q){return Q!==V}),K.fire=K.subscribers.reduce(B,$)}},x[P]=v[P]=K;c(et=P).forEach(function(V){var Q=et[V];if(u(Q))O(V,et[V][0],et[V][1]);else{if(Q!=="asap")throw new kt.InvalidArgument("Invalid event config");var Z=O(V,he,function(){for(var X=arguments.length,Y=new Array(X);X--;)Y[X]=arguments[X];Z.subscribers.forEach(function(it){F(function(){it.apply(null,Y)})})})}})}}function Sn(m,v){return S(v).from({prototype:m}),v}function cs(m,v){return!(m.filter||m.algorithm||m.or)&&(v?m.justLimit:!m.replayFilter)}function ro(m,v){m.filter=ks(m.filter,v)}function wr(m,v,x){var E=m.replayFilter;m.replayFilter=E?function(){return ks(E(),v())}:v,m.justLimit=x&&!E}function Ki(m,v){if(m.isPrimKey)return v.primaryKey;var x=v.getIndexByKeyPath(m.index);if(x)return x;throw new kt.Schema("KeyPath "+m.index+" on object store "+v.name+" is not indexed")}function El(m,v,x){var E=Ki(m,v.schema);return v.openCursor({trans:x,values:!m.keysOnly,reverse:m.dir==="prev",unique:!!m.unique,query:{index:E,range:m.range}})}function xr(m,v,x,E){var R,O,P=m.replayFilter?ks(m.filter,m.replayFilter()):m.filter;return m.or?(R={},O=function(B,$,et){var K,V;P&&!P($,et,function(Q){return $.stop(Q)},function(Q){return $.fail(Q)})||((V=""+(K=$.primaryKey))=="[object ArrayBuffer]"&&(V=""+new Uint8Array(K)),y(R,V))||(R[V]=!0,v(B,$,et))},Promise.all([m.or._iterate(O,x),Ls(El(m,E,x),m.algorithm,O,!m.keysOnly&&m.valueMapper)])):Ls(El(m,E,x),ks(m.algorithm,P),v,!m.keysOnly&&m.valueMapper)}function Ls(m,v,x,E){var R=Ie(E?function(O,P,B){return x(E(O),P,B)}:x);return m.then(function(O){if(O)return O.start(function(){var P=function(){return O.continue()};v&&!v(O,function(B){return P=B},function(B){O.stop(B),P=pt},function(B){O.fail(B),P=pt})||R(O.value,O,function(B){return P=B}),P()})})}ye.prototype._read=function(m,v){var x=this._ctx;return x.error?x.table._trans(null,ke.bind(null,x.error)):x.table._trans("readonly",m).then(v)},ye.prototype._write=function(m){var v=this._ctx;return v.error?v.table._trans(null,ke.bind(null,v.error)):v.table._trans("readwrite",m,"locked")},ye.prototype._addAlgorithm=function(m){var v=this._ctx;v.algorithm=ks(v.algorithm,m)},ye.prototype._iterate=function(m,v){return xr(this._ctx,m,v,this._ctx.table.core)},ye.prototype.clone=function(m){var v=Object.create(this.constructor.prototype),x=Object.create(this._ctx);return m&&d(x,m),v._ctx=x,v},ye.prototype.raw=function(){return this._ctx.valueMapper=null,this},ye.prototype.each=function(m){var v=this._ctx;return this._read(function(x){return xr(v,m,x,v.table.core)})},ye.prototype.count=function(m){var v=this;return this._read(function(x){var E,R=v._ctx,O=R.table.core;return cs(R,!0)?O.count({trans:x,query:{index:Ki(R,O.schema),range:R.range}}).then(function(P){return Math.min(P,R.limit)}):(E=0,xr(R,function(){return++E,!1},x,O).then(function(){return E}))}).then(m)},ye.prototype.sortBy=function(m,v){var x=m.split(".").reverse(),E=x[0],R=x.length-1;function O($,et){return et?O($[x[et]],et-1):$[E]}var P=this._ctx.dir==="next"?1:-1;function B($,et){return ce(O($,R),O(et,R))*P}return this.toArray(function($){return $.sort(B)}).then(v)},ye.prototype.toArray=function(m){var v=this;return this._read(function(x){var E,R,O,P=v._ctx;return P.dir==="next"&&cs(P,!0)&&0<P.limit?(E=P.valueMapper,R=Ki(P,P.table.core.schema),P.table.core.query({trans:x,limit:P.limit,values:!0,query:{index:R,range:P.range}}).then(function(B){return B=B.result,E?B.map(E):B})):(O=[],xr(P,function(B){return O.push(B)},x,P.table.core).then(function(){return O}))},m)},ye.prototype.offset=function(m){var v=this._ctx;return m<=0||(v.offset+=m,cs(v)?wr(v,function(){var x=m;return function(E,R){return x===0||(x===1?--x:R(function(){E.advance(x),x=0}),!1)}}):wr(v,function(){var x=m;return function(){return--x<0}})),this},ye.prototype.limit=function(m){return this._ctx.limit=Math.min(this._ctx.limit,m),wr(this._ctx,function(){var v=m;return function(x,E,R){return--v<=0&&E(R),0<=v}},!0),this},ye.prototype.until=function(m,v){return ro(this._ctx,function(x,E,R){return!m(x.value)||(E(R),v)}),this},ye.prototype.first=function(m){return this.limit(1).toArray(function(v){return v[0]}).then(m)},ye.prototype.last=function(m){return this.reverse().first(m)},ye.prototype.filter=function(m){var v;return ro(this._ctx,function(x){return m(x.value)}),(v=this._ctx).isMatch=ks(v.isMatch,m),this},ye.prototype.and=function(m){return this.filter(m)},ye.prototype.or=function(m){return new this.db.WhereClause(this._ctx.table,m,this)},ye.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ye.prototype.desc=function(){return this.reverse()},ye.prototype.eachKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(x,E){m(E.key,E)})},ye.prototype.eachUniqueKey=function(m){return this._ctx.unique="unique",this.eachKey(m)},ye.prototype.eachPrimaryKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(x,E){m(E.primaryKey,E)})},ye.prototype.keys=function(m){var v=this._ctx,x=(v.keysOnly=!v.isMatch,[]);return this.each(function(E,R){x.push(R.key)}).then(function(){return x}).then(m)},ye.prototype.primaryKeys=function(m){var v=this._ctx;if(v.dir==="next"&&cs(v,!0)&&0<v.limit)return this._read(function(E){var R=Ki(v,v.table.core.schema);return v.table.core.query({trans:E,values:!1,limit:v.limit,query:{index:R,range:v.range}})}).then(function(E){return E.result}).then(m);v.keysOnly=!v.isMatch;var x=[];return this.each(function(E,R){x.push(R.primaryKey)}).then(function(){return x}).then(m)},ye.prototype.uniqueKeys=function(m){return this._ctx.unique="unique",this.keys(m)},ye.prototype.firstKey=function(m){return this.limit(1).keys(function(v){return v[0]}).then(m)},ye.prototype.lastKey=function(m){return this.reverse().firstKey(m)},ye.prototype.distinct=function(){var m,v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];return v&&v.multi&&(m={},ro(this._ctx,function(E){var E=E.primaryKey.toString(),R=y(m,E);return m[E]=!0,!R})),this},ye.prototype.modify=function(m){var v=this,x=this._ctx;return this._write(function(E){function R(Y,it){var ot=it.failures;Q+=Y-it.numFailures;for(var nt=0,gt=c(ot);nt<gt.length;nt++){var At=gt[nt];V.push(ot[At])}}var O=typeof m=="function"?m:function(Y){return ao(Y,m)},P=x.table.core,K=P.schema.primaryKey,B=K.outbound,$=K.extractKey,et=200,K=v.db._options.modifyChunkSize,V=(K&&(et=typeof K=="object"?K[P.name]||K["*"]||200:K),[]),Q=0,Z=[],X=m===_l;return v.clone().primaryKeys().then(function(Y){function it(nt){var gt=Math.min(et,Y.length-nt),At=Y.slice(nt,nt+gt);return(X?Promise.resolve([]):P.getMany({trans:E,keys:At,cache:"immutable"})).then(function(Mt){var Dt=[],St=[],zt=B?[]:null,Pt=X?At:[];if(!X)for(var Et=0;Et<gt;++Et){var Ht=Mt[Et],ee={value:Lt(Ht),primKey:Y[nt+Et]};O.call(ee,ee.value,ee)!==!1&&(ee.value==null?Pt.push(Y[nt+Et]):B||ce($(Ht),$(ee.value))===0?(St.push(ee.value),B&&zt.push(Y[nt+Et])):(Pt.push(Y[nt+Et]),Dt.push(ee.value)))}return Promise.resolve(0<Dt.length&&P.mutate({trans:E,type:"add",values:Dt}).then(function(ue){for(var Yt in ue.failures)Pt.splice(parseInt(Yt),1);R(Dt.length,ue)})).then(function(){return(0<St.length||ot&&typeof m=="object")&&P.mutate({trans:E,type:"put",keys:zt,values:St,criteria:ot,changeSpec:typeof m!="function"&&m,isAdditionalChunk:0<nt}).then(function(ue){return R(St.length,ue)})}).then(function(){return(0<Pt.length||ot&&X)&&P.mutate({trans:E,type:"delete",keys:Pt,criteria:ot,isAdditionalChunk:0<nt}).then(function(ue){return On(x.table,Pt,ue)}).then(function(ue){return R(Pt.length,ue)})}).then(function(){return Y.length>nt+gt&&it(nt+et)})})}var ot=cs(x)&&x.limit===1/0&&(typeof m!="function"||X)&&{index:x.index,range:x.range};return it(0).then(function(){if(0<V.length)throw new Ut("Error modifying one or more objects",V,Q,Z);return Y.length})})})},ye.prototype.delete=function(){var m=this._ctx,v=m.range;return!cs(m)||m.table.schema.yProps||!m.isPrimKey&&v.type!==3?this.modify(_l):this._write(function(x){var E=m.table.core.schema.primaryKey,R=v;return m.table.core.count({trans:x,query:{index:E,range:R}}).then(function(O){return m.table.core.mutate({trans:x,type:"deleteRange",range:R}).then(function($){var B=$.failures,$=$.numFailures;if($)throw new Ut("Could not delete some values",Object.keys(B).map(function(et){return B[et]}),O-$);return O-$})})})};var wd=ye;function ye(){}var _l=function(m,v){return v.value=null};function Cl(m,v){return m<v?-1:m===v?0:1}function xd(m,v){return v<m?-1:m===v?0:1}function Yn(m,v,x){return m=m instanceof Ps?new m.Collection(m):m,m._ctx.error=new(x||TypeError)(v),m}function Xi(m){return new m.Collection(m,function(){return oo("")}).limit(0)}function ei(Z,v,x,E){var R,O,P,B,$,et,K,V=x.length;if(!x.every(function(Y){return typeof Y=="string"}))return Yn(Z,an);function Q(Y){R=Y==="next"?function(ot){return ot.toUpperCase()}:function(ot){return ot.toLowerCase()},O=Y==="next"?function(ot){return ot.toLowerCase()}:function(ot){return ot.toUpperCase()},P=Y==="next"?Cl:xd;var it=x.map(function(ot){return{lower:O(ot),upper:R(ot)}}).sort(function(ot,nt){return P(ot.lower,nt.lower)});B=it.map(function(ot){return ot.upper}),$=it.map(function(ot){return ot.lower}),K=(et=Y)==="next"?"":E}Q("next");var Z=new Z.Collection(Z,function(){return Mi(B[0],$[V-1]+E)}),X=(Z._ondirectionchange=function(Y){Q(Y)},0);return Z._addAlgorithm(function(Y,it,ot){var nt=Y.key;if(typeof nt=="string"){var gt=O(nt);if(v(gt,$,X))return!0;for(var At=null,Mt=X;Mt<V;++Mt){var Dt=((St,zt,Pt,Et,Ht,ee)=>{for(var ue=Math.min(St.length,Et.length),Yt=-1,se=0;se<ue;++se){var Le=zt[se];if(Le!==Et[se])return Ht(St[se],Pt[se])<0?St.substr(0,se)+Pt[se]+Pt.substr(se+1):Ht(St[se],Et[se])<0?St.substr(0,se)+Et[se]+Pt.substr(se+1):0<=Yt?St.substr(0,Yt)+zt[Yt]+Pt.substr(Yt+1):null;Ht(St[se],Le)<0&&(Yt=se)}return ue<Et.length&&ee==="next"?St+Pt.substr(St.length):ue<St.length&&ee==="prev"?St.substr(0,Pt.length):Yt<0?null:St.substr(0,Yt)+Et[Yt]+Pt.substr(Yt+1)})(nt,gt,B[Mt],$[Mt],P,et);Dt===null&&At===null?X=Mt+1:(At===null||0<P(At,Dt))&&(At=Dt)}it(At!==null?function(){Y.continue(At+K)}:ot)}return!1}),Z}function Mi(m,v,x,E){return{type:2,lower:m,upper:v,lowerOpen:x,upperOpen:E}}function oo(m){return{type:1,lower:m,upper:m}}Object.defineProperty(He.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),He.prototype.between=function(m,v,x,E){x=x!==!1,E=E===!0;try{return 0<this._cmp(m,v)||this._cmp(m,v)===0&&(x||E)&&(!x||!E)?Xi(this):new this.Collection(this,function(){return Mi(m,v,!x,!E)})}catch{return Yn(this,zn)}},He.prototype.equals=function(m){return m==null?Yn(this,zn):new this.Collection(this,function(){return oo(m)})},He.prototype.above=function(m){return m==null?Yn(this,zn):new this.Collection(this,function(){return Mi(m,void 0,!0)})},He.prototype.aboveOrEqual=function(m){return m==null?Yn(this,zn):new this.Collection(this,function(){return Mi(m,void 0,!1)})},He.prototype.below=function(m){return m==null?Yn(this,zn):new this.Collection(this,function(){return Mi(void 0,m,!1,!0)})},He.prototype.belowOrEqual=function(m){return m==null?Yn(this,zn):new this.Collection(this,function(){return Mi(void 0,m)})},He.prototype.startsWith=function(m){return typeof m!="string"?Yn(this,an):this.between(m,m+pi,!0,!0)},He.prototype.startsWithIgnoreCase=function(m){return m===""?this.startsWith(m):ei(this,function(v,x){return v.indexOf(x[0])===0},[m],pi)},He.prototype.equalsIgnoreCase=function(m){return ei(this,function(v,x){return v===x[0]},[m],"")},He.prototype.anyOfIgnoreCase=function(){var m=Ct.apply(Xt,arguments);return m.length===0?Xi(this):ei(this,function(v,x){return x.indexOf(v)!==-1},m,"")},He.prototype.startsWithAnyOfIgnoreCase=function(){var m=Ct.apply(Xt,arguments);return m.length===0?Xi(this):ei(this,function(v,x){return x.some(function(E){return v.indexOf(E)===0})},m,pi)},He.prototype.anyOf=function(){var m,v,x=this,E=Ct.apply(Xt,arguments),R=this._cmp;try{E.sort(R)}catch{return Yn(this,zn)}return E.length===0?Xi(this):((m=new this.Collection(this,function(){return Mi(E[0],E[E.length-1])}))._ondirectionchange=function(O){R=O==="next"?x._ascending:x._descending,E.sort(R)},v=0,m._addAlgorithm(function(O,P,B){for(var $=O.key;0<R($,E[v]);)if(++v===E.length)return P(B),!1;return R($,E[v])===0||(P(function(){O.continue(E[v])}),!1)}),m)},He.prototype.notEqual=function(m){return this.inAnyRange([[-1/0,m],[m,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},He.prototype.noneOf=function(){var m=Ct.apply(Xt,arguments);if(m.length===0)return new this.Collection(this);try{m.sort(this._ascending)}catch{return Yn(this,zn)}var v=m.reduce(function(x,E){return x?x.concat([[x[x.length-1][1],E]]):[[-1/0,E]]},null);return v.push([m[m.length-1],this.db._maxKey]),this.inAnyRange(v,{includeLowers:!1,includeUppers:!1})},He.prototype.inAnyRange=function(m,ot){var x=this,E=this._cmp,R=this._ascending,O=this._descending,P=this._min,B=this._max;if(m.length===0)return Xi(this);if(!m.every(function(nt){return nt[0]!==void 0&&nt[1]!==void 0&&R(nt[0],nt[1])<=0}))return Yn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",kt.InvalidArgument);var $=!ot||ot.includeLowers!==!1,et=ot&&ot.includeUppers===!0,K,V=R;function Q(nt,gt){return V(nt[0],gt[0])}try{(K=m.reduce(function(nt,gt){for(var At=0,Mt=nt.length;At<Mt;++At){var Dt=nt[At];if(E(gt[0],Dt[1])<0&&0<E(gt[1],Dt[0])){Dt[0]=P(Dt[0],gt[0]),Dt[1]=B(Dt[1],gt[1]);break}}return At===Mt&&nt.push(gt),nt},[])).sort(Q)}catch{return Yn(this,zn)}var Z=0,X=et?function(nt){return 0<R(nt,K[Z][1])}:function(nt){return 0<=R(nt,K[Z][1])},Y=$?function(nt){return 0<O(nt,K[Z][0])}:function(nt){return 0<=O(nt,K[Z][0])},it=X,ot=new this.Collection(this,function(){return Mi(K[0][0],K[K.length-1][1],!$,!et)});return ot._ondirectionchange=function(nt){V=nt==="next"?(it=X,R):(it=Y,O),K.sort(Q)},ot._addAlgorithm(function(nt,gt,At){for(var Mt,Dt=nt.key;it(Dt);)if(++Z===K.length)return gt(At),!1;return!X(Mt=Dt)&&!Y(Mt)||(x._cmp(Dt,K[Z][1])===0||x._cmp(Dt,K[Z][0])===0||gt(function(){V===R?nt.continue(K[Z][0]):nt.continue(K[Z][1])}),!1)}),ot},He.prototype.startsWithAnyOf=function(){var m=Ct.apply(Xt,arguments);return m.every(function(v){return typeof v=="string"})?m.length===0?Xi(this):this.inAnyRange(m.map(function(v){return[v,v+pi]})):Yn(this,"startsWithAnyOf() only works with strings")};var Ps=He;function He(){}function mi(m){return Ie(function(v){return Bs(v),m(v.target.error),!1})}function Bs(m){m.stopPropagation&&m.stopPropagation(),m.preventDefault&&m.preventDefault()}var va="storagemutated",js="x-storagemutated-1",En=vr(null,va),Tl=(Hn.prototype._lock=function(){return j(!Ft.global),++this._reculock,this._reculock!==1||Ft.global||(Ft.lockOwnerFor=this),this},Hn.prototype._unlock=function(){if(j(!Ft.global),--this._reculock==0)for(Ft.global||(Ft.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var m=this._blockedFuncs.shift();try{fi(m[1],m[0])}catch{}}return this},Hn.prototype._locked=function(){return this._reculock&&Ft.lockOwnerFor!==this},Hn.prototype.create=function(m){var v=this;if(this.mode){var x=this.db.idbdb,E=this.db._state.dbOpenError;if(j(!this.idbtrans),!m&&!x)switch(E&&E.name){case"DatabaseClosedError":throw new kt.DatabaseClosed(E);case"MissingAPIError":throw new kt.MissingAPI(E.message,E);default:throw new kt.OpenFailed(E)}if(!this.active)throw new kt.TransactionInactive;j(this._completion._state===null),(m=this.idbtrans=m||(this.db.core||x).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ie(function(R){Bs(R),v._reject(m.error)}),m.onabort=Ie(function(R){Bs(R),v.active&&v._reject(new kt.Abort(m.error)),v.active=!1,v.on("abort").fire(R)}),m.oncomplete=Ie(function(){v.active=!1,v._resolve(),"mutatedParts"in m&&En.storagemutated.fire(m.mutatedParts)})}return this},Hn.prototype._promise=function(m,v,x){var E,R=this;return m==="readwrite"&&this.mode!=="readwrite"?ke(new kt.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Nt(function(O,P){R._blockedFuncs.push([function(){R._promise(m,v,x).then(O,P)},Ft])}):x?ze(function(){var O=new Nt(function(P,B){R._lock();var $=v(P,B,R);$&&$.then&&$.then(P,B)});return O.finally(function(){return R._unlock()}),O._lib=!0,O}):((E=new Nt(function(O,P){var B=v(O,P,R);B&&B.then&&B.then(O,P)}))._lib=!0,E):ke(new kt.TransactionInactive)},Hn.prototype._root=function(){return this.parent?this.parent._root():this},Hn.prototype.waitFor=function(m){var v,x=this._root(),E=Nt.resolve(m),R=(x._waitingFor?x._waitingFor=x._waitingFor.then(function(){return E}):(x._waitingFor=E,x._waitingQueue=[],v=x.idbtrans.objectStore(x.storeNames[0]),(function O(){for(++x._spinCount;x._waitingQueue.length;)x._waitingQueue.shift()();x._waitingFor&&(v.get(-1/0).onsuccess=O)})()),x._waitingFor);return new Nt(function(O,P){E.then(function(B){return x._waitingQueue.push(Ie(O.bind(null,B)))},function(B){return x._waitingQueue.push(Ie(P.bind(null,B)))}).finally(function(){x._waitingFor===R&&(x._waitingFor=null)})})},Hn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new kt.Abort))},Hn.prototype.table=function(m){var v=this._memoizedTables||(this._memoizedTables={});if(y(v,m))return v[m];var x=this.schema[m];if(x)return(x=new this.db.Table(m,x,this)).core=this.db.core.table(m),v[m]=x;throw new kt.NotFound("Table "+m+" not part of transaction")},Hn);function Hn(){}function Di(m,v,x,E,R,O,P,B){return{name:m,keyPath:v,unique:x,multi:E,auto:R,compound:O,src:(x&&!P?"&":"")+(E?"*":"")+(R?"++":"")+lo(v),type:B}}function lo(m){return typeof m=="string"?m:m?"["+[].join.call(m,"+")+"]":""}function wa(m,v,x){return{name:m,primKey:v,indexes:x,mappedClass:null,idxByName:(E=function(R){return[R.name,R]},x.reduce(function(R,O,P){return O=E(O,P),O&&(R[O[0]]=O[1]),R},{}))};var E}var xa=function(m){try{return m.only([[]]),xa=function(){return[[]]},[[]]}catch{return xa=function(){return pi},pi}};function Aa(m){return m==null?function(){}:typeof m=="string"?(v=m).split(".").length===1?function(x){return x[v]}:function(x){return z(x,v)}:function(x){return z(x,m)};var v}function Ar(m){return[].slice.call(m)}var au=0;function un(m){return m==null?":id":typeof m=="string"?m:"[".concat(m.join("+"),"]")}function Fs(m,v,$){function E(X){if(X.type===3)return null;if(X.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var V=X.lower,Q=X.upper,Z=X.lowerOpen,X=X.upperOpen;return V===void 0?Q===void 0?null:v.upperBound(Q,!!X):Q===void 0?v.lowerBound(V,!!Z):v.bound(V,Q,!!Z,!!X)}function R(K){var V,Q=K.name;return{name:Q,schema:K,mutate:function(Z){var X=Z.trans,Y=Z.type,it=Z.keys,ot=Z.values,nt=Z.range;return new Promise(function(gt,At){gt=Ie(gt);var Mt=X.objectStore(Q),Dt=Mt.keyPath==null,St=Y==="put"||Y==="add";if(!St&&Y!=="delete"&&Y!=="deleteRange")throw new Error("Invalid operation type: "+Y);var zt,Pt=(it||ot||{length:1}).length;if(it&&ot&&it.length!==ot.length)throw new Error("Given keys array must have same length as given values array.");if(Pt===0)return gt({numFailures:0,failures:{},results:[],lastResult:void 0});function Et(De){++ue,Bs(De)}var Ht=[],ee=[],ue=0;if(Y==="deleteRange"){if(nt.type===4)return gt({numFailures:ue,failures:ee,results:[],lastResult:void 0});nt.type===3?Ht.push(zt=Mt.clear()):Ht.push(zt=Mt.delete(E(nt)))}else{var Dt=St?Dt?[ot,it]:[ot,null]:[it,null],Yt=Dt[0],se=Dt[1];if(St)for(var Le=0;Le<Pt;++Le)Ht.push(zt=se&&se[Le]!==void 0?Mt[Y](Yt[Le],se[Le]):Mt[Y](Yt[Le])),zt.onerror=Et;else for(Le=0;Le<Pt;++Le)Ht.push(zt=Mt[Y](Yt[Le])),zt.onerror=Et}function Gn(De){De=De.target.result,Ht.forEach(function(fs,Ra){return fs.error!=null&&(ee[Ra]=fs.error)}),gt({numFailures:ue,failures:ee,results:Y==="delete"?it:Ht.map(function(fs){return fs.result}),lastResult:De})}zt.onerror=function(De){Et(De),Gn(De)},zt.onsuccess=Gn})},getMany:function(Z){var X=Z.trans,Y=Z.keys;return new Promise(function(it,ot){it=Ie(it);for(var nt,gt=X.objectStore(Q),At=Y.length,Mt=new Array(At),Dt=0,St=0,zt=function(Ht){Ht=Ht.target,Mt[Ht._pos]=Ht.result,++St===Dt&&it(Mt)},Pt=mi(ot),Et=0;Et<At;++Et)Y[Et]!=null&&((nt=gt.get(Y[Et]))._pos=Et,nt.onsuccess=zt,nt.onerror=Pt,++Dt);Dt===0&&it(Mt)})},get:function(Z){var X=Z.trans,Y=Z.key;return new Promise(function(it,ot){it=Ie(it);var nt=X.objectStore(Q).get(Y);nt.onsuccess=function(gt){return it(gt.target.result)},nt.onerror=mi(ot)})},query:(V=B,function(Z){return new Promise(function(X,Y){X=Ie(X);var it,ot,nt,St=Z.trans,gt=Z.values,At=Z.limit,Dt=Z.query,Mt=At===1/0?void 0:At,zt=Dt.index,Dt=Dt.range,St=St.objectStore(Q),St=zt.isPrimaryKey?St:St.index(zt.name),zt=E(Dt);if(At===0)return X({result:[]});V?((Dt=gt?St.getAll(zt,Mt):St.getAllKeys(zt,Mt)).onsuccess=function(Pt){return X({result:Pt.target.result})},Dt.onerror=mi(Y)):(it=0,ot=!gt&&"openKeyCursor"in St?St.openKeyCursor(zt):St.openCursor(zt),nt=[],ot.onsuccess=function(Pt){var Et=ot.result;return!Et||(nt.push(gt?Et.value:Et.primaryKey),++it===At)?X({result:nt}):void Et.continue()},ot.onerror=mi(Y))})}),openCursor:function(Z){var X=Z.trans,Y=Z.values,it=Z.query,ot=Z.reverse,nt=Z.unique;return new Promise(function(gt,At){gt=Ie(gt);var St=it.index,Mt=it.range,Dt=X.objectStore(Q),Dt=St.isPrimaryKey?Dt:Dt.index(St.name),St=ot?nt?"prevunique":"prev":nt?"nextunique":"next",zt=!Y&&"openKeyCursor"in Dt?Dt.openKeyCursor(E(Mt),St):Dt.openCursor(E(Mt),St);zt.onerror=mi(At),zt.onsuccess=Ie(function(Pt){var Et,Ht,ee,ue,Yt=zt.result;Yt?(Yt.___id=++au,Yt.done=!1,Et=Yt.continue.bind(Yt),Ht=(Ht=Yt.continuePrimaryKey)&&Ht.bind(Yt),ee=Yt.advance.bind(Yt),ue=function(){throw new Error("Cursor not stopped")},Yt.trans=X,Yt.stop=Yt.continue=Yt.continuePrimaryKey=Yt.advance=function(){throw new Error("Cursor not started")},Yt.fail=Ie(At),Yt.next=function(){var se=this,Le=1;return this.start(function(){return Le--?se.continue():se.stop()}).then(function(){return se})},Yt.start=function(se){function Le(){if(zt.result)try{se()}catch(De){Yt.fail(De)}else Yt.done=!0,Yt.start=function(){throw new Error("Cursor behind last entry")},Yt.stop()}var Gn=new Promise(function(De,fs){De=Ie(De),zt.onerror=mi(fs),Yt.fail=fs,Yt.stop=function(Ra){Yt.stop=Yt.continue=Yt.continuePrimaryKey=Yt.advance=ue,De(Ra)}});return zt.onsuccess=Ie(function(De){zt.onsuccess=Le,Le()}),Yt.continue=Et,Yt.continuePrimaryKey=Ht,Yt.advance=ee,Le(),Gn},gt(Yt)):gt(null)},At)})},count:function(Z){var X=Z.query,Y=Z.trans,it=X.index,ot=X.range;return new Promise(function(nt,gt){var At=Y.objectStore(Q),At=it.isPrimaryKey?At:At.index(it.name),Mt=E(ot),Mt=Mt?At.count(Mt):At.count();Mt.onsuccess=Ie(function(Dt){return nt(Dt.target.result)}),Mt.onerror=mi(gt)})}}}O=$,P=Ar(($=m).objectStoreNames);var O,$={schema:{name:$.name,tables:P.map(function(K){return O.objectStore(K)}).map(function(K){var V=K.keyPath,Q=K.autoIncrement,X=u(V),Z={},X={name:K.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:V==null,compound:X,keyPath:V,autoIncrement:Q,unique:!0,extractKey:Aa(V)},indexes:Ar(K.indexNames).map(function(Y){return K.index(Y)}).map(function(nt){var gt=nt.name,it=nt.unique,ot=nt.multiEntry,nt=nt.keyPath,gt={name:gt,compound:u(nt),keyPath:nt,unique:it,multiEntry:ot,extractKey:Aa(nt)};return Z[un(nt)]=gt}),getIndexByKeyPath:function(Y){return Z[un(Y)]}};return Z[":id"]=X.primaryKey,V!=null&&(Z[un(V)]=X.primaryKey),X})},hasGetAll:0<P.length&&"getAll"in O.objectStore(P[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},P=$.schema,B=$.hasGetAll,$=P.tables.map(R),et={};return $.forEach(function(K){return et[K.name]=K}),{stack:"dbcore",transaction:m.transaction.bind(m),table:function(K){if(et[K])return et[K];throw new Error("Table '".concat(K,"' not found"))},MIN_KEY:-1/0,MAX_KEY:xa(v),schema:P}}function co(m,v,x,E){return x=x.IDBKeyRange,v=Fs(v,x,E),{dbcore:m.dbcore.reduce(function(R,O){return O=O.create,i(i({},R),O(R))},v)}}function us(m,v){var x=v.db,x=co(m._middlewares,x,m._deps,v);m.core=x.dbcore,m.tables.forEach(function(E){var R=E.name;m.core.schema.tables.some(function(O){return O.name===R})&&(E.core=m.core.table(R),m[R]instanceof m.Table)&&(m[R].core=E.core)})}function uo(m,v,x,E){x.forEach(function(R){var O=E[R];v.forEach(function(P){var B=(function $(et,K){return C(et,K)||(et=f(et))&&$(et,K)})(P,R);(!B||"value"in B&&B.value===void 0)&&(P===m.Transaction.prototype||P instanceof m.Transaction?_(P,R,{get:function(){return this.table(R)},set:function($){A(this,R,{value:$,writable:!0,configurable:!0,enumerable:!0})}}):P[R]=new m.Table(R,O))})})}function Sr(m,v){v.forEach(function(x){for(var E in x)x[E]instanceof m.Table&&delete x[E]})}function Rl(m,v){return m._cfg.version-v._cfg.version}function Er(m,v,x,E){var R=m._dbSchema,O=(x.objectStoreNames.contains("$meta")&&!R.$meta&&(R.$meta=wa("$meta",ou("")[0],[]),m._storeNames.push("$meta")),m._createTransaction("readwrite",m._storeNames,R)),P=(O.create(x),O._completion.catch(E),O._reject.bind(O)),B=Ft.transless||Ft;ze(function(){if(Ft.trans=O,Ft.transless=B,v!==0)return us(m,x),et=v,(($=O).storeNames.includes("$meta")?$.table("$meta").get("version").then(function(K){return K??et}):Nt.resolve(et)).then(function(it){var V=m,Q=it,Z=O,X=x,Y=[],it=V._versions,ot=V._dbSchema=Sa(0,V.idbdb,X);return(it=it.filter(function(nt){return nt._cfg.version>=Q})).length===0?Nt.resolve():(it.forEach(function(nt){Y.push(function(){var gt,At,Mt,Dt=ot,St=nt._cfg.dbschema,zt=(mo(V,Dt,X),mo(V,St,X),ot=V._dbSchema=St,fo(Dt,St)),Pt=(zt.add.forEach(function(Et){Ml(X,Et[0],Et[1].primKey,Et[1].indexes)}),zt.change.forEach(function(Et){if(Et.recreate)throw new kt.Upgrade("Not yet support for changing primary key");var Ht=X.objectStore(Et.name);Et.add.forEach(function(ee){return po(Ht,ee)}),Et.change.forEach(function(ee){Ht.deleteIndex(ee.name),po(Ht,ee)}),Et.del.forEach(function(ee){return Ht.deleteIndex(ee)})}),nt._cfg.contentUpgrade);if(Pt&&nt._cfg.version>Q)return us(V,X),Z._memoizedTables={},gt=ut(St),zt.del.forEach(function(Et){gt[Et]=Dt[Et]}),Sr(V,[V.Transaction.prototype]),uo(V,[V.Transaction.prototype],c(gt),gt),Z.schema=gt,(At=U(Pt))&&sn(),St=Nt.follow(function(){var Et;(Mt=Pt(Z))&&At&&(Et=Xn.bind(null,null),Mt.then(Et,Et))}),Mt&&typeof Mt.then=="function"?Nt.resolve(Mt):St.then(function(){return Mt})}),Y.push(function(gt){var At,Mt,Dt=nt._cfg.dbschema;At=Dt,Mt=gt,[].slice.call(Mt.db.objectStoreNames).forEach(function(St){return At[St]==null&&Mt.db.deleteObjectStore(St)}),Sr(V,[V.Transaction.prototype]),uo(V,[V.Transaction.prototype],V._storeNames,V._dbSchema),Z.schema=V._dbSchema}),Y.push(function(gt){V.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(V.idbdb.version/10)===nt._cfg.version?(V.idbdb.deleteObjectStore("$meta"),delete V._dbSchema.$meta,V._storeNames=V._storeNames.filter(function(At){return At!=="$meta"})):gt.objectStore("$meta").put(nt._cfg.version,"version"))})}),(function nt(){return Y.length?Nt.resolve(Y.shift()(Z.idbtrans)).then(nt):Nt.resolve()})().then(function(){ru(ot,X)}))}).catch(P);var $,et;c(R).forEach(function(K){Ml(x,K,R[K].primKey,R[K].indexes)}),us(m,x),Nt.follow(function(){return m.on.populate.fire(O)}).catch(P)})}function ho(m,v){ru(m._dbSchema,v),v.db.version%10!=0||v.objectStoreNames.contains("$meta")||v.db.createObjectStore("$meta").add(Math.ceil(v.db.version/10-1),"version");var x=Sa(0,m.idbdb,v);mo(m,m._dbSchema,v);for(var E=0,R=fo(x,m._dbSchema).change;E<R.length;E++){var O=(P=>{if(P.change.length||P.recreate)return console.warn("Unable to patch indexes of table ".concat(P.name," because it has changes on the type of index or primary key.")),{value:void 0};var B=v.objectStore(P.name);P.add.forEach(function($){ti&&console.debug("Dexie upgrade patch: Creating missing index ".concat(P.name,".").concat($.src)),po(B,$)})})(R[E]);if(typeof O=="object")return O.value}}function fo(m,v){var x,E={del:[],add:[],change:[]};for(x in m)v[x]||E.del.push(x);for(x in v){var R=m[x],O=v[x];if(R){var P={name:x,def:O,recreate:!1,del:[],add:[],change:[]};if(""+(R.primKey.keyPath||"")!=""+(O.primKey.keyPath||"")||R.primKey.auto!==O.primKey.auto)P.recreate=!0,E.change.push(P);else{var B=R.idxByName,$=O.idxByName,et=void 0;for(et in B)$[et]||P.del.push(et);for(et in $){var K=B[et],V=$[et];K?K.src!==V.src&&P.change.push(V):P.add.push(V)}(0<P.del.length||0<P.add.length||0<P.change.length)&&E.change.push(P)}}else E.add.push([x,O])}return E}function Ml(m,v,x,E){var R=m.db.createObjectStore(v,x.keyPath?{keyPath:x.keyPath,autoIncrement:x.auto}:{autoIncrement:x.auto});E.forEach(function(O){return po(R,O)})}function ru(m,v){c(m).forEach(function(x){v.db.objectStoreNames.contains(x)||(ti&&console.debug("Dexie: Creating missing table",x),Ml(v,x,m[x].primKey,m[x].indexes))})}function po(m,v){m.createIndex(v.name,v.keyPath,{unique:v.unique,multiEntry:v.multi})}function Sa(m,v,x){var E={};return N(v.objectStoreNames,0).forEach(function(R){for(var O=x.objectStore(R),P=Di(lo(et=O.keyPath),et||"",!0,!1,!!O.autoIncrement,et&&typeof et!="string",!0),B=[],$=0;$<O.indexNames.length;++$){var K=O.index(O.indexNames[$]),et=K.keyPath,K=Di(K.name,et,!!K.unique,!!K.multiEntry,!1,et&&typeof et!="string",!1);B.push(K)}E[R]=wa(R,P,B)}),E}function mo(m,v,x){for(var E=x.db.objectStoreNames,R=0;R<E.length;++R){var O=E[R],P=x.objectStore(O);m._hasGetAll="getAll"in P;for(var B=0;B<P.indexNames.length;++B){var $,et=P.indexNames[B],K=P.index(et).keyPath,K=typeof K=="string"?K:"["+N(K).join("+")+"]";v[O]&&($=v[O].idxByName[K])&&($.name=et,delete v[O].idxByName[K],v[O].idxByName[et]=$)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(m._hasGetAll=!1)}function ou(m){return m.split(",").map(function(v,x){var R=v.split(":"),E=(E=R[1])==null?void 0:E.trim(),R=(v=R[0].trim()).replace(/([&*]|\+\+)/g,""),O=/^\[/.test(R)?R.match(/^\[(.*)\]$/)[1].split("+"):R;return Di(R,O||null,/\&/.test(v),/\*/.test(v),/\+\+/.test(v),u(O),x===0,E)})}Ea.prototype._createTableSchema=wa,Ea.prototype._parseIndexSyntax=ou,Ea.prototype._parseStoresSpec=function(m,v){var x=this;c(m).forEach(function(E){if(m[E]!==null){var R=x._parseIndexSyntax(m[E]),O=R.shift();if(!O)throw new kt.Schema("Invalid schema for table "+E+": "+m[E]);if(O.unique=!0,O.multi)throw new kt.Schema("Primary key cannot be multiEntry*");R.forEach(function(P){if(P.auto)throw new kt.Schema("Only primary key can be marked as autoIncrement (++)");if(!P.keyPath)throw new kt.Schema("Index must have a name and cannot be an empty string")}),O=x._createTableSchema(E,O,R),v[E]=O}})},Ea.prototype.stores=function(x){var v=this.db,x=(this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,x):x,v._versions),E={},R={};return x.forEach(function(O){d(E,O._cfg.storesSource),R=O._cfg.dbschema={},O._parseStoresSpec(E,R)}),v._dbSchema=R,Sr(v,[v._allTables,v,v.Transaction.prototype]),uo(v,[v._allTables,v,v.Transaction.prototype,this._cfg.tables],c(R),R),v._storeNames=c(R),this},Ea.prototype.upgrade=function(m){return this._cfg.contentUpgrade=rr(this._cfg.contentUpgrade||pt,m),this};var Ad=Ea;function Ea(){}function Dl(m,v){var x=m._dbNamesDB;return x||(x=m._dbNamesDB=new Oi(gr,{addons:[],indexedDB:m,IDBKeyRange:v})).version(1).stores({dbnames:"name"}),x.table("dbnames")}function go(m){return m&&typeof m.databases=="function"}function Ol(m){return ze(function(){return Ft.letThrough=!0,m()})}function Nl(m){return!("from"in m)}var _n=function(m,v){var x;if(!this)return x=new _n,m&&"d"in m&&d(x,m),x;d(this,arguments.length?{d:1,from:m,to:1<arguments.length?v:m}:{d:0})};function _r(m,v,x){var E=ce(v,x);if(!isNaN(E)){if(0<E)throw RangeError();if(Nl(m))return d(m,{from:v,to:x,d:1});var E=m.l,R=m.r;if(ce(x,m.from)<0)return E?_r(E,v,x):m.l={from:v,to:x,d:1,l:null,r:null},cu(m);if(0<ce(v,m.to))return R?_r(R,v,x):m.r={from:v,to:x,d:1,l:null,r:null},cu(m);ce(v,m.from)<0&&(m.from=v,m.l=null,m.d=R?R.d+1:1),0<ce(x,m.to)&&(m.to=x,m.r=null,m.d=m.l?m.l.d+1:1),v=!m.r,E&&!m.l&&Is(m,E),R&&v&&Is(m,R)}}function Is(m,v){Nl(v)||(function x(E,R){var O=R.from,P=R.l,B=R.r;_r(E,O,R.to),P&&x(E,P),B&&x(E,B)})(m,v)}function lu(m,v){var x=yo(v),E=x.next();if(!E.done)for(var R=E.value,O=yo(m),P=O.next(R.from),B=P.value;!E.done&&!P.done;){if(ce(B.from,R.to)<=0&&0<=ce(B.to,R.from))return!0;ce(R.from,B.from)<0?R=(E=x.next(B.from)).value:B=(P=O.next(R.from)).value}return!1}function yo(m){var v=Nl(m)?null:{s:0,n:m};return{next:function(x){for(var E=0<arguments.length;v;)switch(v.s){case 0:if(v.s=1,E)for(;v.n.l&&ce(x,v.n.from)<0;)v={up:v,n:v.n.l,s:1};else for(;v.n.l;)v={up:v,n:v.n.l,s:1};case 1:if(v.s=2,!E||ce(x,v.n.to)<=0)return{value:v.n,done:!1};case 2:if(v.n.r){v.s=3,v={up:v,n:v.n.r,s:0};continue}case 3:v=v.up}return{done:!0}}}}function cu(m){var v,x,E,R=(((R=m.r)==null?void 0:R.d)||0)-(((R=m.l)==null?void 0:R.d)||0),R=1<R?"r":R<-1?"l":"";R&&(v=R=="r"?"l":"r",x=i({},m),E=m[R],m.from=E.from,m.to=E.to,m[R]=E[R],x[R]=E[v],(m[v]=x).d=kl(x)),m.d=kl(m)}function kl(x){var v=x.r,x=x.l;return(v?x?Math.max(v.d,x.d):v.d:x?x.d:0)+1}function bo(m,v){return c(v).forEach(function(x){m[x]?Is(m[x],v[x]):m[x]=(function E(R){var O,P,B={};for(O in R)y(R,O)&&(P=R[O],B[O]=!P||typeof P!="object"||ct.has(P.constructor)?P:E(P));return B})(v[x])}),m}function Ll(m,v){return m.all||v.all||Object.keys(m).some(function(x){return v[x]&&lu(v[x],m[x])})}w(_n.prototype,((Un={add:function(m){return Is(this,m),this},addKey:function(m){return _r(this,m,m),this},addKeys:function(m){var v=this;return m.forEach(function(x){return _r(v,x,x)}),this},hasKey:function(m){var v=yo(this).next(m).value;return v&&ce(v.from,m)<=0&&0<=ce(v.to,m)}})[G]=function(){return yo(this)},Un));var Us={},Pl={},Bl=!1;function vo(m){bo(Pl,m),Bl||(Bl=!0,setTimeout(function(){Bl=!1,jl(Pl,!(Pl={}))},0))}function jl(m,v){v===void 0&&(v=!1);var x=new Set;if(m.all)for(var E=0,R=Object.values(Us);E<R.length;E++)uu(B=R[E],m,x,v);else for(var O in m){var P,B,O=/^idb\:\/\/(.*)\/(.*)\//.exec(O);O&&(P=O[1],O=O[2],B=Us["idb://".concat(P,"/").concat(O)])&&uu(B,m,x,v)}x.forEach(function($){return $()})}function uu(m,v,x,E){for(var R=[],O=0,P=Object.entries(m.queries.query);O<P.length;O++){for(var B=P[O],$=B[0],et=[],K=0,V=B[1];K<V.length;K++){var Q=V[K];Ll(v,Q.obsSet)?Q.subscribers.forEach(function(it){return x.add(it)}):E&&et.push(Q)}E&&R.push([$,et])}if(E)for(var Z=0,X=R;Z<X.length;Z++){var Y=X[Z],$=Y[0],et=Y[1];m.queries.query[$]=et}}function Sd(m){var v=m._state,x=m._deps.indexedDB;if(v.isBeingOpened||m.idbdb)return v.dbReadyPromise.then(function(){return v.dbOpenError?ke(v.dbOpenError):m});v.isBeingOpened=!0,v.dbOpenError=null,v.openComplete=!1;var E=v.openCanceller,R=Math.round(10*m.verno),O=!1;function P(){if(v.openCanceller!==E)throw new kt.DatabaseClosed("db.open() was cancelled")}function B(){return new Nt(function(Q,Z){if(P(),!x)throw new kt.MissingAPI;var X=m.name,Y=v.autoSchema||!R?x.open(X):x.open(X,R);if(!Y)throw new kt.MissingAPI;Y.onerror=mi(Z),Y.onblocked=Ie(m._fireOnBlocked),Y.onupgradeneeded=Ie(function(it){var ot;K=Y.transaction,v.autoSchema&&!m._options.allowEmptyDB?(Y.onerror=Bs,K.abort(),Y.result.close(),(ot=x.deleteDatabase(X)).onsuccess=ot.onerror=Ie(function(){Z(new kt.NoSuchDatabase("Database ".concat(X," doesnt exist")))})):(K.onerror=mi(Z),ot=it.oldVersion>Math.pow(2,62)?0:it.oldVersion,V=ot<1,m.idbdb=Y.result,O&&ho(m,K),Er(m,ot/10,K,Z))},Z),Y.onsuccess=Ie(function(){K=null;var it,ot,nt,gt,At,Mt,Dt=m.idbdb=Y.result,St=N(Dt.objectStoreNames);if(0<St.length)try{var zt=Dt.transaction((At=St).length===1?At[0]:At,"readonly");if(v.autoSchema)Mt=Dt,gt=zt,(nt=m).verno=Mt.version/10,gt=nt._dbSchema=Sa(0,Mt,gt),nt._storeNames=N(Mt.objectStoreNames,0),uo(nt,[nt._allTables],c(gt),gt);else if(mo(m,m._dbSchema,zt),ot=zt,((ot=fo(Sa(0,(it=m).idbdb,ot),it._dbSchema)).add.length||ot.change.some(function(Pt){return Pt.add.length||Pt.change.length}))&&!O)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Dt.close(),R=Dt.version+1,O=!0,Q(B());us(m,zt)}catch{}Ns.push(m),Dt.onversionchange=Ie(function(Pt){v.vcFired=!0,m.on("versionchange").fire(Pt)}),Dt.onclose=Ie(function(){m.close({disableAutoOpen:!1})}),V&&(St=m._deps,At=X,go(Mt=St.indexedDB)||At===gr||Dl(Mt,St.IDBKeyRange).put({name:At}).catch(pt)),Q()},Z)}).catch(function(Q){switch(Q?.name){case"UnknownError":if(0<v.PR1398_maxLoop)return v.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),B();break;case"VersionError":if(0<R)return R=0,B()}return Nt.reject(Q)})}var $,et=v.dbReadyResolve,K=null,V=!1;return Nt.race([E,(typeof navigator>"u"?Nt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function Z(){return indexedDB.databases().finally(Q)}$=setInterval(Z,100),Z()}).finally(function(){return clearInterval($)}):Promise.resolve()).then(B)]).then(function(){return P(),v.onReadyBeingFired=[],Nt.resolve(Ol(function(){return m.on.ready.fire(m.vip)})).then(function Q(){var Z;if(0<v.onReadyBeingFired.length)return Z=v.onReadyBeingFired.reduce(rr,pt),v.onReadyBeingFired=[],Nt.resolve(Ol(function(){return Z(m.vip)})).then(Q)})}).finally(function(){v.openCanceller===E&&(v.onReadyBeingFired=null,v.isBeingOpened=!1)}).catch(function(Q){v.dbOpenError=Q;try{K&&K.abort()}catch{}return E===v.openCanceller&&m._close(),ke(Q)}).finally(function(){v.openComplete=!0,et()}).then(function(){var Q;return V&&(Q={},m.tables.forEach(function(Z){Z.schema.indexes.forEach(function(X){X.name&&(Q["idb://".concat(m.name,"/").concat(Z.name,"/").concat(X.name)]=new _n(-1/0,[[[]]]))}),Q["idb://".concat(m.name,"/").concat(Z.name,"/")]=Q["idb://".concat(m.name,"/").concat(Z.name,"/:dels")]=new _n(-1/0,[[[]]])}),En(va).fire(Q),jl(Q,!0)),m})}function Cr(m){function v(O){return m.next(O)}var x=R(v),E=R(function(O){return m.throw(O)});function R(O){return function(B){var B=O(B),$=B.value;return B.done?$:$&&typeof $.then=="function"?$.then(x,E):u($)?Promise.all($).then(x,E):x($)}}return R(v)()}function hs(m,v,x){for(var E=u(m)?m.slice():[m],R=0;R<x;++R)E.push(v);return E}var Ed={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(m){return i(i({},m),{table:function(E){var x=m.table(E),E=x.schema,R={},O=[];function P(Q,Z,X){var nt=un(Q),Y=R[nt]=R[nt]||[],it=Q==null?0:typeof Q=="string"?1:Q.length,ot=0<Z,nt=i(i({},X),{name:ot?"".concat(nt,"(virtual-from:").concat(X.name,")"):X.name,lowLevelIndex:X,isVirtual:ot,keyTail:Z,keyLength:it,extractKey:Aa(Q),unique:!ot&&X.unique});return Y.push(nt),nt.isPrimaryKey||O.push(nt),1<it&&P(it===2?Q[0]:Q.slice(0,it-1),Z+1,X),Y.sort(function(gt,At){return gt.keyTail-At.keyTail}),nt}var B=P(E.primaryKey.keyPath,0,E.primaryKey);R[":id"]=[B];for(var $=0,et=E.indexes;$<et.length;$++){var K=et[$];P(K.keyPath,0,K)}function V(Q){var Z,X=Q.query.index;return X.isVirtual?i(i({},Q),{query:{index:X.lowLevelIndex,range:(Z=Q.query.range,X=X.keyTail,{type:Z.type===1?2:Z.type,lower:hs(Z.lower,Z.lowerOpen?m.MAX_KEY:m.MIN_KEY,X),lowerOpen:!0,upper:hs(Z.upper,Z.upperOpen?m.MIN_KEY:m.MAX_KEY,X),upperOpen:!0})}}):Q}return i(i({},x),{schema:i(i({},E),{primaryKey:B,indexes:O,getIndexByKeyPath:function(Q){return(Q=R[un(Q)])&&Q[0]}}),count:function(Q){return x.count(V(Q))},query:function(Q){return x.query(V(Q))},openCursor:function(Q){var Z=Q.query.index,X=Z.keyTail,Y=Z.keyLength;return Z.isVirtual?x.openCursor(V(Q)).then(function(ot){return ot&&it(ot)}):x.openCursor(Q);function it(ot){return Object.create(ot,{continue:{value:function(nt){nt!=null?ot.continue(hs(nt,Q.reverse?m.MAX_KEY:m.MIN_KEY,X)):Q.unique?ot.continue(ot.key.slice(0,Y).concat(Q.reverse?m.MIN_KEY:m.MAX_KEY,X)):ot.continue()}},continuePrimaryKey:{value:function(nt,gt){ot.continuePrimaryKey(hs(nt,m.MAX_KEY,X),gt)}},primaryKey:{get:function(){return ot.primaryKey}},key:{get:function(){var nt=ot.key;return Y===1?nt[0]:nt.slice(0,Y)}},value:{get:function(){return ot.value}}})}}})}})}};function wo(m,v,x,E){return x=x||{},E=E||"",c(m).forEach(function(R){var O,P,B;y(v,R)?(O=m[R],P=v[R],typeof O=="object"&&typeof P=="object"&&O&&P?(B=$t(O))!==$t(P)?x[E+R]=v[R]:B==="Object"?wo(O,P,x,E+R+"."):O!==P&&(x[E+R]=v[R]):O!==P&&(x[E+R]=v[R])):x[E+R]=void 0}),c(v).forEach(function(R){y(m,R)||(x[E+R]=v[R])}),x}function xo(m,v){return v.type==="delete"?v.keys:v.keys||v.values.map(m.extractKey)}var hu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(m){return i(i({},m),{table:function(v){var x=m.table(v),E=x.schema.primaryKey;return i(i({},x),{mutate:function(R){var O=Ft.trans,P=O.table(v).hook,B=P.deleting,$=P.creating,et=P.updating;switch(R.type){case"add":if($.fire===pt)break;return O._promise("readwrite",function(){return K(R)},!0);case"put":if($.fire===pt&&et.fire===pt)break;return O._promise("readwrite",function(){return K(R)},!0);case"delete":if(B.fire===pt)break;return O._promise("readwrite",function(){return K(R)},!0);case"deleteRange":if(B.fire===pt)break;return O._promise("readwrite",function(){return(function V(Q,Z,X){return x.query({trans:Q,values:!1,query:{index:E,range:Z},limit:X}).then(function(Y){var it=Y.result;return K({type:"delete",keys:it,trans:Q}).then(function(ot){return 0<ot.numFailures?Promise.reject(ot.failures[0]):it.length<X?{failures:[],numFailures:0,lastResult:void 0}:V(Q,i(i({},Z),{lower:it[it.length-1],lowerOpen:!0}),X)})})})(R.trans,R.range,1e4)},!0)}return x.mutate(R);function K(V){var Q,Z,X,Y=Ft.trans,it=V.keys||xo(E,V);if(it)return(V=V.type==="add"||V.type==="put"?i(i({},V),{keys:it}):i({},V)).type!=="delete"&&(V.values=a([],V.values)),V.keys&&(V.keys=a([],V.keys)),Q=x,X=it,((Z=V).type==="add"?Promise.resolve([]):Q.getMany({trans:Z.trans,keys:X,cache:"immutable"})).then(function(ot){var nt=it.map(function(gt,At){var Mt,Dt,St,zt=ot[At],Pt={onerror:null,onsuccess:null};return V.type==="delete"?B.fire.call(Pt,gt,zt,Y):V.type==="add"||zt===void 0?(Mt=$.fire.call(Pt,gt,V.values[At],Y),gt==null&&Mt!=null&&(V.keys[At]=gt=Mt,E.outbound||H(V.values[At],E.keyPath,gt))):(Mt=wo(zt,V.values[At]),(Dt=et.fire.call(Pt,Mt,gt,zt,Y))&&(St=V.values[At],Object.keys(Dt).forEach(function(Et){y(St,Et)?St[Et]=Dt[Et]:H(St,Et,Dt[Et])}))),Pt});return x.mutate(V).then(function(gt){for(var At=gt.failures,Mt=gt.results,Dt=gt.numFailures,gt=gt.lastResult,St=0;St<it.length;++St){var zt=(Mt||it)[St],Pt=nt[St];zt==null?Pt.onerror&&Pt.onerror(At[St]):Pt.onsuccess&&Pt.onsuccess(V.type==="put"&&ot[St]?V.values[St]:zt)}return{failures:At,results:Mt,numFailures:Dt,lastResult:gt}}).catch(function(gt){return nt.forEach(function(At){return At.onerror&&At.onerror(gt)}),Promise.reject(gt)})});throw new Error("Keys missing")}}})}})}};function Fl(m,v,x){try{if(!v||v.keys.length<m.length)return null;for(var E=[],R=0,O=0;R<v.keys.length&&O<m.length;++R)ce(v.keys[R],m[O])===0&&(E.push(x?Lt(v.values[R]):v.values[R]),++O);return E.length===m.length?E:null}catch{return null}}var du={stack:"dbcore",level:-1,create:function(m){return{table:function(v){var x=m.table(v);return i(i({},x),{getMany:function(E){var R;return E.cache?(R=Fl(E.keys,E.trans._cache,E.cache==="clone"))?Nt.resolve(R):x.getMany(E).then(function(O){return E.trans._cache={keys:E.keys,values:E.cache==="clone"?Lt(O):O},O}):x.getMany(E)},mutate:function(E){return E.type!=="add"&&(E.trans._cache=null),x.mutate(E)}})}}}};function zs(m,v){return m.trans.mode==="readonly"&&!!m.subscr&&!m.trans.explicit&&m.trans.db._options.cache!=="disabled"&&!v.schema.primaryKey.outbound}function fu(m,v){switch(m){case"query":return v.values&&!v.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var _d={stack:"dbcore",level:0,name:"Observability",create:function(m){var v=m.schema.name,x=new _n(m.MIN_KEY,m.MAX_KEY);return i(i({},m),{transaction:function(E,R,O){if(Ft.subscr&&R!=="readonly")throw new kt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ft.querier));return m.transaction(E,R,O)},table:function(E){function R(it){var Y,it=it.query;return[Y=it.index,new _n((Y=(it=it.range).lower)!=null?Y:m.MIN_KEY,(Y=it.upper)!=null?Y:m.MAX_KEY)]}var O=m.table(E),P=O.schema,B=P.primaryKey,$=P.indexes,et=B.extractKey,K=B.outbound,V=B.autoIncrement&&$.filter(function(X){return X.compound&&X.keyPath.includes(B.keyPath)}),Q=i(i({},O),{mutate:function(X){function Y(Ht){return Ht="idb://".concat(v,"/").concat(E,"/").concat(Ht),At[Ht]||(At[Ht]=new _n)}var it,ot,nt,gt=X.trans,At=X.mutatedParts||(X.mutatedParts={}),Mt=Y(""),Dt=Y(":dels"),St=X.type,Pt=X.type==="deleteRange"?[X.range]:X.type==="delete"?[X.keys]:X.values.length<50?[xo(B,X).filter(function(Ht){return Ht}),X.values]:[],zt=Pt[0],Pt=Pt[1],Et=X.trans._cache;return u(zt)?(Mt.addKeys(zt),(St=St==="delete"||zt.length===Pt.length?Fl(zt,Et):null)||Dt.addKeys(zt),(St||Pt)&&(it=Y,ot=St,nt=Pt,P.indexes.forEach(function(Ht){var ee=it(Ht.name||"");function ue(se){return se!=null?Ht.extractKey(se):null}function Yt(se){Ht.multiEntry&&u(se)?se.forEach(function(Le){return ee.addKey(Le)}):ee.addKey(se)}(ot||nt).forEach(function(se,De){var Gn=ot&&ue(ot[De]),De=nt&&ue(nt[De]);ce(Gn,De)!==0&&(Gn!=null&&Yt(Gn),De!=null)&&Yt(De)})}))):zt?(Pt={from:(Et=zt.lower)!=null?Et:m.MIN_KEY,to:(St=zt.upper)!=null?St:m.MAX_KEY},Dt.add(Pt),Mt.add(Pt)):(Mt.add(x),Dt.add(x),P.indexes.forEach(function(Ht){return Y(Ht.name).add(x)})),O.mutate(X).then(function(Ht){return!zt||X.type!=="add"&&X.type!=="put"||(Mt.addKeys(Ht.results),V&&V.forEach(function(ee){for(var ue=X.values.map(function(Gn){return ee.extractKey(Gn)}),Yt=ee.keyPath.findIndex(function(Gn){return Gn===B.keyPath}),se=0,Le=Ht.results.length;se<Le;++se)ue[se][Yt]=Ht.results[se];Y(ee.name).addKeys(ue)})),gt.mutatedParts=bo(gt.mutatedParts||{},At),Ht})}}),Z={get:function(X){return[B,new _n(X.key)]},getMany:function(X){return[B,new _n().addKeys(X.keys)]},count:R,query:R,openCursor:R};return c(Z).forEach(function(X){Q[X]=function(Y){var it=Ft.subscr,ot=!!it,nt=zs(Ft,O)&&fu(X,Y)?Y.obsSet={}:it;if(ot){var gt,it=function(Pt){return Pt="idb://".concat(v,"/").concat(E,"/").concat(Pt),nt[Pt]||(nt[Pt]=new _n)},At=it(""),Mt=it(":dels"),ot=Z[X](Y),Dt=ot[0],ot=ot[1];if((X==="query"&&Dt.isPrimaryKey&&!Y.values?Mt:it(Dt.name||"")).add(ot),!Dt.isPrimaryKey){if(X!=="count")return gt=X==="query"&&K&&Y.values&&O.query(i(i({},Y),{values:!1})),O[X].apply(this,arguments).then(function(Pt){if(X==="query"){if(K&&Y.values)return gt.then(function(ue){return ue=ue.result,At.addKeys(ue),Pt});var Et=Y.values?Pt.result.map(et):Pt.result;(Y.values?At:Mt).addKeys(Et)}else{var Ht,ee;if(X==="openCursor")return ee=Y.values,(Ht=Pt)&&Object.create(Ht,{key:{get:function(){return Mt.addKey(Ht.primaryKey),Ht.key}},primaryKey:{get:function(){var ue=Ht.primaryKey;return Mt.addKey(ue),ue}},value:{get:function(){return ee&&At.addKey(Ht.primaryKey),Ht.value}}})}return Pt});Mt.add(x)}}return O[X].apply(this,arguments)}}),Q}})}};function pu(m,v,x){var E;return x.numFailures===0?v:v.type==="deleteRange"||(E=v.keys?v.keys.length:"values"in v&&v.values?v.values.length:1,x.numFailures===E)?null:(E=i({},v),u(E.keys)&&(E.keys=E.keys.filter(function(R,O){return!(O in x.failures)})),"values"in E&&u(E.values)&&(E.values=E.values.filter(function(R,O){return!(O in x.failures)})),E)}function Ao(m,v){return x=m,((E=v).lower===void 0||(E.lowerOpen?0<ce(x,E.lower):0<=ce(x,E.lower)))&&(x=m,(E=v).upper===void 0||(E.upperOpen?ce(x,E.upper)<0:ce(x,E.upper)<=0));var x,E}function Il(m,v,x,E,R,O){var P,B,$,et,K,V;return!x||x.length===0||(P=v.query.index,B=P.multiEntry,$=v.query.range,et=E.schema.primaryKey.extractKey,K=P.extractKey,V=(P.lowLevelIndex||P).extractKey,(E=x.reduce(function(Q,Z){var X=Q,Y=[];if(Z.type==="add"||Z.type==="put")for(var it=new _n,ot=Z.values.length-1;0<=ot;--ot){var nt,gt=Z.values[ot],At=et(gt);!it.hasKey(At)&&(nt=K(gt),B&&u(nt)?nt.some(function(Pt){return Ao(Pt,$)}):Ao(nt,$))&&(it.addKey(At),Y.push(gt))}switch(Z.type){case"add":var Mt=new _n().addKeys(v.values?Q.map(function(Et){return et(Et)}):Q),X=Q.concat(v.values?Y.filter(function(Et){return Et=et(Et),!Mt.hasKey(Et)&&(Mt.addKey(Et),!0)}):Y.map(function(Et){return et(Et)}).filter(function(Et){return!Mt.hasKey(Et)&&(Mt.addKey(Et),!0)}));break;case"put":var Dt=new _n().addKeys(Z.values.map(function(Et){return et(Et)}));X=Q.filter(function(Et){return!Dt.hasKey(v.values?et(Et):Et)}).concat(v.values?Y:Y.map(function(Et){return et(Et)}));break;case"delete":var St=new _n().addKeys(Z.keys);X=Q.filter(function(Et){return!St.hasKey(v.values?et(Et):Et)});break;case"deleteRange":var zt=Z.range;X=Q.filter(function(Et){return!Ao(et(Et),zt)})}return X},m))===m)?m:(E.sort(function(Q,Z){return ce(V(Q),V(Z))||ce(et(Q),et(Z))}),v.limit&&v.limit<1/0&&(E.length>v.limit?E.length=v.limit:m.length===v.limit&&E.length<v.limit&&(R.dirty=!0)),O?Object.freeze(E):E)}function _a(m,v){return ce(m.lower,v.lower)===0&&ce(m.upper,v.upper)===0&&!!m.lowerOpen==!!v.lowerOpen&&!!m.upperOpen==!!v.upperOpen}function Tr(m,v){return((x,E,R,O)=>{if(x===void 0)return E!==void 0?-1:0;if(E===void 0)return 1;if((x=ce(x,E))===0){if(R&&O)return 0;if(R)return 1;if(O)return-1}return x})(m.lower,v.lower,m.lowerOpen,v.lowerOpen)<=0&&0<=((x,E,R,O)=>{if(x===void 0)return E!==void 0?1:0;if(E===void 0)return-1;if((x=ce(x,E))===0){if(R&&O)return 0;if(R)return-1;if(O)return 1}return x})(m.upper,v.upper,m.upperOpen,v.upperOpen)}function Cd(m,v,x,E){m.subscribers.add(x),E.addEventListener("abort",function(){var R,O;m.subscribers.delete(x),m.subscribers.size===0&&(R=m,O=v,setTimeout(function(){R.subscribers.size===0&&wt(O,R)},3e3))})}var So={stack:"dbcore",level:0,name:"Cache",create:function(m){var v=m.schema.name;return i(i({},m),{transaction:function(x,E,R){var O,P,B=m.transaction(x,E,R);return E==="readwrite"&&(R=(O=new AbortController).signal,B.addEventListener("abort",(P=function($){return function(){if(O.abort(),E==="readwrite"){for(var et=new Set,K=0,V=x;K<V.length;K++){var Q=V[K],Z=Us["idb://".concat(v,"/").concat(Q)];if(Z){var X=m.table(Q),Y=Z.optimisticOps.filter(function(Ht){return Ht.trans===B});if(B._explicit&&$&&B.mutatedParts)for(var it=0,ot=Object.values(Z.queries.query);it<ot.length;it++)for(var nt=0,gt=(Dt=ot[it]).slice();nt<gt.length;nt++)Ll((St=gt[nt]).obsSet,B.mutatedParts)&&(wt(Dt,St),St.subscribers.forEach(function(Ht){return et.add(Ht)}));else if(0<Y.length){Z.optimisticOps=Z.optimisticOps.filter(function(Ht){return Ht.trans!==B});for(var At=0,Mt=Object.values(Z.queries.query);At<Mt.length;At++)for(var Dt,St,zt,Pt=0,Et=(Dt=Mt[At]).slice();Pt<Et.length;Pt++)(St=Et[Pt]).res!=null&&B.mutatedParts&&($&&!St.dirty?(zt=Object.isFrozen(St.res),zt=Il(St.res,St.req,Y,X,St,zt),St.dirty?(wt(Dt,St),St.subscribers.forEach(function(Ht){return et.add(Ht)})):zt!==St.res&&(St.res=zt,St.promise=Nt.resolve({result:zt}))):(St.dirty&&wt(Dt,St),St.subscribers.forEach(function(Ht){return et.add(Ht)})))}}}et.forEach(function(Ht){return Ht()})}}})(!1),{signal:R}),B.addEventListener("error",P(!1),{signal:R}),B.addEventListener("complete",P(!0),{signal:R})),B},table:function(x){var E=m.table(x),R=E.schema.primaryKey;return i(i({},E),{mutate:function(O){var P,B=Ft.trans;return!R.outbound&&B.db._options.cache!=="disabled"&&!B.explicit&&B.idbtrans.mode==="readwrite"&&(P=Us["idb://".concat(v,"/").concat(x)])?(B=E.mutate(O),O.type!=="add"&&O.type!=="put"||!(50<=O.values.length||xo(R,O).some(function($){return $==null}))?(P.optimisticOps.push(O),O.mutatedParts&&vo(O.mutatedParts),B.then(function($){0<$.numFailures&&(wt(P.optimisticOps,O),($=pu(0,O,$))&&P.optimisticOps.push($),O.mutatedParts)&&vo(O.mutatedParts)}),B.catch(function(){wt(P.optimisticOps,O),O.mutatedParts&&vo(O.mutatedParts)})):B.then(function($){var et=pu(0,i(i({},O),{values:O.values.map(function(K,V){var Q;return $.failures[V]?K:(H(Q=(Q=R.keyPath)!=null&&Q.includes(".")?Lt(K):i({},K),R.keyPath,$.results[V]),Q)})}),$);P.optimisticOps.push(et),queueMicrotask(function(){return O.mutatedParts&&vo(O.mutatedParts)})}),B):E.mutate(O)},query:function(O){var P,B,$,et,K,V,Q;return zs(Ft,E)&&fu("query",O)?(P=(($=Ft.trans)==null?void 0:$.db._options.cache)==="immutable",B=($=Ft).requery,$=$.signal,V=((Z,X,Y,it)=>{var ot=Us["idb://".concat(Z,"/").concat(X)];if(!ot)return[];if(!(Z=ot.queries[Y]))return[null,!1,ot,null];var nt=Z[(it.query?it.query.index.name:null)||""];if(!nt)return[null,!1,ot,null];switch(Y){case"query":var gt=nt.find(function(At){return At.req.limit===it.limit&&At.req.values===it.values&&_a(At.req.query.range,it.query.range)});return gt?[gt,!0,ot,nt]:[nt.find(function(At){return("limit"in At.req?At.req.limit:1/0)>=it.limit&&(!it.values||At.req.values)&&Tr(At.req.query.range,it.query.range)}),!1,ot,nt];case"count":return gt=nt.find(function(At){return _a(At.req.query.range,it.query.range)}),[gt,!!gt,ot,nt]}})(v,x,"query",O),Q=V[0],et=V[2],K=V[3],Q&&V[1]?Q.obsSet=O.obsSet:(V=E.query(O).then(function(Z){var X=Z.result;if(Q&&(Q.res=X),P){for(var Y=0,it=X.length;Y<it;++Y)Object.freeze(X[Y]);Object.freeze(X)}else Z.result=Lt(X);return Z}).catch(function(Z){return K&&Q&&wt(K,Q),Promise.reject(Z)}),Q={obsSet:O.obsSet,promise:V,subscribers:new Set,type:"query",req:O,dirty:!1},K?K.push(Q):(K=[Q],(et=et||(Us["idb://".concat(v,"/").concat(x)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[O.query.index.name||""]=K)),Cd(Q,K,B,$),Q.promise.then(function(Z){return{result:Il(Z.result,O,et?.optimisticOps,E,Q,P)}})):E.query(O)}})}})}};function Rr(m,v){return new Proxy(m,{get:function(x,E,R){return E==="db"?v:Reflect.get(x,E,R)}})}qe.prototype.version=function(m){if(isNaN(m)||m<.1)throw new kt.Type("Given version is not a positive number");if(m=Math.round(10*m)/10,this.idbdb||this._state.isBeingOpened)throw new kt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,m);var v=this._versions,x=v.filter(function(E){return E._cfg.version===m})[0];return x||(x=new this.Version(m),v.push(x),v.sort(Rl),x.stores({}),this._state.autoSchema=!1),x},qe.prototype._whenReady=function(m){var v=this;return this.idbdb&&(this._state.openComplete||Ft.letThrough||this._vip)?m():new Nt(function(x,E){if(v._state.openComplete)return E(new kt.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return void E(new kt.DatabaseClosed);v.open().catch(pt)}v._state.dbReadyPromise.then(x,E)}).then(m)},qe.prototype.use=function(R){var v=R.stack,x=R.create,E=R.level,R=R.name,O=(R&&this.unuse({stack:v,name:R}),this._middlewares[v]||(this._middlewares[v]=[]));return O.push({stack:v,create:x,level:E??10,name:R}),O.sort(function(P,B){return P.level-B.level}),this},qe.prototype.unuse=function(m){var v=m.stack,x=m.name,E=m.create;return v&&this._middlewares[v]&&(this._middlewares[v]=this._middlewares[v].filter(function(R){return E?R.create!==E:!!x&&R.name!==x})),this},qe.prototype.open=function(){var m=this;return fi(Dn,function(){return Sd(m)})},qe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var m=this._state,v=Ns.indexOf(this);if(0<=v&&Ns.splice(v,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}m.isBeingOpened||(m.dbReadyPromise=new Nt(function(x){m.dbReadyResolve=x}),m.openCanceller=new Nt(function(x,E){m.cancelOpen=E}))},qe.prototype.close=function(v){var v=(v===void 0?{disableAutoOpen:!0}:v).disableAutoOpen,x=this._state;v?(x.isBeingOpened&&x.cancelOpen(new kt.DatabaseClosed),this._close(),x.autoOpen=!1,x.dbOpenError=new kt.DatabaseClosed):(this._close(),x.autoOpen=this._options.autoOpen||x.isBeingOpened,x.openComplete=!1,x.dbOpenError=null)},qe.prototype.delete=function(m){var v=this,x=(m===void 0&&(m={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),E=this._state;return new Nt(function(R,O){function P(){v.close(m);var B=v._deps.indexedDB.deleteDatabase(v.name);B.onsuccess=Ie(function(){var $,et,K;$=v._deps,et=v.name,go(K=$.indexedDB)||et===gr||Dl(K,$.IDBKeyRange).delete(et).catch(pt),R()}),B.onerror=mi(O),B.onblocked=v._fireOnBlocked}if(x)throw new kt.InvalidArgument("Invalid closeOptions argument to db.delete()");E.isBeingOpened?E.dbReadyPromise.then(P):P()})},qe.prototype.backendDB=function(){return this.idbdb},qe.prototype.isOpen=function(){return this.idbdb!==null},qe.prototype.hasBeenClosed=function(){var m=this._state.dbOpenError;return m&&m.name==="DatabaseClosed"},qe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qe.prototype,"tables",{get:function(){var m=this;return c(this._allTables).map(function(v){return m._allTables[v]})},enumerable:!1,configurable:!0}),qe.prototype.transaction=function(){var m=(function(v,x,E){var R=arguments.length;if(R<2)throw new kt.InvalidArgument("Too few arguments");for(var O=new Array(R-1);--R;)O[R-1]=arguments[R];return E=O.pop(),[v,_t(O),E]}).apply(this,arguments);return this._transaction.apply(this,m)},qe.prototype._transaction=function(m,v,x){var E,R,O=this,P=Ft.trans,B=(P&&P.db===this&&m.indexOf("!")===-1||(P=null),m.indexOf("?")!==-1);m=m.replace("!","").replace("?","");try{if(R=v.map(function(et){if(et=et instanceof O.Table?et.name:et,typeof et!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return et}),m=="r"||m===$i)E=$i;else{if(m!="rw"&&m!=ls)throw new kt.InvalidArgument("Invalid transaction mode: "+m);E=ls}if(P){if(P.mode===$i&&E===ls){if(!B)throw new kt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");P=null}P&&R.forEach(function(et){if(P&&P.storeNames.indexOf(et)===-1){if(!B)throw new kt.SubTransaction("Table "+et+" not included in parent transaction.");P=null}}),B&&P&&!P.active&&(P=null)}}catch(et){return P?P._promise(null,function(K,V){V(et)}):ke(et)}var $=(function et(K,V,Q,Z,X){return Nt.resolve().then(function(){var nt=Ft.transless||Ft,Y=K._createTransaction(V,Q,K._dbSchema,Z),nt=(Y.explicit=!0,{trans:Y,transless:nt});if(Z)Y.idbtrans=Z.idbtrans;else try{Y.create(),Y.idbtrans._explicit=!0,K._state.PR1398_maxLoop=3}catch(gt){return gt.name===Tt.InvalidState&&K.isOpen()&&0<--K._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),K.close({disableAutoOpen:!1}),K.open().then(function(){return et(K,V,Q,null,X)})):ke(gt)}var it,ot=U(X),nt=(ot&&sn(),Nt.follow(function(){var gt;(it=X.call(Y,Y))&&(ot?(gt=Xn.bind(null,null),it.then(gt,gt)):typeof it.next=="function"&&typeof it.throw=="function"&&(it=Cr(it)))},nt));return(it&&typeof it.then=="function"?Nt.resolve(it).then(function(gt){return Y.active?gt:ke(new kt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):nt.then(function(){return it})).then(function(gt){return Z&&Y._resolve(),Y._completion.then(function(){return gt})}).catch(function(gt){return Y._reject(gt),ke(gt)})})}).bind(null,this,E,R,P,x);return P?P._promise(E,$,"lock"):Ft.trans?fi(Ft.transless,function(){return O._whenReady($)}):this._whenReady($)},qe.prototype.table=function(m){if(y(this._allTables,m))return this._allTables[m];throw new kt.InvalidTable("Table ".concat(m," does not exist"))};var Oi=qe;function qe(m,v){var x,E,R,O,P,B=this,$=(this._middlewares={},this.verno=0,qe.dependencies),$=(this._options=v=i({addons:qe.addons,autoOpen:!0,indexedDB:$.indexedDB,IDBKeyRange:$.IDBKeyRange,cache:"cloned"},v),this._deps={indexedDB:v.indexedDB,IDBKeyRange:v.IDBKeyRange},v.addons),et=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:pt,dbReadyPromise:null,cancelOpen:pt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:v.autoOpen}),K=(et.dbReadyPromise=new Nt(function(V){et.dbReadyResolve=V}),et.openCanceller=new Nt(function(V,Q){et.cancelOpen=Q}),this._state=et,this.name=m,this.on=vr(this,"populate","blocked","versionchange","close",{ready:[rr,pt]}),this.once=function(V,Q){var Z=function(){for(var X=[],Y=0;Y<arguments.length;Y++)X[Y]=arguments[Y];B.on(V).unsubscribe(Z),Q.apply(B,X)};return B.on(V,Z)},this.on.ready.subscribe=k(this.on.ready.subscribe,function(V){return function(Q,Z){qe.vip(function(){var X,Y=B._state;Y.openComplete?(Y.dbOpenError||Nt.resolve().then(Q),Z&&V(Q)):Y.onReadyBeingFired?(Y.onReadyBeingFired.push(Q),Z&&V(Q)):(V(Q),X=B,Z||V(function it(){X.on.ready.unsubscribe(Q),X.on.ready.unsubscribe(it)}))})}}),this.Collection=(x=this,Sn(wd.prototype,function(it,Y){this.db=x;var Z=Al,X=null;if(Y)try{Z=Y()}catch(nt){X=nt}var Y=it._ctx,it=Y.table,ot=it.hook.reading.fire;this._ctx={table:it,index:Y.index,isPrimKey:!Y.index||it.schema.primKey.keyPath&&Y.index===it.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:X,or:Y.or,valueMapper:ot!==he?ot:null}})),this.Table=(E=this,Sn(Sl.prototype,function(V,Q,Z){this.db=E,this._tx=Z,this.name=V,this.schema=Q,this.hook=E._allTables[V]?E._allTables[V].hook:vr(null,{creating:[Gi,pt],reading:[ge,he],updating:[tu,pt],deleting:[ar,pt]})})),this.Transaction=(R=this,Sn(Tl.prototype,function(V,Q,Z,X,Y){var it=this;V!=="readonly"&&Q.forEach(function(ot){ot=(ot=Z[ot])==null?void 0:ot.yProps,ot&&(Q=Q.concat(ot.map(function(nt){return nt.updatesTable})))}),this.db=R,this.mode=V,this.storeNames=Q,this.schema=Z,this.chromeTransactionDurability=X,this.idbtrans=null,this.on=vr(this,"complete","error","abort"),this.parent=Y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Nt(function(ot,nt){it._resolve=ot,it._reject=nt}),this._completion.then(function(){it.active=!1,it.on.complete.fire()},function(ot){var nt=it.active;return it.active=!1,it.on.error.fire(ot),it.parent?it.parent._reject(ot):nt&&it.idbtrans&&it.idbtrans.abort(),ke(ot)})})),this.Version=(O=this,Sn(Ad.prototype,function(V){this.db=O,this._cfg={version:V,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(P=this,Sn(Ps.prototype,function(V,Q,Z){if(this.db=P,this._ctx={table:V,index:Q===":id"?null:Q,or:Z},this._cmp=this._ascending=ce,this._descending=function(X,Y){return ce(Y,X)},this._max=function(X,Y){return 0<ce(X,Y)?X:Y},this._min=function(X,Y){return ce(X,Y)<0?X:Y},this._IDBKeyRange=P._deps.IDBKeyRange,!this._IDBKeyRange)throw new kt.MissingAPI})),this.on("versionchange",function(V){0<V.newVersion?console.warn("Another connection wants to upgrade database '".concat(B.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(B.name,"'. Closing db now to resume the delete request.")),B.close({disableAutoOpen:!1})}),this.on("blocked",function(V){!V.newVersion||V.newVersion<V.oldVersion?console.warn("Dexie.delete('".concat(B.name,"') was blocked")):console.warn("Upgrade '".concat(B.name,"' blocked by other connection holding version ").concat(V.oldVersion/10))}),this._maxKey=xa(v.IDBKeyRange),this._createTransaction=function(V,Q,Z,X){return new B.Transaction(V,Q,Z,B._options.chromeTransactionDurability,X)},this._fireOnBlocked=function(V){B.on("blocked").fire(V),Ns.filter(function(Q){return Q.name===B.name&&Q!==B&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire(V)})},this.use(du),this.use(So),this.use(_d),this.use(Ed),this.use(hu),new Proxy(this,{get:function(V,Q,Z){var X;return Q==="_vip"||(Q==="table"?function(Y){return Rr(B.table(Y),K)}:(X=Reflect.get(V,Q,Z))instanceof Sl?Rr(X,K):Q==="tables"?X.map(function(Y){return Rr(Y,K)}):Q==="_createTransaction"?function(){return Rr(X.apply(this,arguments),K)}:X)}}));this.vip=K,$.forEach(function(V){return V(B)})}var Ca,Hs=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",mu=(Eo.prototype.subscribe=function(m,v,x){return this._subscribe(m&&typeof m!="function"?m:{next:m,error:v,complete:x})},Eo.prototype[Hs]=function(){return this},Eo);function Eo(m){this._subscribe=m}try{Ca={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Ca={indexedDB:null,IDBKeyRange:null}}function gu(m){var v,x=!1,E=new mu(function(R){var O=U(m),P,B=!1,$={},et={},K={get closed(){return B},unsubscribe:function(){B||(B=!0,P&&P.abort(),V&&En.storagemutated.unsubscribe(Z))}},V=(R.start&&R.start(K),!1),Q=function(){return os(X)},Z=function(Y){bo($,Y),Ll(et,$)&&Q()},X=function(){var Y,it,ot;!B&&Ca.indexedDB&&($={},Y={},P&&P.abort(),P=new AbortController,ot=(nt=>{var gt=ss();try{O&&sn();var At=ze(m,nt);return At=O?At.finally(Xn):At}finally{gt&&Ti()}})(it={subscr:Y,signal:P.signal,requery:Q,querier:m,trans:null}),Promise.resolve(ot).then(function(nt){x=!0,v=nt,B||it.signal.aborted||($={},(gt=>{for(var At in gt)if(y(gt,At))return;return 1})(et=Y)||V||(En(va,Z),V=!0),os(function(){return!B&&R.next&&R.next(nt)}))},function(nt){x=!1,["DatabaseClosedError","AbortError"].includes(nt?.name)||B||os(function(){B||R.error&&R.error(nt)})}))};return setTimeout(Q,0),K});return E.hasValue=function(){return x},E.getValue=function(){return v},E}var qs=Oi;function Ul(m){var v=ds;try{ds=!0,En.storagemutated.fire(m),jl(m,!0)}finally{ds=v}}w(qs,i(i({},J),{delete:function(m){return new qs(m,{addons:[]}).delete()},exists:function(m){return new qs(m,{addons:[]}).open().then(function(v){return v.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(m){try{return v=qs.dependencies,x=v.indexedDB,v=v.IDBKeyRange,(go(x)?Promise.resolve(x.databases()).then(function(E){return E.map(function(R){return R.name}).filter(function(R){return R!==gr})}):Dl(x,v).toCollection().primaryKeys()).then(m)}catch{return ke(new kt.MissingAPI)}var v,x},defineClass:function(){return function(m){d(this,m)}},ignoreTransaction:function(m){return Ft.trans?fi(Ft.transless,m):m()},vip:Ol,async:function(m){return function(){try{var v=Cr(m.apply(this,arguments));return v&&typeof v.then=="function"?v:Nt.resolve(v)}catch(x){return ke(x)}}},spawn:function(m,v,x){try{var E=Cr(m.apply(x,v||[]));return E&&typeof E.then=="function"?E:Nt.resolve(E)}catch(R){return ke(R)}},currentTransaction:{get:function(){return Ft.trans||null}},waitFor:function(m,v){return m=Nt.resolve(typeof m=="function"?qs.ignoreTransaction(m):m).timeout(v||6e4),Ft.trans?Ft.trans.waitFor(m):m},Promise:Nt,debug:{get:function(){return ti},set:function(m){eu(m)}},derive:S,extend:d,props:w,override:k,Events:vr,on:En,liveQuery:gu,extendObservabilitySet:bo,getByKeyPath:z,setByKeyPath:H,delByKeyPath:function(m,v){typeof v=="string"?H(m,v,void 0):"length"in v&&[].map.call(v,function(x){H(m,x,void 0)})},shallowClone:ut,deepClone:Lt,getObjectDiff:wo,cmp:ce,asap:F,minKey:-1/0,addons:[],connections:Ns,errnames:Tt,dependencies:Ca,cache:Us,semVer:"4.3.0",version:"4.3.0".split(".").map(function(m){return parseInt(m)}).reduce(function(m,v,x){return m+v/Math.pow(10,2*x)})})),qs.maxKey=xa(qs.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(En(va,function(m){ds||(m=new CustomEvent(js,{detail:m}),ds=!0,dispatchEvent(m),ds=!1)}),addEventListener(js,function(m){m=m.detail,ds||Ul(m)}));var Ta,ds=!1,qn=function(){};return typeof BroadcastChannel<"u"&&((qn=function(){(Ta=new BroadcastChannel(js)).onmessage=function(m){return m.data&&Ul(m.data)}})(),typeof Ta.unref=="function"&&Ta.unref(),En(va,function(m){ds||Ta.postMessage(m)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(m){if(!Oi.disableBfCache&&m.persisted){ti&&console.debug("Dexie: handling persisted pagehide"),Ta?.close();for(var v=0,x=Ns;v<x.length;v++)x[v].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(m){!Oi.disableBfCache&&m.persisted&&(ti&&console.debug("Dexie: handling persisted pageshow"),qn(),Ul({all:new _n(-1/0,[[]])}))})),Nt.rejectionMapper=function(m,v){return!m||m instanceof xt||m instanceof TypeError||m instanceof SyntaxError||!m.name||!we[m.name]?m:(v=new we[m.name](v||m.message,m),"stack"in m&&_(v,"stack",{get:function(){return this.inner.stack}}),v)},eu(ti),i(Oi,Object.freeze({__proto__:null,Dexie:Oi,Entity:iu,PropModification:ba,RangeSet:_n,add:function(m){return new ba({add:m})},cmp:ce,default:Oi,liveQuery:gu,mergeRanges:Is,rangesOverlap:lu,remove:function(m){return new ba({remove:m})},replacePrefix:function(m,v){return new ba({replacePrefix:[m,v]})}}),{default:Oi}),Oi})})(Bh)),Bh.exports}var wC=vC();const Wp=Ev(wC),K0=Symbol.for("Dexie"),$h=globalThis[K0]||(globalThis[K0]=Wp);if(Wp.semVer!==$h.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Wp.semVer} and ${$h.semVer}`);const{liveQuery:rR,mergeRanges:oR,rangesOverlap:lR,RangeSet:cR,cmp:uR,Entity:hR,PropModification:dR,replacePrefix:fR,add:pR,remove:mR,DexieYProvider:gR}=$h,Nm=new $h("WiseMarkDB");Nm.version(1).stores({pdfs:"hash, filename, size, blob"});async function _w(r){const t=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}async function km(r,t,e,i){await Nm.pdfs.put({hash:r,filename:t,size:e,blob:i})}async function xC(r){const t=await Nm.pdfs.get(r);return t?{data:t.blob,filename:t.filename,size:t.size}:null}async function AC(r){if(!r?.pdf_hash)return null;try{const{data:t}=await $n.getPdf(r.id),e=(t instanceof ArrayBuffer,t),i=r.file_size??e?.byteLength??0;return await km(r.pdf_hash,r.filename||"",i,e),{data:e,filename:r.filename||"",size:i}}catch{const t=await xC(r.pdf_hash);return t||null}}function _p(r){if(!r)return null;const t=new Date(r);return Number.isNaN(t.getTime())?null:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}function SC(){const{projectId:r}=gm(),t=fa(),e=gl(),[i,a]=I.useState(!1),[l,c]=I.useState(""),[u,d]=I.useState(null),[f,p]=I.useState(""),[y,w]=I.useState(!1),[A,_]=I.useState(""),[S,C]=I.useState(null),[M,N]=I.useState(""),[k,j]=I.useState(null),F=I.useRef(null),z=I.useRef(null),H=I.useRef(null),[ut,ft]=I.useState(0),{data:_t,isLoading:ct}=tr({queryKey:["project",r],queryFn:async()=>{const{data:Tt}=await Vh.get(r);return Tt},enabled:!!r}),{data:Rt,isLoading:Lt}=tr({queryKey:["documents",r],queryFn:async()=>{const{data:Tt}=await $n.list({project:r});return Tt},enabled:!!r}),Bt=Array.isArray(Rt)?Rt:Rt?.results??[],$t=Nc({mutationFn:({id:Tt,name:jt})=>Vh.update(Tt,{name:jt}),onSuccess:()=>{e.invalidateQueries({queryKey:["project",r]}),e.invalidateQueries({queryKey:["projects"]}),w(!1)}}),G=Nc({mutationFn:({id:Tt,filename:jt})=>$n.update(Tt,{filename:jt}),onSuccess:()=>{e.invalidateQueries({queryKey:["documents",r]}),d(null),p("")}}),st=Nc({mutationFn:Tt=>$n.delete(Tt),onSuccess:()=>e.invalidateQueries({queryKey:["documents",r]})}),wt=async Tt=>{const jt=Tt.target.files?.[0];if(!jt||!jt.type.includes("pdf"))return;c(""),C(jt);const kt=jt.name.replace(/\.pdf$/i,"")||jt.name;N(kt),j(null),F.current=null;try{const we=await jt.arrayBuffer(),pt=await _w(we),he={arrayBuffer:we,hash:pt,size:jt.size};j(he),F.current={...he,suggestedName:kt}}catch(we){c(we.message||"Could not read file"),C(null),N("")}},Xt=()=>{C(null),N(""),j(null),c(""),F.current=null,ft(Tt=>Tt+1)},Ct=()=>{H.current?.click()},U=async Tt=>{Tt.preventDefault();const jt=r,we=z.current?.value?.trim()||M?.trim()||F.current?.suggestedName?.trim()||"",pt=F.current||k;if(!jt){c("Project not found.");return}if(!we){c("Please enter a name for the PDF.");return}if(!pt||!pt.hash||!pt.arrayBuffer){c("File data missing. Please close and select the file again.");return}const he=we.toLowerCase().endsWith(".pdf")?we:`${we}.pdf`;c(""),a(!0);try{const ge=new FormData;ge.append("project",String(jt)),ge.append("filename",he),ge.append("file",new Blob([pt.arrayBuffer]),he),await $n.createWithFile(ge),await km(pt.hash,he,pt.size,pt.arrayBuffer),e.invalidateQueries({queryKey:["documents",jt]}),C(null),N(""),j(null),F.current=null,ft(An=>An+1)}catch(ge){const An=ge.response?.data?.detail||typeof ge.response?.data=="object"&&Object.values(ge.response?.data||{}).flat().join(" ")||ge.message||"Upload failed";c(String(An))}finally{a(!1)}},J=Tt=>{d(Tt.id),p(Tt.filename||"")},mt=()=>{if(u==null||!f.trim()){d(null);return}G.mutate({id:u,filename:f.trim()})},xt=()=>{d(null),p("")},It=()=>{_(_t?.name??""),w(!0)},Ut=()=>{const Tt=A.trim();if(!Tt||Tt===_t?.name){w(!1);return}$t.mutate({id:r,name:Tt})},Ot=()=>{w(!1),_("")};return ct||!_t?D.jsx("div",{className:`${ua} ${_i.page} flex items-center justify-center`,children:D.jsx(Ts,{className:"w-8 h-8 animate-spin text-slate-400"})}):D.jsxs("div",{className:`${ua} ${_i.page}`,children:[D.jsx("header",{className:"flex items-center justify-between mb-6",children:D.jsxs("button",{type:"button",onClick:()=>t("/"),className:`flex items-center gap-2 ${Zt.secondary} hover:text-slate-900 ${tl}`,children:[D.jsx(ad,{className:"w-4 h-4"}),"Back"]})}),D.jsxs("div",{className:"mb-8",children:[D.jsx("div",{className:"flex items-center gap-2 mb-4",children:y?D.jsxs(D.Fragment,{children:[D.jsx("input",{type:"text",value:A,onChange:Tt=>_(Tt.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900 text-xl font-semibold min-w-0 flex-1 max-w-md",autoFocus:!0,onKeyDown:Tt=>{Tt.key==="Enter"&&Ut(),Tt.key==="Escape"&&Ot()}}),D.jsx("button",{type:"button",onClick:Ut,className:"p-2 text-green-600 hover:bg-slate-100 rounded",title:"Save",children:D.jsx(V0,{className:"w-5 h-5"})}),D.jsx("button",{type:"button",onClick:Ot,className:"p-2 text-slate-500 hover:bg-slate-100 rounded",title:"Cancel",children:D.jsx(Qp,{className:"w-5 h-5"})})]}):D.jsxs(D.Fragment,{children:[D.jsx("h1",{className:`text-xl font-semibold ${Zt.heading}`,children:_t.name}),D.jsx("button",{type:"button",onClick:It,className:"p-2 text-slate-400 hover:text-slate-600 rounded",title:"Edit project name",children:D.jsx(Xp,{className:"w-4 h-4"})})]})}),D.jsxs("button",{type:"button",onClick:Ct,disabled:i,className:`${da} inline-flex items-center gap-2`,children:[D.jsx(Yp,{className:"w-4 h-4"}),"Add PDF"]}),D.jsx("input",{ref:H,type:"file",accept:".pdf",onChange:wt,className:"hidden","aria-hidden":"true",tabIndex:-1},ut)]}),S&&D.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:Xt,children:D.jsxs("div",{className:`rounded-xl ${_i.surface} border ${Zi.default} shadow-xl w-full max-w-md p-6`,onClick:Tt=>Tt.stopPropagation(),children:[D.jsx("h2",{className:`text-lg font-semibold ${Zt.heading} mb-4`,children:"Name this PDF"}),k?D.jsxs("div",{className:"space-y-4",children:[l&&D.jsx("p",{className:"text-sm text-red-600 bg-red-50 rounded-lg px-3 py-2",children:l}),D.jsx("input",{ref:z,type:"text",value:M,onChange:Tt=>N(Tt.target.value),placeholder:"Document name",className:"w-full border border-slate-200 rounded-lg px-3 py-2.5 text-slate-900",autoFocus:!0,disabled:i}),D.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[D.jsx("button",{type:"button",onClick:Xt,disabled:i,className:"px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:"Cancel"}),D.jsx("button",{type:"button",onClick:Tt=>{Tt.preventDefault(),U(Tt)},disabled:i||!M.trim(),className:da,children:i?D.jsxs("span",{className:"inline-flex items-center gap-2",children:[D.jsx(Ts,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Upload & save"})]})]}):D.jsxs("div",{className:"flex items-center gap-2 text-slate-600 py-4",children:[D.jsx(Ts,{className:"w-5 h-5 animate-spin shrink-0"}),D.jsx("span",{children:"Reading file..."})]})]})}),l&&D.jsx("p",{className:"text-sm text-red-600 mb-4",children:l}),i&&D.jsxs("p",{className:"flex items-center gap-2 text-sm text-slate-600 mb-4",children:[D.jsx(Ts,{className:"w-4 h-4 animate-spin"})," Uploading..."]}),Lt?D.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[D.jsx(Ts,{className:"w-5 h-5 animate-spin"})," Loading PDFs..."]}):Bt.length===0?D.jsxs("div",{className:`rounded-xl border ${Zi.default} p-8 text-center ${Zt.secondary}`,children:[D.jsx(Sw,{className:"w-12 h-12 mx-auto mb-3 text-slate-400"}),D.jsx("p",{children:"No PDFs in this project yet. Add a PDF above."})]}):D.jsx("ul",{className:"space-y-2",children:Bt.map(Tt=>D.jsx("li",{className:`rounded-lg border ${Zi.default} ${_i.surface} overflow-hidden`,children:u===Tt.id?D.jsxs("div",{className:"flex items-center gap-2 px-4 py-3",children:[D.jsx("input",{type:"text",value:f,onChange:jt=>p(jt.target.value),className:"flex-1 min-w-0 border border-slate-200 rounded-lg px-3 py-2 text-slate-900",autoFocus:!0,onKeyDown:jt=>{jt.key==="Enter"&&mt(),jt.key==="Escape"&&xt()}}),D.jsx("button",{type:"button",onClick:mt,className:"p-2.5 text-green-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Save",children:D.jsx(V0,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:xt,className:"p-2.5 text-slate-500 hover:bg-slate-100 rounded-lg shrink-0",title:"Cancel",children:D.jsx(Qp,{className:"w-4 h-4"})})]}):D.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[D.jsxs("button",{type:"button",className:"flex-1 min-w-0 text-left py-1 flex flex-col items-start gap-0.5",onClick:()=>t(`/document/${Tt.id}`),children:[D.jsx("span",{className:`font-medium ${Zt.body} truncate block w-full`,children:Tt.filename}),D.jsxs("span",{className:`text-xs ${Zt.muted} block`,children:[Tt.file_size!=null&&`${(Tt.file_size/1024).toFixed(1)} KB`,Tt.file_size!=null&&_p(Tt.created_at)&&"  ",_p(Tt.created_at)?`Uploaded ${_p(Tt.created_at)}`:null]})]}),D.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[D.jsx("button",{type:"button",onClick:()=>J(Tt),className:"p-2.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",title:"Rename",children:D.jsx(Xp,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:jt=>{jt.stopPropagation(),confirm("Delete this PDF?")&&st.mutate(Tt.id)},className:"p-2.5 text-slate-400 hover:text-red-600 hover:bg-slate-100 rounded-lg",title:"Delete",children:D.jsx(Om,{className:"w-4 h-4"})})]})]})},Tt.id))})]})}const ui={yellow:{key:"yellow",label:"Yellow",name:"Key Metrics",hex:"#EAB308",rgba:"rgba(254, 243, 199, 0.5)",rgbaSoft:"rgba(234,179,8,0.18)",rgbaHover:"rgba(234,179,8,0.38)",solid:"#fbbf24"},green:{key:"green",label:"Green",name:"Competitive Advantages",hex:"#22C55E",rgba:"rgba(209, 250, 229, 0.5)",rgbaSoft:"rgba(34,197,94,0.18)",rgbaHover:"rgba(34,197,94,0.38)",solid:"#10b981"},blue:{key:"blue",label:"Blue",name:"Management Questions",hex:"#3B82F6",rgba:"rgba(219, 234, 254, 0.5)",rgbaSoft:"rgba(59,130,246,0.18)",rgbaHover:"rgba(59,130,246,0.38)",solid:"#3b82f6"},pink:{key:"pink",label:"Pink",name:"Investment Risks",hex:"#EC4899",rgba:"rgba(252, 231, 243, 0.5)",rgbaSoft:"rgba(236,72,153,0.18)",rgbaHover:"rgba(236,72,153,0.38)",solid:"#ec4899"},orange:{key:"orange",label:"Orange",name:"Commercial DD",hex:"#F97316",rgba:"rgba(254, 215, 170, 0.5)",rgbaSoft:"rgba(249,115,22,0.18)",rgbaHover:"rgba(249,115,22,0.38)",solid:"#f59e0b"}},la=Object.keys(ui);function _s(r,t={}){return t&&typeof t[r]=="string"&&t[r].trim()?t[r].trim():ui[r]&&ui[r].name||r}const Wn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Zp=[.001,0,0,.001,0,0],Cp=1.35,Ai={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Wa={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},jc="pdfjs_internal_editor_",re={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},ve={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},EC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Jp={TRIANGLES:1,LATTICE:2},bn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},jh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},gn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Wo={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},rd={ERRORS:0,WARNINGS:1,INFOS:5},Fc={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Sc={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},_C={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let od=rd.WARNINGS;function CC(r){Number.isInteger(r)&&(od=r)}function TC(){return od}function ld(r){od>=rd.INFOS&&console.info(`Info: ${r}`)}function ne(r){od>=rd.WARNINGS&&console.warn(`Warning: ${r}`)}function Me(r){throw new Error(r)}function Re(r,t){r||Me(t)}function RC(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Cw(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"&&(e.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),e.tryConvertEncoding))try{r=LC(r)}catch{}const i=t?URL.parse(r,t):URL.parse(r);return RC(i)?i:null}function Tw(r,t,e=!1){const i=URL.parse(r);return i?(i.hash=t,i.href):e&&Cw(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function ie(r,t,e,i=!1){return Object.defineProperty(r,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const Jr=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class X0 extends Jr{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Tp extends Jr{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class tm extends Jr{constructor(t){super(t,"InvalidPDFException")}}class Kh extends Jr{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class MC extends Jr{constructor(t){super(t,"FormatError")}}class er extends Jr{constructor(t){super(t,"AbortException")}}function DC(r){(typeof r!="object"||r?.length===void 0)&&Me("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const i=[];for(let a=0;a<t;a+=e){const l=Math.min(a+e,t),c=r.subarray(a,l);i.push(String.fromCharCode.apply(null,c))}return i.join("")}function cd(r){typeof r!="string"&&Me("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=r.charCodeAt(i)&255;return e}function OC(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function NC(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function kC(){try{return new Function(""),!0}catch{return!1}}class wn{static get isLittleEndian(){return ie(this,"isLittleEndian",NC())}static get isEvalSupported(){return ie(this,"isEvalSupported",kC())}static get isOffscreenCanvasSupported(){return ie(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ie(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ie(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ie(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return ie(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return ie(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Rp=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class qt{static makeHexColor(t,e,i){return`#${Rp[t]}${Rp[e]}${Rp[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const a=t[i],l=t[i+1];t[i]=a*e[0]+l*e[2]+e[4],t[i+1]=a*e[1]+l*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5];for(let p=0;p<6;p+=2){const y=t[i+p],w=t[i+p+1];t[i+p]=y*a+w*c+d,t[i+p+1]=y*l+w*u+f}}static applyInverseTransform(t,e){const i=t[0],a=t[1],l=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-a*e[2]+e[2]*e[5]-e[4]*e[3])/l,t[1]=(-i*e[1]+a*e[0]+e[4]*e[1]-e[5]*e[0])/l}static axialAlignedBoundingBox(t,e,i){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5],p=t[0],y=t[1],w=t[2],A=t[3];let _=a*p+d,S=_,C=a*w+d,M=C,N=u*y+f,k=N,j=u*A+f,F=j;if(l!==0||c!==0){const z=l*p,H=l*w,ut=c*y,ft=c*A;_+=ut,M+=ut,C+=ft,S+=ft,N+=z,F+=z,j+=H,k+=H}i[0]=Math.min(i[0],_,C,S,M),i[1]=Math.min(i[1],N,j,k,F),i[2]=Math.max(i[2],_,C,S,M),i[3]=Math.max(i[3],N,j,k,F)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],a=t[1],l=t[2],c=t[3],u=i**2+a**2,d=i*l+a*c,f=l**2+c**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-d**2));e[0]=Math.sqrt(p+y||1),e[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>a)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return l>c?null:[i,l,a,c]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,a,l){l[0]=Math.min(l[0],t,i),l[1]=Math.min(l[1],e,a),l[2]=Math.max(l[2],t,i),l[3]=Math.max(l[3],e,a)}static#t(t,e,i,a,l,c,u,d,f,p){if(f<=0||f>=1)return;const y=1-f,w=f*f,A=w*f,_=y*(y*(y*t+3*f*e)+3*w*i)+A*a,S=y*(y*(y*l+3*f*c)+3*w*u)+A*d;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],S)}static#e(t,e,i,a,l,c,u,d,f,p,y,w){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,i,a,l,c,u,d,-y/p,w);return}const A=p**2-4*y*f;if(A<0)return;const _=Math.sqrt(A),S=2*f;this.#t(t,e,i,a,l,c,u,d,(-p+_)/S,w),this.#t(t,e,i,a,l,c,u,d,(-p-_)/S,w)}static bezierBoundingBox(t,e,i,a,l,c,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,i,l,u,e,a,c,d,3*(-t+3*(i-l)+u),6*(t-2*i+l),3*(i-t),f),this.#e(t,i,l,u,e,a,c,d,3*(-e+3*(a-c)+d),6*(e-2*a+c),3*(a-e),f)}}function LC(r){return decodeURIComponent(escape(r))}let Mp=null,Y0=null;function PC(r){return Mp||(Mp=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Y0=new Map([["","t"]])),r.replaceAll(Mp,(t,e,i)=>e?e.normalize("NFKC"):Y0.get(i))}function Rw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),DC(r)}const el="pdfjs_internal_id_";function BC(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,a,...l]=e;if(!r(i)&&!Number.isInteger(i)||!t(a))return!1;const c=l.length;let u=!0;switch(a.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const d of l)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function jn(r,t,e){return Math.min(Math.max(r,t),e)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});class Ic{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function a(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(Ic.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&e.push({str:c}),!!l.children)for(const d of l.children)a(d)}return a(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Mw{static setupStorage(t,e,i,a,l){const c=a.getValue(e,{value:null});switch(i.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(c.value===i.attributes.xfaOn?t.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{a.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of i.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:a,linkService:l}){const{attributes:c}=e,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${a}`);for(const[d,f]of Object.entries(c))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(t,c.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,a=t.xfaHtml,l=t.intent||"display",c=document.createElement(a.name);a.attributes&&this.setAttributes({html:c,element:a,intent:l,linkService:i});const u=l!=="richText",d=t.div;if(d.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=y}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const y=document.createTextNode(a.value);c.append(y),u&&Ic.shouldBuildText(a.name)&&f.push(y)}return{textDivs:f}}const p=[[a,-1,c]];for(;p.length>0;){const[y,w,A]=p.at(-1);if(w+1===y.children.length){p.pop();continue}const _=y.children[++p.at(-1)[1]];if(_===null)continue;const{name:S}=_;if(S==="#text"){const M=document.createTextNode(_.value);f.push(M),A.append(M);continue}const C=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,S):document.createElement(S);if(A.append(C),_.attributes&&this.setAttributes({html:C,element:_,storage:e,intent:l,linkService:i}),_.children?.length>0)p.push([_,-1,C]);else if(_.value){const M=document.createTextNode(_.value);u&&Ic.shouldBuildText(S)&&f.push(M),C.append(M)}}for(const y of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const aa="http://www.w3.org/2000/svg";class hl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Yc(r,t="text"){if(Mc(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}i(new Error(a.statusText))}},a.send(null)})}class Qc{constructor({viewBox:t,userUnit:e,scale:i,rotation:a,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=a,this.offsetX=l,this.offsetY=c,i*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,w,A;switch(a%=360,a<0&&(a+=360),a){case 180:p=-1,y=0,w=0,A=1;break;case 90:p=0,y=1,w=1,A=0;break;case 270:p=0,y=-1,w=-1,A=0;break;case 0:p=1,y=0,w=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(w=-w,A=-A);let _,S,C,M;p===0?(_=Math.abs(f-t[1])*i+l,S=Math.abs(d-t[0])*i+c,C=(t[3]-t[1])*i,M=(t[2]-t[0])*i):(_=Math.abs(d-t[0])*i+l,S=Math.abs(f-t[1])*i+c,C=(t[2]-t[0])*i,M=(t[3]-t[1])*i),this.transform=[p*i,y*i,w*i,A*i,_-p*i*d-w*i*f,S-y*i*d-A*i*f],this.width=C,this.height=M}get rawDims(){const t=this.viewBox;return ie(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:a=this.offsetY,dontFlip:l=!1}={}){return new Qc({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}convertToViewportPoint(t,e){const i=[t,e];return qt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];qt.applyTransform(e,this.transform);const i=[t[2],t[3]];return qt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return qt.applyInverseTransform(i,this.transform),i}}class Lm extends Jr{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function ud(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function Pm(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function jC(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function FC(r,t="document.pdf"){if(typeof r!="string")return t;if(ud(r))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(r);if(!i)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},l=/\.pdf$/i,c=i.pathname.split("/").at(-1);if(l.test(c))return a(c);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const f of u)if(l.test(f))return a(f);const d=Array.from(i.searchParams.keys()).reverse();for(const f of d)if(l.test(f))return a(f)}if(i.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(d)return a(d[0])}return t}class Q0{started=Object.create(null);times=[];time(t){t in this.started&&ne(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ne(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:a,end:l}of this.times)t.push(`${i.padEnd(e)} ${l-a}ms
`);return t.join("")}}function Mc(r,t){const e=t?URL.parse(r,t):URL.parse(r);return e?.protocol==="http:"||e?.protocol==="https:"}function qi(r){r.preventDefault()}function en(r){r.preventDefault(),r.stopPropagation()}function IC(r){console.log("Deprecated API usage: "+r)}class em{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let l=parseInt(e[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(e[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=p,u+=y):f==="+"&&(c-=p,u-=y),new Date(Date.UTC(i,a,l,c,u,d))}}function UC(r,{scale:t=1,rotation:e=0}){const{width:i,height:a}=r.attributes.style,l=[0,0,parseInt(i),parseInt(a)];return new Qc({viewBox:l,userUnit:1,scale:t,rotation:e})}function Wc(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ne(`Not a valid color format: "${r}"`),[0,0,0])}function zC(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;r.set(e,Wc(i))}t.remove()}function We(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform();return[t,e,i,a,l,c]}function ws(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform().invertSelf();return[t,e,i,a,l,c]}function Wr(r,t,e=!1,i=!0){if(t instanceof Qc){const{pageWidth:a,pageHeight:l}=t.rawDims,{style:c}=r,u=wn.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(c.width=p,c.height=y):(c.width=y,c.height=p)}i&&r.setAttribute("data-main-rotation",t.rotation)}class Rs{constructor(){const{pixelRatio:t}=Rs;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,a,l=-1){let c=1/0,u=1/0,d=1/0;i=Rs.capPixels(i,l),i>0&&(c=Math.sqrt(i/(t*e))),a!==-1&&(u=a/t,d=a/e);const f=Math.min(c,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const nm=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class HC{static get isDarkMode(){return ie(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class qC{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),ie(this,"commentForegroundColor",Wc(i))}}function GC(r,t,e,i){i=Math.min(Math.max(i??1,0),1);const a=255*(1-i);return r=Math.round(r*i+a),t=Math.round(t*i+a),e=Math.round(e*i+a),[r,t,e]}function W0(r,t){const e=r[0]/255,i=r[1]/255,a=r[2]/255,l=Math.max(e,i,a),c=Math.min(e,i,a),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const d=l-c;switch(t[1]=u<.5?d/(l+c):d/(2-l-c),l){case e:t[0]=((i-a)/d+(i<a?6:0))*60;break;case i:t[0]=((a-e)/d+2)*60;break;case a:t[0]=((e-i)/d+4)*60;break}}t[2]=u}function im(r,t){const e=r[0],i=r[1],a=r[2],l=(1-Math.abs(2*a-1))*i,c=l*(1-Math.abs(e/60%2-1)),u=a-l/2;switch(Math.floor(e/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Z0(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function J0(r,t,e){im(r,e),e.map(Z0);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];im(t,e),e.map(Z0);const a=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>a?(i+.05)/(a+.05):(a+.05)/(i+.05)}const tv=new Map;function VC(r,t){const e=r[0]+r[1]*256+r[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=tv.get(e);if(i)return i;const a=new Float32Array(9),l=a.subarray(0,3),c=a.subarray(3,6);W0(r,c);const u=a.subarray(6,9);W0(t,u);const d=u[2]<.5,f=d?12:4.5;if(c[2]=d?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),J0(c,u,l)<f){let p,y;d?(p=c[2],y=1):(p=0,y=c[2]);const w=.005;for(;y-p>w;){const A=c[2]=(p+y)/2;d===J0(c,u,l)<f?p=A:y=A}c[2]=d?y:p}return im(c,l),i=qt.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),tv.set(e,i),i}function Dw({html:r,dir:t,className:e},i){const a=document.createDocumentFragment();if(typeof r=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=r.split(/(?:\r\n?|\n)/);for(let u=0,d=c.length;u<d;++u){const f=c[u];l.append(document.createTextNode(f)),u<d-1&&l.append(document.createElement("br"))}a.append(l)}else Mw.render({xfaHtml:r,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",e),i.append(a)}function Ow(r){const t=new Path2D;if(!r)return t;for(let e=0,i=r.length;e<i;)switch(r[e++]){case Sc.moveTo:t.moveTo(r[e++],r[e++]);break;case Sc.lineTo:t.lineTo(r[e++],r[e++]);break;case Sc.curveTo:t.bezierCurveTo(r[e++],r[e++],r[e++],r[e++],r[e++],r[e++]);break;case Sc.quadraticCurveTo:t.quadraticCurveTo(r[e++],r[e++],r[e++],r[e++]);break;case Sc.closePath:t.closePath();break;default:ne(`Unrecognized drawing path operator: ${r[e-1]}`);break}return t}class Ce{static#t=null;static#e=null;static#i=null;static#n=0;static#s=[];get pagesNumber(){return Ce.#n}set pagesNumber(t){Ce.#n!==t&&(Ce.#n=t,t===0&&(Ce.#e=null,Ce.#t=null))}addListener(t){Ce.#s.push(t)}removeListener(t){const e=Ce.#s.indexOf(t);e>=0&&Ce.#s.splice(e,1)}#r(){for(const t of Ce.#s)t()}#a(t){if(Ce.#e)return;const e=Ce.#n,i=new Uint32Array(3*e),a=Ce.#e=i.subarray(0,e),l=Ce.#t=i.subarray(e,2*e);if(t)for(let c=0;c<e;c++)a[c]=l[c]=c+1;Ce.#i=i.subarray(2*e)}movePages(t,e,i){this.#a(!0);const a=Ce.#e,l=Ce.#t;Ce.#i.set(l);const c=e.length,u=new Uint32Array(c);let d=0;for(let A=0;A<c;A++){const _=e[A]-1;u[A]=a[_],_<i&&(d+=1)}const f=Ce.#n;let p=i-d;const y=f-c;p=jn(p,0,y);for(let A=0,_=0;A<f;A++)t.has(A+1)||(a[_++]=a[A]);a.copyWithin(p+c,p,y),a.set(u,p);let w=!1;for(let A=0,_=f;A<_;A++){const S=a[A];w||=S!==A+1,l[S-1]=A+1}this.#r(),w||(this.pagesNumber=0)}hasBeenAltered(){return Ce.#e!==null}getPageMappingForSaving(){return{pageIndices:Ce.#t?Ce.#t.map(t=>t-1):null}}getPrevPageNumber(t){return Ce.#i[Ce.#e[t-1]-1]}getPageNumber(t){return Ce.#t?.[t-1]??t}getPageId(t){return Ce.#e?.[t-1]??t}static get instance(){return ie(this,"instance",new Ce)}getMapping(){return Ce.#e.subarray(0,this.pagesNumber)}}class kc{#t=null;#e=null;#i;#n=null;#s=null;#r=null;#a=null;#o=null;static#c=null;constructor(t){this.#i=t,kc.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",qi,{signal:e}),t.addEventListener("pointerdown",kc.#l,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const a=this.#i.toolbarPosition;if(a){const{style:l}=t,c=this.#i._uiManager.direction==="ltr"?1-a[0]:a[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,en(t)}#h(t){this.#i._focusEventsAllowed=!0,en(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",qi,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",kc.#c[t]),this.#f(i)&&i.addEventListener("click",a=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#g),this.#s=t}addComment(t,e=null){if(this.#r)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const a=this.#a=this.#g;e?(this.#n.insertBefore(i,e),this.#n.insertBefore(a,e)):this.#n.append(i,a),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#g)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#g)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#a?.remove(),this.#a=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const a=this.#n.querySelector(i);a&&t==="comment"&&this.addComment(e,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class $C{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",qi,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#s(t,e){let i=0,a=0;for(const l of t){const c=l.y+l.height;if(c<i)continue;const u=l.x+(e?l.width:0);if(c>i){a=u,i=c;continue}e?u>a&&(a=u):u<a&&(a=u)}return[e?1-a:a,i]}show(t,e,i){const[a,l]=this.#s(e,i),{style:c}=this.#e||=this.#n();t.append(this.#e),c.insetInlineEnd=`${100*a}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,i,a){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",e);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",i);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",qi,{signal:u}),l.addEventListener("click",a,{signal:u})),this.#t.append(l)}}function Nw(r,t,e){for(const i of e)t.addEventListener(i,r[i].bind(r))}class Te{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(Te.#e||=new Set).add(t)}static setPointer(t,e){Te.#t||=e,Te.#n??=t}static setTimeStamp(t){Te.#i=t}static isSamePointerId(t){return Te.#t===t}static isSamePointerIdOrRemove(t){return Te.#t===t?!0:(Te.#e?.delete(t),!1)}static isSamePointerType(t){return Te.#n===t}static isInitializedAndDifferentPointerType(t){return Te.#n!==null&&!Te.isSamePointerType(t)}static isSameTimeStamp(t){return Te.#i===t}static isUsingMultiplePointers(){return Te.#e?.size>=1}static clearPointerType(){Te.#n=null}static clearPointerIds(){Te.#t=NaN,Te.#e=null}static clearTimeStamp(){Te.#i=NaN}}class KC{#t=0;get id(){return`${jc}${this.#t++}`}}class Bm{#t=Rw();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const l=a.decode().then(()=>(i.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ie(this,"_isSVGFittingCanvas",l)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof e=="string"?(i.url=e,a=await Yc(e,"blob")):e instanceof File?a=i.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const l=Bm._isSVGFittingCanvas,c=new FileReader,u=new Image,d=new Promise((f,p)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,f()},c.onload=async()=>{const y=i.svgUrl=c.result;u.src=await l?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=p});c.readAsDataURL(a),await d}else i.bitmap=await createImageBitmap(a);i.refCounter=1}catch(a){ne(a),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:a,type:l}=t;return this.#n(`${e}_${i}_${a}_${l}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),i={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const a=new OffscreenCanvas(i.width,i.height);a.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=a.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class XC{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:a,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:e,post:i,type:l};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(d);return}if(c&&this.#t[this.#n].type===l){u&&(d.undo=this.#t[this.#n].undo),this.#t[this.#n]=d;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class Zc{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=wn.platform;for(const[i,a,l={}]of t)for(const c of i){const u=c.startsWith("mac+");e&&u?(this.callbacks.set(c.slice(4),{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1))):!e&&!u&&(this.callbacks.set(c,{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:a,options:{bubbles:l=!1,args:c=[],checker:u=null}}=i;u&&!u(t,e)||(a.bind(t,...c,e)(),l||en(e))}}class jm{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return zC(t),ie(this,"_colors",t)}convert(t){const e=Wc(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,a]of this._colors)if(a.every((l,c)=>l===e[c]))return jm._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?qt.makeHexColor(...e):t}}class nr{#t=new AbortController;#e=null;#i=null;#n=new Map;#s=new Map;#r=null;#a=null;#o=null;#c=new XC;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#S=null;#w=null;#C=null;#x=!1;#_=null;#D=new KC;#R=!1;#M=!1;#j=!1;#N=null;#L=null;#F=null;#P=null;#G=null;#T=re.NONE;#A=new Set;#k=null;#I=null;#z=null;#K=null;#$=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#B=null;#V=null;#Z=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=nr.prototype,e=c=>c.#V.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),i=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return ie(this,"_keyboardManager",new Zc([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#V.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:e}]]))}constructor(t,e,i,a,l,c,u,d,f,p,y,w,A,_,S,C){const M=this._signal=this.#t.signal;this.#V=t,this.#Z=e,this.#J=i,this.#r=a,this.#l=l,this.#I=c,this.#$=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:M}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:M}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:M}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:M}),u._on("setpreference",this.onSetPreference.bind(this),{signal:M}),u._on("switchannotationeditorparams",N=>this.updateParams(N.type,N.value),{signal:M}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:M}),window.addEventListener("pointerdown",()=>{this.#M=!0},{capture:!0,signal:M}),window.addEventListener("pointerup",()=>{this.#M=!1},{capture:!0,signal:M}),this.#rt(),this.#dt(),this.#et(),this.#a=d.annotationStorage,this.#E=d.filterFactory,this.#z=f,this.#C=p||null,this.#y=y,this.#v=w,this.#b=A,this.#G=_||null,this.viewParameters={realScale:hl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=C!==!1,l?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#p.clear(),this.#P?.clear(),this.#e=null,this.#A.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#I?.destroy(),this.#_?.hide(),this.#_=null,this.#F?.destroy(),this.#F=null,this.#i=null,this.#S&&(clearTimeout(this.#S),this.#S=null),this.#B&&(clearTimeout(this.#B),this.#B=null),this._editorUndoBar?.destroy(),this.#$=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return ie(this,"hcmFilter",this.#z?this.#E.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return ie(this,"direction",getComputedStyle(this.#V).direction)}get _highlightColors(){return ie(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return ie(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[a,l]of t){const c=a.endsWith("_HCM");if(i&&c){e.set(a.replace("_HCM",""),l);continue}!i&&!c&&e.set(a,l)}return ie(this,"highlightColors",e)}get highlightColorNames(){return ie(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,a){this.#l?.showDialog(this,t,e,i,a)}selectComment(t,e){this.#s.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}deleteComment(t,e){const i=()=>{t.comment=e},a=()=>{this._editorUndoBar?.show(i,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:a,undo:i,mustExec:!0})}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#s.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),a=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",a),e())};this._eventBus.on("editorsrendered",a),await i}getSignature(t){this.#I?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#I}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=e)}onPagesEdited({pagesMapper:t}){for(const a of this.#n.values())a.updatePageIndex(t.getPrevPageNumber(a.pageIndex+1)-1);const e=this.#s,i=this.#s=new Map;for(const[a,l]of e){const c=t.getPrevPageNumber(a+1)-1;if(c===-1){l.destroy();continue}i.set(c,l),l.updatePageIndex(c)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#V.focus()}findParent(t,e){for(const i of this.#s.values()){const{x:a,y:l,width:c,height:u}=i.div.getBoundingClientRect();if(t>=a&&t<=a+c&&e>=l&&e<=l+u)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*hl.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#s.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u}=i,d=i.toString(),p=this.#W(i).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;i.empty();const w=this.#tt(p),A=this.#T===re.NONE,_=()=>{const S=w?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u,text:d});A&&this.showAllEditors("highlight",!0,!0),e&&S?.editComment()};if(A){this.switchToMode(re.HIGHLIGHT,_);return}_()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#W(t).closest(".textLayer"),a=this.getSelectionBoxes(i);a&&(this.#_||=new $C(this),this.#_.show(i,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#a)return null;const e=`${jc}${t}`,i=this.#a.getRawValue(e);return i&&this.#a.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#k&&(this.#_?.hide(),this.#k=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#k)return;const a=this.#W(t).closest(".textLayer");if(!a){this.#k&&(this.#_?.hide(),this.#k=null,this.#O({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#k=e,this.#O({hasSelectedText:!0}),!(this.#T!==re.HIGHLIGHT&&this.#T!==re.NONE)&&(this.#T===re.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#x=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===re.HIGHLIGHT?this.#tt(a):null;if(l?.toggleDrawing(),this.#M){const c=new AbortController,u=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else l?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(t=""){this.#T===re.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#A)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#N)return;this.#N=new AbortController;const t=this.combinedSignal(this.#N);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#N?.abort(),this.#N=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#A){const a=i.serialize(!0);a&&e.push(a)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const l of e.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(l){ne(`paste: "${l.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const a=this.currentLayer;try{const l=[];for(const d of i){const f=await a.deserialize(d);if(!f)return;l.push(f)}const c=()=>{for(const d of l)this.#nt(d);this.#it(l)},u=()=>{for(const d of l)d.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){ne(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==re.NONE&&!this.isEditorHandlingKeyboard&&nr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([i,a])=>this.#X[i]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#T===re.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#q([[ve.HIGHLIGHT_FREE,!0]]))}#q(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#O({isEditing:this.#T!==re.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#q(e.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#s.get(this.#f)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#s.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,a=!1,l=!1,c=!1){if(this.#T!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===re.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===re.NONE){this.setEditingState(!1),this.#pt();for(const u of this.#n.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const u of this.#n.values())u.addStandaloneCommentButton();t===re.SIGNATURE&&await this.#I?.loadSignatures(),i&&Te.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#s.values())u.updateMode(t);if(t===re.POPUP){this.#i||=await this.#$.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#n.values()){const{annotationElementId:p,hasComment:y,deleted:w}=f;p&&u.add(p),y&&!w&&d.push(f.getData())}for(const f of this.#i){const{id:p,popupRef:y,contentsObj:w}=f;y&&w?.str&&!u.has(p)&&!this.#g.has(p)&&d.push(f)}this.#l?.showSidebar(d)}if(!e){a&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const u of this.#n.values())u.uid===e?(this.setSelected(u),c?u.editComment():l?u.enterInEditMode():u.focus()):u.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case ve.CREATE:this.currentLayer.addNewEditor(e);return;case ve.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#K||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#A)i.updateParams(t,e);else for(const i of this.#u)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const l of this.#n.values())l.editorType===t&&l.show(e);(this.#K?.get(ve.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#q([[ve.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#j!==t){this.#j=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#S&&clearTimeout(this.#S),this.#S=setTimeout(()=>{this.focusMainContainer(),this.#S=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#P?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#q(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#mt===t&&this.#q(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#q(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#A)e!==t&&e.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#A],i=()=>{this._editorUndoBar?.show(a,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},a=()=>{for(const l of e)this.#nt(l)};this.addCommands({cmd:i,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#A)e.unselect();this.#A.clear();for(const e of t)e.isEmpty()||(this.#A.add(e),e.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==re.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[a,l]=this.#H,c=[...this.#A],u=1e3;this.#B&&clearTimeout(this.#B),this.#B=setTimeout(()=>{this.#B=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(a,l),d.translationDone())},undo:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(-a,-l),d.translationDone())},mustExec:!1})},u);for(const d of c)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#A)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let e=!1;for(const[{x:a,y:l,pageIndex:c},u]of t)u.newX=a,u.newY=l,u.newPageIndex=c,e||=a!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!e)return!1;const i=(a,l,c,u)=>{if(this.#n.has(a.id)){const d=this.#s.get(u);d?a._setParentAndPosition(d,l,c):(a.pageIndex=u,a.x=l,a.y=c)}};return this.addCommands({cmd:()=>{for(const[a,{newX:l,newY:c,newPageIndex:u}]of t)i(a,l,c,u)},undo:()=>{for(const[a,{savedX:l,savedY:c,savedPageIndex:u}]of t)i(a,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#m)for(const i of this.#m.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==re.NONE}get imageManager(){return ie(this,"imageManager",new Bm)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:a,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,w)=>({x:(p-a)/c,y:1-(f+y-i)/l,width:w/c,height:y/l});break;case"180":u=(f,p,y,w)=>({x:1-(f+y-i)/l,y:1-(p+w-a)/c,width:y/l,height:w/c});break;case"270":u=(f,p,y,w)=>({x:1-(p+w-a)/c,y:(f-i)/l,width:w/c,height:y/l});break;default:u=(f,p,y,w)=>({x:(f-i)/l,y:(p-a)/c,width:y/l,height:w/c});break}const d=[];for(let f=0,p=e.rangeCount;f<p;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x:w,y:A,width:_,height:S}of y.getClientRects())_===0||S===0||d.push(u(w,A,_,S))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#a.getRawValue(e);i&&(this.#T===re.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const a=this.#P?.get(t);a&&(a.setCanvas(e,i),this.#P.delete(t))}addMissingCanvas(t,e){(this.#P||=new Map).set(t,e)}}class Cs{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,Cs.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){Cs._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",Cs.#f.missing),e.setAttribute("data-l10n-id",Cs.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",qi,{signal:i}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#a=!0,a(l))},{signal:i}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await Cs._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:a,cancel:l=!1}){i&&(this.#l=i,this.#d=a),!(this.#t===t&&this.#e===e)&&(l||(this.#t=t,this.#e=e),this.#m())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#s=null,this.#o?.remove(),this.#o=null}async#m(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",Cs.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",Cs.#f[`${this.#g}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const a=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:l})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class vh{#t=null;#e=null;#i=!1;#n=null;#s=null;#r=null;#a=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const a=this.#n.commentButtonColor;a&&(i.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#n.parent.boundingClientRect;return[(t-a)/c,(e+i-l)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#n._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",qi,{signal:i}),e&&(t.addEventListener("focusin",l=>{this.#n._focusEventsAllowed=!1,en(l)},{capture:!0,signal:i}),t.addEventListener("focusout",l=>{this.#n._focusEventsAllowed=!0,en(l)},{capture:!0,signal:i})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#i=!0,a(l))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,a;if(e)[i,a]=e;else{[i,a]=this.#n.commentButtonPosition;const{width:p,height:y,x:w,y:A}=this.#n;i=w+i*p,a=A+a*y}const l=this.#n.parent.boundingClientRect,{x:c,y:u,width:d,height:f}=l;this.#n._uiManager.editComment(this.#n,c+i*d,u+a*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#a===""}isEmpty(){return this.#a===null}hasBeenEdited(){return this.isDeleted()||this.#a!==this.#s}serialize(){return this.data}get data(){return{text:this.#a,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#a&&(this.#r=null),t===null){this.#a="",this.#c=!0;return}this.#a=t,this.#o=new Date,this.#c=!1}restoreData({text:t,richText:e,date:i}){this.#a=t,this.#r=e,this.#o=i,this.#c=!1}setInitialText(t,e=null){this.#s=t,this.data=t,this.#o=null,this.#r=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#a="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class hd{#t;#e=!1;#i=null;#n;#s;#r;#a;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:a=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#i=i,this.#n=e,this.#s=a,this.#r=l,this.#a=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Rs.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,l=AbortSignal.any([this.#c,a.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(en(f),d(f))},u),c.addEventListener("pointerup",d,u),c.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:a,capture:!1,passive:!1};l.addEventListener("touchmove",this.#g.bind(this),c);const u=this.#m.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",en,c),l.addEventListener("pointermove",en,c),l.addEventListener("pointercancel",en,c),l.addEventListener("pointerup",en,c),this.#s?.()}if(en(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;en(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:a,screenY:l}=e,{screenX:c,screenY:u}=i,d=this.#l,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:w}=d,A=y-f,_=w-p,S=c-a,C=u-l,M=Math.hypot(S,C)||1,N=Math.hypot(A,_)||1;if(!this.#e&&Math.abs(N-M)<=hd.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=l,d.touch1X=c,d.touch1Y=u,!this.#e){this.#e=!0;return}const k=[(a+c)/2,(l+u)/2];this.#r?.(k,N,M)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#a?.()),this.#l&&(en(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Wt{#t=null;#e=null;#i=null;#n=null;#s=null;#r=!1;#a=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#S=0;#w=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#x=!1;#_=Wt._zIndex++;static _borderLineWidth=-1;static _colorManager=new jm;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Wt.prototype._resizeWithKeyboard,e=nr.TRANSLATE_SMALL,i=nr.TRANSLATE_BIG;return ie(this,"_resizerKeyboardManager",new Zc([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Wt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,a],this.pageTranslation=[l,c];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ie(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new YC({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Wt._l10n??=t,Wt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Wt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Wt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Me("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(t){this.#x=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#B(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,a){const[l,c]=this.parentDimensions;[i,a]=this.screenToPageTranslation(i,a),this.x=(t+i)/l,this.y=(e+a)/c,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,a]=this.parentDimensions;this.setAt(t*i,e*a,this.width*i,this.height*a),this._onTranslated()}#D([t,e],i,a){[i,a]=this.screenToPageTranslation(i,a),this.x+=i/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#D(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[a,l]}=this;if(this.x+=t/a,this.y+=e/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:w}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,w)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[d,f]=this.getBaseTranslation();c+=d,u+=f;const{style:p}=i;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Wt,a=i/t,l=i/e;switch(this.rotation){case 90:return[-a,l];case 180:return[a,l];case 270:return[a,-l];default:return[-a,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,a]}=this;let{x:l,y:c,width:u,height:d}=this;if(u*=i,d*=a,l*=i,c*=a,this._mustFixPosition)switch(t){case 0:l=jn(l,0,i-u),c=jn(c,0,a-d);break;case 90:l=jn(l,0,i-d),c=jn(c,u,a);break;case 180:l=jn(l,u,i),c=jn(c,d,a);break;case 270:l=jn(l,d,i),c=jn(c,0,a-u);break}this.x=l/=i,this.y=c/=a;const[f,p]=this.getBaseTranslation();l+=f,c+=p,e.left=`${(100*l).toFixed(2)}%`,e.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Wt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Wt.#R(t,e,360-this.parentRotation)}#M(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",i),a.setAttribute("data-resizer-name",i),a.addEventListener("pointerdown",this.#N.bind(this,i),{signal:e}),a.addEventListener("contextmenu",qi,{signal:e}),a.tabIndex=-1}this.div.prepend(this.#c)}#N(t,e){e.preventDefault();const{isMac:i}=wn.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#P.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",en,{passive:!1,signal:c}),window.addEventListener("contextmenu",qi,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#F()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#L(t,e,i,a){this.width=i,this.height=a,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:a}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,d=this.height;l===t&&c===e&&u===i&&d===a||this.addCommands({cmd:this.#L.bind(this,l,c,u,d),undo:this.#L.bind(this,t,e,i,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#P(t,e){const[i,a]=this.parentDimensions,l=this.x,c=this.y,u=this.width,d=this.height,f=Wt.MIN_SIZE/i,p=Wt.MIN_SIZE/a,y=this.#M(this.rotation),w=(G,st)=>[y[0]*G+y[2]*st,y[1]*G+y[3]*st],A=this.#M(360-this.rotation),_=(G,st)=>[A[0]*G+A[2]*st,A[1]*G+A[3]*st];let S,C,M=!1,N=!1;switch(t){case"topLeft":M=!0,S=(G,st)=>[0,0],C=(G,st)=>[G,st];break;case"topMiddle":S=(G,st)=>[G/2,0],C=(G,st)=>[G/2,st];break;case"topRight":M=!0,S=(G,st)=>[G,0],C=(G,st)=>[0,st];break;case"middleRight":N=!0,S=(G,st)=>[G,st/2],C=(G,st)=>[0,st/2];break;case"bottomRight":M=!0,S=(G,st)=>[G,st],C=(G,st)=>[0,0];break;case"bottomMiddle":S=(G,st)=>[G/2,st],C=(G,st)=>[G/2,0];break;case"bottomLeft":M=!0,S=(G,st)=>[0,st],C=(G,st)=>[G,0];break;case"middleLeft":N=!0,S=(G,st)=>[0,st/2],C=(G,st)=>[G,st/2];break}const k=S(u,d),j=C(u,d);let F=w(...j);const z=Wt._round(l+F[0]),H=Wt._round(c+F[1]);let ut=1,ft=1,_t,ct;if(e.fromKeyboard)({deltaX:_t,deltaY:ct}=e);else{const{screenX:G,screenY:st}=e,[wt,Xt]=this.#l;[_t,ct]=this.screenToPageTranslation(G-wt,st-Xt),this.#l[0]=G,this.#l[1]=st}if([_t,ct]=_(_t/i,ct/a),M){const G=Math.hypot(u,d);ut=ft=Math.max(Math.min(Math.hypot(j[0]-k[0]-_t,j[1]-k[1]-ct)/G,1/u,1/d),f/u,p/d)}else N?ut=jn(Math.abs(j[0]-k[0]-_t),f,1)/u:ft=jn(Math.abs(j[1]-k[1]-ct),p,1)/d;const Rt=Wt._round(u*ut),Lt=Wt._round(d*ft);F=w(...C(Rt,Lt));const Bt=z-F[0],$t=H-F[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=Rt,this.height=Lt,this.x=Bt,this.y=$t,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new kc(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(Cs.initialize(Wt._l10n),this.#i=new Cs(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new vh(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#s){this._uiManager.isEditingMode()&&this.#s.classList.remove("hidden");return}this.hasComment&&(this.#s=this.#n.renderForStandalone(),this.div.append(this.#s))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#s=null}hideStandaloneCommentButton(){this.#s?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:t,text:e,date:i,deleted:a}}=this.#n;return{text:e,richText:t,date:i,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new vh(this),typeof t=="object"&&t!==null?this.#n.restoreData(t):this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#n||=new vh(this),this.#n.setInitialText(t,i),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new vh(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[a,l]=this.getInitialTranslation();return this.translate(a,l),Nw(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new hd({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,i){let l=.7*(i/e)+1-.7;if(l===1)return;const c=this.#M(this.rotation),u=(z,H)=>[c[0]*z+c[2]*H,c[1]*z+c[3]*H],[d,f]=this.parentDimensions,p=this.x,y=this.y,w=this.width,A=this.height,_=Wt.MIN_SIZE/d,S=Wt.MIN_SIZE/f;l=Math.max(Math.min(l,1/w,1/A),_/w,S/A);const C=Wt._round(w*l),M=Wt._round(A*l);if(C===w&&M===A)return;this.#u||=[p,y,w,A];const N=u(w/2,A/2),k=Wt._round(p+N[0]),j=Wt._round(y+N[1]),F=u(C/2,M/2);this.x=k-F[0],this.y=j-F[1],this.width=C,this.height=M,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=wn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#I(t);return}this.#k(t)}#k(t){const{isMac:e}=wn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#I(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const a=new AbortController,l=this._uiManager.combinedSignal(a),c={capture:!0,passive:!1,signal:l},u=f=>{a.abort(),this.#a=null,this.#m=!1,this._uiManager.endDragSession()||this.#k(f),i&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#S=t.clientY,this.#a=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:w}=f;if(w!==this.#a){en(f);return}const[A,_]=this.screenToPageTranslation(p-this.#E,y-this.#S);this.#E=p,this.#S=y,this._uiManager.dragSelectedEditors(A,_)},c),window.addEventListener("touchmove",en,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),en(f)},c));const d=f=>{if(!this.#a||this.#a===f.pointerId){u(f);return}en(f)};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const a=this.parentScale,[l,c]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,p=e/a,y=this.x*l,w=this.y*c,A=this.width*l,_=this.height*c;switch(i){case 0:return[y+f+u,c-w-p-_+d,y+f+A+u,c-w-p+d];case 90:return[y+p+u,c-w+f+d,y+p+_+u,c-w+f+A+d];case 180:return[y-f-A+u,c-w+p+d,y-f+u,c-w+p+_+d];case 270:return[y-p-_+u,c-w-f-A+d,y-p+u,c-w-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,a,l,c]=t,u=l-i,d=c-a;switch(this.rotation){case 0:return[i,e-c,u,d];case 90:return[i,e-a,d,u];case 180:return[l,e-a,u,d];case 270:return[l,e-c,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Wt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:a,deleted:l,richText:c},uid:u,pageIndex:d,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:i||p,popupRef:!l,color:e,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:a}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return e<c&&a>0&&t<l&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[l,c]=a.pageDimensions,[u,d,f,p]=a.getRectInCurrentCoords(t.rect,c);return a.x=u/l,a.y=d/c,a.width=f/l,a.height=p/c,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#B(),this.removeEditToolbar(),this.#w){for(const t of this.#w.values())clearTimeout(t);this.#w=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,a,l,c]=this.getPDFRect();return[Wt._round(i+(l-i)*t),Wt._round(a+(c-a)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const c=this.#K.bind(this),u=this.#$.bind(this),d=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,p),{signal:d}),f.setAttribute("data-l10n-id",Wt._l10nResizer[p])}}const i=this.#e[0];let a=0;for(const c of e){if(c===i)break;a++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==a){if(l<a)for(let u=0;u<a-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>a)for(let u=0;u<l-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of e){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Wt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#K(t){Wt._resizerKeyboardManager.exec(this,t)}#$(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#B()}#X(t){this.#g=this.#v?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#P(this.#g,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#w||=new Map;const{action:i}=t;let a=this.#w.get(i);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#w.delete(i),this.#w.size===0&&(this.#w=null)},Wt._telemetryTimeout),this.#w.set(i,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class YC extends Wt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const ev=3285377520,Ui=4294901760,xs=65535;class kw{constructor(t){this.h1=t?t&4294967295:ev,this.h2=t?t&4294967295:ev}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let S=0,C=t.length;S<C;S++){const M=t.charCodeAt(S);M<=255?e[i++]=M:(e[i++]=M>>>8,e[i++]=M&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=i>>2,l=i-a*4,c=new Uint32Array(e.buffer,0,a);let u=0,d=0,f=this.h1,p=this.h2;const y=3432918353,w=461845907,A=y&xs,_=w&xs;for(let S=0;S<a;S++)S&1?(u=c[S],u=u*y&Ui|u*A&xs,u=u<<15|u>>>17,u=u*w&Ui|u*_&xs,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=c[S],d=d*y&Ui|d*A&xs,d=d<<15|d>>>17,d=d*w&Ui|d*_&xs,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=e[a*4+2]<<16;case 2:u^=e[a*4+1]<<8;case 1:u^=e[a*4],u=u*y&Ui|u*A&xs,u=u<<15|u>>>17,u=u*w&Ui|u*_&xs,a&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Ui|t*36045&xs,e=e*4283543511&Ui|((e<<16|t>>>16)*2950163797&Ui)>>>16,t^=e>>>1,t=t*444984403&Ui|t*60499&xs,e=e*3301882366&Ui|((e<<16|t>>>16)*3120437893&Ui)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const sm=Object.freeze({map:null,hash:"",transfer:void 0});class Fm{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof Wt&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#n.values())if(i instanceof Wt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let a=!1;if(i!==void 0)for(const[l,c]of Object.entries(e))i[l]!==c&&(a=!0,i[l]=c);else a=!0,this.#n.set(t,e);a&&this.#s(),e instanceof Wt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Lw(this)}get serializable(){if(this.#n.size===0)return sm;const t=new Map,e=new kw,i=[],a=Object.create(null);let l=!1;for(const[c,u]of this.#n){const d=u instanceof Wt?u.serialize(!1,a):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(t.set(c,d),e.update(`${c}:${JSON.stringify(d)}`),l||=!!d.bitmap)}if(l)for(const c of t.values())c.bitmap&&i.push(c.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:sm}get editorStats(){let t=null;const e=new Map;let i=0,a=0;for(const l of this.#n.values()){if(!(l instanceof Wt)){l.popup&&(l.popup.deleted?a+=1:i+=1);continue}l.isCommentDeleted?a+=1:l.hasEditedComment&&(i+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;e.has(u)||e.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,p]of Object.entries(c)){if(f==="type")continue;let y=d.get(f);y||(y=new Map,d.set(f,y));const w=y.get(p)??0;y.set(p,w+1)}}if((a>0||i>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:i}),!t)return null;for(const[l,c]of e)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#i?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Lw extends Fm{#t;constructor(t){super();const{map:e,hash:i,transfer:a}=t.serializable,l=structuredClone(e,a?{transfer:a}:null);this.#t={map:l,hash:i,transfer:a}}get print(){Me("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return ie(this,"modifiedIds",{ids:new Set,hash:""})}}class QC{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Re(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:l,style:c}=t,u=new FontFace(a,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),i?.(t)}catch{ne(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Me("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(a){throw ne(`Failed to load font '${i.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const a=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return ie(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return ie(this,"isSyncFontLoadingSupported",Wn||wn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Re(!a.done,"completeRequest() cannot be called twice."),a.done=!0;i.length>0&&i[0].done;){const l=i.shift();setTimeout(l.callback,0)}}const{loadingRequests:i}=this,a={done:!1,complete:e,callback:t};return i.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ie(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(j,F){return j.charCodeAt(F)<<24|j.charCodeAt(F+1)<<16|j.charCodeAt(F+2)<<8|j.charCodeAt(F+3)&255}function a(j,F,z,H){const ut=j.substring(0,F),ft=j.substring(F+z);return ut+H+ft}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function p(j,F){if(++f>30){ne("Load test font never loaded."),F();return}if(d.font="30px "+j,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(p.bind(null,j,F))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=a(w,976,y.length,y);const _=16,S=1482184792;let C=i(w,_);for(l=0,c=y.length-3;l<c;l+=4)C=C-S+i(y,l)|0;l<y.length&&(C=C-S+i(y+"XXX",l)|0),w=a(w,_,4,OC(C));const M=`url(data:font/opentype;base64,${btoa(w)});`,N=`@font-face {font-family:"${y}";src:${M}}`;this.insertRule(N);const k=this._document.createElement("div");k.style.visibility="hidden",k.style.width=k.style.height="10px",k.style.position="absolute",k.style.top=k.style.left="0px";for(const j of[t.loadedName,y]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=j,k.append(F)}this._document.body.append(k),p(y,()=>{k.remove(),e.complete()})}}class WC{#t;constructor(t,e=null,i,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let a;try{a=t.get(i)}catch(c){ne(`getPathGenerator - ignoring character: "${c}".`)}const l=Ow(a?.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){ie(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){ie(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class al{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let a=0;for(const f of al.strings){const p=e.encode(t[f]);i[f]=p,a+=4+p.length}const l=new ArrayBuffer(a),c=new Uint8Array(l),u=new DataView(l);let d=0;for(const f of al.strings){const p=i[f],y=p.length;u.setUint32(d,y),c.set(p,d+4),d+=4+y}return Re(d===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Re(t<al.strings.length,"Invalid string index");let e=0;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class rl{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let a=0;for(const w of rl.strings){const A=e.encode(t[w]);i[w]=A,a+=4+A.length}a+=4;let l,c,u=1+a;t.style&&(l=e.encode(t.style.style),c=e.encode(t.style.weight),u+=4+l.length+4+c.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,a=0;for(const w of rl.strings){const A=i[w],_=A.length;a+=4+_,p.setUint32(y,_),f.set(A,y+4),y+=4+_}return p.setUint32(y-a-4,a),t.style&&(p.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length,p.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Re(y<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Re(t<rl.strings.length,"Invalid string index");let e=5;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const a=this.#e.getUint32(t),l=this.#i.decode(new Uint8Array(this.#t,t+4,a));return{style:i,weight:l}}}class Fe{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#s=this.#n+1+6;#r;#a;#o;constructor({data:t,extra:e}){this.#r=t,this.#a=new TextDecoder,this.#o=new DataView(this.#r),e&&Object.assign(this,e)}#c(t){Re(t<Fe.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,a=this.#o.getUint8(e)>>i&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Re(t<Fe.numbers.length,"Invalid number index"),this.#o.getFloat64(Fe.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Fe.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<4;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Fe.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<6;a++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Fe.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<3;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Re(t<Fe.strings.length,"Invalid string index");let e=Fe.#s+4;for(let l=0;l<t;l++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),a=new Uint8Array(i);return a.set(new Uint8Array(this.#r,e+4,i)),this.#a.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);if(l!==0)return new Uint8Array(this.#r,t+4,l)}clearData(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,l).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);if(a===0)return null;const l=new Uint8Array(a);return l.set(new Uint8Array(this.#r,t+4,a)),new al(l.buffer)}get systemFontInfo(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const a=new Uint8Array(i);return a.set(new Uint8Array(this.#r,t+4,i)),new rl(a.buffer)}static write(t){const e=t.systemFontInfo?rl.write(t.systemFontInfo):null,i=t.cssFontInfo?al.write(t.cssFontInfo):null,a=new TextEncoder,l={};let c=0;for(const S of Fe.strings)l[S]=a.encode(t[S]),c+=4+l[S].length;const u=Fe.#s+4+c+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;const w=Fe.bools.length;let A=0,_=0;for(let S=0;S<w;S++){const C=t[Fe.bools[S]];A|=(C===void 0?0:C?2:1)<<_,_+=2,(_===8||S===w-1)&&(p.setUint8(y++,A),A=0,_=0)}Re(y===Fe.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Fe.numbers)p.setFloat64(y,t[S]),y+=8;if(Re(y===Fe.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const S of t.bbox)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Re(y===Fe.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const S of t.fontMatrix)p.setFloat64(y,S,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Re(y===Fe.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const S of t.defaultVMetrics)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=6;Re(y===Fe.#s,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Fe.#s,0),y+=4;for(const S of Fe.strings){const C=l[S],M=C.length;p.setUint32(y,M),f.set(C,y+4),y+=4+M}if(p.setUint32(Fe.#s,y-Fe.#s-4),!e)p.setUint32(y,0),y+=4;else{const S=e.byteLength;p.setUint32(y,S),Re(y+4+S<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),y+4),y+=4+S}if(!i)p.setUint32(y,0),y+=4;else{const S=i.byteLength;p.setUint32(y,S),Re(y+4+S<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+S}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Re(y<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(y)}}class Tn{static#t=0;static#e=1;static#i=2;static#n=3;static#s=4;static#r=8;static#a=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,a=[],l=[],c=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],c=t[3],e===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,d=t[1],a=t[2],l=t[3],u=t[4]||[],i=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(a.length/2),y=Math.floor(l.length/3),w=c.length,A=u.length;let _=0;for(const F of u)_+=1,_=Math.ceil(_/4)*4,_+=4+F.coords.length*4,_+=4+F.colors.length*4,F.verticesPerRow!==void 0&&(_+=4);const S=20+p*8+y*3+w*8+(i?16:0)+(f?3:0)+_,C=new ArrayBuffer(S),M=new DataView(C),N=new Uint8Array(C);M.setUint8(Tn.#t,e),M.setUint8(Tn.#e,i?1:0),M.setUint8(Tn.#i,f?1:0),M.setUint8(Tn.#n,d),M.setUint32(Tn.#s,p,!0),M.setUint32(Tn.#r,y,!0),M.setUint32(Tn.#a,w,!0),M.setUint32(Tn.#o,A,!0);let k=20;new Float32Array(C,k,p*2).set(a),k+=p*8,N.set(l,k),k+=y*3;for(const[F,z]of c)M.setFloat32(k,F,!0),k+=4,M.setUint32(k,parseInt(z.slice(1),16),!0),k+=4;if(i)for(const F of i)M.setFloat32(k,F,!0),k+=4;f&&(N.set(f,k),k+=3);for(let F=0;F<u.length;F++){const z=u[F];M.setUint8(k,z.type),k+=1,k=Math.ceil(k/4)*4,M.setUint32(k,z.coords.length,!0),k+=4,new Int32Array(C,k,z.coords.length).set(z.coords),k+=z.coords.length*4,M.setUint32(k,z.colors.length,!0),k+=4,new Int32Array(C,k,z.colors.length).set(z.colors),k+=z.colors.length*4,z.verticesPerRow!==void 0&&(M.setUint32(k,z.verticesPerRow,!0),k+=4)}return C}getIR(){const t=this.view,e=this.data[Tn.#t],i=!!this.data[Tn.#e],a=!!this.data[Tn.#i],l=t.getUint32(Tn.#s,!0),c=t.getUint32(Tn.#r,!0),u=t.getUint32(Tn.#a,!0),d=t.getUint32(Tn.#o,!0);let f=20;const p=new Float32Array(this.buffer,f,l*2);f+=l*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const w=[];for(let C=0;C<u;++C){const M=t.getFloat32(f,!0);f+=4;const N=t.getUint32(f,!0);f+=4,w.push([M,`#${N.toString(16).padStart(6,"0")}`])}let A=null;if(i){A=[];for(let C=0;C<4;++C)A.push(t.getFloat32(f,!0)),f+=4}let _=null;a&&(_=new Uint8Array(this.buffer,f,3),f+=3);const S=[];for(let C=0;C<d;++C){const M=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const N=t.getUint32(f,!0);f+=4;const k=new Int32Array(this.buffer,f,N);f+=N*4;const j=t.getUint32(f,!0);f+=4;const F=new Int32Array(this.buffer,f,j);f+=j*4;const z={type:M,coords:k,colors:F};M===Jp.LATTICE&&(z.verticesPerRow=t.getUint32(f,!0),f+=4),S.push(z)}if(e===1)return["RadialAxial","axial",A,w,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",A,w,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(e===3){const C=this.data[Tn.#n];let M=null;if(p.length>0){let N=p[0],k=p[0],j=p[1],F=p[1];for(let z=0;z<p.length;z+=2){const H=p[z],ut=p[z+1];N=N>H?H:N,j=j>ut?ut:j,k=k<H?H:k,F=F<ut?ut:F}M=[N,j,k,F]}return["Mesh",C,p,y,S,M,A,_]}throw new Error(`Unsupported pattern kind: ${e}`)}}class ZC{static write(t){let e,i;return wn.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}#t;constructor(t){this.#t=t}get path(){return wn.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function JC(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(Wn)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function tT(r){if(Wn&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return cd(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function wh(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const am=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,eT=r=>typeof r=="object"&&typeof r?.name=="string",nT=BC.bind(null,am,eT);class iT{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,i)})}addEventListener(t,e,i=null){let a=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,e);a=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(e,a)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const xh={DATA:1,ERROR:2},mn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function nv(){}function li(r){if(r instanceof er||r instanceof tm||r instanceof X0||r instanceof Kh||r instanceof Tp)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Me('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new er(r.message);case"InvalidPDFException":return new tm(r.message);case"PasswordException":return new X0(r.message,r.code);case"ResponseException":return new Kh(r.message,r.status,r.missing);case"UnknownErrorException":return new Tp(r.message,r.details)}return new Tp(r.message,r.toString())}class Dc{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,a=this.callbackCapabilities[i];if(!a)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===xh.DATA)a.resolve(t.data);else if(t.callback===xh.ERROR)a.reject(li(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,a=t.sourceName,l=this.comObj;Promise.try(e,t.data).then(function(c){l.postMessage({sourceName:i,targetName:a,callback:xh.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:i,targetName:a,callback:xh.ERROR,callbackId:t.callbackId,reason:li(c)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const a=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[a]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},i)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,e,i,a){const l=this.streamId++,c=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:e,desiredSize:f.desiredSize},a),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,d.postMessage({sourceName:c,targetName:u,stream:mn.PULL,streamId:l,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Re(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,d.postMessage({sourceName:c,targetName:u,stream:mn.CANCEL,streamId:l,reason:li(f)}),p.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],d={enqueue(f,p=1,y){if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=p,w>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:a,stream:mn.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:mn.CLOSE,streamId:e}),delete c.streamSinks[e])},error(f){Re(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:mn.ERROR,streamId:e,reason:li(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:mn.START_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:mn.START_COMPLETE,streamId:e,reason:li(f)})})}#n(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case mn.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(li(t.reason));break;case mn.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(li(t.reason));break;case mn.PULL:if(!u){l.postMessage({sourceName:i,targetName:a,stream:mn.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||nv).then(function(){l.postMessage({sourceName:i,targetName:a,stream:mn.PULL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:mn.PULL_COMPLETE,streamId:e,reason:li(f)})});break;case mn.ENQUEUE:if(Re(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case mn.CLOSE:if(Re(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#s(c,e);break;case mn.ERROR:Re(c,"error should have stream controller"),c.controller.error(li(t.reason)),this.#s(c,e);break;case mn.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(li(t.reason)),this.#s(c,e);break;case mn.CANCEL:if(!u)break;const d=li(t.reason);Promise.try(u.onCancel||nv,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:mn.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:mn.CANCEL_COMPLETE,streamId:e,reason:li(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Pw{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Me("Abstract method `_createCanvas` called.")}}class sT extends Pw{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class Bw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class iv extends Bw{async _fetch(t){const e=await Yc(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):cd(e)}}class jw{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,a,l){return"none"}destroy(t=!1){}}class aT extends jw{#t;#e;#i;#n;#s;#r;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#s=e}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(aa,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#s.createElementNS(aa,"defs"),t.append(i),i.append(this.#i),this.#s.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=d[y]/255;const p=f.join(",");return[p,p,p]}const[e,i,a]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let d=0;d<256;d++)l[d]=e[d]/255,c[d]=i[d]/255,u[d]=a[d]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(ud(e)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=Tw(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,a,l]=this.#d(t),c=t.length===1?i:`${i}${a}${l}`;if(e=this.#o.get(c),e)return this.#o.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#a++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(c,d);const f=this.#m(u);return this.#p(i,a,l,f),d}addHCMFilter(t,e){const i=`${t}-${e}`,a="base";let l=this.#c.get(a);if(l?.key===i||(l?(l.filter?.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},this.#c.set(a,l)),!t||!e))return l.url;const c=this.#v(t);t=qt.makeHexColor(...c);const u=this.#v(e);if(e=qt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return l.url;const d=new Array(256);for(let A=0;A<=255;A++){const _=A/255;d[A]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const f=d.join(","),p=`g_${this.#n}_hcm_filter`,y=l.filter=this.#m(p);this.#p(f,f,f,y),this.#g(y);const w=(A,_)=>{const S=c[A]/255,C=u[A]/255,M=new Array(_+1);for(let N=0;N<=_;N++)M[N]=S+N/_*(C-S);return M.join(",")};return this.#p(w(0,5),w(1,5),w(2,5),y),l.url=this.#h(p),l.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),a=`alpha_${i}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_alpha_map_${this.#a++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#y(i,u),c}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,a;if(t?([i]=this.#d([t]),a=`luminosity_${i}`):a="luminosity",e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_luminosity_map_${this.#a++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#f(u),t&&this.#y(i,u),c}addHighlightHCMFilter(t,e,i,a,l){const c=`${e}-${i}-${a}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!e||!i))return u.url;const[d,f]=[e,i].map(this.#v.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[w,A]=[a,l].map(this.#v.bind(this));y<p&&([p,y,w,A]=[y,p,A,w]),this.#l.style.color="";const _=(M,N,k)=>{const j=new Array(256),F=(y-p)/k,z=M/255,H=(N-M)/(255*k);let ut=0;for(let ft=0;ft<=k;ft++){const _t=Math.round(p+ft*F),ct=z+ft*H;for(let Rt=ut;Rt<=_t;Rt++)j[Rt]=ct;ut=_t+1}for(let ft=ut;ft<256;ft++)j[ft]=j[ut-1];return j.join(",")},S=`g_${this.#n}_hcm_${t}_filter`,C=u.filter=this.#m(S);return this.#g(C),this.#p(_(w[0],A[0],5),_(w[1],A[1],5),_(w[2],A[2],5),C),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#a=0)}#f(t){const e=this.#s.createElementNS(aa,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#s.createElementNS(aa,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#m(t){const e=this.#s.createElementNS(aa,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,i){const a=this.#s.createElementNS(aa,e);a.setAttribute("type","discrete"),a.setAttribute("tableValues",i),t.append(a)}#p(t,e,i,a){const l=this.#s.createElementNS(aa,"feComponentTransfer");a.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",e),this.#u(l,"feFuncB",i)}#y(t,e){const i=this.#s.createElementNS(aa,"feComponentTransfer");e.append(i),this.#u(i,"feFuncA",t)}#v(t){return this.#l.style.color=t,Wc(getComputedStyle(this.#l).getPropertyValue("color"))}}class Fw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class sv extends Fw{async _fetch(t){const e=await Yc(t,"arraybuffer");return new Uint8Array(e)}}class Iw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class av extends Iw{async _fetch(t){const e=await Yc(t,"arraybuffer");return new Uint8Array(e)}}Wn&&ne("Please use the `legacy` build in Node.js environments.");async function Im(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class rT extends jw{}class oT extends Pw{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class lT extends Bw{async _fetch(t){return Im(t)}}class cT extends Fw{async _fetch(t){return Im(t)}}class uT extends Iw{async _fetch(t){return Im(t)}}const Qo="__forcedDependency",{floor:rv,ceil:ov}=Math;function Ah(r,t,e,i,a,l){r[t*4+0]=Math.min(r[t*4+0],e),r[t*4+1]=Math.min(r[t*4+1],i),r[t*4+2]=Math.max(r[t*4+2],a),r[t*4+3]=Math.max(r[t*4+3],l)}const rm=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class hT{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===rm}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Sh=(r,t)=>{if(!r)return;let e=r.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},r.set(t,e)),e};class dT{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Qo]:[]};#i=new Map;#n=[];#s=[];#r=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,e,i=!1){this.#f=t.width,this.#g=t.height,this.#y(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const i=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(i),this.#u=new Uint32Array(i),e&&e.length>0?(this.#u.set(e),this.#u.fill(rm,e.length)):this.#u.fill(rm)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Qo]:{__proto__:this.#e[Qo]}},this.#a={__proto__:this.#a},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const i=this.#n.pop();return i!==void 0&&(Sh(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(Sh(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#s.push(t),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(Sh(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#r.push(qt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#i.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Qo,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Qo,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,a,l,c){const u=qt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];qt.axialAlignedBoundingBox([i,l,a,c],u,d);const f=qt.intersect(this.#a,d);return f?(this.#a[0]=f[0],this.#a[1]=f[1],this.#a[2]=f[2],this.#a[3]=f[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,i,a,l,c){const u=this.#a;if(u[0]===1/0)return this;const d=qt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(u[0]===-1/0)return qt.axialAlignedBoundingBox([i,l,a,c],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return qt.axialAlignedBoundingBox([i,l,a,c],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,i,a=1,l=0,c=0,u){const d=i.bbox;let f,p;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(i),f!==!1&&(p=[0,0,0,0],qt.axialAlignedBoundingBox(d,i.fontMatrix,p),(a!==1||l!==0||c!==0)&&qt.scaleMinMax([a,0,0,-a,l,c],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return d&&p&&f===void 0&&(f=p[0]<=l-y.actualBoundingBoxLeft&&p[2]>=l+y.actualBoundingBoxRight&&p[1]<=c-y.actualBoundingBoxAscent&&p[3]>=c+y.actualBoundingBoxDescent,this.#h.set(i,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,l-y.actualBoundingBoxLeft,l+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#f,this.#a[2]),this.#o[3]=Math.min(this.#g,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,a=this.#t,l=this.#e;for(const c of e)c in this.#t?i.add(a[c]):c in l&&l[c].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Qo]),this.#p){const i=Sh(this.#p,t),{dependencies:a}=i;this.#l.forEach(a.add,a),this.#n.forEach(a.add,a),this.#s.forEach(a.add,a),a.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=rv(this.#o[0]*256/this.#f),a=rv(this.#o[1]*256/this.#g),l=ov(this.#o[2]*256/this.#f),c=ov(this.#o[3]*256/this.#g);Ah(this.#m,t,i,a,l,c);for(const u of this.#l)u!==t&&Ah(this.#m,u,i,a,l,c);for(const u of this.#n)u!==t&&Ah(this.#m,u,i,a,l,c);for(const u of this.#s)u!==t&&Ah(this.#m,u,i,a,l,c);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const a of i)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new hT(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class Xh{#t;#e;#i;#n=0;#s=0;constructor(t,e,i){if(t instanceof Xh&&t.#i===!!i)return t;this.#t=t,this.#e=e,this.#i=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,a,l,c){return this.#i||this.#t.recordClipBox(this.#e,e,i,a,l,c),this}recordBBox(t,e,i,a,l,c){return this.#i||this.#t.recordBBox(this.#e,e,i,a,l,c),this}recordCharacterBBox(t,e,i,a,l,c,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,i,a,l,c,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const zi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Fn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function om(r,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,i),r.clip(a)}class Um{isModifyingCurrentTransform(){return!1}getPattern(){Me("Abstract method `getPattern` called.")}}class fT extends Um{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,a=this._p0,l=this._p1;if(e&&(a=a.slice(),l=l.slice(),qt.applyTransform(a,e),qt.applyTransform(l,e)),this._type==="axial")i=t.createLinearGradient(a[0],a[1],l[0],l[1]);else if(this._type==="radial"){let c=this._r0,u=this._r1;if(e){const d=new Float32Array(2);qt.singularValueDecompose2dScale(e,d),c*=d[0],u*=d[0]}i=t.createRadialGradient(a[0],a[1],c,l[0],l[1],u)}for(const c of this._colorStops)i.addColorStop(c[0],c[1]);return i}getPattern(t,e,i,a){let l;if(a===Fn.STROKE||a===Fn.FILL){if(this.isOriginBased()){let w=qt.transform(i,e.baseTransform);this.matrix&&(w=qt.transform(w,this.matrix));const A=.001,_=Math.hypot(w[0],w[1]),S=Math.hypot(w[2],w[3]),C=(w[0]*w[2]+w[1]*w[3])/(_*S);if(Math.abs(C)<A)if(this.isRadial()){if(Math.abs(_-S)<A)return this._createGradient(t,w)}else return this._createGradient(t,w)}const c=e.current.getClippedPathBoundingBox(a,We(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),i=qt.transform(i,[1,0,0,1,c[0],c[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),om(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(i);l.setTransform(y)}else om(t,this._bbox),l=this._createGradient(t);return l}}function Dp(r,t,e,i,a,l,c,u){const d=t.coords,f=t.colors,p=r.data,y=r.width*4;let w;d[e+1]>d[i+1]&&(w=e,e=i,i=w,w=l,l=c,c=w),d[i+1]>d[a+1]&&(w=i,i=a,a=w,w=c,c=u,u=w),d[e+1]>d[i+1]&&(w=e,e=i,i=w,w=l,l=c,c=w);const A=(d[e]+t.offsetX)*t.scaleX,_=(d[e+1]+t.offsetY)*t.scaleY,S=(d[i]+t.offsetX)*t.scaleX,C=(d[i+1]+t.offsetY)*t.scaleY,M=(d[a]+t.offsetX)*t.scaleX,N=(d[a+1]+t.offsetY)*t.scaleY;if(_>=N)return;const k=f[l],j=f[l+1],F=f[l+2],z=f[c],H=f[c+1],ut=f[c+2],ft=f[u],_t=f[u+1],ct=f[u+2],Rt=Math.round(_),Lt=Math.round(N);let Bt,$t,G,st,wt,Xt,Ct,U;for(let J=Rt;J<=Lt;J++){if(J<C){const Ot=J<_?0:(_-J)/(_-C);Bt=A-(A-S)*Ot,$t=k-(k-z)*Ot,G=j-(j-H)*Ot,st=F-(F-ut)*Ot}else{let Ot;J>N?Ot=1:C===N?Ot=0:Ot=(C-J)/(C-N),Bt=S-(S-M)*Ot,$t=z-(z-ft)*Ot,G=H-(H-_t)*Ot,st=ut-(ut-ct)*Ot}let mt;J<_?mt=0:J>N?mt=1:mt=(_-J)/(_-N),wt=A-(A-M)*mt,Xt=k-(k-ft)*mt,Ct=j-(j-_t)*mt,U=F-(F-ct)*mt;const xt=Math.round(Math.min(Bt,wt)),It=Math.round(Math.max(Bt,wt));let Ut=y*J+xt*4;for(let Ot=xt;Ot<=It;Ot++)mt=(Bt-Ot)/(Bt-wt),mt<0?mt=0:mt>1&&(mt=1),p[Ut++]=$t-($t-Xt)*mt|0,p[Ut++]=G-(G-Ct)*mt|0,p[Ut++]=st-(st-U)*mt|0,p[Ut++]=255}}function pT(r,t,e){const i=t.coords,a=t.colors;let l,c;switch(t.type){case Jp.LATTICE:const u=t.verticesPerRow,d=Math.floor(i.length/u)-1,f=u-1;for(l=0;l<d;l++){let p=l*u;for(let y=0;y<f;y++,p++)Dp(r,e,i[p],i[p+1],i[p+u],a[p],a[p+1],a[p+u]),Dp(r,e,i[p+u+1],i[p+1],i[p+u],a[p+u+1],a[p+1],a[p+u])}break;case Jp.TRIANGLES:for(l=0,c=i.length;l<c;l+=3)Dp(r,e,i[l],i[l+1],i[l+2],a[l],a[l+1],a[l+2]);break;default:throw new Error("illegal figure")}}class mT extends Um{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),w=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),A=f/y,_=p/w,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/A,scaleY:1/_},C=y+4,M=w+4,N=i.getCanvas("mesh",C,M),k=N.context,j=k.createImageData(y,w);if(e){const z=j.data;for(let H=0,ut=z.length;H<ut;H+=4)z[H]=e[0],z[H+1]=e[1],z[H+2]=e[2],z[H+3]=255}for(const z of this._figures)pT(j,z,S);return k.putImageData(j,2,2),{canvas:N.canvas,offsetX:u-2*A,offsetY:d-2*_,scaleX:A,scaleY:_}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,a){om(t,this._bbox);const l=new Float32Array(2);if(a===Fn.SHADING)qt.singularValueDecompose2dScale(We(t),l);else if(this.matrix){qt.singularValueDecompose2dScale(this.matrix,l);const[u,d]=l;qt.singularValueDecompose2dScale(e.baseTransform,l),l[0]*=u,l[1]*=d}else qt.singularValueDecompose2dScale(e.baseTransform,l);const c=this._createMeshCanvas(l,a===Fn.SHADING?null:this._background,e.cachedCanvases);return a!==Fn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class gT extends Um{getPattern(){return"hotpink"}}function yT(r){switch(r[0]){case"RadialAxial":return new fT(r);case"Mesh":return new mT(r);case"Dummy":return new gT}throw new Error(`Unknown IR type: ${r[0]}`)}const lv={COLORED:1,UNCOLORED:2};class zm{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=a}createPatternCanvas(t,e){const{bbox:i,operatorList:a,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),ld("TilingType: "+c);const y=i[0],w=i[1],A=i[2],_=i[3],S=A-y,C=_-w,M=new Float32Array(2);qt.singularValueDecompose2dScale(this.matrix,M);const[N,k]=M;qt.singularValueDecompose2dScale(this.baseTransform,M);const j=N*M[0],F=k*M[1];let z=S,H=C,ut=!1,ft=!1;const _t=Math.ceil(f*j),ct=Math.ceil(p*F),Rt=Math.ceil(S*j),Lt=Math.ceil(C*F);_t>=Rt?z=f:ut=!0,ct>=Lt?H=p:ft=!0;const Bt=this.getSizeAndScale(z,this.ctx.canvas.width,j),$t=this.getSizeAndScale(H,this.ctx.canvas.height,F),G=t.cachedCanvases.getCanvas("pattern",Bt.size,$t.size),st=G.context,wt=d.createCanvasGraphics(st,e);if(wt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(wt,l,u),st.translate(-Bt.scale*y,-$t.scale*w),wt.transform(0,Bt.scale,0,0,$t.scale,0,0),st.save(),wt.dependencyTracker?.save(),this.clipBbox(wt,y,w,A,_),wt.baseTransform=We(wt.ctx),wt.executeOperatorList(a),wt.endDrawing(),wt.dependencyTracker?.restore(),st.restore(),ut||ft){const Xt=G.canvas;ut&&(z=f),ft&&(H=p);const Ct=this.getSizeAndScale(z,this.ctx.canvas.width,j),U=this.getSizeAndScale(H,this.ctx.canvas.height,F),J=Ct.size,mt=U.size,xt=t.cachedCanvases.getCanvas("pattern-workaround",J,mt),It=xt.context,Ut=ut?Math.floor(S/f):0,Ot=ft?Math.floor(C/p):0;for(let Tt=0;Tt<=Ut;Tt++)for(let jt=0;jt<=Ot;jt++)It.drawImage(Xt,J*Tt,mt*jt,J,mt,0,0,J,mt);return{canvas:xt.canvas,scaleX:Ct.scale,scaleY:U.scale,offsetX:y,offsetY:w}}return{canvas:G.canvas,scaleX:Bt.scale,scaleY:$t.scale,offsetX:y,offsetY:w}}getSizeAndScale(t,e,i){const a=Math.max(zm.MAX_PATTERN_SIZE,e);let l=Math.ceil(t*i);return l>=a?l=a:i=l/t,{scale:i,size:l}}clipBbox(t,e,i,a,l){const c=a-e,u=l-i;t.ctx.rect(e,i,c,u),qt.axialAlignedBoundingBox([e,i,a,l],We(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const a=t.ctx,l=t.current;switch(e){case lv.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;a.fillStyle=l.fillColor=c,a.strokeStyle=l.strokeColor=u;break;case lv.UNCOLORED:a.fillStyle=a.strokeStyle=i,l.fillColor=l.strokeColor=i;break;default:throw new MC(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,a,l){let c=i;a!==Fn.SHADING&&(c=qt.transform(c,e.baseTransform),this.matrix&&(c=qt.transform(c,this.matrix)));const u=this.createPatternCanvas(e,l);let d=new DOMMatrix(c);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function bT({src:r,srcPos:t=0,dest:e,width:i,height:a,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=wn.isLittleEndian?4278190080:255,[d,f]=c?[l,u]:[u,l],p=i>>3,y=i&7,w=r.length;e=new Uint32Array(e.buffer);let A=0;for(let _=0;_<a;_++){for(const C=t+p;t<C;t++){const M=t<w?r[t]:255;e[A++]=M&128?f:d,e[A++]=M&64?f:d,e[A++]=M&32?f:d,e[A++]=M&16?f:d,e[A++]=M&8?f:d,e[A++]=M&4?f:d,e[A++]=M&2?f:d,e[A++]=M&1?f:d}if(y===0)continue;const S=t<w?r[t++]:255;for(let C=0;C<y;C++)e[A++]=S&1<<7-C?f:d}return{srcPos:t,destPos:A}}const cv=16,uv=100,vT=15,hv=10,ci=16,Op=new DOMMatrix,Ei=new Float32Array(2),nl=new Float32Array([1/0,1/0,-1/0,-1/0]);function wT(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},r.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},r.transform=function(e,i,a,l,c,u){t.transform(e,i,a,l,c,u),this.__originalTransform(e,i,a,l,c,u)},r.setTransform=function(e,i,a,l,c,u){t.setTransform(e,i,a,l,c,u),this.__originalSetTransform(e,i,a,l,c,u)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},r.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},r.bezierCurveTo=function(e,i,a,l,c,u){t.bezierCurveTo(e,i,a,l,c,u),this.__originalBezierCurveTo(e,i,a,l,c,u)},r.rect=function(e,i,a,l){t.rect(e,i,a,l),this.__originalRect(e,i,a,l)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class xT{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,i)):(a=this.canvasFactory.create(e,i),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Eh(r,t,e,i,a,l,c,u,d,f){const[p,y,w,A,_,S]=We(r);if(y===0&&w===0){const N=c*p+_,k=Math.round(N),j=u*A+S,F=Math.round(j),z=(c+d)*p+_,H=Math.abs(Math.round(z)-k)||1,ut=(u+f)*A+S,ft=Math.abs(Math.round(ut)-F)||1;return r.setTransform(Math.sign(p),0,0,Math.sign(A),k,F),r.drawImage(t,e,i,a,l,0,0,H,ft),r.setTransform(p,y,w,A,_,S),[H,ft]}if(p===0&&A===0){const N=u*w+_,k=Math.round(N),j=c*y+S,F=Math.round(j),z=(u+f)*w+_,H=Math.abs(Math.round(z)-k)||1,ut=(c+d)*y+S,ft=Math.abs(Math.round(ut)-F)||1;return r.setTransform(0,Math.sign(y),Math.sign(w),0,k,F),r.drawImage(t,e,i,a,l,0,0,ft,H),r.setTransform(p,y,w,A,_,S),[ft,H]}r.drawImage(t,e,i,a,l,c,u,d,f);const C=Math.hypot(p,y),M=Math.hypot(w,A);return[C*d,M*f]}class dv{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Zp;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=bn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=nl.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Fn.FILL,e=null){const i=this.minMax.slice();if(t===Fn.STROKE){e||Me("Stroke bounding box must include transform."),qt.singularValueDecompose2dScale(e,Ei);const a=Ei[0]*this.lineWidth/2,l=Ei[1]*this.lineWidth/2;i[0]-=a,i[1]-=l,i[2]+=a,i[3]+=l}return i}updateClipFromPath(){const t=qt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(nl,0)}getClippedPathBoundingBox(t=Fn.FILL,e=null){return qt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function fv(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,i=t.width,a=e%ci,l=(e-a)/ci,c=a===0?l:l+1,u=r.createImageData(i,ci);let d=0,f;const p=t.data,y=u.data;let w,A,_,S;if(t.kind===jh.GRAYSCALE_1BPP){const C=p.byteLength,M=new Uint32Array(y.buffer,0,y.byteLength>>2),N=M.length,k=i+7>>3,j=4294967295,F=wn.isLittleEndian?4278190080:255;for(w=0;w<c;w++){for(_=w<l?ci:a,f=0,A=0;A<_;A++){const z=C-d;let H=0;const ut=z>k?i:z*8-7,ft=ut&-8;let _t=0,ct=0;for(;H<ft;H+=8)ct=p[d++],M[f++]=ct&128?j:F,M[f++]=ct&64?j:F,M[f++]=ct&32?j:F,M[f++]=ct&16?j:F,M[f++]=ct&8?j:F,M[f++]=ct&4?j:F,M[f++]=ct&2?j:F,M[f++]=ct&1?j:F;for(;H<ut;H++)_t===0&&(ct=p[d++],_t=128),M[f++]=ct&_t?j:F,_t>>=1}for(;f<N;)M[f++]=0;r.putImageData(u,0,w*ci)}}else if(t.kind===jh.RGBA_32BPP){for(A=0,S=i*ci*4,w=0;w<l;w++)y.set(p.subarray(d,d+S)),d+=S,r.putImageData(u,0,A),A+=ci;w<c&&(S=i*a*4,y.set(p.subarray(d,d+S)),r.putImageData(u,0,A))}else if(t.kind===jh.RGB_24BPP)for(_=ci,S=i*_,w=0;w<c;w++){for(w>=l&&(_=a,S=i*_),f=0,A=S;A--;)y[f++]=p[d++],y[f++]=p[d++],y[f++]=p[d++],y[f++]=255;r.putImageData(u,0,w*ci)}else throw new Error(`bad image kind: ${t.kind}`)}function pv(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,a=e%ci,l=(e-a)/ci,c=a===0?l:l+1,u=r.createImageData(i,ci);let d=0;const f=t.data,p=u.data;for(let y=0;y<c;y++){const w=y<l?ci:a;({srcPos:d}=bT({src:f,srcPos:d,dest:p,width:i,height:w,nonBlackColor:0})),r.putImageData(u,0,y*ci)}}function Ec(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)r[i]!==void 0&&(t[i]=r[i]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function _h(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function mv(r,t){if(t)return!0;qt.singularValueDecompose2dScale(r,Ei);const e=Math.fround(Rs.pixelRatio*hl.PDF_TO_CSS_UNITS);return Ei[0]<=e&&Ei[1]<=e}const AT=["butt","round","square"],ST=["miter","round","bevel"],ET={},gv={};class ol{constructor(t,e,i,a,l,{optionalContentConfig:c,markedContentStack:u=null},d,f,p){this.ctx=t,this.current=new dv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=a,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new xT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:a=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,i){const d=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...We(this.compositeCtx))}this.ctx.save(),_h(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=We(this.ctx)}executeOperatorList(t,e,i,a,l){const c=t.argsArray,u=t.fnArray;let d=e||0;const f=c.length;if(f===d)return d;const p=f-d>hv&&typeof i=="function",y=p?Date.now()+vT:0;let w=0;const A=this.commonObjs,_=this.objs;let S,C;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,i),d;if(!l||l(d))if(S=u[d],C=c[d]??null,S!==Fc.dependency)C===null?this[S](d):this[S](d,...C);else for(const M of C){this.dependencyTracker?.recordNamedData(M,d);const N=M.startsWith("g_")?A:_;if(!N.has(M))return N.get(M,i),d}if(d++,d===f)return d;if(p&&++w>hv){if(Date.now()>y)return i(),d;w=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,a=t.height??t.displayHeight;let l=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),u=i,d=a,f="prescale1",p,y;for(;l>2&&u>1||c>2&&d>1;){let w=u,A=d;l>2&&u>1&&(w=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/w),c>2&&d>1&&(A=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/A),p=this.cachedCanvases.getCanvas(f,w,A),y=p.context,y.clearRect(0,0,w,A),y.drawImage(t,0,0,u,d,0,0,w,A),t=p.canvas,u=w,d=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const i=this.ctx,{width:a,height:l}=e,c=this.current.fillColor,u=this.current.patternFill,d=We(i);let f,p,y,w;if((e.bitmap||e.data)&&e.count>1){const _t=e.bitmap||e.data.buffer;p=JSON.stringify(u?d:[d.slice(0,4),c]),f=this._cachedBitmapsMap.get(_t),f||(f=new Map,this._cachedBitmapsMap.set(_t,f));const ct=f.get(p);if(ct&&!u){const Rt=Math.round(Math.min(d[0],d[2])+d[4]),Lt=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,zi.transformAndFill),{canvas:ct,offsetX:Rt,offsetY:Lt}}y=ct}y||(w=this.cachedCanvases.getCanvas("maskCanvas",a,l),pv(w.context,e));let A=qt.transform(d,[1/a,0,0,-1/l,0,0]);A=qt.transform(A,[1,0,0,1,0,-l]);const _=nl.slice();qt.axialAlignedBoundingBox([0,0,a,l],A,_);const[S,C,M,N]=_,k=Math.round(M-S)||1,j=Math.round(N-C)||1,F=this.cachedCanvases.getCanvas("fillCanvas",k,j),z=F.context,H=S,ut=C;z.translate(-H,-ut),z.transform(...A),y||(y=this._scaleImage(w.canvas,ws(z)),y=y.img,f&&u&&f.set(p,y)),z.imageSmoothingEnabled=mv(We(z),e.interpolate),Eh(z,y,0,0,y.width,y.height,0,0,a,l),z.globalCompositeOperation="source-in";const ft=qt.transform(ws(z),[1,0,0,1,-H,-ut]);return z.fillStyle=u?c.getPattern(i,this,ft,Fn.FILL,t):c,z.fillRect(0,0,a,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,F.canvas)),this.dependencyTracker?.recordDependencies(t,zi.transformAndFill),{canvas:F.canvas,offsetX:Math.round(H),offsetY:Math.round(ut)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=AT[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=ST[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(e),a.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,a]of e)switch(i){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(a,e,i);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),Ec(this.suspendedCtx,c),wT(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Ec(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,a){const l=a[0],c=a[1],u=a[2]-l,d=a[3]-c;u===0||d===0||(this.genericComposeSMask(e.context,i,u,d,e.subtype,e.backdrop,e.transferMap,l,c,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,a,l,c,u,d,f,p,y){let w=t.canvas,A=d-p,_=f-y;if(c)if(A<0||_<0||A+i>w.width||_+a>w.height){const C=this.cachedCanvases.getCanvas("maskExtension",i,a),M=C.context;M.drawImage(w,-A,-_),M.globalCompositeOperation="destination-atop",M.fillStyle=c,M.fillRect(0,0,i,a),M.globalCompositeOperation="source-over",w=C.canvas,A=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(A,_,i,a),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,_,i,a),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(d,f,i,a),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(w,A,_,i,a,d,f,i,a),e.restore()}save(t){this.inSMaskMode&&Ec(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Ec(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,a,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,a,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,a){let[l]=i;if(!a){l||=i[0]=new Path2D,this[e](t,l);return}if(this.dependencyTracker!==null){const c=e===Fc.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-c,a[2]+c,a[1]-c,a[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=i[0]=Ow(l)),qt.axialAlignedBoundingBox(a,We(this.ctx),this.current.minMax),this[e](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const a=this.ctx,l=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=l.getPattern(a,this,ws(a),Fn.STROKE,t),c){const u=new Path2D;u.addPath(e,a.getTransform().invertSelf().multiplySelf(c)),e=u}this.rescaleAndStroke(e,!1),a.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,zi.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Fn.STROKE,We(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const a=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=l.getPattern(a,this,ws(a),Fn.FILL,t),f){const p=new Path2D;p.addPath(e,a.getTransform().invertSelf().multiplySelf(f)),e=p}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(e,"evenodd"),this.pendingEOFill=!1):a.fill(e)),this.dependencyTracker?.recordDependencies(t,zi.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,zi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=ET}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=gv}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;e!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(e!==void 0){const a=new Path2D,l=i.getTransform().invertSelf();for(const{transform:c,x:u,y:d,fontSize:f,path:p}of e)p&&a.addPath(p,new DOMMatrix(c).preMultiplySelf(l).translate(u,d).scale(f,-f));i.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const a=this.commonObjs.get(e),l=this.current;if(!a)throw new Error(`Can't find font for ${e}`);if(l.fontMatrix=a.fontMatrix||Zp,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),i<0?(i=-i,l.fontDirection=-1):l.fontDirection=1,this.current.font=a,this.current.fontSize=i,a.isType3Font)return;const c=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${c}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let p=i;i<cv?p=cv:i>uv&&(p=uv),this.current.fontSizeScale=i/p,this.ctx.font=`${f} ${d} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const a=new Path2D;return a.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),a}paintChar(t,e,i,a,l,c){const u=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,y=d.fontSize/d.fontSizeScale,w=p&bn.FILL_STROKE_MASK,A=!!(p&bn.ADD_TO_PATH_FLAG),_=d.patternFill&&!f.missingFile,S=d.patternStroke&&!f.missingFile;let C;if((f.disableFontFace||A||_||S)&&!f.missingFile&&(C=f.getPathGenerator(this.commonObjs,e)),C&&(f.disableFontFace||_||S)){u.save(),u.translate(i,a),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let M;if(w===bn.FILL||w===bn.FILL_STROKE)if(l){M=u.getTransform(),u.setTransform(...l);const N=this.#i(C,M,l);u.fill(N)}else u.fill(C);if(w===bn.STROKE||w===bn.FILL_STROKE)if(c){M||=u.getTransform(),u.setTransform(...c);const{a:N,b:k,c:j,d:F}=M,z=qt.inverseTransform(c),H=qt.transform([N,k,j,F,0,0],z);qt.singularValueDecompose2dScale(H,Ei),u.lineWidth*=Math.max(Ei[0],Ei[1])/y,u.stroke(this.#i(C,M,c))}else u.lineWidth/=y,u.stroke(C);u.restore()}else(w===bn.FILL||w===bn.FILL_STROKE)&&(u.fillText(e,i,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a,()=>u.measureText(e))),(w===bn.STROKE||w===bn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a,()=>u.measureText(e)).recordDependencies(t,zi.stroke),u.strokeText(e,i,a));A&&((this.pendingTextPaths||=[]).push({transform:We(u),x:i,y:a,fontSize:y,path:C}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){i=!0;break}return ie(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,zi.showText).resetBBox(t),this.current.textRenderingMode&bn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,a=i.font;if(a.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const l=i.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=i.fontSizeScale,d=i.charSpacing,f=i.wordSpacing,p=i.fontDirection,y=i.textHScale*p,w=e.length,A=a.vertical,_=A?1:-1,S=a.defaultVMetrics,C=l*i.fontMatrix[0],M=i.textRenderingMode===bn.FILL&&!a.disableFontFace&&!i.patternFill;c.save(),i.textMatrix&&c.transform(...i.textMatrix),c.translate(i.x,i.y+i.textRise),p>0?c.scale(y,-1):c.scale(y,1);let N,k;const j=i.textRenderingMode&bn.FILL_STROKE_MASK,F=j===bn.FILL||j===bn.FILL_STROKE,z=j===bn.STROKE||j===bn.FILL_STROKE;if(F&&i.patternFill){c.save();const ct=i.fillColor.getPattern(c,this,ws(c),Fn.FILL,t);N=We(c),c.restore(),c.fillStyle=ct}if(z&&i.patternStroke){c.save();const ct=i.strokeColor.getPattern(c,this,ws(c),Fn.STROKE,t);k=We(c),c.restore(),c.strokeStyle=ct}let H=i.lineWidth;const ut=i.textMatrixScale;if(ut===0||H===0?z&&(H=this.getSinglePixelWidth()):H/=ut,u!==1&&(c.scale(u,u),H/=u),c.lineWidth=H,a.isInvalidPDFjsFont){const ct=[];let Rt=0;for(const Bt of e)ct.push(Bt.unicode),Rt+=Bt.width;const Lt=ct.join("");if(c.fillText(Lt,0,0),this.dependencyTracker!==null){const Bt=c.measureText(Lt);this.dependencyTracker.recordBBox(t,this.ctx,-Bt.actualBoundingBoxLeft,Bt.actualBoundingBoxRight,-Bt.actualBoundingBoxAscent,Bt.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=Rt*C*y,c.restore(),this.compose();return}let ft=0,_t;for(_t=0;_t<w;++_t){const ct=e[_t];if(typeof ct=="number"){ft+=_*ct*l/1e3;continue}let Rt=!1;const Lt=(ct.isSpace?f:0)+d,Bt=ct.fontChar,$t=ct.accent;let G,st,wt=ct.width;if(A){const U=ct.vmetric||S,J=-(ct.vmetric?U[1]:wt*.5)*C,mt=U[2]*C;wt=U?-U[0]:wt,G=J/u,st=(ft+mt)/u}else G=ft/u,st=0;let Xt;if(a.remeasure&&wt>0){Xt=c.measureText(Bt);const U=Xt.width*1e3/l*u;if(wt<U&&this.isFontSubpixelAAEnabled){const J=wt/U;Rt=!0,c.save(),c.scale(J,1),G/=J}else wt!==U&&(G+=(wt-U)/2e3*l/u)}if(this.contentVisible&&(ct.isInFont||a.missingFile)){if(M&&!$t)c.fillText(Bt,G,st),this.dependencyTracker?.recordCharacterBBox(t,c,Xt?{bbox:null}:a,l/u,G,st,()=>Xt??c.measureText(Bt));else if(this.paintChar(t,Bt,G,st,N,k),$t){const U=G+l*$t.offset.x/u,J=st-l*$t.offset.y/u;this.paintChar(t,$t.fontChar,U,J,N,k)}}const Ct=A?wt*C-Lt*p:wt*C+Lt*p;ft+=Ct,Rt&&c.restore()}A?i.y-=ft:i.x+=ft*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,a=this.current,l=a.font,c=a.fontSize,u=a.fontDirection,d=l.vertical?1:-1,f=a.charSpacing,p=a.wordSpacing,y=a.textHScale*u,w=a.fontMatrix||Zp,A=e.length,_=a.textRenderingMode===bn.INVISIBLE;let S,C,M,N;if(_||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),a.textMatrix&&i.transform(...a.textMatrix),i.translate(a.x,a.y+a.textRise),i.scale(y,u);const k=this.dependencyTracker;for(this.dependencyTracker=k?new Xh(k,t):null,S=0;S<A;++S){if(C=e[S],typeof C=="number"){N=d*C*c/1e3,this.ctx.translate(N,0),a.x+=N*y;continue}const j=(C.isSpace?p:0)+f,F=l.charProcOperatorList[C.operatorListId];F?this.contentVisible&&(this.save(),i.scale(c,c),i.transform(...w),this.executeOperatorList(F),this.restore()):ne(`Type3 character "${C.operatorListId}" is not available.`);const z=[C.width,0];qt.applyTransform(z,w),M=z[0]*c+j,i.translate(M,0),a.x+=M*y}i.restore(),k&&(this.dependencyTracker=k)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,a,l,c,u){const d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,c,l,u).recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const a=this.baseTransform||We(this.ctx),l={createCanvasGraphics:(c,u)=>new ol(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Xh(this.dependencyTracker,u,!0):null)};i=new zm(e,this.ctx,l,a)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let a;return this.cachedPatterns.has(e)?a=this.cachedPatterns.get(e):(a=yT(this.getObject(t,e)),this.cachedPatterns.set(e,a)),i&&(a.matrix=i),a}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const a=this._getPattern(t,e);i.fillStyle=a.getPattern(i,this,ws(i),Fn.SHADING,t);const l=ws(i);if(l){const{width:c,height:u}=i.canvas,d=nl.slice();qt.axialAlignedBoundingBox([0,0,c,u],l,d);const[f,p,y,w]=d;this.ctx.fillRect(f,p,y-f,w-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,zi.transform).recordDependencies(t,zi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Me("Should not call beginInlineImage")}beginImageData(){Me("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=We(this.ctx),i)){qt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[a,l,c,u]=i,d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||ld("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const a=We(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let l=nl.slice();qt.axialAlignedBoundingBox(e.bbox,We(i),l);const c=[0,0,i.canvas.width,i.canvas.height];l=qt.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),d=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),p=Math.max(Math.ceil(l[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const w=this.cachedCanvases.getCanvas(y,f,p),A=w.context;A.translate(-u,-d),A.transform(...a);let _=new Path2D;const[S,C,M,N]=e.bbox;if(_.rect(S,C,M-S,N-C),e.matrix){const k=new Path2D;k.addPath(_,new DOMMatrix(e.matrix)),_=k}A.clip(_),e.smask&&this.smaskStack.push({canvas:w.canvas,context:A,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,d),i.save()),Ec(i,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=We(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=nl.slice();qt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l,c),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,e,i,a,l,c){if(this.#t(),_h(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],d=i[3]-i[1];if(c&&this.annotationCanvasMap){a=a.slice(),a[4]-=i[0],a[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=d,qt.singularValueDecompose2dScale(We(this.ctx),Ei);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:w,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(e,w),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(Ei[0],0,0,-Ei[1],0,d*Ei[1]),_h(this.ctx)}else{_h(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],u,d),this.ctx.clip(f)}}this.current=new dv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const a=this.ctx,l=this._createMaskCanvas(t,e),c=l.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,a=0,l=0,c,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=We(d);d.transform(i,a,l,c,0,0);const p=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,w=u.length;y<w;y+=2){const A=qt.transform(f,[i,a,l,c,u[y],u[y+1]]);d.drawImage(p.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+p.canvas.width,A[5],A[5]+p.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,zi.transformAndFill);for(const c of e){const{data:u,width:d,height:f,transform:p}=c,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),w=y.context;w.save();const A=this.getObject(t,u,c);pv(w,A),w.globalCompositeOperation="source-in",w.fillStyle=l?a.getPattern(w,this,ws(i),Fn.FILL,t):a,w.fillRect(0,0,d,f),w.restore(),i.save(),i.transform(...p),i.scale(1,-1),Eh(i,y.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,d,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,a,l){if(!this.contentVisible)return;const c=this.getObject(t,e);if(!c){ne("Dependent image isn't ready yet");return}const u=c.width,d=c.height,f=[];for(let p=0,y=l.length;p<y;p+=2)f.push({transform:[i,0,0,a,l[p],l[p+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:a}=t,l=this.cachedCanvases.getCanvas("inlineImage",i,a),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(e,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,a=e.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/i,-1/a);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,a).context;fv(p,e),u=this.applyTransferMapsToCanvas(p)}const d=this._scaleImage(u,ws(l));l.imageSmoothingEnabled=mv(We(l),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,i,-a,0).recordDependencies(t,zi.imageXObject).recordOperation(t),Eh(l,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,i,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const a=this.ctx;let l;if(e.bitmap)l=e.bitmap;else{const c=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;fv(f,e),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of i)a.save(),a.transform(...c.transform),a.scale(1,-1),Eh(a,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,zi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const l=this.ctx;this.pendingClip?(a||(this.pendingClip===gv?l.clip(e,"evenodd"):l.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=We(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:a,d:l}=this.ctx.getTransform();let c,u;if(i===0&&a===0){const d=Math.abs(e),f=Math.abs(l);if(d===f)if(t===0)c=u=1/d;else{const p=d*t;c=u=p<1?1/p:1}else if(t===0)c=1/d,u=1/f;else{const p=d*t,y=f*t;c=p<1?1/p:1,u=y<1?1/y:1}}else{const d=Math.abs(e*l-i*a),f=Math.hypot(e,i),p=Math.hypot(a,l);if(t===0)c=p/d,u=f/d;else{const y=t*d;c=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:a}}=this,[l,c]=this.getScaleForStroking();if(l===c){i.lineWidth=(a||1)*l,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(l,c),Op.a=1/l,Op.d=1/c;const d=new Path2D;if(d.addPath(t,Op),u.length>0){const f=Math.max(l,c);i.setLineDash(u.map(p=>p/f)),i.lineDashOffset/=f}i.lineWidth=a||1,i.stroke(d),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const r in Fc)ol.prototype[r]!==void 0&&(ol.prototype[Fc[r]]=ol.prototype[r]);class ll{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class _T{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Zo=Symbol("INTERNAL");class CT{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:a,rbGroups:l}){this.#t=!!(t&Ai.DISPLAY),this.#e=!!(t&Ai.PRINT),this.name=e,this.intent=i,this.usage=a,this.rbGroups=l}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Zo&&Me("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class TT{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=Ai.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new CT(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Zo,!1);for(const i of t.on)this.#e.get(i)._setVisible(Zo,!0);for(const i of t.off)this.#e.get(i)._setVisible(Zo,!1);this.#i=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let a=1;a<e;a++){const l=t[a];let c;if(Array.isArray(l))c=this.#s(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return ne(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return ld("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ne(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ne(`Unknown optional content policy ${t.policy}.`),!0}return ne(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const a=this.#e.get(t);if(!a){ne(`Optional content group not found: ${t}`);return}if(i&&e&&a.rbGroups.length)for(const l of a.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(Zo,!1,!0);a._setVisible(Zo,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":i=a;continue}const l=this.#e.get(a);if(l)switch(i){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!l.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new kw;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class dd{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,e,i){this._source=t,this.#t=e,this.#e=i}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Re(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new this.#e(this,t,e);return this._rangeReaders.add(i),i}cancelAllRequests(t){this._fullReader?.cancel(t);for(const e of new Set(this._rangeReaders))e.cancel(t)}}class fd{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){Me("Abstract method `read` called")}cancel(t){Me("Abstract method `cancel` called")}}class pd{_stream=null;constructor(t,e,i){this._stream=t}async read(){Me("Abstract method `read` called")}cancel(t){Me("Abstract method `cancel` called")}}function yv(r){return r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer}class RT extends dd{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,MT,DT);const{pdfDataRangeTransport:e}=t,{initialData:i,progressiveDone:a}=e;if(i?.length>0){const l=yv(i);this._queuedChunks.push(l)}this._progressiveDone=a,e.addRangeListener((l,c)=>{this.#t(l,c)}),e.addProgressListener((l,c)=>{c!==void 0&&this._fullReader?.onProgress?.({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this.#t(void 0,l)}),e.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),e.transportReady()}#t(t,e){const i=yv(e);if(t===void 0)this._fullReader?this._fullReader._enqueue(i):this._queuedChunks.push(i);else{const a=this._rangeReaders.keys().find(l=>l._begin===t);Re(a,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),a._enqueue(i)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onDone=()=>this._rangeReaders.delete(i),this._source.pdfDataRangeTransport.requestDataRange(t,e)),i}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class MT extends fd{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:e,disableRange:i,disableStream:a}=t._source,{length:l,contentDispositionFilename:c}=e;this._queuedChunks=t._queuedChunks||[];for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._done=t._progressiveDone,this._contentLength=l,this._isStreamingSupported=!a,this._isRangeSupported=!i,Pm(c)&&(this._filename=c),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class DT extends pd{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,e,i){super(t,e,i),this._begin=e}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function OT(r){let t=!0,e=i("filename\\*","i").exec(r);if(e){e=e[1];let p=u(e);return p=unescape(p),p=d(p),p=f(p),l(p)}if(e=c(r),e){const p=f(e);return l(p)}if(e=i("filename","i").exec(r),e){e=e[1];let p=u(e);return p=f(p),l(p)}function i(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function a(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const w=new TextDecoder(p,{fatal:!0}),A=cd(y);y=w.decode(A),t=!1}catch{}}return y}function l(p){return t&&/[\x80-\xff]/.test(p)&&(p=a("utf-8",p),t&&(p=a("iso-8859-1",p))),p}function c(p){const y=[];let w;const A=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(w=A.exec(p))!==null;){let[,S,C,M]=w;if(S=parseInt(S,10),S in y){if(S===0)break;continue}y[S]=[C,M]}const _=[];for(let S=0;S<y.length&&S in y;++S){let[C,M]=y[S];M=u(M),C&&(M=unescape(M),S===0&&(M=d(M))),_.push(M)}return _.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let w=0;w<y.length;++w){const A=y[w].indexOf('"');A!==-1&&(y[w]=y[w].slice(0,A),y.length=w+1),y[w]=y[w].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function d(p){const y=p.indexOf("'");if(y===-1)return p;const w=p.slice(0,y),_=p.slice(y+1).replace(/^[^']*'/,"");return a(w,_)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,w,A,_){if(A==="q"||A==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,C){return String.fromCharCode(parseInt(C,16))}),a(w,_);try{_=atob(_)}catch{}return a(w,_)})}return""}function Uw(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const i in t){const a=t[i];a!==void 0&&e.append(i,a)}return e}function md(r){return URL.parse(r)?.origin??null}function zw({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:i}){const a={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(r.get("Content-Length"),10);return!Number.isInteger(l)||(a.suggestedLength=l,l<=2*e)||i||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function Hw(r){const t=r.get("Content-Disposition");if(t){let e=OT(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Pm(e))return e}return null}function gd(r,t){return new Kh(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function qw(r,t){if(r!==t)throw new Error(`Expected range response-origin "${r}" to match "${t}".`)}function Gw(r,t,e,i){return fetch(r,{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"})}function Vw(r,t){if(r!==200&&r!==206)throw gd(r,t)}function $w(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ne(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class NT extends dd{_responseOrigin=null;constructor(t){super(t,kT,LT),this.isHttp=/^https?:/i.test(t.url),this.headers=Uw(this.isHttp,t.httpHeaders)}}class kT extends fd{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:a,rangeChunkSize:l,url:c,withCredentials:u}=t._source;this._contentLength=a,this._isStreamingSupported=!i,this._isRangeSupported=!e;const d=new Headers(t.headers);Gw(c,d,u,this._abortController).then(f=>{t._responseOrigin=md(f.url),Vw(f.status,c),this._reader=f.body.getReader();const p=f.headers,{allowRangeRequests:y,suggestedLength:w}=zw({responseHeaders:p,isHttp:t.isHttp,rangeChunkSize:l,disableRange:e});this._isRangeSupported=y,this._contentLength=w||this._contentLength,this._filename=Hw(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new er("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:$w(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class LT extends pd{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const{url:a,withCredentials:l}=t._source,c=new Headers(t.headers);c.append("Range",`bytes=${e}-${i-1}`),Gw(a,c,l,this._abortController).then(u=>{const d=md(u.url);qw(d,t._responseOrigin),Vw(u.status,a),this._reader=u.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:$w(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Np=200,bv=206;function PT(r){return typeof r!="string"?r:cd(r).buffer}class BT extends dd{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,jT,FT),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=Uw(this.isHttp,t.httpHeaders)}_request(t){const e=new XMLHttpRequest,i={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(e,i),e.open("GET",this.url),e.withCredentials=this._source.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.validateStatus=a=>a===bv||a===Np):i.validateStatus=a=>a===Np,e.responseType="arraybuffer",Re(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>t.onError(e.status),e.onreadystatechange=this.#i.bind(this,e),e.onprogress=this.#e.bind(this,e),e.send(null),e}#e(t,e){this.#t.get(t)?.onProgress?.(e)}#i(t,e){const i=this.#t.get(t);if(!i||(t.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){i.onError(t.status);return}const a=t.status||Np;if(!i.validateStatus(a)){i.onError(t.status);return}const l=PT(t.response);if(a===bv){const c=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(c)?i.onDone(l):(ne('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone(l):i.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onClosed=()=>this._rangeReaders.delete(i)),i}}class jT extends fd{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:e}=t._source;this._contentLength=e,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:this.#n.bind(this)})}#t(){const t=this._stream,{disableRange:e,rangeChunkSize:i}=t._source,a=this._fullRequestXhr;t._responseOrigin=md(a.responseURL);const l=a.getAllResponseHeaders(),c=new Headers(l?l.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[p,...y]=f.split(": ");return[p,y.join(": ")]}):[]),{allowRangeRequests:u,suggestedLength:d}=zw({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:i,disableRange:e});u&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=Hw(c),this._isRangeSupported&&t._abortRequest(a),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}#i(t){this._storedError=gd(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class FT extends pd{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,e,i){super(t,e,i),this._requestXhr=t._request({begin:e,end:i,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:null})}#t(){const t=md(this._requestXhr?.responseURL);try{qw(t,this._stream._responseOrigin)}catch(e){this._storedError=e,this.#i(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#i(t){this._storedError??=gd(t,this._stream.url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const IT=/^[a-z][a-z0-9\-+.]+:/i;function UT(r){if(IT.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}function Kw(r){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(r):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(r)}function Xw(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ne(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class zT extends dd{constructor(t){super(t,HT,qT),this.url=UT(t.url),Re(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class HT extends fd{_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:a,rangeChunkSize:l}=t._source;this._contentLength=a,this._isStreamingSupported=!i,this._isRangeSupported=!e;const c=t.url,u=process.getBuiltinModule("fs");u.promises.lstat(c).then(d=>{const f=u.createReadStream(c),p=Kw(f);this._reader=p.getReader();const{size:y}=d;y<=2*l&&(this._isRangeSupported=!1),this._contentLength=y,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new er("Streaming is disabled.")),this._headersCapability.resolve()}).catch(d=>{d.code==="ENOENT"&&(d=gd(0,c.href)),this._headersCapability.reject(d)})}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Xw(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class qT extends pd{_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const a=t.url,l=process.getBuiltinModule("fs");try{const c=l.createReadStream(a,{start:e,end:i-1}),u=Kw(c);this._reader=u.getReader(),this._readCapability.resolve()}catch(c){this._readCapability.reject(c)}}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:Xw(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const _c=Symbol("INITIAL_DATA");class Yw{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:_c}}get(t,e=null){if(e){const a=this.#e(t);return a.promise.then(()=>e(a.data)),null}const i=this.#t[t];if(!i||i.data===_c)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==_c}delete(t){const e=this.#t[t];return!e||e.data===_c?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==_c&&(yield[t,e])}}}const GT=1e5,vv=30;class Si{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#a=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#S=null;static#w=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=i.scale*Rs.pixelRatio,this.#d=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:l,pageX:c,pageY:u}=i.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#o=a,this.#a=l,Si.#M(),e.style.setProperty("--min-font-size",Si.#S),Wr(e,i),this.#t.promise.finally(()=>{Si.#w.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=wn.platform;return ie(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),Si.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Rs.pixelRatio,a=t.rotation;if(a!==this.#d&&(e?.(),this.#d=a,Wr(this.#l,{rotation:a})),i!==this.#h){e?.(),this.#h=i;const l={div:null,properties:null,ctx:Si.#D(this.#s)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#_(l)}}cancel(){const t=new er("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#C(t){if(this.#i)return;this.#r.ctx??=Si.#D(this.#s);const e=this.#u,i=this.#g;for(const a of t){if(e.length>GT){ne("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(this.#e.ariaHidden=!0),l.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(a.str),this.#x(a)}}#x(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const a=qt.transform(this.#y,t.transform);let l=Math.atan2(a[1],a[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#n&&c.fontSubstitution||c.fontFamily;u=Si.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*Si.#j(u,c,this.#s);let p,y;l===0?(p=a[4],y=a[5]-f):(p=a[4]+f*Math.sin(l),y=a[5]-f*Math.cos(l));const w=e.style;w.left=`${(100*p/this.#o).toFixed(2)}%`,w.top=`${(100*y/this.#a).toFixed(2)}%`,w.setProperty("--font-height",`${d.toFixed(2)}px`),w.fontFamily=u,i.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(i.angle=l*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);_!==S&&Math.max(_,S)/Math.min(_,S)>1.5&&(A=!0)}if(A&&(i.canvasWidth=c.vertical?t.height:t.width),this.#p.set(e,i),this.#r.div=e,this.#r.properties=i,this.#_(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#_(t){const{div:e,properties:i,ctx:a}=t,{style:l}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=l,{canvasWidth:u,fontSize:d}=i;Si.#R(a,d*this.#h,c);const{width:f}=a.measureText(e.textContent);f>0&&l.setProperty("--scale-x",u*this.#h/f)}i.angle!==0&&l.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#w.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#D(t=null){let e=this.#b.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#R(t,e,i){const a=this.#E.get(t);e===a.size&&i===a.family||(t.font=`${e}px ${i}`,a.size=e,a.family=i)}static#M(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#j(t,e,i){const a=this.#v.get(t);if(a)return a;const l=this.#D(i);l.canvas.width=l.canvas.height=vv,this.#R(l,vv,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,d=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+d):(wn.platform.isFirefox&&ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}}const VT=100;function Qw(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new Hm,{docId:e}=t,i=r.url?JC(r.url):null,a=r.data?tT(r.data):null,l=r.httpHeaders||null,c=r.withCredentials===!0,u=r.password??null,d=r.range instanceof Ww?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let p=r.worker instanceof Uc?r.worker:null;const y=r.verbosity,w=typeof r.docBaseUrl=="string"&&!ud(r.docBaseUrl)?r.docBaseUrl:null,A=wh(r.cMapUrl),_=r.cMapPacked!==!1,S=r.CMapReaderFactory||(Wn?lT:iv),C=wh(r.iccUrl),M=wh(r.standardFontDataUrl),N=r.StandardFontDataFactory||(Wn?cT:sv),k=wh(r.wasmUrl),j=r.WasmFactory||(Wn?uT:av),F=r.stopAtErrors!==!0,z=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,H=r.isEvalSupported!==!1,ut=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!Wn,ft=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!Wn&&(wn.platform.isFirefox||!globalThis.chrome),_t=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,ct=typeof r.disableFontFace=="boolean"?r.disableFontFace:Wn,Rt=r.fontExtraProperties===!0,Lt=r.enableXfa===!0,Bt=r.ownerDocument||globalThis.document,$t=r.disableRange===!0,G=r.disableStream===!0,st=r.disableAutoFetch===!0,wt=r.pdfBug===!0,Xt=r.CanvasFactory||(Wn?oT:sT),Ct=r.FilterFactory||(Wn?rT:aT),U=r.enableHWA===!0,J=r.useWasm!==!1,mt=d?d.length:r.length??NaN,xt=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!Wn&&!ct,It=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(S===iv&&N===sv&&j===av&&A&&M&&k&&Mc(A,document.baseURI)&&Mc(M,document.baseURI)&&Mc(k,document.baseURI)),Ut=null;CC(y);const Ot={canvasFactory:new Xt({ownerDocument:Bt,enableHWA:U}),filterFactory:new Ct({docId:e,ownerDocument:Bt}),cMapReaderFactory:It?null:new S({baseUrl:A,isCompressed:_}),standardFontDataFactory:It?null:new N({baseUrl:M}),wasmFactory:It?null:new j({baseUrl:k})};p||(p=Uc.create({verbosity:y,port:ll.workerPort}),t._worker=p);const Tt={docId:e,apiVersion:"5.4.624",data:a,password:u,disableAutoFetch:st,rangeChunkSize:f,length:mt,docBaseUrl:w,enableXfa:Lt,evaluatorOptions:{maxImageSize:z,disableFontFace:ct,ignoreErrors:F,isEvalSupported:H,isOffscreenCanvasSupported:ut,isImageDecoderSupported:ft,canvasMaxAreaInBytes:_t,fontExtraProperties:Rt,useSystemFonts:xt,useWasm:J,useWorkerFetch:It,cMapUrl:A,iccUrl:C,standardFontDataUrl:M,wasmUrl:k}},jt={ownerDocument:Bt,pdfBug:wt,styleElement:Ut,enableHWA:U,loadingParams:{disableAutoFetch:st,enableXfa:Lt}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const kt=p.messageHandler.sendWithPromise("GetDocRequest",Tt,a?[a.buffer]:null);let we;if(d)we=new RT({pdfDataRangeTransport:d,disableRange:$t,disableStream:G});else if(!a){if(!i)throw new Error("getDocument - no `url` parameter provided.");const pt=Mc(i)?NT:Wn?zT:BT;we=new pt({url:i,length:mt,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:$t,disableStream:G})}return kt.then(pt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const he=new Dc(e,pt,p.port),ge=new XT(he,t,we,jt,Ot);t._transport=ge,he.send("Ready",null)})}).catch(t._capability.reject),t}class Hm{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Hm.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Ww{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#s=[];constructor(t,e,i=!1,a=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=a}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Me("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class $T{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class KT{#t=!1;#e=Ce.instance;constructor(t,e,i,a=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=a?new Q0:null,this._pdfBug=a,this.commonObjs=i.commonObjs,this.objs=new Yw,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:a=0,dontFlip:l=!1}={}){return new Qc({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:a="display",annotationMode:l=Wa.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:w=!1,recordOperations:A=!1,operationsFilter:_=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(a,l,y,w),{renderingIntent:C,cacheKey:M}=S;this.#t=!1,d||=this._transport.getOptionalContentConfig(C);let N=this._intentStates.get(M);N||(N=Object.create(null),this._intentStates.set(M,N)),N.streamReaderCancelTimeout&&(clearTimeout(N.streamReaderCancelTimeout),N.streamReaderCancelTimeout=null);const k=!!(C&Ai.PRINT);N.displayReadyCapability||(N.displayReadyCapability=Promise.withResolvers(),N.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const j=!!(this._pdfBug&&globalThis.StepperManager?.enabled),F=!this.recordedBBoxes&&(A||j),z=ft=>{if(N.renderTasks.delete(H),F){const _t=H.gfx?.dependencyTracker.take();_t&&(H.stepper&&H.stepper.setOperatorBBoxes(_t,H.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=_t))}k&&(this.#t=!0),this.#i(),ft?(H.capability.reject(ft),this._abortOperatorList({intentState:N,reason:ft instanceof Error?ft:new Error(ft)})):H.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},H=new il({callback:z,params:{canvas:e,canvasContext:t,dependencyTracker:F?new dT(e,N.operatorList.length,j):null,viewport:i,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:N.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!k,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:_});(N.renderTasks||=new Set).add(H);const ut=H.task;return Promise.all([N.displayReadyCapability.promise,d]).then(([ft,_t])=>{if(this.destroyed){z();return}if(this._stats?.time("Rendering"),!(_t.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");H.initializeGraphics({transparency:ft,optionalContentConfig:_t}),H.operatorListChanged()}).catch(z),ut}getOperatorList({intent:t="display",annotationMode:e=Wa.ENABLE,printAnnotationStorage:i=null,isEditing:a=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const c=this._transport.getRenderingIntent(t,e,i,a,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Ic.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,a){function l(){c.read().then(function({value:d,done:f}){if(f){i(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),l()},a)}const c=e.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#i();return t&&e&&(this._stats&&=new Q0),e}#i(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,a=t.length;i<a;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#i()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:a}){const{map:l,transfer:c}=i,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:l,modifiedIds:a},c).getReader(),f=this._intentStates.get(e);f.streamReader=d;const p=()=>{d.read().then(({value:y,done:w})=>{if(w){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const w of f.renderTasks)w.operatorListChanged();this.#i()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Lm){let a=VT;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new er(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,l]of this._intentStates)if(l===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var Za,Wi,oa,Gr,Qh,Vr,$r,Jn,Fh,Zw,Jw,Oc,cl,Ih;const Xe=class Xe{constructor({name:t=null,port:e=null,verbosity:i=TC()}={}){bs(this,Jn);bs(this,Za,Promise.withResolvers());bs(this,Wi,null);bs(this,oa,null);bs(this,Gr,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Ke(Xe,$r).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Ke(Xe,$r).set(e,this),vs(this,Jn,Zw).call(this,e)}else vs(this,Jn,Jw).call(this)}get promise(){return Ke(this,Za).promise}get port(){return Ke(this,oa)}get messageHandler(){return Ke(this,Wi)}destroy(){this.destroyed=!0,Ke(this,Gr)?.terminate(),oi(this,Gr,null),Ke(Xe,$r).delete(Ke(this,oa)),oi(this,oa,null),Ke(this,Wi)?.destroy(),oi(this,Wi,null)}static create(t){const e=Ke(this,$r).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Xe(t)}static get workerSrc(){if(ll.workerSrc)return ll.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ie(this,"_setupFakeWorkerGlobal",(async()=>Ke(this,cl,Ih)?Ke(this,cl,Ih):(await import(this.workerSrc)).WorkerMessageHandler)())}};Za=new WeakMap,Wi=new WeakMap,oa=new WeakMap,Gr=new WeakMap,Qh=new WeakMap,Vr=new WeakMap,$r=new WeakMap,Jn=new WeakSet,Fh=function(){Ke(this,Za).resolve(),Ke(this,Wi).send("configure",{verbosity:this.verbosity})},Zw=function(t){oi(this,oa,t),oi(this,Wi,new Dc("main","worker",t)),Ke(this,Wi).on("ready",()=>{}),vs(this,Jn,Fh).call(this)},Jw=function(){if(Ke(Xe,Vr)||Ke(Xe,cl,Ih)){vs(this,Jn,Oc).call(this);return}let{workerSrc:t}=Xe;try{Xe._isSameOrigin(window.location,t)||(t=Xe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Dc("main","worker",e),a=()=>{l.abort(),i.destroy(),e.terminate(),this.destroyed?Ke(this,Za).reject(new Error("Worker was destroyed")):vs(this,Jn,Oc).call(this)},l=new AbortController;e.addEventListener("error",()=>{Ke(this,Gr)||a()},{signal:l.signal}),i.on("test",u=>{if(l.abort(),this.destroyed||!u){a();return}oi(this,Wi,i),oi(this,oa,e),oi(this,Gr,e),vs(this,Jn,Fh).call(this)}),i.on("ready",u=>{if(l.abort(),this.destroyed){a();return}try{c()}catch{vs(this,Jn,Oc).call(this)}});const c=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};c();return}catch{ld("The worker has been disabled.")}vs(this,Jn,Oc).call(this)},Oc=function(){Ke(Xe,Vr)||(ne("Setting up fake worker."),oi(Xe,Vr,!0)),Xe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Ke(this,Za).reject(new Error("Worker was destroyed"));return}const e=new iT;oi(this,oa,e);const i=`fake${Wb(Xe,Qh)._++}`,a=new Dc(i+"_worker",i,e);t.setup(a,e),oi(this,Wi,new Dc(i,i+"_worker",e)),vs(this,Jn,Fh).call(this)}).catch(t=>{Ke(this,Za).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},cl=new WeakSet,Ih=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},bs(Xe,cl),bs(Xe,Qh,0),bs(Xe,Vr,!1),bs(Xe,$r,new WeakMap),Wn&&(oi(Xe,Vr,!0),ll.workerSrc||="./pdf.worker.mjs"),Xe._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const a=new URL(e,i);return i.origin===a.origin},Xe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Xe.fromPort=t=>{if(IC("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Xe.create(t)};let Uc=Xe;class XT{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#i=null;#n=new Map;#s=new Map;#r=new Map;#a=null;#o=Ce.instance;constructor(t,e,i,a,l){this.messageHandler=t,this.loadingTask=e,this.#i=i,this.commonObjs=new Yw,this.fontLoader=new QC({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.enableHWA=a.enableHWA,this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const t=new Map,e=new Map;for(let i=0,a=this.#o.pagesNumber;i<a;i++){const l=this.#o.getPrevPageNumber(i+1)-1,c=this.#n.get(l);c&&t.set(i,c);const u=this.#s.get(l);u&&e.set(i,u)}this.#n=t,this.#s=e}#l(t,e=null){const i=this.#e.get(t);if(i)return i;const a=this.messageHandler.sendWithPromise(t,e);return this.#e.set(t,a),a}#d({loaded:t,total:e}){this.loadingTask.onProgress?.({loaded:t,total:e,percent:jn(Math.round(t/e*100),0,100)})}get annotationStorage(){return ie(this,"annotationStorage",new Fm)}getRenderingIntent(t,e=Wa.ENABLE,i=null,a=!1,l=!1){let c=Ai.DISPLAY,u=sm;switch(t){case"any":c=Ai.ANY;break;case"display":break;case"print":c=Ai.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${t}`)}const d=c&Ai.PRINT&&i instanceof Lw?i:this.annotationStorage;switch(e){case Wa.DISABLE:c+=Ai.ANNOTATIONS_DISABLE;break;case Wa.ENABLE:break;case Wa.ENABLE_FORMS:c+=Ai.ANNOTATIONS_FORMS;break;case Wa.ENABLE_STORAGE:c+=Ai.ANNOTATIONS_STORAGE,u=d.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(c+=Ai.IS_EDITING),l&&(c+=Ai.OPLIST);const{ids:f,hash:p}=d.modifiedIds,y=[c,u.hash,p];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#n.values())t.push(i._destroy());this.#n.clear(),this.#s.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Si.cleanup(),this.#i?.cancelAllRequests(new er("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,a)=>{Re(this.#i,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#i.getFullReader(),this.#t.onProgress=l=>this.#d(l),a.onPull=()=>{this.#t.read().then(function({value:l,done:c}){if(c){a.close();return}Re(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{this.#t.cancel(l),a.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async i=>{await this.#t.headersReady;const{isStreamingSupported:a,isRangeSupported:l,contentLength:c}=this.#t;return a&&l&&(this.#t.onProgress=null),{isStreamingSupported:a,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(i,a)=>{Re(this.#i,"GetRangeReader - no `BasePDFStream` instance available.");const l=this.#i.getRangeReader(i.begin,i.end);if(!l){a.close();return}a.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){a.close();return}Re(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{a.error(c)})},a.onCancel=c=>{l.cancel(c),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this.#o.pagesNumber=i.numPages,this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new $T(i,this))}),t.on("DocException",i=>{e._capability.reject(li(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw li(i);const a=l=>{l instanceof Error?this.#a.reject(l):this.#a.resolve({password:l})};e.onPassword(a,i.code)}catch(a){this.#a.reject(a)}return this.#a.promise}),t.on("DataLoaded",i=>{this.#d({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#n.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,a,l])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(a){case"Font":if("error"in l){const y=l.error;ne(`Error during font loading: ${y}`),this.commonObjs.resolve(i,y);break}const c=new Fe(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,w)=>globalThis.FontInspector.fontAdded(y,w):null,d=new WC(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:f}=l;Re(f,"The imageRef must be defined.");for(const y of this.#n.values())for(const[,w]of y.objs)if(w?.ref===f)return w.dataLen?(this.commonObjs.resolve(i,structuredClone(w)),w.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new ZC(l));break;case"Image":this.commonObjs.resolve(i,l);break;case"Pattern":const p=new Tn(l);this.commonObjs.resolve(i,p.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([i,a,l,c])=>{if(this.destroyed)return;const u=this.#n.get(a);if(!u.objs.has(i)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(i,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",i=>{this.destroyed||this.#d(i)}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[i.type];if(!a)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#o.getPageId(t)-1,a=this.#s.get(e);if(a)return a;const l=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(c=>{if(this.destroyed)throw new Error("Transport destroyed");c.refStr&&this.#r.set(c.refStr,i);const u=new KT(e,c,this,this._params.pdfBug);return this.#n.set(e,u),u});return this.#s.set(e,l),l}async getPageIndex(t){if(!am(t))throw new Error("Invalid pageIndex request.");const e=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#o.getPageNumber(e+1)-1}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(t+1)-1,intent:e})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#l("GetOptionalContentConfig").then(e=>new TT(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#e.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new _T(a[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:a[2]}));return this.#e.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#n.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Si.cleanup()}}cachedPageNumber(t){if(!am(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,i=this.#r.get(e);return i>=0?this.#o.getPageNumber(i+1):null}}class YT{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this._internalRenderTask;return t.form||t.canvas&&e?.size>0}}class il{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:a,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:w=null,enableHWA:A=!1,operationsFilter:_=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=a,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=y,this.pageColors=w,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new YT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=A,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=_}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(il.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");il.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:a,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new ol(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:a,viewport:i,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),il.#e.delete(this._canvas),t||=new Lm(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),il.#e.delete(this._canvas),this.callback())))}}const QT="5.4.624",WT="384c6208b";let tx=class Ss{#t=null;#e=null;#i;#n=null;#s=!1;#r=!1;#a=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return ie(this,"_keyboardManager",new Zc([[["Escape","mac+Escape"],Ss.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ss.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ss.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ss.prototype._moveToPrevious],[["Home","mac+Home"],Ss.prototype._moveToBeginning],[["End","mac+End"],Ss.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#a=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Ss.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",qi,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[i,a]of this.#l.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",a),l.title=i,l.setAttribute("data-l10n-id",Ss.#d[i]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=a,l.ariaSelected=a===this.#i,l.addEventListener("click",this.#f.bind(this,a),{signal:e}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:ve.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#n.lastElementChild?.focus()}#g(t){Ss._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#s=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}};class zc{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,zc.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:i}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=i||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",zc.#n[t]),a.addEventListener("input",()=>{this.#i.updateParams(e,a.value)},{signal:this.#i._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function wv(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function Cc(r){return Math.max(0,Math.min(255,255*r))}class xv{static CMYK_G([t,e,i,a]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Cc(t),[t,t,t]}static G_HTML([t]){const e=wv(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Cc)}static RGB_HTML(t){return`#${t.map(wv).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,i+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,i,a]){return[Cc(1-Math.min(1,t+a)),Cc(1-Math.min(1,i+a)),Cc(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const a=1-t,l=1-e,c=1-i,u=Math.min(a,l,c);return["CMYK",a,l,c,u]}}class ZT{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),i||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Me("Abstract method `_createSVG` called.")}}class Yh extends ZT{_createSVG(t){return document.createElementNS(aa,t)}}const JT=9,Zr=new WeakSet,t2=new Date().getTimezoneOffset()*60*1e3;class kp{static create(t){switch(t.data.annotationType){case gn.LINK:return new qm(t);case gn.TEXT:return new n2(t);case gn.WIDGET:switch(t.data.fieldType){case"Tx":return new i2(t);case"Btn":return t.data.radioButton?new ex(t):t.data.checkBox?new a2(t):new r2(t);case"Ch":return new o2(t);case"Sig":return new s2(t)}return new to(t);case gn.POPUP:return new lm(t);case gn.FREETEXT:return new nx(t);case gn.LINE:return new c2(t);case gn.SQUARE:return new u2(t);case gn.CIRCLE:return new h2(t);case gn.POLYLINE:return new ix(t);case gn.CARET:return new f2(t);case gn.INK:return new Gm(t);case gn.POLYGON:return new d2(t);case gn.HIGHLIGHT:return new sx(t);case gn.UNDERLINE:return new p2(t);case gn.SQUIGGLY:return new m2(t);case gn.STRIKEOUT:return new g2(t);case gn.STAMP:return new ax(t);case gn.FILEATTACHMENT:return new y2(t);default:return new Ze(t)}}}class Ze{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return Ze._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:a}=this.data;let l=-1/0,c=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>c?(c=e[u+1],l=e[u+2]):e[u+1]===c&&(l=Math.max(l,e[u+2]));return[l,c]}if(i?.length>=1){for(const u of i)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>c?(c=u[d+1],l=u[d]):u[d+1]===c&&(l=Math.max(l,u[d]));if(l!==1/0)return[l,c]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-l)/i,t[1]=100*(t[1]-c)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${jc}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${jc}${e.id}`,{id:e.id,annotationType:e.annotationType,page:this.parent.page,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#n(e);let a=this.#i?.popup||this.popup;!a&&i?.text&&(this._createPopup(i),a=this.#i.popup),a&&(a.updateEdited(t),i?.deleted&&(a.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:i,rotation:a},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:d}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/l}%`,e.top=`${100*(c-t[3]+d)/c}%`,a===0?(e.width=`${100*(t[2]-t[0])/l}%`,e.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(a)}_createContainer(t){const{data:e,parent:{page:i,viewport:a}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",e.id),!(this instanceof to)&&!(this instanceof qm)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(l.title=e.alternativeText),e.noRotate&&l.classList.add("norotate"),!e.rect||this instanceof lm){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,l),l}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){c.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(S>0||C>0){const N=`calc(${S}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;c.borderRadius=N}else if(this instanceof ex){const N=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;c.borderRadius=N}switch(e.borderStyle.style){case Wo.SOLID:c.borderStyle="solid";break;case Wo.DASHED:c.borderStyle="dashed";break;case Wo.BEVELED:ne("Unimplemented border style: beveled");break;case Wo.INSET:ne("Unimplemented border style: inset");break;case Wo.UNDERLINE:c.borderBottomStyle="solid";break}const M=e.borderColor||null;M?(this.#e=!0,c.borderColor=qt.makeHexColor(M[0]|0,M[1]|0,M[2]|0)):c.borderWidth=0}const f=qt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:y,pageX:w,pageY:A}=a.rawDims;c.left=`${100*(f[0]-w)/p}%`,c.top=`${100*(f[1]-A)/y}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(c.width=`${100*u/p}%`,c.height=`${100*d/y}%`):this.setRotation(_,l),l}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:a}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),e.style.width=`${100*l/i}%`,e.style.height=`${100*c/a}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,a)=>{const l=a.detail[e],c=l[0],u=l.slice(1);a.target.style[i]=xv[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:xv[`${c}_rgb`](u)})};return ie(this,"_commonActions",{display:e=>{const{display:i}=e.detail,a=i%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const a of Object.keys(e.detail))(t[a]||i[a])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[a,l]of Object.entries(e)){const c=i[a];if(c){const u={detail:{[a]:l},target:t};c(u),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,a,l]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,C,M,N]=t.subarray(2,6);if(a===S&&l===C&&e===M&&i===N)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:C}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const d=a-e,f=l-i,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const w=p.createElement("defs");y.append(w);const A=p.createElement("clipPath"),_=`clippath_${this.data.id}`;A.setAttribute("id",_),A.setAttribute("clipPathUnits","objectBoundingBox"),w.append(A);for(let S=2,C=t.length;S<C;S+=8){const M=t[S],N=t[S+1],k=t[S+2],j=t[S+3],F=p.createElement("rect"),z=(k-e)/d,H=(l-N)/f,ut=(M-k)/d,ft=(N-j)/f;F.setAttribute("x",z),F.setAttribute("y",H),F.setAttribute("width",ut),F.setAttribute("height",ft),A.append(F),u?.push(`<rect vector-effect="non-scaling-stroke" x="${z}" y="${H}" width="${ut}" height="${ft}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${_})`}_createPopup(t=null){const{data:e}=this;let i,a;t?(i={str:t.text},a=t.date):(i=e.contentsObj,a=e.modificationDate),this.#i=new lm({data:{color:e.color,titleObj:e.titleObj,modificationDate:a,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Me("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:l,id:c,exportValues:u}of a){if(l===-1||c===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!Zr.has(f)){ne(`_getElementsByName - element not allowed: ${c}`);continue}i.push({id:c,exportValue:d,domElement:f})}return i}for(const a of document.getElementsByName(t)){const{exportValue:l}=a,c=a.getAttribute("data-element-id");c!==e&&Zr.has(a)&&i.push({id:c,exportValue:l,domElement:a})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class e2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class qm extends Ze{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let a=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),a=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(i,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=i,this.container.append(i)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",a=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,a),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(e.actions)){const l=i.get(a);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:a}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:a,refs:l,include:c}=e,u=[];if(a.length!==0||l.length!==0){const p=new Set(l);for(const y of a){const w=this._fieldObjects[y]||[];for(const{id:A}of w)p.add(A)}for(const y of Object.values(this._fieldObjects))for(const w of y)p.has(w.id)===c&&u.push(w)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const A=p.defaultValue||"";d.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=p.defaultValue===p.exportValues;d.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=p.defaultValue||"";d.setValue(y,{value:A});break}default:continue}const w=document.querySelector(`[data-element-id="${y}"]`);if(w){if(!Zr.has(w)){ne(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class n2 extends Ze{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class to extends Ze{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return wn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,a,l){i.includes("mouse")?t.addEventListener(i,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(i,c=>{if(i==="blur"){if(!e.focused||!c.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c)}})})}_setEventListeners(t,e,i,a){for(const[l,c]of i)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,l,c,a),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":qt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||JT,l=t.style;let c;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(Cp*a))||1,y=f/p;c=Math.min(a,d(y/Cp))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(a,d(f/Cp))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=qt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(l.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class i2 extends to{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,a){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[e]=i),l.setValue(c.id,{[a]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let l=a.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Zr.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,w=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",_=>{t.setValue(e,{value:_.target.value}),this.setPropertyOnSiblings(i,"value",_.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",_=>{const S=this.data.defaultFieldValue??"";i.value=d.userValue=S,d.formattedValue=null});let A=_=>{const{formattedValue:S}=d;S!=null&&(_.target.value=S),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",S=>{if(d.focused)return;const{target:C}=S;if(w&&(C.type=p,y&&(C.step=y)),d.userValue){const M=d.userValue;if(w)if(p==="time"){const N=new Date(M),k=[N.getHours(),N.getMinutes(),N.getSeconds()];C.value=k.map(j=>j.toString().padStart(2,"0")).join(":")}else C.value=new Date(M-t2).toISOString().split(p==="date"?"T":".",1)[0];else C.value=M}d.lastCommittedValue=C.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const C={value(M){d.userValue=M.detail.value??"",w||t.setValue(e,{value:d.userValue.toString()}),M.target.value=d.userValue},formattedValue(M){const{formattedValue:N}=M.detail;d.formattedValue=N,N!=null&&M.target!==document.activeElement&&(M.target.value=N);const k={formattedValue:N};w&&(k.value=N),t.setValue(e,k)},selRange(M){M.target.setSelectionRange(...M.detail.selRange)},charLimit:M=>{const{charLimit:N}=M.detail,{target:k}=M;if(N===0){k.removeAttribute("maxLength");return}k.setAttribute("maxLength",N);let j=d.userValue;!j||j.length<=N||(j=j.slice(0,N),k.value=d.userValue=j,t.setValue(e,{value:j}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:j,willCommit:!0,commitKey:1,selStart:k.selectionStart,selEnd:k.selectionEnd}}))}};this._dispatchEventFromSandbox(C,S)}),i.addEventListener("keydown",S=>{d.commitKey=1;let C=-1;if(S.key==="Escape"?C=0:S.key==="Enter"&&!this.data.multiLine?C=2:S.key==="Tab"&&(d.commitKey=3),C===-1)return;const{value:M}=S.target;d.lastCommittedValue!==M&&(d.lastCommittedValue=M,d.userValue=M,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,willCommit:!0,commitKey:C,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const _=A;A=null,i.addEventListener("blur",S=>{if(!d.focused||!S.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:C}=S;let{value:M}=C;if(w){if(M&&p==="time"){const N=M.split(":").map(k=>parseInt(k,10));M=new Date(2e3,0,1,N[0],N[1],N[2]||0).valueOf(),C.step=""}else M.includes("T")||(M=`${M}T00:00`),M=new Date(M).valueOf();C.type="text"}d.userValue=M,d.lastCommittedValue!==M&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,willCommit:!0,commitKey:d.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),_(S)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",S=>{d.lastCommittedValue=null;const{data:C,target:M}=S,{value:N,selectionStart:k,selectionEnd:j}=M;let F=k,z=j;switch(S.inputType){case"deleteWordBackward":{const H=N.substring(0,k).match(/\w*[^\w]*$/);H&&(F-=H[0].length);break}case"deleteWordForward":{const H=N.substring(k).match(/^[^\w]*\w*/);H&&(z+=H[0].length);break}case"deleteContentBackward":k===j&&(F-=1);break;case"deleteContentForward":k===j&&(z+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:N,change:C||"",willCommit:!1,selStart:F,selEnd:z}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&i.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class s2 extends to{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class a2 extends to{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(i,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return Zr.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.setAttribute("exportValue",e.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i)){const p=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue||"Off";c.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(i,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class ex extends to{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(i,{value:a})),a)for(const c of this._getElementsByName(e.fieldName,i))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(Zr.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue;c.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const c=e.buttonValue;l.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const p=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const w=p&&y.id===i;y.domElement&&(y.domElement.checked=w),t.setValue(y.id,{value:w})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class r2 extends qm{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class o2 extends to{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");Zr.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const w of a.options)w.selected=w.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,i.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),l=!1),a.append(y)}let c=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),a.prepend(p),c=()=>{p.remove(),a.removeEventListener("input",c),c=null},a.addEventListener("input",c)}const u=p=>{const y=p?"value":"textContent",{options:w,multiple:A}=a;return A?Array.prototype.filter.call(w,_=>_.selected).map(_=>_[y]):w.selectedIndex===-1?null:w[w.selectedIndex][y]};let d=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,w=>({displayValue:w.textContent,exportValue:w.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",p=>{const y={value(w){c?.();const A=w.detail.value,_=new Set(Array.isArray(A)?A:[A]);for(const S of a.options)S.selected=_.has(S.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(w){a.multiple=!0},remove(w){const A=a.options,_=w.detail.remove;A[_].selected=!1,a.remove(_),A.length>0&&Array.prototype.findIndex.call(A,C=>C.selected)===-1&&(A[0].selected=!0),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},clear(w){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(w){const{index:A,displayValue:_,exportValue:S}=w.detail.insert,C=a.children[A],M=document.createElement("option");M.textContent=_,M.value=S,C?C.before(M):a.append(M),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},items(w){const{items:A}=w.detail;for(;a.length!==0;)a.remove(0);for(const _ of A){const{displayValue:S,exportValue:C}=_,M=document.createElement("option");M.textContent=S,M.value=C,a.append(M)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},indices(w){const A=new Set(w.detail.indices);for(const _ of w.target.options)_.selected=A.has(_.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(w){w.target.disabled=!w.detail.editable}};this._dispatchEventFromSandbox(y,p)}),a.addEventListener("input",p=>{const y=u(!0),w=u(!1);t.setValue(e,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:w,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):a.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class lm extends Ze{constructor(t){const{data:e,elements:i,parent:a}=t,l=!!a._commentManager;if(super(t,{isRenderable:!l&&Ze._hasPopupData(e)}),this.elements=i,l&&Ze._hasPopupData(e)){const c=this.popup=this.#t();for(const u of i)u.popup=c}else this.popup=null}#t(){return new l2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const a of this.elements)a.popup=e,a.container.ariaHasPopup="dialog",i.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(a=>`${el}${a}`).join(",")),this.container}}class l2{#t=null;#e=this.#G.bind(this);#i=this.#I.bind(this);#n=this.#k.bind(this);#s=this.#A.bind(this);#r=null;#a=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#S=null;#w=null;#C=!1;#x=null;#_=null;constructor({container:t,color:e,elements:i,titleObj:a,modificationDate:l,contentsObj:c,richText:u,parent:d,rect:f,parentRect:p,open:y,commentManager:w=null}){this.#a=t,this.#S=a,this.#o=c,this.#E=u,this.#d=d,this.#r=e,this.#b=f,this.#h=p,this.#l=i,this.#t=w,this.#x=i[0],this.#c=em.toDateObject(l),this.trigger=i.flatMap(A=>A.getElementsToTriggerPopup()),w||(this.#D(),this.#a.hidden=!0,y&&this.#A())}#D(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const e of this.trigger)e.addEventListener("click",this.#s,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#x.container.after(this.#p);return}if(this.#y||this.#R(),!this.#y)return;const{signal:t}=this.#m=new AbortController,e=this.#x.hasOwnCommentButton,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#x.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#x.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#M(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#M(){if(this.#x.extraPopupElement&&!this.#x.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#y,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#j(){this.#x.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#x.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}=this.#x.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#x.commentText,this.#_}set comment(t){t!==this.comment&&(this.#x.commentText=this.#_=t)}focus(){this.#x.container?.focus()}get parentBoundingClientRect(){return this.#x.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#x.layer.getBoundingClientRect();return[(t-a)/c,(e+i-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#v||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:l,y:c,width:u,height:d}=a;this.#t.showDialog(null,this,l+e*u,c+i*d,{...t,parentDimensions:a})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#r){const i=t.style.outlineColor=qt.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#S?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#S}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}Dw({html:this.#N||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#a.append(t)}get#N(){const t=this.#E,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#L(){return this.#N?.attributes?.style?.fontSize||0}get#F(){return this.#N?.attributes?.style?.color||null}#P(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))e.push({name:"span",value:l,attributes:a});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#A()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#_=null):e&&(e.deleted?this.remove():(this.#j(),this.#_=e.text)),t&&(this.#y=null,this.#R(),this.#M());return}if(i||e?.deleted){this.remove();return}this.#D(),this.#w||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),e&&e.text&&(this.#E=this.#P(e.text),this.#c=em.toDateObject(e.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#E}=this.#w,this.#w=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:a,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const _ of this.#l)if(!u||qt.intersect(_.data.rect,u)!==null){u=_.data.rect,c=!0;break}const d=qt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=c?u[2]-u[0]+5:0,y=d[0]+p,w=d[1];this.#u=[100*(y-a)/e,100*(w-l)/i];const{style:A}=this.#a;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#A(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#k(),this.#a.addEventListener("click",this.#s),this.#a.addEventListener("keydown",this.#e)):(this.#I(),this.#a.removeEventListener("click",this.#s),this.#a.removeEventListener("keydown",this.#e))}#k(){this.#g||this.render(),this.isVisible?this.#f&&this.#a.classList.add("focused"):(this.#T(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#I(){this.#a.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#a.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#C&&(this.#g||this.#k(),this.#C=!1,this.#a.hidden=!1))}get isVisible(){return this.#t?!1:this.#a.hidden===!1}}class nx extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=re.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class c2 extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class u2 extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",e-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class h2 extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",e/2),c.setAttribute("cy",i/2),c.setAttribute("rx",e/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class ix extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:a},width:l,height:c}=this;if(!e)return this.container;const u=this.svgFactory.create(l,c,!0);let d=[];for(let p=0,y=e.length;p<y;p+=2){const w=e[p]-t[0],A=t[3]-e[p+1];d.push(`${w},${A}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class d2 extends ix{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class f2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Gm extends Ze{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?re.HIGHLIGHT:re.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:a,popupRef:l}}=this,{transform:c,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",a.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let y=0,w=i.length;y<w;y++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",i[y].join(",")),p.append(A)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:a}=t,l=this.#t;if(e>=0&&l.setAttribute("stroke-width",e||1),i)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",i[c].join(","));if(a){const{transform:c,width:u,height:d}=this.#i(this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class sx extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=re.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class p2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class m2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class g2 extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class ax extends Ze{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=re.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class y2 extends Ze{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:a}=wn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class Vm{#t=null;#e=null;#i=null;#n=new Map;#s=null;#r=null;#a=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:a,page:l,viewport:c,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:p}){this.div=t,this.#t=e,this.#e=i,this.#s=u||null,this.#r=f||null,this.#i=p||new Fm,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,i=this.div;Wr(i,this.viewport);const a=new Map,l=[],c={data:null,layer:i,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Yh,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const d=u.annotationType===gn.POPUP;if(d){const y=a.get(u.id);if(!y)continue;if(!this._commentManager){l.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=kp.create(c);if(!f.isRenderable)continue;if(!d&&(this.#a.push(f),u.popupRef)){const y=a.get(u.popupRef);y?y.push(f):a.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const d=c.elements=a.get(u.id);c.data=u;const f=kp.create(c);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${el}${u.id}`,u.hidden&&(p.style.visibility="hidden"),d.at(-1).container.after(p)}this.#l()}async#c(){if(this.#a.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:i,data:{id:a}}of this.#a){const l=i.id=`${el}${a}`;t.push(this.#s?.getAriaAttributes(l).then(c=>{if(c)for(const[u,d]of c)i.setAttribute(u,d)}))}}this.#a.sort(({data:{rect:[i,a,l,c]}},{data:{rect:[u,d,f,p]}})=>{if(i===l&&a===c)return 1;if(u===f&&d===p)return-1;const y=c,w=a,A=(a+c)/2,_=p,S=d,C=(d+p)/2;if(A>=_&&C<=w)return-1;if(C>=y&&A<=S)return 1;const M=(i+l)/2,N=(u+f)/2;return M-N});const e=document.createDocumentFragment();for(const i of this.#a)e.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&e.append(i.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const i of this.#a)this.#t.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#r,svgFactory:new Yh,parent:this};for(const i of t){i.borderStyle||=Vm._defaultBorderStyle,e.data=i;const a=kp.create(e);a.isRenderable&&(a.render(),a.contentElement.id=`${el}${i.id}`,this.#a.push(a))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,Wr(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const a=t.querySelector(`[data-annotation-id="${e}"]`);if(!a)continue;i.className="annotationContent";const{firstChild:l}=a;l?l.nodeName==="CANVAS"?l.replaceWith(i):l.classList.contains("annotationContent")?l.after(i):l.before(i):a.append(i);const c=this.#n.get(e);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,a.id,i),c._hasNoCanvas=!1):c.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:a}=t,l=new e2({data:{id:i,rect:t.getPDFRect(),rotation:a},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return l.render(),l.contentElement.id=`${el}${i}`,l.createOrUpdatePopup(),this.#a.push(l),l}removeAnnotation(t){const e=this.#a.findIndex(a=>a.data.id===t);if(e<0)return;const[i]=this.#a.splice(e,1);this.#t?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return ie(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Wo.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Ch=/\r\n?|\n/g;class Rn extends Wt{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Rn.prototype,e=l=>l.isEmpty(),i=nr.TRANSLATE_SMALL,a=nr.TRANSLATE_BIG;return ie(this,"_keyboardManager",new Zc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:e}]]))}static _type="freetext";static _editorType=re.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Rn._defaultColor||Wt._defaultLineColor,this.#n=t.fontSize||Rn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){Wt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case ve.FREETEXT_SIZE:Rn._defaultFontSize=e;break;case ve.FREETEXT_COLOR:Rn._defaultColor=e;break}}updateParams(t,e){switch(t){case ve.FREETEXT_SIZE:this.#s(e);break;case ve.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[ve.FREETEXT_SIZE,Rn._defaultFontSize],[ve.FREETEXT_COLOR,Rn._defaultColor||Wt._defaultLineColor]]}get propertiesToUpdate(){return[[ve.FREETEXT_SIZE,this.#n],[ve.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new zc(this),[["colorPicker",this._colorPicker]]}get colorType(){return ve.FREETEXT_COLOR}#s(t){const e=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#n)*this.parentScale),this.#n=a,this.#o()},i=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const e=a=>{this.color=a,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Rn._internalPadding*t,-(Rn._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Rn.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#a().trimEnd();if(t===e)return;const i=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Rn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,p]=this.pageDimensions,[y,w]=this.pageTranslation;let A,_;switch(this.rotation){case 0:A=t+(c[0]-y)/f,_=e+this.height-(c[1]-w)/p;break;case 90:A=t+(c[0]-y)/f,_=e-(c[1]-w)/p,[u,d]=[d,-u];break;case 180:A=t-this.width+(c[0]-y)/f,_=e-(c[1]-w)/p,[u,d]=[-u,-d];break;case 270:A=t+(c[0]-y-this.height*p)/f,_=e+(c[1]-w-this.width*f)/p,[u,d]=[-d,u];break}this.setAt(A*a,_*l,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Ch,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const a=Rn.#h(e.getData("text")||"").replaceAll(Ch,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:d}=c,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(Ch,"")),A!==this.editorDiv){let _=f;for(const S of this.editorDiv.childNodes){if(S===A){_=p;continue}_.push(Rn.#c(S))}}f.push(u.nodeValue.slice(0,d).replaceAll(Ch,""))}else if(u===this.editorDiv){let A=f,_=0;for(const S of this.editorDiv.childNodes)_++===d&&(A=p),A.push(Rn.#c(S))}this.#t=`${f.join(`
`)}${a}${p.join(`
`)}`,this.#l();const y=new Range;let w=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const _=A.nodeValue.length;if(w<=_){y.setStart(A,w),y.setEnd(A,w);break}w-=_}l.removeAllRanges(),l.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Rn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let a=null;if(t instanceof nx){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:f,id:p,popupRef:y,richText:w,contentsObj:A,creationDate:_,modificationDate:S},textContent:C,textPosition:M,parent:{page:{pageNumber:N}}}=t;if(!C||C.length===0)return null;a=t={annotationType:re.FREETEXT,color:Array.from(u),fontSize:c,value:C.join(`
`),position:M,pageIndex:N-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:A?.str||null,richText:w,creationDate:_,modificationDate:S}}const l=await super.deserialize(t,e,i);return l.#n=t.fontSize,l.color=qt.makeHexColor(...t.color),l.#t=Rn.#h(t.value),l._initialData=a,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Wt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((c,u)=>c!==a[u])||t.pageIndex!==l}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const a of this.#t.split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),e.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Gt{static PRECISION=1e-4;toSVGPath(){Me("Abstract method `toSVGPath` must be implemented.")}get box(){Me("Abstract getter `box` must be implemented.")}serialize(t,e){Me("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u]*a,c[u+1]=i+t[u+1]*l;return c}static _rescaleAndSwap(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u+1]*a,c[u+1]=i+t[u]*l;return c}static _translate(t,e,i,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l],a[l+1]=i+t[l+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,a,l){switch(l){case 90:return[1-e/i,t/a];case 180:return[1-t/i,1-e/a];case 270:return[e/i,1-t/a];default:return[t/i,e/a]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,a,l,c){return[(t+5*i)/6,(e+5*a)/6,(5*i+l)/6,(5*a+c)/6,(i+l)/2,(a+c)/2]}}class qr{#t;#e=[];#i;#n;#s=[];#r=new Float32Array(18);#a;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=qr.#g+qr.#m;constructor({x:t,y:e},i,a,l,c,u=0){this.#t=i,this.#h=l*a,this.#n=c,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=qr.#g*a,this.#c=qr.#u*a,this.#d=a,this.#f.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#p(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,a,l,c]=this.#t;return[(this.#a+(t[0]-e[0])/2-i)/l,(this.#o+(t[1]-e[1])/2-a)/c,(this.#a+(e[0]-t[0])/2-i)/l,(this.#o+(e[1]-t[1])/2-a)/c]}add({x:t,y:e}){this.#a=t,this.#o=e;const[i,a,l,c]=this.#t;let[u,d,f,p]=this.#r.subarray(8,12);const y=t-f,w=e-p,A=Math.hypot(y,w);if(A<this.#c)return!1;const _=A-this.#l,S=_/A,C=S*y,M=S*w;let N=u,k=d;u=f,d=p,f+=C,p+=M,this.#f?.push(t,e);const j=-M/_,F=C/_,z=j*this.#h,H=F*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+z,p+H],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-z,p-H],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([u+z,d+H],2),this.#s.push(NaN,NaN,NaN,NaN,(u+z-i)/l,(d+H-a)/c),this.#r.set([u-z,d-H],14),this.#e.push(NaN,NaN,NaN,NaN,(u-z-i)/l,(d-H-a)/c)),this.#r.set([N,k,u,d,f,p],6),!this.isEmpty()):(this.#r.set([N,k,u,d,f,p],6),Math.abs(Math.atan2(k-d,N-u)-Math.atan2(M,C))<Math.PI/2?([u,d,f,p]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((u+f)/2-i)/l,((d+p)/2-a)/c),[u,d,N,k]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((N+u)/2-i)/l,((k+d)/2-a)/c),!0):([N,k,u,d,f,p]=this.#r.subarray(0,6),this.#s.push(((N+5*u)/6-i)/l,((k+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+p)/6-a)/c,((u+f)/2-i)/l,((d+p)/2-a)/c),[f,p,u,d,N,k]=this.#r.subarray(12,18),this.#e.push(((N+5*u)/6-i)/l,((k+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+p)/6-a)/c,((u+f)/2-i)/l,((d+p)/2-a)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?i.push(`L${t[a+4]} ${t[a+5]}`):i.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#b(i);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?i.push(`L${e[a+4]} ${e[a+5]}`):i.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return this.#v(i),i.join(" ")}#y(){const[t,e,i,a]=this.#t,[l,c,u,d]=this.#p();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/a} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/a} L${l} ${c} L${u} ${d} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/a} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/a} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,i,a,l]=this.#t,c=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[d,f,p,y]=this.#p();t.push(`L${(c[0]-e)/a} ${(c[1]-i)/l} L${d} ${f} L${p} ${y} L${(u[0]-e)/a} ${(u[1]-i)/l}`)}newFreeDrawOutline(t,e,i,a,l,c){return new rx(t,e,i,a,l,c)}getOutlines(){const t=this.#s,e=this.#e,i=this.#r,[a,l,c,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let y=0,w=d.length-2;y<w;y+=2)d[y]=(this.#f[y]-a)/c,d[y+1]=(this.#f[y+1]-l)/u;if(d[d.length-2]=(this.#a-a)/c,d[d.length-1]=(this.#o-l)/u,isNaN(i[6])&&!this.isEmpty())return this.#E(d);const f=new Float32Array(this.#s.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#w(f,p);for(let y=e.length-6;y>=6;y-=6)for(let w=0;w<6;w+=2){if(isNaN(e[y+w])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[y+w],f[p+1]=e[y+w+1],p+=2}return this.#S(f,p),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#n)}#E(t){const e=this.#r,[i,a,l,c]=this.#t,[u,d,f,p]=this.#p(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-i)/l,(e[3]-a)/c,NaN,NaN,NaN,NaN,(e[4]-i)/l,(e[5]-a)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-i)/l,(e[17]-a)/c,NaN,NaN,NaN,NaN,(e[14]-i)/l,(e[15]-a)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#i,this.#n)}#S(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#w(t,e){const i=this.#r.subarray(4,6),a=this.#r.subarray(16,18),[l,c,u,d]=this.#t,[f,p,y,w]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-c)/d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,w,NaN,NaN,NaN,NaN,(a[0]-l)/u,(a[1]-c)/d],e),e+=24}}class rx extends Gt{#t;#e=new Float32Array(4);#i;#n;#s;#r;#a;constructor(t,e,i,a,l,c){super(),this.#a=t,this.#s=e,this.#t=i,this.#r=a,this.#i=l,this.#n=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,d,f,p]=this.#e;for(let y=0,w=t.length;y<w;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-d)/p;for(let y=0,w=e.length;y<w;y+=2)e[y]=(e[y]-u)/f,e[y+1]=(e[y+1]-d)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,i=this.#a.length;e<i;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,a],l){const c=i-t,u=a-e;let d,f;switch(l){case 0:d=Gt._rescale(this.#a,t,a,c,-u),f=Gt._rescale(this.#s,t,a,c,-u);break;case 90:d=Gt._rescaleAndSwap(this.#a,t,e,c,u),f=Gt._rescaleAndSwap(this.#s,t,e,c,u);break;case 180:d=Gt._rescale(this.#a,i,e,-c,u),f=Gt._rescale(this.#s,i,e,-c,u);break;case 270:d=Gt._rescaleAndSwap(this.#a,i,a,-c,-u),f=Gt._rescaleAndSwap(this.#s,i,a,-c,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#a;let i=e[4],a=e[5];const l=[i,a,i,a];let c=i,u=a,d=i,f=a;const p=t?Math.max:Math.min,y=new Float32Array(4);for(let A=6,_=e.length;A<_;A+=6){const S=e[A+4],C=e[A+5];isNaN(e[A])?(qt.pointBoundingBox(S,C,l),u>C?(c=S,u=C):u===C&&(c=p(c,S)),f<C?(d=S,f=C):f===C&&(d=p(d,S))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,qt.bezierBoundingBox(i,a,...e.slice(A,A+6),y),qt.rectBoundingBox(y[0],y[1],y[2],y[3],l),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=p(c,y[0])),f<y[3]?(d=y[2],f=y[3]):f===y[3]&&(d=p(d,y[2]))),i=S,a=C}const w=this.#e;w[0]=l[0]-this.#i,w[1]=l[1]-this.#i,w[2]=l[2]-l[0]+2*this.#i,w[3]=l[3]-l[1]+2*this.#i,this.firstPoint=[c,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,i,a,l,c=0){return new qr(t,e,i,a,l,c)}getNewOutline(t,e){const[i,a,l,c]=this.#e,[u,d,f,p]=this.#t,y=l*f,w=c*p,A=i*f+u,_=a*p+d,S=this.newOutliner({x:this.#s[0]*y+A,y:this.#s[1]*w+_},this.#t,this.#r,t,this.#n,e??this.#i);for(let C=2;C<this.#s.length;C+=2)S.add({x:this.#s[C]*y+A,y:this.#s[C+1]*w+_});return S.getOutlines()}}class cm{#t;#e;#i;#n=[];#s=[];constructor(t,e=0,i=0,a=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:S,y:C,width:M,height:N}of t){const k=Math.floor((S-e)/c)*c,j=Math.ceil((S+M+e)/c)*c,F=Math.floor((C-e)/c)*c,z=Math.ceil((C+N+e)/c)*c,H=[k,F,z,!0],ut=[j,F,z,!1];this.#n.push(H,ut),qt.rectBoundingBox(k,F,j,z,l)}const u=l[2]-l[0]+2*i,d=l[3]-l[1]+2*i,f=l[0]-i,p=l[1]-i;let y=a?-1/0:1/0,w=1/0;const A=this.#n.at(a?-1:-2),_=[A[0],A[2]];for(const S of this.#n){const[C,M,N,k]=S;!k&&a?M<w?(w=M,y=C):M===w&&(y=Math.max(y,C)):k&&!a&&(M<w?(w=M,y=C):M===w&&(y=Math.min(y,C))),S[0]=(C-f)/u,S[1]=(M-p)/d,S[2]=(N-p)/d}this.#t=new Float32Array([f,p,u,d]),this.#e=[y,w],this.#i=_}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],i=new Set;for(const c of t){const[u,d,f]=c;e.push([u,d,c],[u,f,c])}e.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=e.length;c<u;c+=2){const d=e[c][2],f=e[c+1][2];d.push(f),f.push(d),i.add(d),i.add(f)}const a=[];let l;for(;i.size>0;){const c=i.values().next().value;let[u,d,f,p,y]=c;i.delete(c);let w=u,A=d;for(l=[u,f],a.push(l);;){let _;if(i.has(p))_=p;else if(i.has(y))_=y;else break;i.delete(_),[u,d,f,p,y]=_,w!==u&&(l.push(w,A,u,A===d?d:f),w=u),A=A===d?f:d}l.push(w,A)}return new b2(a,this.#t,this.#e,this.#i)}#a(t){const e=this.#s;let i=0,a=e.length-1;for(;i<=a;){const l=i+a>>1,c=e[l][0];if(c===t)return l;c<t?i=l+1:a=l-1}return a+1}#o([,t,e]){const i=this.#a(t);this.#s.splice(i,0,[t,e])}#c([,t,e]){const i=this.#a(t);for(let a=i;a<this.#s.length;a++){const[l,c]=this.#s[a];if(l!==t)break;if(l===t&&c===e){this.#s.splice(a,1);return}}for(let a=i-1;a>=0;a--){const[l,c]=this.#s[a];if(l!==t)break;if(l===t&&c===e){this.#s.splice(a,1);return}}}#l(t){const[e,i,a]=t,l=[[e,i,a]],c=this.#a(a);for(let u=0;u<c;u++){const[d,f]=this.#s[u];for(let p=0,y=l.length;p<y;p++){const[,w,A]=l[p];if(!(f<=w||A<=d)){if(w>=d){if(A>f)l[p][1]=f;else{if(y===1)return[];l.splice(p,1),p--,y--}continue}l[p][2]=d,A>f&&l.push([e,f,A])}}}return l}}class b2 extends Gt{#t;#e;constructor(t,e,i,a){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=a}toSVGPath(){const t=[];for(const e of this.#e){let[i,a]=e;t.push(`M${i} ${a}`);for(let l=2;l<e.length;l+=2){const c=e[l],u=e[l+1];c===i?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${c}`),i=c)}t.push("Z")}return t.join(" ")}serialize([t,e,i,a],l){const c=[],u=i-t,d=a-e;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=a-f[y+1]*d;c.push(p)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class um extends qr{newFreeDrawOutline(t,e,i,a,l,c){return new v2(t,e,i,a,l,c)}}class v2 extends rx{newOutliner(t,e,i,a,l,c=0){return new um(t,e,i,a,l,c)}}class ln extends Wt{#t=null;#e=0;#i;#n=null;#s=null;#r=null;#a=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=re.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ln.prototype;return ie(this,"_keyboardManager",new Zc([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ln._defaultColor,this.#p=t.thickness||ln._defaultThickness,this.opacity=t.opacity||ln._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#x()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#x(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new cm(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new cm(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:a}=this.#r;this.#g=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const a=1.5;if(this.#r=t.getNewOutline(this.#p/2+a,.0025),e>=0)this.#d=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ln.#_(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:ln.#_(this.#r.box,y),path:{d:this.#r.toSVGPath()}})}const[l,c,u,d]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=d;break;case 90:{const[y,w]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*w/y,this.height=d*y/w;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=d;break;case 270:{const[y,w]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*w/y,this.height=d*y/w;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/d];const{lastPoint:p}=this.#r;this.#g=[(p[0]-l)/u,(p[1]-c)/d]}static initialize(t,e){Wt.initialize(t,e),ln._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case ve.HIGHLIGHT_COLOR:ln._defaultColor=e;break;case ve.HIGHLIGHT_THICKNESS:ln._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case ve.HIGHLIGHT_COLOR:this.#E(e);break;case ve.HIGHLIGHT_THICKNESS:this.#S(e);break}}static get defaultPropertiesToUpdate(){return[[ve.HIGHLIGHT_COLOR,ln._defaultColor],[ve.HIGHLIGHT_THICKNESS,ln._defaultThickness]]}get propertiesToUpdate(){return[[ve.HIGHLIGHT_COLOR,this.color||ln._defaultColor],[ve.HIGHLIGHT_THICKNESS,this.#p||ln._defaultThickness],[ve.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#s?.updateColor(this.color),super.onUpdatedColor()}#E(t){const e=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},i=this.color,a=this.opacity;this.addCommands({cmd:e.bind(this,t,ln._defaultOpacity),undo:e.bind(this,i,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#S(t){const e=this.#p,i=a=>{this.#p=a,this.#w(a)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:ve.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new tx({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#M())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#x(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#x(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#w(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#x(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#_([t,e,i,a],l){switch(l){case 90:return[1-e-a,t,a,i];case 180:return[1-t-i,1-e-a,i,a];case 270:return[e,1-t-i,a,i]}return[t,e,i,a]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=ln.#_(this.#l.box,t)):i=ln.#_([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#m,{bbox:ln.#_(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),Nw(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#D(t){ln._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#M(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[t,e]=this.pageDimensions,[i,a]=this.pageTranslation,l=this.#i,c=new Float32Array(l.length*8);let u=0;for(const{x:d,y:f,width:p,height:y}of l){const w=d*t+i,A=(1-f)*e+a;c[u]=c[u+4]=w,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=w+p*t,c[u+5]=c[u+7]=A-y*e,u+=8}return c}#N(t){return this.#l.serialize(t,this.#M())}static startHighlighting(t,e,{target:i,x:a,y:l}){const{x:c,y:u,width:d,height:f}=i.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),w=A=>{p.abort(),this.#F(t,A)};window.addEventListener("blur",w,{signal:y}),window.addEventListener("pointerup",w,{signal:y}),window.addEventListener("pointerdown",en,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",qi,{signal:y}),i.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new um({x:a,y:l},[c,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let a=null;if(t instanceof sx){const{data:{quadPoints:_,rect:S,rotation:C,id:M,color:N,opacity:k,popupRef:j,richText:F,contentsObj:z,creationDate:H,modificationDate:ut},parent:{page:{pageNumber:ft}}}=t;a=t={annotationType:re.HIGHLIGHT,color:Array.from(N),opacity:k,quadPoints:_,boxes:null,pageIndex:ft-1,rect:S.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,popupRef:j,richText:F,comment:z?.str||null,creationDate:H,modificationDate:ut}}else if(t instanceof Gm){const{data:{inkLists:_,rect:S,rotation:C,id:M,color:N,borderStyle:{rawWidth:k},popupRef:j,richText:F,contentsObj:z,creationDate:H,modificationDate:ut},parent:{page:{pageNumber:ft}}}=t;a=t={annotationType:re.HIGHLIGHT,color:Array.from(N),thickness:k,inkLists:_,boxes:null,pageIndex:ft-1,rect:S.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,popupRef:j,richText:F,comment:z?.str||null,creationDate:H,modificationDate:ut}}const{color:l,quadPoints:c,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,i);f.color=qt.makeHexColor(...l),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[p,y]=f.pageDimensions,[w,A]=f.pageTranslation;if(c){const _=f.#i=[];for(let S=0;S<c.length;S+=8)_.push({x:(c[S]-w)/p,y:1-(c[S+1]-A)/y,width:(c[S+2]-c[S])/p,height:(c[S+1]-c[S+5])/y});f.#v(),f.#x(),f.rotate(f.rotation)}else if(u){f.#h=!0;const _=u[0],S={x:_[0]-w,y:y-(_[1]-A)},C=new um(S,[0,0,p,y],1,f.#p/2,!0,.001);for(let k=0,j=_.length;k<j;k+=2)S.x=_[k]-w,S.y=y-(_[k+1]-A),C.add(S);const{id:M,clipPathId:N}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);f.#b({highlightOutlines:C.getOutlines(),highlightId:M,clipPathId:N}),f.#x(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Wt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#N(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#P(i)?null:(i.id=this.annotationElementId,i)}#P(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,a)=>i!==e[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class ox{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Me("Not implemented")}}class _e extends Wt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#s=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#a(t,this.parent),this.#h(t.box)}#a(t,e){const{id:i}=e.drawLayer.draw(_e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[a,l]of Object.entries(e))i.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){Me("Not implemented")}static get typesMap(){Me("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(_e.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,a]of this.typesMap)t.push([i,e[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,a]of this.constructor.typesMap)t.push([i,e[a]]);return t}_updateProperty(t,e,i){const a=this._drawingOptions,l=a[e],c=u=>{a.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#a(this.#t,t)}}#l([t,e,i,a]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(c/l),a*(l/c)];case 180:return[1-t,1-e,i,a];case 270:return[1-e,t,i*(c/l),a*(l/c)];default:return[t,e,i,a]}}#d(){const{x:t,y:e,width:i,height:a,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(l/c),a*(c/l)];case 180:return[1-t,1-e,i,a];case 270:return[e,1-t,i*(l/c),a*(c/l)];default:return[t,e,i,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:i,height:a,rotation:l,parentRotation:c,parentDimensions:[u,d]}=this;switch((l*4+c)/90){case 1:return[1-e-a,t,a,i];case 2:return[1-t-i,1-e-a,i,a];case 3:return[e,1-t-i,a,i];case 4:return[t,e-i*(u/d),a*(d/u),i*(u/d)];case 5:return[1-e,t,i*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-e,a*(d/u),i*(u/d)];case 7:return[e-i*(u/d),1-t-a*(d/u),i*(u/d),a*(d/u)];case 8:return[t-i,e-a,i,a];case 9:return[1-e,t-i,a,i];case 10:return[1-t,1-e,i,a];case 11:return[e-a,1-t,a,i];case 12:return[t-a*(d/u),e,a*(d/u),i*(u/d)];case 13:return[1-e-i*(u/d),t-a*(d/u),i*(u/d),a*(d/u)];case 14:return[1-t,1-e-i*(u/d),a*(d/u),i*(u/d)];case 15:return[e,1-t,i*(u/d),a*(d/u)];default:return[t,e,i,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const a=document.createElement("div");return i.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,a,l){Me("Not implemented")}static startDrawing(t,e,i,a){const{target:l,offsetX:c,offsetY:u,pointerId:d,pointerType:f}=a;if(Te.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=t,{width:y,height:w}=l.getBoundingClientRect(),A=_e.#n=new AbortController,_=t.combinedSignal(A);if(Te.setPointer(f,d),window.addEventListener("pointerup",S=>{Te.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:_}),window.addEventListener("pointercancel",S=>{Te.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:_}),window.addEventListener("pointerdown",S=>{Te.isSamePointerType(S.pointerType)&&(Te.initializeAndAddPointerId(S.pointerId),_e.#i.isCancellable()&&(_e.#i.removeLastElement(),_e.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",qi,{signal:_}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),l.addEventListener("touchmove",S=>{Te.isSameTimeStamp(S.timeStamp)&&en(S)},{signal:_}),t.toggleDrawing(),e._editorUndoBar?.hide(),_e.#i){t.drawLayer.updateProperties(this._currentDrawId,_e.#i.startNew(c,u,y,w,p));return}e.updateUIForDefaultProperties(this),_e.#i=this.createDrawerInstance(c,u,y,w,p),_e.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(_e.#s.toSVGProperties(),_e.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Te.isSameTimeStamp(t.timeStamp),!_e.#i)return;const{offsetX:e,offsetY:i,pointerId:a}=t;if(Te.isSamePointerId(a)){if(Te.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,_e.#i.add(e,i)),Te.setTimeStamp(t.timeStamp),en(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_e.#i=null,_e.#s=null,Te.clearTimeStamp()),_e.#n&&(_e.#n.abort(),_e.#n=null,Te.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,_e.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=_e.#i,a=this._currentDrawId,l=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(a,i.setLastElement(l))},undo:()=>{e.drawLayer.updateProperties(a,i.removeLastElement())},mustExec:!1,type:ve.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(ve.DRAW_STEP),!_e.#i.isEmpty()){const{pageDimensions:[i,a],scale:l}=e,c=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:_e.#i.getOutlines(i*l,a*l,l,this._INNER_MARGIN),drawingOptions:_e.#s,mustBeCommitted:!t});return this._cleanup(!0),c}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,a,l,c){Me("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:u}}=e.viewport,d=this.deserializeDraw(c,u,a,l,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#r({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[a,l]=this.pageDimensions;return this.#t.serialize([e,i,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class w2{#t=new Float64Array(6);#e;#i;#n;#s;#r;#a="";#o=0;#c=new Jc;#l;#d;constructor(t,e,i,a,l,c){this.#l=i,this.#d=a,this.#n=l,this.#s=c,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#h(t,e){return Gt._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#h(t,e);const[i,a,l,c]=this.#t.subarray(2,6),u=t-l,d=e-c;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([l,c,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,a,l,c,t,e],0),this.#e.push(...Gt.createBezierPoints(i,a,l,c,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,a,l){this.#l=i,this.#d=a,this.#n=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:c,points:this.#r}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#a="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:a}=this.#i[t];this.#e=i,this.#r=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=Gt.svgRound(this.#e[4]),e=Gt.svgRound(this.#e[5]);if(this.#r.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#r.length<=6){const a=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,a)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const a=Gt.svgRound(this.#e[10]),l=Gt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${a} ${l}`,this.#o=12,this.#a}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let a=this.#o,l=this.#e.length;a<l;a+=6){const[c,u,d,f,p,y]=this.#e.slice(a,a+6).map(Gt.svgRound);i.push(`C${c} ${u} ${d} ${f} ${p} ${y}`)}return this.#a+=i.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,i,a){const l=this.#i.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#i,t,e,i,this.#n,this.#s,a),this.#t=null,this.#e=null,this.#i=null,this.#a=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Jc extends Gt{#t;#e=0;#i;#n;#s;#r;#a;#o;#c;build(t,e,i,a,l,c,u){this.#s=e,this.#r=i,this.#a=a,this.#o=l,this.#c=c,this.#i=u??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${Gt.svgRound(e[4])} ${Gt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Gt.svgRound(e[10])} ${Gt.svgRound(e[11])}`);continue}for(let i=6,a=e.length;i<a;i+=6){const[l,c,u,d,f,p]=e.subarray(i,i+6).map(Gt.svgRound);t.push(`C${l} ${c} ${u} ${d} ${f} ${p}`)}}return t.join("")}serialize([t,e,i,a],l){const c=[],u=[],[d,f,p,y]=this.#d();let w,A,_,S,C,M,N,k,j;switch(this.#o){case 0:j=Gt._rescale,w=t,A=e+a,_=i,S=-a,C=t+d*i,M=e+(1-f-y)*a,N=t+(d+p)*i,k=e+(1-f)*a;break;case 90:j=Gt._rescaleAndSwap,w=t,A=e,_=i,S=a,C=t+f*i,M=e+d*a,N=t+(f+y)*i,k=e+(d+p)*a;break;case 180:j=Gt._rescale,w=t+i,A=e,_=-i,S=a,C=t+(1-d-p)*i,M=e+f*a,N=t+(1-d)*i,k=e+(f+y)*a;break;case 270:j=Gt._rescaleAndSwap,w=t+i,A=e+a,_=-i,S=-a,C=t+(1-f-y)*i,M=e+(1-d-p)*a,N=t+(1-f)*i,k=e+(1-d)*a;break}for(const{line:F,points:z}of this.#n)c.push(j(F,w,A,_,S,l?new Array(F.length):null)),u.push(j(z,w,A,_,S,l?new Array(z.length):null));return{lines:c,points:u,rect:[C,M,N,k]}}static deserialize(t,e,i,a,l,{paths:{lines:c,points:u},rotation:d,thickness:f}){const p=[];let y,w,A,_,S;switch(d){case 0:S=Gt._rescale,y=-t/i,w=e/a+1,A=1/i,_=-1/a;break;case 90:S=Gt._rescaleAndSwap,y=-e/a,w=-t/i,A=1/a,_=1/i;break;case 180:S=Gt._rescale,y=t/i+1,w=-e/a,A=-1/i,_=1/a;break;case 270:S=Gt._rescaleAndSwap,y=e/a+1,w=t/i+1,A=-1/a,_=-1/i;break}if(!c){c=[];for(const M of u){const N=M.length;if(N===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,M[0],M[1]]));continue}if(N===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,M[0],M[1],NaN,NaN,NaN,NaN,M[2],M[3]]));continue}const k=new Float32Array(3*(N-2));c.push(k);let[j,F,z,H]=M.subarray(0,4);k.set([NaN,NaN,NaN,NaN,j,F],0);for(let ut=4;ut<N;ut+=2){const ft=M[ut],_t=M[ut+1];k.set(Gt.createBezierPoints(j,F,z,H,ft,_t),(ut-2)*3),[j,F,z,H]=[z,H,ft,_t]}}}for(let M=0,N=c.length;M<N;M++)p.push({line:S(c[M].map(k=>k??NaN),y,w,A,_),points:S(u[M].map(k=>k??NaN),y,w,A,_)});const C=new this.prototype.constructor;return C.build(p,i,a,1,d,f,l),C}#l(t=this.#c){const e=this.#i+t/2*this.#a;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#d(){const[t,e,i,a]=this.#t,[l,c]=this.#l(0);return[t+l,e+c,i-2*l,a-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#n){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)qt.pointBoundingBox(a[u],a[u+1],t);continue}let l=a[4],c=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,p,y,w,A,_]=a.subarray(u,u+6);qt.bezierBoundingBox(l,c,f,p,y,w,A,_,t),l=A,c=_}}const[e,i]=this.#l();t[0]=jn(t[0]-e,0,1),t[1]=jn(t[1]-i,0,1),t[2]=jn(t[2]+e,0,1),t[3]=jn(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[a,l]=this.#l(),[c,u]=[a-e,l-i],d=this.#t;return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateParentDimensions([t,e],i){const[a,l]=this.#l();this.#s=t,this.#r=e,this.#a=i;const[c,u]=this.#l(),d=c-a,f=u-l,p=this.#t;return p[0]-=d,p[1]-=f,p[2]+=2*d,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Gt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,a=0,l=0,c=0,u=0,d=0;switch(this.#e){case 90:a=e/t,l=-t/e,u=t;break;case 180:i=-1,c=-1,u=t,d=e;break;case 270:a=-e/t,l=t/e,d=e;break;default:return""}return`matrix(${i} ${a} ${l} ${c} ${Gt.svgRound(u)} ${Gt.svgRound(d)})`}getPathResizingSVGProperties([t,e,i,a]){const[l,c]=this.#l(),[u,d,f,p]=this.#t;if(Math.abs(f-l)<=Gt.PRECISION||Math.abs(p-c)<=Gt.PRECISION){const S=t+i/2-(u+f/2),C=e+a/2-(d+p/2);return{path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${S} ${C})`}}}const y=(i-2*l)/(f-2*l),w=(a-2*c)/(p-2*c),A=f/i,_=p/a;return{path:{"transform-origin":`${Gt.svgRound(u)} ${Gt.svgRound(d)}`,transform:`${this.rotationTransform} scale(${A} ${_}) translate(${Gt.svgRound(l)} ${Gt.svgRound(c)}) scale(${y} ${w}) translate(${Gt.svgRound(-l)} ${Gt.svgRound(-c)})`}}}getPathResizedSVGProperties([t,e,i,a]){const[l,c]=this.#l(),u=this.#t,[d,f,p,y]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=a,Math.abs(p-l)<=Gt.PRECISION||Math.abs(y-c)<=Gt.PRECISION){const C=t+i/2-(d+p/2),M=e+a/2-(f+y/2);for(const{line:N,points:k}of this.#n)Gt._translate(N,C,M,N),Gt._translate(k,C,M,k);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const w=(i-2*l)/(p-2*l),A=(a-2*c)/(y-2*c),_=-w*(d+l)+t+l,S=-A*(f+c)+e+c;if(w!==1||A!==1||_!==0||S!==0)for(const{line:C,points:M}of this.#n)Gt._rescale(C,_,S,w,A,C),Gt._rescale(M,_,S,w,A,M);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[a,l]=i,c=this.#t,u=t-c[0],d=e-c[1];if(this.#s===a&&this.#r===l)for(const{line:f,points:p}of this.#n)Gt._translate(f,u,d,f),Gt._translate(p,u,d,p);else{const f=this.#s/a,p=this.#r/l;this.#s=a,this.#r=l;for(const{line:y,points:w}of this.#n)Gt._rescale(y,u,d,f,p,y),Gt._rescale(w,u,d,f,p,w);c[2]*=f,c[3]*=p}return c[0]=t,c[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t[0])} ${Gt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class yd extends ox{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Wt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new yd(this._viewParameters);return t.updateAll(this),t}}class $m extends _e{static _type="ink";static _editorType=re.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Wt.initialize(t,e),this._defaultDrawingOptions=new yd(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return ie(this,"typesMap",new Map([[ve.INK_THICKNESS,"stroke-width"],[ve.INK_COLOR,"stroke"],[ve.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,a,l){return new w2(t,e,i,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,a,l,c){return Jc.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){let a=null;if(t instanceof Gm){const{data:{inkLists:c,rect:u,rotation:d,id:f,color:p,opacity:y,borderStyle:{rawWidth:w},popupRef:A,richText:_,contentsObj:S,creationDate:C,modificationDate:M},parent:{page:{pageNumber:N}}}=t;a=t={annotationType:re.INK,color:Array.from(p),thickness:w,opacity:y,paths:{points:c},boxes:null,pageIndex:N-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:_,comment:S?.str||null,creationDate:C,modificationDate:M}}const l=await super.deserialize(t,e,i);return l._initialData=a,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new zc(this),[["colorPicker",this._colorPicker]]}get colorType(){return ve.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=$m.getDefaultDrawingOptions({stroke:qt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:Wt._colorManager.convert(a),opacity:l,thickness:c,paths:{lines:e,points:i}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==e[u])||t.thickness!==i||t.opacity!==a||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class hm extends Jc{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Th=8,Tc=3;class Jo{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,a){return i-=t,a-=e,i===0?a>0?0:4:i===1?a+6:2-a}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const p=(-f+d-u+16)%8,y=this.#i[2*p],w=this.#i[2*p+1];if(t[(i+y)*e+(a+w)]!==0)return p}return-1}static#s(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const p=(f+d+u+16)%8,y=this.#i[2*p],w=this.#i[2*p+1];if(t[(i+y)*e+(a+w)]!==0)return p}return-1}static#r(t,e,i,a){const l=t.length,c=new Int32Array(l);for(let p=0;p<l;p++)c[p]=t[p]<=a?1:0;for(let p=1;p<i-1;p++)c[p*e]=c[p*e+e-1]=0;for(let p=0;p<e;p++)c[p]=c[e*i-1-p]=0;let u=1,d;const f=[];for(let p=1;p<i-1;p++){d=1;for(let y=1;y<e-1;y++){const w=p*e+y,A=c[w];if(A===0)continue;let _=p,S=y;if(A===1&&c[w-1]===0)u+=1,S-=1;else if(A>=1&&c[w+1]===0)u+=1,S+=1,A>1&&(d=A);else{A!==1&&(d=Math.abs(A));continue}const C=[y,p],M=S===y+1,N={isHole:M,points:C,id:u,parent:0};f.push(N);let k;for(const ct of f)if(ct.id===d){k=ct;break}k?k.isHole?N.parent=M?k.parent:d:N.parent=M?d:k.parent:N.parent=M?d:0;const j=this.#n(c,e,p,y,_,S,0);if(j===-1){c[w]=-u,c[w]!==1&&(d=Math.abs(c[w]));continue}let F=this.#i[2*j],z=this.#i[2*j+1];const H=p+F,ut=y+z;_=H,S=ut;let ft=p,_t=y;for(;;){const ct=this.#s(c,e,ft,_t,_,S,1);F=this.#i[2*ct],z=this.#i[2*ct+1];const Rt=ft+F,Lt=_t+z;C.push(Lt,Rt);const Bt=ft*e+_t;if(c[Bt+1]===0?c[Bt]=-u:c[Bt]===1&&(c[Bt]=u),Rt===p&&Lt===y&&ft===H&&_t===ut){c[w]!==1&&(d=Math.abs(c[w]));break}else _=ft,S=_t,ft=Rt,_t=Lt}}}return f}static#a(t,e,i,a){if(i-e<=4){for(let H=e;H<i-2;H+=2)a.push(t[H],t[H+1]);return}const l=t[e],c=t[e+1],u=t[i-4]-l,d=t[i-3]-c,f=Math.hypot(u,d),p=u/f,y=d/f,w=p*c-y*l,A=d/u,_=1/f,S=Math.atan(A),C=Math.cos(S),M=Math.sin(S),N=_*(Math.abs(C)+Math.abs(M)),k=_*(1-N+N**2),j=Math.max(Math.atan(Math.abs(M+C)*k),Math.atan(Math.abs(M-C)*k));let F=0,z=e;for(let H=e+2;H<i-2;H+=2){const ut=Math.abs(w-p*t[H+1]+y*t[H]);ut>F&&(z=H,F=ut)}F>(f*j)**2?(this.#a(t,e,z+2,a),this.#a(t,z,i,a)):a.push(l,c)}static#o(t){const e=[],i=t.length;return this.#a(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,a,l,c){const u=new Float32Array(c**2),d=-2*a**2,f=c>>1;for(let S=0;S<c;S++){const C=(S-f)**2;for(let M=0;M<c;M++)u[S*c+M]=Math.exp((C+(M-f)**2)/d)}const p=new Float32Array(256),y=-2*l**2;for(let S=0;S<256;S++)p[S]=Math.exp(S**2/y);const w=t.length,A=new Uint8Array(w),_=new Uint32Array(256);for(let S=0;S<i;S++)for(let C=0;C<e;C++){const M=S*e+C,N=t[M];let k=0,j=0;for(let z=0;z<c;z++){const H=S+z-f;if(!(H<0||H>=i))for(let ut=0;ut<c;ut++){const ft=C+ut-f;if(ft<0||ft>=e)continue;const _t=t[H*e+ft],ct=u[z*c+ut]*p[Math.abs(_t-N)];k+=_t*ct,j+=ct}}const F=A[M]=Math.round(k/j);_[F]++}return[A,_]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let a=-1/0,l=1/0;for(let u=0,d=i.length;u<d;u++){const f=i[u]=t[u<<2];a=Math.max(a,f),l=Math.min(l,f)}const c=255/(a-l);for(let u=0,d=i.length;u<d;u++)i[u]=(i[u]-l)*c;return i}static#h(t){let e,i=-1/0,a=-1/0;const l=t.findIndex(d=>d!==0);let c=l,u=l;for(e=l;e<256;e++){const d=t[e];d>i&&(e-c>a&&(a=e-c,u=e-1),i=d,c=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:a}=t,{maxDim:l}=this.#t;let c=i,u=a;if(i>l||a>l){let w=i,A=a,_=Math.log2(Math.max(i,a)/l);const S=Math.floor(_);_=_===S?S-1:S;for(let M=0;M<_;M++){c=Math.ceil(w/2),u=Math.ceil(A/2);const N=new OffscreenCanvas(c,u);N.getContext("2d").drawImage(t,0,0,w,A,0,0,c,u),w=c,A=u,t!==e&&t.close(),t=N.transferToImageBitmap()}const C=Math.min(l/c,l/u);c=Math.round(c*C),u=Math.round(u*C)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const p=f.getImageData(0,0,c,u).data;return[this.#d(p),c,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:a},l,c,u,d){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,w=p.font=`${i} ${a} ${y}px ${e}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:_,actualBoundingBoxAscent:S,actualBoundingBoxDescent:C,fontBoundingBoxAscent:M,fontBoundingBoxDescent:N,width:k}=p.measureText(t),j=1.5,F=Math.ceil(Math.max(Math.abs(A)+Math.abs(_)||0,k)*j),z=Math.ceil(Math.max(Math.abs(S)+Math.abs(C)||y,Math.abs(M)+Math.abs(N)||y)*j);f=new OffscreenCanvas(F,z),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=w,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,F,z),p.fillStyle="black",p.fillText(t,F*(j-1)/2,z*(3-j)/2);const H=this.#d(p.getImageData(0,0,F,z).data),ut=this.#l(H),ft=this.#h(ut),_t=this.#r(H,F,z,ft);return this.processDrawnLines({lines:{curves:_t,width:F,height:z},pageWidth:l,pageHeight:c,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,i,a,l){const[c,u,d]=this.#f(t),[f,p]=this.#c(c,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(p),w=this.#r(f,u,d,y);return this.processDrawnLines({lines:{curves:w,width:u,height:d},pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:c,areContours:u}){a%180!==0&&([e,i]=[i,e]);const{curves:d,width:f,height:p}=t,y=t.thickness??0,w=[],A=Math.min(e/f,i/p),_=A/e,S=A/i,C=[];for(const{points:N}of d){const k=c?this.#o(N):N;if(!k)continue;C.push(k);const j=k.length,F=new Float32Array(j),z=new Float32Array(3*(j===2?2:j-2));if(w.push({line:z,points:F}),j===2){F[0]=k[0]*_,F[1]=k[1]*S,z.set([NaN,NaN,NaN,NaN,F[0],F[1]],0);continue}let[H,ut,ft,_t]=k;H*=_,ut*=S,ft*=_,_t*=S,F.set([H,ut,ft,_t],0),z.set([NaN,NaN,NaN,NaN,H,ut],0);for(let ct=4;ct<j;ct+=2){const Rt=F[ct]=k[ct]*_,Lt=F[ct+1]=k[ct+1]*S;z.set(Gt.createBezierPoints(H,ut,ft,_t,Rt,Lt),(ct-2)*3),[H,ut,ft,_t]=[ft,_t,Rt,Lt]}}if(w.length===0)return null;const M=u?new hm:new Jc;return M.build(w,e,i,1,a,u?0:y,l),{outline:M,newCurves:C,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:a,height:l}){let c=1/0,u=-1/0,d=0;for(const k of t){d+=k.length;for(let j=2,F=k.length;j<F;j++){const z=k[j]-k[j-2];c=Math.min(c,z),u=Math.max(u,z)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=Th+Tc*p,w=new Uint32Array(y);let A=0;w[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(d-2*p)*f.BYTES_PER_ELEMENT,w[A++]=0,w[A++]=a,w[A++]=l,w[A++]=e?0:1,w[A++]=Math.max(0,Math.floor(i??0)),w[A++]=p,w[A++]=f.BYTES_PER_ELEMENT;for(const k of t)w[A++]=k.length-2,w[A++]=k[0],w[A++]=k[1];const _=new CompressionStream("deflate-raw"),S=_.writable.getWriter();await S.ready,S.write(w);const C=f.prototype.constructor;for(const k of t){const j=new C(k.length-2);for(let F=2,z=k.length;F<z;F++)j[F-2]=k[F]-k[F-2];S.write(j)}S.close();const M=await new Response(_.readable).arrayBuffer();return new Uint8Array(M).toBase64()}static async decompressSignature(t){try{const e=Uint8Array.fromBase64(t),{readable:i,writable:a}=new DecompressionStream("deflate-raw"),l=a.getWriter();await l.ready,l.write(e).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const k of i)c||=new Uint8Array(new Uint32Array(k.buffer,0,4)[0]),c.set(k,u),u+=k.length;const d=new Uint32Array(c.buffer,0,c.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=d[2],y=d[3],w=d[4]===0,A=d[5],_=d[6],S=d[7],C=[],M=(Th+Tc*_)*Uint32Array.BYTES_PER_ELEMENT;let N;switch(S){case Int8Array.BYTES_PER_ELEMENT:N=new Int8Array(c.buffer,M);break;case Int16Array.BYTES_PER_ELEMENT:N=new Int16Array(c.buffer,M);break;case Int32Array.BYTES_PER_ELEMENT:N=new Int32Array(c.buffer,M);break}u=0;for(let k=0;k<_;k++){const j=d[Tc*k+Th],F=new Float32Array(j+2);C.push(F);for(let z=0;z<Tc-1;z++)F[z]=d[Tc*k+Th+z+1];for(let z=0;z<j;z++)F[z+2]=F[z]+N[u++]}return{areContours:w,thickness:A,outlines:C,width:p,height:y}}catch(e){return ne(`decompressSignature: ${e}`),null}}}class Km extends ox{constructor(){super(),super.updateProperties({fill:Wt._defaultLineColor,"stroke-width":0})}clone(){const t=new Km;return t.updateAll(this),t}}class Xm extends yd{constructor(t){super(t),super.updateProperties({stroke:Wt._defaultLineColor,"stroke-width":1})}clone(){const t=new Xm(this._viewParameters);return t.updateAll(this),t}}class Es extends _e{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=re.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Wt.initialize(t,e),this._defaultDrawingOptions=new Km,this._defaultDrawnSignatureOptions=new Xm(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return ie(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:a,mustSmooth:l,areContours:c,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:p,pageHeight:y},rotation:w}=this.parent.viewport,A=Jo.processDrawnLines({lines:a,pageWidth:p,pageHeight:y,rotation:w,innerMargin:Es._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(A,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:a,height:l}=this.#i,c=Math.max(a,l),u=Jo.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:i,width:a,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,a){const{x:l,y:c}=this,{outline:u}=this.#i=t;this.#t=u instanceof hm,this.description=i;let d;this.#t?d=Es.getDefaultDrawingOptions():(d=Es._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let p=e/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return Jo.process(t,e,i,a,Es._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:a},rotation:l}=this.parent.viewport;return Jo.extractContoursFromText(t,e,i,a,l,Es._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return Jo.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:Es._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Es.getDefaultDrawingOptions():(this._drawingOptions=Es._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(l),t?(l.paths={lines:e,points:i},l.uuid=this.#n,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,i,a,l,c){return c.areContours?hm.deserialize(t,e,i,a,l,c):Jc.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){const a=await super.deserialize(t,e,i);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#n=t.uuid,a}}class x2 extends Wt{#t=null;#e=null;#i=null;#n=null;#s=null;#r="";#a=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=re.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Wt.initialize(t,e)}static isHandlingMimeForPasting(t){return nm.includes(t)}static paste(t,e){e.pasteEditor({mode:re.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:a,width:l,height:c,channels:a.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#h(i,!0)).finally(()=>this.#f());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=nm.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#s||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,a&&(this.#t=a),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:e,height:i}=this.#t;const[a,l]=this.pageDimensions,c=.75;if(this.width)e=this.width*a,i=this.height*l;else if(e>c*a||i>c*l){const d=Math.min(c*a/e,c*l/i);e*=d,i*=d}this._uiManager.enableWaiting(!1);const u=this.#a=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/a,this.height=i/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:a,height:l}=this.#t,c=new Rs;let u=this.#t,d=a,f=l,p=null;if(e){if(a>e||l>e){const z=Math.min(e/a,e/l);d=Math.floor(a*z),f=Math.floor(l*z)}p=document.createElement("canvas");const w=p.width=Math.ceil(d*c.sx),A=p.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(w,A));const _=p.getContext("2d");_.filter=this._uiManager.hcmFilter;let S="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":HC.isDarkMode&&(S="#8f8f9d",C="#42414d");const M=15,N=M*c.sx,k=M*c.sy,j=new OffscreenCanvas(N*2,k*2),F=j.getContext("2d");F.fillStyle=S,F.fillRect(0,0,N*2,k*2),F.fillStyle=C,F.fillRect(0,0,N,k),F.fillRect(N,k,N,k),_.fillStyle=_.createPattern(j,"repeat"),_.fillRect(0,0,w,A),_.drawImage(u,0,0,u.width,u.height,0,0,w,A)}let y=null;if(i){let w,A;if(c.symmetric&&u.width<t&&u.height<t)w=u.width,A=u.height;else if(u=this.#t,a>t||l>t){const C=Math.min(t/a,t/l);w=Math.floor(a*C),A=Math.floor(l*C),this.#l||(u=this.#u(w,A))}const S=new OffscreenCanvas(w,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,w,A),y={width:w,height:A,data:S.getImageData(0,0,w,A).data}}return{canvas:p,width:d,height:f,imageData:y}}#u(t,e){const{width:i,height:a}=this.#t;let l=i,c=a,u=this.#t;for(;l>2*t||c>2*e;){const d=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*e&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(l,c);p.getContext("2d").drawImage(u,0,0,d,f,0,0,l,c),u=p.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:i,height:a}=this,l=new Rs,c=Math.ceil(i*t*l.sx),u=Math.ceil(a*e*l.sy),d=this.#a;if(!d||d.width===c&&d.height===u)return;d.width=c,d.height=u;const f=this.#l?this.#t:this.#u(c,u),p=d.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,a=Math.round(this.width*e*hl.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*hl.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let a=null,l=!1;if(t instanceof ax){const{data:{rect:S,rotation:C,id:M,structParent:N,popupRef:k,richText:j,contentsObj:F,creationDate:z,modificationDate:H},container:ut,parent:{page:{pageNumber:ft}},canvas:_t}=t;let ct,Rt;_t?(delete t.canvas,{id:ct,bitmap:Rt}=i.imageManager.getFromCanvas(ut.id,_t),_t.remove()):(l=!0,t._hasNoCanvas=!0);const Lt=(await e._structTree.getAriaAttributes(`${el}${M}`))?.get("aria-label")||"";a=t={annotationType:re.STAMP,bitmapId:ct,bitmap:Rt,pageIndex:ft-1,rect:S.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,accessibilityData:{decorative:!1,altText:Lt},isSvg:!1,structParent:N,popupRef:k,richText:j,comment:F?.str||null,creationDate:z,modificationDate:H}}const c=await super.deserialize(t,e,i),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:w}=t;l?(i.addMissingCanvas(t.id,c),c.#o=!0):p&&i.imageManager.isValidId(p)?(c.#e=p,d&&(c.#t=d)):c.#n=f,c.#l=y;const[A,_]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/_,w&&(c.altTextData=w),c._initialData=a,t.comment&&c.setCommentData(t),c.#d=!!a,c}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(i);return u.isSame?null:(u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const c=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:c,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return i}#v(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,a=t.pageIndex===e,l=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class ra{#t;#e=!1;#i=null;#n=null;#s=null;#r=new Map;#a=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([Rn,$m,x2,ln,Es].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:a,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:d,viewport:f,l10n:p}){const y=[...ra.#p.values()];if(!ra._initialized){ra._initialized=!0;for(const w of y)w.initialize(p,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=e,this.div=i,this.#t=l,this.#i=c,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===re.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#w(),t){case re.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case re.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case re.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===re.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of ra.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#y(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const i of this.#y)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#u.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#i;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#u.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const a=await this.deserialize(i);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const a=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:d,timeStamp:f}=l,p=this.#m;if(f-p>500){this.#m=f;return}this.#m=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const w=document.elementsFromPoint(u,d);if(y.toggle("getElements",!1),!this.div.contains(w[0]))return;let A;const _=new RegExp(`^${jc}[0-9]+$`);for(const C of w)if(_.test(C.id)){A=C.id;break}if(!A)return;const S=this.#r.get(A);S?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),S.dblclick(l))},{signal:a,capture:!0})}const t=this.#i,e=[];if(t){const a=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=l.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const a of ra.#p.values())i.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:i}=wn.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ln.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),Wt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#r.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#b(){return ra.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const e=this.#b;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:i,offsetY:a}=this.#S(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:i,y:a,uiManager:this.#u,isCentered:!0,...e});c&&this.add(c)}async deserialize(t){return await ra.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,i={}){const a=this.getNextId(),l=this.#E({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...i});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#S(){const{x:t,y:e,width:i,height:a}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,e),u=Math.min(window.innerWidth,t+i),d=Math.min(window.innerHeight,e+a),f=(l+u)/2-t,p=(c+d)/2-e,[y,w]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:w}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=wn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#u.getMode();if(i===re.STAMP||i===re.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===re.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=wn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const i=this.#u.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,e,i){const a=this.#u.findParent(e,i);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#w(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Wr(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#w();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Wr(this.div,{rotation:i}),e!==i)for(const a of this.#r.values())a.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class Bn{#t=null;#e=new Map;#i=new Map;static#n=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return ie(this,"_svgFactory",new Yh)}static#s(t,[e,i,a,l]){const{style:c}=t;c.top=`${100*i}%`,c.left=`${100*e}%`,c.width=`${100*a}%`,c.height=`${100*l}%`}#r(){const t=Bn._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const i=Bn._svgFactory.createElement("clipPath");t.append(i);const a=`clip_${e}`;i.setAttribute("id",a),i.setAttribute("clipPathUnits","objectBoundingBox");const l=Bn._svgFactory.createElement("use");return i.append(l),l.setAttribute("href",`#${e}`),l.classList.add("clip"),a}#o(t,e){for(const[i,a]of Object.entries(e))a===null?t.removeAttribute(i):t.setAttribute(i,a)}draw(t,e=!1,i=!1){const a=Bn.#n++,l=this.#r(),c=Bn._svgFactory.createElement("defs");l.append(c);const u=Bn._svgFactory.createElement("path");c.append(u);const d=`path_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(a,u);const f=i?this.#a(c,d):null,p=Bn._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(l,t),this.#e.set(a,l),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=Bn.#n++,a=this.#r(),l=Bn._svgFactory.createElement("defs");a.append(l);const c=Bn._svgFactory.createElement("path");l.append(c);const u=`path_${i}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const y=Bn._svgFactory.createElement("mask");l.append(y),d=`mask_${i}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const w=Bn._svgFactory.createElement("rect");y.append(w),w.setAttribute("width","1"),w.setAttribute("height","1"),w.setAttribute("fill","white");const A=Bn._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=Bn._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const p=f.cloneNode();return a.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(i,a),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:a,rootClass:l,path:c}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#o(u,i),a&&Bn.#s(u,a),l){const{classList:d}=u;for(const[f,p]of Object.entries(l))d.toggle(f,p)}if(c){const f=u.firstElementChild.firstElementChild;this.#o(f,c)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:cm};globalThis.pdfjsLib={AbortException:er,AnnotationEditorLayer:ra,AnnotationEditorParamsType:ve,AnnotationEditorType:re,AnnotationEditorUIManager:nr,AnnotationLayer:Vm,AnnotationMode:Wa,AnnotationType:gn,applyOpacity:GC,build:WT,ColorPicker:tx,createValidAbsoluteUrl:Cw,CSSConstants:qC,DOMSVGFactory:Yh,DrawLayer:Bn,FeatureTest:wn,fetchData:Yc,findContrastColor:VC,getDocument:Qw,getFilenameFromUrl:jC,getPdfFilenameFromUrl:FC,getRGB:Wc,getUuid:Rw,getXfaPageViewport:UC,GlobalWorkerOptions:ll,ImageKind:jh,InvalidPDFException:tm,isDataScheme:ud,isPdfFile:Pm,isValidExplicitDest:nT,MathClamp:jn,noContextMenu:qi,normalizeUnicode:PC,OPS:Fc,OutputScale:Rs,PagesMapper:Ce,PasswordResponses:_C,PDFDataRangeTransport:Ww,PDFDateString:em,PDFWorker:Uc,PermissionFlag:EC,PixelsPerInch:hl,RenderingCancelledException:Lm,renderRichText:Dw,ResponseException:Kh,setLayerDimensions:Wr,shadow:ie,SignatureExtractor:Jo,stopEvent:en,SupportedImageMimeTypes:nm,TextLayer:Si,TouchManager:hd,updateUrlHash:Tw,Util:qt,VerbosityLevel:rd,version:QT,XfaLayer:Mw};ll.workerSrc=new URL("/static/frontend/assets/pdf.worker-BA9kU3Pw.mjs",import.meta.url).toString();const A2=()=>typeof window<"u"&&window.devicePixelRatio||1;function S2(r,t){const e=Math.sqrt(t[2]*t[2]+t[3]*t[3]),i=Math.sqrt(t[0]*t[0]+t[1]*t[1]),a=e,l=a,c=typeof r.width=="number"&&r.width>0?r.width*i:(r.str?.length||1)*l*.5,u=t[4],d=t[5]-a*.85;return{x:u,y:d,w:c,h:l}}function E2(r,t,e){const a=(typeof document<"u"?document.createElement("canvas"):null)?.getContext("2d"),l=[];let c=0,u=-999;const d=4;let f=0;return r.items.forEach(p=>{if(!p.str||p.str.trim()==="")return;const y=qt.transform(t.transform,p.transform),w=S2(p,y);Math.abs(w.y-u)>d&&(c+=1,u=w.y);const A=w.h,_=typeof p.width=="number"&&p.width>0?p.width*e:w.w,S=p.str.split(/(\s+)/);if(!a||S.length===0){l.push({id:f++,text:p.str,x:w.x,y:w.y,w:w.w,h:w.h,fontSize:w.h,lineIndex:c});return}a.font=`${A}px sans-serif`;const C=S.map(j=>({text:j,measured:a.measureText(j).width,isSpace:/^\s+$/.test(j)||j===""})),M=C.reduce((j,F)=>j+F.measured,0),N=M>0?_/M:1;let k=0;C.forEach(j=>{const F=j.measured*N;if(j.text===""||j.isSpace){k+=F;return}l.push({id:f,text:j.text,x:w.x+k,y:w.y,w:F,h:A,fontSize:A,lineIndex:c}),f+=1,k+=F})}),l}function lx(r){const t={};return r.forEach(e=>{const i=e.lineIndex??Math.round(e.y/4)*4;t[i]||(t[i]=[]),t[i].push(e)}),Object.values(t)}function Av(r,t,e){let l=null,c=1/0;for(const u of r){if(!(e>=u.y-6&&e<=u.y+u.h+6))continue;if(t>=u.x-4&&t<=u.x+u.w+4)return u;const p=t<u.x?u.x-t:t-(u.x+u.w);p<c&&p<40&&(c=p,l=u)}return l}function _2(r){if(!r.length)return"";let t="";for(let e=0;e<r.length;e++){const i=r[e];if(e>0){const a=r[e-1];Math.abs(i.y-a.y)<6?i.x-(a.x+a.w)>1&&(t+=" "):t+=" "}t+=i.text}return t.trim()}function C2(r,t){return r.length?lx(r).map(i=>{const a=Math.min(...i.map(y=>y.x)),l=Math.max(...i.map(y=>y.x+y.w)),c=i.map(y=>y.y),u=c.sort((y,w)=>y-w)[Math.floor(c.length/2)],d=Math.max(...i.map(y=>y.h)),f=2;return{x:(a-1)/t,y:(u-f)/t,width:(l-a+2)/t,height:(d+f+3)/t}}):[]}function T2({pdfData:r,scale:t,highlights:e=[],hoveredHighlightId:i=null,activeHighlightId:a=null,selectionForPicker:l=null,onSelectionComplete:c,onNumPages:u,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y}){const[w,A]=I.useState(null),[_,S]=I.useState(0),[C,M]=I.useState(!0);return I.useEffect(()=>{if(!r)return;let N=!1;return(async()=>{M(!0);try{const j=r.slice(0),F=await Qw({data:j}).promise;N||(A(F),S(F.numPages),u?.(F.numPages))}catch(j){console.error("Failed to load PDF",j)}N||M(!1)})(),()=>{N=!0}},[r,u]),C?D.jsx("div",{className:"flex items-center justify-center h-full",children:D.jsx(Ts,{className:"w-6 h-6 text-slate-400 animate-spin"})}):w?D.jsx("div",{className:"flex flex-col items-center py-6 gap-4",children:Array.from({length:_},(N,k)=>D.jsx(R2,{pdf:w,pageNumber:k+1,scale:t,pageHighlights:e.filter(j=>j.page_number===k+1),hoveredHighlightId:i,activeHighlightId:a,selectionForPicker:l,onSelectionComplete:c,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y},k))}):null}function R2({pdf:r,pageNumber:t,scale:e,pageHighlights:i,hoveredHighlightId:a,activeHighlightId:l,selectionForPicker:c,onSelectionComplete:u,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y}){const w=I.useRef(null),A=I.useRef(null),_=I.useRef(null),S=I.useRef(null),[C,M]=I.useState({width:0,height:0}),[N,k]=I.useState([]),[j,F]=I.useState(null),[z,H]=I.useState(null),[ut,ft]=I.useState(!1),_t=I.useRef(null),ct=I.useRef(null),Rt=I.useCallback(()=>{ct.current&&clearTimeout(ct.current),ct.current=setTimeout(()=>{f?.(),ct.current=null},1e3)},[f]),Lt=I.useCallback(Ct=>{ct.current&&(clearTimeout(ct.current),ct.current=null),d?.(Ct)},[d]);I.useEffect(()=>()=>{ct.current&&clearTimeout(ct.current)},[]),I.useEffect(()=>{let Ct=!1;return(async()=>{const J=await r.getPage(t),mt=A2(),xt=J.getViewport({scale:e}),It=J.getViewport({scale:e*mt}),Ut=A.current;if(!Ut||Ct)return;const Ot=Ut.getContext("2d",{alpha:!1});Ot.imageSmoothingEnabled=!0,Ot.imageSmoothingQuality="high",Ut.width=It.width,Ut.height=It.height,Ut.style.width=`${xt.width}px`,Ut.style.height=`${xt.height}px`,M({width:xt.width,height:xt.height}),await J.render({canvasContext:Ot,viewport:It}).promise;const Tt=await J.getTextContent();if(Ct)return;const jt=E2(Tt,xt,e);k(jt);const kt=_.current;!kt||Ct||(kt.innerHTML="",kt.style.width=`${xt.width}px`,kt.style.height=`${xt.height}px`,jt.forEach(we=>{const pt=document.createElement("span");pt.textContent=we.text,pt.style.position="absolute",pt.style.left=`${we.x}px`,pt.style.top=`${we.y}px`,pt.style.width=`${we.w}px`,pt.style.height=`${we.h}px`,pt.style.fontSize=`${we.fontSize}px`,pt.style.fontFamily="sans-serif",pt.style.color="transparent",pt.style.whiteSpace="pre",pt.style.pointerEvents="none",pt.style.lineHeight="1",kt.appendChild(pt)}))})(),()=>{Ct=!0}},[r,t,e]);const Bt=I.useMemo(()=>{if(c&&c.pageNumber===t){const J=Math.min(c.spanStart,c.spanEnd),mt=Math.max(c.spanStart,c.spanEnd);return N.filter(xt=>xt.id>=J&&xt.id<=mt)}if(j==null||z==null)return[];const Ct=Math.min(j,z),U=Math.max(j,z);return N.filter(J=>J.id>=Ct&&J.id<=U)},[N,c,t,j,z]);I.useEffect(()=>{c===null&&_t.current?.pageNumber===t&&(F(null),H(null)),_t.current=c},[c,t]);const $t=I.useCallback((Ct,U)=>{const J=w.current?.getBoundingClientRect();return J?{x:Ct-J.left,y:U-J.top}:{x:0,y:0}},[]),G=I.useCallback(Ct=>{if(Ct.button!==0||!N.length)return;const{x:U,y:J}=$t(Ct.clientX,Ct.clientY),mt=Av(N,U,J);mt?(F(mt.id),H(mt.id),ft(!0)):(F(null),H(null))},[N,$t]),st=I.useCallback(Ct=>{if(!ut)return;const{x:U,y:J}=$t(Ct.clientX,Ct.clientY),mt=Av(N,U,J);mt&&H(mt.id)},[ut,N,$t]),wt=I.useCallback(Ct=>{if(Ct.button!==0||!ut)return;if(ft(!1),Bt.length<2){F(null),H(null);return}if(!u)return;const U=w.current?.getBoundingClientRect();if(!U)return;const J={rects:C2(Bt,e)},mt=_2(Bt),xt=Bt[Bt.length-1],It={x:U.left+(xt.x+xt.w/2),y:U.top+(xt.y-8)};u({pageNumber:t,position_data:J,highlighted_text:mt,spanStart:Math.min(j,z),spanEnd:Math.max(j,z),pickerPosition:It})},[ut,Bt,j,z,e,t,u]);I.useEffect(()=>{const Ct=S.current||w.current;if(Ct)return Ct.addEventListener("mousedown",G),Ct.addEventListener("mousemove",st),Ct.addEventListener("mouseup",wt),Ct.addEventListener("mouseleave",wt),()=>{Ct.removeEventListener("mousedown",G),Ct.removeEventListener("mousemove",st),Ct.removeEventListener("mouseup",wt),Ct.removeEventListener("mouseleave",wt)}},[G,st,wt]);const Xt=I.useMemo(()=>lx(Bt),[Bt]);return D.jsxs("div",{ref:w,"data-page":t,className:"relative shadow-lg bg-white overflow-hidden select-none",style:{width:C.width||0,height:C.height||0,cursor:"text"},title:"Drag to highlight text",children:[D.jsx("canvas",{ref:A,className:"block w-full h-full",style:{display:"block"}}),D.jsxs("div",{ref:S,className:"absolute inset-0",style:{pointerEvents:"auto"},children:[i.map(Ct=>{const U=Ct.position_data?.rects||[],J=ui[Ct.color]||ui.yellow,mt=a!=null&&String(Ct.id)===String(a),xt=l!=null&&String(Ct.id)===String(l),It=mt||xt?J.rgbaHover??J.rgba:J.rgbaSoft??J.rgba,Ut=p||y;let Ot=null;if(U.length>0){const Tt=Math.min(...U.map(pt=>pt.x))*e,jt=Math.min(...U.map(pt=>pt.y))*e,kt=Math.max(...U.map(pt=>(pt.x||0)+(pt.width||0)))*e,we=Math.max(...U.map(pt=>(pt.y||0)+(pt.height||4)))*e;Ot={left:Tt,top:jt,width:kt-Tt,height:we-jt}}return Ot?D.jsxs("div",{className:"absolute rounded-sm transition-colors duration-150 group",style:{left:Ot.left,top:Ot.top,width:Ot.width,height:Ot.height,pointerEvents:"auto"},onMouseEnter:()=>Lt(Ct.id),onMouseLeave:Rt,children:[U.map((Tt,jt)=>D.jsx("div",{className:"absolute rounded-sm transition-colors duration-150",style:{left:(Tt.x||0)*e-Ot.left,top:(Tt.y||0)*e-Ot.top,width:Math.max(0,(Tt.width||0)*e),height:Math.max(4,(Tt.height||0)*e),backgroundColor:It,pointerEvents:"none"}},jt)),Ut&&mt&&Ot&&D.jsxs("div",{className:"absolute flex items-center gap-0.5 rounded-md border border-slate-200 bg-white shadow-sm z-10",style:{left:0,bottom:"100%",marginBottom:4},onMouseEnter:()=>Lt(Ct.id),onMouseLeave:Rt,children:[p&&D.jsx("button",{type:"button",onClick:Tt=>{Tt.stopPropagation(),p(Ct.id,Tt)},className:"p-1.5 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-l-md transition-colors",title:"Edit note","aria-label":"Edit note",children:D.jsx(Xp,{className:"w-3.5 h-3.5",strokeWidth:2})}),y&&D.jsx("button",{type:"button",onClick:Tt=>{Tt.stopPropagation(),y(Ct.id)},className:"p-1.5 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded-r-md transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:D.jsx(Om,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]},Ct.id):null}),Xt.map((Ct,U)=>{const J=Math.min(...Ct.map(jt=>jt.x)),mt=Math.max(...Ct.map(jt=>jt.x+jt.w)),xt=Ct.map(jt=>jt.y).sort((jt,kt)=>jt-kt),It=xt[Math.floor(xt.length/2)],Ut=Math.max(...Ct.map(jt=>jt.h)),Ot=2;return D.jsx("div",{className:"absolute rounded-sm pointer-events-none",style:{left:`${J-1}px`,top:`${It-Ot}px`,width:`${mt-J+2}px`,height:`${Ut+Ot+3}px`,backgroundColor:"rgba(59, 130, 246, 0.2)"}},U)})]}),D.jsx("div",{ref:_,className:"absolute inset-0 overflow-hidden pointer-events-none","aria-hidden":!0})]})}function M2({highlights:r,colorLabels:t,documentColorKeys:e,activeHighlightId:i,onScrollToPage:a,onHighlightClick:l,onHighlightHover:c,onHighlightHoverEnd:u,onClearActive:d,documentId:f,onHighlightNoteUpdate:p,onHighlightDelete:y,openEditForHighlightId:w,onClearOpenEditForHighlightId:A}){const _=e?.length>0?e:la,[S,C]=I.useState("all"),[M,N]=I.useState(""),[k,j]=I.useState(null),[F,z]=I.useState("");I.useEffect(()=>{if(w==null||!r?.length)return;const ct=r.find(Rt=>String(Rt.id)===String(w));ct&&(j(ct.id),z(ct.note?.content??"")),A?.()},[w,r,A]);const H=I.useMemo(()=>{let ct=r||[];if(S!=="all"&&(ct=ct.filter(Rt=>Rt.color===S)),M.trim()){const Rt=M.trim().toLowerCase();ct=ct.filter(Lt=>Lt.highlighted_text&&Lt.highlighted_text.toLowerCase().includes(Rt)||Lt.note?.content&&Lt.note.content.toLowerCase().includes(Rt))}return ct},[r,S,M]),ut=ct=>{j(ct.id),z(ct.note?.content??"")},ft=async()=>{if(k==null||!f||!p){j(null);return}await p(k,F.trim()||""),j(null)},_t=()=>{j(null),z("")};return D.jsxs("div",{className:`w-80 shrink-0 flex flex-col border-l ${Zi.default} ${_i.surface}`,children:[D.jsxs("div",{className:`px-4 pt-5 pb-0 border-b ${Zi.default}`,children:[D.jsx("h2",{className:`text-[15px] font-semibold ${Zt.heading} mb-1`,children:"Annotations"}),D.jsxs("p",{className:`text-xs ${Zt.muted} mb-4`,children:[H.length," highlight",H.length!==1?"s":"",r?.length!==H.length&&` of ${r?.length||0}`]}),D.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[D.jsx("button",{type:"button",onClick:()=>{C("all"),d?.()},className:`text-[11px] font-semibold px-3 py-1 rounded-full border cursor-pointer transition-colors ${S==="all"?"bg-slate-900 text-white border-slate-900":`border-slate-200 ${Zt.secondary} hover:bg-slate-50`}`,children:"All"}),_.map(ct=>{const Rt=(r||[]).filter(Bt=>Bt.color===ct).length,Lt=ui[ct];return Lt?D.jsx("button",{type:"button",onClick:()=>{C(S===ct?"all":ct),d?.()},className:`w-7 h-7 rounded-full border-2 flex items-center justify-center text-[10px] font-bold cursor-pointer transition-all ${S===ct?"border-slate-800 scale-105":"border-transparent"}`,style:{backgroundColor:S===ct?Lt.hex??Lt.solid:`${Lt.hex??Lt.solid}25`,color:S===ct?"white":Lt.hex??Lt.solid},title:_s(ct,t),children:Rt},ct):null})]}),D.jsxs("div",{className:"relative mb-4",children:[D.jsx(sC,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400",strokeWidth:2}),D.jsx("input",{type:"text",placeholder:"Search highlights...",value:M,onChange:ct=>N(ct.target.value),className:`w-full pl-8 pr-3 py-1.5 text-xs border ${Zi.default} rounded-lg bg-slate-50 outline-none ${Zt.body} placeholder:${Zt.muted}`})]})]}),D.jsx("div",{className:"flex-1 overflow-auto px-3 pb-5",children:r?.length?H.length?D.jsx("ul",{className:"space-y-1.5",children:H.map(ct=>{const Rt=ui[ct.color]||ui.yellow,Lt=ct.note?.content,Bt=i!=null&&String(ct.id)===String(i);return D.jsx("li",{children:D.jsxs("div",{role:"button",tabIndex:0,className:`w-full text-left rounded-[10px] p-3 transition-all cursor-pointer border ${Bt?"border-slate-300":"border-transparent hover:border-slate-200"} hover:bg-slate-50`,onClick:()=>{l?.(ct.id),a?.(ct.page_number)},onKeyDown:$t=>{$t.target.tagName==="TEXTAREA"||$t.target.tagName==="INPUT"||$t.target.isContentEditable||($t.key==="Enter"||$t.key===" ")&&($t.preventDefault(),l?.(ct.id),a?.(ct.page_number))},onMouseEnter:()=>c?.(ct.id),onMouseLeave:u,children:[D.jsxs("div",{className:"flex gap-2.5",children:[D.jsx("div",{className:"w-0.5 min-h-9 shrink-0 rounded-full transition-opacity",style:{backgroundColor:Rt.hex??Rt.solid,opacity:Bt?1:.6}}),D.jsx("div",{className:"flex-1 min-w-0",children:D.jsx("p",{className:`text-xs leading-snug ${Zt.body} line-clamp-3`,children:ct.highlighted_text||"(No text captured)"})})]}),k===ct.id?D.jsxs("div",{className:"mt-2 pl-3.5 space-y-1.5",children:[D.jsx("textarea",{value:F,onChange:$t=>z($t.target.value),placeholder:"Add a comment...",rows:2,className:`w-full text-[11.5px] border ${Zi.default} rounded-lg px-2 py-1.5 resize-none outline-none focus:ring-1 focus:ring-slate-300 ${Zt.body}`}),D.jsxs("div",{className:"flex gap-1.5",children:[D.jsx("button",{type:"button",onClick:ft,className:"text-[11px] font-medium px-2 py-1 rounded bg-slate-800 text-white hover:bg-slate-700",children:"Save"}),D.jsx("button",{type:"button",onClick:_t,className:"text-[11px] font-medium px-2 py-1 rounded text-slate-600 hover:bg-slate-100",children:"Cancel"})]})]}):D.jsxs(D.Fragment,{children:[Lt&&D.jsx("p",{className:`text-[11.5px] ${Zt.muted} mt-2 pl-3.5 leading-snug italic`,children:Lt}),f&&p&&D.jsx("button",{type:"button",onClick:()=>ut(ct),className:"mt-1.5 pl-3.5 text-[11px] text-slate-500 hover:text-slate-700",children:Lt?"Edit comment":"Add comment"})]}),D.jsxs("div",{className:"mt-2 pl-3.5 flex items-center gap-2 flex-wrap",children:[D.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:Rt.hex??Rt.solid,backgroundColor:`${Rt.hex??Rt.solid}12`},children:_s(ct.color,t)}),D.jsxs("span",{className:"text-[10px] text-slate-400",children:["p.",ct.page_number]}),f&&y&&D.jsx("button",{type:"button",onClick:$t=>{$t.stopPropagation(),y(ct.id)},className:"ml-auto p-1 rounded text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:D.jsx(Om,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]})},ct.id)})}):D.jsx("div",{className:`py-6 text-center ${Zt.muted} text-sm`,children:"No matching highlights."}):D.jsxs("div",{className:`py-8 text-center ${Zt.muted} text-sm`,children:[D.jsx(Sw,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),D.jsx("p",{children:"No highlights yet."}),D.jsx("p",{className:"mt-1 text-xs",children:"Select text on the document to create your first highlight."})]})})]})}const Lp=[{colorKey:"yellow",color:"#FBBF24",shortcut:"1"},{colorKey:"green",color:"#34D399",shortcut:"2"},{colorKey:"blue",color:"#60A5FA",shortcut:"3"},{colorKey:"pink",color:"#F472B6",shortcut:"4"},{colorKey:"orange",color:"#FB923C",shortcut:"5"}];function D2({position:r,onSelect:t,onClose:e,colorLabels:i,documentColorKeys:a}){const l=I.useRef(null),c=I.useRef(null),[u,d]=I.useState(null),[f,p]=I.useState(""),[y,w]=I.useState(!1),[A,_]=I.useState(!1),S=a?.length>0?a.map(F=>Lp.find(z=>z.colorKey===F)).filter(Boolean):Lp,C=S.length>0?S:Lp,M=I.useCallback(F=>_s(F,i),[i]);I.useEffect(()=>{y&&c.current&&c.current.focus()},[y]);const N=I.useCallback(F=>{d(F.colorKey),y||(t(F.colorKey,""),_(!0),setTimeout(()=>e(),400))},[y,t,e]),k=I.useCallback(()=>{u&&(t(u,f.trim()||void 0),_(!0),setTimeout(()=>e(),400))},[u,f,t,e]);if(I.useEffect(()=>{const F=z=>{if(z.key==="Escape"){e();return}if(!y){const H=parseInt(z.key,10);if(H>=1&&H<=C.length){const ut=C[H-1];ut&&N(ut)}}y&&z.key==="Enter"&&(z.metaKey||z.ctrlKey)&&(z.preventDefault(),k())};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[y,u,f,e,N,k,C]),I.useEffect(()=>{const F=z=>{l.current&&!l.current.contains(z.target)&&e()};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[e]),I.useEffect(()=>{p(""),d(null),w(!1),_(!1)},[r]),!r)return null;const j=u?C.find(F=>F.colorKey===u):null;return D.jsx("div",{ref:l,className:"fixed z-[1000]",style:{left:r.x,top:r.y-48,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:A?D.jsxs("div",{className:"flex items-center gap-2 rounded-[10px] px-3.5 py-2 bg-white border border-slate-200 shadow-md",children:[D.jsx("div",{className:"flex h-[18px] w-[18px] items-center justify-center rounded-full",style:{background:j?.color??"#64748b"},children:D.jsx("svg",{width:"10",height:"10",viewBox:"0 0 12 12",fill:"none",children:D.jsx("path",{d:"M2 6L5 9L10 3",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),D.jsx("span",{className:"text-[13px] font-medium text-slate-800",children:"Saved"})]}):D.jsxs("div",{className:"overflow-hidden rounded-xl bg-white border border-slate-200 shadow-lg",style:{width:y?280:"auto",transition:"width 0.2s cubic-bezier(0.16, 1, 0.3, 1)"},children:[D.jsxs("div",{className:"flex items-center gap-0.5 p-1.5",children:[C.map((F,z)=>D.jsx("button",{type:"button",onClick:()=>N(F),title:`${M(F.colorKey)}${C.length<=5?` (${z+1})`:""}`,className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 hover:bg-slate-100",style:{background:u===F.colorKey?`${F.color}25`:"transparent"},children:D.jsx("div",{className:"h-4 w-4 rounded-full transition-[box-shadow,transform] duration-150",style:{background:F.color,boxShadow:u===F.colorKey?`0 0 0 2px ${F.color}80`:"none",transform:u===F.colorKey?"scale(1.15)":"scale(1)"}})},F.colorKey)),D.jsx("div",{className:"mx-0.5 h-4 w-px bg-slate-200"}),D.jsx("button",{type:"button",onClick:()=>w(!y),title:"Add note",className:`flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 ${y?"bg-slate-100":"hover:bg-slate-100"}`,children:D.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",children:[D.jsx("path",{d:"M13 2.5H3C2.72386 2.5 2.5 2.72386 2.5 3V13C2.5 13.2761 2.72386 13.5 3 13.5H10L13.5 10V3C13.5 2.72386 13.2761 2.5 13 2.5Z",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),D.jsx("path",{d:"M5.5 6H10.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),D.jsx("path",{d:"M5.5 8.5H8.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),D.jsx("path",{d:"M10 13.5V10H13.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),D.jsx("button",{type:"button",onClick:e,className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 bg-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-700 transition-colors duration-150",children:D.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:D.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]}),y&&D.jsxs("div",{className:"px-2 pb-2 border-t border-slate-100 pt-2",style:{animation:"expandIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[!j&&D.jsx("div",{className:"px-1.5 pb-2 pt-1 text-[11px] text-slate-500",children:"Pick a category above, then add your note"}),j&&D.jsxs("div",{className:"flex items-center gap-1.5 px-1.5 pb-2 pt-0.5",children:[D.jsx("div",{className:"h-2 w-2 rounded-full shrink-0",style:{background:j.color}}),D.jsx("span",{className:"text-[11px] font-medium text-slate-600",children:M(j.colorKey)})]}),D.jsx("textarea",{ref:c,value:f,onChange:F=>p(F.target.value),placeholder:"Add a note...",rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200"}),D.jsx("div",{className:"mt-1.5 flex items-center justify-end",children:D.jsx("button",{type:"button",onClick:k,disabled:!j,className:"rounded-lg border-0 px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-default transition-colors",children:"Save"})})]})]})})}const Rh="color_label_";function O2({colorLabels:r={},documentId:t,onSave:e,onClose:i}){const a=gl(),l=I.useRef(null),[c,u]=I.useState(()=>Object.keys(r||{}).length>0?Object.keys(r):[...la]);I.useEffect(()=>{const C=Object.keys(r||{});u(C.length>0?C:[...la])},[t,r]);const d=Nc({mutationFn:C=>$n.update(t,C),onSuccess:()=>{a.invalidateQueries({queryKey:["document",t]}),e?.()},onError:C=>{console.error("Failed to save color labels",C?.response?.data??C)}}),f=C=>{u(M=>M.filter(N=>N!==C))},p=C=>{c.includes(C)||u(M=>[...M,C].sort((N,k)=>la.indexOf(N)-la.indexOf(k)))},y=la.filter(C=>!c.includes(C)),w=c.length<5&&y.length>0,A=C=>{if(C.preventDefault(),!t)return;const M=l.current;if(!M)return;const N={};c.forEach(k=>{const j=M.elements.namedItem(Rh+k),F=j&&"value"in j?String(j.value).trim():"";N[k]=F}),d.mutate({color_labels:N})},_=C=>{C.target===C.currentTarget&&i()},S=D.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40",onClick:_,children:D.jsxs("div",{role:"dialog","aria-modal":"true",className:`relative z-10 ${_i.surface} rounded-xl shadow-xl border ${Zi.default} w-full max-w-md mx-4 overflow-hidden max-h-[90vh] flex flex-col`,onClick:C=>C.stopPropagation(),onMouseDown:C=>C.stopPropagation(),children:[D.jsx("div",{className:"px-5 pt-5 pb-2 border-b border-slate-200 shrink-0",children:D.jsx("h3",{className:`text-base font-semibold ${Zt.heading}`,children:"Colours in this document"})}),D.jsxs("form",{ref:l,onSubmit:A,className:"p-5 space-y-4 overflow-auto flex-1 min-h-0",children:[c.map(C=>{const M=ui[C],N=M?.name||C,k=(r&&r[C])??"";return D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("div",{className:"h-8 w-8 rounded-full shrink-0 border-2 border-slate-200",style:{backgroundColor:M?.hex??M?.solid}}),D.jsxs("div",{className:"flex-1 min-w-0",children:[D.jsxs("label",{className:`text-xs ${Zt.muted} block mb-0.5`,htmlFor:Rh+C,children:[M?.label??C," (default: ",N,")"]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("input",{id:Rh+C,name:Rh+C,type:"text",defaultValue:k,placeholder:N,className:`w-full rounded-lg border ${Zi.default} px-3 py-2 text-sm ${Zt.body} placeholder:${Zt.muted} outline-none focus:ring-2 focus:ring-slate-300`}),D.jsx("button",{type:"button",onMouseDown:j=>{j.preventDefault(),j.stopPropagation(),f(C)},onClick:j=>{j.preventDefault(),j.stopPropagation(),f(C)},className:"shrink-0 p-2 rounded-lg text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors select-none",title:"Remove this colour from the document","aria-label":"Remove colour",children:D.jsx(Qp,{className:"w-4 h-4 pointer-events-none",strokeWidth:2})})]})]})]},C)}),w&&D.jsxs("div",{className:"pt-2 border-t border-slate-200",children:[D.jsx("p",{className:`text-xs ${Zt.muted} mb-2`,children:"Add a colour"}),D.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(C=>{const M=ui[C];return D.jsxs("button",{type:"button",onClick:()=>p(C),className:"flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 transition-colors",children:[D.jsx("span",{className:"h-5 w-5 rounded-full border border-slate-200 shrink-0",style:{backgroundColor:M?.hex??M?.solid}}),D.jsx("span",{children:M?.label??C}),D.jsx(nC,{className:"w-4 h-4 text-slate-400",strokeWidth:2})]},C)})})]}),c.length===0&&D.jsx("p",{className:`text-sm ${Zt.muted}`,children:"No colours in this document. Add one above to use for highlights."}),d.isError&&D.jsx("p",{className:"text-sm text-red-600",children:d.error?.response?.data?.detail??d.error?.message??"Failed to save. Try again."}),D.jsxs("div",{className:"flex justify-end gap-2 pt-2 shrink-0",children:[D.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancel"}),D.jsx("button",{type:"submit",className:da,disabled:d.isPending,children:d.isPending?"Saving":"Save"})]})]})]})});return typeof document>"u"||!document.body?S:dS.createPortal(S,document.body)}function N2({position:r,initialValue:t="",onSave:e,onClose:i}){const[a,l]=I.useState(t),c=I.useRef(null),u=I.useRef(null);return I.useEffect(()=>{l(t)},[t,r]),I.useEffect(()=>{u.current?.focus()},[r]),I.useEffect(()=>{const d=f=>{f.key==="Escape"&&i(),f.key==="Enter"&&(f.metaKey||f.ctrlKey)&&(f.preventDefault(),e(a.trim()))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[a,e,i]),I.useEffect(()=>{const d=f=>{c.current&&!c.current.contains(f.target)&&i()};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[i]),r?D.jsxs("div",{ref:c,className:"fixed z-[1001] w-64 rounded-xl border border-slate-200 bg-white p-3 shadow-lg",style:{left:r.x,top:r.y+6,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[D.jsx("textarea",{ref:u,value:a,onChange:d=>l(d.target.value),placeholder:"Add a note...",rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200 mb-2"}),D.jsxs("div",{className:"flex items-center justify-end gap-2",children:[D.jsx("button",{type:"button",onClick:i,className:"rounded-lg px-2.5 py-1.5 text-xs font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Cancel"}),D.jsx("button",{type:"button",onClick:()=>e(a.trim()),className:"rounded-lg px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 transition-colors",children:"Save"})]})]}):null}function k2(){const{id:r}=gm(),t=fa(),e=gl(),[i,a]=I.useState(null),[l,c]=I.useState(!1),[u,d]=I.useState(!0),[f,p]=I.useState(1.3),[y,w]=I.useState(!0),[A,_]=I.useState(null),[S,C]=I.useState(null),[M,N]=I.useState(null),[k,j]=I.useState(null),[F,z]=I.useState(null),[H,ut]=I.useState(0),[ft,_t]=I.useState(1),[ct,Rt]=I.useState(!1),[Lt,Bt]=I.useState(null),[$t,G]=I.useState(null),{data:st,isLoading:wt,isError:Xt}=tr({queryKey:["document",r],queryFn:async()=>{const{data:pt}=await $n.get(r);return pt},enabled:!!r}),Ct=I.useMemo(()=>{const pt=Object.keys(st?.color_labels||{});return pt.length>0?pt:[...la]},[st?.color_labels]);I.useEffect(()=>{if(!st||!r)return;let pt=!1;return(async()=>{d(!0);try{const ge=await AC(st);pt||(ge?a(ge.data):c(!0))}finally{pt||d(!1)}})(),()=>{pt=!0}},[st,r]);const{data:U=[]}=tr({queryKey:["highlights",r],queryFn:async()=>{const{data:pt}=await $n.highlights(r);return pt},enabled:!!r}),J=I.useCallback(async pt=>{if(r)try{await $n.createHighlight(r,pt),e.invalidateQueries({queryKey:["highlights",r]}),N(null),j(null),z(null)}catch(he){console.error("Failed to save highlight",he)}},[r,e]),mt=I.useCallback(pt=>{N({page_number:pt.pageNumber,position_data:pt.position_data,highlighted_text:pt.highlighted_text}),j(pt.pickerPosition),z({pageNumber:pt.pageNumber,spanStart:pt.spanStart,spanEnd:pt.spanEnd})},[]),xt=I.useCallback((pt,he)=>{M&&J({...M,color:pt,comment:he})},[M,J]),It=I.useCallback(()=>{N(null),j(null),z(null)},[]),Ut=I.useCallback(pt=>{_t(pt),window.document.getElementById("pdf-scroll-container")?.querySelector(`[data-page="${pt}"]`)?.scrollIntoView({behavior:"smooth",block:"start"})},[]),Ot=I.useCallback(pt=>{C(he=>he!=null&&String(he)===String(pt)?null:pt)},[]),Tt=I.useCallback(pt=>ut(pt??0),[]),jt=I.useCallback(()=>{if(ft<=1)return;const pt=ft-1;_t(pt),Ut(pt)},[ft,Ut]),kt=I.useCallback(()=>{if(ft>=H)return;const pt=ft+1;_t(pt),Ut(pt)},[ft,H,Ut]),we=async pt=>{const he=pt.target.files?.[0];if(!he||!st||!r)return;const ge=await he.arrayBuffer(),An=await _w(ge);if(An!==st.pdf_hash){alert("This file does not match the original document.");return}try{const Gi=new FormData;Gi.append("file",new Blob([ge],{type:"application/pdf"}),he.name||st.filename||"document.pdf"),await $n.uploadPdf(r,Gi)}catch(Gi){const ar=Gi.response?.data?.detail??Gi.message??"Upload failed";alert(typeof ar=="string"?ar:JSON.stringify(ar));return}await km(An,st.filename||he.name,he.size,ge),a(ge),c(!1)};return r?wt||u?D.jsx("div",{className:`${ua} flex items-center justify-center min-h-[50vh]`,children:D.jsx(Ts,{className:`w-8 h-8 ${Zt.muted} animate-spin`})}):Xt||!st&&!wt?D.jsxs("div",{className:`${ua} flex flex-col items-center justify-center min-h-[50vh]`,children:[D.jsx("h2",{className:`text-lg font-semibold ${Zt.heading} mb-2`,children:"Document not found"}),D.jsx("p",{className:`text-sm ${Zt.secondary} mb-4`,children:"It may have been deleted or you dont have access to it."}),D.jsx("button",{type:"button",onClick:()=>t(st?.project?`/project/${st.project}`:"/"),className:da,children:"Back to project"})]}):l?D.jsxs("div",{className:`${ua} flex flex-col items-center justify-center`,children:[D.jsx(Yp,{className:`w-12 h-12 ${Zt.muted} mb-4`}),D.jsx("h2",{className:`text-lg font-semibold ${Zt.heading} mb-2`,children:"PDF needed on this device"}),D.jsxs("p",{className:`text-sm ${Zt.secondary} mb-4 text-center max-w-sm`,children:["Upload the same file to open ",D.jsx("strong",{children:st?.filename}),"."]}),D.jsxs("label",{className:`${da} inline-flex items-center gap-2`,children:[D.jsx(Yp,{className:"w-4 h-4"})," Upload PDF",D.jsx("input",{type:"file",accept:".pdf",onChange:we,className:"hidden"})]}),D.jsx("button",{type:"button",onClick:()=>t(st?.project?`/project/${st.project}`:"/"),className:`mt-4 text-sm ${Zt.muted} hover:underline`,children:"Back to project"})]}):D.jsxs("div",{className:`h-screen flex flex-col ${_i.page} overflow-hidden`,children:[D.jsxs("header",{className:`${xw} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("button",{type:"button",onClick:()=>t(st?.project?`/project/${st.project}`:"/"),className:tl,title:"Back to project",children:D.jsx(ad,{className:"w-4 h-4"})}),D.jsx("p",{className:`text-sm font-medium ${Zt.heading} truncate max-w-xs`,children:st?.filename})]}),D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:()=>Rt(!0),className:tl,title:"Customise topic names",children:D.jsx(rC,{className:"w-4 h-4"})}),D.jsx("button",{type:"button",onClick:()=>t(`/document/${r}/summary`),className:tl,title:"Summary",children:D.jsx(H_,{className:"w-4 h-4"})}),D.jsx("div",{className:q0}),D.jsxs("div",{className:`flex items-center gap-1 ${_i.muted} rounded-lg px-1 py-0.5`,children:[D.jsx("button",{type:"button",onClick:()=>p(pt=>Math.max(.5,pt-.1)),className:`p-1.5 ${Zt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:D.jsx(fC,{className:"w-3.5 h-3.5"})}),D.jsxs("span",{className:`text-xs ${Zt.secondary} w-12 text-center`,children:[Math.round(f*100),"%"]}),D.jsx("button",{type:"button",onClick:()=>p(pt=>Math.min(3,pt+.1)),className:`p-1.5 ${Zt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:D.jsx(hC,{className:"w-3.5 h-3.5"})})]}),D.jsx("div",{className:q0}),D.jsx("button",{type:"button",onClick:()=>w(pt=>!pt),className:tl,title:y?"Close annotations":"Open annotations",children:y?D.jsx(W_,{className:"w-4 h-4"}):D.jsx(J_,{className:"w-4 h-4"})})]})]}),D.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[D.jsxs("div",{className:"flex-1 overflow-auto flex flex-col relative pb-14",id:"pdf-scroll-container",children:[i&&D.jsx(T2,{pdfData:i,scale:f,highlights:U,hoveredHighlightId:A,activeHighlightId:S,selectionForPicker:F,onSelectionComplete:mt,onNumPages:Tt,onHighlightHover:_,onHighlightHoverEnd:()=>_(null),onHighlightEdit:(pt,he)=>{const ge=he?.target?.getBoundingClientRect?.();ge?G({highlightId:pt,x:ge.left+ge.width/2,y:ge.bottom}):(Bt(pt),w(!0))},onHighlightDelete:async pt=>{r&&(await $n.deleteHighlight(r,pt),e.invalidateQueries({queryKey:["highlights",r]}),String(S)===String(pt)&&C(null),String(A)===String(pt)&&_(null))}}),k&&D.jsx(D2,{position:k,onSelect:xt,onClose:It,colorLabels:st?.color_labels,documentColorKeys:Ct}),$t&&D.jsx(N2,{position:{x:$t.x,y:$t.y},initialValue:(U||[]).find(pt=>String(pt.id)===String($t.highlightId))?.note?.content??"",onSave:async pt=>{r&&(await $n.updateHighlight(r,$t.highlightId,{note:pt}),e.invalidateQueries({queryKey:["highlights",r]}),G(null))},onClose:()=>G(null)}),ct&&D.jsx(O2,{colorLabels:st?.color_labels||{},documentId:r,onSave:()=>{e.invalidateQueries({queryKey:["document",r]}),Rt(!1)},onClose:()=>Rt(!1)})]}),y&&D.jsx(M2,{highlights:U,colorLabels:st?.color_labels,documentColorKeys:Ct,activeHighlightId:S,onScrollToPage:Ut,onHighlightClick:Ot,onHighlightHover:_,onHighlightHoverEnd:()=>_(null),onClearActive:()=>C(null),documentId:r,openEditForHighlightId:Lt,onClearOpenEditForHighlightId:()=>Bt(null),onHighlightNoteUpdate:async(pt,he)=>{r&&(await $n.updateHighlight(r,pt,{note:he}),e.invalidateQueries({queryKey:["highlights",r]}))},onHighlightDelete:async pt=>{r&&(await $n.deleteHighlight(r,pt),e.invalidateQueries({queryKey:["highlights",r]}),String(S)===String(pt)&&C(null),String(A)===String(pt)&&_(null))}})]}),H>0&&D.jsxs("div",{className:`fixed bottom-0 left-0 z-10 flex items-center justify-center gap-2 border-t border-slate-200 bg-white py-2.5 shadow-[0_-2px_8px_rgba(0,0,0,0.06)] ${y?"right-80":"right-0"}`,children:[D.jsx("button",{type:"button",onClick:jt,disabled:ft<=1,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""}),D.jsxs("span",{className:"min-w-[80px] text-center text-xs text-slate-500",children:["Page ",ft," of ",H]}),D.jsx("button",{type:"button",onClick:kt,disabled:ft>=H,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""})]})]}):(t("/",{replace:!0}),null)}const Mh="sequence",Dh="topic";function L2(){const{id:r}=gm(),t=fa(),[e,i]=I.useState(Mh),{data:a,isLoading:l,isError:c}=tr({queryKey:["document",r],queryFn:async()=>{const{data:y}=await $n.get(r);return y},enabled:!!r}),{data:u=[]}=tr({queryKey:["highlights",r],queryFn:async()=>{const{data:y}=await $n.highlights(r);return y},enabled:!!r}),d=a?.color_labels||{},f=I.useMemo(()=>{const y=[...u||[]];return e===Mh?(y.sort((w,A)=>w.page_number!==A.page_number?w.page_number-A.page_number:new Date(w.created_at)-new Date(A.created_at)),y):(y.sort((w,A)=>{const _=_s(w.color,d),S=_s(A.color,d);return _!==S?_.localeCompare(S):w.page_number!==A.page_number?w.page_number-A.page_number:new Date(w.created_at)-new Date(A.created_at)}),y)},[u,e,d]),p=I.useMemo(()=>{if(e!==Dh)return[];const y={};return(u||[]).forEach(w=>{const A=_s(w.color,d);y[A]||(y[A]=[]),y[A].push(w)}),la.forEach(w=>{const A=_s(w,d);y[A]&&y[A].sort((_,S)=>_.page_number!==S.page_number?_.page_number-S.page_number:new Date(_.created_at)-new Date(S.created_at))}),la.map(w=>({topic:_s(w,d),colorKey:w,items:y[_s(w,d)]||[]})).filter(w=>w.items.length>0)},[u,e,d]);return r?l?D.jsx("div",{className:`${ua} flex items-center justify-center min-h-[50vh]`,children:D.jsx(Ts,{className:`w-8 h-8 ${Zt.muted} animate-spin`})}):c||!a?D.jsxs("div",{className:`${ua} flex flex-col items-center justify-center min-h-[50vh]`,children:[D.jsx("h2",{className:`text-lg font-semibold ${Zt.heading} mb-2`,children:"Document not found"}),D.jsx("button",{type:"button",onClick:()=>t(a?.project?`/project/${a.project}`:"/"),className:da,children:"Back to project"})]}):D.jsxs("div",{className:`min-h-screen flex flex-col ${_i.page}`,children:[D.jsxs("header",{className:`${xw} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[D.jsxs("div",{className:"flex items-center gap-3",children:[D.jsx("button",{type:"button",onClick:()=>t(`/document/${r}`),className:tl,children:D.jsx(ad,{className:"w-4 h-4"})}),D.jsxs("div",{children:[D.jsx("h1",{className:`text-sm font-semibold ${Zt.heading}`,children:"Summary"}),D.jsx("p",{className:`text-xs ${Zt.muted} truncate max-w-[200px]`,children:a.filename})]})]}),D.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 p-0.5 bg-slate-50",children:[D.jsxs("button",{type:"button",onClick:()=>i(Mh),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===Mh?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[D.jsx(K_,{className:"w-3.5 h-3.5"}),"Sequence"]}),D.jsxs("button",{type:"button",onClick:()=>i(Dh),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===Dh?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[D.jsx(V_,{className:"w-3.5 h-3.5"}),"Topic"]})]})]}),D.jsx("main",{className:"flex-1 overflow-auto p-6 max-w-3xl mx-auto w-full",children:u?.length?e===Dh&&p.length>0?D.jsx("div",{className:"space-y-8",children:p.map(({topic:y,colorKey:w,items:A})=>{const _=ui[w]||ui.yellow;return D.jsxs("section",{children:[D.jsxs("h2",{className:"text-sm font-semibold text-slate-800 mb-3 pb-2 border-b border-slate-200 flex items-center gap-2",children:[D.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:_.hex??_.solid}}),y,D.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:["(",A.length,")"]})]}),D.jsx("ul",{className:"space-y-3",children:A.map(S=>D.jsxs("li",{className:`rounded-lg border ${Zi.default} ${_i.surface} p-4`,children:[D.jsx("p",{className:`text-sm ${Zt.body} leading-snug`,children:S.highlighted_text||"(No text captured)"}),S.note?.content&&D.jsx("p",{className:`text-xs ${Zt.muted} mt-2 italic`,children:S.note.content}),D.jsxs("p",{className:`text-[11px] ${Zt.muted} mt-2`,children:["p.",S.page_number]})]},S.id))})]},y)})}):D.jsx("ul",{className:"space-y-3",children:f.map(y=>{const w=ui[y.color]||ui.yellow,A=_s(y.color,d);return D.jsxs("li",{className:`rounded-lg border ${Zi.default} ${_i.surface} p-4 flex gap-3`,children:[D.jsx("div",{className:"w-1 min-h-8 rounded-full shrink-0",style:{backgroundColor:w.hex??w.solid}}),D.jsxs("div",{className:"min-w-0 flex-1",children:[D.jsx("p",{className:`text-sm ${Zt.body} leading-snug`,children:y.highlighted_text||"(No text captured)"}),y.note?.content&&D.jsx("p",{className:`text-xs ${Zt.muted} mt-2 italic`,children:y.note.content}),D.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[D.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:w.hex??w.solid,backgroundColor:`${w.hex??w.solid}18`},children:A}),D.jsxs("span",{className:`text-[11px] ${Zt.muted}`,children:["p.",y.page_number]})]})]})]},y.id)})}):D.jsxs("div",{className:`py-12 text-center ${Zt.muted} text-sm`,children:[D.jsx("p",{children:"No highlights yet."}),D.jsx("p",{className:"mt-1",children:"Select text in the document to create highlights, then return here for a summary."}),D.jsx("button",{type:"button",onClick:()=>t(`/document/${r}`),className:`${da} mt-4`,children:"Open document"})]})})]}):(t("/",{replace:!0}),null)}function P2({onClose:r,onConfirm:t,isDeleting:e}){return D.jsx("div",{className:"fixed inset-0 bg-slate-950/40 backdrop-blur-sm flex items-center justify-center z-[1000]",onClick:r,children:D.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-[400px] mx-4 shadow-xl",onClick:i=>i.stopPropagation(),children:[D.jsx("h3",{className:"m-0 text-lg font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"Delete account?"}),D.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-600",style:{fontFamily:"'DM Sans', sans-serif"},children:"This will permanently delete your account and all your data. This cannot be undone."}),D.jsxs("div",{className:"flex justify-end gap-2",children:[D.jsx("button",{type:"button",onClick:r,disabled:e,className:"px-4 py-2 text-sm font-medium border border-slate-200 rounded-lg bg-white text-slate-600 hover:bg-slate-50",children:"Cancel"}),D.jsx("button",{type:"button",onClick:t,disabled:e,className:"px-4 py-2 text-sm font-medium rounded-lg text-white bg-red-600 hover:bg-red-700 disabled:opacity-70",children:e?D.jsxs(D.Fragment,{children:[D.jsx(Ts,{className:"w-4 h-4 animate-spin inline-block mr-1.5 align-middle"}),"Deleting"]}):"Delete account"})]})]})})}function B2(){const r=fa(),t=sr(p=>p.logout),[e,i]=I.useState(!1),[a,l]=I.useState(!1),[c,u]=I.useState(""),d=()=>{t(),r("/login",{replace:!0})},f=async()=>{u(""),l(!0);try{await Bc.deleteAccount(),t(),r("/",{replace:!0})}catch(p){u(p.response?.data?.detail||p.message||"Something went wrong."),l(!1)}};return D.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif"},children:[D.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&display=swap",rel:"stylesheet"}),D.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[D.jsxs("div",{className:"flex items-center gap-2",children:[D.jsx("button",{type:"button",onClick:()=>r("/app"),className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Back to projects",children:D.jsx(ad,{className:"w-4 h-4"})}),D.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),D.jsx("button",{type:"button",onClick:d,className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:D.jsx(Ew,{className:"w-4 h-4"})})]}),D.jsxs("div",{className:"max-w-[560px] mx-auto px-6 py-10",children:[D.jsx("h1",{className:"m-0 text-[28px] font-normal text-slate-950 tracking-tight",style:{fontFamily:"'Instrument Serif', serif"},children:"Account settings"}),D.jsxs("section",{className:"mt-8 p-6 bg-white border border-slate-200 rounded-xl",children:[D.jsx("h2",{className:"text-base font-semibold text-slate-800 mb-1",children:"Delete account"}),D.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Permanently delete your account and all your projects and documents."}),D.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-4 py-2 text-sm font-medium rounded-lg text-red-600 border border-red-200 bg-white hover:bg-red-50",children:"Delete account"})]}),c&&D.jsx("p",{className:"mt-4 text-sm text-red-600",children:c})]}),e&&D.jsx(P2,{onClose:()=>!a&&i(!1),onConfirm:f,isDeleting:a})]})}const j2=new BS({defaultOptions:{queries:{staleTime:3e4,retry:1}}});function Rc({children:r}){return sr(e=>e.token)?r:D.jsx(zh,{to:"/login",replace:!0})}function Sv({children:r}){return sr(e=>e.token)?D.jsx(zh,{to:"/app",replace:!0}):r}function F2(){return D.jsx(jS,{client:j2,children:D.jsx(nS,{children:D.jsxs(NA,{children:[D.jsx(As,{path:"/login",element:D.jsx(Sv,{children:D.jsx(N_,{})})}),D.jsx(As,{path:"/register",element:D.jsx(Sv,{children:D.jsx(k_,{})})}),D.jsx(As,{path:"/",element:D.jsx(zh,{to:"/app",replace:!0})}),D.jsx(As,{path:"/app",element:D.jsx(Rc,{children:D.jsx(yC,{})})}),D.jsx(As,{path:"/app/settings",element:D.jsx(Rc,{children:D.jsx(B2,{})})}),D.jsx(As,{path:"/project/:projectId",element:D.jsx(Rc,{children:D.jsx(SC,{})})}),D.jsx(As,{path:"/document/:id",element:D.jsx(Rc,{children:D.jsx(k2,{})})}),D.jsx(As,{path:"/document/:id/summary",element:D.jsx(Rc,{children:D.jsx(L2,{})})}),D.jsx(As,{path:"*",element:D.jsx(zh,{to:"/app",replace:!0})})]})})})}P1.createRoot(document.getElementById("root")).render(D.jsx(I.StrictMode,{children:D.jsx(F2,{})}));
