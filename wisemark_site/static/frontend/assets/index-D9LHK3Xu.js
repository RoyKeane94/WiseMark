var Zb=r=>{throw TypeError(r)};var pp=(r,t,e)=>t.has(r)||Zb("Cannot "+e);var Je=(r,t,e)=>(pp(r,t,"read from private field"),e?e.call(r):t.get(r)),As=(r,t,e)=>t.has(r)?Zb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(r):t.set(r,e),di=(r,t,e,i)=>(pp(r,t,"write to private field"),i?i.call(r,e):t.set(r,e),e),Es=(r,t,e)=>(pp(r,t,"access private method"),e);var Jb=(r,t,e,i)=>({set _(a){di(r,t,a,e)},get _(){return Je(r,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))i(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(a){if(a.ep)return;a.ep=!0;const l=e(a);fetch(a.href,l)}})();var N1=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Dv(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var mp={exports:{}},Ac={};var t0;function k1(){if(t0)return Ac;t0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,a,l){var c=null;if(l!==void 0&&(c=""+l),a.key!==void 0&&(c=""+a.key),"key"in a){l={};for(var u in a)u!=="key"&&(l[u]=a[u])}else l=a;return a=l.ref,{$$typeof:r,type:i,key:c,ref:a!==void 0?a:null,props:l}}return Ac.Fragment=t,Ac.jsx=e,Ac.jsxs=e,Ac}var e0;function O1(){return e0||(e0=1,mp.exports=k1()),mp.exports}var C=O1(),gp={exports:{}},re={};var n0;function L1(){if(n0)return re;n0=1;var r=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),x=Symbol.iterator;function S(F){return F===null||typeof F!="object"?null:(F=x&&F[x]||F["@@iterator"],typeof F=="function"?F:null)}var A={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,R={};function D(F,J,ht){this.props=F,this.context=J,this.refs=R,this.updater=ht||A}D.prototype.isReactComponent={},D.prototype.setState=function(F,J){if(typeof F!="object"&&typeof F!="function"&&F!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,F,J,"setState")},D.prototype.forceUpdate=function(F){this.updater.enqueueForceUpdate(this,F,"forceUpdate")};function k(){}k.prototype=D.prototype;function O(F,J,ht){this.props=F,this.context=J,this.refs=R,this.updater=ht||A}var I=O.prototype=new k;I.constructor=O,E(I,D.prototype),I.isPureReactComponent=!0;var z=Array.isArray;function H(){}var P={H:null,A:null,T:null,S:null},rt=Object.prototype.hasOwnProperty;function ut(F,J,ht){var xt=ht.ref;return{$$typeof:r,type:F,key:J,ref:xt!==void 0?xt:null,props:ht}}function St(F,J){return ut(F.type,J,F.props)}function _t(F){return typeof F=="object"&&F!==null&&F.$$typeof===r}function Mt(F){var J={"=":"=0",":":"=2"};return"$"+F.replace(/[=:]/g,function(ht){return J[ht]})}var Vt=/\/+/g;function vt(F,J){return typeof F=="object"&&F!==null&&F.key!=null?Mt(""+F.key):J.toString(36)}function Ht(F){switch(F.status){case"fulfilled":return F.value;case"rejected":throw F.reason;default:switch(typeof F.status=="string"?F.then(H,H):(F.status="pending",F.then(function(J){F.status==="pending"&&(F.status="fulfilled",F.value=J)},function(J){F.status==="pending"&&(F.status="rejected",F.reason=J)})),F.status){case"fulfilled":return F.value;case"rejected":throw F.reason}}throw F}function G(F,J,ht,xt,Dt){var qt=typeof F;(qt==="undefined"||qt==="boolean")&&(F=null);var Bt=!1;if(F===null)Bt=!0;else switch(qt){case"bigint":case"string":case"number":Bt=!0;break;case"object":switch(F.$$typeof){case r:case t:Bt=!0;break;case p:return Bt=F._init,G(Bt(F._payload),J,ht,xt,Dt)}}if(Bt)return Dt=Dt(F),Bt=xt===""?"."+vt(F,0):xt,z(Dt)?(ht="",Bt!=null&&(ht=Bt.replace(Vt,"$&/")+"/"),G(Dt,J,ht,"",function(Rt){return Rt})):Dt!=null&&(_t(Dt)&&(Dt=St(Dt,ht+(Dt.key==null||F&&F.key===Dt.key?"":(""+Dt.key).replace(Vt,"$&/")+"/")+Bt)),J.push(Dt)),1;Bt=0;var he=xt===""?".":xt+":";if(z(F))for(var de=0;de<F.length;de++)xt=F[de],qt=he+vt(xt,de),Bt+=G(xt,J,ht,qt,Dt);else if(de=S(F),typeof de=="function")for(F=de.call(F),de=0;!(xt=F.next()).done;)xt=xt.value,qt=he+vt(xt,de++),Bt+=G(xt,J,ht,qt,Dt);else if(qt==="object"){if(typeof F.then=="function")return G(Ht(F),J,ht,xt,Dt);throw J=String(F),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(F).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Bt}function ct(F,J,ht){if(F==null)return F;var xt=[],Dt=0;return G(F,xt,"","",function(qt){return J.call(ht,qt,Dt++)}),xt}function yt(F){if(F._status===-1){var J=F._result;J=J(),J.then(function(ht){(F._status===0||F._status===-1)&&(F._status=1,F._result=ht)},function(ht){(F._status===0||F._status===-1)&&(F._status=2,F._result=ht)}),F._status===-1&&(F._status=0,F._result=J)}if(F._status===1)return F._result.default;throw F._result}var Tt=typeof reportError=="function"?reportError:function(F){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof F=="object"&&F!==null&&typeof F.message=="string"?String(F.message):String(F),error:F});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",F);return}console.error(F)},Pt={map:ct,forEach:function(F,J,ht){ct(F,function(){J.apply(this,arguments)},ht)},count:function(F){var J=0;return ct(F,function(){J++}),J},toArray:function(F){return ct(F,function(J){return J})||[]},only:function(F){if(!_t(F))throw Error("React.Children.only expected to receive a single React element child.");return F}};return re.Activity=y,re.Children=Pt,re.Component=D,re.Fragment=e,re.Profiler=a,re.PureComponent=O,re.StrictMode=i,re.Suspense=d,re.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,re.__COMPILER_RUNTIME={__proto__:null,c:function(F){return P.H.useMemoCache(F)}},re.cache=function(F){return function(){return F.apply(null,arguments)}},re.cacheSignal=function(){return null},re.cloneElement=function(F,J,ht){if(F==null)throw Error("The argument must be a React element, but you passed "+F+".");var xt=E({},F.props),Dt=F.key;if(J!=null)for(qt in J.key!==void 0&&(Dt=""+J.key),J)!rt.call(J,qt)||qt==="key"||qt==="__self"||qt==="__source"||qt==="ref"&&J.ref===void 0||(xt[qt]=J[qt]);var qt=arguments.length-2;if(qt===1)xt.children=ht;else if(1<qt){for(var Bt=Array(qt),he=0;he<qt;he++)Bt[he]=arguments[he+2];xt.children=Bt}return ut(F.type,Dt,xt)},re.createContext=function(F){return F={$$typeof:c,_currentValue:F,_currentValue2:F,_threadCount:0,Provider:null,Consumer:null},F.Provider=F,F.Consumer={$$typeof:l,_context:F},F},re.createElement=function(F,J,ht){var xt,Dt={},qt=null;if(J!=null)for(xt in J.key!==void 0&&(qt=""+J.key),J)rt.call(J,xt)&&xt!=="key"&&xt!=="__self"&&xt!=="__source"&&(Dt[xt]=J[xt]);var Bt=arguments.length-2;if(Bt===1)Dt.children=ht;else if(1<Bt){for(var he=Array(Bt),de=0;de<Bt;de++)he[de]=arguments[de+2];Dt.children=he}if(F&&F.defaultProps)for(xt in Bt=F.defaultProps,Bt)Dt[xt]===void 0&&(Dt[xt]=Bt[xt]);return ut(F,qt,Dt)},re.createRef=function(){return{current:null}},re.forwardRef=function(F){return{$$typeof:u,render:F}},re.isValidElement=_t,re.lazy=function(F){return{$$typeof:p,_payload:{_status:-1,_result:F},_init:yt}},re.memo=function(F,J){return{$$typeof:f,type:F,compare:J===void 0?null:J}},re.startTransition=function(F){var J=P.T,ht={};P.T=ht;try{var xt=F(),Dt=P.S;Dt!==null&&Dt(ht,xt),typeof xt=="object"&&xt!==null&&typeof xt.then=="function"&&xt.then(H,Tt)}catch(qt){Tt(qt)}finally{J!==null&&ht.types!==null&&(J.types=ht.types),P.T=J}},re.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},re.use=function(F){return P.H.use(F)},re.useActionState=function(F,J,ht){return P.H.useActionState(F,J,ht)},re.useCallback=function(F,J){return P.H.useCallback(F,J)},re.useContext=function(F){return P.H.useContext(F)},re.useDebugValue=function(){},re.useDeferredValue=function(F,J){return P.H.useDeferredValue(F,J)},re.useEffect=function(F,J){return P.H.useEffect(F,J)},re.useEffectEvent=function(F){return P.H.useEffectEvent(F)},re.useId=function(){return P.H.useId()},re.useImperativeHandle=function(F,J,ht){return P.H.useImperativeHandle(F,J,ht)},re.useInsertionEffect=function(F,J){return P.H.useInsertionEffect(F,J)},re.useLayoutEffect=function(F,J){return P.H.useLayoutEffect(F,J)},re.useMemo=function(F,J){return P.H.useMemo(F,J)},re.useOptimistic=function(F,J){return P.H.useOptimistic(F,J)},re.useReducer=function(F,J,ht){return P.H.useReducer(F,J,ht)},re.useRef=function(F){return P.H.useRef(F)},re.useState=function(F){return P.H.useState(F)},re.useSyncExternalStore=function(F,J,ht){return P.H.useSyncExternalStore(F,J,ht)},re.useTransition=function(){return P.H.useTransition()},re.version="19.2.4",re}var i0;function fm(){return i0||(i0=1,gp.exports=L1()),gp.exports}var U=fm();const bh=Dv(U);var yp={exports:{}},Ec={},bp={exports:{}},vp={};var s0;function j1(){return s0||(s0=1,(function(r){function t(G,ct){var yt=G.length;G.push(ct);t:for(;0<yt;){var Tt=yt-1>>>1,Pt=G[Tt];if(0<a(Pt,ct))G[Tt]=ct,G[yt]=Pt,yt=Tt;else break t}}function e(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var ct=G[0],yt=G.pop();if(yt!==ct){G[0]=yt;t:for(var Tt=0,Pt=G.length,F=Pt>>>1;Tt<F;){var J=2*(Tt+1)-1,ht=G[J],xt=J+1,Dt=G[xt];if(0>a(ht,yt))xt<Pt&&0>a(Dt,ht)?(G[Tt]=Dt,G[xt]=yt,Tt=xt):(G[Tt]=ht,G[J]=yt,Tt=J);else if(xt<Pt&&0>a(Dt,yt))G[Tt]=Dt,G[xt]=yt,Tt=xt;else break t}}return ct}function a(G,ct){var yt=G.sortIndex-ct.sortIndex;return yt!==0?yt:G.id-ct.id}if(r.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;r.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();r.unstable_now=function(){return c.now()-u}}var d=[],f=[],p=1,y=null,x=3,S=!1,A=!1,E=!1,R=!1,D=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function I(G){for(var ct=e(f);ct!==null;){if(ct.callback===null)i(f);else if(ct.startTime<=G)i(f),ct.sortIndex=ct.expirationTime,t(d,ct);else break;ct=e(f)}}function z(G){if(E=!1,I(G),!A)if(e(d)!==null)A=!0,H||(H=!0,Mt());else{var ct=e(f);ct!==null&&Ht(z,ct.startTime-G)}}var H=!1,P=-1,rt=5,ut=-1;function St(){return R?!0:!(r.unstable_now()-ut<rt)}function _t(){if(R=!1,H){var G=r.unstable_now();ut=G;var ct=!0;try{t:{A=!1,E&&(E=!1,k(P),P=-1),S=!0;var yt=x;try{e:{for(I(G),y=e(d);y!==null&&!(y.expirationTime>G&&St());){var Tt=y.callback;if(typeof Tt=="function"){y.callback=null,x=y.priorityLevel;var Pt=Tt(y.expirationTime<=G);if(G=r.unstable_now(),typeof Pt=="function"){y.callback=Pt,I(G),ct=!0;break e}y===e(d)&&i(d),I(G)}else i(d);y=e(d)}if(y!==null)ct=!0;else{var F=e(f);F!==null&&Ht(z,F.startTime-G),ct=!1}}break t}finally{y=null,x=yt,S=!1}ct=void 0}}finally{ct?Mt():H=!1}}}var Mt;if(typeof O=="function")Mt=function(){O(_t)};else if(typeof MessageChannel<"u"){var Vt=new MessageChannel,vt=Vt.port2;Vt.port1.onmessage=_t,Mt=function(){vt.postMessage(null)}}else Mt=function(){D(_t,0)};function Ht(G,ct){P=D(function(){G(r.unstable_now())},ct)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(G){G.callback=null},r.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):rt=0<G?Math.floor(1e3/G):5},r.unstable_getCurrentPriorityLevel=function(){return x},r.unstable_next=function(G){switch(x){case 1:case 2:case 3:var ct=3;break;default:ct=x}var yt=x;x=ct;try{return G()}finally{x=yt}},r.unstable_requestPaint=function(){R=!0},r.unstable_runWithPriority=function(G,ct){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var yt=x;x=G;try{return ct()}finally{x=yt}},r.unstable_scheduleCallback=function(G,ct,yt){var Tt=r.unstable_now();switch(typeof yt=="object"&&yt!==null?(yt=yt.delay,yt=typeof yt=="number"&&0<yt?Tt+yt:Tt):yt=Tt,G){case 1:var Pt=-1;break;case 2:Pt=250;break;case 5:Pt=1073741823;break;case 4:Pt=1e4;break;default:Pt=5e3}return Pt=yt+Pt,G={id:p++,callback:ct,priorityLevel:G,startTime:yt,expirationTime:Pt,sortIndex:-1},yt>Tt?(G.sortIndex=yt,t(f,G),e(d)===null&&G===e(f)&&(E?(k(P),P=-1):E=!0,Ht(z,yt-Tt))):(G.sortIndex=Pt,t(d,G),A||S||(A=!0,H||(H=!0,Mt()))),G},r.unstable_shouldYield=St,r.unstable_wrapCallback=function(G){var ct=x;return function(){var yt=x;x=ct;try{return G.apply(this,arguments)}finally{x=yt}}}})(vp)),vp}var a0;function P1(){return a0||(a0=1,bp.exports=j1()),bp.exports}var xp={exports:{}},Wn={};var r0;function B1(){if(r0)return Wn;r0=1;var r=fm();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},a=Symbol.for("react.portal");function l(d,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:f,implementation:p}}var c=r.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Wn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Wn.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(d,f,null,p)},Wn.flushSync=function(d){var f=c.T,p=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=f,i.p=p,i.d.f()}},Wn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Wn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Wn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),x=typeof f.integrity=="string"?f.integrity:void 0,S=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:x,fetchPriority:S}):p==="script"&&i.d.X(d,{crossOrigin:y,integrity:x,fetchPriority:S,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Wn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Wn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);i.d.L(d,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Wn.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Wn.requestFormReset=function(d){i.d.r(d)},Wn.unstable_batchedUpdates=function(d,f){return d(f)},Wn.useFormState=function(d,f,p){return c.H.useFormState(d,f,p)},Wn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Wn.version="19.2.4",Wn}var o0;function Nv(){if(o0)return xp.exports;o0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),xp.exports=B1(),xp.exports}var l0;function F1(){if(l0)return Ec;l0=1;var r=P1(),t=fm(),e=Nv();function i(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,o=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(o=s.return),n=s.return;while(n)}return s.tag===3?o:null}function c(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function u(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function d(n){if(l(n)!==n)throw Error(i(188))}function f(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(i(188));return s!==n?null:n}for(var o=n,h=s;;){var g=o.return;if(g===null)break;var b=g.alternate;if(b===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===o)return d(g),n;if(b===h)return d(g),s;b=b.sibling}throw Error(i(188))}if(o.return!==h.return)o=g,h=b;else{for(var T=!1,L=g.child;L;){if(L===o){T=!0,o=g,h=b;break}if(L===h){T=!0,h=g,o=b;break}L=L.sibling}if(!T){for(L=b.child;L;){if(L===o){T=!0,o=b,h=g;break}if(L===h){T=!0,h=b,o=g;break}L=L.sibling}if(!T)throw Error(i(189))}}if(o.alternate!==h)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:s}function p(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=p(n),s!==null)return s;n=n.sibling}return null}var y=Object.assign,x=Symbol.for("react.element"),S=Symbol.for("react.transitional.element"),A=Symbol.for("react.portal"),E=Symbol.for("react.fragment"),R=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),O=Symbol.for("react.context"),I=Symbol.for("react.forward_ref"),z=Symbol.for("react.suspense"),H=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),rt=Symbol.for("react.lazy"),ut=Symbol.for("react.activity"),St=Symbol.for("react.memo_cache_sentinel"),_t=Symbol.iterator;function Mt(n){return n===null||typeof n!="object"?null:(n=_t&&n[_t]||n["@@iterator"],typeof n=="function"?n:null)}var Vt=Symbol.for("react.client.reference");function vt(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===Vt?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case E:return"Fragment";case D:return"Profiler";case R:return"StrictMode";case z:return"Suspense";case H:return"SuspenseList";case ut:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case A:return"Portal";case O:return n.displayName||"Context";case k:return(n._context.displayName||"Context")+".Consumer";case I:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case P:return s=n.displayName||null,s!==null?s:vt(n.type)||"Memo";case rt:s=n._payload,n=n._init;try{return vt(n(s))}catch{}}return null}var Ht=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ct=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,yt={pending:!1,data:null,method:null,action:null},Tt=[],Pt=-1;function F(n){return{current:n}}function J(n){0>Pt||(n.current=Tt[Pt],Tt[Pt]=null,Pt--)}function ht(n,s){Pt++,Tt[Pt]=n.current,n.current=s}var xt=F(null),Dt=F(null),qt=F(null),Bt=F(null);function he(n,s){switch(ht(qt,s),ht(Dt,n),ht(xt,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?wb(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=wb(s),n=Sb(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}J(xt),ht(xt,n)}function de(){J(xt),J(Dt),J(qt)}function Rt(n){n.memoizedState!==null&&ht(Bt,n);var s=xt.current,o=Sb(s,n.type);s!==o&&(ht(Dt,n),ht(xt,o))}function pe(n){Dt.current===n&&(J(xt),J(Dt)),Bt.current===n&&(J(Bt),vc._currentValue=yt)}var Xt,Ce;function On(n){if(Xt===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);Xt=s&&s[1]||"",Ce=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Xt+n+Ce}var Nt=!1;function Se(n,s){if(!n||Nt)return"";Nt=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var bt=function(){throw Error()};if(Object.defineProperty(bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(bt,[])}catch(ft){var lt=ft}Reflect.construct(n,[],bt)}else{try{bt.call()}catch(ft){lt=ft}n.call(bt.prototype)}}else{try{throw Error()}catch(ft){lt=ft}(bt=n())&&typeof bt.catch=="function"&&bt.catch(function(){})}}catch(ft){if(ft&&lt&&typeof ft.stack=="string")return[ft.stack,lt.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=h.DetermineComponentFrameRoot(),T=b[0],L=b[1];if(T&&L){var q=T.split(`
`),at=L.split(`
`);for(g=h=0;h<q.length&&!q[h].includes("DetermineComponentFrameRoot");)h++;for(;g<at.length&&!at[g].includes("DetermineComponentFrameRoot");)g++;if(h===q.length||g===at.length)for(h=q.length-1,g=at.length-1;1<=h&&0<=g&&q[h]!==at[g];)g--;for(;1<=h&&0<=g;h--,g--)if(q[h]!==at[g]){if(h!==1||g!==1)do if(h--,g--,0>g||q[h]!==at[g]){var mt=`
`+q[h].replace(" at new "," at ");return n.displayName&&mt.includes("<anonymous>")&&(mt=mt.replace("<anonymous>",n.displayName)),mt}while(1<=h&&0<=g);break}}}finally{Nt=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?On(o):""}function Bs(n,s){switch(n.tag){case 26:case 27:case 5:return On(n.type);case 16:return On("Lazy");case 13:return n.child!==s&&s!==null?On("Suspense Fallback"):On("Suspense");case 19:return On("SuspenseList");case 0:case 15:return Se(n.type,!1);case 11:return Se(n.type.render,!1);case 1:return Se(n.type,!0);case 31:return On("Activity");default:return""}}function Ct(n){try{var s="",o=null;do s+=Bs(n,o),o=n,n=n.return;while(n);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var ne=Object.prototype.hasOwnProperty,Te=r.unstable_scheduleCallback,Fe=r.unstable_cancelCallback,ai=r.unstable_shouldYield,Yi=r.unstable_requestPaint,Kn=r.unstable_now,dr=r.unstable_getCurrentPriorityLevel,Vn=r.unstable_ImmediatePriority,os=r.unstable_UserBlockingPriority,Aa=r.unstable_NormalPriority,fr=r.unstable_LowPriority,oo=r.unstable_IdlePriority,lo=r.log,Fs=r.unstable_setDisableYieldValue,ls=null,Ln=null;function jn(n){if(typeof lo=="function"&&Fs(n),Ln&&typeof Ln.setStrictMode=="function")try{Ln.setStrictMode(ls,n)}catch{}}var Ft=Math.clz32?Math.clz32:co,pr=Math.log,Is=Math.LN2;function co(n){return n>>>=0,n===0?32:31-(pr(n)/Is|0)|0}var Lt=256,Ea=262144,mr=4194304;function Qi(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function gr(n,s,o){var h=n.pendingLanes;if(h===0)return 0;var g=0,b=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var L=h&134217727;return L!==0?(h=L&~b,h!==0?g=Qi(h):(T&=L,T!==0?g=Qi(T):o||(o=L&~n,o!==0&&(g=Qi(o))))):(L=h&~b,L!==0?g=Qi(L):T!==0?g=Qi(T):o||(o=h&~n,o!==0&&(g=Qi(o)))),g===0?0:s!==0&&s!==g&&(s&b)===0&&(b=g&-g,o=s&-s,b>=o||b===32&&(o&4194048)!==0)?s:g}function Us(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function xd(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function au(){var n=mr;return mr<<=1,(mr&62914560)===0&&(mr=4194304),n}function cs(n){for(var s=[],o=0;31>o;o++)s.push(n);return s}function Ni(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Al(n,s,o,h,g,b){var T=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var L=n.entanglements,q=n.expirationTimes,at=n.hiddenUpdates;for(o=T&~o;0<o;){var mt=31-Ft(o),bt=1<<mt;L[mt]=0,q[mt]=-1;var lt=at[mt];if(lt!==null)for(at[mt]=null,mt=0;mt<lt.length;mt++){var ft=lt[mt];ft!==null&&(ft.lane&=-536870913)}o&=~bt}h!==0&&yr(n,h,0),b!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=b&~(T&~s))}function yr(n,s,o){n.pendingLanes|=s,n.suspendedLanes&=~s;var h=31-Ft(s);n.entangledLanes|=s,n.entanglements[h]=n.entanglements[h]|1073741824|o&261930}function Ke(n,s){var o=n.entangledLanes|=s;for(n=n.entanglements;o;){var h=31-Ft(o),g=1<<h;g&s|n[h]&s&&(n[h]|=s),o&=~g}}function cn(n,s){var o=s&-s;return o=(o&42)!==0?1:El(o),(o&(n.suspendedLanes|s))!==0?0:o}function El(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function _a(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function br(){var n=ct.p;return n!==0?n:(n=window.event,n===void 0?32:Kb(n.type))}function vr(n,s){var o=ct.p;try{return ct.p=n,s()}finally{ct.p=o}}var us=Math.random().toString(36).slice(2),$e="__reactFiber$"+us,un="__reactProps$"+us,Jn="__reactContainer$"+us,Ca="__reactEvents$"+us,wd="__reactListeners$"+us,hs="__reactHandles$"+us,_l="__reactResources$"+us,yi="__reactMarker$"+us;function uo(n){delete n[$e],delete n[un],delete n[Ca],delete n[wd],delete n[hs]}function ds(n){var s=n[$e];if(s)return s;for(var o=n.parentNode;o;){if(s=o[Jn]||o[$e]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(n=Mb(n);n!==null;){if(o=n[$e])return o;n=Mb(n)}return s}n=o,o=n.parentNode}return null}function Ie(n){if(n=n[$e]||n[Jn]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function bi(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(i(33))}function $n(n){var s=n[_l];return s||(s=n[_l]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function hn(n){n[yi]=!0}var zs=new Set,xr={};function Wi(n,s){fs(n,s),fs(n+"Capture",s)}function fs(n,s){for(xr[n]=s,n=0;n<s.length;n++)zs.add(s[n])}var Hs=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Cl={},wr={};function ru(n){return ne.call(wr,n)?!0:ne.call(Cl,n)?!1:Hs.test(n)?wr[n]=!0:(Cl[n]=!0,!1)}function ue(n,s,o){if(ru(s))if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+o)}}function Sr(n,s,o){if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+o)}}function ki(n,s,o,h){if(h===null)n.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(s,o,""+h)}}function Pn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Ta(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function ou(n,s,o){var h=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,b=h.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return g.call(this)},set:function(T){o=""+T,b.call(this,T)}}),Object.defineProperty(n,s,{enumerable:h.enumerable}),{getValue:function(){return o},setValue:function(T){o=""+T},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function ho(n){if(!n._valueTracker){var s=Ta(n)?"checked":"value";n._valueTracker=ou(n,s,""+n[s])}}function Tl(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return n&&(h=Ta(n)?n.checked?"true":"false":n.value),n=h,n!==o?(s.setValue(n),!0):!1}function Re(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var Ar=/[\n"\\]/g;function Tn(n){return n.replace(Ar,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function ps(n,s,o,h,g,b,T,L){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),s!=null?T==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+Pn(s)):n.value!==""+Pn(s)&&(n.value=""+Pn(s)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),s!=null?Er(n,T,Pn(s)):o!=null?Er(n,T,Pn(o)):h!=null&&n.removeAttribute("value"),g==null&&b!=null&&(n.defaultChecked=!!b),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),L!=null&&typeof L!="function"&&typeof L!="symbol"&&typeof L!="boolean"?n.name=""+Pn(L):n.removeAttribute("name")}function fo(n,s,o,h,g,b,T,L){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.type=b),s!=null||o!=null){if(!(b!=="submit"&&b!=="reset"||s!=null)){ho(n);return}o=o!=null?""+Pn(o):"",s=s!=null?""+Pn(s):o,L||s===n.value||(n.value=s),n.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,n.checked=L?n.checked:!!h,n.defaultChecked=!!h,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),ho(n)}function Er(n,s,o){s==="number"&&Re(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Zi(n,s,o,h){if(n=n.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<n.length;o++)g=s.hasOwnProperty("$"+n[o].value),n[o].selected!==g&&(n[o].selected=g),g&&h&&(n[o].defaultSelected=!0)}else{for(o=""+Pn(o),s=null,g=0;g<n.length;g++){if(n[g].value===o){n[g].selected=!0,h&&(n[g].defaultSelected=!0);return}s!==null||n[g].disabled||(s=n[g])}s!==null&&(s.selected=!0)}}function Rl(n,s,o){if(s!=null&&(s=""+Pn(s),s!==n.value&&(n.value=s),o==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=o!=null?""+Pn(o):""}function _r(n,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(i(92));if(Ht(h)){if(1<h.length)throw Error(i(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=Pn(s),n.defaultValue=o,h=n.textContent,h===o&&h!==""&&h!==null&&(n.value=h),ho(n)}function qs(n,s){if(s){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=s;return}}n.textContent=s}var Sd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ve(n,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":h?n.setProperty(s,o):typeof o!="number"||o===0||Sd.has(s)?s==="float"?n.cssFloat=o:n[s]=(""+o).trim():n[s]=o+"px"}function Ml(n,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(n=n.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?n.setProperty(h,""):h==="float"?n.cssFloat="":n[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&o[g]!==h&&ve(n,g,h)}else for(var b in s)s.hasOwnProperty(b)&&ve(n,b,s[b])}function Dl(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ad=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),ti=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Ji(n){return ti.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ri(){}var Oi=null;function po(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Gs=null,Xe=null;function vi(n){var s=Ie(n);if(s&&(n=s.stateNode)){var o=n[un]||null;t:switch(n=s.stateNode,s.type){case"input":if(ps(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Tn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==n&&h.form===n.form){var g=h[un]||null;if(!g)throw Error(i(90));ps(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===n.form&&Tl(h)}break t;case"textarea":Rl(n,o.value,o.defaultValue);break t;case"select":s=o.value,s!=null&&Zi(n,!!o.multiple,s,!1)}}}var Ks=!1;function Ra(n,s,o){if(Ks)return n(s,o);Ks=!0;try{var h=n(s);return h}finally{if(Ks=!1,(Gs!==null||Xe!==null)&&(Qu(),Gs&&(s=Gs,n=Xe,Xe=Gs=null,vi(s),n)))for(s=0;s<n.length;s++)vi(n[s])}}function Vs(n,s){var o=n.stateNode;if(o===null)return null;var h=o[un]||null;if(h===null)return null;o=h[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break t;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var Rn=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nl=!1;if(Rn)try{var Xn={};Object.defineProperty(Xn,"passive",{get:function(){Nl=!0}}),window.addEventListener("test",Xn,Xn),window.removeEventListener("test",Xn,Xn)}catch{Nl=!1}var Li=null,mo=null,Ma=null;function Da(){if(Ma)return Ma;var n,s=mo,o=s.length,h,g="value"in Li?Li.value:Li.textContent,b=g.length;for(n=0;n<o&&s[n]===g[n];n++);var T=o-n;for(h=1;h<=T&&s[o-h]===g[b-h];h++);return Ma=g.slice(n,1<h?1-h:void 0)}function Na(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function Cr(){return!0}function lu(){return!1}function gn(n){function s(o,h,g,b,T){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=b,this.target=T,this.currentTarget=null;for(var L in n)n.hasOwnProperty(L)&&(o=n[L],this[L]=o?o(b):b[L]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?Cr:lu,this.isPropagationStopped=lu,this}return y(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Cr)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Cr)},persist:function(){},isPersistent:Cr}),s}var $s={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},go=gn($s),ms=y({},$s,{view:0,detail:0}),yo=gn(ms),Tr,kl,Rr,bo=y({},ms,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xs,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Rr&&(Rr&&n.type==="mousemove"?(Tr=n.screenX-Rr.screenX,kl=n.screenY-Rr.screenY):kl=Tr=0,Rr=n),Tr)},movementY:function(n){return"movementY"in n?n.movementY:kl}}),vo=gn(bo),Ol=y({},bo,{dataTransfer:0}),cu=gn(Ol),xo=y({},ms,{relatedTarget:0}),ka=gn(xo),wo=y({},$s,{animationName:0,elapsedTime:0,pseudoElement:0}),uu=gn(wo),Ed=y({},$s,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),Oa=gn(Ed),Ll=y({},$s,{data:0}),So=gn(Ll),jl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Pl={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Mn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Mr(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=Mn[n])?!!s[n]:!1}function Xs(){return Mr}var hu=y({},ms,{key:function(n){if(n.key){var s=jl[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=Na(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Pl[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xs,charCode:function(n){return n.type==="keypress"?Na(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Na(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),Ao=gn(hu),du=y({},bo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Bl=gn(du),Eo=y({},ms,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xs}),Fl=gn(Eo),Ys=y({},$s,{propertyName:0,elapsedTime:0,pseudoElement:0}),Il=gn(Ys),Ul=y({},bo,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),_o=gn(Ul),zl=y({},$s,{newState:0,oldState:0}),fu=gn(zl),_d=[9,13,27,32],Dr=Rn&&"CompositionEvent"in window,gs=null;Rn&&"documentMode"in document&&(gs=document.documentMode);var Cd=Rn&&"TextEvent"in window&&!gs,Co=Rn&&(!Dr||gs&&8<gs&&11>=gs),To=" ",pu=!1;function Hl(n,s){switch(n){case"keyup":return _d.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function mu(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Qs=!1;function gu(n,s){switch(n){case"compositionend":return mu(s);case"keypress":return s.which!==32?null:(pu=!0,To);case"textInput":return n=s.data,n===To&&pu?null:n;default:return null}}function Td(n,s){if(Qs)return n==="compositionend"||!Dr&&Hl(n,s)?(n=Da(),Ma=mo=Li=null,Qs=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Co&&s.locale!=="ko"?null:s.data;default:return null}}var yu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ro(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!yu[n.type]:s==="textarea"}function ql(n,s,o,h){Gs?Xe?Xe.push(h):Xe=[h]:Gs=h,s=ih(s,"onChange"),0<s.length&&(o=new go("onChange","change",null,o,h),n.push({event:o,listeners:s}))}var La=null,Nr=null;function Rd(n){mb(n,0)}function Mo(n){var s=bi(n);if(Tl(s))return n}function kr(n,s){if(n==="change")return s}var ji=!1;if(Rn){var Ye;if(Rn){var ja="oninput"in document;if(!ja){var Ws=document.createElement("div");Ws.setAttribute("oninput","return;"),ja=typeof Ws.oninput=="function"}Ye=ja}else Ye=!1;ji=Ye&&(!document.documentMode||9<document.documentMode)}function bu(){La&&(La.detachEvent("onpropertychange",Do),Nr=La=null)}function Do(n){if(n.propertyName==="value"&&Mo(Nr)){var s=[];ql(s,Nr,n,po(n)),Ra(Rd,s)}}function vu(n,s,o){n==="focusin"?(bu(),La=s,Nr=o,La.attachEvent("onpropertychange",Do)):n==="focusout"&&bu()}function Zs(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Mo(Nr)}function Gl(n,s){if(n==="click")return Mo(s)}function Pa(n,s){if(n==="input"||n==="change")return Mo(s)}function ys(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var Yn=typeof Object.is=="function"?Object.is:ys;function m(n,s){if(Yn(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var o=Object.keys(n),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!ne.call(s,g)||!Yn(n[g],s[g]))return!1}return!0}function v(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function w(n,s){var o=v(n);n=0;for(var h;o;){if(o.nodeType===3){if(h=n+o.textContent.length,n<=s&&h>=s)return{node:o,offset:s-n};n=h}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=v(o)}}function _(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?_(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function M(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=Re(n.document);s instanceof n.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)n=s.contentWindow;else break;s=Re(n.document)}return s}function N(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var j=Rn&&"documentMode"in document&&11>=document.documentMode,B=null,V=null,et=null,$=!1;function K(n,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;$||B==null||B!==Re(h)||(h=B,"selectionStart"in h&&N(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),et&&m(et,h)||(et=h,h=ih(V,"onSelect"),0<h.length&&(s=new go("onSelect","select",null,s,o),n.push({event:s,listeners:h}),s.target=B)))}function Q(n,s){var o={};return o[n.toLowerCase()]=s.toLowerCase(),o["Webkit"+n]="webkit"+s,o["Moz"+n]="moz"+s,o}var Z={animationend:Q("Animation","AnimationEnd"),animationiteration:Q("Animation","AnimationIteration"),animationstart:Q("Animation","AnimationStart"),transitionrun:Q("Transition","TransitionRun"),transitionstart:Q("Transition","TransitionStart"),transitioncancel:Q("Transition","TransitionCancel"),transitionend:Q("Transition","TransitionEnd")},X={},Y={};Rn&&(Y=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function it(n){if(X[n])return X[n];if(!Z[n])return n;var s=Z[n],o;for(o in s)if(s.hasOwnProperty(o)&&o in Y)return X[n]=s[o];return n}var ot=it("animationend"),nt=it("animationiteration"),pt=it("animationstart"),wt=it("transitionrun"),kt=it("transitionstart"),Ot=it("transitioncancel"),At=it("transitionend"),It=new Map,jt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");jt.push("scrollEnd");function Et(n,s){It.set(n,s),Wi(s,[n])}var Ut=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},ee=[],fe=0,Yt=0;function ae(){for(var n=fe,s=Yt=fe=0;s<n;){var o=ee[s];ee[s++]=null;var h=ee[s];ee[s++]=null;var g=ee[s];ee[s++]=null;var b=ee[s];if(ee[s++]=null,h!==null&&g!==null){var T=h.pending;T===null?g.next=g:(g.next=T.next,T.next=g),h.pending=g}b!==0&&bs(o,g,b)}}function Ue(n,s,o,h){ee[fe++]=n,ee[fe++]=s,ee[fe++]=o,ee[fe++]=h,Yt|=h,n.lanes|=h,n=n.alternate,n!==null&&(n.lanes|=h)}function Qn(n,s,o,h){return Ue(n,s,o,h),Ba(n)}function je(n,s){return Ue(n,null,null,s),Ba(n)}function bs(n,s,o){n.lanes|=o;var h=n.alternate;h!==null&&(h.lanes|=o);for(var g=!1,b=n.return;b!==null;)b.childLanes|=o,h=b.alternate,h!==null&&(h.childLanes|=o),b.tag===22&&(n=b.stateNode,n===null||n._visibility&1||(g=!0)),n=b,b=b.return;return n.tag===3?(b=n.stateNode,g&&s!==null&&(g=31-Ft(o),n=b.hiddenUpdates,h=n[g],h===null?n[g]=[s]:h.push(s),s.lane=o|536870912),b):null}function Ba(n){if(50<dc)throw dc=0,Ff=null,Error(i(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var No={};function pw(n,s,o,h){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function xi(n,s,o,h){return new pw(n,s,o,h)}function Md(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Js(n,s){var o=n.alternate;return o===null?(o=xi(n.tag,s,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=s,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,s=n.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Wm(n,s){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,s=o.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function xu(n,s,o,h,g,b){var T=0;if(h=n,typeof n=="function")Md(n)&&(T=1);else if(typeof n=="string")T=v1(n,o,xt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case ut:return n=xi(31,o,s,g),n.elementType=ut,n.lanes=b,n;case E:return Or(o.children,g,b,s);case R:T=8,g|=24;break;case D:return n=xi(12,o,s,g|2),n.elementType=D,n.lanes=b,n;case z:return n=xi(13,o,s,g),n.elementType=z,n.lanes=b,n;case H:return n=xi(19,o,s,g),n.elementType=H,n.lanes=b,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case O:T=10;break t;case k:T=9;break t;case I:T=11;break t;case P:T=14;break t;case rt:T=16,h=null;break t}T=29,o=Error(i(130,n===null?"null":typeof n,"")),h=null}return s=xi(T,o,s,g),s.elementType=n,s.type=h,s.lanes=b,s}function Or(n,s,o,h){return n=xi(7,n,h,s),n.lanes=o,n}function Dd(n,s,o){return n=xi(6,n,null,s),n.lanes=o,n}function Zm(n){var s=xi(18,null,null,0);return s.stateNode=n,s}function Nd(n,s,o){return s=xi(4,n.children!==null?n.children:[],n.key,s),s.lanes=o,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var Jm=new WeakMap;function Pi(n,s){if(typeof n=="object"&&n!==null){var o=Jm.get(n);return o!==void 0?o:(s={value:n,source:s,stack:Ct(s)},Jm.set(n,s),s)}return{value:n,source:s,stack:Ct(s)}}var ko=[],Oo=0,wu=null,Kl=0,Bi=[],Fi=0,Fa=null,vs=1,xs="";function ta(n,s){ko[Oo++]=Kl,ko[Oo++]=wu,wu=n,Kl=s}function tg(n,s,o){Bi[Fi++]=vs,Bi[Fi++]=xs,Bi[Fi++]=Fa,Fa=n;var h=vs;n=xs;var g=32-Ft(h)-1;h&=~(1<<g),o+=1;var b=32-Ft(s)+g;if(30<b){var T=g-g%5;b=(h&(1<<T)-1).toString(32),h>>=T,g-=T,vs=1<<32-Ft(s)+g|o<<g|h,xs=b+n}else vs=1<<b|o<<g|h,xs=n}function kd(n){n.return!==null&&(ta(n,1),tg(n,1,0))}function Od(n){for(;n===wu;)wu=ko[--Oo],ko[Oo]=null,Kl=ko[--Oo],ko[Oo]=null;for(;n===Fa;)Fa=Bi[--Fi],Bi[Fi]=null,xs=Bi[--Fi],Bi[Fi]=null,vs=Bi[--Fi],Bi[Fi]=null}function eg(n,s){Bi[Fi++]=vs,Bi[Fi++]=xs,Bi[Fi++]=Fa,vs=s.id,xs=s.overflow,Fa=n}var Bn=null,Qe=null,xe=!1,Ia=null,Ii=!1,Ld=Error(i(519));function Ua(n){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Vl(Pi(s,n)),Ld}function ng(n){var s=n.stateNode,o=n.type,h=n.memoizedProps;switch(s[$e]=n,s[un]=h,o){case"dialog":ge("cancel",s),ge("close",s);break;case"iframe":case"object":case"embed":ge("load",s);break;case"video":case"audio":for(o=0;o<pc.length;o++)ge(pc[o],s);break;case"source":ge("error",s);break;case"img":case"image":case"link":ge("error",s),ge("load",s);break;case"details":ge("toggle",s);break;case"input":ge("invalid",s),fo(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":ge("invalid",s);break;case"textarea":ge("invalid",s),_r(s,h.value,h.defaultValue,h.children)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||vb(s.textContent,o)?(h.popover!=null&&(ge("beforetoggle",s),ge("toggle",s)),h.onScroll!=null&&ge("scroll",s),h.onScrollEnd!=null&&ge("scrollend",s),h.onClick!=null&&(s.onclick=ri),s=!0):s=!1,s||Ua(n,!0)}function ig(n){for(Bn=n.return;Bn;)switch(Bn.tag){case 5:case 31:case 13:Ii=!1;return;case 27:case 3:Ii=!0;return;default:Bn=Bn.return}}function Lo(n){if(n!==Bn)return!1;if(!xe)return ig(n),xe=!0,!1;var s=n.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Jf(n.type,n.memoizedProps)),o=!o),o&&Qe&&Ua(n),ig(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Qe=Rb(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Qe=Rb(n)}else s===27?(s=Qe,tr(n.type)?(n=sp,sp=null,Qe=n):Qe=s):Qe=Bn?zi(n.stateNode.nextSibling):null;return!0}function Lr(){Qe=Bn=null,xe=!1}function jd(){var n=Ia;return n!==null&&(ui===null?ui=n:ui.push.apply(ui,n),Ia=null),n}function Vl(n){Ia===null?Ia=[n]:Ia.push(n)}var Pd=F(null),jr=null,ea=null;function za(n,s,o){ht(Pd,s._currentValue),s._currentValue=o}function na(n){n._currentValue=Pd.current,J(Pd)}function Bd(n,s,o){for(;n!==null;){var h=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),n===o)break;n=n.return}}function Fd(n,s,o,h){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var b=g.dependencies;if(b!==null){var T=g.child;b=b.firstContext;t:for(;b!==null;){var L=b;b=g;for(var q=0;q<s.length;q++)if(L.context===s[q]){b.lanes|=o,L=b.alternate,L!==null&&(L.lanes|=o),Bd(b.return,o,n),h||(T=null);break t}b=L.next}}else if(g.tag===18){if(T=g.return,T===null)throw Error(i(341));T.lanes|=o,b=T.alternate,b!==null&&(b.lanes|=o),Bd(T,o,n),T=null}else T=g.child;if(T!==null)T.return=g;else for(T=g;T!==null;){if(T===n){T=null;break}if(g=T.sibling,g!==null){g.return=T.return,T=g;break}T=T.return}g=T}}function jo(n,s,o,h){n=null;for(var g=s,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var T=g.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var L=g.type;Yn(g.pendingProps.value,T.value)||(n!==null?n.push(L):n=[L])}}else if(g===Bt.current){if(T=g.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(vc):n=[vc])}g=g.return}n!==null&&Fd(s,n,o,h),s.flags|=262144}function Su(n){for(n=n.firstContext;n!==null;){if(!Yn(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Pr(n){jr=n,ea=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Fn(n){return sg(jr,n)}function Au(n,s){return jr===null&&Pr(n),sg(n,s)}function sg(n,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},ea===null){if(n===null)throw Error(i(308));ea=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else ea=ea.next=s;return o}var mw=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(o,h){n.push(h)}};this.abort=function(){s.aborted=!0,n.forEach(function(o){return o()})}},gw=r.unstable_scheduleCallback,yw=r.unstable_NormalPriority,yn={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Id(){return{controller:new mw,data:new Map,refCount:0}}function $l(n){n.refCount--,n.refCount===0&&gw(yw,function(){n.controller.abort()})}var Xl=null,Ud=0,Po=0,Bo=null;function bw(n,s){if(Xl===null){var o=Xl=[];Ud=0,Po=Gf(),Bo={status:"pending",value:void 0,then:function(h){o.push(h)}}}return Ud++,s.then(ag,ag),s}function ag(){if(--Ud===0&&Xl!==null){Bo!==null&&(Bo.status="fulfilled");var n=Xl;Xl=null,Po=0,Bo=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function vw(n,s){var o=[],h={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return n.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),h}var rg=G.S;G.S=function(n,s){qy=Kn(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&bw(n,s),rg!==null&&rg(n,s)};var Br=F(null);function zd(){var n=Br.current;return n!==null?n:Ve.pooledCache}function Eu(n,s){s===null?ht(Br,Br.current):ht(Br,s.pool)}function og(){var n=zd();return n===null?null:{parent:yn._currentValue,pool:n}}var Fo=Error(i(460)),Hd=Error(i(474)),_u=Error(i(542)),Cu={then:function(){}};function lg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function cg(n,s,o){switch(o=n[o],o===void 0?n.push(s):o!==s&&(s.then(ri,ri),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,hg(n),n;default:if(typeof s.status=="string")s.then(ri,ri);else{if(n=Ve,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=s,n.status="pending",n.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,hg(n),n}throw Ir=s,Fo}}function Fr(n){try{var s=n._init;return s(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Ir=o,Fo):o}}var Ir=null;function ug(){if(Ir===null)throw Error(i(459));var n=Ir;return Ir=null,n}function hg(n){if(n===Fo||n===_u)throw Error(i(483))}var Io=null,Yl=0;function Tu(n){var s=Yl;return Yl+=1,Io===null&&(Io=[]),cg(Io,n,s)}function Ql(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function Ru(n,s){throw s.$$typeof===x?Error(i(525)):(n=Object.prototype.toString.call(s),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function dg(n){function s(tt,W){if(n){var st=tt.deletions;st===null?(tt.deletions=[W],tt.flags|=16):st.push(W)}}function o(tt,W){if(!n)return null;for(;W!==null;)s(tt,W),W=W.sibling;return null}function h(tt){for(var W=new Map;tt!==null;)tt.key!==null?W.set(tt.key,tt):W.set(tt.index,tt),tt=tt.sibling;return W}function g(tt,W){return tt=Js(tt,W),tt.index=0,tt.sibling=null,tt}function b(tt,W,st){return tt.index=st,n?(st=tt.alternate,st!==null?(st=st.index,st<W?(tt.flags|=67108866,W):st):(tt.flags|=67108866,W)):(tt.flags|=1048576,W)}function T(tt){return n&&tt.alternate===null&&(tt.flags|=67108866),tt}function L(tt,W,st,gt){return W===null||W.tag!==6?(W=Dd(st,tt.mode,gt),W.return=tt,W):(W=g(W,st),W.return=tt,W)}function q(tt,W,st,gt){var Qt=st.type;return Qt===E?mt(tt,W,st.props.children,gt,st.key):W!==null&&(W.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===rt&&Fr(Qt)===W.type)?(W=g(W,st.props),Ql(W,st),W.return=tt,W):(W=xu(st.type,st.key,st.props,null,tt.mode,gt),Ql(W,st),W.return=tt,W)}function at(tt,W,st,gt){return W===null||W.tag!==4||W.stateNode.containerInfo!==st.containerInfo||W.stateNode.implementation!==st.implementation?(W=Nd(st,tt.mode,gt),W.return=tt,W):(W=g(W,st.children||[]),W.return=tt,W)}function mt(tt,W,st,gt,Qt){return W===null||W.tag!==7?(W=Or(st,tt.mode,gt,Qt),W.return=tt,W):(W=g(W,st),W.return=tt,W)}function bt(tt,W,st){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Dd(""+W,tt.mode,st),W.return=tt,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case S:return st=xu(W.type,W.key,W.props,null,tt.mode,st),Ql(st,W),st.return=tt,st;case A:return W=Nd(W,tt.mode,st),W.return=tt,W;case rt:return W=Fr(W),bt(tt,W,st)}if(Ht(W)||Mt(W))return W=Or(W,tt.mode,st,null),W.return=tt,W;if(typeof W.then=="function")return bt(tt,Tu(W),st);if(W.$$typeof===O)return bt(tt,Au(tt,W),st);Ru(tt,W)}return null}function lt(tt,W,st,gt){var Qt=W!==null?W.key:null;if(typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint")return Qt!==null?null:L(tt,W,""+st,gt);if(typeof st=="object"&&st!==null){switch(st.$$typeof){case S:return st.key===Qt?q(tt,W,st,gt):null;case A:return st.key===Qt?at(tt,W,st,gt):null;case rt:return st=Fr(st),lt(tt,W,st,gt)}if(Ht(st)||Mt(st))return Qt!==null?null:mt(tt,W,st,gt,null);if(typeof st.then=="function")return lt(tt,W,Tu(st),gt);if(st.$$typeof===O)return lt(tt,W,Au(tt,st),gt);Ru(tt,st)}return null}function ft(tt,W,st,gt,Qt){if(typeof gt=="string"&&gt!==""||typeof gt=="number"||typeof gt=="bigint")return tt=tt.get(st)||null,L(W,tt,""+gt,Qt);if(typeof gt=="object"&&gt!==null){switch(gt.$$typeof){case S:return tt=tt.get(gt.key===null?st:gt.key)||null,q(W,tt,gt,Qt);case A:return tt=tt.get(gt.key===null?st:gt.key)||null,at(W,tt,gt,Qt);case rt:return gt=Fr(gt),ft(tt,W,st,gt,Qt)}if(Ht(gt)||Mt(gt))return tt=tt.get(st)||null,mt(W,tt,gt,Qt,null);if(typeof gt.then=="function")return ft(tt,W,st,Tu(gt),Qt);if(gt.$$typeof===O)return ft(tt,W,st,Au(W,gt),Qt);Ru(W,gt)}return null}function Kt(tt,W,st,gt){for(var Qt=null,Ae=null,$t=W,ce=W=0,be=null;$t!==null&&ce<st.length;ce++){$t.index>ce?(be=$t,$t=null):be=$t.sibling;var Ee=lt(tt,$t,st[ce],gt);if(Ee===null){$t===null&&($t=be);break}n&&$t&&Ee.alternate===null&&s(tt,$t),W=b(Ee,W,ce),Ae===null?Qt=Ee:Ae.sibling=Ee,Ae=Ee,$t=be}if(ce===st.length)return o(tt,$t),xe&&ta(tt,ce),Qt;if($t===null){for(;ce<st.length;ce++)$t=bt(tt,st[ce],gt),$t!==null&&(W=b($t,W,ce),Ae===null?Qt=$t:Ae.sibling=$t,Ae=$t);return xe&&ta(tt,ce),Qt}for($t=h($t);ce<st.length;ce++)be=ft($t,tt,ce,st[ce],gt),be!==null&&(n&&be.alternate!==null&&$t.delete(be.key===null?ce:be.key),W=b(be,W,ce),Ae===null?Qt=be:Ae.sibling=be,Ae=be);return n&&$t.forEach(function(ar){return s(tt,ar)}),xe&&ta(tt,ce),Qt}function Zt(tt,W,st,gt){if(st==null)throw Error(i(151));for(var Qt=null,Ae=null,$t=W,ce=W=0,be=null,Ee=st.next();$t!==null&&!Ee.done;ce++,Ee=st.next()){$t.index>ce?(be=$t,$t=null):be=$t.sibling;var ar=lt(tt,$t,Ee.value,gt);if(ar===null){$t===null&&($t=be);break}n&&$t&&ar.alternate===null&&s(tt,$t),W=b(ar,W,ce),Ae===null?Qt=ar:Ae.sibling=ar,Ae=ar,$t=be}if(Ee.done)return o(tt,$t),xe&&ta(tt,ce),Qt;if($t===null){for(;!Ee.done;ce++,Ee=st.next())Ee=bt(tt,Ee.value,gt),Ee!==null&&(W=b(Ee,W,ce),Ae===null?Qt=Ee:Ae.sibling=Ee,Ae=Ee);return xe&&ta(tt,ce),Qt}for($t=h($t);!Ee.done;ce++,Ee=st.next())Ee=ft($t,tt,ce,Ee.value,gt),Ee!==null&&(n&&Ee.alternate!==null&&$t.delete(Ee.key===null?ce:Ee.key),W=b(Ee,W,ce),Ae===null?Qt=Ee:Ae.sibling=Ee,Ae=Ee);return n&&$t.forEach(function(D1){return s(tt,D1)}),xe&&ta(tt,ce),Qt}function qe(tt,W,st,gt){if(typeof st=="object"&&st!==null&&st.type===E&&st.key===null&&(st=st.props.children),typeof st=="object"&&st!==null){switch(st.$$typeof){case S:t:{for(var Qt=st.key;W!==null;){if(W.key===Qt){if(Qt=st.type,Qt===E){if(W.tag===7){o(tt,W.sibling),gt=g(W,st.props.children),gt.return=tt,tt=gt;break t}}else if(W.elementType===Qt||typeof Qt=="object"&&Qt!==null&&Qt.$$typeof===rt&&Fr(Qt)===W.type){o(tt,W.sibling),gt=g(W,st.props),Ql(gt,st),gt.return=tt,tt=gt;break t}o(tt,W);break}else s(tt,W);W=W.sibling}st.type===E?(gt=Or(st.props.children,tt.mode,gt,st.key),gt.return=tt,tt=gt):(gt=xu(st.type,st.key,st.props,null,tt.mode,gt),Ql(gt,st),gt.return=tt,tt=gt)}return T(tt);case A:t:{for(Qt=st.key;W!==null;){if(W.key===Qt)if(W.tag===4&&W.stateNode.containerInfo===st.containerInfo&&W.stateNode.implementation===st.implementation){o(tt,W.sibling),gt=g(W,st.children||[]),gt.return=tt,tt=gt;break t}else{o(tt,W);break}else s(tt,W);W=W.sibling}gt=Nd(st,tt.mode,gt),gt.return=tt,tt=gt}return T(tt);case rt:return st=Fr(st),qe(tt,W,st,gt)}if(Ht(st))return Kt(tt,W,st,gt);if(Mt(st)){if(Qt=Mt(st),typeof Qt!="function")throw Error(i(150));return st=Qt.call(st),Zt(tt,W,st,gt)}if(typeof st.then=="function")return qe(tt,W,Tu(st),gt);if(st.$$typeof===O)return qe(tt,W,Au(tt,st),gt);Ru(tt,st)}return typeof st=="string"&&st!==""||typeof st=="number"||typeof st=="bigint"?(st=""+st,W!==null&&W.tag===6?(o(tt,W.sibling),gt=g(W,st),gt.return=tt,tt=gt):(o(tt,W),gt=Dd(st,tt.mode,gt),gt.return=tt,tt=gt),T(tt)):o(tt,W)}return function(tt,W,st,gt){try{Yl=0;var Qt=qe(tt,W,st,gt);return Io=null,Qt}catch($t){if($t===Fo||$t===_u)throw $t;var Ae=xi(29,$t,null,tt.mode);return Ae.lanes=gt,Ae.return=tt,Ae}}}var Ur=dg(!0),fg=dg(!1),Ha=!1;function qd(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gd(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function qa(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ga(n,s,o){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,(Me&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=Ba(n),bs(n,null,o),s}return Ue(n,h,s,o),Ba(n)}function Wl(n,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ke(n,o)}}function Kd(n,s){var o=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};b===null?g=b=T:b=b.next=T,o=o.next}while(o!==null);b===null?g=b=s:b=b.next=s}else g=b=s;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:h.shared,callbacks:h.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=s:n.next=s,o.lastBaseUpdate=s}var Vd=!1;function Zl(){if(Vd){var n=Bo;if(n!==null)throw n}}function Jl(n,s,o,h){Vd=!1;var g=n.updateQueue;Ha=!1;var b=g.firstBaseUpdate,T=g.lastBaseUpdate,L=g.shared.pending;if(L!==null){g.shared.pending=null;var q=L,at=q.next;q.next=null,T===null?b=at:T.next=at,T=q;var mt=n.alternate;mt!==null&&(mt=mt.updateQueue,L=mt.lastBaseUpdate,L!==T&&(L===null?mt.firstBaseUpdate=at:L.next=at,mt.lastBaseUpdate=q))}if(b!==null){var bt=g.baseState;T=0,mt=at=q=null,L=b;do{var lt=L.lane&-536870913,ft=lt!==L.lane;if(ft?(ye&lt)===lt:(h&lt)===lt){lt!==0&&lt===Po&&(Vd=!0),mt!==null&&(mt=mt.next={lane:0,tag:L.tag,payload:L.payload,callback:null,next:null});t:{var Kt=n,Zt=L;lt=s;var qe=o;switch(Zt.tag){case 1:if(Kt=Zt.payload,typeof Kt=="function"){bt=Kt.call(qe,bt,lt);break t}bt=Kt;break t;case 3:Kt.flags=Kt.flags&-65537|128;case 0:if(Kt=Zt.payload,lt=typeof Kt=="function"?Kt.call(qe,bt,lt):Kt,lt==null)break t;bt=y({},bt,lt);break t;case 2:Ha=!0}}lt=L.callback,lt!==null&&(n.flags|=64,ft&&(n.flags|=8192),ft=g.callbacks,ft===null?g.callbacks=[lt]:ft.push(lt))}else ft={lane:lt,tag:L.tag,payload:L.payload,callback:L.callback,next:null},mt===null?(at=mt=ft,q=bt):mt=mt.next=ft,T|=lt;if(L=L.next,L===null){if(L=g.shared.pending,L===null)break;ft=L,L=ft.next,ft.next=null,g.lastBaseUpdate=ft,g.shared.pending=null}}while(!0);mt===null&&(q=bt),g.baseState=q,g.firstBaseUpdate=at,g.lastBaseUpdate=mt,b===null&&(g.shared.lanes=0),Ya|=T,n.lanes=T,n.memoizedState=bt}}function pg(n,s){if(typeof n!="function")throw Error(i(191,n));n.call(s)}function mg(n,s){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)pg(o[n],s)}var Uo=F(null),Mu=F(0);function gg(n,s){n=ha,ht(Mu,n),ht(Uo,s),ha=n|s.baseLanes}function $d(){ht(Mu,ha),ht(Uo,Uo.current)}function Xd(){ha=Mu.current,J(Uo),J(Mu)}var wi=F(null),Ui=null;function Ka(n){var s=n.alternate;ht(dn,dn.current&1),ht(wi,n),Ui===null&&(s===null||Uo.current!==null||s.memoizedState!==null)&&(Ui=n)}function Yd(n){ht(dn,dn.current),ht(wi,n),Ui===null&&(Ui=n)}function yg(n){n.tag===22?(ht(dn,dn.current),ht(wi,n),Ui===null&&(Ui=n)):Va()}function Va(){ht(dn,dn.current),ht(wi,wi.current)}function Si(n){J(wi),Ui===n&&(Ui=null),J(dn)}var dn=F(0);function Du(n){for(var s=n;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||np(o)||ip(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var ia=0,le=null,ze=null,bn=null,Nu=!1,zo=!1,zr=!1,ku=0,tc=0,Ho=null,xw=0;function an(){throw Error(i(321))}function Qd(n,s){if(s===null)return!1;for(var o=0;o<s.length&&o<n.length;o++)if(!Yn(n[o],s[o]))return!1;return!0}function Wd(n,s,o,h,g,b){return ia=b,le=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,G.H=n===null||n.memoizedState===null?ty:ff,zr=!1,b=o(h,g),zr=!1,zo&&(b=vg(s,o,h,g)),bg(n),b}function bg(n){G.H=ic;var s=ze!==null&&ze.next!==null;if(ia=0,bn=ze=le=null,Nu=!1,tc=0,Ho=null,s)throw Error(i(300));n===null||vn||(n=n.dependencies,n!==null&&Su(n)&&(vn=!0))}function vg(n,s,o,h){le=n;var g=0;do{if(zo&&(Ho=null),tc=0,zo=!1,25<=g)throw Error(i(301));if(g+=1,bn=ze=null,n.updateQueue!=null){var b=n.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}G.H=ey,b=s(o,h)}while(zo);return b}function ww(){var n=G.H,s=n.useState()[0];return s=typeof s.then=="function"?ec(s):s,n=n.useState()[0],(ze!==null?ze.memoizedState:null)!==n&&(le.flags|=1024),s}function Zd(){var n=ku!==0;return ku=0,n}function Jd(n,s,o){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~o}function tf(n){if(Nu){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}Nu=!1}ia=0,bn=ze=le=null,zo=!1,tc=ku=0,Ho=null}function ei(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return bn===null?le.memoizedState=bn=n:bn=bn.next=n,bn}function fn(){if(ze===null){var n=le.alternate;n=n!==null?n.memoizedState:null}else n=ze.next;var s=bn===null?le.memoizedState:bn.next;if(s!==null)bn=s,ze=n;else{if(n===null)throw le.alternate===null?Error(i(467)):Error(i(310));ze=n,n={memoizedState:ze.memoizedState,baseState:ze.baseState,baseQueue:ze.baseQueue,queue:ze.queue,next:null},bn===null?le.memoizedState=bn=n:bn=bn.next=n}return bn}function Ou(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function ec(n){var s=tc;return tc+=1,Ho===null&&(Ho=[]),n=cg(Ho,n,s),s=le,(bn===null?s.memoizedState:bn.next)===null&&(s=s.alternate,G.H=s===null||s.memoizedState===null?ty:ff),n}function Lu(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return ec(n);if(n.$$typeof===O)return Fn(n)}throw Error(i(438,String(n)))}function ef(n){var s=null,o=le.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=le.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Ou(),le.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(n),h=0;h<n;h++)o[h]=St;return s.index++,o}function sa(n,s){return typeof s=="function"?s(n):s}function ju(n){var s=fn();return nf(s,ze,n)}function nf(n,s,o){var h=n.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=o;var g=n.baseQueue,b=h.pending;if(b!==null){if(g!==null){var T=g.next;g.next=b.next,b.next=T}s.baseQueue=g=b,h.pending=null}if(b=n.baseState,g===null)n.memoizedState=b;else{s=g.next;var L=T=null,q=null,at=s,mt=!1;do{var bt=at.lane&-536870913;if(bt!==at.lane?(ye&bt)===bt:(ia&bt)===bt){var lt=at.revertLane;if(lt===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),bt===Po&&(mt=!0);else if((ia&lt)===lt){at=at.next,lt===Po&&(mt=!0);continue}else bt={lane:0,revertLane:at.revertLane,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},q===null?(L=q=bt,T=b):q=q.next=bt,le.lanes|=lt,Ya|=lt;bt=at.action,zr&&o(b,bt),b=at.hasEagerState?at.eagerState:o(b,bt)}else lt={lane:bt,revertLane:at.revertLane,gesture:at.gesture,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},q===null?(L=q=lt,T=b):q=q.next=lt,le.lanes|=bt,Ya|=bt;at=at.next}while(at!==null&&at!==s);if(q===null?T=b:q.next=L,!Yn(b,n.memoizedState)&&(vn=!0,mt&&(o=Bo,o!==null)))throw o;n.memoizedState=b,n.baseState=T,n.baseQueue=q,h.lastRenderedState=b}return g===null&&(h.lanes=0),[n.memoizedState,h.dispatch]}function sf(n){var s=fn(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var h=o.dispatch,g=o.pending,b=s.memoizedState;if(g!==null){o.pending=null;var T=g=g.next;do b=n(b,T.action),T=T.next;while(T!==g);Yn(b,s.memoizedState)||(vn=!0),s.memoizedState=b,s.baseQueue===null&&(s.baseState=b),o.lastRenderedState=b}return[b,h]}function xg(n,s,o){var h=le,g=fn(),b=xe;if(b){if(o===void 0)throw Error(i(407));o=o()}else o=s();var T=!Yn((ze||g).memoizedState,o);if(T&&(g.memoizedState=o,vn=!0),g=g.queue,of(Ag.bind(null,h,g,n),[n]),g.getSnapshot!==s||T||bn!==null&&bn.memoizedState.tag&1){if(h.flags|=2048,qo(9,{destroy:void 0},Sg.bind(null,h,g,o,s),null),Ve===null)throw Error(i(349));b||(ia&127)!==0||wg(h,s,o)}return o}function wg(n,s,o){n.flags|=16384,n={getSnapshot:s,value:o},s=le.updateQueue,s===null?(s=Ou(),le.updateQueue=s,s.stores=[n]):(o=s.stores,o===null?s.stores=[n]:o.push(n))}function Sg(n,s,o,h){s.value=o,s.getSnapshot=h,Eg(s)&&_g(n)}function Ag(n,s,o){return o(function(){Eg(s)&&_g(n)})}function Eg(n){var s=n.getSnapshot;n=n.value;try{var o=s();return!Yn(n,o)}catch{return!0}}function _g(n){var s=je(n,2);s!==null&&hi(s,n,2)}function af(n){var s=ei();if(typeof n=="function"){var o=n;if(n=o(),zr){jn(!0);try{o()}finally{jn(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:n},s}function Cg(n,s,o,h){return n.baseState=o,nf(n,ze,typeof h=="function"?h:sa)}function Sw(n,s,o,h,g){if(Fu(n))throw Error(i(485));if(n=s.action,n!==null){var b={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){b.listeners.push(T)}};G.T!==null?o(!0):b.isTransition=!1,h(b),o=s.pending,o===null?(b.next=s.pending=b,Tg(s,b)):(b.next=o.next,s.pending=o.next=b)}}function Tg(n,s){var o=s.action,h=s.payload,g=n.state;if(s.isTransition){var b=G.T,T={};G.T=T;try{var L=o(g,h),q=G.S;q!==null&&q(T,L),Rg(n,s,L)}catch(at){rf(n,s,at)}finally{b!==null&&T.types!==null&&(b.types=T.types),G.T=b}}else try{b=o(g,h),Rg(n,s,b)}catch(at){rf(n,s,at)}}function Rg(n,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){Mg(n,s,h)},function(h){return rf(n,s,h)}):Mg(n,s,o)}function Mg(n,s,o){s.status="fulfilled",s.value=o,Dg(s),n.state=o,s=n.pending,s!==null&&(o=s.next,o===s?n.pending=null:(o=o.next,s.next=o,Tg(n,o)))}function rf(n,s,o){var h=n.pending;if(n.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,Dg(s),s=s.next;while(s!==h)}n.action=null}function Dg(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function Ng(n,s){return s}function kg(n,s){if(xe){var o=Ve.formState;if(o!==null){t:{var h=le;if(xe){if(Qe){e:{for(var g=Qe,b=Ii;g.nodeType!==8;){if(!b){g=null;break e}if(g=zi(g.nextSibling),g===null){g=null;break e}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){Qe=zi(g.nextSibling),h=g.data==="F!";break t}}Ua(h)}h=!1}h&&(s=o[0])}}return o=ei(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ng,lastRenderedState:s},o.queue=h,o=Wg.bind(null,le,h),h.dispatch=o,h=af(!1),b=df.bind(null,le,!1,h.queue),h=ei(),g={state:s,dispatch:null,action:n,pending:null},h.queue=g,o=Sw.bind(null,le,g,b,o),g.dispatch=o,h.memoizedState=n,[s,o,!1]}function Og(n){var s=fn();return Lg(s,ze,n)}function Lg(n,s,o){if(s=nf(n,s,Ng)[0],n=ju(sa)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=ec(s)}catch(T){throw T===Fo?_u:T}else h=s;s=fn();var g=s.queue,b=g.dispatch;return o!==s.memoizedState&&(le.flags|=2048,qo(9,{destroy:void 0},Aw.bind(null,g,o),null)),[h,b,n]}function Aw(n,s){n.action=s}function jg(n){var s=fn(),o=ze;if(o!==null)return Lg(s,o,n);fn(),s=s.memoizedState,o=fn();var h=o.queue.dispatch;return o.memoizedState=n,[s,h,!1]}function qo(n,s,o,h){return n={tag:n,create:o,deps:h,inst:s,next:null},s=le.updateQueue,s===null&&(s=Ou(),le.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=n.next=n:(h=o.next,o.next=n,n.next=h,s.lastEffect=n),n}function Pg(){return fn().memoizedState}function Pu(n,s,o,h){var g=ei();le.flags|=n,g.memoizedState=qo(1|s,{destroy:void 0},o,h===void 0?null:h)}function Bu(n,s,o,h){var g=fn();h=h===void 0?null:h;var b=g.memoizedState.inst;ze!==null&&h!==null&&Qd(h,ze.memoizedState.deps)?g.memoizedState=qo(s,b,o,h):(le.flags|=n,g.memoizedState=qo(1|s,b,o,h))}function Bg(n,s){Pu(8390656,8,n,s)}function of(n,s){Bu(2048,8,n,s)}function Ew(n){le.flags|=4;var s=le.updateQueue;if(s===null)s=Ou(),le.updateQueue=s,s.events=[n];else{var o=s.events;o===null?s.events=[n]:o.push(n)}}function Fg(n){var s=fn().memoizedState;return Ew({ref:s,nextImpl:n}),function(){if((Me&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function Ig(n,s){return Bu(4,2,n,s)}function Ug(n,s){return Bu(4,4,n,s)}function zg(n,s){if(typeof s=="function"){n=n();var o=s(n);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function Hg(n,s,o){o=o!=null?o.concat([n]):null,Bu(4,4,zg.bind(null,s,n),o)}function lf(){}function qg(n,s){var o=fn();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&Qd(s,h[1])?h[0]:(o.memoizedState=[n,s],n)}function Gg(n,s){var o=fn();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&Qd(s,h[1]))return h[0];if(h=n(),zr){jn(!0);try{n()}finally{jn(!1)}}return o.memoizedState=[h,s],h}function cf(n,s,o){return o===void 0||(ia&1073741824)!==0&&(ye&261930)===0?n.memoizedState=s:(n.memoizedState=o,n=Ky(),le.lanes|=n,Ya|=n,o)}function Kg(n,s,o,h){return Yn(o,s)?o:Uo.current!==null?(n=cf(n,o,h),Yn(n,s)||(vn=!0),n):(ia&42)===0||(ia&1073741824)!==0&&(ye&261930)===0?(vn=!0,n.memoizedState=o):(n=Ky(),le.lanes|=n,Ya|=n,s)}function Vg(n,s,o,h,g){var b=ct.p;ct.p=b!==0&&8>b?b:8;var T=G.T,L={};G.T=L,df(n,!1,s,o);try{var q=g(),at=G.S;if(at!==null&&at(L,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var mt=vw(q,h);nc(n,s,mt,_i(n))}else nc(n,s,h,_i(n))}catch(bt){nc(n,s,{then:function(){},status:"rejected",reason:bt},_i())}finally{ct.p=b,T!==null&&L.types!==null&&(T.types=L.types),G.T=T}}function _w(){}function uf(n,s,o,h){if(n.tag!==5)throw Error(i(476));var g=$g(n).queue;Vg(n,g,s,yt,o===null?_w:function(){return Xg(n),o(h)})}function $g(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:yt,baseState:yt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:yt},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:sa,lastRenderedState:o},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function Xg(n){var s=$g(n);s.next===null&&(s=n.alternate.memoizedState),nc(n,s.next.queue,{},_i())}function hf(){return Fn(vc)}function Yg(){return fn().memoizedState}function Qg(){return fn().memoizedState}function Cw(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var o=_i();n=qa(o);var h=Ga(s,n,o);h!==null&&(hi(h,s,o),Wl(h,s,o)),s={cache:Id()},n.payload=s;return}s=s.return}}function Tw(n,s,o){var h=_i();o={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Fu(n)?Zg(s,o):(o=Qn(n,s,o,h),o!==null&&(hi(o,n,h),Jg(o,s,h)))}function Wg(n,s,o){var h=_i();nc(n,s,o,h)}function nc(n,s,o,h){var g={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Fu(n))Zg(s,g);else{var b=n.alternate;if(n.lanes===0&&(b===null||b.lanes===0)&&(b=s.lastRenderedReducer,b!==null))try{var T=s.lastRenderedState,L=b(T,o);if(g.hasEagerState=!0,g.eagerState=L,Yn(L,T))return Ue(n,s,g,0),Ve===null&&ae(),!1}catch{}if(o=Qn(n,s,g,h),o!==null)return hi(o,n,h),Jg(o,s,h),!0}return!1}function df(n,s,o,h){if(h={lane:2,revertLane:Gf(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Fu(n)){if(s)throw Error(i(479))}else s=Qn(n,o,h,2),s!==null&&hi(s,n,2)}function Fu(n){var s=n.alternate;return n===le||s!==null&&s===le}function Zg(n,s){zo=Nu=!0;var o=n.pending;o===null?s.next=s:(s.next=o.next,o.next=s),n.pending=s}function Jg(n,s,o){if((o&4194048)!==0){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ke(n,o)}}var ic={readContext:Fn,use:Lu,useCallback:an,useContext:an,useEffect:an,useImperativeHandle:an,useLayoutEffect:an,useInsertionEffect:an,useMemo:an,useReducer:an,useRef:an,useState:an,useDebugValue:an,useDeferredValue:an,useTransition:an,useSyncExternalStore:an,useId:an,useHostTransitionStatus:an,useFormState:an,useActionState:an,useOptimistic:an,useMemoCache:an,useCacheRefresh:an};ic.useEffectEvent=an;var ty={readContext:Fn,use:Lu,useCallback:function(n,s){return ei().memoizedState=[n,s===void 0?null:s],n},useContext:Fn,useEffect:Bg,useImperativeHandle:function(n,s,o){o=o!=null?o.concat([n]):null,Pu(4194308,4,zg.bind(null,s,n),o)},useLayoutEffect:function(n,s){return Pu(4194308,4,n,s)},useInsertionEffect:function(n,s){Pu(4,2,n,s)},useMemo:function(n,s){var o=ei();s=s===void 0?null:s;var h=n();if(zr){jn(!0);try{n()}finally{jn(!1)}}return o.memoizedState=[h,s],h},useReducer:function(n,s,o){var h=ei();if(o!==void 0){var g=o(s);if(zr){jn(!0);try{o(s)}finally{jn(!1)}}}else g=s;return h.memoizedState=h.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},h.queue=n,n=n.dispatch=Tw.bind(null,le,n),[h.memoizedState,n]},useRef:function(n){var s=ei();return n={current:n},s.memoizedState=n},useState:function(n){n=af(n);var s=n.queue,o=Wg.bind(null,le,s);return s.dispatch=o,[n.memoizedState,o]},useDebugValue:lf,useDeferredValue:function(n,s){var o=ei();return cf(o,n,s)},useTransition:function(){var n=af(!1);return n=Vg.bind(null,le,n.queue,!0,!1),ei().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,o){var h=le,g=ei();if(xe){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),Ve===null)throw Error(i(349));(ye&127)!==0||wg(h,s,o)}g.memoizedState=o;var b={value:o,getSnapshot:s};return g.queue=b,Bg(Ag.bind(null,h,b,n),[n]),h.flags|=2048,qo(9,{destroy:void 0},Sg.bind(null,h,b,o,s),null),o},useId:function(){var n=ei(),s=Ve.identifierPrefix;if(xe){var o=xs,h=vs;o=(h&~(1<<32-Ft(h)-1)).toString(32)+o,s="_"+s+"R_"+o,o=ku++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=xw++,s="_"+s+"r_"+o.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:hf,useFormState:kg,useActionState:kg,useOptimistic:function(n){var s=ei();s.memoizedState=s.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=df.bind(null,le,!0,o),o.dispatch=s,[n,s]},useMemoCache:ef,useCacheRefresh:function(){return ei().memoizedState=Cw.bind(null,le)},useEffectEvent:function(n){var s=ei(),o={impl:n};return s.memoizedState=o,function(){if((Me&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},ff={readContext:Fn,use:Lu,useCallback:qg,useContext:Fn,useEffect:of,useImperativeHandle:Hg,useInsertionEffect:Ig,useLayoutEffect:Ug,useMemo:Gg,useReducer:ju,useRef:Pg,useState:function(){return ju(sa)},useDebugValue:lf,useDeferredValue:function(n,s){var o=fn();return Kg(o,ze.memoizedState,n,s)},useTransition:function(){var n=ju(sa)[0],s=fn().memoizedState;return[typeof n=="boolean"?n:ec(n),s]},useSyncExternalStore:xg,useId:Yg,useHostTransitionStatus:hf,useFormState:Og,useActionState:Og,useOptimistic:function(n,s){var o=fn();return Cg(o,ze,n,s)},useMemoCache:ef,useCacheRefresh:Qg};ff.useEffectEvent=Fg;var ey={readContext:Fn,use:Lu,useCallback:qg,useContext:Fn,useEffect:of,useImperativeHandle:Hg,useInsertionEffect:Ig,useLayoutEffect:Ug,useMemo:Gg,useReducer:sf,useRef:Pg,useState:function(){return sf(sa)},useDebugValue:lf,useDeferredValue:function(n,s){var o=fn();return ze===null?cf(o,n,s):Kg(o,ze.memoizedState,n,s)},useTransition:function(){var n=sf(sa)[0],s=fn().memoizedState;return[typeof n=="boolean"?n:ec(n),s]},useSyncExternalStore:xg,useId:Yg,useHostTransitionStatus:hf,useFormState:jg,useActionState:jg,useOptimistic:function(n,s){var o=fn();return ze!==null?Cg(o,ze,n,s):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:ef,useCacheRefresh:Qg};ey.useEffectEvent=Fg;function pf(n,s,o,h){s=n.memoizedState,o=o(h,s),o=o==null?s:y({},s,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var mf={enqueueSetState:function(n,s,o){n=n._reactInternals;var h=_i(),g=qa(h);g.payload=s,o!=null&&(g.callback=o),s=Ga(n,g,h),s!==null&&(hi(s,n,h),Wl(s,n,h))},enqueueReplaceState:function(n,s,o){n=n._reactInternals;var h=_i(),g=qa(h);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=Ga(n,g,h),s!==null&&(hi(s,n,h),Wl(s,n,h))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var o=_i(),h=qa(o);h.tag=2,s!=null&&(h.callback=s),s=Ga(n,h,o),s!==null&&(hi(s,n,o),Wl(s,n,o))}};function ny(n,s,o,h,g,b,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,b,T):s.prototype&&s.prototype.isPureReactComponent?!m(o,h)||!m(g,b):!0}function iy(n,s,o,h){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==n&&mf.enqueueReplaceState(s,s.state,null)}function Hr(n,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(n=n.defaultProps){o===s&&(o=y({},o));for(var g in n)o[g]===void 0&&(o[g]=n[g])}return o}function sy(n){Ut(n)}function ay(n){console.error(n)}function ry(n){Ut(n)}function Iu(n,s){try{var o=n.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function oy(n,s,o){try{var h=n.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function gf(n,s,o){return o=qa(o),o.tag=3,o.payload={element:null},o.callback=function(){Iu(n,s)},o}function ly(n){return n=qa(n),n.tag=3,n}function cy(n,s,o,h){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var b=h.value;n.payload=function(){return g(b)},n.callback=function(){oy(s,o,h)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){oy(s,o,h),typeof g!="function"&&(Qa===null?Qa=new Set([this]):Qa.add(this));var L=h.stack;this.componentDidCatch(h.value,{componentStack:L!==null?L:""})})}function Rw(n,s,o,h,g){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&jo(s,o,g,!0),o=wi.current,o!==null){switch(o.tag){case 31:case 13:return Ui===null?Wu():o.alternate===null&&rn===0&&(rn=3),o.flags&=-257,o.flags|=65536,o.lanes=g,h===Cu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),zf(n,h,g)),!1;case 22:return o.flags|=65536,h===Cu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),zf(n,h,g)),!1}throw Error(i(435,o.tag))}return zf(n,h,g),Wu(),!1}if(xe)return s=wi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==Ld&&(n=Error(i(422),{cause:h}),Vl(Pi(n,o)))):(h!==Ld&&(s=Error(i(423),{cause:h}),Vl(Pi(s,o))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,h=Pi(h,o),g=gf(n.stateNode,h,g),Kd(n,g),rn!==4&&(rn=2)),!1;var b=Error(i(520),{cause:h});if(b=Pi(b,o),hc===null?hc=[b]:hc.push(b),rn!==4&&(rn=2),s===null)return!0;h=Pi(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,n=g&-g,o.lanes|=n,n=gf(o.stateNode,h,n),Kd(o,n),!1;case 1:if(s=o.type,b=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Qa===null||!Qa.has(b))))return o.flags|=65536,g&=-g,o.lanes|=g,g=ly(g),cy(g,n,o,h),Kd(o,g),!1}o=o.return}while(o!==null);return!1}var yf=Error(i(461)),vn=!1;function In(n,s,o,h){s.child=n===null?fg(s,null,o,h):Ur(s,n.child,o,h)}function uy(n,s,o,h,g){o=o.render;var b=s.ref;if("ref"in h){var T={};for(var L in h)L!=="ref"&&(T[L]=h[L])}else T=h;return Pr(s),h=Wd(n,s,o,T,b,g),L=Zd(),n!==null&&!vn?(Jd(n,s,g),aa(n,s,g)):(xe&&L&&kd(s),s.flags|=1,In(n,s,h,g),s.child)}function hy(n,s,o,h,g){if(n===null){var b=o.type;return typeof b=="function"&&!Md(b)&&b.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=b,dy(n,s,b,h,g)):(n=xu(o.type,null,h,s,s.mode,g),n.ref=s.ref,n.return=s,s.child=n)}if(b=n.child,!_f(n,g)){var T=b.memoizedProps;if(o=o.compare,o=o!==null?o:m,o(T,h)&&n.ref===s.ref)return aa(n,s,g)}return s.flags|=1,n=Js(b,h),n.ref=s.ref,n.return=s,s.child=n}function dy(n,s,o,h,g){if(n!==null){var b=n.memoizedProps;if(m(b,h)&&n.ref===s.ref)if(vn=!1,s.pendingProps=h=b,_f(n,g))(n.flags&131072)!==0&&(vn=!0);else return s.lanes=n.lanes,aa(n,s,g)}return bf(n,s,o,h,g)}function fy(n,s,o,h){var g=h.children,b=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(b=b!==null?b.baseLanes|o:o,n!==null){for(h=s.child=n.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~b}else h=0,s.child=null;return py(n,s,b,o,h)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&Eu(s,b!==null?b.cachePool:null),b!==null?gg(s,b):$d(),yg(s);else return h=s.lanes=536870912,py(n,s,b!==null?b.baseLanes|o:o,o,h)}else b!==null?(Eu(s,b.cachePool),gg(s,b),Va(),s.memoizedState=null):(n!==null&&Eu(s,null),$d(),Va());return In(n,s,g,o),s.child}function sc(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function py(n,s,o,h,g){var b=zd();return b=b===null?null:{parent:yn._currentValue,pool:b},s.memoizedState={baseLanes:o,cachePool:b},n!==null&&Eu(s,null),$d(),yg(s),n!==null&&jo(n,s,h,!0),s.childLanes=g,null}function Uu(n,s){return s=Hu({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function my(n,s,o){return Ur(s,n.child,null,o),n=Uu(s,s.pendingProps),n.flags|=2,Si(s),s.memoizedState=null,n}function Mw(n,s,o){var h=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(xe){if(h.mode==="hidden")return n=Uu(s,h),s.lanes=536870912,sc(null,n);if(Yd(s),(n=Qe)?(n=Tb(n,Ii),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Fa!==null?{id:vs,overflow:xs}:null,retryLane:536870912,hydrationErrors:null},o=Zm(n),o.return=s,s.child=o,Bn=s,Qe=null)):n=null,n===null)throw Ua(s);return s.lanes=536870912,null}return Uu(s,h)}var b=n.memoizedState;if(b!==null){var T=b.dehydrated;if(Yd(s),g)if(s.flags&256)s.flags&=-257,s=my(n,s,o);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(i(558));else if(vn||jo(n,s,o,!1),g=(o&n.childLanes)!==0,vn||g){if(h=Ve,h!==null&&(T=cn(h,o),T!==0&&T!==b.retryLane))throw b.retryLane=T,je(n,T),hi(h,n,T),yf;Wu(),s=my(n,s,o)}else n=b.treeContext,Qe=zi(T.nextSibling),Bn=s,xe=!0,Ia=null,Ii=!1,n!==null&&eg(s,n),s=Uu(s,h),s.flags|=4096;return s}return n=Js(n.child,{mode:h.mode,children:h.children}),n.ref=s.ref,s.child=n,n.return=s,n}function zu(n,s){var o=s.ref;if(o===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(s.flags|=4194816)}}function bf(n,s,o,h,g){return Pr(s),o=Wd(n,s,o,h,void 0,g),h=Zd(),n!==null&&!vn?(Jd(n,s,g),aa(n,s,g)):(xe&&h&&kd(s),s.flags|=1,In(n,s,o,g),s.child)}function gy(n,s,o,h,g,b){return Pr(s),s.updateQueue=null,o=vg(s,h,o,g),bg(n),h=Zd(),n!==null&&!vn?(Jd(n,s,b),aa(n,s,b)):(xe&&h&&kd(s),s.flags|=1,In(n,s,o,b),s.child)}function yy(n,s,o,h,g){if(Pr(s),s.stateNode===null){var b=No,T=o.contextType;typeof T=="object"&&T!==null&&(b=Fn(T)),b=new o(h,b),s.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=mf,s.stateNode=b,b._reactInternals=s,b=s.stateNode,b.props=h,b.state=s.memoizedState,b.refs={},qd(s),T=o.contextType,b.context=typeof T=="object"&&T!==null?Fn(T):No,b.state=s.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(pf(s,o,T,h),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(T=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),T!==b.state&&mf.enqueueReplaceState(b,b.state,null),Jl(s,h,b,g),Zl(),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(n===null){b=s.stateNode;var L=s.memoizedProps,q=Hr(o,L);b.props=q;var at=b.context,mt=o.contextType;T=No,typeof mt=="object"&&mt!==null&&(T=Fn(mt));var bt=o.getDerivedStateFromProps;mt=typeof bt=="function"||typeof b.getSnapshotBeforeUpdate=="function",L=s.pendingProps!==L,mt||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(L||at!==T)&&iy(s,b,h,T),Ha=!1;var lt=s.memoizedState;b.state=lt,Jl(s,h,b,g),Zl(),at=s.memoizedState,L||lt!==at||Ha?(typeof bt=="function"&&(pf(s,o,bt,h),at=s.memoizedState),(q=Ha||ny(s,o,q,h,lt,at,T))?(mt||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=at),b.props=h,b.state=at,b.context=T,h=q):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{b=s.stateNode,Gd(n,s),T=s.memoizedProps,mt=Hr(o,T),b.props=mt,bt=s.pendingProps,lt=b.context,at=o.contextType,q=No,typeof at=="object"&&at!==null&&(q=Fn(at)),L=o.getDerivedStateFromProps,(at=typeof L=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(T!==bt||lt!==q)&&iy(s,b,h,q),Ha=!1,lt=s.memoizedState,b.state=lt,Jl(s,h,b,g),Zl();var ft=s.memoizedState;T!==bt||lt!==ft||Ha||n!==null&&n.dependencies!==null&&Su(n.dependencies)?(typeof L=="function"&&(pf(s,o,L,h),ft=s.memoizedState),(mt=Ha||ny(s,o,mt,h,lt,ft,q)||n!==null&&n.dependencies!==null&&Su(n.dependencies))?(at||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,ft,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,ft,q)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=ft),b.props=h,b.state=ft,b.context=q,h=mt):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),h=!1)}return b=h,zu(n,s),h=(s.flags&128)!==0,b||h?(b=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:b.render(),s.flags|=1,n!==null&&h?(s.child=Ur(s,n.child,null,g),s.child=Ur(s,null,o,g)):In(n,s,o,g),s.memoizedState=b.state,n=s.child):n=aa(n,s,g),n}function by(n,s,o,h){return Lr(),s.flags|=256,In(n,s,o,h),s.child}var vf={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xf(n){return{baseLanes:n,cachePool:og()}}function wf(n,s,o){return n=n!==null?n.childLanes&~o:0,s&&(n|=Ei),n}function vy(n,s,o){var h=s.pendingProps,g=!1,b=(s.flags&128)!==0,T;if((T=b)||(T=n!==null&&n.memoizedState===null?!1:(dn.current&2)!==0),T&&(g=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,n===null){if(xe){if(g?Ka(s):Va(),(n=Qe)?(n=Tb(n,Ii),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Fa!==null?{id:vs,overflow:xs}:null,retryLane:536870912,hydrationErrors:null},o=Zm(n),o.return=s,s.child=o,Bn=s,Qe=null)):n=null,n===null)throw Ua(s);return ip(n)?s.lanes=32:s.lanes=536870912,null}var L=h.children;return h=h.fallback,g?(Va(),g=s.mode,L=Hu({mode:"hidden",children:L},g),h=Or(h,g,o,null),L.return=s,h.return=s,L.sibling=h,s.child=L,h=s.child,h.memoizedState=xf(o),h.childLanes=wf(n,T,o),s.memoizedState=vf,sc(null,h)):(Ka(s),Sf(s,L))}var q=n.memoizedState;if(q!==null&&(L=q.dehydrated,L!==null)){if(b)s.flags&256?(Ka(s),s.flags&=-257,s=Af(n,s,o)):s.memoizedState!==null?(Va(),s.child=n.child,s.flags|=128,s=null):(Va(),L=h.fallback,g=s.mode,h=Hu({mode:"visible",children:h.children},g),L=Or(L,g,o,null),L.flags|=2,h.return=s,L.return=s,h.sibling=L,s.child=h,Ur(s,n.child,null,o),h=s.child,h.memoizedState=xf(o),h.childLanes=wf(n,T,o),s.memoizedState=vf,s=sc(null,h));else if(Ka(s),ip(L)){if(T=L.nextSibling&&L.nextSibling.dataset,T)var at=T.dgst;T=at,h=Error(i(419)),h.stack="",h.digest=T,Vl({value:h,source:null,stack:null}),s=Af(n,s,o)}else if(vn||jo(n,s,o,!1),T=(o&n.childLanes)!==0,vn||T){if(T=Ve,T!==null&&(h=cn(T,o),h!==0&&h!==q.retryLane))throw q.retryLane=h,je(n,h),hi(T,n,h),yf;np(L)||Wu(),s=Af(n,s,o)}else np(L)?(s.flags|=192,s.child=n.child,s=null):(n=q.treeContext,Qe=zi(L.nextSibling),Bn=s,xe=!0,Ia=null,Ii=!1,n!==null&&eg(s,n),s=Sf(s,h.children),s.flags|=4096);return s}return g?(Va(),L=h.fallback,g=s.mode,q=n.child,at=q.sibling,h=Js(q,{mode:"hidden",children:h.children}),h.subtreeFlags=q.subtreeFlags&65011712,at!==null?L=Js(at,L):(L=Or(L,g,o,null),L.flags|=2),L.return=s,h.return=s,h.sibling=L,s.child=h,sc(null,h),h=s.child,L=n.child.memoizedState,L===null?L=xf(o):(g=L.cachePool,g!==null?(q=yn._currentValue,g=g.parent!==q?{parent:q,pool:q}:g):g=og(),L={baseLanes:L.baseLanes|o,cachePool:g}),h.memoizedState=L,h.childLanes=wf(n,T,o),s.memoizedState=vf,sc(n.child,h)):(Ka(s),o=n.child,n=o.sibling,o=Js(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,n!==null&&(T=s.deletions,T===null?(s.deletions=[n],s.flags|=16):T.push(n)),s.child=o,s.memoizedState=null,o)}function Sf(n,s){return s=Hu({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function Hu(n,s){return n=xi(22,n,null,s),n.lanes=0,n}function Af(n,s,o){return Ur(s,n.child,null,o),n=Sf(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function xy(n,s,o){n.lanes|=s;var h=n.alternate;h!==null&&(h.lanes|=s),Bd(n.return,s,o)}function Ef(n,s,o,h,g,b){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g,treeForkCount:b}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=h,T.tail=o,T.tailMode=g,T.treeForkCount=b)}function wy(n,s,o){var h=s.pendingProps,g=h.revealOrder,b=h.tail;h=h.children;var T=dn.current,L=(T&2)!==0;if(L?(T=T&1|2,s.flags|=128):T&=1,ht(dn,T),In(n,s,h,o),h=xe?Kl:0,!L&&n!==null&&(n.flags&128)!==0)t:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&xy(n,o,s);else if(n.tag===19)xy(n,o,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break t;for(;n.sibling===null;){if(n.return===null||n.return===s)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)n=o.alternate,n!==null&&Du(n)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),Ef(s,!1,g,o,b,h);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(n=g.alternate,n!==null&&Du(n)===null){s.child=g;break}n=g.sibling,g.sibling=o,o=g,g=n}Ef(s,!0,o,null,b,h);break;case"together":Ef(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function aa(n,s,o){if(n!==null&&(s.dependencies=n.dependencies),Ya|=s.lanes,(o&s.childLanes)===0)if(n!==null){if(jo(n,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(i(153));if(s.child!==null){for(n=s.child,o=Js(n,n.pendingProps),s.child=o,o.return=s;n.sibling!==null;)n=n.sibling,o=o.sibling=Js(n,n.pendingProps),o.return=s;o.sibling=null}return s.child}function _f(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&Su(n)))}function Dw(n,s,o){switch(s.tag){case 3:he(s,s.stateNode.containerInfo),za(s,yn,n.memoizedState.cache),Lr();break;case 27:case 5:Rt(s);break;case 4:he(s,s.stateNode.containerInfo);break;case 10:za(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,Yd(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(Ka(s),s.flags|=128,null):(o&s.child.childLanes)!==0?vy(n,s,o):(Ka(s),n=aa(n,s,o),n!==null?n.sibling:null);Ka(s);break;case 19:var g=(n.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(jo(n,s,o,!1),h=(o&s.childLanes)!==0),g){if(h)return wy(n,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),ht(dn,dn.current),h)break;return null;case 22:return s.lanes=0,fy(n,s,o,s.pendingProps);case 24:za(s,yn,n.memoizedState.cache)}return aa(n,s,o)}function Sy(n,s,o){if(n!==null)if(n.memoizedProps!==s.pendingProps)vn=!0;else{if(!_f(n,o)&&(s.flags&128)===0)return vn=!1,Dw(n,s,o);vn=(n.flags&131072)!==0}else vn=!1,xe&&(s.flags&1048576)!==0&&tg(s,Kl,s.index);switch(s.lanes=0,s.tag){case 16:t:{var h=s.pendingProps;if(n=Fr(s.elementType),s.type=n,typeof n=="function")Md(n)?(h=Hr(n,h),s.tag=1,s=yy(null,s,n,h,o)):(s.tag=0,s=bf(null,s,n,h,o));else{if(n!=null){var g=n.$$typeof;if(g===I){s.tag=11,s=uy(null,s,n,h,o);break t}else if(g===P){s.tag=14,s=hy(null,s,n,h,o);break t}}throw s=vt(n)||n,Error(i(306,s,""))}}return s;case 0:return bf(n,s,s.type,s.pendingProps,o);case 1:return h=s.type,g=Hr(h,s.pendingProps),yy(n,s,h,g,o);case 3:t:{if(he(s,s.stateNode.containerInfo),n===null)throw Error(i(387));h=s.pendingProps;var b=s.memoizedState;g=b.element,Gd(n,s),Jl(s,h,null,o);var T=s.memoizedState;if(h=T.cache,za(s,yn,h),h!==b.cache&&Fd(s,[yn],o,!0),Zl(),h=T.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=b,s.memoizedState=b,s.flags&256){s=by(n,s,h,o);break t}else if(h!==g){g=Pi(Error(i(424)),s),Vl(g),s=by(n,s,h,o);break t}else for(n=s.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Qe=zi(n.firstChild),Bn=s,xe=!0,Ia=null,Ii=!0,o=fg(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Lr(),h===g){s=aa(n,s,o);break t}In(n,s,h,o)}s=s.child}return s;case 26:return zu(n,s),n===null?(o=Ob(s.type,null,s.pendingProps,null))?s.memoizedState=o:xe||(o=s.type,n=s.pendingProps,h=sh(qt.current).createElement(o),h[$e]=s,h[un]=n,Un(h,o,n),hn(h),s.stateNode=h):s.memoizedState=Ob(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return Rt(s),n===null&&xe&&(h=s.stateNode=Db(s.type,s.pendingProps,qt.current),Bn=s,Ii=!0,g=Qe,tr(s.type)?(sp=g,Qe=zi(h.firstChild)):Qe=g),In(n,s,s.pendingProps.children,o),zu(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&xe&&((g=h=Qe)&&(h=r1(h,s.type,s.pendingProps,Ii),h!==null?(s.stateNode=h,Bn=s,Qe=zi(h.firstChild),Ii=!1,g=!0):g=!1),g||Ua(s)),Rt(s),g=s.type,b=s.pendingProps,T=n!==null?n.memoizedProps:null,h=b.children,Jf(g,b)?h=null:T!==null&&Jf(g,T)&&(s.flags|=32),s.memoizedState!==null&&(g=Wd(n,s,ww,null,null,o),vc._currentValue=g),zu(n,s),In(n,s,h,o),s.child;case 6:return n===null&&xe&&((n=o=Qe)&&(o=o1(o,s.pendingProps,Ii),o!==null?(s.stateNode=o,Bn=s,Qe=null,n=!0):n=!1),n||Ua(s)),null;case 13:return vy(n,s,o);case 4:return he(s,s.stateNode.containerInfo),h=s.pendingProps,n===null?s.child=Ur(s,null,h,o):In(n,s,h,o),s.child;case 11:return uy(n,s,s.type,s.pendingProps,o);case 7:return In(n,s,s.pendingProps,o),s.child;case 8:return In(n,s,s.pendingProps.children,o),s.child;case 12:return In(n,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,za(s,s.type,h.value),In(n,s,h.children,o),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,Pr(s),g=Fn(g),h=h(g),s.flags|=1,In(n,s,h,o),s.child;case 14:return hy(n,s,s.type,s.pendingProps,o);case 15:return dy(n,s,s.type,s.pendingProps,o);case 19:return wy(n,s,o);case 31:return Mw(n,s,o);case 22:return fy(n,s,o,s.pendingProps);case 24:return Pr(s),h=Fn(yn),n===null?(g=zd(),g===null&&(g=Ve,b=Id(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=o),g=b),s.memoizedState={parent:h,cache:g},qd(s),za(s,yn,g)):((n.lanes&o)!==0&&(Gd(n,s),Jl(s,null,null,o),Zl()),g=n.memoizedState,b=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),za(s,yn,h)):(h=b.cache,za(s,yn,h),h!==g.cache&&Fd(s,[yn],o,!0))),In(n,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function ra(n){n.flags|=4}function Cf(n,s,o,h,g){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if(Yy())n.flags|=8192;else throw Ir=Cu,Hd}else n.flags&=-16777217}function Ay(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Fb(s))if(Yy())n.flags|=8192;else throw Ir=Cu,Hd}function qu(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?au():536870912,n.lanes|=s,$o|=s)}function ac(n,s){if(!xe)switch(n.tailMode){case"hidden":s=n.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function We(n){var s=n.alternate!==null&&n.alternate.child===n.child,o=0,h=0;if(s)for(var g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=h,n.childLanes=o,s}function Nw(n,s,o){var h=s.pendingProps;switch(Od(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return We(s),null;case 1:return We(s),null;case 3:return o=s.stateNode,h=null,n!==null&&(h=n.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),na(yn),de(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(Lo(s)?ra(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,jd())),We(s),null;case 26:var g=s.type,b=s.memoizedState;return n===null?(ra(s),b!==null?(We(s),Ay(s,b)):(We(s),Cf(s,g,null,h,o))):b?b!==n.memoizedState?(ra(s),We(s),Ay(s,b)):(We(s),s.flags&=-16777217):(n=n.memoizedProps,n!==h&&ra(s),We(s),Cf(s,g,n,h,o)),null;case 27:if(pe(s),o=qt.current,g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&ra(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return We(s),null}n=xt.current,Lo(s)?ng(s):(n=Db(g,h,o),s.stateNode=n,ra(s))}return We(s),null;case 5:if(pe(s),g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&ra(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return We(s),null}if(b=xt.current,Lo(s))ng(s);else{var T=sh(qt.current);switch(b){case 1:b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":b=T.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof h.is=="string"?T.createElement("select",{is:h.is}):T.createElement("select"),h.multiple?b.multiple=!0:h.size&&(b.size=h.size);break;default:b=typeof h.is=="string"?T.createElement(g,{is:h.is}):T.createElement(g)}}b[$e]=s,b[un]=h;t:for(T=s.child;T!==null;){if(T.tag===5||T.tag===6)b.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===s)break t;for(;T.sibling===null;){if(T.return===null||T.return===s)break t;T=T.return}T.sibling.return=T.return,T=T.sibling}s.stateNode=b;t:switch(Un(b,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&ra(s)}}return We(s),Cf(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,o),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==h&&ra(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(i(166));if(n=qt.current,Lo(s)){if(n=s.stateNode,o=s.memoizedProps,h=null,g=Bn,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}n[$e]=s,n=!!(n.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||vb(n.nodeValue,o)),n||Ua(s,!0)}else n=sh(n).createTextNode(h),n[$e]=s,s.stateNode=n}return We(s),null;case 31:if(o=s.memoizedState,n===null||n.memoizedState!==null){if(h=Lo(s),o!==null){if(n===null){if(!h)throw Error(i(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[$e]=s}else Lr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;We(s),n=!1}else o=jd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return s.flags&256?(Si(s),s):(Si(s),null);if((s.flags&128)!==0)throw Error(i(558))}return We(s),null;case 13:if(h=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=Lo(s),h!==null&&h.dehydrated!==null){if(n===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[$e]=s}else Lr(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;We(s),g=!1}else g=jd(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(Si(s),s):(Si(s),null)}return Si(s),(s.flags&128)!==0?(s.lanes=o,s):(o=h!==null,n=n!==null&&n.memoizedState!==null,o&&(h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),b=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==g&&(h.flags|=2048)),o!==n&&o&&(s.child.flags|=8192),qu(s,s.updateQueue),We(s),null);case 4:return de(),n===null&&Xf(s.stateNode.containerInfo),We(s),null;case 10:return na(s.type),We(s),null;case 19:if(J(dn),h=s.memoizedState,h===null)return We(s),null;if(g=(s.flags&128)!==0,b=h.rendering,b===null)if(g)ac(h,!1);else{if(rn!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(b=Du(n),b!==null){for(s.flags|=128,ac(h,!1),n=b.updateQueue,s.updateQueue=n,qu(s,n),s.subtreeFlags=0,n=o,o=s.child;o!==null;)Wm(o,n),o=o.sibling;return ht(dn,dn.current&1|2),xe&&ta(s,h.treeForkCount),s.child}n=n.sibling}h.tail!==null&&Kn()>Xu&&(s.flags|=128,g=!0,ac(h,!1),s.lanes=4194304)}else{if(!g)if(n=Du(b),n!==null){if(s.flags|=128,g=!0,n=n.updateQueue,s.updateQueue=n,qu(s,n),ac(h,!0),h.tail===null&&h.tailMode==="hidden"&&!b.alternate&&!xe)return We(s),null}else 2*Kn()-h.renderingStartTime>Xu&&o!==536870912&&(s.flags|=128,g=!0,ac(h,!1),s.lanes=4194304);h.isBackwards?(b.sibling=s.child,s.child=b):(n=h.last,n!==null?n.sibling=b:s.child=b,h.last=b)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=Kn(),n.sibling=null,o=dn.current,ht(dn,g?o&1|2:o&1),xe&&ta(s,h.treeForkCount),n):(We(s),null);case 22:case 23:return Si(s),Xd(),h=s.memoizedState!==null,n!==null?n.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&(We(s),s.subtreeFlags&6&&(s.flags|=8192)):We(s),o=s.updateQueue,o!==null&&qu(s,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),n!==null&&J(Br),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),na(yn),We(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function kw(n,s){switch(Od(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return na(yn),de(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return pe(s),null;case 31:if(s.memoizedState!==null){if(Si(s),s.alternate===null)throw Error(i(340));Lr()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(Si(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Lr()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return J(dn),null;case 4:return de(),null;case 10:return na(s.type),null;case 22:case 23:return Si(s),Xd(),n!==null&&J(Br),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return na(yn),null;case 25:return null;default:return null}}function Ey(n,s){switch(Od(s),s.tag){case 3:na(yn),de();break;case 26:case 27:case 5:pe(s);break;case 4:de();break;case 31:s.memoizedState!==null&&Si(s);break;case 13:Si(s);break;case 19:J(dn);break;case 10:na(s.type);break;case 22:case 23:Si(s),Xd(),n!==null&&J(Br);break;case 24:na(yn)}}function rc(n,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var g=h.next;o=g;do{if((o.tag&n)===n){h=void 0;var b=o.create,T=o.inst;h=b(),T.destroy=h}o=o.next}while(o!==g)}}catch(L){Be(s,s.return,L)}}function $a(n,s,o){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var b=g.next;h=b;do{if((h.tag&n)===n){var T=h.inst,L=T.destroy;if(L!==void 0){T.destroy=void 0,g=s;var q=o,at=L;try{at()}catch(mt){Be(g,q,mt)}}}h=h.next}while(h!==b)}}catch(mt){Be(s,s.return,mt)}}function _y(n){var s=n.updateQueue;if(s!==null){var o=n.stateNode;try{mg(s,o)}catch(h){Be(n,n.return,h)}}}function Cy(n,s,o){o.props=Hr(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(h){Be(n,s,h)}}function oc(n,s){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var h=n.stateNode;break;case 30:h=n.stateNode;break;default:h=n.stateNode}typeof o=="function"?n.refCleanup=o(h):o.current=h}}catch(g){Be(n,s,g)}}function ws(n,s){var o=n.ref,h=n.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(g){Be(n,s,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Be(n,s,g)}else o.current=null}function Ty(n){var s=n.type,o=n.memoizedProps,h=n.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break t;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(g){Be(n,n.return,g)}}function Tf(n,s,o){try{var h=n.stateNode;t1(h,n.type,o,s),h[un]=s}catch(g){Be(n,n.return,g)}}function Ry(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&tr(n.type)||n.tag===4}function Rf(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Ry(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&tr(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Mf(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(n),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=ri));else if(h!==4&&(h===27&&tr(n.type)&&(o=n.stateNode,s=null),n=n.child,n!==null))for(Mf(n,s,o),n=n.sibling;n!==null;)Mf(n,s,o),n=n.sibling}function Gu(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?o.insertBefore(n,s):o.appendChild(n);else if(h!==4&&(h===27&&tr(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Gu(n,s,o),n=n.sibling;n!==null;)Gu(n,s,o),n=n.sibling}function My(n){var s=n.stateNode,o=n.memoizedProps;try{for(var h=n.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Un(s,h,o),s[$e]=n,s[un]=o}catch(b){Be(n,n.return,b)}}var oa=!1,xn=!1,Df=!1,Dy=typeof WeakSet=="function"?WeakSet:Set,Dn=null;function Ow(n,s){if(n=n.containerInfo,Wf=hh,n=M(n),N(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else t:{o=(o=n.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break t}var T=0,L=-1,q=-1,at=0,mt=0,bt=n,lt=null;e:for(;;){for(var ft;bt!==o||g!==0&&bt.nodeType!==3||(L=T+g),bt!==b||h!==0&&bt.nodeType!==3||(q=T+h),bt.nodeType===3&&(T+=bt.nodeValue.length),(ft=bt.firstChild)!==null;)lt=bt,bt=ft;for(;;){if(bt===n)break e;if(lt===o&&++at===g&&(L=T),lt===b&&++mt===h&&(q=T),(ft=bt.nextSibling)!==null)break;bt=lt,lt=bt.parentNode}bt=ft}o=L===-1||q===-1?null:{start:L,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(Zf={focusedElem:n,selectionRange:o},hh=!1,Dn=s;Dn!==null;)if(s=Dn,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Dn=n;else for(;Dn!==null;){switch(s=Dn,b=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)g=n[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&b!==null){n=void 0,o=s,g=b.memoizedProps,b=b.memoizedState,h=o.stateNode;try{var Kt=Hr(o.type,g);n=h.getSnapshotBeforeUpdate(Kt,b),h.__reactInternalSnapshotBeforeUpdate=n}catch(Zt){Be(o,o.return,Zt)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,o=n.nodeType,o===9)ep(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":ep(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=s.sibling,n!==null){n.return=s.return,Dn=n;break}Dn=s.return}}function Ny(n,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:ca(n,o),h&4&&rc(5,o);break;case 1:if(ca(n,o),h&4)if(n=o.stateNode,s===null)try{n.componentDidMount()}catch(T){Be(o,o.return,T)}else{var g=Hr(o.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(g,s,n.__reactInternalSnapshotBeforeUpdate)}catch(T){Be(o,o.return,T)}}h&64&&_y(o),h&512&&oc(o,o.return);break;case 3:if(ca(n,o),h&64&&(n=o.updateQueue,n!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{mg(n,s)}catch(T){Be(o,o.return,T)}}break;case 27:s===null&&h&4&&My(o);case 26:case 5:ca(n,o),s===null&&h&4&&Ty(o),h&512&&oc(o,o.return);break;case 12:ca(n,o);break;case 31:ca(n,o),h&4&&Ly(n,o);break;case 13:ca(n,o),h&4&&jy(n,o),h&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=Hw.bind(null,o),l1(n,o))));break;case 22:if(h=o.memoizedState!==null||oa,!h){s=s!==null&&s.memoizedState!==null||xn,g=oa;var b=xn;oa=h,(xn=s)&&!b?ua(n,o,(o.subtreeFlags&8772)!==0):ca(n,o),oa=g,xn=b}break;case 30:break;default:ca(n,o)}}function ky(n){var s=n.alternate;s!==null&&(n.alternate=null,ky(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&uo(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Ze=null,oi=!1;function la(n,s,o){for(o=o.child;o!==null;)Oy(n,s,o),o=o.sibling}function Oy(n,s,o){if(Ln&&typeof Ln.onCommitFiberUnmount=="function")try{Ln.onCommitFiberUnmount(ls,o)}catch{}switch(o.tag){case 26:xn||ws(o,s),la(n,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:xn||ws(o,s);var h=Ze,g=oi;tr(o.type)&&(Ze=o.stateNode,oi=!1),la(n,s,o),gc(o.stateNode),Ze=h,oi=g;break;case 5:xn||ws(o,s);case 6:if(h=Ze,g=oi,Ze=null,la(n,s,o),Ze=h,oi=g,Ze!==null)if(oi)try{(Ze.nodeType===9?Ze.body:Ze.nodeName==="HTML"?Ze.ownerDocument.body:Ze).removeChild(o.stateNode)}catch(b){Be(o,s,b)}else try{Ze.removeChild(o.stateNode)}catch(b){Be(o,s,b)}break;case 18:Ze!==null&&(oi?(n=Ze,_b(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),el(n)):_b(Ze,o.stateNode));break;case 4:h=Ze,g=oi,Ze=o.stateNode.containerInfo,oi=!0,la(n,s,o),Ze=h,oi=g;break;case 0:case 11:case 14:case 15:$a(2,o,s),xn||$a(4,o,s),la(n,s,o);break;case 1:xn||(ws(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&Cy(o,s,h)),la(n,s,o);break;case 21:la(n,s,o);break;case 22:xn=(h=xn)||o.memoizedState!==null,la(n,s,o),xn=h;break;default:la(n,s,o)}}function Ly(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{el(n)}catch(o){Be(s,s.return,o)}}}function jy(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{el(n)}catch(o){Be(s,s.return,o)}}function Lw(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new Dy),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new Dy),s;default:throw Error(i(435,n.tag))}}function Ku(n,s){var o=Lw(n);s.forEach(function(h){if(!o.has(h)){o.add(h);var g=qw.bind(null,n,h);h.then(g,g)}})}function li(n,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h],b=n,T=s,L=T;t:for(;L!==null;){switch(L.tag){case 27:if(tr(L.type)){Ze=L.stateNode,oi=!1;break t}break;case 5:Ze=L.stateNode,oi=!1;break t;case 3:case 4:Ze=L.stateNode.containerInfo,oi=!0;break t}L=L.return}if(Ze===null)throw Error(i(160));Oy(b,T,g),Ze=null,oi=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Py(s,n),s=s.sibling}var ts=null;function Py(n,s){var o=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:li(s,n),ci(n),h&4&&($a(3,n,n.return),rc(3,n),$a(5,n,n.return));break;case 1:li(s,n),ci(n),h&512&&(xn||o===null||ws(o,o.return)),h&64&&oa&&(n=n.updateQueue,n!==null&&(h=n.callbacks,h!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var g=ts;if(li(s,n),ci(n),h&512&&(xn||o===null||ws(o,o.return)),h&4){var b=o!==null?o.memoizedState:null;if(h=n.memoizedState,o===null)if(h===null)if(n.stateNode===null){t:{h=n.type,o=n.memoizedProps,g=g.ownerDocument||g;e:switch(h){case"title":b=g.getElementsByTagName("title")[0],(!b||b[yi]||b[$e]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(h),g.head.insertBefore(b,g.querySelector("head > title"))),Un(b,h,o),b[$e]=n,hn(b),h=b;break t;case"link":var T=Pb("link","href",g).get(h+(o.href||""));if(T){for(var L=0;L<T.length;L++)if(b=T[L],b.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&b.getAttribute("rel")===(o.rel==null?null:o.rel)&&b.getAttribute("title")===(o.title==null?null:o.title)&&b.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(L,1);break e}}b=g.createElement(h),Un(b,h,o),g.head.appendChild(b);break;case"meta":if(T=Pb("meta","content",g).get(h+(o.content||""))){for(L=0;L<T.length;L++)if(b=T[L],b.getAttribute("content")===(o.content==null?null:""+o.content)&&b.getAttribute("name")===(o.name==null?null:o.name)&&b.getAttribute("property")===(o.property==null?null:o.property)&&b.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&b.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(L,1);break e}}b=g.createElement(h),Un(b,h,o),g.head.appendChild(b);break;default:throw Error(i(468,h))}b[$e]=n,hn(b),h=b}n.stateNode=h}else Bb(g,n.type,n.stateNode);else n.stateNode=jb(g,h,n.memoizedProps);else b!==h?(b===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):b.count--,h===null?Bb(g,n.type,n.stateNode):jb(g,h,n.memoizedProps)):h===null&&n.stateNode!==null&&Tf(n,n.memoizedProps,o.memoizedProps)}break;case 27:li(s,n),ci(n),h&512&&(xn||o===null||ws(o,o.return)),o!==null&&h&4&&Tf(n,n.memoizedProps,o.memoizedProps);break;case 5:if(li(s,n),ci(n),h&512&&(xn||o===null||ws(o,o.return)),n.flags&32){g=n.stateNode;try{qs(g,"")}catch(Kt){Be(n,n.return,Kt)}}h&4&&n.stateNode!=null&&(g=n.memoizedProps,Tf(n,g,o!==null?o.memoizedProps:g)),h&1024&&(Df=!0);break;case 6:if(li(s,n),ci(n),h&4){if(n.stateNode===null)throw Error(i(162));h=n.memoizedProps,o=n.stateNode;try{o.nodeValue=h}catch(Kt){Be(n,n.return,Kt)}}break;case 3:if(oh=null,g=ts,ts=ah(s.containerInfo),li(s,n),ts=g,ci(n),h&4&&o!==null&&o.memoizedState.isDehydrated)try{el(s.containerInfo)}catch(Kt){Be(n,n.return,Kt)}Df&&(Df=!1,By(n));break;case 4:h=ts,ts=ah(n.stateNode.containerInfo),li(s,n),ci(n),ts=h;break;case 12:li(s,n),ci(n);break;case 31:li(s,n),ci(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Ku(n,h)));break;case 13:li(s,n),ci(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&($u=Kn()),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Ku(n,h)));break;case 22:g=n.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,at=oa,mt=xn;if(oa=at||g,xn=mt||q,li(s,n),xn=mt,oa=at,ci(n),h&8192)t:for(s=n.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||q||oa||xn||qr(n)),o=null,s=n;;){if(s.tag===5||s.tag===26){if(o===null){q=o=s;try{if(b=q.stateNode,g)T=b.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{L=q.stateNode;var bt=q.memoizedProps.style,lt=bt!=null&&bt.hasOwnProperty("display")?bt.display:null;L.style.display=lt==null||typeof lt=="boolean"?"":(""+lt).trim()}}catch(Kt){Be(q,q.return,Kt)}}}else if(s.tag===6){if(o===null){q=s;try{q.stateNode.nodeValue=g?"":q.memoizedProps}catch(Kt){Be(q,q.return,Kt)}}}else if(s.tag===18){if(o===null){q=s;try{var ft=q.stateNode;g?Cb(ft,!0):Cb(q.stateNode,!1)}catch(Kt){Be(q,q.return,Kt)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break t;for(;s.sibling===null;){if(s.return===null||s.return===n)break t;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=n.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,Ku(n,o))));break;case 19:li(s,n),ci(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Ku(n,h)));break;case 30:break;case 21:break;default:li(s,n),ci(n)}}function ci(n){var s=n.flags;if(s&2){try{for(var o,h=n.return;h!==null;){if(Ry(h)){o=h;break}h=h.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,b=Rf(n);Gu(n,b,g);break;case 5:var T=o.stateNode;o.flags&32&&(qs(T,""),o.flags&=-33);var L=Rf(n);Gu(n,L,T);break;case 3:case 4:var q=o.stateNode.containerInfo,at=Rf(n);Mf(n,at,q);break;default:throw Error(i(161))}}catch(mt){Be(n,n.return,mt)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function By(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;By(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function ca(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Ny(n,s.alternate,s),s=s.sibling}function qr(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:$a(4,s,s.return),qr(s);break;case 1:ws(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&Cy(s,s.return,o),qr(s);break;case 27:gc(s.stateNode);case 26:case 5:ws(s,s.return),qr(s);break;case 22:s.memoizedState===null&&qr(s);break;case 30:qr(s);break;default:qr(s)}n=n.sibling}}function ua(n,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=n,b=s,T=b.flags;switch(b.tag){case 0:case 11:case 15:ua(g,b,o),rc(4,b);break;case 1:if(ua(g,b,o),h=b,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(at){Be(h,h.return,at)}if(h=b,g=h.updateQueue,g!==null){var L=h.stateNode;try{var q=g.shared.hiddenCallbacks;if(q!==null)for(g.shared.hiddenCallbacks=null,g=0;g<q.length;g++)pg(q[g],L)}catch(at){Be(h,h.return,at)}}o&&T&64&&_y(b),oc(b,b.return);break;case 27:My(b);case 26:case 5:ua(g,b,o),o&&h===null&&T&4&&Ty(b),oc(b,b.return);break;case 12:ua(g,b,o);break;case 31:ua(g,b,o),o&&T&4&&Ly(g,b);break;case 13:ua(g,b,o),o&&T&4&&jy(g,b);break;case 22:b.memoizedState===null&&ua(g,b,o),oc(b,b.return);break;case 30:break;default:ua(g,b,o)}s=s.sibling}}function Nf(n,s){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&$l(o))}function kf(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&$l(n))}function es(n,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Fy(n,s,o,h),s=s.sibling}function Fy(n,s,o,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:es(n,s,o,h),g&2048&&rc(9,s);break;case 1:es(n,s,o,h);break;case 3:es(n,s,o,h),g&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&$l(n)));break;case 12:if(g&2048){es(n,s,o,h),n=s.stateNode;try{var b=s.memoizedProps,T=b.id,L=b.onPostCommit;typeof L=="function"&&L(T,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(q){Be(s,s.return,q)}}else es(n,s,o,h);break;case 31:es(n,s,o,h);break;case 13:es(n,s,o,h);break;case 23:break;case 22:b=s.stateNode,T=s.alternate,s.memoizedState!==null?b._visibility&2?es(n,s,o,h):lc(n,s):b._visibility&2?es(n,s,o,h):(b._visibility|=2,Go(n,s,o,h,(s.subtreeFlags&10256)!==0||!1)),g&2048&&Nf(T,s);break;case 24:es(n,s,o,h),g&2048&&kf(s.alternate,s);break;default:es(n,s,o,h)}}function Go(n,s,o,h,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var b=n,T=s,L=o,q=h,at=T.flags;switch(T.tag){case 0:case 11:case 15:Go(b,T,L,q,g),rc(8,T);break;case 23:break;case 22:var mt=T.stateNode;T.memoizedState!==null?mt._visibility&2?Go(b,T,L,q,g):lc(b,T):(mt._visibility|=2,Go(b,T,L,q,g)),g&&at&2048&&Nf(T.alternate,T);break;case 24:Go(b,T,L,q,g),g&&at&2048&&kf(T.alternate,T);break;default:Go(b,T,L,q,g)}s=s.sibling}}function lc(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=n,h=s,g=h.flags;switch(h.tag){case 22:lc(o,h),g&2048&&Nf(h.alternate,h);break;case 24:lc(o,h),g&2048&&kf(h.alternate,h);break;default:lc(o,h)}s=s.sibling}}var cc=8192;function Ko(n,s,o){if(n.subtreeFlags&cc)for(n=n.child;n!==null;)Iy(n,s,o),n=n.sibling}function Iy(n,s,o){switch(n.tag){case 26:Ko(n,s,o),n.flags&cc&&n.memoizedState!==null&&x1(o,ts,n.memoizedState,n.memoizedProps);break;case 5:Ko(n,s,o);break;case 3:case 4:var h=ts;ts=ah(n.stateNode.containerInfo),Ko(n,s,o),ts=h;break;case 22:n.memoizedState===null&&(h=n.alternate,h!==null&&h.memoizedState!==null?(h=cc,cc=16777216,Ko(n,s,o),cc=h):Ko(n,s,o));break;default:Ko(n,s,o)}}function Uy(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function uc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Dn=h,Hy(h,n)}Uy(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)zy(n),n=n.sibling}function zy(n){switch(n.tag){case 0:case 11:case 15:uc(n),n.flags&2048&&$a(9,n,n.return);break;case 3:uc(n);break;case 12:uc(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,Vu(n)):uc(n);break;default:uc(n)}}function Vu(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Dn=h,Hy(h,n)}Uy(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:$a(8,s,s.return),Vu(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Vu(s));break;default:Vu(s)}n=n.sibling}}function Hy(n,s){for(;Dn!==null;){var o=Dn;switch(o.tag){case 0:case 11:case 15:$a(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:$l(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Dn=h;else t:for(o=n;Dn!==null;){h=Dn;var g=h.sibling,b=h.return;if(ky(h),h===o){Dn=null;break t}if(g!==null){g.return=b,Dn=g;break t}Dn=b}}}var jw={getCacheForType:function(n){var s=Fn(yn),o=s.data.get(n);return o===void 0&&(o=n(),s.data.set(n,o)),o},cacheSignal:function(){return Fn(yn).controller.signal}},Pw=typeof WeakMap=="function"?WeakMap:Map,Me=0,Ve=null,me=null,ye=0,Pe=0,Ai=null,Xa=!1,Vo=!1,Of=!1,ha=0,rn=0,Ya=0,Gr=0,Lf=0,Ei=0,$o=0,hc=null,ui=null,jf=!1,$u=0,qy=0,Xu=1/0,Yu=null,Qa=null,An=0,Wa=null,Xo=null,da=0,Pf=0,Bf=null,Gy=null,dc=0,Ff=null;function _i(){return(Me&2)!==0&&ye!==0?ye&-ye:G.T!==null?Gf():br()}function Ky(){if(Ei===0)if((ye&536870912)===0||xe){var n=Ea;Ea<<=1,(Ea&3932160)===0&&(Ea=262144),Ei=n}else Ei=536870912;return n=wi.current,n!==null&&(n.flags|=32),Ei}function hi(n,s,o){(n===Ve&&(Pe===2||Pe===9)||n.cancelPendingCommit!==null)&&(Yo(n,0),Za(n,ye,Ei,!1)),Ni(n,o),((Me&2)===0||n!==Ve)&&(n===Ve&&((Me&2)===0&&(Gr|=o),rn===4&&Za(n,ye,Ei,!1)),Ss(n))}function Vy(n,s,o){if((Me&6)!==0)throw Error(i(327));var h=!o&&(s&127)===0&&(s&n.expiredLanes)===0||Us(n,s),g=h?Iw(n,s):Uf(n,s,!0),b=h;do{if(g===0){Vo&&!h&&Za(n,s,0,!1);break}else{if(o=n.current.alternate,b&&!Bw(o)){g=Uf(n,s,!1),b=!1;continue}if(g===2){if(b=s,n.errorRecoveryDisabledLanes&b)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;t:{var L=n;g=hc;var q=L.current.memoizedState.isDehydrated;if(q&&(Yo(L,T).flags|=256),T=Uf(L,T,!1),T!==2){if(Of&&!q){L.errorRecoveryDisabledLanes|=b,Gr|=b,g=4;break t}b=ui,ui=g,b!==null&&(ui===null?ui=b:ui.push.apply(ui,b))}g=T}if(b=!1,g!==2)continue}}if(g===1){Yo(n,0),Za(n,s,0,!0);break}t:{switch(h=n,b=g,b){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Za(h,s,Ei,!Xa);break t;case 2:ui=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=$u+300-Kn(),10<g)){if(Za(h,s,Ei,!Xa),gr(h,0,!0)!==0)break t;da=s,h.timeoutHandle=Ab($y.bind(null,h,o,ui,Yu,jf,s,Ei,Gr,$o,Xa,b,"Throttled",-0,0),g);break t}$y(h,o,ui,Yu,jf,s,Ei,Gr,$o,Xa,b,null,-0,0)}}break}while(!0);Ss(n)}function $y(n,s,o,h,g,b,T,L,q,at,mt,bt,lt,ft){if(n.timeoutHandle=-1,bt=s.subtreeFlags,bt&8192||(bt&16785408)===16785408){bt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ri},Iy(s,b,bt);var Kt=(b&62914560)===b?$u-Kn():(b&4194048)===b?qy-Kn():0;if(Kt=w1(bt,Kt),Kt!==null){da=b,n.cancelPendingCommit=Kt(eb.bind(null,n,s,b,o,h,g,T,L,q,mt,bt,null,lt,ft)),Za(n,b,T,!at);return}}eb(n,s,b,o,h,g,T,L,q)}function Bw(n){for(var s=n;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var g=o[h],b=g.getSnapshot;g=g.value;try{if(!Yn(b(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Za(n,s,o,h){s&=~Lf,s&=~Gr,n.suspendedLanes|=s,n.pingedLanes&=~s,h&&(n.warmLanes|=s),h=n.expirationTimes;for(var g=s;0<g;){var b=31-Ft(g),T=1<<b;h[b]=-1,g&=~T}o!==0&&yr(n,o,s)}function Qu(){return(Me&6)===0?(fc(0),!1):!0}function If(){if(me!==null){if(Pe===0)var n=me.return;else n=me,ea=jr=null,tf(n),Io=null,Yl=0,n=me;for(;n!==null;)Ey(n.alternate,n),n=n.return;me=null}}function Yo(n,s){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,i1(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),da=0,If(),Ve=n,me=o=Js(n.current,null),ye=s,Pe=0,Ai=null,Xa=!1,Vo=Us(n,s),Of=!1,$o=Ei=Lf=Gr=Ya=rn=0,ui=hc=null,jf=!1,(s&8)!==0&&(s|=s&32);var h=n.entangledLanes;if(h!==0)for(n=n.entanglements,h&=s;0<h;){var g=31-Ft(h),b=1<<g;s|=n[g],h&=~b}return ha=s,ae(),o}function Xy(n,s){le=null,G.H=ic,s===Fo||s===_u?(s=ug(),Pe=3):s===Hd?(s=ug(),Pe=4):Pe=s===yf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Ai=s,me===null&&(rn=1,Iu(n,Pi(s,n.current)))}function Yy(){var n=wi.current;return n===null?!0:(ye&4194048)===ye?Ui===null:(ye&62914560)===ye||(ye&536870912)!==0?n===Ui:!1}function Qy(){var n=G.H;return G.H=ic,n===null?ic:n}function Wy(){var n=G.A;return G.A=jw,n}function Wu(){rn=4,Xa||(ye&4194048)!==ye&&wi.current!==null||(Vo=!0),(Ya&134217727)===0&&(Gr&134217727)===0||Ve===null||Za(Ve,ye,Ei,!1)}function Uf(n,s,o){var h=Me;Me|=2;var g=Qy(),b=Wy();(Ve!==n||ye!==s)&&(Yu=null,Yo(n,s)),s=!1;var T=rn;t:do try{if(Pe!==0&&me!==null){var L=me,q=Ai;switch(Pe){case 8:If(),T=6;break t;case 3:case 2:case 9:case 6:wi.current===null&&(s=!0);var at=Pe;if(Pe=0,Ai=null,Qo(n,L,q,at),o&&Vo){T=0;break t}break;default:at=Pe,Pe=0,Ai=null,Qo(n,L,q,at)}}Fw(),T=rn;break}catch(mt){Xy(n,mt)}while(!0);return s&&n.shellSuspendCounter++,ea=jr=null,Me=h,G.H=g,G.A=b,me===null&&(Ve=null,ye=0,ae()),T}function Fw(){for(;me!==null;)Zy(me)}function Iw(n,s){var o=Me;Me|=2;var h=Qy(),g=Wy();Ve!==n||ye!==s?(Yu=null,Xu=Kn()+500,Yo(n,s)):Vo=Us(n,s);t:do try{if(Pe!==0&&me!==null){s=me;var b=Ai;e:switch(Pe){case 1:Pe=0,Ai=null,Qo(n,s,b,1);break;case 2:case 9:if(lg(b)){Pe=0,Ai=null,Jy(s);break}s=function(){Pe!==2&&Pe!==9||Ve!==n||(Pe=7),Ss(n)},b.then(s,s);break t;case 3:Pe=7;break t;case 4:Pe=5;break t;case 7:lg(b)?(Pe=0,Ai=null,Jy(s)):(Pe=0,Ai=null,Qo(n,s,b,7));break;case 5:var T=null;switch(me.tag){case 26:T=me.memoizedState;case 5:case 27:var L=me;if(T?Fb(T):L.stateNode.complete){Pe=0,Ai=null;var q=L.sibling;if(q!==null)me=q;else{var at=L.return;at!==null?(me=at,Zu(at)):me=null}break e}}Pe=0,Ai=null,Qo(n,s,b,5);break;case 6:Pe=0,Ai=null,Qo(n,s,b,6);break;case 8:If(),rn=6;break t;default:throw Error(i(462))}}Uw();break}catch(mt){Xy(n,mt)}while(!0);return ea=jr=null,G.H=h,G.A=g,Me=o,me!==null?0:(Ve=null,ye=0,ae(),rn)}function Uw(){for(;me!==null&&!ai();)Zy(me)}function Zy(n){var s=Sy(n.alternate,n,ha);n.memoizedProps=n.pendingProps,s===null?Zu(n):me=s}function Jy(n){var s=n,o=s.alternate;switch(s.tag){case 15:case 0:s=gy(o,s,s.pendingProps,s.type,void 0,ye);break;case 11:s=gy(o,s,s.pendingProps,s.type.render,s.ref,ye);break;case 5:tf(s);default:Ey(o,s),s=me=Wm(s,ha),s=Sy(o,s,ha)}n.memoizedProps=n.pendingProps,s===null?Zu(n):me=s}function Qo(n,s,o,h){ea=jr=null,tf(s),Io=null,Yl=0;var g=s.return;try{if(Rw(n,g,s,o,ye)){rn=1,Iu(n,Pi(o,n.current)),me=null;return}}catch(b){if(g!==null)throw me=g,b;rn=1,Iu(n,Pi(o,n.current)),me=null;return}s.flags&32768?(xe||h===1?n=!0:Vo||(ye&536870912)!==0?n=!1:(Xa=n=!0,(h===2||h===9||h===3||h===6)&&(h=wi.current,h!==null&&h.tag===13&&(h.flags|=16384))),tb(s,n)):Zu(s)}function Zu(n){var s=n;do{if((s.flags&32768)!==0){tb(s,Xa);return}n=s.return;var o=Nw(s.alternate,s,ha);if(o!==null){me=o;return}if(s=s.sibling,s!==null){me=s;return}me=s=n}while(s!==null);rn===0&&(rn=5)}function tb(n,s){do{var o=kw(n.alternate,n);if(o!==null){o.flags&=32767,me=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(n=n.sibling,n!==null)){me=n;return}me=n=o}while(n!==null);rn=6,me=null}function eb(n,s,o,h,g,b,T,L,q){n.cancelPendingCommit=null;do Ju();while(An!==0);if((Me&6)!==0)throw Error(i(327));if(s!==null){if(s===n.current)throw Error(i(177));if(b=s.lanes|s.childLanes,b|=Yt,Al(n,o,b,T,L,q),n===Ve&&(me=Ve=null,ye=0),Xo=s,Wa=n,da=o,Pf=b,Bf=g,Gy=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,Gw(Aa,function(){return rb(),null})):(n.callbackNode=null,n.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=G.T,G.T=null,g=ct.p,ct.p=2,T=Me,Me|=4;try{Ow(n,s,o)}finally{Me=T,ct.p=g,G.T=h}}An=1,nb(),ib(),sb()}}function nb(){if(An===1){An=0;var n=Wa,s=Xo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var h=ct.p;ct.p=2;var g=Me;Me|=4;try{Py(s,n);var b=Zf,T=M(n.containerInfo),L=b.focusedElem,q=b.selectionRange;if(T!==L&&L&&L.ownerDocument&&_(L.ownerDocument.documentElement,L)){if(q!==null&&N(L)){var at=q.start,mt=q.end;if(mt===void 0&&(mt=at),"selectionStart"in L)L.selectionStart=at,L.selectionEnd=Math.min(mt,L.value.length);else{var bt=L.ownerDocument||document,lt=bt&&bt.defaultView||window;if(lt.getSelection){var ft=lt.getSelection(),Kt=L.textContent.length,Zt=Math.min(q.start,Kt),qe=q.end===void 0?Zt:Math.min(q.end,Kt);!ft.extend&&Zt>qe&&(T=qe,qe=Zt,Zt=T);var tt=w(L,Zt),W=w(L,qe);if(tt&&W&&(ft.rangeCount!==1||ft.anchorNode!==tt.node||ft.anchorOffset!==tt.offset||ft.focusNode!==W.node||ft.focusOffset!==W.offset)){var st=bt.createRange();st.setStart(tt.node,tt.offset),ft.removeAllRanges(),Zt>qe?(ft.addRange(st),ft.extend(W.node,W.offset)):(st.setEnd(W.node,W.offset),ft.addRange(st))}}}}for(bt=[],ft=L;ft=ft.parentNode;)ft.nodeType===1&&bt.push({element:ft,left:ft.scrollLeft,top:ft.scrollTop});for(typeof L.focus=="function"&&L.focus(),L=0;L<bt.length;L++){var gt=bt[L];gt.element.scrollLeft=gt.left,gt.element.scrollTop=gt.top}}hh=!!Wf,Zf=Wf=null}finally{Me=g,ct.p=h,G.T=o}}n.current=s,An=2}}function ib(){if(An===2){An=0;var n=Wa,s=Xo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var h=ct.p;ct.p=2;var g=Me;Me|=4;try{Ny(n,s.alternate,s)}finally{Me=g,ct.p=h,G.T=o}}An=3}}function sb(){if(An===4||An===3){An=0,Yi();var n=Wa,s=Xo,o=da,h=Gy;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?An=5:(An=0,Xo=Wa=null,ab(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(Qa=null),_a(o),s=s.stateNode,Ln&&typeof Ln.onCommitFiberRoot=="function")try{Ln.onCommitFiberRoot(ls,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=G.T,g=ct.p,ct.p=2,G.T=null;try{for(var b=n.onRecoverableError,T=0;T<h.length;T++){var L=h[T];b(L.value,{componentStack:L.stack})}}finally{G.T=s,ct.p=g}}(da&3)!==0&&Ju(),Ss(n),g=n.pendingLanes,(o&261930)!==0&&(g&42)!==0?n===Ff?dc++:(dc=0,Ff=n):dc=0,fc(0)}}function ab(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,$l(s)))}function Ju(){return nb(),ib(),sb(),rb()}function rb(){if(An!==5)return!1;var n=Wa,s=Pf;Pf=0;var o=_a(da),h=G.T,g=ct.p;try{ct.p=32>o?32:o,G.T=null,o=Bf,Bf=null;var b=Wa,T=da;if(An=0,Xo=Wa=null,da=0,(Me&6)!==0)throw Error(i(331));var L=Me;if(Me|=4,zy(b.current),Fy(b,b.current,T,o),Me=L,fc(0,!1),Ln&&typeof Ln.onPostCommitFiberRoot=="function")try{Ln.onPostCommitFiberRoot(ls,b)}catch{}return!0}finally{ct.p=g,G.T=h,ab(n,s)}}function ob(n,s,o){s=Pi(o,s),s=gf(n.stateNode,s,2),n=Ga(n,s,2),n!==null&&(Ni(n,2),Ss(n))}function Be(n,s,o){if(n.tag===3)ob(n,n,o);else for(;s!==null;){if(s.tag===3){ob(s,n,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Qa===null||!Qa.has(h))){n=Pi(o,n),o=ly(2),h=Ga(s,o,2),h!==null&&(cy(o,h,s,n),Ni(h,2),Ss(h));break}}s=s.return}}function zf(n,s,o){var h=n.pingCache;if(h===null){h=n.pingCache=new Pw;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(o)||(Of=!0,g.add(o),n=zw.bind(null,n,s,o),s.then(n,n))}function zw(n,s,o){var h=n.pingCache;h!==null&&h.delete(s),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Ve===n&&(ye&o)===o&&(rn===4||rn===3&&(ye&62914560)===ye&&300>Kn()-$u?(Me&2)===0&&Yo(n,0):Lf|=o,$o===ye&&($o=0)),Ss(n)}function lb(n,s){s===0&&(s=au()),n=je(n,s),n!==null&&(Ni(n,s),Ss(n))}function Hw(n){var s=n.memoizedState,o=0;s!==null&&(o=s.retryLane),lb(n,o)}function qw(n,s){var o=0;switch(n.tag){case 31:case 13:var h=n.stateNode,g=n.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=n.stateNode;break;case 22:h=n.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(s),lb(n,o)}function Gw(n,s){return Te(n,s)}var th=null,Wo=null,Hf=!1,eh=!1,qf=!1,Ja=0;function Ss(n){n!==Wo&&n.next===null&&(Wo===null?th=Wo=n:Wo=Wo.next=n),eh=!0,Hf||(Hf=!0,Vw())}function fc(n,s){if(!qf&&eh){qf=!0;do for(var o=!1,h=th;h!==null;){if(n!==0){var g=h.pendingLanes;if(g===0)var b=0;else{var T=h.suspendedLanes,L=h.pingedLanes;b=(1<<31-Ft(42|n)+1)-1,b&=g&~(T&~L),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(o=!0,db(h,b))}else b=ye,b=gr(h,h===Ve?b:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(b&3)===0||Us(h,b)||(o=!0,db(h,b));h=h.next}while(o);qf=!1}}function Kw(){cb()}function cb(){eh=Hf=!1;var n=0;Ja!==0&&n1()&&(n=Ja);for(var s=Kn(),o=null,h=th;h!==null;){var g=h.next,b=ub(h,s);b===0?(h.next=null,o===null?th=g:o.next=g,g===null&&(Wo=o)):(o=h,(n!==0||(b&3)!==0)&&(eh=!0)),h=g}An!==0&&An!==5||fc(n),Ja!==0&&(Ja=0)}function ub(n,s){for(var o=n.suspendedLanes,h=n.pingedLanes,g=n.expirationTimes,b=n.pendingLanes&-62914561;0<b;){var T=31-Ft(b),L=1<<T,q=g[T];q===-1?((L&o)===0||(L&h)!==0)&&(g[T]=xd(L,s)):q<=s&&(n.expiredLanes|=L),b&=~L}if(s=Ve,o=ye,o=gr(n,n===s?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h=n.callbackNode,o===0||n===s&&(Pe===2||Pe===9)||n.cancelPendingCommit!==null)return h!==null&&h!==null&&Fe(h),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Us(n,o)){if(s=o&-o,s===n.callbackPriority)return s;switch(h!==null&&Fe(h),_a(o)){case 2:case 8:o=os;break;case 32:o=Aa;break;case 268435456:o=oo;break;default:o=Aa}return h=hb.bind(null,n),o=Te(o,h),n.callbackPriority=s,n.callbackNode=o,s}return h!==null&&h!==null&&Fe(h),n.callbackPriority=2,n.callbackNode=null,2}function hb(n,s){if(An!==0&&An!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Ju()&&n.callbackNode!==o)return null;var h=ye;return h=gr(n,n===Ve?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h===0?null:(Vy(n,h,s),ub(n,Kn()),n.callbackNode!=null&&n.callbackNode===o?hb.bind(null,n):null)}function db(n,s){if(Ju())return null;Vy(n,s,!0)}function Vw(){s1(function(){(Me&6)!==0?Te(Vn,Kw):cb()})}function Gf(){if(Ja===0){var n=Po;n===0&&(n=Lt,Lt<<=1,(Lt&261888)===0&&(Lt=256)),Ja=n}return Ja}function fb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Ji(""+n)}function pb(n,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,n.id&&o.setAttribute("form",n.id),s.parentNode.insertBefore(o,s),n=new FormData(n),o.parentNode.removeChild(o),n}function $w(n,s,o,h,g){if(s==="submit"&&o&&o.stateNode===g){var b=fb((g[un]||null).action),T=h.submitter;T&&(s=(s=T[un]||null)?fb(s.formAction):T.getAttribute("formAction"),s!==null&&(b=s,T=null));var L=new go("action","action",null,h,g);n.push({event:L,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Ja!==0){var q=T?pb(g,T):new FormData(g);uf(o,{pending:!0,data:q,method:g.method,action:b},null,q)}}else typeof b=="function"&&(L.preventDefault(),q=T?pb(g,T):new FormData(g),uf(o,{pending:!0,data:q,method:g.method,action:b},b,q))},currentTarget:g}]})}}for(var Kf=0;Kf<jt.length;Kf++){var Vf=jt[Kf],Xw=Vf.toLowerCase(),Yw=Vf[0].toUpperCase()+Vf.slice(1);Et(Xw,"on"+Yw)}Et(ot,"onAnimationEnd"),Et(nt,"onAnimationIteration"),Et(pt,"onAnimationStart"),Et("dblclick","onDoubleClick"),Et("focusin","onFocus"),Et("focusout","onBlur"),Et(wt,"onTransitionRun"),Et(kt,"onTransitionStart"),Et(Ot,"onTransitionCancel"),Et(At,"onTransitionEnd"),fs("onMouseEnter",["mouseout","mouseover"]),fs("onMouseLeave",["mouseout","mouseover"]),fs("onPointerEnter",["pointerout","pointerover"]),fs("onPointerLeave",["pointerout","pointerover"]),Wi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Wi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Wi("onBeforeInput",["compositionend","keypress","textInput","paste"]),Wi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Wi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Wi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(pc));function mb(n,s){s=(s&4)!==0;for(var o=0;o<n.length;o++){var h=n[o],g=h.event;h=h.listeners;t:{var b=void 0;if(s)for(var T=h.length-1;0<=T;T--){var L=h[T],q=L.instance,at=L.currentTarget;if(L=L.listener,q!==b&&g.isPropagationStopped())break t;b=L,g.currentTarget=at;try{b(g)}catch(mt){Ut(mt)}g.currentTarget=null,b=q}else for(T=0;T<h.length;T++){if(L=h[T],q=L.instance,at=L.currentTarget,L=L.listener,q!==b&&g.isPropagationStopped())break t;b=L,g.currentTarget=at;try{b(g)}catch(mt){Ut(mt)}g.currentTarget=null,b=q}}}}function ge(n,s){var o=s[Ca];o===void 0&&(o=s[Ca]=new Set);var h=n+"__bubble";o.has(h)||(gb(s,n,2,!1),o.add(h))}function $f(n,s,o){var h=0;s&&(h|=4),gb(o,n,h,s)}var nh="_reactListening"+Math.random().toString(36).slice(2);function Xf(n){if(!n[nh]){n[nh]=!0,zs.forEach(function(o){o!=="selectionchange"&&(Qw.has(o)||$f(o,!1,n),$f(o,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[nh]||(s[nh]=!0,$f("selectionchange",!1,s))}}function gb(n,s,o,h){switch(Kb(s)){case 2:var g=E1;break;case 8:g=_1;break;default:g=cp}o=g.bind(null,s,o,n),g=void 0,!Nl||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?n.addEventListener(s,o,{capture:!0,passive:g}):n.addEventListener(s,o,!0):g!==void 0?n.addEventListener(s,o,{passive:g}):n.addEventListener(s,o,!1)}function Yf(n,s,o,h,g){var b=h;if((s&1)===0&&(s&2)===0&&h!==null)t:for(;;){if(h===null)return;var T=h.tag;if(T===3||T===4){var L=h.stateNode.containerInfo;if(L===g)break;if(T===4)for(T=h.return;T!==null;){var q=T.tag;if((q===3||q===4)&&T.stateNode.containerInfo===g)return;T=T.return}for(;L!==null;){if(T=ds(L),T===null)return;if(q=T.tag,q===5||q===6||q===26||q===27){h=b=T;continue t}L=L.parentNode}}h=h.return}Ra(function(){var at=b,mt=po(o),bt=[];t:{var lt=It.get(n);if(lt!==void 0){var ft=go,Kt=n;switch(n){case"keypress":if(Na(o)===0)break t;case"keydown":case"keyup":ft=Ao;break;case"focusin":Kt="focus",ft=ka;break;case"focusout":Kt="blur",ft=ka;break;case"beforeblur":case"afterblur":ft=ka;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ft=vo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ft=cu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ft=Fl;break;case ot:case nt:case pt:ft=uu;break;case At:ft=Il;break;case"scroll":case"scrollend":ft=yo;break;case"wheel":ft=_o;break;case"copy":case"cut":case"paste":ft=Oa;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ft=Bl;break;case"toggle":case"beforetoggle":ft=fu}var Zt=(s&4)!==0,qe=!Zt&&(n==="scroll"||n==="scrollend"),tt=Zt?lt!==null?lt+"Capture":null:lt;Zt=[];for(var W=at,st;W!==null;){var gt=W;if(st=gt.stateNode,gt=gt.tag,gt!==5&&gt!==26&&gt!==27||st===null||tt===null||(gt=Vs(W,tt),gt!=null&&Zt.push(mc(W,gt,st))),qe)break;W=W.return}0<Zt.length&&(lt=new ft(lt,Kt,null,o,mt),bt.push({event:lt,listeners:Zt}))}}if((s&7)===0){t:{if(lt=n==="mouseover"||n==="pointerover",ft=n==="mouseout"||n==="pointerout",lt&&o!==Oi&&(Kt=o.relatedTarget||o.fromElement)&&(ds(Kt)||Kt[Jn]))break t;if((ft||lt)&&(lt=mt.window===mt?mt:(lt=mt.ownerDocument)?lt.defaultView||lt.parentWindow:window,ft?(Kt=o.relatedTarget||o.toElement,ft=at,Kt=Kt?ds(Kt):null,Kt!==null&&(qe=l(Kt),Zt=Kt.tag,Kt!==qe||Zt!==5&&Zt!==27&&Zt!==6)&&(Kt=null)):(ft=null,Kt=at),ft!==Kt)){if(Zt=vo,gt="onMouseLeave",tt="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(Zt=Bl,gt="onPointerLeave",tt="onPointerEnter",W="pointer"),qe=ft==null?lt:bi(ft),st=Kt==null?lt:bi(Kt),lt=new Zt(gt,W+"leave",ft,o,mt),lt.target=qe,lt.relatedTarget=st,gt=null,ds(mt)===at&&(Zt=new Zt(tt,W+"enter",Kt,o,mt),Zt.target=st,Zt.relatedTarget=qe,gt=Zt),qe=gt,ft&&Kt)e:{for(Zt=Ww,tt=ft,W=Kt,st=0,gt=tt;gt;gt=Zt(gt))st++;gt=0;for(var Qt=W;Qt;Qt=Zt(Qt))gt++;for(;0<st-gt;)tt=Zt(tt),st--;for(;0<gt-st;)W=Zt(W),gt--;for(;st--;){if(tt===W||W!==null&&tt===W.alternate){Zt=tt;break e}tt=Zt(tt),W=Zt(W)}Zt=null}else Zt=null;ft!==null&&yb(bt,lt,ft,Zt,!1),Kt!==null&&qe!==null&&yb(bt,qe,Kt,Zt,!0)}}t:{if(lt=at?bi(at):window,ft=lt.nodeName&&lt.nodeName.toLowerCase(),ft==="select"||ft==="input"&&lt.type==="file")var Ae=kr;else if(Ro(lt))if(ji)Ae=Pa;else{Ae=Zs;var $t=vu}else ft=lt.nodeName,!ft||ft.toLowerCase()!=="input"||lt.type!=="checkbox"&&lt.type!=="radio"?at&&Dl(at.elementType)&&(Ae=kr):Ae=Gl;if(Ae&&(Ae=Ae(n,at))){ql(bt,Ae,o,mt);break t}$t&&$t(n,lt,at),n==="focusout"&&at&&lt.type==="number"&&at.memoizedProps.value!=null&&Er(lt,"number",lt.value)}switch($t=at?bi(at):window,n){case"focusin":(Ro($t)||$t.contentEditable==="true")&&(B=$t,V=at,et=null);break;case"focusout":et=V=B=null;break;case"mousedown":$=!0;break;case"contextmenu":case"mouseup":case"dragend":$=!1,K(bt,o,mt);break;case"selectionchange":if(j)break;case"keydown":case"keyup":K(bt,o,mt)}var ce;if(Dr)t:{switch(n){case"compositionstart":var be="onCompositionStart";break t;case"compositionend":be="onCompositionEnd";break t;case"compositionupdate":be="onCompositionUpdate";break t}be=void 0}else Qs?Hl(n,o)&&(be="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(be="onCompositionStart");be&&(Co&&o.locale!=="ko"&&(Qs||be!=="onCompositionStart"?be==="onCompositionEnd"&&Qs&&(ce=Da()):(Li=mt,mo="value"in Li?Li.value:Li.textContent,Qs=!0)),$t=ih(at,be),0<$t.length&&(be=new So(be,n,null,o,mt),bt.push({event:be,listeners:$t}),ce?be.data=ce:(ce=mu(o),ce!==null&&(be.data=ce)))),(ce=Cd?gu(n,o):Td(n,o))&&(be=ih(at,"onBeforeInput"),0<be.length&&($t=new So("onBeforeInput","beforeinput",null,o,mt),bt.push({event:$t,listeners:be}),$t.data=ce)),$w(bt,n,at,o,mt)}mb(bt,s)})}function mc(n,s,o){return{instance:n,listener:s,currentTarget:o}}function ih(n,s){for(var o=s+"Capture",h=[];n!==null;){var g=n,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=Vs(n,o),g!=null&&h.unshift(mc(n,g,b)),g=Vs(n,s),g!=null&&h.push(mc(n,g,b))),n.tag===3)return h;n=n.return}return[]}function Ww(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function yb(n,s,o,h,g){for(var b=s._reactName,T=[];o!==null&&o!==h;){var L=o,q=L.alternate,at=L.stateNode;if(L=L.tag,q!==null&&q===h)break;L!==5&&L!==26&&L!==27||at===null||(q=at,g?(at=Vs(o,b),at!=null&&T.unshift(mc(o,at,q))):g||(at=Vs(o,b),at!=null&&T.push(mc(o,at,q)))),o=o.return}T.length!==0&&n.push({event:s,listeners:T})}var Zw=/\r\n?/g,Jw=/\u0000|\uFFFD/g;function bb(n){return(typeof n=="string"?n:""+n).replace(Zw,`
`).replace(Jw,"")}function vb(n,s){return s=bb(s),bb(n)===s}function He(n,s,o,h,g,b){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||qs(n,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&qs(n,""+h);break;case"className":Sr(n,"class",h);break;case"tabIndex":Sr(n,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":Sr(n,o,h);break;case"style":Ml(n,h,b);break;case"data":if(s!=="object"){Sr(n,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){n.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Ji(""+h),n.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(o==="formAction"?(s!=="input"&&He(n,s,"name",g.name,g,null),He(n,s,"formEncType",g.formEncType,g,null),He(n,s,"formMethod",g.formMethod,g,null),He(n,s,"formTarget",g.formTarget,g,null)):(He(n,s,"encType",g.encType,g,null),He(n,s,"method",g.method,g,null),He(n,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Ji(""+h),n.setAttribute(o,h);break;case"onClick":h!=null&&(n.onclick=ri);break;case"onScroll":h!=null&&ge("scroll",n);break;case"onScrollEnd":h!=null&&ge("scrollend",n);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":n.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){n.removeAttribute("xlink:href");break}o=Ji(""+h),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""+h):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":h===!0?n.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,h):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?n.setAttribute(o,h):n.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?n.removeAttribute(o):n.setAttribute(o,h);break;case"popover":ge("beforetoggle",n),ge("toggle",n),ue(n,"popover",h);break;case"xlinkActuate":ki(n,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":ki(n,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":ki(n,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":ki(n,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":ki(n,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":ki(n,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":ki(n,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":ki(n,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":ki(n,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":ue(n,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=Ad.get(o)||o,ue(n,o,h))}}function Qf(n,s,o,h,g,b){switch(o){case"style":Ml(n,h,b);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof h=="string"?qs(n,h):(typeof h=="number"||typeof h=="bigint")&&qs(n,""+h);break;case"onScroll":h!=null&&ge("scroll",n);break;case"onScrollEnd":h!=null&&ge("scrollend",n);break;case"onClick":h!=null&&(n.onclick=ri);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xr.hasOwnProperty(o))t:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),b=n[un]||null,b=b!=null?b[o]:null,typeof b=="function"&&n.removeEventListener(s,b,g),typeof h=="function")){typeof b!="function"&&b!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(s,h,g);break t}o in n?n[o]=h:h===!0?n.setAttribute(o,""):ue(n,o,h)}}}function Un(n,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ge("error",n),ge("load",n);var h=!1,g=!1,b;for(b in o)if(o.hasOwnProperty(b)){var T=o[b];if(T!=null)switch(b){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:He(n,s,b,T,o,null)}}g&&He(n,s,"srcSet",o.srcSet,o,null),h&&He(n,s,"src",o.src,o,null);return;case"input":ge("invalid",n);var L=b=T=g=null,q=null,at=null;for(h in o)if(o.hasOwnProperty(h)){var mt=o[h];if(mt!=null)switch(h){case"name":g=mt;break;case"type":T=mt;break;case"checked":q=mt;break;case"defaultChecked":at=mt;break;case"value":b=mt;break;case"defaultValue":L=mt;break;case"children":case"dangerouslySetInnerHTML":if(mt!=null)throw Error(i(137,s));break;default:He(n,s,h,mt,o,null)}}fo(n,b,L,q,at,T,g,!1);return;case"select":ge("invalid",n),h=T=b=null;for(g in o)if(o.hasOwnProperty(g)&&(L=o[g],L!=null))switch(g){case"value":b=L;break;case"defaultValue":T=L;break;case"multiple":h=L;default:He(n,s,g,L,o,null)}s=b,o=T,n.multiple=!!h,s!=null?Zi(n,!!h,s,!1):o!=null&&Zi(n,!!h,o,!0);return;case"textarea":ge("invalid",n),b=g=h=null;for(T in o)if(o.hasOwnProperty(T)&&(L=o[T],L!=null))switch(T){case"value":h=L;break;case"defaultValue":g=L;break;case"children":b=L;break;case"dangerouslySetInnerHTML":if(L!=null)throw Error(i(91));break;default:He(n,s,T,L,o,null)}_r(n,h,g,b);return;case"option":for(q in o)o.hasOwnProperty(q)&&(h=o[q],h!=null)&&(q==="selected"?n.selected=h&&typeof h!="function"&&typeof h!="symbol":He(n,s,q,h,o,null));return;case"dialog":ge("beforetoggle",n),ge("toggle",n),ge("cancel",n),ge("close",n);break;case"iframe":case"object":ge("load",n);break;case"video":case"audio":for(h=0;h<pc.length;h++)ge(pc[h],n);break;case"image":ge("error",n),ge("load",n);break;case"details":ge("toggle",n);break;case"embed":case"source":case"link":ge("error",n),ge("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(at in o)if(o.hasOwnProperty(at)&&(h=o[at],h!=null))switch(at){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:He(n,s,at,h,o,null)}return;default:if(Dl(s)){for(mt in o)o.hasOwnProperty(mt)&&(h=o[mt],h!==void 0&&Qf(n,s,mt,h,o,void 0));return}}for(L in o)o.hasOwnProperty(L)&&(h=o[L],h!=null&&He(n,s,L,h,o,null))}function t1(n,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,T=null,L=null,q=null,at=null,mt=null;for(ft in o){var bt=o[ft];if(o.hasOwnProperty(ft)&&bt!=null)switch(ft){case"checked":break;case"value":break;case"defaultValue":q=bt;default:h.hasOwnProperty(ft)||He(n,s,ft,null,h,bt)}}for(var lt in h){var ft=h[lt];if(bt=o[lt],h.hasOwnProperty(lt)&&(ft!=null||bt!=null))switch(lt){case"type":b=ft;break;case"name":g=ft;break;case"checked":at=ft;break;case"defaultChecked":mt=ft;break;case"value":T=ft;break;case"defaultValue":L=ft;break;case"children":case"dangerouslySetInnerHTML":if(ft!=null)throw Error(i(137,s));break;default:ft!==bt&&He(n,s,lt,ft,h,bt)}}ps(n,T,L,q,at,mt,b,g);return;case"select":ft=T=L=lt=null;for(b in o)if(q=o[b],o.hasOwnProperty(b)&&q!=null)switch(b){case"value":break;case"multiple":ft=q;default:h.hasOwnProperty(b)||He(n,s,b,null,h,q)}for(g in h)if(b=h[g],q=o[g],h.hasOwnProperty(g)&&(b!=null||q!=null))switch(g){case"value":lt=b;break;case"defaultValue":L=b;break;case"multiple":T=b;default:b!==q&&He(n,s,g,b,h,q)}s=L,o=T,h=ft,lt!=null?Zi(n,!!o,lt,!1):!!h!=!!o&&(s!=null?Zi(n,!!o,s,!0):Zi(n,!!o,o?[]:"",!1));return;case"textarea":ft=lt=null;for(L in o)if(g=o[L],o.hasOwnProperty(L)&&g!=null&&!h.hasOwnProperty(L))switch(L){case"value":break;case"children":break;default:He(n,s,L,null,h,g)}for(T in h)if(g=h[T],b=o[T],h.hasOwnProperty(T)&&(g!=null||b!=null))switch(T){case"value":lt=g;break;case"defaultValue":ft=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==b&&He(n,s,T,g,h,b)}Rl(n,lt,ft);return;case"option":for(var Kt in o)lt=o[Kt],o.hasOwnProperty(Kt)&&lt!=null&&!h.hasOwnProperty(Kt)&&(Kt==="selected"?n.selected=!1:He(n,s,Kt,null,h,lt));for(q in h)lt=h[q],ft=o[q],h.hasOwnProperty(q)&&lt!==ft&&(lt!=null||ft!=null)&&(q==="selected"?n.selected=lt&&typeof lt!="function"&&typeof lt!="symbol":He(n,s,q,lt,h,ft));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Zt in o)lt=o[Zt],o.hasOwnProperty(Zt)&&lt!=null&&!h.hasOwnProperty(Zt)&&He(n,s,Zt,null,h,lt);for(at in h)if(lt=h[at],ft=o[at],h.hasOwnProperty(at)&&lt!==ft&&(lt!=null||ft!=null))switch(at){case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(i(137,s));break;default:He(n,s,at,lt,h,ft)}return;default:if(Dl(s)){for(var qe in o)lt=o[qe],o.hasOwnProperty(qe)&&lt!==void 0&&!h.hasOwnProperty(qe)&&Qf(n,s,qe,void 0,h,lt);for(mt in h)lt=h[mt],ft=o[mt],!h.hasOwnProperty(mt)||lt===ft||lt===void 0&&ft===void 0||Qf(n,s,mt,lt,h,ft);return}}for(var tt in o)lt=o[tt],o.hasOwnProperty(tt)&&lt!=null&&!h.hasOwnProperty(tt)&&He(n,s,tt,null,h,lt);for(bt in h)lt=h[bt],ft=o[bt],!h.hasOwnProperty(bt)||lt===ft||lt==null&&ft==null||He(n,s,bt,lt,h,ft)}function xb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function e1(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,o=performance.getEntriesByType("resource"),h=0;h<o.length;h++){var g=o[h],b=g.transferSize,T=g.initiatorType,L=g.duration;if(b&&L&&xb(T)){for(T=0,L=g.responseEnd,h+=1;h<o.length;h++){var q=o[h],at=q.startTime;if(at>L)break;var mt=q.transferSize,bt=q.initiatorType;mt&&xb(bt)&&(q=q.responseEnd,T+=mt*(q<L?1:(L-at)/(q-at)))}if(--h,s+=8*(b+T)/(g.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var Wf=null,Zf=null;function sh(n){return n.nodeType===9?n:n.ownerDocument}function wb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Sb(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Jf(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var tp=null;function n1(){var n=window.event;return n&&n.type==="popstate"?n===tp?!1:(tp=n,!0):(tp=null,!1)}var Ab=typeof setTimeout=="function"?setTimeout:void 0,i1=typeof clearTimeout=="function"?clearTimeout:void 0,Eb=typeof Promise=="function"?Promise:void 0,s1=typeof queueMicrotask=="function"?queueMicrotask:typeof Eb<"u"?function(n){return Eb.resolve(null).then(n).catch(a1)}:Ab;function a1(n){setTimeout(function(){throw n})}function tr(n){return n==="head"}function _b(n,s){var o=s,h=0;do{var g=o.nextSibling;if(n.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(h===0){n.removeChild(g),el(s);return}h--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")h++;else if(o==="html")gc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,gc(o);for(var b=o.firstChild;b;){var T=b.nextSibling,L=b.nodeName;b[yi]||L==="SCRIPT"||L==="STYLE"||L==="LINK"&&b.rel.toLowerCase()==="stylesheet"||o.removeChild(b),b=T}}else o==="body"&&gc(n.ownerDocument.body);o=g}while(o);el(s)}function Cb(n,s){var o=n;n=0;do{var h=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=h}while(o)}function ep(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":ep(o),uo(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function r1(n,s,o,h){for(;n.nodeType===1;){var g=o;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(h){if(!n[yi])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(b=n.getAttribute("rel"),b==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(b!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(b=n.getAttribute("src"),(b!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===b)return n}else return n;if(n=zi(n.nextSibling),n===null)break}return null}function o1(n,s,o){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=zi(n.nextSibling),n===null))return null;return n}function Tb(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=zi(n.nextSibling),n===null))return null;return n}function np(n){return n.data==="$?"||n.data==="$~"}function ip(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function l1(n,s){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||o.readyState!=="loading")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),n._reactRetry=h}}function zi(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var sp=null;function Rb(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(s===0)return zi(n.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}n=n.nextSibling}return null}function Mb(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return n;s--}else o!=="/$"&&o!=="/&"||s++}n=n.previousSibling}return null}function Db(n,s,o){switch(s=sh(o),n){case"html":if(n=s.documentElement,!n)throw Error(i(452));return n;case"head":if(n=s.head,!n)throw Error(i(453));return n;case"body":if(n=s.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function gc(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);uo(n)}var Hi=new Map,Nb=new Set;function ah(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var fa=ct.d;ct.d={f:c1,r:u1,D:h1,C:d1,L:f1,m:p1,X:g1,S:m1,M:y1};function c1(){var n=fa.f(),s=Qu();return n||s}function u1(n){var s=Ie(n);s!==null&&s.tag===5&&s.type==="form"?Xg(s):fa.r(n)}var Zo=typeof document>"u"?null:document;function kb(n,s,o){var h=Zo;if(h&&typeof s=="string"&&s){var g=Tn(s);g='link[rel="'+n+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Nb.has(g)||(Nb.add(g),n={rel:n,crossOrigin:o,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),Un(s,"link",n),hn(s),h.head.appendChild(s)))}}function h1(n){fa.D(n),kb("dns-prefetch",n,null)}function d1(n,s){fa.C(n,s),kb("preconnect",n,s)}function f1(n,s,o){fa.L(n,s,o);var h=Zo;if(h&&n&&s){var g='link[rel="preload"][as="'+Tn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Tn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Tn(o.imageSizes)+'"]')):g+='[href="'+Tn(n)+'"]';var b=g;switch(s){case"style":b=Jo(n);break;case"script":b=tl(n)}Hi.has(b)||(n=y({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:n,as:s},o),Hi.set(b,n),h.querySelector(g)!==null||s==="style"&&h.querySelector(yc(b))||s==="script"&&h.querySelector(bc(b))||(s=h.createElement("link"),Un(s,"link",n),hn(s),h.head.appendChild(s)))}}function p1(n,s){fa.m(n,s);var o=Zo;if(o&&n){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Tn(h)+'"][href="'+Tn(n)+'"]',b=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=tl(n)}if(!Hi.has(b)&&(n=y({rel:"modulepreload",href:n},s),Hi.set(b,n),o.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(bc(b)))return}h=o.createElement("link"),Un(h,"link",n),hn(h),o.head.appendChild(h)}}}function m1(n,s,o){fa.S(n,s,o);var h=Zo;if(h&&n){var g=$n(h).hoistableStyles,b=Jo(n);s=s||"default";var T=g.get(b);if(!T){var L={loading:0,preload:null};if(T=h.querySelector(yc(b)))L.loading=5;else{n=y({rel:"stylesheet",href:n,"data-precedence":s},o),(o=Hi.get(b))&&ap(n,o);var q=T=h.createElement("link");hn(q),Un(q,"link",n),q._p=new Promise(function(at,mt){q.onload=at,q.onerror=mt}),q.addEventListener("load",function(){L.loading|=1}),q.addEventListener("error",function(){L.loading|=2}),L.loading|=4,rh(T,s,h)}T={type:"stylesheet",instance:T,count:1,state:L},g.set(b,T)}}}function g1(n,s){fa.X(n,s);var o=Zo;if(o&&n){var h=$n(o).hoistableScripts,g=tl(n),b=h.get(g);b||(b=o.querySelector(bc(g)),b||(n=y({src:n,async:!0},s),(s=Hi.get(g))&&rp(n,s),b=o.createElement("script"),hn(b),Un(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function y1(n,s){fa.M(n,s);var o=Zo;if(o&&n){var h=$n(o).hoistableScripts,g=tl(n),b=h.get(g);b||(b=o.querySelector(bc(g)),b||(n=y({src:n,async:!0,type:"module"},s),(s=Hi.get(g))&&rp(n,s),b=o.createElement("script"),hn(b),Un(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function Ob(n,s,o,h){var g=(g=qt.current)?ah(g):null;if(!g)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Jo(o.href),o=$n(g).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Jo(o.href);var b=$n(g).hoistableStyles,T=b.get(n);if(T||(g=g.ownerDocument||g,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(n,T),(b=g.querySelector(yc(n)))&&!b._p&&(T.instance=b,T.state.loading=5),Hi.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Hi.set(n,o),b||b1(g,n,o,T.state))),s&&h===null)throw Error(i(528,""));return T}if(s&&h!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=tl(o),o=$n(g).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Jo(n){return'href="'+Tn(n)+'"'}function yc(n){return'link[rel="stylesheet"]['+n+"]"}function Lb(n){return y({},n,{"data-precedence":n.precedence,precedence:null})}function b1(n,s,o,h){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=n.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Un(s,"link",o),hn(s),n.head.appendChild(s))}function tl(n){return'[src="'+Tn(n)+'"]'}function bc(n){return"script[async]"+n}function jb(n,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=n.querySelector('style[data-href~="'+Tn(o.href)+'"]');if(h)return s.instance=h,hn(h),h;var g=y({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(n.ownerDocument||n).createElement("style"),hn(h),Un(h,"style",g),rh(h,o.precedence,n),s.instance=h;case"stylesheet":g=Jo(o.href);var b=n.querySelector(yc(g));if(b)return s.state.loading|=4,s.instance=b,hn(b),b;h=Lb(o),(g=Hi.get(g))&&ap(h,g),b=(n.ownerDocument||n).createElement("link"),hn(b);var T=b;return T._p=new Promise(function(L,q){T.onload=L,T.onerror=q}),Un(b,"link",h),s.state.loading|=4,rh(b,o.precedence,n),s.instance=b;case"script":return b=tl(o.src),(g=n.querySelector(bc(b)))?(s.instance=g,hn(g),g):(h=o,(g=Hi.get(b))&&(h=y({},o),rp(h,g)),n=n.ownerDocument||n,g=n.createElement("script"),hn(g),Un(g,"link",h),n.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,rh(h,o.precedence,n));return s.instance}function rh(n,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,b=g,T=0;T<h.length;T++){var L=h[T];if(L.dataset.precedence===s)b=L;else if(b!==g)break}b?b.parentNode.insertBefore(n,b.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(n,s.firstChild))}function ap(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function rp(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var oh=null;function Pb(n,s,o){if(oh===null){var h=new Map,g=oh=new Map;g.set(o,h)}else g=oh,h=g.get(o),h||(h=new Map,g.set(o,h));if(h.has(n))return h;for(h.set(n,null),o=o.getElementsByTagName(n),g=0;g<o.length;g++){var b=o[g];if(!(b[yi]||b[$e]||n==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var T=b.getAttribute(s)||"";T=n+T;var L=h.get(T);L?L.push(b):h.set(T,[b])}}return h}function Bb(n,s,o){n=n.ownerDocument||n,n.head.insertBefore(o,s==="title"?n.querySelector("head > title"):null)}function v1(n,s,o){if(o===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(n=s.disabled,typeof s.precedence=="string"&&n==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Fb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function x1(n,s,o,h){if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Jo(h.href),b=s.querySelector(yc(g));if(b){s=b._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=lh.bind(n),s.then(n,n)),o.state.loading|=4,o.instance=b,hn(b);return}b=s.ownerDocument||s,h=Lb(h),(g=Hi.get(g))&&ap(h,g),b=b.createElement("link"),hn(b);var T=b;T._p=new Promise(function(L,q){T.onload=L,T.onerror=q}),Un(b,"link",h),o.instance=b}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=lh.bind(n),s.addEventListener("load",o),s.addEventListener("error",o))}}var op=0;function w1(n,s){return n.stylesheets&&n.count===0&&uh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var h=setTimeout(function(){if(n.stylesheets&&uh(n,n.stylesheets),n.unsuspend){var b=n.unsuspend;n.unsuspend=null,b()}},6e4+s);0<n.imgBytes&&op===0&&(op=62500*e1());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&uh(n,n.stylesheets),n.unsuspend)){var b=n.unsuspend;n.unsuspend=null,b()}},(n.imgBytes>op?50:800)+s);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function lh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)uh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var ch=null;function uh(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,ch=new Map,s.forEach(S1,n),ch=null,lh.call(n))}function S1(n,s){if(!(s.state.loading&4)){var o=ch.get(n);if(o)var h=o.get(null);else{o=new Map,ch.set(n,o);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var T=g[b];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),h=T)}h&&o.set(null,h)}g=s.instance,T=g.getAttribute("data-precedence"),b=o.get(T)||h,b===h&&o.set(null,g),o.set(T,g),this.count++,h=lh.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),b?b.parentNode.insertBefore(g,b.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),s.state.loading|=4}}var vc={$$typeof:O,Provider:null,Consumer:null,_currentValue:yt,_currentValue2:yt,_threadCount:0};function A1(n,s,o,h,g,b,T,L,q){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cs(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cs(0),this.hiddenUpdates=cs(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Ib(n,s,o,h,g,b,T,L,q,at,mt,bt){return n=new A1(n,s,o,T,q,at,mt,bt,L),s=1,b===!0&&(s|=24),b=xi(3,null,null,s),n.current=b,b.stateNode=n,s=Id(),s.refCount++,n.pooledCache=s,s.refCount++,b.memoizedState={element:h,isDehydrated:o,cache:s},qd(b),n}function Ub(n){return n?(n=No,n):No}function zb(n,s,o,h,g,b){g=Ub(g),h.context===null?h.context=g:h.pendingContext=g,h=qa(s),h.payload={element:o},b=b===void 0?null:b,b!==null&&(h.callback=b),o=Ga(n,h,s),o!==null&&(hi(o,n,s),Wl(o,n,s))}function Hb(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<s?o:s}}function lp(n,s){Hb(n,s),(n=n.alternate)&&Hb(n,s)}function qb(n){if(n.tag===13||n.tag===31){var s=je(n,67108864);s!==null&&hi(s,n,67108864),lp(n,67108864)}}function Gb(n){if(n.tag===13||n.tag===31){var s=_i();s=El(s);var o=je(n,s);o!==null&&hi(o,n,s),lp(n,s)}}var hh=!0;function E1(n,s,o,h){var g=G.T;G.T=null;var b=ct.p;try{ct.p=2,cp(n,s,o,h)}finally{ct.p=b,G.T=g}}function _1(n,s,o,h){var g=G.T;G.T=null;var b=ct.p;try{ct.p=8,cp(n,s,o,h)}finally{ct.p=b,G.T=g}}function cp(n,s,o,h){if(hh){var g=up(h);if(g===null)Yf(n,s,h,dh,o),Vb(n,h);else if(T1(g,n,s,o,h))h.stopPropagation();else if(Vb(n,h),s&4&&-1<C1.indexOf(n)){for(;g!==null;){var b=Ie(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var T=Qi(b.pendingLanes);if(T!==0){var L=b;for(L.pendingLanes|=2,L.entangledLanes|=2;T;){var q=1<<31-Ft(T);L.entanglements[1]|=q,T&=~q}Ss(b),(Me&6)===0&&(Xu=Kn()+500,fc(0))}}break;case 31:case 13:L=je(b,2),L!==null&&hi(L,b,2),Qu(),lp(b,2)}if(b=up(h),b===null&&Yf(n,s,h,dh,o),b===g)break;g=b}g!==null&&h.stopPropagation()}else Yf(n,s,h,null,o)}}function up(n){return n=po(n),hp(n)}var dh=null;function hp(n){if(dh=null,n=ds(n),n!==null){var s=l(n);if(s===null)n=null;else{var o=s.tag;if(o===13){if(n=c(s),n!==null)return n;n=null}else if(o===31){if(n=u(s),n!==null)return n;n=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return dh=n,null}function Kb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(dr()){case Vn:return 2;case os:return 8;case Aa:case fr:return 32;case oo:return 268435456;default:return 32}default:return 32}}var dp=!1,er=null,nr=null,ir=null,xc=new Map,wc=new Map,sr=[],C1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Vb(n,s){switch(n){case"focusin":case"focusout":er=null;break;case"dragenter":case"dragleave":nr=null;break;case"mouseover":case"mouseout":ir=null;break;case"pointerover":case"pointerout":xc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":wc.delete(s.pointerId)}}function Sc(n,s,o,h,g,b){return n===null||n.nativeEvent!==b?(n={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:b,targetContainers:[g]},s!==null&&(s=Ie(s),s!==null&&qb(s)),n):(n.eventSystemFlags|=h,s=n.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),n)}function T1(n,s,o,h,g){switch(s){case"focusin":return er=Sc(er,n,s,o,h,g),!0;case"dragenter":return nr=Sc(nr,n,s,o,h,g),!0;case"mouseover":return ir=Sc(ir,n,s,o,h,g),!0;case"pointerover":var b=g.pointerId;return xc.set(b,Sc(xc.get(b)||null,n,s,o,h,g)),!0;case"gotpointercapture":return b=g.pointerId,wc.set(b,Sc(wc.get(b)||null,n,s,o,h,g)),!0}return!1}function $b(n){var s=ds(n.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){n.blockedOn=s,vr(n.priority,function(){Gb(o)});return}}else if(s===31){if(s=u(o),s!==null){n.blockedOn=s,vr(n.priority,function(){Gb(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function fh(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var o=up(n.nativeEvent);if(o===null){o=n.nativeEvent;var h=new o.constructor(o.type,o);Oi=h,o.target.dispatchEvent(h),Oi=null}else return s=Ie(o),s!==null&&qb(s),n.blockedOn=o,!1;s.shift()}return!0}function Xb(n,s,o){fh(n)&&o.delete(s)}function R1(){dp=!1,er!==null&&fh(er)&&(er=null),nr!==null&&fh(nr)&&(nr=null),ir!==null&&fh(ir)&&(ir=null),xc.forEach(Xb),wc.forEach(Xb)}function ph(n,s){n.blockedOn===s&&(n.blockedOn=null,dp||(dp=!0,r.unstable_scheduleCallback(r.unstable_NormalPriority,R1)))}var mh=null;function Yb(n){mh!==n&&(mh=n,r.unstable_scheduleCallback(r.unstable_NormalPriority,function(){mh===n&&(mh=null);for(var s=0;s<n.length;s+=3){var o=n[s],h=n[s+1],g=n[s+2];if(typeof h!="function"){if(hp(h||o)===null)continue;break}var b=Ie(o);b!==null&&(n.splice(s,3),s-=3,uf(b,{pending:!0,data:g,method:o.method,action:h},h,g))}}))}function el(n){function s(q){return ph(q,n)}er!==null&&ph(er,n),nr!==null&&ph(nr,n),ir!==null&&ph(ir,n),xc.forEach(s),wc.forEach(s);for(var o=0;o<sr.length;o++){var h=sr[o];h.blockedOn===n&&(h.blockedOn=null)}for(;0<sr.length&&(o=sr[0],o.blockedOn===null);)$b(o),o.blockedOn===null&&sr.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var g=o[h],b=o[h+1],T=g[un]||null;if(typeof b=="function")T||Yb(o);else if(T){var L=null;if(b&&b.hasAttribute("formAction")){if(g=b,T=b[un]||null)L=T.formAction;else if(hp(g)!==null)continue}else L=T.action;typeof L=="function"?o[h+1]=L:(o.splice(h,3),h-=3),Yb(o)}}}function Qb(){function n(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(T){return g=T})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),h||setTimeout(o,20)}function o(){if(!h&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){h=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function fp(n){this._internalRoot=n}gh.prototype.render=fp.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,h=_i();zb(o,h,n,s,null,null)},gh.prototype.unmount=fp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;zb(n.current,2,null,n,null,null),Qu(),s[Jn]=null}};function gh(n){this._internalRoot=n}gh.prototype.unstable_scheduleHydration=function(n){if(n){var s=br();n={blockedOn:null,target:n,priority:s};for(var o=0;o<sr.length&&s!==0&&s<sr[o].priority;o++);sr.splice(o,0,n),o===0&&$b(n)}};var Wb=t.version;if(Wb!=="19.2.4")throw Error(i(527,Wb,"19.2.4"));ct.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(s),n=n!==null?p(n):null,n=n===null?null:n.stateNode,n};var M1={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{ls=yh.inject(M1),Ln=yh}catch{}}return Ec.createRoot=function(n,s){if(!a(n))throw Error(i(299));var o=!1,h="",g=sy,b=ay,T=ry;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),s=Ib(n,1,!1,null,null,o,h,null,g,b,T,Qb),n[Jn]=s.current,Xf(n),new fp(s)},Ec.hydrateRoot=function(n,s,o){if(!a(n))throw Error(i(299));var h=!1,g="",b=sy,T=ay,L=ry,q=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(L=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),s=Ib(n,1,!0,s,o??null,h,g,q,b,T,L,Qb),s.context=Ub(null),o=s.current,h=_i(),h=El(h),g=qa(h),g.callback=null,Ga(o,g,h),o=h,s.current.lanes=o,Ni(s,o),Ss(s),n[Jn]=s.current,Xf(n),new gh(s)},Ec.version="19.2.4",Ec}var c0;function I1(){if(c0)return yp.exports;c0=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}return r(),yp.exports=F1(),yp.exports}var U1=I1();var u0="popstate";function z1(r={}){function t(i,a){let{pathname:l,search:c,hash:u}=i.location;return Pp("",{pathname:l,search:c,hash:u},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function e(i,a){return typeof a=="string"?a:Ic(a)}return q1(t,e,null,r)}function en(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function ss(r,t){if(!r){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function H1(){return Math.random().toString(36).substring(2,10)}function h0(r,t){return{usr:r.state,key:r.key,idx:t}}function Pp(r,t,e=null,i){return{pathname:typeof r=="string"?r:r.pathname,search:"",hash:"",...typeof t=="string"?bl(t):t,state:e,key:t&&t.key||i||H1()}}function Ic({pathname:r="/",search:t="",hash:e=""}){return t&&t!=="?"&&(r+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(r+=e.charAt(0)==="#"?e:"#"+e),r}function bl(r){let t={};if(r){let e=r.indexOf("#");e>=0&&(t.hash=r.substring(e),r=r.substring(0,e));let i=r.indexOf("?");i>=0&&(t.search=r.substring(i),r=r.substring(0,i)),r&&(t.pathname=r)}return t}function q1(r,t,e,i={}){let{window:a=document.defaultView,v5Compat:l=!1}=i,c=a.history,u="POP",d=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function y(){u="POP";let R=p(),D=R==null?null:R-f;f=R,d&&d({action:u,location:E.location,delta:D})}function x(R,D){u="PUSH";let k=Pp(E.location,R,D);f=p()+1;let O=h0(k,f),I=E.createHref(k);try{c.pushState(O,"",I)}catch(z){if(z instanceof DOMException&&z.name==="DataCloneError")throw z;a.location.assign(I)}l&&d&&d({action:u,location:E.location,delta:1})}function S(R,D){u="REPLACE";let k=Pp(E.location,R,D);f=p();let O=h0(k,f),I=E.createHref(k);c.replaceState(O,"",I),l&&d&&d({action:u,location:E.location,delta:0})}function A(R){return G1(R)}let E={get action(){return u},get location(){return r(a,c)},listen(R){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(u0,y),d=R,()=>{a.removeEventListener(u0,y),d=null}},createHref(R){return t(a,R)},createURL:A,encodeLocation(R){let D=A(R);return{pathname:D.pathname,search:D.search,hash:D.hash}},push:x,replace:S,go(R){return c.go(R)}};return E}function G1(r,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),en(e,"No window.location.(origin|href) available to create URL");let i=typeof r=="string"?r:Ic(r);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function kv(r,t,e="/"){return K1(r,t,e,!1)}function K1(r,t,e,i){let a=typeof t=="string"?bl(t):t,l=xa(a.pathname||"/",e);if(l==null)return null;let c=Ov(r);V1(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let f=iS(l);u=eS(c[d],f,i)}return u}function Ov(r,t=[],e=[],i="",a=!1){let l=(c,u,d=a,f)=>{let p={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(i)&&d)return;en(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length)}let y=va([i,p.relativePath]),x=e.concat(p);c.children&&c.children.length>0&&(en(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),Ov(c.children,t,x,y,d)),!(c.path==null&&!c.index)&&t.push({path:y,score:J1(y,c.index),routesMeta:x})};return r.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let d of Lv(c.path))l(c,u,!0,d)}),t}function Lv(r){let t=r.split("/");if(t.length===0)return[];let[e,...i]=t,a=e.endsWith("?"),l=e.replace(/\?$/,"");if(i.length===0)return a?[l,""]:[l];let c=Lv(i.join("/")),u=[];return u.push(...c.map(d=>d===""?l:[l,d].join("/"))),a&&u.push(...c),u.map(d=>r.startsWith("/")&&d===""?"/":d)}function V1(r){r.sort((t,e)=>t.score!==e.score?e.score-t.score:tS(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var $1=/^:[\w-]+$/,X1=3,Y1=2,Q1=1,W1=10,Z1=-2,d0=r=>r==="*";function J1(r,t){let e=r.split("/"),i=e.length;return e.some(d0)&&(i+=Z1),t&&(i+=Y1),e.filter(a=>!d0(a)).reduce((a,l)=>a+($1.test(l)?X1:l===""?Q1:W1),i)}function tS(r,t){return r.length===t.length&&r.slice(0,-1).every((i,a)=>i===t[a])?r[r.length-1]-t[t.length-1]:0}function eS(r,t,e=!1){let{routesMeta:i}=r,a={},l="/",c=[];for(let u=0;u<i.length;++u){let d=i[u],f=u===i.length-1,p=l==="/"?t:t.slice(l.length)||"/",y=Hh({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},p),x=d.route;if(!y&&f&&e&&!i[i.length-1].route.index&&(y=Hh({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!y)return null;Object.assign(a,y.params),c.push({params:a,pathname:va([l,y.pathname]),pathnameBase:oS(va([l,y.pathnameBase])),route:x}),y.pathnameBase!=="/"&&(l=va([l,y.pathnameBase]))}return c}function Hh(r,t){typeof r=="string"&&(r={path:r,caseSensitive:!1,end:!0});let[e,i]=nS(r.path,r.caseSensitive,r.end),a=t.match(e);if(!a)return null;let l=a[0],c=l.replace(/(.)\/+$/,"$1"),u=a.slice(1);return{params:i.reduce((f,{paramName:p,isOptional:y},x)=>{if(p==="*"){let A=u[x]||"";c=l.slice(0,l.length-A.length).replace(/(.)\/+$/,"$1")}const S=u[x];return y&&!S?f[p]=void 0:f[p]=(S||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:r}}function nS(r,t=!1,e=!0){ss(r==="*"||!r.endsWith("*")||r.endsWith("/*"),`Route path "${r}" will be treated as if it were "${r.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${r.replace(/\*$/,"/*")}".`);let i=[],a="^"+r.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return r.endsWith("*")?(i.push({paramName:"*"}),a+=r==="*"||r==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?a+="\\/*$":r!==""&&r!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),i]}function iS(r){try{return r.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return ss(!1,`The URL path "${r}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),r}}function xa(r,t){if(t==="/")return r;if(!r.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=r.charAt(e);return i&&i!=="/"?null:r.slice(e)||"/"}var sS=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function aS(r,t="/"){let{pathname:e,search:i="",hash:a=""}=typeof r=="string"?bl(r):r,l;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?l=f0(e.substring(1),"/"):l=f0(e,t)):l=t,{pathname:l,search:lS(i),hash:cS(a)}}function f0(r,t){let e=t.replace(/\/+$/,"").split("/");return r.split("/").forEach(a=>{a===".."?e.length>1&&e.pop():a!=="."&&e.push(a)}),e.length>1?e.join("/"):"/"}function wp(r,t,e,i){return`Cannot include a '${r}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function rS(r){return r.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function pm(r){let t=rS(r);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function mm(r,t,e,i=!1){let a;typeof r=="string"?a=bl(r):(a={...r},en(!a.pathname||!a.pathname.includes("?"),wp("?","pathname","search",a)),en(!a.pathname||!a.pathname.includes("#"),wp("#","pathname","hash",a)),en(!a.search||!a.search.includes("#"),wp("#","search","hash",a)));let l=r===""||a.pathname==="",c=l?"/":a.pathname,u;if(c==null)u=e;else{let y=t.length-1;if(!i&&c.startsWith("..")){let x=c.split("/");for(;x[0]==="..";)x.shift(),y-=1;a.pathname=x.join("/")}u=y>=0?t[y]:"/"}let d=aS(a,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||p)&&(d.pathname+="/"),d}var va=r=>r.join("/").replace(/\/\/+/g,"/"),oS=r=>r.replace(/\/+$/,"").replace(/^\/*/,"/"),lS=r=>!r||r==="?"?"":r.startsWith("?")?r:"?"+r,cS=r=>!r||r==="#"?"":r.startsWith("#")?r:"#"+r,uS=class{constructor(r,t,e,i=!1){this.status=r,this.statusText=t||"",this.internal=i,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function hS(r){return r!=null&&typeof r.status=="number"&&typeof r.statusText=="string"&&typeof r.internal=="boolean"&&"data"in r}function dS(r){return r.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var jv=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Pv(r,t){let e=r;if(typeof e!="string"||!sS.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let i=e,a=!1;if(jv)try{let l=new URL(window.location.href),c=e.startsWith("//")?new URL(l.protocol+e):new URL(e),u=xa(c.pathname,t);c.origin===l.origin&&u!=null?e=u+c.search+c.hash:a=!0}catch{ss(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:a,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Bv=["POST","PUT","PATCH","DELETE"];new Set(Bv);var fS=["GET",...Bv];new Set(fS);var vl=U.createContext(null);vl.displayName="DataRouter";var Jh=U.createContext(null);Jh.displayName="DataRouterState";var pS=U.createContext(!1),Fv=U.createContext({isTransitioning:!1});Fv.displayName="ViewTransition";var mS=U.createContext(new Map);mS.displayName="Fetchers";var gS=U.createContext(null);gS.displayName="Await";var Di=U.createContext(null);Di.displayName="Navigation";var $c=U.createContext(null);$c.displayName="Location";var as=U.createContext({outlet:null,matches:[],isDataRoute:!1});as.displayName="Route";var gm=U.createContext(null);gm.displayName="RouteError";var Iv="REACT_ROUTER_ERROR",yS="REDIRECT",bS="ROUTE_ERROR_RESPONSE";function vS(r){if(r.startsWith(`${Iv}:${yS}:{`))try{let t=JSON.parse(r.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function xS(r){if(r.startsWith(`${Iv}:${bS}:{`))try{let t=JSON.parse(r.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new uS(t.status,t.statusText,t.data)}catch{}}function wS(r,{relative:t}={}){en(xl(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=U.useContext(Di),{hash:a,pathname:l,search:c}=Xc(r,{relative:t}),u=l;return e!=="/"&&(u=l==="/"?e:va([e,l])),i.createHref({pathname:u,search:c,hash:a})}function xl(){return U.useContext($c)!=null}function hr(){return en(xl(),"useLocation() may be used only in the context of a <Router> component."),U.useContext($c).location}var Uv="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function zv(r){U.useContext(Di).static||U.useLayoutEffect(r)}function wa(){let{isDataRoute:r}=U.useContext(as);return r?LS():SS()}function SS(){en(xl(),"useNavigate() may be used only in the context of a <Router> component.");let r=U.useContext(vl),{basename:t,navigator:e}=U.useContext(Di),{matches:i}=U.useContext(as),{pathname:a}=hr(),l=JSON.stringify(pm(i)),c=U.useRef(!1);return zv(()=>{c.current=!0}),U.useCallback((d,f={})=>{if(ss(c.current,Uv),!c.current)return;if(typeof d=="number"){e.go(d);return}let p=mm(d,JSON.parse(l),a,f.relative==="path");r==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:va([t,p.pathname])),(f.replace?e.replace:e.push)(p,f.state,f)},[t,e,l,a,r])}U.createContext(null);function ym(){let{matches:r}=U.useContext(as),t=r[r.length-1];return t?t.params:{}}function Xc(r,{relative:t}={}){let{matches:e}=U.useContext(as),{pathname:i}=hr(),a=JSON.stringify(pm(e));return U.useMemo(()=>mm(r,JSON.parse(a),i,t==="path"),[r,a,i,t])}function AS(r,t){return Hv(r,t)}function Hv(r,t,e,i,a){en(xl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=U.useContext(Di),{matches:c}=U.useContext(as),u=c[c.length-1],d=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",y=u&&u.route;{let k=y&&y.path||"";Gv(f,!y||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let x=hr(),S;if(t){let k=typeof t=="string"?bl(t):t;en(p==="/"||k.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${k.pathname}" was given in the \`location\` prop.`),S=k}else S=x;let A=S.pathname||"/",E=A;if(p!=="/"){let k=p.replace(/^\//,"").split("/");E="/"+A.replace(/^\//,"").split("/").slice(k.length).join("/")}let R=kv(r,{pathname:E});ss(y||R!=null,`No routes matched location "${S.pathname}${S.search}${S.hash}" `),ss(R==null||R[R.length-1].route.element!==void 0||R[R.length-1].route.Component!==void 0||R[R.length-1].route.lazy!==void 0,`Matched leaf route at location "${S.pathname}${S.search}${S.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let D=RS(R&&R.map(k=>Object.assign({},k,{params:Object.assign({},d,k.params),pathname:va([p,l.encodeLocation?l.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?p:va([p,l.encodeLocation?l.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),c,e,i,a);return t&&D?U.createElement($c.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...S},navigationType:"POP"}},D):D}function ES(){let r=OS(),t=hS(r)?`${r.status} ${r.statusText}`:r instanceof Error?r.message:JSON.stringify(r),e=r instanceof Error?r.stack:null,i="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",r),c=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:l},"ErrorBoundary")," or"," ",U.createElement("code",{style:l},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},t),e?U.createElement("pre",{style:a},e):null,c)}var _S=U.createElement(ES,null),qv=class extends U.Component{constructor(r){super(r),this.state={location:r.location,revalidation:r.revalidation,error:r.error}}static getDerivedStateFromError(r){return{error:r}}static getDerivedStateFromProps(r,t){return t.location!==r.location||t.revalidation!=="idle"&&r.revalidation==="idle"?{error:r.error,location:r.location,revalidation:r.revalidation}:{error:r.error!==void 0?r.error:t.error,location:t.location,revalidation:r.revalidation||t.revalidation}}componentDidCatch(r,t){this.props.onError?this.props.onError(r,t):console.error("React Router caught the following error during render",r)}render(){let r=this.state.error;if(this.context&&typeof r=="object"&&r&&"digest"in r&&typeof r.digest=="string"){const e=xS(r.digest);e&&(r=e)}let t=r!==void 0?U.createElement(as.Provider,{value:this.props.routeContext},U.createElement(gm.Provider,{value:r,children:this.props.component})):this.props.children;return this.context?U.createElement(CS,{error:r},t):t}};qv.contextType=pS;var Sp=new WeakMap;function CS({children:r,error:t}){let{basename:e}=U.useContext(Di);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=vS(t.digest);if(i){let a=Sp.get(t);if(a)throw a;let l=Pv(i.location,e);if(jv&&!Sp.get(t))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw Sp.set(t,c),c}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return r}function TS({routeContext:r,match:t,children:e}){let i=U.useContext(vl);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),U.createElement(as.Provider,{value:r},e)}function RS(r,t=[],e=null,i=null,a=null){if(r==null){if(!e)return null;if(e.errors)r=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)r=e.matches;else return null}let l=r,c=e?.errors;if(c!=null){let p=l.findIndex(y=>y.route.id&&c?.[y.route.id]!==void 0);en(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,p+1))}let u=!1,d=-1;if(e)for(let p=0;p<l.length;p++){let y=l[p];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=p),y.route.id){let{loaderData:x,errors:S}=e,A=y.route.loader&&!x.hasOwnProperty(y.route.id)&&(!S||S[y.route.id]===void 0);if(y.route.lazy||A){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}let f=e&&i?(p,y)=>{i(p,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:dS(e.matches),errorInfo:y})}:void 0;return l.reduceRight((p,y,x)=>{let S,A=!1,E=null,R=null;e&&(S=c&&y.route.id?c[y.route.id]:void 0,E=y.route.errorElement||_S,u&&(d<0&&x===0?(Gv("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),A=!0,R=null):d===x&&(A=!0,R=y.route.hydrateFallbackElement||null)));let D=t.concat(l.slice(0,x+1)),k=()=>{let O;return S?O=E:A?O=R:y.route.Component?O=U.createElement(y.route.Component,null):y.route.element?O=y.route.element:O=p,U.createElement(TS,{match:y,routeContext:{outlet:p,matches:D,isDataRoute:e!=null},children:O})};return e&&(y.route.ErrorBoundary||y.route.errorElement||x===0)?U.createElement(qv,{location:e.location,revalidation:e.revalidation,component:E,error:S,children:k(),routeContext:{outlet:null,matches:D,isDataRoute:!0},onError:f}):k()},null)}function bm(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function MS(r){let t=U.useContext(vl);return en(t,bm(r)),t}function DS(r){let t=U.useContext(Jh);return en(t,bm(r)),t}function NS(r){let t=U.useContext(as);return en(t,bm(r)),t}function vm(r){let t=NS(r),e=t.matches[t.matches.length-1];return en(e.route.id,`${r} can only be used on routes that contain a unique "id"`),e.route.id}function kS(){return vm("useRouteId")}function OS(){let r=U.useContext(gm),t=DS("useRouteError"),e=vm("useRouteError");return r!==void 0?r:t.errors?.[e]}function LS(){let{router:r}=MS("useNavigate"),t=vm("useNavigate"),e=U.useRef(!1);return zv(()=>{e.current=!0}),U.useCallback(async(a,l={})=>{ss(e.current,Uv),e.current&&(typeof a=="number"?await r.navigate(a):await r.navigate(a,{fromRouteId:t,...l}))},[r,t])}var p0={};function Gv(r,t,e){!t&&!p0[r]&&(p0[r]=!0,ss(!1,e))}U.memo(jS);function jS({routes:r,future:t,state:e,onError:i}){return Hv(r,void 0,e,i,t)}function qh({to:r,replace:t,state:e,relative:i}){en(xl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:a}=U.useContext(Di);ss(!a,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=U.useContext(as),{pathname:c}=hr(),u=wa(),d=mm(r,pm(l),c,i==="path"),f=JSON.stringify(d);return U.useEffect(()=>{u(JSON.parse(f),{replace:t,state:e,relative:i})},[u,f,i,t,e]),null}function Rs(r){en(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function PS({basename:r="/",children:t=null,location:e,navigationType:i="POP",navigator:a,static:l=!1,unstable_useTransitions:c}){en(!xl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=r.replace(/^\/*/,"/"),d=U.useMemo(()=>({basename:u,navigator:a,static:l,unstable_useTransitions:c,future:{}}),[u,a,l,c]);typeof e=="string"&&(e=bl(e));let{pathname:f="/",search:p="",hash:y="",state:x=null,key:S="default"}=e,A=U.useMemo(()=>{let E=xa(f,u);return E==null?null:{location:{pathname:E,search:p,hash:y,state:x,key:S},navigationType:i}},[u,f,p,y,x,S,i]);return ss(A!=null,`<Router basename="${u}"> is not able to match the URL "${f}${p}${y}" because it does not start with the basename, so the <Router> won't render anything.`),A==null?null:U.createElement(Di.Provider,{value:d},U.createElement($c.Provider,{children:t,value:A}))}function BS({children:r,location:t}){return AS(Bp(r),t)}function Bp(r,t=[]){let e=[];return U.Children.forEach(r,(i,a)=>{if(!U.isValidElement(i))return;let l=[...t,a];if(i.type===U.Fragment){e.push.apply(e,Bp(i.props.children,l));return}en(i.type===Rs,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),en(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Bp(i.props.children,l)),e.push(c)}),e}var Oh="get",Lh="application/x-www-form-urlencoded";function td(r){return typeof HTMLElement<"u"&&r instanceof HTMLElement}function FS(r){return td(r)&&r.tagName.toLowerCase()==="button"}function IS(r){return td(r)&&r.tagName.toLowerCase()==="form"}function US(r){return td(r)&&r.tagName.toLowerCase()==="input"}function zS(r){return!!(r.metaKey||r.altKey||r.ctrlKey||r.shiftKey)}function HS(r,t){return r.button===0&&(!t||t==="_self")&&!zS(r)}var vh=null;function qS(){if(vh===null)try{new FormData(document.createElement("form"),0),vh=!1}catch{vh=!0}return vh}var GS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Ap(r){return r!=null&&!GS.has(r)?(ss(!1,`"${r}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lh}"`),null):r}function KS(r,t){let e,i,a,l,c;if(IS(r)){let u=r.getAttribute("action");i=u?xa(u,t):null,e=r.getAttribute("method")||Oh,a=Ap(r.getAttribute("enctype"))||Lh,l=new FormData(r)}else if(FS(r)||US(r)&&(r.type==="submit"||r.type==="image")){let u=r.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=r.getAttribute("formaction")||u.getAttribute("action");if(i=d?xa(d,t):null,e=r.getAttribute("formmethod")||u.getAttribute("method")||Oh,a=Ap(r.getAttribute("formenctype"))||Ap(u.getAttribute("enctype"))||Lh,l=new FormData(u,r),!qS()){let{name:f,type:p,value:y}=r;if(p==="image"){let x=f?`${f}.`:"";l.append(`${x}x`,"0"),l.append(`${x}y`,"0")}else f&&l.append(f,y)}}else{if(td(r))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Oh,i=null,a=Lh,c=r}return l&&a==="text/plain"&&(c=l,l=void 0),{action:i,method:e.toLowerCase(),encType:a,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function xm(r,t){if(r===!1||r===null||typeof r>"u")throw new Error(t)}function VS(r,t,e,i){let a=typeof r=="string"?new URL(r,typeof window>"u"?"server://singlefetch/":window.location.origin):r;return e?a.pathname.endsWith("/")?a.pathname=`${a.pathname}_.${i}`:a.pathname=`${a.pathname}.${i}`:a.pathname==="/"?a.pathname=`_root.${i}`:t&&xa(a.pathname,t)==="/"?a.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:a.pathname=`${a.pathname.replace(/\/$/,"")}.${i}`,a}async function $S(r,t){if(r.id in t)return t[r.id];try{let e=await import(r.module);return t[r.id]=e,e}catch(e){return console.error(`Error loading route module \`${r.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function XS(r){return r==null?!1:r.href==null?r.rel==="preload"&&typeof r.imageSrcSet=="string"&&typeof r.imageSizes=="string":typeof r.rel=="string"&&typeof r.href=="string"}async function YS(r,t,e){let i=await Promise.all(r.map(async a=>{let l=t.routes[a.route.id];if(l){let c=await $S(l,e);return c.links?c.links():[]}return[]}));return JS(i.flat(1).filter(XS).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function m0(r,t,e,i,a,l){let c=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return l==="assets"?t.filter((d,f)=>c(d,f)||u(d,f)):l==="data"?t.filter((d,f)=>{let p=i.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(c(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(r,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function QS(r,t,{includeHydrateFallback:e}={}){return WS(r.map(i=>{let a=t.routes[i.route.id];if(!a)return[];let l=[a.module];return a.clientActionModule&&(l=l.concat(a.clientActionModule)),a.clientLoaderModule&&(l=l.concat(a.clientLoaderModule)),e&&a.hydrateFallbackModule&&(l=l.concat(a.hydrateFallbackModule)),a.imports&&(l=l.concat(a.imports)),l}).flat(1))}function WS(r){return[...new Set(r)]}function ZS(r){let t={},e=Object.keys(r).sort();for(let i of e)t[i]=r[i];return t}function JS(r,t){let e=new Set;return new Set(t),r.reduce((i,a)=>{let l=JSON.stringify(ZS(a));return e.has(l)||(e.add(l),i.push({key:l,link:a})),i},[])}function Kv(){let r=U.useContext(vl);return xm(r,"You must render this element inside a <DataRouterContext.Provider> element"),r}function tA(){let r=U.useContext(Jh);return xm(r,"You must render this element inside a <DataRouterStateContext.Provider> element"),r}var wm=U.createContext(void 0);wm.displayName="FrameworkContext";function Vv(){let r=U.useContext(wm);return xm(r,"You must render this element inside a <HydratedRouter> element"),r}function eA(r,t){let e=U.useContext(wm),[i,a]=U.useState(!1),[l,c]=U.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:p,onTouchStart:y}=t,x=U.useRef(null);U.useEffect(()=>{if(r==="render"&&c(!0),r==="viewport"){let E=D=>{D.forEach(k=>{c(k.isIntersecting)})},R=new IntersectionObserver(E,{threshold:.5});return x.current&&R.observe(x.current),()=>{R.disconnect()}}},[r]),U.useEffect(()=>{if(i){let E=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(E)}}},[i]);let S=()=>{a(!0)},A=()=>{a(!1),c(!1)};return e?r!=="intent"?[l,x,{}]:[l,x,{onFocus:_c(u,S),onBlur:_c(d,A),onMouseEnter:_c(f,S),onMouseLeave:_c(p,A),onTouchStart:_c(y,S)}]:[!1,x,{}]}function _c(r,t){return e=>{r&&r(e),e.defaultPrevented||t(e)}}function nA({page:r,...t}){let{router:e}=Kv(),i=U.useMemo(()=>kv(e.routes,r,e.basename),[e.routes,r,e.basename]);return i?U.createElement(sA,{page:r,matches:i,...t}):null}function iA(r){let{manifest:t,routeModules:e}=Vv(),[i,a]=U.useState([]);return U.useEffect(()=>{let l=!1;return YS(r,t,e).then(c=>{l||a(c)}),()=>{l=!0}},[r,t,e]),i}function sA({page:r,matches:t,...e}){let i=hr(),{future:a,manifest:l,routeModules:c}=Vv(),{basename:u}=Kv(),{loaderData:d,matches:f}=tA(),p=U.useMemo(()=>m0(r,t,f,l,i,"data"),[r,t,f,l,i]),y=U.useMemo(()=>m0(r,t,f,l,i,"assets"),[r,t,f,l,i]),x=U.useMemo(()=>{if(r===i.pathname+i.search+i.hash)return[];let E=new Set,R=!1;if(t.forEach(k=>{let O=l.routes[k.route.id];!O||!O.hasLoader||(!p.some(I=>I.route.id===k.route.id)&&k.route.id in d&&c[k.route.id]?.shouldRevalidate||O.hasClientLoader?R=!0:E.add(k.route.id))}),E.size===0)return[];let D=VS(r,u,a.unstable_trailingSlashAwareDataRequests,"data");return R&&E.size>0&&D.searchParams.set("_routes",t.filter(k=>E.has(k.route.id)).map(k=>k.route.id).join(",")),[D.pathname+D.search]},[u,a.unstable_trailingSlashAwareDataRequests,d,i,l,p,t,r,c]),S=U.useMemo(()=>QS(y,l),[y,l]),A=iA(y);return U.createElement(U.Fragment,null,x.map(E=>U.createElement("link",{key:E,rel:"prefetch",as:"fetch",href:E,...e})),S.map(E=>U.createElement("link",{key:E,rel:"modulepreload",href:E,...e})),A.map(({key:E,link:R})=>U.createElement("link",{key:E,nonce:e.nonce,...R,crossOrigin:R.crossOrigin??e.crossOrigin})))}function aA(...r){return t=>{r.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var rA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{rA&&(window.__reactRouterVersion="7.13.0")}catch{}function oA({basename:r,children:t,unstable_useTransitions:e,window:i}){let a=U.useRef();a.current==null&&(a.current=z1({window:i,v5Compat:!0}));let l=a.current,[c,u]=U.useState({action:l.action,location:l.location}),d=U.useCallback(f=>{e===!1?u(f):U.startTransition(()=>u(f))},[e]);return U.useLayoutEffect(()=>l.listen(d),[l,d]),U.createElement(PS,{basename:r,children:t,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:e})}var $v=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ed=U.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:a,reloadDocument:l,replace:c,state:u,target:d,to:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:x,...S},A){let{basename:E,unstable_useTransitions:R}=U.useContext(Di),D=typeof f=="string"&&$v.test(f),k=Pv(f,E);f=k.to;let O=wS(f,{relative:a}),[I,z,H]=eA(i,S),P=hA(f,{replace:c,state:u,target:d,preventScrollReset:p,relative:a,viewTransition:y,unstable_defaultShouldRevalidate:x,unstable_useTransitions:R});function rt(St){t&&t(St),St.defaultPrevented||P(St)}let ut=U.createElement("a",{...S,...H,href:k.absoluteURL||O,onClick:k.isExternal||l?t:rt,ref:aA(A,z),target:d,"data-discover":!D&&e==="render"?"true":void 0});return I&&!D?U.createElement(U.Fragment,null,ut,U.createElement(nA,{page:O})):ut});ed.displayName="Link";var lA=U.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:a=!1,style:l,to:c,viewTransition:u,children:d,...f},p){let y=Xc(c,{relative:f.relative}),x=hr(),S=U.useContext(Jh),{navigator:A,basename:E}=U.useContext(Di),R=S!=null&&gA(y)&&u===!0,D=A.encodeLocation?A.encodeLocation(y).pathname:y.pathname,k=x.pathname,O=S&&S.navigation&&S.navigation.location?S.navigation.location.pathname:null;e||(k=k.toLowerCase(),O=O?O.toLowerCase():null,D=D.toLowerCase()),O&&E&&(O=xa(O,E)||O);const I=D!=="/"&&D.endsWith("/")?D.length-1:D.length;let z=k===D||!a&&k.startsWith(D)&&k.charAt(I)==="/",H=O!=null&&(O===D||!a&&O.startsWith(D)&&O.charAt(D.length)==="/"),P={isActive:z,isPending:H,isTransitioning:R},rt=z?t:void 0,ut;typeof i=="function"?ut=i(P):ut=[i,z?"active":null,H?"pending":null,R?"transitioning":null].filter(Boolean).join(" ");let St=typeof l=="function"?l(P):l;return U.createElement(ed,{...f,"aria-current":rt,className:ut,ref:p,style:St,to:c,viewTransition:u},typeof d=="function"?d(P):d)});lA.displayName="NavLink";var cA=U.forwardRef(({discover:r="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:a,state:l,method:c=Oh,action:u,onSubmit:d,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:x,...S},A)=>{let{unstable_useTransitions:E}=U.useContext(Di),R=pA(),D=mA(u,{relative:f}),k=c.toLowerCase()==="get"?"get":"post",O=typeof u=="string"&&$v.test(u),I=z=>{if(d&&d(z),z.defaultPrevented)return;z.preventDefault();let H=z.nativeEvent.submitter,P=H?.getAttribute("formmethod")||c,rt=()=>R(H||z.currentTarget,{fetcherKey:t,method:P,navigate:e,replace:a,state:l,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:x});E&&e!==!1?U.startTransition(()=>rt()):rt()};return U.createElement("form",{ref:A,method:k,action:D,onSubmit:i?d:I,...S,"data-discover":!O&&r==="render"?"true":void 0})});cA.displayName="Form";function uA(r){return`${r} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Xv(r){let t=U.useContext(vl);return en(t,uA(r)),t}function hA(r,{target:t,replace:e,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let f=wa(),p=hr(),y=Xc(r,{relative:l});return U.useCallback(x=>{if(HS(x,t)){x.preventDefault();let S=e!==void 0?e:Ic(p)===Ic(y),A=()=>f(r,{replace:S,state:i,preventScrollReset:a,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u});d?U.startTransition(()=>A()):A()}},[p,f,y,e,i,t,r,a,l,c,u,d])}var dA=0,fA=()=>`__${String(++dA)}__`;function pA(){let{router:r}=Xv("useSubmit"),{basename:t}=U.useContext(Di),e=kS(),i=r.fetch,a=r.navigate;return U.useCallback(async(l,c={})=>{let{action:u,method:d,encType:f,formData:p,body:y}=KS(l,t);if(c.navigate===!1){let x=c.fetcherKey||fA();await i(x,e,c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,flushSync:c.flushSync})}else await a(c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:e,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,a,t,e])}function mA(r,{relative:t}={}){let{basename:e}=U.useContext(Di),i=U.useContext(as);en(i,"useFormAction must be used inside a RouteContext");let[a]=i.matches.slice(-1),l={...Xc(r||".",{relative:t})},c=hr();if(r==null){l.search=c.search;let u=new URLSearchParams(l.search),d=u.getAll("index");if(d.some(p=>p==="")){u.delete("index"),d.filter(y=>y).forEach(y=>u.append("index",y));let p=u.toString();l.search=p?`?${p}`:""}}return(!r||r===".")&&a.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(l.pathname=l.pathname==="/"?e:va([e,l.pathname])),Ic(l)}function gA(r,{relative:t}={}){let e=U.useContext(Fv);en(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=Xv("useViewTransitionState"),a=Xc(r,{relative:t});if(!e.isTransitioning)return!1;let l=xa(e.currentLocation.pathname,i)||e.currentLocation.pathname,c=xa(e.nextLocation.pathname,i)||e.nextLocation.pathname;return Hh(a.pathname,c)!=null||Hh(a.pathname,l)!=null}var yA=Nv(),wl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(r){return this.listeners.add(r),this.onSubscribe(),()=>{this.listeners.delete(r),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},bA={setTimeout:(r,t)=>setTimeout(r,t),clearTimeout:r=>clearTimeout(r),setInterval:(r,t)=>setInterval(r,t),clearInterval:r=>clearInterval(r)},vA=class{#t=bA;#e=!1;setTimeoutProvider(r){this.#t=r}setTimeout(r,t){return this.#t.setTimeout(r,t)}clearTimeout(r){this.#t.clearTimeout(r)}setInterval(r,t){return this.#t.setInterval(r,t)}clearInterval(r){this.#t.clearInterval(r)}},Kr=new vA;function xA(r){setTimeout(r,0)}var Jr=typeof window>"u"||"Deno"in globalThis;function ii(){}function wA(r,t){return typeof r=="function"?r(t):r}function Fp(r){return typeof r=="number"&&r>=0&&r!==1/0}function Yv(r,t){return Math.max(r+(t||0)-Date.now(),0)}function lr(r,t){return typeof r=="function"?r(t):r}function Vi(r,t){return typeof r=="function"?r(t):r}function g0(r,t){const{type:e="all",exact:i,fetchStatus:a,predicate:l,queryKey:c,stale:u}=r;if(c){if(i){if(t.queryHash!==Sm(c,t.options))return!1}else if(!Uc(t.queryKey,c))return!1}if(e!=="all"){const d=t.isActive();if(e==="active"&&!d||e==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||a&&a!==t.state.fetchStatus||l&&!l(t))}function y0(r,t){const{exact:e,status:i,predicate:a,mutationKey:l}=r;if(l){if(!t.options.mutationKey)return!1;if(e){if(to(t.options.mutationKey)!==to(l))return!1}else if(!Uc(t.options.mutationKey,l))return!1}return!(i&&t.state.status!==i||a&&!a(t))}function Sm(r,t){return(t?.queryKeyHashFn||to)(r)}function to(r){return JSON.stringify(r,(t,e)=>Ip(e)?Object.keys(e).sort().reduce((i,a)=>(i[a]=e[a],i),{}):e)}function Uc(r,t){return r===t?!0:typeof r!=typeof t?!1:r&&t&&typeof r=="object"&&typeof t=="object"?Object.keys(t).every(e=>Uc(r[e],t[e])):!1}var SA=Object.prototype.hasOwnProperty;function Qv(r,t,e=0){if(r===t)return r;if(e>500)return t;const i=b0(r)&&b0(t);if(!i&&!(Ip(r)&&Ip(t)))return t;const l=(i?r:Object.keys(r)).length,c=i?t:Object.keys(t),u=c.length,d=i?new Array(u):{};let f=0;for(let p=0;p<u;p++){const y=i?p:c[p],x=r[y],S=t[y];if(x===S){d[y]=x,(i?p<l:SA.call(r,y))&&f++;continue}if(x===null||S===null||typeof x!="object"||typeof S!="object"){d[y]=S;continue}const A=Qv(x,S,e+1);d[y]=A,A===x&&f++}return l===u&&f===l?r:d}function Gh(r,t){if(!t||Object.keys(r).length!==Object.keys(t).length)return!1;for(const e in r)if(r[e]!==t[e])return!1;return!0}function b0(r){return Array.isArray(r)&&r.length===Object.keys(r).length}function Ip(r){if(!v0(r))return!1;const t=r.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!v0(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(r)!==Object.prototype)}function v0(r){return Object.prototype.toString.call(r)==="[object Object]"}function AA(r){return new Promise(t=>{Kr.setTimeout(t,r)})}function Up(r,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(r,t):e.structuralSharing!==!1?Qv(r,t):t}function EA(r,t,e=0){const i=[...r,t];return e&&i.length>e?i.slice(1):i}function _A(r,t,e=0){const i=[t,...r];return e&&i.length>e?i.slice(0,-1):i}var Am=Symbol();function Wv(r,t){return!r.queryFn&&t?.initialPromise?()=>t.initialPromise:!r.queryFn||r.queryFn===Am?()=>Promise.reject(new Error(`Missing queryFn: '${r.queryHash}'`)):r.queryFn}function Em(r,t){return typeof r=="function"?r(...t):!!r}function CA(r,t,e){let i=!1,a;return Object.defineProperty(r,"signal",{enumerable:!0,get:()=>(a??=t(),i||(i=!0,a.aborted?e():a.addEventListener("abort",e,{once:!0})),a)}),r}var TA=class extends wl{#t;#e;#i;constructor(){super(),this.#i=r=>{if(!Jr&&window.addEventListener){const t=()=>r();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(r){this.#i=r,this.#e?.(),this.#e=r(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(r){this.#t!==r&&(this.#t=r,this.onFocus())}onFocus(){const r=this.isFocused();this.listeners.forEach(t=>{t(r)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},_m=new TA;function zp(){let r,t;const e=new Promise((a,l)=>{r=a,t=l});e.status="pending",e.catch(()=>{});function i(a){Object.assign(e,a),delete e.resolve,delete e.reject}return e.resolve=a=>{i({status:"fulfilled",value:a}),r(a)},e.reject=a=>{i({status:"rejected",reason:a}),t(a)},e}var RA=xA;function MA(){let r=[],t=0,e=u=>{u()},i=u=>{u()},a=RA;const l=u=>{t?r.push(u):a(()=>{e(u)})},c=()=>{const u=r;r=[],u.length&&a(()=>{i(()=>{u.forEach(d=>{e(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{l(()=>{u(...d)})},schedule:l,setNotifyFunction:u=>{e=u},setBatchNotifyFunction:u=>{i=u},setScheduler:u=>{a=u}}}var _n=MA(),DA=class extends wl{#t=!0;#e;#i;constructor(){super(),this.#i=r=>{if(!Jr&&window.addEventListener){const t=()=>r(!0),e=()=>r(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",e,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(r){this.#i=r,this.#e?.(),this.#e=r(this.setOnline.bind(this))}setOnline(r){this.#t!==r&&(this.#t=r,this.listeners.forEach(e=>{e(r)}))}isOnline(){return this.#t}},Kh=new DA;function NA(r){return Math.min(1e3*2**r,3e4)}function Zv(r){return(r??"online")==="online"?Kh.isOnline():!0}var Hp=class extends Error{constructor(r){super("CancelledError"),this.revert=r?.revert,this.silent=r?.silent}};function Jv(r){let t=!1,e=0,i;const a=zp(),l=()=>a.status!=="pending",c=E=>{if(!l()){const R=new Hp(E);x(R),r.onCancel?.(R)}},u=()=>{t=!0},d=()=>{t=!1},f=()=>_m.isFocused()&&(r.networkMode==="always"||Kh.isOnline())&&r.canRun(),p=()=>Zv(r.networkMode)&&r.canRun(),y=E=>{l()||(i?.(),a.resolve(E))},x=E=>{l()||(i?.(),a.reject(E))},S=()=>new Promise(E=>{i=R=>{(l()||f())&&E(R)},r.onPause?.()}).then(()=>{i=void 0,l()||r.onContinue?.()}),A=()=>{if(l())return;let E;const R=e===0?r.initialPromise:void 0;try{E=R??r.fn()}catch(D){E=Promise.reject(D)}Promise.resolve(E).then(y).catch(D=>{if(l())return;const k=r.retry??(Jr?0:3),O=r.retryDelay??NA,I=typeof O=="function"?O(e,D):O,z=k===!0||typeof k=="number"&&e<k||typeof k=="function"&&k(e,D);if(t||!z){x(D);return}e++,r.onFail?.(e,D),AA(I).then(()=>f()?void 0:S()).then(()=>{t?x(D):A()})})};return{promise:a,status:()=>a.status,cancel:c,continue:()=>(i?.(),a),cancelRetry:u,continueRetry:d,canStart:p,start:()=>(p()?A():S().then(A),a)}}var tx=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Fp(this.gcTime)&&(this.#t=Kr.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(r){this.gcTime=Math.max(this.gcTime||0,r??(Jr?1/0:300*1e3))}clearGcTimeout(){this.#t&&(Kr.clearTimeout(this.#t),this.#t=void 0)}},kA=class extends tx{#t;#e;#i;#n;#s;#r;#a;constructor(r){super(),this.#a=!1,this.#r=r.defaultOptions,this.setOptions(r.options),this.observers=[],this.#n=r.client,this.#i=this.#n.getQueryCache(),this.queryKey=r.queryKey,this.queryHash=r.queryHash,this.#t=w0(this.options),this.state=r.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(r){if(this.options={...this.#r,...r},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=w0(this.options);t.data!==void 0&&(this.setState(x0(t.data,t.dataUpdatedAt)),this.#t=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#i.remove(this)}setData(r,t){const e=Up(this.state.data,r,this.options);return this.#o({data:e,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),e}setState(r,t){this.#o({type:"setState",state:r,setStateOptions:t})}cancel(r){const t=this.#s?.promise;return this.#s?.cancel(r),t?t.then(ii).catch(ii):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(r=>Vi(r.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Am||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(r=>lr(r.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(r=>r.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(r=0){return this.state.data===void 0?!0:r==="static"?!1:this.state.isInvalidated?!0:!Yv(this.state.dataUpdatedAt,r)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(r){this.observers.includes(r)||(this.observers.push(r),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",query:this,observer:r}))}removeObserver(r){this.observers.includes(r)&&(this.observers=this.observers.filter(t=>t!==r),this.observers.length||(this.#s&&(this.#a?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#i.notify({type:"observerRemoved",query:this,observer:r}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#o({type:"invalidate"})}async fetch(r,t){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(r&&this.setOptions(r),!this.options.queryFn){const u=this.observers.find(d=>d.options.queryFn);u&&this.setOptions(u.options)}const e=new AbortController,i=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(this.#a=!0,e.signal)})},a=()=>{const u=Wv(this.options,t),f=(()=>{const p={client:this.#n,queryKey:this.queryKey,meta:this.meta};return i(p),p})();return this.#a=!1,this.options.persister?this.options.persister(u,f,this):u(f)},c=(()=>{const u={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:a};return i(u),u})();this.options.behavior?.onFetch(c,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&this.#o({type:"fetch",meta:c.fetchOptions?.meta}),this.#s=Jv({initialPromise:t?.initialPromise,fn:c.fetchFn,onCancel:u=>{u instanceof Hp&&u.revert&&this.setState({...this.#e,fetchStatus:"idle"}),e.abort()},onFail:(u,d)=>{this.#o({type:"failed",failureCount:u,error:d})},onPause:()=>{this.#o({type:"pause"})},onContinue:()=>{this.#o({type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0});try{const u=await this.#s.start();if(u===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(u),this.#i.config.onSuccess?.(u,this),this.#i.config.onSettled?.(u,this.state.error,this),u}catch(u){if(u instanceof Hp){if(u.silent)return this.#s.promise;if(u.revert){if(this.state.data===void 0)throw u;return this.state.data}}throw this.#o({type:"error",error:u}),this.#i.config.onError?.(u,this),this.#i.config.onSettled?.(this.state.data,u,this),u}finally{this.scheduleGc()}}#o(r){const t=e=>{switch(r.type){case"failed":return{...e,fetchFailureCount:r.failureCount,fetchFailureReason:r.error};case"pause":return{...e,fetchStatus:"paused"};case"continue":return{...e,fetchStatus:"fetching"};case"fetch":return{...e,...ex(e.data,this.options),fetchMeta:r.meta??null};case"success":const i={...e,...x0(r.data,r.dataUpdatedAt),dataUpdateCount:e.dataUpdateCount+1,...!r.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=r.manual?i:void 0,i;case"error":const a=r.error;return{...e,error:a,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:a,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...e,isInvalidated:!0};case"setState":return{...e,...r.state}}};this.state=t(this.state),_n.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#i.notify({query:this,type:"updated",action:r})})}};function ex(r,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:Zv(t.networkMode)?"fetching":"paused",...r===void 0&&{error:null,status:"pending"}}}function x0(r,t){return{data:r,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function w0(r){const t=typeof r.initialData=="function"?r.initialData():r.initialData,e=t!==void 0,i=e?typeof r.initialDataUpdatedAt=="function"?r.initialDataUpdatedAt():r.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var OA=class extends wl{constructor(r,t){super(),this.options=t,this.#t=r,this.#o=null,this.#a=zp(),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#i=void 0;#n=void 0;#s;#r;#a;#o;#c;#l;#d;#h;#f;#g;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),S0(this.#e,this.options)?this.#u():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return qp(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return qp(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#E(),this.#A(),this.#e.removeObserver(this)}setOptions(r){const t=this.options,e=this.#e;if(this.options=this.#t.defaultQueryOptions(r),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Vi(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#x(),this.#e.setOptions(this.options),t._defaulted&&!Gh(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const i=this.hasListeners();i&&A0(this.#e,e,this.options,t)&&this.#u(),this.updateResult(),i&&(this.#e!==e||Vi(this.options.enabled,this.#e)!==Vi(t.enabled,this.#e)||lr(this.options.staleTime,this.#e)!==lr(t.staleTime,this.#e))&&this.#p();const a=this.#y();i&&(this.#e!==e||Vi(this.options.enabled,this.#e)!==Vi(t.enabled,this.#e)||a!==this.#g)&&this.#v(a)}getOptimisticResult(r){const t=this.#t.getQueryCache().build(this.#t,r),e=this.createResult(t,r);return jA(this,e)&&(this.#n=e,this.#r=this.options,this.#s=this.#e.state),e}getCurrentResult(){return this.#n}trackResult(r,t){return new Proxy(r,{get:(e,i)=>(this.trackProp(i),t?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,i))})}trackProp(r){this.#m.add(r)}getCurrentQuery(){return this.#e}refetch({...r}={}){return this.fetch({...r})}fetchOptimistic(r){const t=this.#t.defaultQueryOptions(r),e=this.#t.getQueryCache().build(this.#t,t);return e.fetch().then(()=>this.createResult(e,t))}fetch(r){return this.#u({...r,cancelRefetch:r.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#u(r){this.#x();let t=this.#e.fetch(this.options,r);return r?.throwOnError||(t=t.catch(ii)),t}#p(){this.#E();const r=lr(this.options.staleTime,this.#e);if(Jr||this.#n.isStale||!Fp(r))return;const e=Yv(this.#n.dataUpdatedAt,r)+1;this.#h=Kr.setTimeout(()=>{this.#n.isStale||this.updateResult()},e)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#v(r){this.#A(),this.#g=r,!(Jr||Vi(this.options.enabled,this.#e)===!1||!Fp(this.#g)||this.#g===0)&&(this.#f=Kr.setInterval(()=>{(this.options.refetchIntervalInBackground||_m.isFocused())&&this.#u()},this.#g))}#b(){this.#p(),this.#v(this.#y())}#E(){this.#h&&(Kr.clearTimeout(this.#h),this.#h=void 0)}#A(){this.#f&&(Kr.clearInterval(this.#f),this.#f=void 0)}createResult(r,t){const e=this.#e,i=this.options,a=this.#n,l=this.#s,c=this.#r,d=r!==e?r.state:this.#i,{state:f}=r;let p={...f},y=!1,x;if(t._optimisticResults){const rt=this.hasListeners(),ut=!rt&&S0(r,t),St=rt&&A0(r,e,t,i);(ut||St)&&(p={...p,...ex(f.data,r.options)}),t._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:S,errorUpdatedAt:A,status:E}=p;x=p.data;let R=!1;if(t.placeholderData!==void 0&&x===void 0&&E==="pending"){let rt;a?.isPlaceholderData&&t.placeholderData===c?.placeholderData?(rt=a.data,R=!0):rt=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,rt!==void 0&&(E="success",x=Up(a?.data,rt,t),y=!0)}if(t.select&&x!==void 0&&!R)if(a&&x===l?.data&&t.select===this.#c)x=this.#l;else try{this.#c=t.select,x=t.select(x),x=Up(a?.data,x,t),this.#l=x,this.#o=null}catch(rt){this.#o=rt}this.#o&&(S=this.#o,x=this.#l,A=Date.now(),E="error");const D=p.fetchStatus==="fetching",k=E==="pending",O=E==="error",I=k&&D,z=x!==void 0,P={status:E,fetchStatus:p.fetchStatus,isPending:k,isSuccess:E==="success",isError:O,isInitialLoading:I,isLoading:I,data:x,dataUpdatedAt:p.dataUpdatedAt,error:S,errorUpdatedAt:A,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:D,isRefetching:D&&!k,isLoadingError:O&&!z,isPaused:p.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:O&&z,isStale:Cm(r,t),refetch:this.refetch,promise:this.#a,isEnabled:Vi(t.enabled,r)!==!1};if(this.options.experimental_prefetchInRender){const rt=P.data!==void 0,ut=P.status==="error"&&!rt,St=Vt=>{ut?Vt.reject(P.error):rt&&Vt.resolve(P.data)},_t=()=>{const Vt=this.#a=P.promise=zp();St(Vt)},Mt=this.#a;switch(Mt.status){case"pending":r.queryHash===e.queryHash&&St(Mt);break;case"fulfilled":(ut||P.data!==Mt.value)&&_t();break;case"rejected":(!ut||P.error!==Mt.reason)&&_t();break}}return P}updateResult(){const r=this.#n,t=this.createResult(this.#e,this.options);if(this.#s=this.#e.state,this.#r=this.options,this.#s.data!==void 0&&(this.#d=this.#e),Gh(t,r))return;this.#n=t;const e=()=>{if(!r)return!0;const{notifyOnChangeProps:i}=this.options,a=typeof i=="function"?i():i;if(a==="all"||!a&&!this.#m.size)return!0;const l=new Set(a??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#n).some(c=>{const u=c;return this.#n[u]!==r[u]&&l.has(u)})};this.#C({listeners:e()})}#x(){const r=this.#t.getQueryCache().build(this.#t,this.options);if(r===this.#e)return;const t=this.#e;this.#e=r,this.#i=r.state,this.hasListeners()&&(t?.removeObserver(this),r.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#C(r){_n.batch(()=>{r.listeners&&this.listeners.forEach(t=>{t(this.#n)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function LA(r,t){return Vi(t.enabled,r)!==!1&&r.state.data===void 0&&!(r.state.status==="error"&&t.retryOnMount===!1)}function S0(r,t){return LA(r,t)||r.state.data!==void 0&&qp(r,t,t.refetchOnMount)}function qp(r,t,e){if(Vi(t.enabled,r)!==!1&&lr(t.staleTime,r)!=="static"){const i=typeof e=="function"?e(r):e;return i==="always"||i!==!1&&Cm(r,t)}return!1}function A0(r,t,e,i){return(r!==t||Vi(i.enabled,r)===!1)&&(!e.suspense||r.state.status!=="error")&&Cm(r,e)}function Cm(r,t){return Vi(t.enabled,r)!==!1&&r.isStaleByTime(lr(t.staleTime,r))}function jA(r,t){return!Gh(r.getCurrentResult(),t)}function E0(r){return{onFetch:(t,e)=>{const i=t.options,a=t.fetchOptions?.meta?.fetchMore?.direction,l=t.state.data?.pages||[],c=t.state.data?.pageParams||[];let u={pages:[],pageParams:[]},d=0;const f=async()=>{let p=!1;const y=A=>{CA(A,()=>t.signal,()=>p=!0)},x=Wv(t.options,t.fetchOptions),S=async(A,E,R)=>{if(p)return Promise.reject();if(E==null&&A.pages.length)return Promise.resolve(A);const k=(()=>{const H={client:t.client,queryKey:t.queryKey,pageParam:E,direction:R?"backward":"forward",meta:t.options.meta};return y(H),H})(),O=await x(k),{maxPages:I}=t.options,z=R?_A:EA;return{pages:z(A.pages,O,I),pageParams:z(A.pageParams,E,I)}};if(a&&l.length){const A=a==="backward",E=A?PA:_0,R={pages:l,pageParams:c},D=E(i,R);u=await S(R,D,A)}else{const A=r??l.length;do{const E=d===0?c[0]??i.initialPageParam:_0(i,u);if(d>0&&E==null)break;u=await S(u,E),d++}while(d<A)}return u};t.options.persister?t.fetchFn=()=>t.options.persister?.(f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e):t.fetchFn=f}}}function _0(r,{pages:t,pageParams:e}){const i=t.length-1;return t.length>0?r.getNextPageParam(t[i],t,e[i],e):void 0}function PA(r,{pages:t,pageParams:e}){return t.length>0?r.getPreviousPageParam?.(t[0],t,e[0],e):void 0}var BA=class extends tx{#t;#e;#i;#n;constructor(r){super(),this.#t=r.client,this.mutationId=r.mutationId,this.#i=r.mutationCache,this.#e=[],this.state=r.state||nx(),this.setOptions(r.options),this.scheduleGc()}setOptions(r){this.options=r,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(r){this.#e.includes(r)||(this.#e.push(r),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",mutation:this,observer:r}))}removeObserver(r){this.#e=this.#e.filter(t=>t!==r),this.scheduleGc(),this.#i.notify({type:"observerRemoved",mutation:this,observer:r})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#i.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(r){const t=()=>{this.#s({type:"continue"})},e={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#n=Jv({fn:()=>this.options.mutationFn?this.options.mutationFn(r,e):Promise.reject(new Error("No mutationFn found")),onFail:(l,c)=>{this.#s({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#i.canRun(this)});const i=this.state.status==="pending",a=!this.#n.canStart();try{if(i)t();else{this.#s({type:"pending",variables:r,isPaused:a}),this.#i.config.onMutate&&await this.#i.config.onMutate(r,this,e);const c=await this.options.onMutate?.(r,e);c!==this.state.context&&this.#s({type:"pending",context:c,variables:r,isPaused:a})}const l=await this.#n.start();return await this.#i.config.onSuccess?.(l,r,this.state.context,this,e),await this.options.onSuccess?.(l,r,this.state.context,e),await this.#i.config.onSettled?.(l,null,this.state.variables,this.state.context,this,e),await this.options.onSettled?.(l,null,r,this.state.context,e),this.#s({type:"success",data:l}),l}catch(l){try{await this.#i.config.onError?.(l,r,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onError?.(l,r,this.state.context,e)}catch(c){Promise.reject(c)}try{await this.#i.config.onSettled?.(void 0,l,this.state.variables,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onSettled?.(void 0,l,r,this.state.context,e)}catch(c){Promise.reject(c)}throw this.#s({type:"error",error:l}),l}finally{this.#i.runNext(this)}}#s(r){const t=e=>{switch(r.type){case"failed":return{...e,failureCount:r.failureCount,failureReason:r.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:r.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:r.isPaused,status:"pending",variables:r.variables,submittedAt:Date.now()};case"success":return{...e,data:r.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:r.error,failureCount:e.failureCount+1,failureReason:r.error,isPaused:!1,status:"error"}}};this.state=t(this.state),_n.batch(()=>{this.#e.forEach(e=>{e.onMutationUpdate(r)}),this.#i.notify({mutation:this,type:"updated",action:r})})}};function nx(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var FA=class extends wl{constructor(r={}){super(),this.config=r,this.#t=new Set,this.#e=new Map,this.#i=0}#t;#e;#i;build(r,t,e){const i=new BA({client:r,mutationCache:this,mutationId:++this.#i,options:r.defaultMutationOptions(t),state:e});return this.add(i),i}add(r){this.#t.add(r);const t=xh(r);if(typeof t=="string"){const e=this.#e.get(t);e?e.push(r):this.#e.set(t,[r])}this.notify({type:"added",mutation:r})}remove(r){if(this.#t.delete(r)){const t=xh(r);if(typeof t=="string"){const e=this.#e.get(t);if(e)if(e.length>1){const i=e.indexOf(r);i!==-1&&e.splice(i,1)}else e[0]===r&&this.#e.delete(t)}}this.notify({type:"removed",mutation:r})}canRun(r){const t=xh(r);if(typeof t=="string"){const i=this.#e.get(t)?.find(a=>a.state.status==="pending");return!i||i===r}else return!0}runNext(r){const t=xh(r);return typeof t=="string"?this.#e.get(t)?.find(i=>i!==r&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){_n.batch(()=>{this.#t.forEach(r=>{this.notify({type:"removed",mutation:r})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(r){const t={exact:!0,...r};return this.getAll().find(e=>y0(t,e))}findAll(r={}){return this.getAll().filter(t=>y0(r,t))}notify(r){_n.batch(()=>{this.listeners.forEach(t=>{t(r)})})}resumePausedMutations(){const r=this.getAll().filter(t=>t.state.isPaused);return _n.batch(()=>Promise.all(r.map(t=>t.continue().catch(ii))))}};function xh(r){return r.options.scope?.id}var IA=class extends wl{#t;#e=void 0;#i;#n;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),Gh(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#i,observer:this}),e?.mutationKey&&this.options.mutationKey&&to(e.mutationKey)!==to(this.options.mutationKey)?this.reset():this.#i?.state.status==="pending"&&this.#i.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#i?.removeObserver(this)}onMutationUpdate(t){this.#s(),this.#r(t)}getCurrentResult(){return this.#e}reset(){this.#i?.removeObserver(this),this.#i=void 0,this.#s(),this.#r()}mutate(t,e){return this.#n=e,this.#i?.removeObserver(this),this.#i=this.#t.getMutationCache().build(this.#t,this.options),this.#i.addObserver(this),this.#i.execute(t)}#s(){const t=this.#i?.state??nx();this.#e={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#r(t){_n.batch(()=>{if(this.#n&&this.hasListeners()){const e=this.#e.variables,i=this.#e.context,a={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#n.onSuccess?.(t.data,e,i,a)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(t.data,null,e,i,a)}catch(l){Promise.reject(l)}}else if(t?.type==="error"){try{this.#n.onError?.(t.error,e,i,a)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(void 0,t.error,e,i,a)}catch(l){Promise.reject(l)}}}this.listeners.forEach(e=>{e(this.#e)})})}},UA=class extends wl{constructor(r={}){super(),this.config=r,this.#t=new Map}#t;build(r,t,e){const i=t.queryKey,a=t.queryHash??Sm(i,t);let l=this.get(a);return l||(l=new kA({client:r,queryKey:i,queryHash:a,options:r.defaultQueryOptions(t),state:e,defaultOptions:r.getQueryDefaults(i)}),this.add(l)),l}add(r){this.#t.has(r.queryHash)||(this.#t.set(r.queryHash,r),this.notify({type:"added",query:r}))}remove(r){const t=this.#t.get(r.queryHash);t&&(r.destroy(),t===r&&this.#t.delete(r.queryHash),this.notify({type:"removed",query:r}))}clear(){_n.batch(()=>{this.getAll().forEach(r=>{this.remove(r)})})}get(r){return this.#t.get(r)}getAll(){return[...this.#t.values()]}find(r){const t={exact:!0,...r};return this.getAll().find(e=>g0(t,e))}findAll(r={}){const t=this.getAll();return Object.keys(r).length>0?t.filter(e=>g0(r,e)):t}notify(r){_n.batch(()=>{this.listeners.forEach(t=>{t(r)})})}onFocus(){_n.batch(()=>{this.getAll().forEach(r=>{r.onFocus()})})}onOnline(){_n.batch(()=>{this.getAll().forEach(r=>{r.onOnline()})})}},zA=class{#t;#e;#i;#n;#s;#r;#a;#o;constructor(r={}){this.#t=r.queryCache||new UA,this.#e=r.mutationCache||new FA,this.#i=r.defaultOptions||{},this.#n=new Map,this.#s=new Map,this.#r=0}mount(){this.#r++,this.#r===1&&(this.#a=_m.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#o=Kh.subscribe(async r=>{r&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#r--,this.#r===0&&(this.#a?.(),this.#a=void 0,this.#o?.(),this.#o=void 0)}isFetching(r){return this.#t.findAll({...r,fetchStatus:"fetching"}).length}isMutating(r){return this.#e.findAll({...r,status:"pending"}).length}getQueryData(r){const t=this.defaultQueryOptions({queryKey:r});return this.#t.get(t.queryHash)?.state.data}ensureQueryData(r){const t=this.defaultQueryOptions(r),e=this.#t.build(this,t),i=e.state.data;return i===void 0?this.fetchQuery(r):(r.revalidateIfStale&&e.isStaleByTime(lr(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(r){return this.#t.findAll(r).map(({queryKey:t,state:e})=>{const i=e.data;return[t,i]})}setQueryData(r,t,e){const i=this.defaultQueryOptions({queryKey:r}),l=this.#t.get(i.queryHash)?.state.data,c=wA(t,l);if(c!==void 0)return this.#t.build(this,i).setData(c,{...e,manual:!0})}setQueriesData(r,t,e){return _n.batch(()=>this.#t.findAll(r).map(({queryKey:i})=>[i,this.setQueryData(i,t,e)]))}getQueryState(r){const t=this.defaultQueryOptions({queryKey:r});return this.#t.get(t.queryHash)?.state}removeQueries(r){const t=this.#t;_n.batch(()=>{t.findAll(r).forEach(e=>{t.remove(e)})})}resetQueries(r,t){const e=this.#t;return _n.batch(()=>(e.findAll(r).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...r},t)))}cancelQueries(r,t={}){const e={revert:!0,...t},i=_n.batch(()=>this.#t.findAll(r).map(a=>a.cancel(e)));return Promise.all(i).then(ii).catch(ii)}invalidateQueries(r,t={}){return _n.batch(()=>(this.#t.findAll(r).forEach(e=>{e.invalidate()}),r?.refetchType==="none"?Promise.resolve():this.refetchQueries({...r,type:r?.refetchType??r?.type??"active"},t)))}refetchQueries(r,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},i=_n.batch(()=>this.#t.findAll(r).filter(a=>!a.isDisabled()&&!a.isStatic()).map(a=>{let l=a.fetch(void 0,e);return e.throwOnError||(l=l.catch(ii)),a.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(ii)}fetchQuery(r){const t=this.defaultQueryOptions(r);t.retry===void 0&&(t.retry=!1);const e=this.#t.build(this,t);return e.isStaleByTime(lr(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(r){return this.fetchQuery(r).then(ii).catch(ii)}fetchInfiniteQuery(r){return r.behavior=E0(r.pages),this.fetchQuery(r)}prefetchInfiniteQuery(r){return this.fetchInfiniteQuery(r).then(ii).catch(ii)}ensureInfiniteQueryData(r){return r.behavior=E0(r.pages),this.ensureQueryData(r)}resumePausedMutations(){return Kh.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#i}setDefaultOptions(r){this.#i=r}setQueryDefaults(r,t){this.#n.set(to(r),{queryKey:r,defaultOptions:t})}getQueryDefaults(r){const t=[...this.#n.values()],e={};return t.forEach(i=>{Uc(r,i.queryKey)&&Object.assign(e,i.defaultOptions)}),e}setMutationDefaults(r,t){this.#s.set(to(r),{mutationKey:r,defaultOptions:t})}getMutationDefaults(r){const t=[...this.#s.values()],e={};return t.forEach(i=>{Uc(r,i.mutationKey)&&Object.assign(e,i.defaultOptions)}),e}defaultQueryOptions(r){if(r._defaulted)return r;const t={...this.#i.queries,...this.getQueryDefaults(r.queryKey),...r,_defaulted:!0};return t.queryHash||(t.queryHash=Sm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Am&&(t.enabled=!1),t}defaultMutationOptions(r){return r?._defaulted?r:{...this.#i.mutations,...r?.mutationKey&&this.getMutationDefaults(r.mutationKey),...r,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},ix=U.createContext(void 0),so=r=>{const t=U.useContext(ix);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},HA=({client:r,children:t})=>(U.useEffect(()=>(r.mount(),()=>{r.unmount()}),[r]),C.jsx(ix.Provider,{value:r,children:t})),sx=U.createContext(!1),qA=()=>U.useContext(sx);sx.Provider;function GA(){let r=!1;return{clearReset:()=>{r=!1},reset:()=>{r=!0},isReset:()=>r}}var KA=U.createContext(GA()),VA=()=>U.useContext(KA),$A=(r,t,e)=>{const i=e?.state.error&&typeof r.throwOnError=="function"?Em(r.throwOnError,[e.state.error,e]):r.throwOnError;(r.suspense||r.experimental_prefetchInRender||i)&&(t.isReset()||(r.retryOnMount=!1))},XA=r=>{U.useEffect(()=>{r.clearReset()},[r])},YA=({result:r,errorResetBoundary:t,throwOnError:e,query:i,suspense:a})=>r.isError&&!t.isReset()&&!r.isFetching&&i&&(a&&r.data===void 0||Em(e,[r.error,i])),QA=r=>{if(r.suspense){const e=a=>a==="static"?a:Math.max(a??1e3,1e3),i=r.staleTime;r.staleTime=typeof i=="function"?(...a)=>e(i(...a)):e(i),typeof r.gcTime=="number"&&(r.gcTime=Math.max(r.gcTime,1e3))}},WA=(r,t)=>r.isLoading&&r.isFetching&&!t,ZA=(r,t)=>r?.suspense&&t.isPending,C0=(r,t,e)=>t.fetchOptimistic(r).catch(()=>{e.clearReset()});function JA(r,t,e){const i=qA(),a=VA(),l=so(),c=l.defaultQueryOptions(r);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c);const u=l.getQueryCache().get(c.queryHash);c._optimisticResults=i?"isRestoring":"optimistic",QA(c),$A(c,a,u),XA(a);const d=!l.getQueryCache().get(c.queryHash),[f]=U.useState(()=>new t(l,c)),p=f.getOptimisticResult(c),y=!i&&r.subscribed!==!1;if(U.useSyncExternalStore(U.useCallback(x=>{const S=y?f.subscribe(_n.batchCalls(x)):ii;return f.updateResult(),S},[f,y]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),U.useEffect(()=>{f.setOptions(c)},[c,f]),ZA(c,p))throw C0(c,f,a);if(YA({result:p,errorResetBoundary:a,throwOnError:c.throwOnError,query:u,suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!Jr&&WA(p,i)&&(d?C0(c,f,a):u?.promise)?.catch(ii).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function is(r,t){return JA(r,OA)}function Mi(r,t){const e=so(),[i]=U.useState(()=>new IA(e,r));U.useEffect(()=>{i.setOptions(r)},[i,r]);const a=U.useSyncExternalStore(U.useCallback(c=>i.subscribe(_n.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=U.useCallback((c,u)=>{i.mutate(c,u).catch(ii)},[i]);if(a.error&&Em(i.options.throwOnError,[a.error]))throw a.error;return{...a,mutate:l,mutateAsync:a.mutate}}const T0=r=>{let t;const e=new Set,i=(f,p)=>{const y=typeof f=="function"?f(t):f;if(!Object.is(y,t)){const x=t;t=p??(typeof y!="object"||y===null)?y:Object.assign({},t,y),e.forEach(S=>S(t,x))}},a=()=>t,u={setState:i,getState:a,getInitialState:()=>d,subscribe:f=>(e.add(f),()=>e.delete(f))},d=t=r(i,a,u);return u},tE=(r=>r?T0(r):T0),eE=r=>r;function nE(r,t=eE){const e=bh.useSyncExternalStore(r.subscribe,bh.useCallback(()=>t(r.getState()),[r,t]),bh.useCallback(()=>t(r.getInitialState()),[r,t]));return bh.useDebugValue(e),e}const R0=r=>{const t=tE(r),e=i=>nE(t,i);return Object.assign(e,t),e},iE=(r=>r?R0(r):R0);function sE(r,t){let e;try{e=r()}catch{return}return{getItem:a=>{var l;const c=d=>d===null?null:JSON.parse(d,void 0),u=(l=e.getItem(a))!=null?l:null;return u instanceof Promise?u.then(c):c(u)},setItem:(a,l)=>e.setItem(a,JSON.stringify(l,void 0)),removeItem:a=>e.removeItem(a)}}const Gp=r=>t=>{try{const e=r(t);return e instanceof Promise?e:{then(i){return Gp(i)(e)},catch(i){return this}}}catch(e){return{then(i){return this},catch(i){return Gp(i)(e)}}}},aE=(r,t)=>(e,i,a)=>{let l={storage:sE(()=>window.localStorage),partialize:R=>R,version:0,merge:(R,D)=>({...D,...R}),...t},c=!1,u=0;const d=new Set,f=new Set;let p=l.storage;if(!p)return r((...R)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),e(...R)},i,a);const y=()=>{const R=l.partialize({...i()});return p.setItem(l.name,{state:R,version:l.version})},x=a.setState;a.setState=(R,D)=>(x(R,D),y());const S=r((...R)=>(e(...R),y()),i,a);a.getInitialState=()=>S;let A;const E=()=>{var R,D;if(!p)return;const k=++u;c=!1,d.forEach(I=>{var z;return I((z=i())!=null?z:S)});const O=((D=l.onRehydrateStorage)==null?void 0:D.call(l,(R=i())!=null?R:S))||void 0;return Gp(p.getItem.bind(p))(l.name).then(I=>{if(I)if(typeof I.version=="number"&&I.version!==l.version){if(l.migrate){const z=l.migrate(I.state,I.version);return z instanceof Promise?z.then(H=>[!0,H]):[!0,z]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,I.state];return[!1,void 0]}).then(I=>{var z;if(k!==u)return;const[H,P]=I;if(A=l.merge(P,(z=i())!=null?z:S),e(A,!0),H)return y()}).then(()=>{k===u&&(O?.(A,void 0),A=i(),c=!0,f.forEach(I=>I(A)))}).catch(I=>{k===u&&O?.(void 0,I)})};return a.persist={setOptions:R=>{l={...l,...R},R.storage&&(p=R.storage)},clearStorage:()=>{p?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>E(),hasHydrated:()=>c,onHydrate:R=>(d.add(R),()=>{d.delete(R)}),onFinishHydration:R=>(f.add(R),()=>{f.delete(R)})},l.skipHydration||E(),A||S},rE=aE,Sa=iE(rE(r=>({token:null,setToken:t=>r({token:t}),logout:()=>r({token:null})}),{name:"wisemark-auth",partialize:r=>({token:r.token})}));function ax(r,t){return function(){return r.apply(t,arguments)}}const{toString:oE}=Object.prototype,{getPrototypeOf:Tm}=Object,{iterator:nd,toStringTag:rx}=Symbol,id=(r=>t=>{const e=oE.call(t);return r[e]||(r[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),rs=r=>(r=r.toLowerCase(),t=>id(t)===r),sd=r=>t=>typeof t===r,{isArray:Sl}=Array,pl=sd("undefined");function Yc(r){return r!==null&&!pl(r)&&r.constructor!==null&&!pl(r.constructor)&&mi(r.constructor.isBuffer)&&r.constructor.isBuffer(r)}const ox=rs("ArrayBuffer");function lE(r){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(r):t=r&&r.buffer&&ox(r.buffer),t}const cE=sd("string"),mi=sd("function"),lx=sd("number"),Qc=r=>r!==null&&typeof r=="object",uE=r=>r===!0||r===!1,jh=r=>{if(id(r)!=="object")return!1;const t=Tm(r);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(rx in r)&&!(nd in r)},hE=r=>{if(!Qc(r)||Yc(r))return!1;try{return Object.keys(r).length===0&&Object.getPrototypeOf(r)===Object.prototype}catch{return!1}},dE=rs("Date"),fE=rs("File"),pE=rs("Blob"),mE=rs("FileList"),gE=r=>Qc(r)&&mi(r.pipe),yE=r=>{let t;return r&&(typeof FormData=="function"&&r instanceof FormData||mi(r.append)&&((t=id(r))==="formdata"||t==="object"&&mi(r.toString)&&r.toString()==="[object FormData]"))},bE=rs("URLSearchParams"),[vE,xE,wE,SE]=["ReadableStream","Request","Response","Headers"].map(rs),AE=r=>r.trim?r.trim():r.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wc(r,t,{allOwnKeys:e=!1}={}){if(r===null||typeof r>"u")return;let i,a;if(typeof r!="object"&&(r=[r]),Sl(r))for(i=0,a=r.length;i<a;i++)t.call(null,r[i],i,r);else{if(Yc(r))return;const l=e?Object.getOwnPropertyNames(r):Object.keys(r),c=l.length;let u;for(i=0;i<c;i++)u=l[i],t.call(null,r[u],u,r)}}function cx(r,t){if(Yc(r))return null;t=t.toLowerCase();const e=Object.keys(r);let i=e.length,a;for(;i-- >0;)if(a=e[i],t===a.toLowerCase())return a;return null}const Vr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,ux=r=>!pl(r)&&r!==Vr;function Kp(){const{caseless:r,skipUndefined:t}=ux(this)&&this||{},e={},i=(a,l)=>{if(l==="__proto__"||l==="constructor"||l==="prototype")return;const c=r&&cx(e,l)||l;jh(e[c])&&jh(a)?e[c]=Kp(e[c],a):jh(a)?e[c]=Kp({},a):Sl(a)?e[c]=a.slice():(!t||!pl(a))&&(e[c]=a)};for(let a=0,l=arguments.length;a<l;a++)arguments[a]&&Wc(arguments[a],i);return e}const EE=(r,t,e,{allOwnKeys:i}={})=>(Wc(t,(a,l)=>{e&&mi(a)?Object.defineProperty(r,l,{value:ax(a,e),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(r,l,{value:a,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:i}),r),_E=r=>(r.charCodeAt(0)===65279&&(r=r.slice(1)),r),CE=(r,t,e,i)=>{r.prototype=Object.create(t.prototype,i),Object.defineProperty(r.prototype,"constructor",{value:r,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(r,"super",{value:t.prototype}),e&&Object.assign(r.prototype,e)},TE=(r,t,e,i)=>{let a,l,c;const u={};if(t=t||{},r==null)return t;do{for(a=Object.getOwnPropertyNames(r),l=a.length;l-- >0;)c=a[l],(!i||i(c,r,t))&&!u[c]&&(t[c]=r[c],u[c]=!0);r=e!==!1&&Tm(r)}while(r&&(!e||e(r,t))&&r!==Object.prototype);return t},RE=(r,t,e)=>{r=String(r),(e===void 0||e>r.length)&&(e=r.length),e-=t.length;const i=r.indexOf(t,e);return i!==-1&&i===e},ME=r=>{if(!r)return null;if(Sl(r))return r;let t=r.length;if(!lx(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=r[t];return e},DE=(r=>t=>r&&t instanceof r)(typeof Uint8Array<"u"&&Tm(Uint8Array)),NE=(r,t)=>{const i=(r&&r[nd]).call(r);let a;for(;(a=i.next())&&!a.done;){const l=a.value;t.call(r,l[0],l[1])}},kE=(r,t)=>{let e;const i=[];for(;(e=r.exec(t))!==null;)i.push(e);return i},OE=rs("HTMLFormElement"),LE=r=>r.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,i,a){return i.toUpperCase()+a}),M0=(({hasOwnProperty:r})=>(t,e)=>r.call(t,e))(Object.prototype),jE=rs("RegExp"),hx=(r,t)=>{const e=Object.getOwnPropertyDescriptors(r),i={};Wc(e,(a,l)=>{let c;(c=t(a,l,r))!==!1&&(i[l]=c||a)}),Object.defineProperties(r,i)},PE=r=>{hx(r,(t,e)=>{if(mi(r)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const i=r[e];if(mi(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},BE=(r,t)=>{const e={},i=a=>{a.forEach(l=>{e[l]=!0})};return Sl(r)?i(r):i(String(r).split(t)),e},FE=()=>{},IE=(r,t)=>r!=null&&Number.isFinite(r=+r)?r:t;function UE(r){return!!(r&&mi(r.append)&&r[rx]==="FormData"&&r[nd])}const zE=r=>{const t=new Array(10),e=(i,a)=>{if(Qc(i)){if(t.indexOf(i)>=0)return;if(Yc(i))return i;if(!("toJSON"in i)){t[a]=i;const l=Sl(i)?[]:{};return Wc(i,(c,u)=>{const d=e(c,a+1);!pl(d)&&(l[u]=d)}),t[a]=void 0,l}}return i};return e(r,0)},HE=rs("AsyncFunction"),qE=r=>r&&(Qc(r)||mi(r))&&mi(r.then)&&mi(r.catch),dx=((r,t)=>r?setImmediate:t?((e,i)=>(Vr.addEventListener("message",({source:a,data:l})=>{a===Vr&&l===e&&i.length&&i.shift()()},!1),a=>{i.push(a),Vr.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",mi(Vr.postMessage)),GE=typeof queueMicrotask<"u"?queueMicrotask.bind(Vr):typeof process<"u"&&process.nextTick||dx,KE=r=>r!=null&&mi(r[nd]),dt={isArray:Sl,isArrayBuffer:ox,isBuffer:Yc,isFormData:yE,isArrayBufferView:lE,isString:cE,isNumber:lx,isBoolean:uE,isObject:Qc,isPlainObject:jh,isEmptyObject:hE,isReadableStream:vE,isRequest:xE,isResponse:wE,isHeaders:SE,isUndefined:pl,isDate:dE,isFile:fE,isBlob:pE,isRegExp:jE,isFunction:mi,isStream:gE,isURLSearchParams:bE,isTypedArray:DE,isFileList:mE,forEach:Wc,merge:Kp,extend:EE,trim:AE,stripBOM:_E,inherits:CE,toFlatObject:TE,kindOf:id,kindOfTest:rs,endsWith:RE,toArray:ME,forEachEntry:NE,matchAll:kE,isHTMLForm:OE,hasOwnProperty:M0,hasOwnProp:M0,reduceDescriptors:hx,freezeMethods:PE,toObjectSet:BE,toCamelCase:LE,noop:FE,toFiniteNumber:IE,findKey:cx,global:Vr,isContextDefined:ux,isSpecCompliantForm:UE,toJSONObject:zE,isAsyncFn:HE,isThenable:qE,setImmediate:dx,asap:GE,isIterable:KE};let te=class fx extends Error{static from(t,e,i,a,l,c){const u=new fx(t.message,e||t.code,i,a,l);return u.cause=t,u.name=t.name,c&&Object.assign(u,c),u}constructor(t,e,i,a,l){super(t),this.name="AxiosError",this.isAxiosError=!0,e&&(this.code=e),i&&(this.config=i),a&&(this.request=a),l&&(this.response=l,this.status=l.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:dt.toJSONObject(this.config),code:this.code,status:this.status}}};te.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";te.ERR_BAD_OPTION="ERR_BAD_OPTION";te.ECONNABORTED="ECONNABORTED";te.ETIMEDOUT="ETIMEDOUT";te.ERR_NETWORK="ERR_NETWORK";te.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";te.ERR_DEPRECATED="ERR_DEPRECATED";te.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";te.ERR_BAD_REQUEST="ERR_BAD_REQUEST";te.ERR_CANCELED="ERR_CANCELED";te.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";te.ERR_INVALID_URL="ERR_INVALID_URL";const VE=null;function Vp(r){return dt.isPlainObject(r)||dt.isArray(r)}function px(r){return dt.endsWith(r,"[]")?r.slice(0,-2):r}function D0(r,t,e){return r?r.concat(t).map(function(a,l){return a=px(a),!e&&l?"["+a+"]":a}).join(e?".":""):t}function $E(r){return dt.isArray(r)&&!r.some(Vp)}const XE=dt.toFlatObject(dt,{},null,function(t){return/^is[A-Z]/.test(t)});function ad(r,t,e){if(!dt.isObject(r))throw new TypeError("target must be an object");t=t||new FormData,e=dt.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(E,R){return!dt.isUndefined(R[E])});const i=e.metaTokens,a=e.visitor||p,l=e.dots,c=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&dt.isSpecCompliantForm(t);if(!dt.isFunction(a))throw new TypeError("visitor must be a function");function f(A){if(A===null)return"";if(dt.isDate(A))return A.toISOString();if(dt.isBoolean(A))return A.toString();if(!d&&dt.isBlob(A))throw new te("Blob is not supported. Use a Buffer instead.");return dt.isArrayBuffer(A)||dt.isTypedArray(A)?d&&typeof Blob=="function"?new Blob([A]):Buffer.from(A):A}function p(A,E,R){let D=A;if(A&&!R&&typeof A=="object"){if(dt.endsWith(E,"{}"))E=i?E:E.slice(0,-2),A=JSON.stringify(A);else if(dt.isArray(A)&&$E(A)||(dt.isFileList(A)||dt.endsWith(E,"[]"))&&(D=dt.toArray(A)))return E=px(E),D.forEach(function(O,I){!(dt.isUndefined(O)||O===null)&&t.append(c===!0?D0([E],I,l):c===null?E:E+"[]",f(O))}),!1}return Vp(A)?!0:(t.append(D0(R,E,l),f(A)),!1)}const y=[],x=Object.assign(XE,{defaultVisitor:p,convertValue:f,isVisitable:Vp});function S(A,E){if(!dt.isUndefined(A)){if(y.indexOf(A)!==-1)throw Error("Circular reference detected in "+E.join("."));y.push(A),dt.forEach(A,function(D,k){(!(dt.isUndefined(D)||D===null)&&a.call(t,D,dt.isString(k)?k.trim():k,E,x))===!0&&S(D,E?E.concat(k):[k])}),y.pop()}}if(!dt.isObject(r))throw new TypeError("data must be an object");return S(r),t}function N0(r){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(r).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Rm(r,t){this._pairs=[],r&&ad(r,this,t)}const mx=Rm.prototype;mx.append=function(t,e){this._pairs.push([t,e])};mx.toString=function(t){const e=t?function(i){return t.call(this,i,N0)}:N0;return this._pairs.map(function(a){return e(a[0])+"="+e(a[1])},"").join("&")};function YE(r){return encodeURIComponent(r).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function gx(r,t,e){if(!t)return r;const i=e&&e.encode||YE,a=dt.isFunction(e)?{serialize:e}:e,l=a&&a.serialize;let c;if(l?c=l(t,a):c=dt.isURLSearchParams(t)?t.toString():new Rm(t,a).toString(i),c){const u=r.indexOf("#");u!==-1&&(r=r.slice(0,u)),r+=(r.indexOf("?")===-1?"?":"&")+c}return r}class k0{constructor(){this.handlers=[]}use(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){dt.forEach(this.handlers,function(i){i!==null&&t(i)})}}const Mm={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},QE=typeof URLSearchParams<"u"?URLSearchParams:Rm,WE=typeof FormData<"u"?FormData:null,ZE=typeof Blob<"u"?Blob:null,JE={isBrowser:!0,classes:{URLSearchParams:QE,FormData:WE,Blob:ZE},protocols:["http","https","file","blob","url","data"]},Dm=typeof window<"u"&&typeof document<"u",$p=typeof navigator=="object"&&navigator||void 0,t_=Dm&&(!$p||["ReactNative","NativeScript","NS"].indexOf($p.product)<0),e_=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",n_=Dm&&window.location.href||"http://localhost",i_=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Dm,hasStandardBrowserEnv:t_,hasStandardBrowserWebWorkerEnv:e_,navigator:$p,origin:n_},Symbol.toStringTag,{value:"Module"})),Zn={...i_,...JE};function s_(r,t){return ad(r,new Zn.classes.URLSearchParams,{visitor:function(e,i,a,l){return Zn.isNode&&dt.isBuffer(e)?(this.append(i,e.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function a_(r){return dt.matchAll(/\w+|\[(\w*)]/g,r).map(t=>t[0]==="[]"?"":t[1]||t[0])}function r_(r){const t={},e=Object.keys(r);let i;const a=e.length;let l;for(i=0;i<a;i++)l=e[i],t[l]=r[l];return t}function yx(r){function t(e,i,a,l){let c=e[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=l>=e.length;return c=!c&&dt.isArray(a)?a.length:c,d?(dt.hasOwnProp(a,c)?a[c]=[a[c],i]:a[c]=i,!u):((!a[c]||!dt.isObject(a[c]))&&(a[c]=[]),t(e,i,a[c],l)&&dt.isArray(a[c])&&(a[c]=r_(a[c])),!u)}if(dt.isFormData(r)&&dt.isFunction(r.entries)){const e={};return dt.forEachEntry(r,(i,a)=>{t(a_(i),a,e,0)}),e}return null}function o_(r,t,e){if(dt.isString(r))try{return(t||JSON.parse)(r),dt.trim(r)}catch(i){if(i.name!=="SyntaxError")throw i}return(e||JSON.stringify)(r)}const Zc={transitional:Mm,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const i=e.getContentType()||"",a=i.indexOf("application/json")>-1,l=dt.isObject(t);if(l&&dt.isHTMLForm(t)&&(t=new FormData(t)),dt.isFormData(t))return a?JSON.stringify(yx(t)):t;if(dt.isArrayBuffer(t)||dt.isBuffer(t)||dt.isStream(t)||dt.isFile(t)||dt.isBlob(t)||dt.isReadableStream(t))return t;if(dt.isArrayBufferView(t))return t.buffer;if(dt.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(i.indexOf("application/x-www-form-urlencoded")>-1)return s_(t,this.formSerializer).toString();if((u=dt.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return ad(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return l||a?(e.setContentType("application/json",!1),o_(t)):t}],transformResponse:[function(t){const e=this.transitional||Zc.transitional,i=e&&e.forcedJSONParsing,a=this.responseType==="json";if(dt.isResponse(t)||dt.isReadableStream(t))return t;if(t&&dt.isString(t)&&(i&&!this.responseType||a)){const c=!(e&&e.silentJSONParsing)&&a;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?te.from(u,te.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Zn.classes.FormData,Blob:Zn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};dt.forEach(["delete","get","head","post","put","patch"],r=>{Zc.headers[r]={}});const l_=dt.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),c_=r=>{const t={};let e,i,a;return r&&r.split(`
`).forEach(function(c){a=c.indexOf(":"),e=c.substring(0,a).trim().toLowerCase(),i=c.substring(a+1).trim(),!(!e||t[e]&&l_[e])&&(e==="set-cookie"?t[e]?t[e].push(i):t[e]=[i]:t[e]=t[e]?t[e]+", "+i:i)}),t},O0=Symbol("internals");function Cc(r){return r&&String(r).trim().toLowerCase()}function Ph(r){return r===!1||r==null?r:dt.isArray(r)?r.map(Ph):String(r)}function u_(r){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=e.exec(r);)t[i[1]]=i[2];return t}const h_=r=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(r.trim());function Ep(r,t,e,i,a){if(dt.isFunction(i))return i.call(this,t,e);if(a&&(t=e),!!dt.isString(t)){if(dt.isString(i))return t.indexOf(i)!==-1;if(dt.isRegExp(i))return i.test(t)}}function d_(r){return r.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,i)=>e.toUpperCase()+i)}function f_(r,t){const e=dt.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(r,i+e,{value:function(a,l,c){return this[i].call(this,t,a,l,c)},configurable:!0})})}let gi=class{constructor(t){t&&this.set(t)}set(t,e,i){const a=this;function l(u,d,f){const p=Cc(d);if(!p)throw new Error("header name must be a non-empty string");const y=dt.findKey(a,p);(!y||a[y]===void 0||f===!0||f===void 0&&a[y]!==!1)&&(a[y||d]=Ph(u))}const c=(u,d)=>dt.forEach(u,(f,p)=>l(f,p,d));if(dt.isPlainObject(t)||t instanceof this.constructor)c(t,e);else if(dt.isString(t)&&(t=t.trim())&&!h_(t))c(c_(t),e);else if(dt.isObject(t)&&dt.isIterable(t)){let u={},d,f;for(const p of t){if(!dt.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?dt.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}c(u,e)}else t!=null&&l(e,t,i);return this}get(t,e){if(t=Cc(t),t){const i=dt.findKey(this,t);if(i){const a=this[i];if(!e)return a;if(e===!0)return u_(a);if(dt.isFunction(e))return e.call(this,a,i);if(dt.isRegExp(e))return e.exec(a);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=Cc(t),t){const i=dt.findKey(this,t);return!!(i&&this[i]!==void 0&&(!e||Ep(this,this[i],i,e)))}return!1}delete(t,e){const i=this;let a=!1;function l(c){if(c=Cc(c),c){const u=dt.findKey(i,c);u&&(!e||Ep(i,i[u],u,e))&&(delete i[u],a=!0)}}return dt.isArray(t)?t.forEach(l):l(t),a}clear(t){const e=Object.keys(this);let i=e.length,a=!1;for(;i--;){const l=e[i];(!t||Ep(this,this[l],l,t,!0))&&(delete this[l],a=!0)}return a}normalize(t){const e=this,i={};return dt.forEach(this,(a,l)=>{const c=dt.findKey(i,l);if(c){e[c]=Ph(a),delete e[l];return}const u=t?d_(l):String(l).trim();u!==l&&delete e[l],e[u]=Ph(a),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return dt.forEach(this,(i,a)=>{i!=null&&i!==!1&&(e[a]=t&&dt.isArray(i)?i.join(", "):i)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const i=new this(t);return e.forEach(a=>i.set(a)),i}static accessor(t){const i=(this[O0]=this[O0]={accessors:{}}).accessors,a=this.prototype;function l(c){const u=Cc(c);i[u]||(f_(a,c),i[u]=!0)}return dt.isArray(t)?t.forEach(l):l(t),this}};gi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);dt.reduceDescriptors(gi.prototype,({value:r},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>r,set(i){this[e]=i}}});dt.freezeMethods(gi);function _p(r,t){const e=this||Zc,i=t||e,a=gi.from(i.headers);let l=i.data;return dt.forEach(r,function(u){l=u.call(e,l,a.normalize(),t?t.status:void 0)}),a.normalize(),l}function bx(r){return!!(r&&r.__CANCEL__)}let Jc=class extends te{constructor(t,e,i){super(t??"canceled",te.ERR_CANCELED,e,i),this.name="CanceledError",this.__CANCEL__=!0}};function vx(r,t,e){const i=e.config.validateStatus;!e.status||!i||i(e.status)?r(e):t(new te("Request failed with status code "+e.status,[te.ERR_BAD_REQUEST,te.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function p_(r){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(r);return t&&t[1]||""}function m_(r,t){r=r||10;const e=new Array(r),i=new Array(r);let a=0,l=0,c;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=i[l];c||(c=f),e[a]=d,i[a]=f;let y=l,x=0;for(;y!==a;)x+=e[y++],y=y%r;if(a=(a+1)%r,a===l&&(l=(l+1)%r),f-c<t)return;const S=p&&f-p;return S?Math.round(x*1e3/S):void 0}}function g_(r,t){let e=0,i=1e3/t,a,l;const c=(f,p=Date.now())=>{e=p,a=null,l&&(clearTimeout(l),l=null),r(...f)};return[(...f)=>{const p=Date.now(),y=p-e;y>=i?c(f,p):(a=f,l||(l=setTimeout(()=>{l=null,c(a)},i-y)))},()=>a&&c(a)]}const Vh=(r,t,e=3)=>{let i=0;const a=m_(50,250);return g_(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,d=c-i,f=a(d),p=c<=u;i=c;const y={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-c)/f:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};r(y)},e)},L0=(r,t)=>{const e=r!=null;return[i=>t[0]({lengthComputable:e,total:r,loaded:i}),t[1]]},j0=r=>(...t)=>dt.asap(()=>r(...t)),y_=Zn.hasStandardBrowserEnv?((r,t)=>e=>(e=new URL(e,Zn.origin),r.protocol===e.protocol&&r.host===e.host&&(t||r.port===e.port)))(new URL(Zn.origin),Zn.navigator&&/(msie|trident)/i.test(Zn.navigator.userAgent)):()=>!0,b_=Zn.hasStandardBrowserEnv?{write(r,t,e,i,a,l,c){if(typeof document>"u")return;const u=[`${r}=${encodeURIComponent(t)}`];dt.isNumber(e)&&u.push(`expires=${new Date(e).toUTCString()}`),dt.isString(i)&&u.push(`path=${i}`),dt.isString(a)&&u.push(`domain=${a}`),l===!0&&u.push("secure"),dt.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(r){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+r+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(r){this.write(r,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function v_(r){return typeof r!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(r)}function x_(r,t){return t?r.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):r}function xx(r,t,e){let i=!v_(t);return r&&(i||e==!1)?x_(r,t):t}const P0=r=>r instanceof gi?{...r}:r;function eo(r,t){t=t||{};const e={};function i(f,p,y,x){return dt.isPlainObject(f)&&dt.isPlainObject(p)?dt.merge.call({caseless:x},f,p):dt.isPlainObject(p)?dt.merge({},p):dt.isArray(p)?p.slice():p}function a(f,p,y,x){if(dt.isUndefined(p)){if(!dt.isUndefined(f))return i(void 0,f,y,x)}else return i(f,p,y,x)}function l(f,p){if(!dt.isUndefined(p))return i(void 0,p)}function c(f,p){if(dt.isUndefined(p)){if(!dt.isUndefined(f))return i(void 0,f)}else return i(void 0,p)}function u(f,p,y){if(y in t)return i(f,p);if(y in r)return i(void 0,f)}const d={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(f,p,y)=>a(P0(f),P0(p),y,!0)};return dt.forEach(Object.keys({...r,...t}),function(p){if(p==="__proto__"||p==="constructor"||p==="prototype")return;const y=dt.hasOwnProp(d,p)?d[p]:a,x=y(r[p],t[p],p);dt.isUndefined(x)&&y!==u||(e[p]=x)}),e}const wx=r=>{const t=eo({},r);let{data:e,withXSRFToken:i,xsrfHeaderName:a,xsrfCookieName:l,headers:c,auth:u}=t;if(t.headers=c=gi.from(c),t.url=gx(xx(t.baseURL,t.url,t.allowAbsoluteUrls),r.params,r.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),dt.isFormData(e)){if(Zn.hasStandardBrowserEnv||Zn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(dt.isFunction(e.getHeaders)){const d=e.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,y])=>{f.includes(p.toLowerCase())&&c.set(p,y)})}}if(Zn.hasStandardBrowserEnv&&(i&&dt.isFunction(i)&&(i=i(t)),i||i!==!1&&y_(t.url))){const d=a&&l&&b_.read(l);d&&c.set(a,d)}return t},w_=typeof XMLHttpRequest<"u",S_=w_&&function(r){return new Promise(function(e,i){const a=wx(r);let l=a.data;const c=gi.from(a.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=a,p,y,x,S,A;function E(){S&&S(),A&&A(),a.cancelToken&&a.cancelToken.unsubscribe(p),a.signal&&a.signal.removeEventListener("abort",p)}let R=new XMLHttpRequest;R.open(a.method.toUpperCase(),a.url,!0),R.timeout=a.timeout;function D(){if(!R)return;const O=gi.from("getAllResponseHeaders"in R&&R.getAllResponseHeaders()),z={data:!u||u==="text"||u==="json"?R.responseText:R.response,status:R.status,statusText:R.statusText,headers:O,config:r,request:R};vx(function(P){e(P),E()},function(P){i(P),E()},z),R=null}"onloadend"in R?R.onloadend=D:R.onreadystatechange=function(){!R||R.readyState!==4||R.status===0&&!(R.responseURL&&R.responseURL.indexOf("file:")===0)||setTimeout(D)},R.onabort=function(){R&&(i(new te("Request aborted",te.ECONNABORTED,r,R)),R=null)},R.onerror=function(I){const z=I&&I.message?I.message:"Network Error",H=new te(z,te.ERR_NETWORK,r,R);H.event=I||null,i(H),R=null},R.ontimeout=function(){let I=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const z=a.transitional||Mm;a.timeoutErrorMessage&&(I=a.timeoutErrorMessage),i(new te(I,z.clarifyTimeoutError?te.ETIMEDOUT:te.ECONNABORTED,r,R)),R=null},l===void 0&&c.setContentType(null),"setRequestHeader"in R&&dt.forEach(c.toJSON(),function(I,z){R.setRequestHeader(z,I)}),dt.isUndefined(a.withCredentials)||(R.withCredentials=!!a.withCredentials),u&&u!=="json"&&(R.responseType=a.responseType),f&&([x,A]=Vh(f,!0),R.addEventListener("progress",x)),d&&R.upload&&([y,S]=Vh(d),R.upload.addEventListener("progress",y),R.upload.addEventListener("loadend",S)),(a.cancelToken||a.signal)&&(p=O=>{R&&(i(!O||O.type?new Jc(null,r,R):O),R.abort(),R=null)},a.cancelToken&&a.cancelToken.subscribe(p),a.signal&&(a.signal.aborted?p():a.signal.addEventListener("abort",p)));const k=p_(a.url);if(k&&Zn.protocols.indexOf(k)===-1){i(new te("Unsupported protocol "+k+":",te.ERR_BAD_REQUEST,r));return}R.send(l||null)})},A_=(r,t)=>{const{length:e}=r=r?r.filter(Boolean):[];if(t||e){let i=new AbortController,a;const l=function(f){if(!a){a=!0,u();const p=f instanceof Error?f:this.reason;i.abort(p instanceof te?p:new Jc(p instanceof Error?p.message:p))}};let c=t&&setTimeout(()=>{c=null,l(new te(`timeout of ${t}ms exceeded`,te.ETIMEDOUT))},t);const u=()=>{r&&(c&&clearTimeout(c),c=null,r.forEach(f=>{f.unsubscribe?f.unsubscribe(l):f.removeEventListener("abort",l)}),r=null)};r.forEach(f=>f.addEventListener("abort",l));const{signal:d}=i;return d.unsubscribe=()=>dt.asap(u),d}},E_=function*(r,t){let e=r.byteLength;if(e<t){yield r;return}let i=0,a;for(;i<e;)a=i+t,yield r.slice(i,a),i=a},__=async function*(r,t){for await(const e of C_(r))yield*E_(e,t)},C_=async function*(r){if(r[Symbol.asyncIterator]){yield*r;return}const t=r.getReader();try{for(;;){const{done:e,value:i}=await t.read();if(e)break;yield i}}finally{await t.cancel()}},B0=(r,t,e,i)=>{const a=__(r,t);let l=0,c,u=d=>{c||(c=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await a.next();if(f){u(),d.close();return}let y=p.byteLength;if(e){let x=l+=y;e(x)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),a.return()}},{highWaterMark:2})},F0=64*1024,{isFunction:wh}=dt,T_=(({Request:r,Response:t})=>({Request:r,Response:t}))(dt.global),{ReadableStream:I0,TextEncoder:U0}=dt.global,z0=(r,...t)=>{try{return!!r(...t)}catch{return!1}},R_=r=>{r=dt.merge.call({skipUndefined:!0},T_,r);const{fetch:t,Request:e,Response:i}=r,a=t?wh(t):typeof fetch=="function",l=wh(e),c=wh(i);if(!a)return!1;const u=a&&wh(I0),d=a&&(typeof U0=="function"?(A=>E=>A.encode(E))(new U0):async A=>new Uint8Array(await new e(A).arrayBuffer())),f=l&&u&&z0(()=>{let A=!1;const E=new e(Zn.origin,{body:new I0,method:"POST",get duplex(){return A=!0,"half"}}).headers.has("Content-Type");return A&&!E}),p=c&&u&&z0(()=>dt.isReadableStream(new i("").body)),y={stream:p&&(A=>A.body)};a&&["text","arrayBuffer","blob","formData","stream"].forEach(A=>{!y[A]&&(y[A]=(E,R)=>{let D=E&&E[A];if(D)return D.call(E);throw new te(`Response type '${A}' is not supported`,te.ERR_NOT_SUPPORT,R)})});const x=async A=>{if(A==null)return 0;if(dt.isBlob(A))return A.size;if(dt.isSpecCompliantForm(A))return(await new e(Zn.origin,{method:"POST",body:A}).arrayBuffer()).byteLength;if(dt.isArrayBufferView(A)||dt.isArrayBuffer(A))return A.byteLength;if(dt.isURLSearchParams(A)&&(A=A+""),dt.isString(A))return(await d(A)).byteLength},S=async(A,E)=>{const R=dt.toFiniteNumber(A.getContentLength());return R??x(E)};return async A=>{let{url:E,method:R,data:D,signal:k,cancelToken:O,timeout:I,onDownloadProgress:z,onUploadProgress:H,responseType:P,headers:rt,withCredentials:ut="same-origin",fetchOptions:St}=wx(A),_t=t||fetch;P=P?(P+"").toLowerCase():"text";let Mt=A_([k,O&&O.toAbortSignal()],I),Vt=null;const vt=Mt&&Mt.unsubscribe&&(()=>{Mt.unsubscribe()});let Ht;try{if(H&&f&&R!=="get"&&R!=="head"&&(Ht=await S(rt,D))!==0){let F=new e(E,{method:"POST",body:D,duplex:"half"}),J;if(dt.isFormData(D)&&(J=F.headers.get("content-type"))&&rt.setContentType(J),F.body){const[ht,xt]=L0(Ht,Vh(j0(H)));D=B0(F.body,F0,ht,xt)}}dt.isString(ut)||(ut=ut?"include":"omit");const G=l&&"credentials"in e.prototype,ct={...St,signal:Mt,method:R.toUpperCase(),headers:rt.normalize().toJSON(),body:D,duplex:"half",credentials:G?ut:void 0};Vt=l&&new e(E,ct);let yt=await(l?_t(Vt,St):_t(E,ct));const Tt=p&&(P==="stream"||P==="response");if(p&&(z||Tt&&vt)){const F={};["status","statusText","headers"].forEach(Dt=>{F[Dt]=yt[Dt]});const J=dt.toFiniteNumber(yt.headers.get("content-length")),[ht,xt]=z&&L0(J,Vh(j0(z),!0))||[];yt=new i(B0(yt.body,F0,ht,()=>{xt&&xt(),vt&&vt()}),F)}P=P||"text";let Pt=await y[dt.findKey(y,P)||"text"](yt,A);return!Tt&&vt&&vt(),await new Promise((F,J)=>{vx(F,J,{data:Pt,headers:gi.from(yt.headers),status:yt.status,statusText:yt.statusText,config:A,request:Vt})})}catch(G){throw vt&&vt(),G&&G.name==="TypeError"&&/Load failed|fetch/i.test(G.message)?Object.assign(new te("Network Error",te.ERR_NETWORK,A,Vt,G&&G.response),{cause:G.cause||G}):te.from(G,G&&G.code,A,Vt,G&&G.response)}}},M_=new Map,Sx=r=>{let t=r&&r.env||{};const{fetch:e,Request:i,Response:a}=t,l=[i,a,e];let c=l.length,u=c,d,f,p=M_;for(;u--;)d=l[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:R_(t)),p=f;return f};Sx();const Nm={http:VE,xhr:S_,fetch:{get:Sx}};dt.forEach(Nm,(r,t)=>{if(r){try{Object.defineProperty(r,"name",{value:t})}catch{}Object.defineProperty(r,"adapterName",{value:t})}});const H0=r=>`- ${r}`,D_=r=>dt.isFunction(r)||r===null||r===!1;function N_(r,t){r=dt.isArray(r)?r:[r];const{length:e}=r;let i,a;const l={};for(let c=0;c<e;c++){i=r[c];let u;if(a=i,!D_(i)&&(a=Nm[(u=String(i)).toLowerCase()],a===void 0))throw new te(`Unknown adapter '${u}'`);if(a&&(dt.isFunction(a)||(a=a.get(t))))break;l[u||"#"+c]=a}if(!a){const c=Object.entries(l).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=e?c.length>1?`since :
`+c.map(H0).join(`
`):" "+H0(c[0]):"as no adapter specified";throw new te("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return a}const Ax={getAdapter:N_,adapters:Nm};function Cp(r){if(r.cancelToken&&r.cancelToken.throwIfRequested(),r.signal&&r.signal.aborted)throw new Jc(null,r)}function q0(r){return Cp(r),r.headers=gi.from(r.headers),r.data=_p.call(r,r.transformRequest),["post","put","patch"].indexOf(r.method)!==-1&&r.headers.setContentType("application/x-www-form-urlencoded",!1),Ax.getAdapter(r.adapter||Zc.adapter,r)(r).then(function(i){return Cp(r),i.data=_p.call(r,r.transformResponse,i),i.headers=gi.from(i.headers),i},function(i){return bx(i)||(Cp(r),i&&i.response&&(i.response.data=_p.call(r,r.transformResponse,i.response),i.response.headers=gi.from(i.response.headers))),Promise.reject(i)})}const Ex="1.13.5",rd={};["object","boolean","number","function","string","symbol"].forEach((r,t)=>{rd[r]=function(i){return typeof i===r||"a"+(t<1?"n ":" ")+r}});const G0={};rd.transitional=function(t,e,i){function a(l,c){return"[Axios v"+Ex+"] Transitional option '"+l+"'"+c+(i?". "+i:"")}return(l,c,u)=>{if(t===!1)throw new te(a(c," has been removed"+(e?" in "+e:"")),te.ERR_DEPRECATED);return e&&!G0[c]&&(G0[c]=!0,console.warn(a(c," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(l,c,u):!0}};rd.spelling=function(t){return(e,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function k_(r,t,e){if(typeof r!="object")throw new te("options must be an object",te.ERR_BAD_OPTION_VALUE);const i=Object.keys(r);let a=i.length;for(;a-- >0;){const l=i[a],c=t[l];if(c){const u=r[l],d=u===void 0||c(u,l,r);if(d!==!0)throw new te("option "+l+" must be "+d,te.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new te("Unknown option "+l,te.ERR_BAD_OPTION)}}const Bh={assertOptions:k_,validators:rd},qi=Bh.validators;let Wr=class{constructor(t){this.defaults=t||{},this.interceptors={request:new k0,response:new k0}}async request(t,e){try{return await this._request(t,e)}catch(i){if(i instanceof Error){let a={};Error.captureStackTrace?Error.captureStackTrace(a):a=new Error;const l=a.stack?a.stack.replace(/^.+\n/,""):"";try{i.stack?l&&!String(i.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+l):i.stack=l}catch{}}throw i}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=eo(this.defaults,e);const{transitional:i,paramsSerializer:a,headers:l}=e;i!==void 0&&Bh.assertOptions(i,{silentJSONParsing:qi.transitional(qi.boolean),forcedJSONParsing:qi.transitional(qi.boolean),clarifyTimeoutError:qi.transitional(qi.boolean),legacyInterceptorReqResOrdering:qi.transitional(qi.boolean)},!1),a!=null&&(dt.isFunction(a)?e.paramsSerializer={serialize:a}:Bh.assertOptions(a,{encode:qi.function,serialize:qi.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Bh.assertOptions(e,{baseUrl:qi.spelling("baseURL"),withXsrfToken:qi.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let c=l&&dt.merge(l.common,l[e.method]);l&&dt.forEach(["delete","get","head","post","put","patch","common"],A=>{delete l[A]}),e.headers=gi.concat(c,l);const u=[];let d=!0;this.interceptors.request.forEach(function(E){if(typeof E.runWhen=="function"&&E.runWhen(e)===!1)return;d=d&&E.synchronous;const R=e.transitional||Mm;R&&R.legacyInterceptorReqResOrdering?u.unshift(E.fulfilled,E.rejected):u.push(E.fulfilled,E.rejected)});const f=[];this.interceptors.response.forEach(function(E){f.push(E.fulfilled,E.rejected)});let p,y=0,x;if(!d){const A=[q0.bind(this),void 0];for(A.unshift(...u),A.push(...f),x=A.length,p=Promise.resolve(e);y<x;)p=p.then(A[y++],A[y++]);return p}x=u.length;let S=e;for(;y<x;){const A=u[y++],E=u[y++];try{S=A(S)}catch(R){E.call(this,R);break}}try{p=q0.call(this,S)}catch(A){return Promise.reject(A)}for(y=0,x=f.length;y<x;)p=p.then(f[y++],f[y++]);return p}getUri(t){t=eo(this.defaults,t);const e=xx(t.baseURL,t.url,t.allowAbsoluteUrls);return gx(e,t.params,t.paramsSerializer)}};dt.forEach(["delete","get","head","options"],function(t){Wr.prototype[t]=function(e,i){return this.request(eo(i||{},{method:t,url:e,data:(i||{}).data}))}});dt.forEach(["post","put","patch"],function(t){function e(i){return function(l,c,u){return this.request(eo(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}Wr.prototype[t]=e(),Wr.prototype[t+"Form"]=e(!0)});let O_=class _x{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(l){e=l});const i=this;this.promise.then(a=>{if(!i._listeners)return;let l=i._listeners.length;for(;l-- >0;)i._listeners[l](a);i._listeners=null}),this.promise.then=a=>{let l;const c=new Promise(u=>{i.subscribe(u),l=u}).then(a);return c.cancel=function(){i.unsubscribe(l)},c},t(function(l,c,u){i.reason||(i.reason=new Jc(l,c,u),e(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=i=>{t.abort(i)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new _x(function(a){t=a}),cancel:t}}};function L_(r){return function(e){return r.apply(null,e)}}function j_(r){return dt.isObject(r)&&r.isAxiosError===!0}const Xp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Xp).forEach(([r,t])=>{Xp[t]=r});function Cx(r){const t=new Wr(r),e=ax(Wr.prototype.request,t);return dt.extend(e,Wr.prototype,t,{allOwnKeys:!0}),dt.extend(e,t,null,{allOwnKeys:!0}),e.create=function(a){return Cx(eo(r,a))},e}const mn=Cx(Zc);mn.Axios=Wr;mn.CanceledError=Jc;mn.CancelToken=O_;mn.isCancel=bx;mn.VERSION=Ex;mn.toFormData=ad;mn.AxiosError=te;mn.Cancel=mn.CanceledError;mn.all=function(t){return Promise.all(t)};mn.spread=L_;mn.isAxiosError=j_;mn.mergeConfig=eo;mn.AxiosHeaders=gi;mn.formToJSON=r=>yx(dt.isHTMLForm(r)?new FormData(r):r);mn.getAdapter=Ax.getAdapter;mn.HttpStatusCode=Xp;mn.default=mn;const{Axios:sR,AxiosError:aR,CanceledError:rR,isCancel:oR,CancelToken:lR,VERSION:cR,all:uR,Cancel:hR,isAxiosError:dR,spread:fR,toFormData:pR,AxiosHeaders:mR,HttpStatusCode:gR,formToJSON:yR,getAdapter:bR,mergeConfig:vR}=mn,_e=mn.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});_e.interceptors.request.use(r=>{const t=Sa.getState().token;return t&&(r.headers.Authorization=`Token ${t}`),r.data instanceof FormData&&delete r.headers["Content-Type"],r});_e.interceptors.response.use(r=>r,r=>(r.response?.status===401&&Sa.getState().logout(),Promise.reject(r)));const ml={login:(r,t)=>_e.post("/auth/login/",{email:r,password:t}),register:r=>_e.post("/auth/register/",r),logout:()=>_e.post("/auth/logout/"),me:()=>_e.get("/auth/me/"),deleteAccount:()=>_e.post("/auth/me/delete/")},Bc={list:()=>_e.get("/projects/"),get:r=>_e.get(`/projects/${r}/`),create:r=>_e.post("/projects/",r),update:(r,t)=>_e.patch(`/projects/${r}/`,t),delete:r=>_e.delete(`/projects/${r}/`)},ya={list:()=>_e.get("/presets/"),get:r=>_e.get(`/presets/${r}/`),create:r=>_e.post("/presets/",r),update:(r,t)=>_e.patch(`/presets/${r}/`,t),delete:r=>_e.delete(`/presets/${r}/`),addColor:(r,t)=>_e.post(`/presets/${r}/colors/`,t),updateColor:(r,t,e)=>_e.patch(`/presets/${r}/colors/${t}/`,e),removeColor:(r,t)=>_e.delete(`/presets/${r}/colors/${t}/`)},Hn={list:r=>_e.get("/documents/",{params:r}),get:r=>_e.get(`/documents/${r}/`),create:r=>_e.post("/documents/",r),createWithFile:r=>_e.post("/documents/",r),getPdf:r=>_e.get(`/documents/${r}/pdf/`,{responseType:"arraybuffer"}),uploadPdf:(r,t)=>_e.post(`/documents/${r}/upload_pdf/`,t),update:(r,t)=>_e.patch(`/documents/${r}/`,t),delete:r=>_e.delete(`/documents/${r}/`),highlights:r=>_e.get(`/documents/${r}/highlights/`),createHighlight:(r,t)=>_e.post(`/documents/${r}/highlights/`,t),updateHighlight:(r,t,e)=>_e.patch(`/documents/${r}/highlights/${t}/`,e),deleteHighlight:(r,t)=>_e.delete(`/documents/${r}/highlights/${t}/`)},P_={page:"bg-slate-50",surface:"bg-white",muted:"bg-slate-100"},Jt={body:"text-slate-800",heading:"text-slate-900",secondary:"text-slate-600",muted:"text-slate-500"},Ls={default:"border-slate-200"},Zr="min-h-screen p-6",Tx="bg-white border-b border-slate-200",gl="bg-slate-800 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-slate-700 cursor-pointer",Oc="p-2 rounded-lg text-slate-600 hover:bg-slate-100 cursor-pointer",K0="w-px h-6 bg-slate-200",js=P_;function B_(){const r=wa(),t=Sa(y=>y.setToken),[e,i]=U.useState(""),[a,l]=U.useState(""),[c,u]=U.useState(""),[d,f]=U.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{const{data:x}=await ml.login(e,a);t(x.token),r("/",{replace:!0})}catch(x){u(x.response?.data?.detail||x.response?.data?.email?.[0]||"Login failed")}finally{f(!1)}};return C.jsx("div",{className:`${Zr} ${js.page} flex items-center justify-center`,children:C.jsxs("div",{className:"w-full max-w-sm",children:[C.jsx("h1",{className:`text-2xl font-semibold ${Jt.heading} mb-6`,children:"Sign in"}),C.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&C.jsx("p",{className:"text-sm text-red-600",children:c}),C.jsxs("label",{className:"flex flex-col gap-1",children:[C.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Email"}),C.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),C.jsxs("label",{className:"flex flex-col gap-1",children:[C.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Password"}),C.jsx("input",{type:"password",value:a,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"current-password"})]}),C.jsx("button",{type:"submit",disabled:d,className:gl,children:d?"Signing in...":"Sign in"})]}),C.jsxs("p",{className:`mt-4 text-sm ${Jt.muted}`,children:["No account? ",C.jsx(ed,{to:"/register",className:"text-slate-700 underline",children:"Register"})]})]})})}function F_(){const r=wa(),t=Sa(y=>y.setToken),[e,i]=U.useState(""),[a,l]=U.useState(""),[c,u]=U.useState(""),[d,f]=U.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{await ml.register({email:e,password:a});const{data:x}=await ml.login(e,a);t(x.token),r("/",{replace:!0})}catch(x){const S=x.response?.data;u(S?.email?.[0]||S?.password?.[0]||"Registration failed")}finally{f(!1)}};return C.jsx("div",{className:`${Zr} ${js.page} flex items-center justify-center`,children:C.jsxs("div",{className:"w-full max-w-sm",children:[C.jsx("h1",{className:`text-2xl font-semibold ${Jt.heading} mb-6`,children:"Create account"}),C.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&C.jsx("p",{className:"text-sm text-red-600",children:c}),C.jsxs("label",{className:"flex flex-col gap-1",children:[C.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Email"}),C.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),C.jsxs("label",{className:"flex flex-col gap-1",children:[C.jsx("span",{className:`text-sm ${Jt.secondary}`,children:"Password"}),C.jsx("input",{type:"password",value:a,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"new-password"})]}),C.jsx("button",{type:"submit",disabled:d,className:gl,children:d?"Creating account...":"Register"})]}),C.jsxs("p",{className:`mt-4 text-sm ${Jt.muted}`,children:["Already have an account? ",C.jsx(ed,{to:"/login",className:"text-slate-700 underline",children:"Sign in"})]})]})})}const Rx=(...r)=>r.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();const I_=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const U_=r=>r.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase());const V0=r=>{const t=U_(r);return t.charAt(0).toUpperCase()+t.slice(1)};var z_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const H_=r=>{for(const t in r)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const q_=U.forwardRef(({color:r="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:a="",children:l,iconNode:c,...u},d)=>U.createElement("svg",{ref:d,...z_,width:t,height:t,stroke:r,strokeWidth:i?Number(e)*24/Number(t):e,className:Rx("lucide",a),...!l&&!H_(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>U.createElement(f,p)),...Array.isArray(l)?l:[l]]));const ln=(r,t)=>{const e=U.forwardRef(({className:i,...a},l)=>U.createElement(q_,{ref:l,iconNode:t,className:Rx(`lucide-${I_(V0(r))}`,`lucide-${r}`,i),...a}));return e.displayName=V0(r),e};const G_=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],od=ln("arrow-left",G_);const K_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],$0=ln("check",K_);const V_=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],$_=ln("chevron-down",V_);const X_=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],Y_=ln("chevron-right",X_);const Q_=[["path",{d:"M11 21a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1",key:"likhh7"}],["path",{d:"M16 16a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1",key:"17ky3x"}],["path",{d:"M21 6a2 2 0 0 0-.586-1.414l-2-2A2 2 0 0 0 17 2h-3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1z",key:"1hyeo0"}]],W_=ln("file-stack",Q_);const Z_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Mx=ln("file-text",Z_);const J_=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],tC=ln("layers",J_);const eC=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],nC=ln("list-ordered",eC);const iC=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Os=ln("loader-circle",iC);const sC=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],km=ln("log-out",sC);const aC=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],rC=ln("palette",aC);const oC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],lC=ln("panel-right-close",oC);const cC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],uC=ln("panel-right-open",cC);const hC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Yp=ln("pencil",hC);const dC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],X0=ln("plus",dC);const fC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],pC=ln("search",fC);const mC=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],gC=ln("settings-2",mC);const yC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],zc=ln("trash-2",yC);const bC=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],Qp=ln("upload",bC);const vC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],$h=ln("x",vC);const xC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],wC=ln("zoom-in",xC);const SC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],AC=ln("zoom-out",SC),ba=["#f59e0b","#3b82f6","#10b981","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316"];function EC(r){if(!r)return"";const t=new Date(r);if(Number.isNaN(t.getTime()))return"";const e=new Date,i=e-t,a=Math.floor(i/6e4),l=Math.floor(i/36e5),c=Math.floor(i/864e5);return a<1?"Just now":a<60?`${a} min ago`:l<24?`${l} hour${l===1?"":"s"} ago`:c===1?"Yesterday":c<7?`${c} days ago`:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:t.getFullYear()!==e.getFullYear()?"numeric":void 0})}function _C({project:r,onOpen:t}){const[e,i]=U.useState(!1),a=r.document_count??0,l=r.annotation_count??0,c=r.color&&ba.includes(r.color)?r.color:ba[r.id%ba.length];return C.jsxs("div",{onMouseEnter:()=>i(!0),onMouseLeave:()=>i(!1),onClick:()=>t(r.id),role:"button",tabIndex:0,onKeyDown:u=>u.key==="Enter"&&t(r.id),className:"flex items-center gap-4 rounded-xl border border-slate-200 bg-white px-5 py-5 cursor-pointer transition-all duration-200",style:{boxShadow:e?"0 4px 12px rgba(71,85,105,0.08)":"0 1px 3px rgba(0,0,0,0.04)",transform:e?"translateY(-1px)":"none",background:e?"#f8fafc":"#fff"},children:[C.jsx("div",{className:"shrink-0 rounded-sm",style:{width:4,height:48,background:c}}),C.jsxs("div",{className:"flex-1 min-w-0",children:[C.jsx("div",{className:"text-base font-normal text-slate-900 truncate",style:{fontFamily:"'Instrument Serif', serif"},children:r.name}),C.jsxs("div",{className:"flex items-center gap-3 mt-1 text-[13px] text-slate-400",style:{fontFamily:"'JetBrains Mono', monospace"},children:[C.jsxs("span",{className:"flex items-center gap-1",children:[C.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-400",children:[C.jsx("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),C.jsx("polyline",{points:"14 2 14 8 20 8"})]}),a," ",a===1?"doc":"docs"]}),C.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),C.jsxs("span",{className:"flex items-center gap-1",children:[C.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-slate-400",children:[C.jsx("path",{d:"M12 20h9"}),C.jsx("path",{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"})]}),l," ",l===1?"annotation":"annotations"]})]})]}),C.jsx("div",{className:"text-[13px] text-slate-400 whitespace-nowrap shrink-0",style:{fontFamily:"'JetBrains Mono', monospace"},children:EC(r.updated_at)}),C.jsx("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:e?"#475569":"#cbd5e1",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"shrink-0 transition-colors",children:C.jsx("polyline",{points:"9 18 15 12 9 6"})})]})}function CC({onClose:r,onCreate:t,isPending:e,defaultColorIndex:i=0}){const[a,l]=U.useState(""),[c,u]=U.useState(ba[i%ba.length]),d=()=>{const f=a.trim();f&&(t(f,c),l(""),u(ba[i%ba.length]))};return C.jsx("div",{className:"fixed inset-0 bg-slate-950/40 backdrop-blur-sm flex items-center justify-center z-[1000]",onClick:r,children:C.jsxs("div",{className:"bg-white rounded-xl p-8 w-full max-w-[420px] shadow-xl mx-4",onClick:f=>f.stopPropagation(),children:[C.jsx("h2",{className:"m-0 text-xl font-normal text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"New project"}),C.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:"Group related deal documents together."}),C.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mb-1.5 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Project name"}),C.jsx("input",{type:"text",value:a,onChange:f=>l(f.target.value),placeholder:"e.g. Meridian Healthcare CIM",autoFocus:!0,className:"w-full px-3.5 py-2.5 text-[15px] border border-slate-200 rounded-lg outline-none text-slate-800 focus:border-slate-600 transition-colors box-border",style:{fontFamily:"'DM Sans', sans-serif"}}),C.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mt-5 mb-2 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Colour"}),C.jsx("div",{className:"flex gap-2",children:ba.map(f=>C.jsx("button",{type:"button",onClick:()=>u(f),className:"w-7 h-7 rounded-full shrink-0 transition-all border-2 border-transparent focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2",style:{background:f,borderColor:c===f?"#1e293b":"transparent",outline:c===f?"2px solid #fff":"none",outlineOffset:-4}},f))}),C.jsxs("div",{className:"flex justify-end gap-2.5 mt-7",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsx("button",{type:"button",onClick:r,className:"px-4 py-2 text-sm font-medium border border-slate-200 rounded-lg bg-white text-slate-500 hover:bg-slate-50",children:"Cancel"}),C.jsx("button",{type:"button",onClick:d,disabled:!a.trim()||e,className:"px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors disabled:bg-slate-300 disabled:cursor-default hover:bg-slate-700",style:{background:a.trim()&&!e?"#1e293b":"#cbd5e1"},children:e?"Creating":"Create project"})]})]})})}function TC(){const r=wa(),t=so(),e=Sa(k=>k.logout),[i,a]=U.useState(!1),[l,c]=U.useState(""),{data:u}=is({queryKey:["me"],queryFn:async()=>{const{data:k}=await ml.me();return k}}),{data:d,isLoading:f}=is({queryKey:["projects"],queryFn:async()=>{const{data:k}=await Bc.list();return k}}),p=Array.isArray(d)?d:d?.results??[],y=p.filter(k=>k.name.toLowerCase().includes(l.toLowerCase())),x=p.reduce((k,O)=>k+(O.document_count??0),0),S=p.reduce((k,O)=>k+(O.annotation_count??0),0),A=Mi({mutationFn:({name:k,color:O})=>Bc.create({name:k.trim(),color:O}),onSuccess:()=>{t.invalidateQueries({queryKey:["projects"]}),a(!1)}}),E=(k,O)=>{A.mutate({name:k,color:O})},R=()=>{e(),r("/login",{replace:!0})},D=(u?.email?.[0]||u?.username?.[0]||"?").toUpperCase();return C.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif",color:"#1e293b"},children:[C.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap",rel:"stylesheet"}),C.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("div",{className:"w-6 h-6 rounded-md bg-slate-700 flex items-center justify-center text-white text-xs font-semibold",style:{fontFamily:"'DM Sans', sans-serif"},children:"W"}),C.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{type:"button",onClick:R,className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:C.jsx(km,{className:"w-4 h-4"})}),C.jsx("button",{type:"button",onClick:()=>r("/app/settings"),className:"w-8 h-8 rounded-full bg-slate-700 text-white flex items-center justify-center text-[13px] font-semibold hover:bg-slate-600 transition-colors cursor-pointer",style:{fontFamily:"'DM Sans', sans-serif"},title:"Account settings",children:D})]})]}),C.jsxs("div",{className:"max-w-[720px] mx-auto px-6 py-10",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsxs("div",{className:"flex items-start justify-between mb-2",children:[C.jsx("h1",{className:"m-0 text-[28px] text-slate-950",style:{fontFamily:"'Instrument Serif', serif",fontWeight:700,letterSpacing:"0.01em"},children:"Projects"}),C.jsxs("button",{type:"button",onClick:()=>a(!0),className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors hover:bg-slate-700",style:{background:"#1e293b",fontFamily:"'DM Sans', sans-serif"},children:[C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2.5",strokeLinecap:"round",children:[C.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),C.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),"New project"]})]}),C.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-400 mb-6 uppercase",style:{fontFamily:"'JetBrains Mono', monospace",letterSpacing:"0.08em"},children:[C.jsxs("span",{children:[p.length," project",p.length!==1?"s":""]}),C.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),C.jsxs("span",{children:[x," document",x!==1?"s":""]}),C.jsx("span",{className:"w-0.5 h-0.5 rounded-full bg-slate-300"}),C.jsxs("span",{children:[S," annotation",S!==1?"s":""]})]}),p.length>3&&C.jsxs("div",{className:"relative mb-4",children:[C.jsxs("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"#94a3b8",strokeWidth:"2",className:"absolute left-3 top-1/2 -translate-y-1/2",children:[C.jsx("circle",{cx:"11",cy:"11",r:"8"}),C.jsx("line",{x1:"21",y1:"21",x2:"16.65",y2:"16.65"})]}),C.jsx("input",{type:"text",placeholder:"Search projects",value:l,onChange:k=>c(k.target.value),className:"w-full py-2.5 pl-9 pr-3.5 text-sm border border-slate-200 rounded-lg outline-none text-slate-800 bg-white box-border",style:{fontFamily:"'DM Sans', sans-serif"}})]}),f?C.jsxs("div",{className:"flex items-center gap-2 text-slate-500 py-12",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsx(Os,{className:"w-5 h-5 animate-spin"}),"Loading projects"]}):C.jsx("div",{className:"flex flex-col gap-2",children:y.map(k=>C.jsx(_C,{project:k,onOpen:O=>r(`/project/${O}`)},k.id))}),!f&&y.length===0&&l&&C.jsxs("div",{className:"text-center py-12 text-slate-500 text-sm",style:{fontFamily:"'DM Sans', sans-serif"},children:['No projects match "',l,'"']}),!f&&p.length===0&&C.jsxs("div",{className:"text-center py-16 text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsx("svg",{width:"48",height:"48",viewBox:"0 0 24 24",fill:"none",stroke:"#cbd5e1",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round",className:"mx-auto mb-4",children:C.jsx("path",{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"})}),C.jsx("div",{className:"text-base font-medium text-slate-600 mb-1.5",children:"No projects yet"}),C.jsx("div",{className:"text-sm text-slate-500",children:"Create a project to start organising your deal documents."})]})]}),i&&C.jsx(CC,{onClose:()=>a(!1),onCreate:E,isPending:A.isPending,defaultColorIndex:p.length%ba.length})]})}var Fh={exports:{}},RC=Fh.exports,Y0;function MC(){return Y0||(Y0=1,(function(r,t){((e,i)=>{r.exports=i()})(RC,function(){var e=function(m,v){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(w,_){w.__proto__=_}:function(w,_){for(var M in _)Object.prototype.hasOwnProperty.call(_,M)&&(w[M]=_[M])}))(m,v)},i=function(){return(i=Object.assign||function(m){for(var v,w=1,_=arguments.length;w<_;w++)for(var M in v=arguments[w])Object.prototype.hasOwnProperty.call(v,M)&&(m[M]=v[M]);return m}).apply(this,arguments)};function a(m,v,w){for(var _,M=0,N=v.length;M<N;M++)!_&&M in v||((_=_||Array.prototype.slice.call(v,0,M))[M]=v[M]);return m.concat(_||Array.prototype.slice.call(v))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:N1,c=Object.keys,u=Array.isArray;function d(m,v){return typeof v=="object"&&c(v).forEach(function(w){m[w]=v[w]}),m}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var f=Object.getPrototypeOf,p={}.hasOwnProperty;function y(m,v){return p.call(m,v)}function x(m,v){typeof v=="function"&&(v=v(f(m))),(typeof Reflect>"u"?c:Reflect.ownKeys)(v).forEach(function(w){A(m,w,v[w])})}var S=Object.defineProperty;function A(m,v,w,_){S(m,v,d(w&&y(w,"get")&&typeof w.get=="function"?{get:w.get,set:w.set,configurable:!0}:{value:w,configurable:!0,writable:!0},_))}function E(m){return{from:function(v){return m.prototype=Object.create(v.prototype),A(m.prototype,"constructor",m),{extend:x.bind(null,m.prototype)}}}}var R=Object.getOwnPropertyDescriptor,D=[].slice;function k(m,v,w){return D.call(m,v,w)}function O(m,v){return v(m)}function I(m){if(!m)throw new Error("Assertion Failed")}function z(m){l.setImmediate?setImmediate(m):setTimeout(m,0)}function H(m,v){if(typeof v=="string"&&y(m,v))return m[v];if(!v)return m;if(typeof v!="string"){for(var w=[],_=0,M=v.length;_<M;++_){var N=H(m,v[_]);w.push(N)}return w}var j,B=v.indexOf(".");return B===-1||(j=m[v.substr(0,B)])==null?void 0:H(j,v.substr(B+1))}function P(m,v,w){if(m&&v!==void 0&&!("isFrozen"in Object&&Object.isFrozen(m)))if(typeof v!="string"&&"length"in v){I(typeof w!="string"&&"length"in w);for(var _=0,M=v.length;_<M;++_)P(m,v[_],w[_])}else{var N,j,B=v.indexOf(".");B!==-1?(N=v.substr(0,B),(B=v.substr(B+1))===""?w===void 0?u(m)&&!isNaN(parseInt(N))?m.splice(N,1):delete m[N]:m[N]=w:P(j=(j=m[N])&&y(m,N)?j:m[N]={},B,w)):w===void 0?u(m)&&!isNaN(parseInt(v))?m.splice(v,1):delete m[v]:m[v]=w}}function rt(m){var v,w={};for(v in m)y(m,v)&&(w[v]=m[v]);return w}var ut=[].concat;function St(m){return ut.apply([],m)}var J="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(St([8,16,32,64].map(function(m){return["Int","Uint","Float"].map(function(v){return v+m+"Array"})}))).filter(function(m){return l[m]}),_t=new Set(J.map(function(m){return l[m]})),Mt=null;function Vt(m){return Mt=new WeakMap,m=(function v(w){if(!w||typeof w!="object")return w;var _=Mt.get(w);if(_)return _;if(u(w)){_=[],Mt.set(w,_);for(var M=0,N=w.length;M<N;++M)_.push(v(w[M]))}else if(_t.has(w.constructor))_=w;else{var j,B=f(w);for(j in _=B===Object.prototype?{}:Object.create(B),Mt.set(w,_),w)y(w,j)&&(_[j]=v(w[j]))}return _})(m),Mt=null,m}var vt={}.toString;function Ht(m){return vt.call(m).slice(8,-1)}var G=typeof Symbol<"u"?Symbol.iterator:"@@iterator",ct=typeof G=="symbol"?function(m){var v;return m!=null&&(v=m[G])&&v.apply(m)}:function(){return null};function yt(m,v){v=m.indexOf(v),0<=v&&m.splice(v,1)}var Tt={};function Pt(m){var v,w,_,M;if(arguments.length===1){if(u(m))return m.slice();if(this===Tt&&typeof m=="string")return[m];if(M=ct(m))for(w=[];!(_=M.next()).done;)w.push(_.value);else{if(m==null)return[m];if(typeof(v=m.length)!="number")return[m];for(w=new Array(v);v--;)w[v]=m[v]}}else for(v=arguments.length,w=new Array(v);v--;)w[v]=arguments[v];return w}var F=typeof Symbol<"u"?function(m){return m[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},J=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Vn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(J),ht={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function xt(m,v){this.name=m,this.message=v}function Dt(m,v){return m+". Errors: "+Object.keys(v).map(function(w){return v[w].toString()}).filter(function(w,_,M){return M.indexOf(w)===_}).join(`
`)}function qt(m,v,w,_){this.failures=v,this.failedKeys=_,this.successCount=w,this.message=Dt(m,v)}function Bt(m,v){this.name="BulkError",this.failures=Object.keys(v).map(function(w){return v[w]}),this.failuresByPos=v,this.message=Dt(m,this.failures)}E(xt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),E(qt).from(xt),E(Bt).from(xt);var he=Vn.reduce(function(m,v){return m[v]=v+"Error",m},{}),de=xt,Rt=Vn.reduce(function(m,v){var w=v+"Error";function _(M,N){this.name=w,M?typeof M=="string"?(this.message="".concat(M).concat(N?`
 `+N:""),this.inner=N||null):typeof M=="object"&&(this.message="".concat(M.name," ").concat(M.message),this.inner=M):(this.message=ht[v]||w,this.inner=null)}return E(_).from(de),m[v]=_,m},{}),pe=(Rt.Syntax=SyntaxError,Rt.Type=TypeError,Rt.Range=RangeError,J.reduce(function(m,v){return m[v+"Error"]=Rt[v],m},{}));J=Vn.reduce(function(m,v){return["Syntax","Type","Range"].indexOf(v)===-1&&(m[v+"Error"]=Rt[v]),m},{});function Xt(){}function Ce(m){return m}function On(m,v){return m==null||m===Ce?v:function(w){return v(m(w))}}function Nt(m,v){return function(){m.apply(this,arguments),v.apply(this,arguments)}}function Se(m,v){return m===Xt?v:function(){var w=m.apply(this,arguments),_=(w!==void 0&&(arguments[0]=w),this.onsuccess),M=this.onerror,N=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return _&&(this.onsuccess=this.onsuccess?Nt(_,this.onsuccess):_),M&&(this.onerror=this.onerror?Nt(M,this.onerror):M),N!==void 0?N:w}}function Bs(m,v){return m===Xt?v:function(){m.apply(this,arguments);var w=this.onsuccess,_=this.onerror;this.onsuccess=this.onerror=null,v.apply(this,arguments),w&&(this.onsuccess=this.onsuccess?Nt(w,this.onsuccess):w),_&&(this.onerror=this.onerror?Nt(_,this.onerror):_)}}function Ct(m,v){return m===Xt?v:function(M){var _=m.apply(this,arguments),M=(d(M,_),this.onsuccess),N=this.onerror,j=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return M&&(this.onsuccess=this.onsuccess?Nt(M,this.onsuccess):M),N&&(this.onerror=this.onerror?Nt(N,this.onerror):N),_===void 0?j===void 0?void 0:j:d(_,j)}}function ne(m,v){return m===Xt?v:function(){return v.apply(this,arguments)!==!1&&m.apply(this,arguments)}}function Te(m,v){return m===Xt?v:function(){var w=m.apply(this,arguments);if(w&&typeof w.then=="function"){for(var _=this,M=arguments.length,N=new Array(M);M--;)N[M]=arguments[M];return w.then(function(){return v.apply(_,N)})}return v.apply(this,arguments)}}J.ModifyError=qt,J.DexieError=xt,J.BulkError=Bt;var Fe=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function ai(m){Fe=m}var Yi={},Kn=100,dr=typeof Promise>"u"?[]:(Vn=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[dr=crypto.subtle.digest("SHA-512",new Uint8Array([0])),f(dr),Vn]:[Vn,f(Vn),Vn]),Vn=dr[0],Ws=dr[1],Ws=Ws&&Ws.then,os=Vn&&Vn.constructor,Aa=!!dr[2],fr=function(m,v){pr.push([m,v]),lo&&(queueMicrotask(au),lo=!1)},oo=!0,lo=!0,Fs=[],ls=[],Ln=Ce,jn={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:Xt,pgp:!1,env:{},finalize:Xt},Ft=jn,pr=[],Is=0,co=[];function Lt(m){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var v=this._PSD=Ft;if(typeof m!="function"){if(m!==Yi)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Qi(this,this._value)}else this._state=null,this._value=null,++v.ref,(function w(_,M){try{M(function(N){if(_._state===null){if(N===_)throw new TypeError("A promise cannot be resolved with itself.");var j=_._lib&&cs();N&&typeof N.then=="function"?w(_,function(B,V){N instanceof Lt?N._then(B,V):N.then(B,V)}):(_._state=!0,_._value=N,gr(_)),j&&Ni()}},Qi.bind(null,_))}catch(N){Qi(_,N)}})(this,m)}var Ea={get:function(){var m=Ft,v=vr;function w(_,M){var N=this,j=!m.global&&(m!==Ft||v!==vr),B=j&&!Jn(),V=new Lt(function(et,$){Us(N,new mr(uo(_,m,j,B),uo(M,m,j,B),et,$,m))});return this._consoleTask&&(V._consoleTask=this._consoleTask),V}return w.prototype=Yi,w},set:function(m){A(this,"then",m&&m.prototype===Yi?Ea:{get:function(){return m},set:Ea.set})}};function mr(m,v,w,_,M){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof v=="function"?v:null,this.resolve=w,this.reject=_,this.psd=M}function Qi(m,v){var w,_;ls.push(v),m._state===null&&(w=m._lib&&cs(),v=Ln(v),m._state=!1,m._value=v,_=m,Fs.some(function(M){return M._value===_._value})||Fs.push(_),gr(m),w)&&Ni()}function gr(m){var v=m._listeners;m._listeners=[];for(var w=0,_=v.length;w<_;++w)Us(m,v[w]);var M=m._PSD;--M.ref||M.finalize(),Is===0&&(++Is,fr(function(){--Is==0&&Al()},[]))}function Us(m,v){if(m._state===null)m._listeners.push(v);else{var w=m._state?v.onFulfilled:v.onRejected;if(w===null)return(m._state?v.resolve:v.reject)(m._value);++v.psd.ref,++Is,fr(xd,[w,m,v])}}function xd(m,v,w){try{var _,M=v._value;!v._state&&ls.length&&(ls=[]),_=Fe&&v._consoleTask?v._consoleTask.run(function(){return m(M)}):m(M),v._state||ls.indexOf(M)!==-1||(N=>{for(var j=Fs.length;j;)if(Fs[--j]._value===N._value)return Fs.splice(j,1)})(v),w.resolve(_)}catch(N){w.reject(N)}finally{--Is==0&&Al(),--w.psd.ref||w.psd.finalize()}}function au(){yi(jn,function(){cs()&&Ni()})}function cs(){var m=oo;return lo=oo=!1,m}function Ni(){var m,v,w;do for(;0<pr.length;)for(m=pr,pr=[],w=m.length,v=0;v<w;++v){var _=m[v];_[0].apply(null,_[1])}while(0<pr.length);lo=oo=!0}function Al(){for(var m=Fs,v=(Fs=[],m.forEach(function(_){_._PSD.onunhandled.call(null,_._value,_)}),co.slice(0)),w=v.length;w;)v[--w]()}function yr(m){return new Lt(Yi,!1,m)}function Ke(m,v){var w=Ft;return function(){var _=cs(),M=Ft;try{return hs(w,!0),m.apply(this,arguments)}catch(N){v&&v(N)}finally{hs(M,!1),_&&Ni()}}}x(Lt.prototype,{then:Ea,_then:function(m,v){Us(this,new mr(null,null,m,v,Ft))},catch:function(m){var v,w;return arguments.length===1?this.then(null,m):(v=m,w=arguments[1],typeof v=="function"?this.then(null,function(_){return(_ instanceof v?w:yr)(_)}):this.then(null,function(_){return(_&&_.name===v?w:yr)(_)}))},finally:function(m){return this.then(function(v){return Lt.resolve(m()).then(function(){return v})},function(v){return Lt.resolve(m()).then(function(){return yr(v)})})},timeout:function(m,v){var w=this;return m<1/0?new Lt(function(_,M){var N=setTimeout(function(){return M(new Rt.Timeout(v))},m);w.then(_,M).finally(clearTimeout.bind(null,N))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&A(Lt.prototype,Symbol.toStringTag,"Dexie.Promise"),jn.env=_l(),x(Lt,{all:function(){var m=Pt.apply(null,arguments).map(Ca);return new Lt(function(v,w){m.length===0&&v([]);var _=m.length;m.forEach(function(M,N){return Lt.resolve(M).then(function(j){m[N]=j,--_||v(m)},w)})})},resolve:function(m){return m instanceof Lt?m:m&&typeof m.then=="function"?new Lt(function(v,w){m.then(v,w)}):new Lt(Yi,!0,m)},reject:yr,race:function(){var m=Pt.apply(null,arguments).map(Ca);return new Lt(function(v,w){m.map(function(_){return Lt.resolve(_).then(v,w)})})},PSD:{get:function(){return Ft},set:function(m){return Ft=m}},totalEchoes:{get:function(){return vr}},newPSD:$e,usePSD:yi,scheduler:{get:function(){return fr},set:function(m){fr=m}},rejectionMapper:{get:function(){return Ln},set:function(m){Ln=m}},follow:function(m,v){return new Lt(function(w,_){return $e(function(M,N){var j=Ft;j.unhandleds=[],j.onunhandled=N,j.finalize=Nt(function(){var B,V=this;B=function(){V.unhandleds.length===0?M():N(V.unhandleds[0])},co.push(function et(){B(),co.splice(co.indexOf(et),1)}),++Is,fr(function(){--Is==0&&Al()},[])},j.finalize),m()},v,w,_)})}}),os&&(os.allSettled&&A(Lt,"allSettled",function(){var m=Pt.apply(null,arguments).map(Ca);return new Lt(function(v){m.length===0&&v([]);var w=m.length,_=new Array(w);m.forEach(function(M,N){return Lt.resolve(M).then(function(j){return _[N]={status:"fulfilled",value:j}},function(j){return _[N]={status:"rejected",reason:j}}).then(function(){return--w||v(_)})})})}),os.any&&typeof AggregateError<"u"&&A(Lt,"any",function(){var m=Pt.apply(null,arguments).map(Ca);return new Lt(function(v,w){m.length===0&&w(new AggregateError([]));var _=m.length,M=new Array(_);m.forEach(function(N,j){return Lt.resolve(N).then(function(B){return v(B)},function(B){M[j]=B,--_||w(new AggregateError(M))})})})}),os.withResolvers)&&(Lt.withResolvers=os.withResolvers);var cn={awaits:0,echoes:0,id:0},El=0,_a=[],br=0,vr=0,us=0;function $e(m,j,w,_){var M=Ft,N=Object.create(M),j=(N.parent=M,N.ref=0,N.global=!1,N.id=++us,jn.env,N.env=Aa?{Promise:Lt,PromiseProp:{value:Lt,configurable:!0,writable:!0},all:Lt.all,race:Lt.race,allSettled:Lt.allSettled,any:Lt.any,resolve:Lt.resolve,reject:Lt.reject}:{},j&&d(N,j),++M.ref,N.finalize=function(){--this.parent.ref||this.parent.finalize()},yi(N,m,w,_));return N.ref===0&&N.finalize(),j}function un(){return cn.id||(cn.id=++El),++cn.awaits,cn.echoes+=Kn,cn.id}function Jn(){return!!cn.awaits&&(--cn.awaits==0&&(cn.id=0),cn.echoes=cn.awaits*Kn,!0)}function Ca(m){return cn.echoes&&m&&m.constructor===os?(un(),m.then(function(v){return Jn(),v},function(v){return Jn(),Ie(v)})):m}function wd(){var m=_a[_a.length-1];_a.pop(),hs(m,!1)}function hs(m,v){var w,_,M=Ft;(v?!cn.echoes||br++&&m===Ft:!br||--br&&m===Ft)||queueMicrotask(v?(function(N){++vr,cn.echoes&&--cn.echoes!=0||(cn.echoes=cn.awaits=cn.id=0),_a.push(Ft),hs(N,!0)}).bind(null,m):wd),m!==Ft&&(Ft=m,M===jn&&(jn.env=_l()),Aa)&&(w=jn.env.Promise,_=m.env,M.global||m.global)&&(Object.defineProperty(l,"Promise",_.PromiseProp),w.all=_.all,w.race=_.race,w.resolve=_.resolve,w.reject=_.reject,_.allSettled&&(w.allSettled=_.allSettled),_.any)&&(w.any=_.any)}function _l(){var m=l.Promise;return Aa?{Promise:m,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:m.all,race:m.race,allSettled:m.allSettled,any:m.any,resolve:m.resolve,reject:m.reject}:{}}function yi(m,v,w,_,M){var N=Ft;try{return hs(m,!0),v(w,_,M)}finally{hs(N,!1)}}function uo(m,v,w,_){return typeof m!="function"?m:function(){var M=Ft;w&&un(),hs(v,!0);try{return m.apply(this,arguments)}finally{hs(M,!1),_&&queueMicrotask(Jn)}}}function ds(m){Promise===os&&cn.echoes===0?br===0?m():enqueueNativeMicroTask(m):setTimeout(m,0)}(""+Ws).indexOf("[native code]")===-1&&(un=Jn=Xt);var Ie=Lt.reject,bi="",$n="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",hn="String expected.",zs=[],xr="__dbnames",Wi="readonly",fs="readwrite";function Hs(m,v){return m?v?function(){return m.apply(this,arguments)&&v.apply(this,arguments)}:m:v}var Cl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function wr(m){return typeof m!="string"||/\./.test(m)?function(v){return v}:function(v){return v[m]===void 0&&m in v&&delete(v=Vt(v))[m],v}}function ru(){throw Rt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ue(m,v){try{var w=Sr(m),_=Sr(v);if(w!==_)return w==="Array"?1:_==="Array"?-1:w==="binary"?1:_==="binary"?-1:w==="string"?1:_==="string"?-1:w==="Date"?1:_!=="Date"?NaN:-1;switch(w){case"number":case"Date":case"string":return v<m?1:m<v?-1:0;case"binary":for(var M=ki(m),N=ki(v),j=M.length,B=N.length,V=j<B?j:B,et=0;et<V;++et)if(M[et]!==N[et])return M[et]<N[et]?-1:1;return j===B?0:j<B?-1:1;case"Array":for(var $=m,K=v,Q=$.length,Z=K.length,X=Q<Z?Q:Z,Y=0;Y<X;++Y){var it=ue($[Y],K[Y]);if(it!==0)return it}return Q===Z?0:Q<Z?-1:1}}catch{}return NaN}function Sr(m){var v=typeof m;return v=="object"&&(ArrayBuffer.isView(m)||(v=Ht(m))==="ArrayBuffer")?"binary":v}function ki(m){return m instanceof Uint8Array?m:ArrayBuffer.isView(m)?new Uint8Array(m.buffer,m.byteOffset,m.byteLength):new Uint8Array(m)}function Pn(m,v,w){var _=m.schema.yProps;return _?(v&&0<w.numFailures&&(v=v.filter(function(M,N){return!w.failures[N]})),Promise.all(_.map(function(M){return M=M.updatesTable,v?m.db.table(M).where("k").anyOf(v).delete():m.db.table(M).clear()})).then(function(){return w})):w}ou.prototype.execute=function(m){var v=this["@@propmod"];if(v.add!==void 0){var w=v.add;if(u(w))return a(a([],u(m)?m:[],!0),w).sort();if(typeof w=="number")return(Number(m)||0)+w;if(typeof w=="bigint")try{return BigInt(m)+w}catch{return BigInt(0)+w}throw new TypeError("Invalid term ".concat(w))}if(v.remove!==void 0){var _=v.remove;if(u(_))return u(m)?m.filter(function(M){return!_.includes(M)}).sort():[];if(typeof _=="number")return Number(m)-_;if(typeof _=="bigint")try{return BigInt(m)-_}catch{return BigInt(0)-_}throw new TypeError("Invalid subtrahend ".concat(_))}return w=(w=v.replacePrefix)==null?void 0:w[0],w&&typeof m=="string"&&m.startsWith(w)?v.replacePrefix[1]+m.substring(w.length):m};var Ta=ou;function ou(m){this["@@propmod"]=m}function ho(m,v){for(var w=c(v),_=w.length,M=!1,N=0;N<_;++N){var j=w[N],B=v[j],V=H(m,j);B instanceof Ta?(P(m,j,B.execute(V)),M=!0):V!==B&&(P(m,j,B),M=!0)}return M}Re.prototype._trans=function(m,v,w){var _=this._tx||Ft.trans,M=this.name,N=Fe&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(m==="readonly"?"read":"write"," ").concat(this.name));function j(et,$,K){if(K.schema[M])return v(K.idbtrans,K);throw new Rt.NotFound("Table "+M+" not part of transaction")}var B=cs();try{var V=_&&_.db._novip===this.db._novip?_===Ft.trans?_._promise(m,j,w):$e(function(){return _._promise(m,j,w)},{trans:_,transless:Ft.transless||Ft}):(function et($,K,Q,Z){if($.idbdb&&($._state.openComplete||Ft.letThrough||$._vip)){var X=$._createTransaction(K,Q,$._dbSchema);try{X.create(),$._state.PR1398_maxLoop=3}catch(Y){return Y.name===he.InvalidState&&$.isOpen()&&0<--$._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$.close({disableAutoOpen:!1}),$.open().then(function(){return et($,K,Q,Z)})):Ie(Y)}return X._promise(K,function(Y,it){return $e(function(){return Ft.trans=X,Z(Y,it,X)})}).then(function(Y){if(K==="readwrite")try{X.idbtrans.commit()}catch{}return K==="readonly"?Y:X._completion.then(function(){return Y})})}if($._state.openComplete)return Ie(new Rt.DatabaseClosed($._state.dbOpenError));if(!$._state.isBeingOpened){if(!$._state.autoOpen)return Ie(new Rt.DatabaseClosed);$.open().catch(Xt)}return $._state.dbReadyPromise.then(function(){return et($,K,Q,Z)})})(this.db,m,[this.name],j);return N&&(V._consoleTask=N,V=V.catch(function(et){return console.trace(et),Ie(et)})),V}finally{B&&Ni()}},Re.prototype.get=function(m,v){var w=this;return m&&m.constructor===Object?this.where(m).first(v):m==null?Ie(new Rt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(_){return w.core.get({trans:_,key:m}).then(function(M){return w.hook.reading.fire(M)})}).then(v)},Re.prototype.where=function(m){if(typeof m=="string")return new this.db.WhereClause(this,m);if(u(m))return new this.db.WhereClause(this,"[".concat(m.join("+"),"]"));var v=c(m);if(v.length===1)return this.where(v[0]).equals(m[v[0]]);var w=this.schema.indexes.concat(this.schema.primKey).filter(function(B){if(B.compound&&v.every(function(et){return 0<=B.keyPath.indexOf(et)})){for(var V=0;V<v.length;++V)if(v.indexOf(B.keyPath[V])===-1)return!1;return!0}return!1}).sort(function(B,V){return B.keyPath.length-V.keyPath.length})[0];if(w&&this.db._maxKey!==bi)return j=w.keyPath.slice(0,v.length),this.where(j).equals(j.map(function(B){return m[B]}));!w&&Fe&&console.warn("The query ".concat(JSON.stringify(m)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(v.join("+"),"]"));var _=this.schema.idxByName;function M(B,V){return ue(B,V)===0}var j=v.reduce(function($,V){var et=$[0],$=$[1],K=_[V],Q=m[V];return[et||K,et||!K?Hs($,K&&K.multi?function(Z){return Z=H(Z,V),u(Z)&&Z.some(function(X){return M(Q,X)})}:function(Z){return M(Q,H(Z,V))}):$]},[null,null]),N=j[0],j=j[1];return N?this.where(N.name).equals(m[N.keyPath]).filter(j):w?this.filter(j):this.where(v).equals("")},Re.prototype.filter=function(m){return this.toCollection().and(m)},Re.prototype.count=function(m){return this.toCollection().count(m)},Re.prototype.offset=function(m){return this.toCollection().offset(m)},Re.prototype.limit=function(m){return this.toCollection().limit(m)},Re.prototype.each=function(m){return this.toCollection().each(m)},Re.prototype.toArray=function(m){return this.toCollection().toArray(m)},Re.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Re.prototype.orderBy=function(m){return new this.db.Collection(new this.db.WhereClause(this,u(m)?"[".concat(m.join("+"),"]"):m))},Re.prototype.reverse=function(){return this.toCollection().reverse()},Re.prototype.mapToClass=function(m){for(var v=this.db,w=this.name,_=((this.schema.mappedClass=m).prototype instanceof ru&&(m=(j=>{var B=$,V=j;if(typeof V!="function"&&V!==null)throw new TypeError("Class extends value "+String(V)+" is not a constructor or null");function et(){this.constructor=B}function $(){return j!==null&&j.apply(this,arguments)||this}return e(B,V),B.prototype=V===null?Object.create(V):(et.prototype=V.prototype,new et),Object.defineProperty($.prototype,"db",{get:function(){return v},enumerable:!1,configurable:!0}),$.prototype.table=function(){return w},$})(m)),new Set),M=m.prototype;M;M=f(M))Object.getOwnPropertyNames(M).forEach(function(j){return _.add(j)});function N(j){if(!j)return j;var B,V=Object.create(m.prototype);for(B in j)if(!_.has(B))try{V[B]=j[B]}catch{}return V}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=N,this.hook("reading",N),m},Re.prototype.defineClass=function(){return this.mapToClass(function(m){d(this,m)})},Re.prototype.add=function(m,v){var w=this,_=this.schema.primKey,M=_.auto,N=_.keyPath,j=m;return N&&M&&(j=wr(N)(m)),this._trans("readwrite",function(B){return w.core.mutate({trans:B,type:"add",keys:v!=null?[v]:null,values:[j]})}).then(function(B){return B.numFailures?Lt.reject(B.failures[0]):B.lastResult}).then(function(B){if(N)try{P(m,N,B)}catch{}return B})},Re.prototype.upsert=function(m,v){var w=this,_=this.schema.primKey.keyPath;return this._trans("readwrite",function(M){return w.core.get({trans:M,key:m}).then(function(N){var j=N??{};return ho(j,v),_&&P(j,_,m),w.core.mutate({trans:M,type:"put",values:[j],keys:[m],upsert:!0,updates:{keys:[m],changeSpecs:[v]}}).then(function(B){return B.numFailures?Lt.reject(B.failures[0]):!!N})})})},Re.prototype.update=function(m,v){return typeof m!="object"||u(m)?this.where(":id").equals(m).modify(v):(m=H(m,this.schema.primKey.keyPath))===void 0?Ie(new Rt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(m).modify(v)},Re.prototype.put=function(m,v){var w=this,_=this.schema.primKey,M=_.auto,N=_.keyPath,j=m;return N&&M&&(j=wr(N)(m)),this._trans("readwrite",function(B){return w.core.mutate({trans:B,type:"put",values:[j],keys:v!=null?[v]:null})}).then(function(B){return B.numFailures?Lt.reject(B.failures[0]):B.lastResult}).then(function(B){if(N)try{P(m,N,B)}catch{}return B})},Re.prototype.delete=function(m){var v=this;return this._trans("readwrite",function(w){return v.core.mutate({trans:w,type:"delete",keys:[m]}).then(function(_){return Pn(v,[m],_)}).then(function(_){return _.numFailures?Lt.reject(_.failures[0]):void 0})})},Re.prototype.clear=function(){var m=this;return this._trans("readwrite",function(v){return m.core.mutate({trans:v,type:"deleteRange",range:Cl}).then(function(w){return Pn(m,null,w)})}).then(function(v){return v.numFailures?Lt.reject(v.failures[0]):void 0})},Re.prototype.bulkGet=function(m){var v=this;return this._trans("readonly",function(w){return v.core.getMany({keys:m,trans:w}).then(function(_){return _.map(function(M){return v.hook.reading.fire(M)})})})},Re.prototype.bulkAdd=function(m,v,w){var _=this,M=Array.isArray(v)?v:void 0,N=(w=w||(M?void 0:v))?w.allKeys:void 0;return this._trans("readwrite",function(j){var B=_.schema.primKey,et=B.auto,B=B.keyPath;if(B&&M)throw new Rt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(M&&M.length!==m.length)throw new Rt.InvalidArgument("Arguments objects and keys must have the same length");var V=m.length,et=B&&et?m.map(wr(B)):m;return _.core.mutate({trans:j,type:"add",keys:M,values:et,wantResults:N}).then(function($){var K=$.numFailures,Q=$.failures;if(K===0)return N?$.results:$.lastResult;throw new Bt("".concat(_.name,".bulkAdd(): ").concat(K," of ").concat(V," operations failed"),Q)})})},Re.prototype.bulkPut=function(m,v,w){var _=this,M=Array.isArray(v)?v:void 0,N=(w=w||(M?void 0:v))?w.allKeys:void 0;return this._trans("readwrite",function(j){var B=_.schema.primKey,et=B.auto,B=B.keyPath;if(B&&M)throw new Rt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(M&&M.length!==m.length)throw new Rt.InvalidArgument("Arguments objects and keys must have the same length");var V=m.length,et=B&&et?m.map(wr(B)):m;return _.core.mutate({trans:j,type:"put",keys:M,values:et,wantResults:N}).then(function($){var K=$.numFailures,Q=$.failures;if(K===0)return N?$.results:$.lastResult;throw new Bt("".concat(_.name,".bulkPut(): ").concat(K," of ").concat(V," operations failed"),Q)})})},Re.prototype.bulkUpdate=function(m){var v=this,w=this.core,_=m.map(function(j){return j.key}),M=m.map(function(j){return j.changes}),N=[];return this._trans("readwrite",function(j){return w.getMany({trans:j,keys:_,cache:"clone"}).then(function(B){var V=[],et=[],$=(m.forEach(function(K,Q){var Z=K.key,X=K.changes,Y=B[Q];if(Y){for(var it=0,ot=Object.keys(X);it<ot.length;it++){var nt=ot[it],pt=X[nt];if(nt===v.schema.primKey.keyPath){if(ue(pt,Z)!==0)throw new Rt.Constraint("Cannot update primary key in bulkUpdate()")}else P(Y,nt,pt)}N.push(Q),V.push(Z),et.push(Y)}}),V.length);return w.mutate({trans:j,type:"put",keys:V,values:et,updates:{keys:_,changeSpecs:M}}).then(function(K){var Q=K.numFailures,Z=K.failures;if(Q===0)return $;for(var X=0,Y=Object.keys(Z);X<Y.length;X++){var it,ot=Y[X],nt=N[Number(ot)];nt!=null&&(it=Z[ot],delete Z[ot],Z[nt]=it)}throw new Bt("".concat(v.name,".bulkUpdate(): ").concat(Q," of ").concat($," operations failed"),Z)})})})},Re.prototype.bulkDelete=function(m){var v=this,w=m.length;return this._trans("readwrite",function(_){return v.core.mutate({trans:_,type:"delete",keys:m}).then(function(M){return Pn(v,m,M)})}).then(function(_){var M=_.numFailures,N=_.failures;if(M===0)return _.lastResult;throw new Bt("".concat(v.name,".bulkDelete(): ").concat(M," of ").concat(w," operations failed"),N)})};var Tl=Re;function Re(){}function Ar(m){function v(j,B){if(B){for(var V=arguments.length,et=new Array(V-1);--V;)et[V-1]=arguments[V];return w[j].subscribe.apply(null,et),m}if(typeof j=="string")return w[j]}var w={};v.addEventType=N;for(var _=1,M=arguments.length;_<M;++_)N(arguments[_]);return v;function N(j,B,V){var et,$;if(typeof j!="object")return B=B||ne,$={subscribers:[],fire:V=V||Xt,subscribe:function(K){$.subscribers.indexOf(K)===-1&&($.subscribers.push(K),$.fire=B($.fire,K))},unsubscribe:function(K){$.subscribers=$.subscribers.filter(function(Q){return Q!==K}),$.fire=$.subscribers.reduce(B,V)}},w[j]=v[j]=$;c(et=j).forEach(function(K){var Q=et[K];if(u(Q))N(K,et[K][0],et[K][1]);else{if(Q!=="asap")throw new Rt.InvalidArgument("Invalid event config");var Z=N(K,Ce,function(){for(var X=arguments.length,Y=new Array(X);X--;)Y[X]=arguments[X];Z.subscribers.forEach(function(it){z(function(){it.apply(null,Y)})})})}})}}function Tn(m,v){return E(v).from({prototype:m}),v}function ps(m,v){return!(m.filter||m.algorithm||m.or)&&(v?m.justLimit:!m.replayFilter)}function fo(m,v){m.filter=Hs(m.filter,v)}function Er(m,v,w){var _=m.replayFilter;m.replayFilter=_?function(){return Hs(_(),v())}:v,m.justLimit=w&&!_}function Zi(m,v){if(m.isPrimKey)return v.primaryKey;var w=v.getIndexByKeyPath(m.index);if(w)return w;throw new Rt.Schema("KeyPath "+m.index+" on object store "+v.name+" is not indexed")}function Rl(m,v,w){var _=Zi(m,v.schema);return v.openCursor({trans:w,values:!m.keysOnly,reverse:m.dir==="prev",unique:!!m.unique,query:{index:_,range:m.range}})}function _r(m,v,w,_){var M,N,j=m.replayFilter?Hs(m.filter,m.replayFilter()):m.filter;return m.or?(M={},N=function(B,V,et){var $,K;j&&!j(V,et,function(Q){return V.stop(Q)},function(Q){return V.fail(Q)})||((K=""+($=V.primaryKey))=="[object ArrayBuffer]"&&(K=""+new Uint8Array($)),y(M,K))||(M[K]=!0,v(B,V,et))},Promise.all([m.or._iterate(N,w),qs(Rl(m,_,w),m.algorithm,N,!m.keysOnly&&m.valueMapper)])):qs(Rl(m,_,w),Hs(m.algorithm,j),v,!m.keysOnly&&m.valueMapper)}function qs(m,v,w,_){var M=Ke(_?function(N,j,B){return w(_(N),j,B)}:w);return m.then(function(N){if(N)return N.start(function(){var j=function(){return N.continue()};v&&!v(N,function(B){return j=B},function(B){N.stop(B),j=Xt},function(B){N.fail(B),j=Xt})||M(N.value,N,function(B){return j=B}),j()})})}ve.prototype._read=function(m,v){var w=this._ctx;return w.error?w.table._trans(null,Ie.bind(null,w.error)):w.table._trans("readonly",m).then(v)},ve.prototype._write=function(m){var v=this._ctx;return v.error?v.table._trans(null,Ie.bind(null,v.error)):v.table._trans("readwrite",m,"locked")},ve.prototype._addAlgorithm=function(m){var v=this._ctx;v.algorithm=Hs(v.algorithm,m)},ve.prototype._iterate=function(m,v){return _r(this._ctx,m,v,this._ctx.table.core)},ve.prototype.clone=function(m){var v=Object.create(this.constructor.prototype),w=Object.create(this._ctx);return m&&d(w,m),v._ctx=w,v},ve.prototype.raw=function(){return this._ctx.valueMapper=null,this},ve.prototype.each=function(m){var v=this._ctx;return this._read(function(w){return _r(v,m,w,v.table.core)})},ve.prototype.count=function(m){var v=this;return this._read(function(w){var _,M=v._ctx,N=M.table.core;return ps(M,!0)?N.count({trans:w,query:{index:Zi(M,N.schema),range:M.range}}).then(function(j){return Math.min(j,M.limit)}):(_=0,_r(M,function(){return++_,!1},w,N).then(function(){return _}))}).then(m)},ve.prototype.sortBy=function(m,v){var w=m.split(".").reverse(),_=w[0],M=w.length-1;function N(V,et){return et?N(V[w[et]],et-1):V[_]}var j=this._ctx.dir==="next"?1:-1;function B(V,et){return ue(N(V,M),N(et,M))*j}return this.toArray(function(V){return V.sort(B)}).then(v)},ve.prototype.toArray=function(m){var v=this;return this._read(function(w){var _,M,N,j=v._ctx;return j.dir==="next"&&ps(j,!0)&&0<j.limit?(_=j.valueMapper,M=Zi(j,j.table.core.schema),j.table.core.query({trans:w,limit:j.limit,values:!0,query:{index:M,range:j.range}}).then(function(B){return B=B.result,_?B.map(_):B})):(N=[],_r(j,function(B){return N.push(B)},w,j.table.core).then(function(){return N}))},m)},ve.prototype.offset=function(m){var v=this._ctx;return m<=0||(v.offset+=m,ps(v)?Er(v,function(){var w=m;return function(_,M){return w===0||(w===1?--w:M(function(){_.advance(w),w=0}),!1)}}):Er(v,function(){var w=m;return function(){return--w<0}})),this},ve.prototype.limit=function(m){return this._ctx.limit=Math.min(this._ctx.limit,m),Er(this._ctx,function(){var v=m;return function(w,_,M){return--v<=0&&_(M),0<=v}},!0),this},ve.prototype.until=function(m,v){return fo(this._ctx,function(w,_,M){return!m(w.value)||(_(M),v)}),this},ve.prototype.first=function(m){return this.limit(1).toArray(function(v){return v[0]}).then(m)},ve.prototype.last=function(m){return this.reverse().first(m)},ve.prototype.filter=function(m){var v;return fo(this._ctx,function(w){return m(w.value)}),(v=this._ctx).isMatch=Hs(v.isMatch,m),this},ve.prototype.and=function(m){return this.filter(m)},ve.prototype.or=function(m){return new this.db.WhereClause(this._ctx.table,m,this)},ve.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ve.prototype.desc=function(){return this.reverse()},ve.prototype.eachKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(w,_){m(_.key,_)})},ve.prototype.eachUniqueKey=function(m){return this._ctx.unique="unique",this.eachKey(m)},ve.prototype.eachPrimaryKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(w,_){m(_.primaryKey,_)})},ve.prototype.keys=function(m){var v=this._ctx,w=(v.keysOnly=!v.isMatch,[]);return this.each(function(_,M){w.push(M.key)}).then(function(){return w}).then(m)},ve.prototype.primaryKeys=function(m){var v=this._ctx;if(v.dir==="next"&&ps(v,!0)&&0<v.limit)return this._read(function(_){var M=Zi(v,v.table.core.schema);return v.table.core.query({trans:_,values:!1,limit:v.limit,query:{index:M,range:v.range}})}).then(function(_){return _.result}).then(m);v.keysOnly=!v.isMatch;var w=[];return this.each(function(_,M){w.push(M.primaryKey)}).then(function(){return w}).then(m)},ve.prototype.uniqueKeys=function(m){return this._ctx.unique="unique",this.keys(m)},ve.prototype.firstKey=function(m){return this.limit(1).keys(function(v){return v[0]}).then(m)},ve.prototype.lastKey=function(m){return this.reverse().firstKey(m)},ve.prototype.distinct=function(){var m,v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];return v&&v.multi&&(m={},fo(this._ctx,function(_){var _=_.primaryKey.toString(),M=y(m,_);return m[_]=!0,!M})),this},ve.prototype.modify=function(m){var v=this,w=this._ctx;return this._write(function(_){function M(Y,it){var ot=it.failures;Q+=Y-it.numFailures;for(var nt=0,pt=c(ot);nt<pt.length;nt++){var wt=pt[nt];K.push(ot[wt])}}var N=typeof m=="function"?m:function(Y){return ho(Y,m)},j=w.table.core,$=j.schema.primaryKey,B=$.outbound,V=$.extractKey,et=200,$=v.db._options.modifyChunkSize,K=($&&(et=typeof $=="object"?$[j.name]||$["*"]||200:$),[]),Q=0,Z=[],X=m===Ml;return v.clone().primaryKeys().then(function(Y){function it(nt){var pt=Math.min(et,Y.length-nt),wt=Y.slice(nt,nt+pt);return(X?Promise.resolve([]):j.getMany({trans:_,keys:wt,cache:"immutable"})).then(function(kt){var Ot=[],At=[],It=B?[]:null,jt=X?wt:[];if(!X)for(var Et=0;Et<pt;++Et){var Ut=kt[Et],ee={value:Vt(Ut),primKey:Y[nt+Et]};N.call(ee,ee.value,ee)!==!1&&(ee.value==null?jt.push(Y[nt+Et]):B||ue(V(Ut),V(ee.value))===0?(At.push(ee.value),B&&It.push(Y[nt+Et])):(jt.push(Y[nt+Et]),Ot.push(ee.value)))}return Promise.resolve(0<Ot.length&&j.mutate({trans:_,type:"add",values:Ot}).then(function(fe){for(var Yt in fe.failures)jt.splice(parseInt(Yt),1);M(Ot.length,fe)})).then(function(){return(0<At.length||ot&&typeof m=="object")&&j.mutate({trans:_,type:"put",keys:It,values:At,criteria:ot,changeSpec:typeof m!="function"&&m,isAdditionalChunk:0<nt}).then(function(fe){return M(At.length,fe)})}).then(function(){return(0<jt.length||ot&&X)&&j.mutate({trans:_,type:"delete",keys:jt,criteria:ot,isAdditionalChunk:0<nt}).then(function(fe){return Pn(w.table,jt,fe)}).then(function(fe){return M(jt.length,fe)})}).then(function(){return Y.length>nt+pt&&it(nt+et)})})}var ot=ps(w)&&w.limit===1/0&&(typeof m!="function"||X)&&{index:w.index,range:w.range};return it(0).then(function(){if(0<K.length)throw new qt("Error modifying one or more objects",K,Q,Z);return Y.length})})})},ve.prototype.delete=function(){var m=this._ctx,v=m.range;return!ps(m)||m.table.schema.yProps||!m.isPrimKey&&v.type!==3?this.modify(Ml):this._write(function(w){var _=m.table.core.schema.primaryKey,M=v;return m.table.core.count({trans:w,query:{index:_,range:M}}).then(function(N){return m.table.core.mutate({trans:w,type:"deleteRange",range:M}).then(function(V){var B=V.failures,V=V.numFailures;if(V)throw new qt("Could not delete some values",Object.keys(B).map(function(et){return B[et]}),N-V);return N-V})})})};var Sd=ve;function ve(){}var Ml=function(m,v){return v.value=null};function Dl(m,v){return m<v?-1:m===v?0:1}function Ad(m,v){return v<m?-1:m===v?0:1}function ti(m,v,w){return m=m instanceof Gs?new m.Collection(m):m,m._ctx.error=new(w||TypeError)(v),m}function Ji(m){return new m.Collection(m,function(){return po("")}).limit(0)}function ri(Z,v,w,_){var M,N,j,B,V,et,$,K=w.length;if(!w.every(function(Y){return typeof Y=="string"}))return ti(Z,hn);function Q(Y){M=Y==="next"?function(ot){return ot.toUpperCase()}:function(ot){return ot.toLowerCase()},N=Y==="next"?function(ot){return ot.toLowerCase()}:function(ot){return ot.toUpperCase()},j=Y==="next"?Dl:Ad;var it=w.map(function(ot){return{lower:N(ot),upper:M(ot)}}).sort(function(ot,nt){return j(ot.lower,nt.lower)});B=it.map(function(ot){return ot.upper}),V=it.map(function(ot){return ot.lower}),$=(et=Y)==="next"?"":_}Q("next");var Z=new Z.Collection(Z,function(){return Oi(B[0],V[K-1]+_)}),X=(Z._ondirectionchange=function(Y){Q(Y)},0);return Z._addAlgorithm(function(Y,it,ot){var nt=Y.key;if(typeof nt=="string"){var pt=N(nt);if(v(pt,V,X))return!0;for(var wt=null,kt=X;kt<K;++kt){var Ot=((At,It,jt,Et,Ut,ee)=>{for(var fe=Math.min(At.length,Et.length),Yt=-1,ae=0;ae<fe;++ae){var Ue=It[ae];if(Ue!==Et[ae])return Ut(At[ae],jt[ae])<0?At.substr(0,ae)+jt[ae]+jt.substr(ae+1):Ut(At[ae],Et[ae])<0?At.substr(0,ae)+Et[ae]+jt.substr(ae+1):0<=Yt?At.substr(0,Yt)+It[Yt]+jt.substr(Yt+1):null;Ut(At[ae],Ue)<0&&(Yt=ae)}return fe<Et.length&&ee==="next"?At+jt.substr(At.length):fe<At.length&&ee==="prev"?At.substr(0,jt.length):Yt<0?null:At.substr(0,Yt)+Et[Yt]+jt.substr(Yt+1)})(nt,pt,B[kt],V[kt],j,et);Ot===null&&wt===null?X=kt+1:(wt===null||0<j(wt,Ot))&&(wt=Ot)}it(wt!==null?function(){Y.continue(wt+$)}:ot)}return!1}),Z}function Oi(m,v,w,_){return{type:2,lower:m,upper:v,lowerOpen:w,upperOpen:_}}function po(m){return{type:1,lower:m,upper:m}}Object.defineProperty(Xe.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Xe.prototype.between=function(m,v,w,_){w=w!==!1,_=_===!0;try{return 0<this._cmp(m,v)||this._cmp(m,v)===0&&(w||_)&&(!w||!_)?Ji(this):new this.Collection(this,function(){return Oi(m,v,!w,!_)})}catch{return ti(this,$n)}},Xe.prototype.equals=function(m){return m==null?ti(this,$n):new this.Collection(this,function(){return po(m)})},Xe.prototype.above=function(m){return m==null?ti(this,$n):new this.Collection(this,function(){return Oi(m,void 0,!0)})},Xe.prototype.aboveOrEqual=function(m){return m==null?ti(this,$n):new this.Collection(this,function(){return Oi(m,void 0,!1)})},Xe.prototype.below=function(m){return m==null?ti(this,$n):new this.Collection(this,function(){return Oi(void 0,m,!1,!0)})},Xe.prototype.belowOrEqual=function(m){return m==null?ti(this,$n):new this.Collection(this,function(){return Oi(void 0,m)})},Xe.prototype.startsWith=function(m){return typeof m!="string"?ti(this,hn):this.between(m,m+bi,!0,!0)},Xe.prototype.startsWithIgnoreCase=function(m){return m===""?this.startsWith(m):ri(this,function(v,w){return v.indexOf(w[0])===0},[m],bi)},Xe.prototype.equalsIgnoreCase=function(m){return ri(this,function(v,w){return v===w[0]},[m],"")},Xe.prototype.anyOfIgnoreCase=function(){var m=Pt.apply(Tt,arguments);return m.length===0?Ji(this):ri(this,function(v,w){return w.indexOf(v)!==-1},m,"")},Xe.prototype.startsWithAnyOfIgnoreCase=function(){var m=Pt.apply(Tt,arguments);return m.length===0?Ji(this):ri(this,function(v,w){return w.some(function(_){return v.indexOf(_)===0})},m,bi)},Xe.prototype.anyOf=function(){var m,v,w=this,_=Pt.apply(Tt,arguments),M=this._cmp;try{_.sort(M)}catch{return ti(this,$n)}return _.length===0?Ji(this):((m=new this.Collection(this,function(){return Oi(_[0],_[_.length-1])}))._ondirectionchange=function(N){M=N==="next"?w._ascending:w._descending,_.sort(M)},v=0,m._addAlgorithm(function(N,j,B){for(var V=N.key;0<M(V,_[v]);)if(++v===_.length)return j(B),!1;return M(V,_[v])===0||(j(function(){N.continue(_[v])}),!1)}),m)},Xe.prototype.notEqual=function(m){return this.inAnyRange([[-1/0,m],[m,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Xe.prototype.noneOf=function(){var m=Pt.apply(Tt,arguments);if(m.length===0)return new this.Collection(this);try{m.sort(this._ascending)}catch{return ti(this,$n)}var v=m.reduce(function(w,_){return w?w.concat([[w[w.length-1][1],_]]):[[-1/0,_]]},null);return v.push([m[m.length-1],this.db._maxKey]),this.inAnyRange(v,{includeLowers:!1,includeUppers:!1})},Xe.prototype.inAnyRange=function(m,ot){var w=this,_=this._cmp,M=this._ascending,N=this._descending,j=this._min,B=this._max;if(m.length===0)return Ji(this);if(!m.every(function(nt){return nt[0]!==void 0&&nt[1]!==void 0&&M(nt[0],nt[1])<=0}))return ti(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Rt.InvalidArgument);var V=!ot||ot.includeLowers!==!1,et=ot&&ot.includeUppers===!0,$,K=M;function Q(nt,pt){return K(nt[0],pt[0])}try{($=m.reduce(function(nt,pt){for(var wt=0,kt=nt.length;wt<kt;++wt){var Ot=nt[wt];if(_(pt[0],Ot[1])<0&&0<_(pt[1],Ot[0])){Ot[0]=j(Ot[0],pt[0]),Ot[1]=B(Ot[1],pt[1]);break}}return wt===kt&&nt.push(pt),nt},[])).sort(Q)}catch{return ti(this,$n)}var Z=0,X=et?function(nt){return 0<M(nt,$[Z][1])}:function(nt){return 0<=M(nt,$[Z][1])},Y=V?function(nt){return 0<N(nt,$[Z][0])}:function(nt){return 0<=N(nt,$[Z][0])},it=X,ot=new this.Collection(this,function(){return Oi($[0][0],$[$.length-1][1],!V,!et)});return ot._ondirectionchange=function(nt){K=nt==="next"?(it=X,M):(it=Y,N),$.sort(Q)},ot._addAlgorithm(function(nt,pt,wt){for(var kt,Ot=nt.key;it(Ot);)if(++Z===$.length)return pt(wt),!1;return!X(kt=Ot)&&!Y(kt)||(w._cmp(Ot,$[Z][1])===0||w._cmp(Ot,$[Z][0])===0||pt(function(){K===M?nt.continue($[Z][0]):nt.continue($[Z][1])}),!1)}),ot},Xe.prototype.startsWithAnyOf=function(){var m=Pt.apply(Tt,arguments);return m.every(function(v){return typeof v=="string"})?m.length===0?Ji(this):this.inAnyRange(m.map(function(v){return[v,v+bi]})):ti(this,"startsWithAnyOf() only works with strings")};var Gs=Xe;function Xe(){}function vi(m){return Ke(function(v){return Ks(v),m(v.target.error),!1})}function Ks(m){m.stopPropagation&&m.stopPropagation(),m.preventDefault&&m.preventDefault()}var Ra="storagemutated",Vs="x-storagemutated-1",Rn=Ar(null,Ra),Nl=(Xn.prototype._lock=function(){return I(!Ft.global),++this._reculock,this._reculock!==1||Ft.global||(Ft.lockOwnerFor=this),this},Xn.prototype._unlock=function(){if(I(!Ft.global),--this._reculock==0)for(Ft.global||(Ft.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var m=this._blockedFuncs.shift();try{yi(m[1],m[0])}catch{}}return this},Xn.prototype._locked=function(){return this._reculock&&Ft.lockOwnerFor!==this},Xn.prototype.create=function(m){var v=this;if(this.mode){var w=this.db.idbdb,_=this.db._state.dbOpenError;if(I(!this.idbtrans),!m&&!w)switch(_&&_.name){case"DatabaseClosedError":throw new Rt.DatabaseClosed(_);case"MissingAPIError":throw new Rt.MissingAPI(_.message,_);default:throw new Rt.OpenFailed(_)}if(!this.active)throw new Rt.TransactionInactive;I(this._completion._state===null),(m=this.idbtrans=m||(this.db.core||w).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ke(function(M){Ks(M),v._reject(m.error)}),m.onabort=Ke(function(M){Ks(M),v.active&&v._reject(new Rt.Abort(m.error)),v.active=!1,v.on("abort").fire(M)}),m.oncomplete=Ke(function(){v.active=!1,v._resolve(),"mutatedParts"in m&&Rn.storagemutated.fire(m.mutatedParts)})}return this},Xn.prototype._promise=function(m,v,w){var _,M=this;return m==="readwrite"&&this.mode!=="readwrite"?Ie(new Rt.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Lt(function(N,j){M._blockedFuncs.push([function(){M._promise(m,v,w).then(N,j)},Ft])}):w?$e(function(){var N=new Lt(function(j,B){M._lock();var V=v(j,B,M);V&&V.then&&V.then(j,B)});return N.finally(function(){return M._unlock()}),N._lib=!0,N}):((_=new Lt(function(N,j){var B=v(N,j,M);B&&B.then&&B.then(N,j)}))._lib=!0,_):Ie(new Rt.TransactionInactive)},Xn.prototype._root=function(){return this.parent?this.parent._root():this},Xn.prototype.waitFor=function(m){var v,w=this._root(),_=Lt.resolve(m),M=(w._waitingFor?w._waitingFor=w._waitingFor.then(function(){return _}):(w._waitingFor=_,w._waitingQueue=[],v=w.idbtrans.objectStore(w.storeNames[0]),(function N(){for(++w._spinCount;w._waitingQueue.length;)w._waitingQueue.shift()();w._waitingFor&&(v.get(-1/0).onsuccess=N)})()),w._waitingFor);return new Lt(function(N,j){_.then(function(B){return w._waitingQueue.push(Ke(N.bind(null,B)))},function(B){return w._waitingQueue.push(Ke(j.bind(null,B)))}).finally(function(){w._waitingFor===M&&(w._waitingFor=null)})})},Xn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Rt.Abort))},Xn.prototype.table=function(m){var v=this._memoizedTables||(this._memoizedTables={});if(y(v,m))return v[m];var w=this.schema[m];if(w)return(w=new this.db.Table(m,w,this)).core=this.db.core.table(m),v[m]=w;throw new Rt.NotFound("Table "+m+" not part of transaction")},Xn);function Xn(){}function Li(m,v,w,_,M,N,j,B){return{name:m,keyPath:v,unique:w,multi:_,auto:M,compound:N,src:(w&&!j?"&":"")+(_?"*":"")+(M?"++":"")+mo(v),type:B}}function mo(m){return typeof m=="string"?m:m?"["+[].join.call(m,"+")+"]":""}function Ma(m,v,w){return{name:m,primKey:v,indexes:w,mappedClass:null,idxByName:(_=function(M){return[M.name,M]},w.reduce(function(M,N,j){return N=_(N,j),N&&(M[N[0]]=N[1]),M},{}))};var _}var Da=function(m){try{return m.only([[]]),Da=function(){return[[]]},[[]]}catch{return Da=function(){return bi},bi}};function Na(m){return m==null?function(){}:typeof m=="string"?(v=m).split(".").length===1?function(w){return w[v]}:function(w){return H(w,v)}:function(w){return H(w,m)};var v}function Cr(m){return[].slice.call(m)}var lu=0;function gn(m){return m==null?":id":typeof m=="string"?m:"[".concat(m.join("+"),"]")}function $s(m,v,V){function _(X){if(X.type===3)return null;if(X.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var K=X.lower,Q=X.upper,Z=X.lowerOpen,X=X.upperOpen;return K===void 0?Q===void 0?null:v.upperBound(Q,!!X):Q===void 0?v.lowerBound(K,!!Z):v.bound(K,Q,!!Z,!!X)}function M($){var K,Q=$.name;return{name:Q,schema:$,mutate:function(Z){var X=Z.trans,Y=Z.type,it=Z.keys,ot=Z.values,nt=Z.range;return new Promise(function(pt,wt){pt=Ke(pt);var kt=X.objectStore(Q),Ot=kt.keyPath==null,At=Y==="put"||Y==="add";if(!At&&Y!=="delete"&&Y!=="deleteRange")throw new Error("Invalid operation type: "+Y);var It,jt=(it||ot||{length:1}).length;if(it&&ot&&it.length!==ot.length)throw new Error("Given keys array must have same length as given values array.");if(jt===0)return pt({numFailures:0,failures:{},results:[],lastResult:void 0});function Et(je){++fe,Ks(je)}var Ut=[],ee=[],fe=0;if(Y==="deleteRange"){if(nt.type===4)return pt({numFailures:fe,failures:ee,results:[],lastResult:void 0});nt.type===3?Ut.push(It=kt.clear()):Ut.push(It=kt.delete(_(nt)))}else{var Ot=At?Ot?[ot,it]:[ot,null]:[it,null],Yt=Ot[0],ae=Ot[1];if(At)for(var Ue=0;Ue<jt;++Ue)Ut.push(It=ae&&ae[Ue]!==void 0?kt[Y](Yt[Ue],ae[Ue]):kt[Y](Yt[Ue])),It.onerror=Et;else for(Ue=0;Ue<jt;++Ue)Ut.push(It=kt[Y](Yt[Ue])),It.onerror=Et}function Qn(je){je=je.target.result,Ut.forEach(function(bs,Ba){return bs.error!=null&&(ee[Ba]=bs.error)}),pt({numFailures:fe,failures:ee,results:Y==="delete"?it:Ut.map(function(bs){return bs.result}),lastResult:je})}It.onerror=function(je){Et(je),Qn(je)},It.onsuccess=Qn})},getMany:function(Z){var X=Z.trans,Y=Z.keys;return new Promise(function(it,ot){it=Ke(it);for(var nt,pt=X.objectStore(Q),wt=Y.length,kt=new Array(wt),Ot=0,At=0,It=function(Ut){Ut=Ut.target,kt[Ut._pos]=Ut.result,++At===Ot&&it(kt)},jt=vi(ot),Et=0;Et<wt;++Et)Y[Et]!=null&&((nt=pt.get(Y[Et]))._pos=Et,nt.onsuccess=It,nt.onerror=jt,++Ot);Ot===0&&it(kt)})},get:function(Z){var X=Z.trans,Y=Z.key;return new Promise(function(it,ot){it=Ke(it);var nt=X.objectStore(Q).get(Y);nt.onsuccess=function(pt){return it(pt.target.result)},nt.onerror=vi(ot)})},query:(K=B,function(Z){return new Promise(function(X,Y){X=Ke(X);var it,ot,nt,At=Z.trans,pt=Z.values,wt=Z.limit,Ot=Z.query,kt=wt===1/0?void 0:wt,It=Ot.index,Ot=Ot.range,At=At.objectStore(Q),At=It.isPrimaryKey?At:At.index(It.name),It=_(Ot);if(wt===0)return X({result:[]});K?((Ot=pt?At.getAll(It,kt):At.getAllKeys(It,kt)).onsuccess=function(jt){return X({result:jt.target.result})},Ot.onerror=vi(Y)):(it=0,ot=!pt&&"openKeyCursor"in At?At.openKeyCursor(It):At.openCursor(It),nt=[],ot.onsuccess=function(jt){var Et=ot.result;return!Et||(nt.push(pt?Et.value:Et.primaryKey),++it===wt)?X({result:nt}):void Et.continue()},ot.onerror=vi(Y))})}),openCursor:function(Z){var X=Z.trans,Y=Z.values,it=Z.query,ot=Z.reverse,nt=Z.unique;return new Promise(function(pt,wt){pt=Ke(pt);var At=it.index,kt=it.range,Ot=X.objectStore(Q),Ot=At.isPrimaryKey?Ot:Ot.index(At.name),At=ot?nt?"prevunique":"prev":nt?"nextunique":"next",It=!Y&&"openKeyCursor"in Ot?Ot.openKeyCursor(_(kt),At):Ot.openCursor(_(kt),At);It.onerror=vi(wt),It.onsuccess=Ke(function(jt){var Et,Ut,ee,fe,Yt=It.result;Yt?(Yt.___id=++lu,Yt.done=!1,Et=Yt.continue.bind(Yt),Ut=(Ut=Yt.continuePrimaryKey)&&Ut.bind(Yt),ee=Yt.advance.bind(Yt),fe=function(){throw new Error("Cursor not stopped")},Yt.trans=X,Yt.stop=Yt.continue=Yt.continuePrimaryKey=Yt.advance=function(){throw new Error("Cursor not started")},Yt.fail=Ke(wt),Yt.next=function(){var ae=this,Ue=1;return this.start(function(){return Ue--?ae.continue():ae.stop()}).then(function(){return ae})},Yt.start=function(ae){function Ue(){if(It.result)try{ae()}catch(je){Yt.fail(je)}else Yt.done=!0,Yt.start=function(){throw new Error("Cursor behind last entry")},Yt.stop()}var Qn=new Promise(function(je,bs){je=Ke(je),It.onerror=vi(bs),Yt.fail=bs,Yt.stop=function(Ba){Yt.stop=Yt.continue=Yt.continuePrimaryKey=Yt.advance=fe,je(Ba)}});return It.onsuccess=Ke(function(je){It.onsuccess=Ue,Ue()}),Yt.continue=Et,Yt.continuePrimaryKey=Ut,Yt.advance=ee,Ue(),Qn},pt(Yt)):pt(null)},wt)})},count:function(Z){var X=Z.query,Y=Z.trans,it=X.index,ot=X.range;return new Promise(function(nt,pt){var wt=Y.objectStore(Q),wt=it.isPrimaryKey?wt:wt.index(it.name),kt=_(ot),kt=kt?wt.count(kt):wt.count();kt.onsuccess=Ke(function(Ot){return nt(Ot.target.result)}),kt.onerror=vi(pt)})}}}N=V,j=Cr((V=m).objectStoreNames);var N,V={schema:{name:V.name,tables:j.map(function($){return N.objectStore($)}).map(function($){var K=$.keyPath,Q=$.autoIncrement,X=u(K),Z={},X={name:$.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:K==null,compound:X,keyPath:K,autoIncrement:Q,unique:!0,extractKey:Na(K)},indexes:Cr($.indexNames).map(function(Y){return $.index(Y)}).map(function(nt){var pt=nt.name,it=nt.unique,ot=nt.multiEntry,nt=nt.keyPath,pt={name:pt,compound:u(nt),keyPath:nt,unique:it,multiEntry:ot,extractKey:Na(nt)};return Z[gn(nt)]=pt}),getIndexByKeyPath:function(Y){return Z[gn(Y)]}};return Z[":id"]=X.primaryKey,K!=null&&(Z[gn(K)]=X.primaryKey),X})},hasGetAll:0<j.length&&"getAll"in N.objectStore(j[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},j=V.schema,B=V.hasGetAll,V=j.tables.map(M),et={};return V.forEach(function($){return et[$.name]=$}),{stack:"dbcore",transaction:m.transaction.bind(m),table:function($){if(et[$])return et[$];throw new Error("Table '".concat($,"' not found"))},MIN_KEY:-1/0,MAX_KEY:Da(v),schema:j}}function go(m,v,w,_){return w=w.IDBKeyRange,v=$s(v,w,_),{dbcore:m.dbcore.reduce(function(M,N){return N=N.create,i(i({},M),N(M))},v)}}function ms(m,v){var w=v.db,w=go(m._middlewares,w,m._deps,v);m.core=w.dbcore,m.tables.forEach(function(_){var M=_.name;m.core.schema.tables.some(function(N){return N.name===M})&&(_.core=m.core.table(M),m[M]instanceof m.Table)&&(m[M].core=_.core)})}function yo(m,v,w,_){w.forEach(function(M){var N=_[M];v.forEach(function(j){var B=(function V(et,$){return R(et,$)||(et=f(et))&&V(et,$)})(j,M);(!B||"value"in B&&B.value===void 0)&&(j===m.Transaction.prototype||j instanceof m.Transaction?A(j,M,{get:function(){return this.table(M)},set:function(V){S(this,M,{value:V,writable:!0,configurable:!0,enumerable:!0})}}):j[M]=new m.Table(M,N))})})}function Tr(m,v){v.forEach(function(w){for(var _ in w)w[_]instanceof m.Table&&delete w[_]})}function kl(m,v){return m._cfg.version-v._cfg.version}function Rr(m,v,w,_){var M=m._dbSchema,N=(w.objectStoreNames.contains("$meta")&&!M.$meta&&(M.$meta=Ma("$meta",uu("")[0],[]),m._storeNames.push("$meta")),m._createTransaction("readwrite",m._storeNames,M)),j=(N.create(w),N._completion.catch(_),N._reject.bind(N)),B=Ft.transless||Ft;$e(function(){if(Ft.trans=N,Ft.transless=B,v!==0)return ms(m,w),et=v,((V=N).storeNames.includes("$meta")?V.table("$meta").get("version").then(function($){return $??et}):Lt.resolve(et)).then(function(it){var K=m,Q=it,Z=N,X=w,Y=[],it=K._versions,ot=K._dbSchema=ka(0,K.idbdb,X);return(it=it.filter(function(nt){return nt._cfg.version>=Q})).length===0?Lt.resolve():(it.forEach(function(nt){Y.push(function(){var pt,wt,kt,Ot=ot,At=nt._cfg.dbschema,It=(wo(K,Ot,X),wo(K,At,X),ot=K._dbSchema=At,vo(Ot,At)),jt=(It.add.forEach(function(Et){Ol(X,Et[0],Et[1].primKey,Et[1].indexes)}),It.change.forEach(function(Et){if(Et.recreate)throw new Rt.Upgrade("Not yet support for changing primary key");var Ut=X.objectStore(Et.name);Et.add.forEach(function(ee){return xo(Ut,ee)}),Et.change.forEach(function(ee){Ut.deleteIndex(ee.name),xo(Ut,ee)}),Et.del.forEach(function(ee){return Ut.deleteIndex(ee)})}),nt._cfg.contentUpgrade);if(jt&&nt._cfg.version>Q)return ms(K,X),Z._memoizedTables={},pt=rt(At),It.del.forEach(function(Et){pt[Et]=Ot[Et]}),Tr(K,[K.Transaction.prototype]),yo(K,[K.Transaction.prototype],c(pt),pt),Z.schema=pt,(wt=F(jt))&&un(),At=Lt.follow(function(){var Et;(kt=jt(Z))&&wt&&(Et=Jn.bind(null,null),kt.then(Et,Et))}),kt&&typeof kt.then=="function"?Lt.resolve(kt):At.then(function(){return kt})}),Y.push(function(pt){var wt,kt,Ot=nt._cfg.dbschema;wt=Ot,kt=pt,[].slice.call(kt.db.objectStoreNames).forEach(function(At){return wt[At]==null&&kt.db.deleteObjectStore(At)}),Tr(K,[K.Transaction.prototype]),yo(K,[K.Transaction.prototype],K._storeNames,K._dbSchema),Z.schema=K._dbSchema}),Y.push(function(pt){K.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(K.idbdb.version/10)===nt._cfg.version?(K.idbdb.deleteObjectStore("$meta"),delete K._dbSchema.$meta,K._storeNames=K._storeNames.filter(function(wt){return wt!=="$meta"})):pt.objectStore("$meta").put(nt._cfg.version,"version"))})}),(function nt(){return Y.length?Lt.resolve(Y.shift()(Z.idbtrans)).then(nt):Lt.resolve()})().then(function(){cu(ot,X)}))}).catch(j);var V,et;c(M).forEach(function($){Ol(w,$,M[$].primKey,M[$].indexes)}),ms(m,w),Lt.follow(function(){return m.on.populate.fire(N)}).catch(j)})}function bo(m,v){cu(m._dbSchema,v),v.db.version%10!=0||v.objectStoreNames.contains("$meta")||v.db.createObjectStore("$meta").add(Math.ceil(v.db.version/10-1),"version");var w=ka(0,m.idbdb,v);wo(m,m._dbSchema,v);for(var _=0,M=vo(w,m._dbSchema).change;_<M.length;_++){var N=(j=>{if(j.change.length||j.recreate)return console.warn("Unable to patch indexes of table ".concat(j.name," because it has changes on the type of index or primary key.")),{value:void 0};var B=v.objectStore(j.name);j.add.forEach(function(V){Fe&&console.debug("Dexie upgrade patch: Creating missing index ".concat(j.name,".").concat(V.src)),xo(B,V)})})(M[_]);if(typeof N=="object")return N.value}}function vo(m,v){var w,_={del:[],add:[],change:[]};for(w in m)v[w]||_.del.push(w);for(w in v){var M=m[w],N=v[w];if(M){var j={name:w,def:N,recreate:!1,del:[],add:[],change:[]};if(""+(M.primKey.keyPath||"")!=""+(N.primKey.keyPath||"")||M.primKey.auto!==N.primKey.auto)j.recreate=!0,_.change.push(j);else{var B=M.idxByName,V=N.idxByName,et=void 0;for(et in B)V[et]||j.del.push(et);for(et in V){var $=B[et],K=V[et];$?$.src!==K.src&&j.change.push(K):j.add.push(K)}(0<j.del.length||0<j.add.length||0<j.change.length)&&_.change.push(j)}}else _.add.push([w,N])}return _}function Ol(m,v,w,_){var M=m.db.createObjectStore(v,w.keyPath?{keyPath:w.keyPath,autoIncrement:w.auto}:{autoIncrement:w.auto});_.forEach(function(N){return xo(M,N)})}function cu(m,v){c(m).forEach(function(w){v.db.objectStoreNames.contains(w)||(Fe&&console.debug("Dexie: Creating missing table",w),Ol(v,w,m[w].primKey,m[w].indexes))})}function xo(m,v){m.createIndex(v.name,v.keyPath,{unique:v.unique,multiEntry:v.multi})}function ka(m,v,w){var _={};return k(v.objectStoreNames,0).forEach(function(M){for(var N=w.objectStore(M),j=Li(mo(et=N.keyPath),et||"",!0,!1,!!N.autoIncrement,et&&typeof et!="string",!0),B=[],V=0;V<N.indexNames.length;++V){var $=N.index(N.indexNames[V]),et=$.keyPath,$=Li($.name,et,!!$.unique,!!$.multiEntry,!1,et&&typeof et!="string",!1);B.push($)}_[M]=Ma(M,j,B)}),_}function wo(m,v,w){for(var _=w.db.objectStoreNames,M=0;M<_.length;++M){var N=_[M],j=w.objectStore(N);m._hasGetAll="getAll"in j;for(var B=0;B<j.indexNames.length;++B){var V,et=j.indexNames[B],$=j.index(et).keyPath,$=typeof $=="string"?$:"["+k($).join("+")+"]";v[N]&&(V=v[N].idxByName[$])&&(V.name=et,delete v[N].idxByName[$],v[N].idxByName[et]=V)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(m._hasGetAll=!1)}function uu(m){return m.split(",").map(function(v,w){var M=v.split(":"),_=(_=M[1])==null?void 0:_.trim(),M=(v=M[0].trim()).replace(/([&*]|\+\+)/g,""),N=/^\[/.test(M)?M.match(/^\[(.*)\]$/)[1].split("+"):M;return Li(M,N||null,/\&/.test(v),/\*/.test(v),/\+\+/.test(v),u(N),w===0,_)})}Oa.prototype._createTableSchema=Ma,Oa.prototype._parseIndexSyntax=uu,Oa.prototype._parseStoresSpec=function(m,v){var w=this;c(m).forEach(function(_){if(m[_]!==null){var M=w._parseIndexSyntax(m[_]),N=M.shift();if(!N)throw new Rt.Schema("Invalid schema for table "+_+": "+m[_]);if(N.unique=!0,N.multi)throw new Rt.Schema("Primary key cannot be multiEntry*");M.forEach(function(j){if(j.auto)throw new Rt.Schema("Only primary key can be marked as autoIncrement (++)");if(!j.keyPath)throw new Rt.Schema("Index must have a name and cannot be an empty string")}),N=w._createTableSchema(_,N,M),v[_]=N}})},Oa.prototype.stores=function(w){var v=this.db,w=(this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,w):w,v._versions),_={},M={};return w.forEach(function(N){d(_,N._cfg.storesSource),M=N._cfg.dbschema={},N._parseStoresSpec(_,M)}),v._dbSchema=M,Tr(v,[v._allTables,v,v.Transaction.prototype]),yo(v,[v._allTables,v,v.Transaction.prototype,this._cfg.tables],c(M),M),v._storeNames=c(M),this},Oa.prototype.upgrade=function(m){return this._cfg.contentUpgrade=Te(this._cfg.contentUpgrade||Xt,m),this};var Ed=Oa;function Oa(){}function Ll(m,v){var w=m._dbNamesDB;return w||(w=m._dbNamesDB=new ji(xr,{addons:[],indexedDB:m,IDBKeyRange:v})).version(1).stores({dbnames:"name"}),w.table("dbnames")}function So(m){return m&&typeof m.databases=="function"}function jl(m){return $e(function(){return Ft.letThrough=!0,m()})}function Pl(m){return!("from"in m)}var Mn=function(m,v){var w;if(!this)return w=new Mn,m&&"d"in m&&d(w,m),w;d(this,arguments.length?{d:1,from:m,to:1<arguments.length?v:m}:{d:0})};function Mr(m,v,w){var _=ue(v,w);if(!isNaN(_)){if(0<_)throw RangeError();if(Pl(m))return d(m,{from:v,to:w,d:1});var _=m.l,M=m.r;if(ue(w,m.from)<0)return _?Mr(_,v,w):m.l={from:v,to:w,d:1,l:null,r:null},du(m);if(0<ue(v,m.to))return M?Mr(M,v,w):m.r={from:v,to:w,d:1,l:null,r:null},du(m);ue(v,m.from)<0&&(m.from=v,m.l=null,m.d=M?M.d+1:1),0<ue(w,m.to)&&(m.to=w,m.r=null,m.d=m.l?m.l.d+1:1),v=!m.r,_&&!m.l&&Xs(m,_),M&&v&&Xs(m,M)}}function Xs(m,v){Pl(v)||(function w(_,M){var N=M.from,j=M.l,B=M.r;Mr(_,N,M.to),j&&w(_,j),B&&w(_,B)})(m,v)}function hu(m,v){var w=Ao(v),_=w.next();if(!_.done)for(var M=_.value,N=Ao(m),j=N.next(M.from),B=j.value;!_.done&&!j.done;){if(ue(B.from,M.to)<=0&&0<=ue(B.to,M.from))return!0;ue(M.from,B.from)<0?M=(_=w.next(B.from)).value:B=(j=N.next(M.from)).value}return!1}function Ao(m){var v=Pl(m)?null:{s:0,n:m};return{next:function(w){for(var _=0<arguments.length;v;)switch(v.s){case 0:if(v.s=1,_)for(;v.n.l&&ue(w,v.n.from)<0;)v={up:v,n:v.n.l,s:1};else for(;v.n.l;)v={up:v,n:v.n.l,s:1};case 1:if(v.s=2,!_||ue(w,v.n.to)<=0)return{value:v.n,done:!1};case 2:if(v.n.r){v.s=3,v={up:v,n:v.n.r,s:0};continue}case 3:v=v.up}return{done:!0}}}}function du(m){var v,w,_,M=(((M=m.r)==null?void 0:M.d)||0)-(((M=m.l)==null?void 0:M.d)||0),M=1<M?"r":M<-1?"l":"";M&&(v=M=="r"?"l":"r",w=i({},m),_=m[M],m.from=_.from,m.to=_.to,m[M]=_[M],w[M]=_[v],(m[v]=w).d=Bl(w)),m.d=Bl(m)}function Bl(w){var v=w.r,w=w.l;return(v?w?Math.max(v.d,w.d):v.d:w?w.d:0)+1}function Eo(m,v){return c(v).forEach(function(w){m[w]?Xs(m[w],v[w]):m[w]=(function _(M){var N,j,B={};for(N in M)y(M,N)&&(j=M[N],B[N]=!j||typeof j!="object"||_t.has(j.constructor)?j:_(j));return B})(v[w])}),m}function Fl(m,v){return m.all||v.all||Object.keys(m).some(function(w){return v[w]&&hu(v[w],m[w])})}x(Mn.prototype,((Vn={add:function(m){return Xs(this,m),this},addKey:function(m){return Mr(this,m,m),this},addKeys:function(m){var v=this;return m.forEach(function(w){return Mr(v,w,w)}),this},hasKey:function(m){var v=Ao(this).next(m).value;return v&&ue(v.from,m)<=0&&0<=ue(v.to,m)}})[G]=function(){return Ao(this)},Vn));var Ys={},Il={},Ul=!1;function _o(m){Eo(Il,m),Ul||(Ul=!0,setTimeout(function(){Ul=!1,zl(Il,!(Il={}))},0))}function zl(m,v){v===void 0&&(v=!1);var w=new Set;if(m.all)for(var _=0,M=Object.values(Ys);_<M.length;_++)fu(B=M[_],m,w,v);else for(var N in m){var j,B,N=/^idb\:\/\/(.*)\/(.*)\//.exec(N);N&&(j=N[1],N=N[2],B=Ys["idb://".concat(j,"/").concat(N)])&&fu(B,m,w,v)}w.forEach(function(V){return V()})}function fu(m,v,w,_){for(var M=[],N=0,j=Object.entries(m.queries.query);N<j.length;N++){for(var B=j[N],V=B[0],et=[],$=0,K=B[1];$<K.length;$++){var Q=K[$];Fl(v,Q.obsSet)?Q.subscribers.forEach(function(it){return w.add(it)}):_&&et.push(Q)}_&&M.push([V,et])}if(_)for(var Z=0,X=M;Z<X.length;Z++){var Y=X[Z],V=Y[0],et=Y[1];m.queries.query[V]=et}}function _d(m){var v=m._state,w=m._deps.indexedDB;if(v.isBeingOpened||m.idbdb)return v.dbReadyPromise.then(function(){return v.dbOpenError?Ie(v.dbOpenError):m});v.isBeingOpened=!0,v.dbOpenError=null,v.openComplete=!1;var _=v.openCanceller,M=Math.round(10*m.verno),N=!1;function j(){if(v.openCanceller!==_)throw new Rt.DatabaseClosed("db.open() was cancelled")}function B(){return new Lt(function(Q,Z){if(j(),!w)throw new Rt.MissingAPI;var X=m.name,Y=v.autoSchema||!M?w.open(X):w.open(X,M);if(!Y)throw new Rt.MissingAPI;Y.onerror=vi(Z),Y.onblocked=Ke(m._fireOnBlocked),Y.onupgradeneeded=Ke(function(it){var ot;$=Y.transaction,v.autoSchema&&!m._options.allowEmptyDB?(Y.onerror=Ks,$.abort(),Y.result.close(),(ot=w.deleteDatabase(X)).onsuccess=ot.onerror=Ke(function(){Z(new Rt.NoSuchDatabase("Database ".concat(X," doesnt exist")))})):($.onerror=vi(Z),ot=it.oldVersion>Math.pow(2,62)?0:it.oldVersion,K=ot<1,m.idbdb=Y.result,N&&bo(m,$),Rr(m,ot/10,$,Z))},Z),Y.onsuccess=Ke(function(){$=null;var it,ot,nt,pt,wt,kt,Ot=m.idbdb=Y.result,At=k(Ot.objectStoreNames);if(0<At.length)try{var It=Ot.transaction((wt=At).length===1?wt[0]:wt,"readonly");if(v.autoSchema)kt=Ot,pt=It,(nt=m).verno=kt.version/10,pt=nt._dbSchema=ka(0,kt,pt),nt._storeNames=k(kt.objectStoreNames,0),yo(nt,[nt._allTables],c(pt),pt);else if(wo(m,m._dbSchema,It),ot=It,((ot=vo(ka(0,(it=m).idbdb,ot),it._dbSchema)).add.length||ot.change.some(function(jt){return jt.add.length||jt.change.length}))&&!N)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Ot.close(),M=Ot.version+1,N=!0,Q(B());ms(m,It)}catch{}zs.push(m),Ot.onversionchange=Ke(function(jt){v.vcFired=!0,m.on("versionchange").fire(jt)}),Ot.onclose=Ke(function(){m.close({disableAutoOpen:!1})}),K&&(At=m._deps,wt=X,So(kt=At.indexedDB)||wt===xr||Ll(kt,At.IDBKeyRange).put({name:wt}).catch(Xt)),Q()},Z)}).catch(function(Q){switch(Q?.name){case"UnknownError":if(0<v.PR1398_maxLoop)return v.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),B();break;case"VersionError":if(0<M)return M=0,B()}return Lt.reject(Q)})}var V,et=v.dbReadyResolve,$=null,K=!1;return Lt.race([_,(typeof navigator>"u"?Lt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function Z(){return indexedDB.databases().finally(Q)}V=setInterval(Z,100),Z()}).finally(function(){return clearInterval(V)}):Promise.resolve()).then(B)]).then(function(){return j(),v.onReadyBeingFired=[],Lt.resolve(jl(function(){return m.on.ready.fire(m.vip)})).then(function Q(){var Z;if(0<v.onReadyBeingFired.length)return Z=v.onReadyBeingFired.reduce(Te,Xt),v.onReadyBeingFired=[],Lt.resolve(jl(function(){return Z(m.vip)})).then(Q)})}).finally(function(){v.openCanceller===_&&(v.onReadyBeingFired=null,v.isBeingOpened=!1)}).catch(function(Q){v.dbOpenError=Q;try{$&&$.abort()}catch{}return _===v.openCanceller&&m._close(),Ie(Q)}).finally(function(){v.openComplete=!0,et()}).then(function(){var Q;return K&&(Q={},m.tables.forEach(function(Z){Z.schema.indexes.forEach(function(X){X.name&&(Q["idb://".concat(m.name,"/").concat(Z.name,"/").concat(X.name)]=new Mn(-1/0,[[[]]]))}),Q["idb://".concat(m.name,"/").concat(Z.name,"/")]=Q["idb://".concat(m.name,"/").concat(Z.name,"/:dels")]=new Mn(-1/0,[[[]]])}),Rn(Ra).fire(Q),zl(Q,!0)),m})}function Dr(m){function v(N){return m.next(N)}var w=M(v),_=M(function(N){return m.throw(N)});function M(N){return function(B){var B=N(B),V=B.value;return B.done?V:V&&typeof V.then=="function"?V.then(w,_):u(V)?Promise.all(V).then(w,_):w(V)}}return M(v)()}function gs(m,v,w){for(var _=u(m)?m.slice():[m],M=0;M<w;++M)_.push(v);return _}var Cd={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(m){return i(i({},m),{table:function(_){var w=m.table(_),_=w.schema,M={},N=[];function j(Q,Z,X){var nt=gn(Q),Y=M[nt]=M[nt]||[],it=Q==null?0:typeof Q=="string"?1:Q.length,ot=0<Z,nt=i(i({},X),{name:ot?"".concat(nt,"(virtual-from:").concat(X.name,")"):X.name,lowLevelIndex:X,isVirtual:ot,keyTail:Z,keyLength:it,extractKey:Na(Q),unique:!ot&&X.unique});return Y.push(nt),nt.isPrimaryKey||N.push(nt),1<it&&j(it===2?Q[0]:Q.slice(0,it-1),Z+1,X),Y.sort(function(pt,wt){return pt.keyTail-wt.keyTail}),nt}var B=j(_.primaryKey.keyPath,0,_.primaryKey);M[":id"]=[B];for(var V=0,et=_.indexes;V<et.length;V++){var $=et[V];j($.keyPath,0,$)}function K(Q){var Z,X=Q.query.index;return X.isVirtual?i(i({},Q),{query:{index:X.lowLevelIndex,range:(Z=Q.query.range,X=X.keyTail,{type:Z.type===1?2:Z.type,lower:gs(Z.lower,Z.lowerOpen?m.MAX_KEY:m.MIN_KEY,X),lowerOpen:!0,upper:gs(Z.upper,Z.upperOpen?m.MIN_KEY:m.MAX_KEY,X),upperOpen:!0})}}):Q}return i(i({},w),{schema:i(i({},_),{primaryKey:B,indexes:N,getIndexByKeyPath:function(Q){return(Q=M[gn(Q)])&&Q[0]}}),count:function(Q){return w.count(K(Q))},query:function(Q){return w.query(K(Q))},openCursor:function(Q){var Z=Q.query.index,X=Z.keyTail,Y=Z.keyLength;return Z.isVirtual?w.openCursor(K(Q)).then(function(ot){return ot&&it(ot)}):w.openCursor(Q);function it(ot){return Object.create(ot,{continue:{value:function(nt){nt!=null?ot.continue(gs(nt,Q.reverse?m.MAX_KEY:m.MIN_KEY,X)):Q.unique?ot.continue(ot.key.slice(0,Y).concat(Q.reverse?m.MIN_KEY:m.MAX_KEY,X)):ot.continue()}},continuePrimaryKey:{value:function(nt,pt){ot.continuePrimaryKey(gs(nt,m.MAX_KEY,X),pt)}},primaryKey:{get:function(){return ot.primaryKey}},key:{get:function(){var nt=ot.key;return Y===1?nt[0]:nt.slice(0,Y)}},value:{get:function(){return ot.value}}})}}})}})}};function Co(m,v,w,_){return w=w||{},_=_||"",c(m).forEach(function(M){var N,j,B;y(v,M)?(N=m[M],j=v[M],typeof N=="object"&&typeof j=="object"&&N&&j?(B=Ht(N))!==Ht(j)?w[_+M]=v[M]:B==="Object"?Co(N,j,w,_+M+"."):N!==j&&(w[_+M]=v[M]):N!==j&&(w[_+M]=v[M])):w[_+M]=void 0}),c(v).forEach(function(M){y(m,M)||(w[_+M]=v[M])}),w}function To(m,v){return v.type==="delete"?v.keys:v.keys||v.values.map(m.extractKey)}var pu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(m){return i(i({},m),{table:function(v){var w=m.table(v),_=w.schema.primaryKey;return i(i({},w),{mutate:function(M){var N=Ft.trans,j=N.table(v).hook,B=j.deleting,V=j.creating,et=j.updating;switch(M.type){case"add":if(V.fire===Xt)break;return N._promise("readwrite",function(){return $(M)},!0);case"put":if(V.fire===Xt&&et.fire===Xt)break;return N._promise("readwrite",function(){return $(M)},!0);case"delete":if(B.fire===Xt)break;return N._promise("readwrite",function(){return $(M)},!0);case"deleteRange":if(B.fire===Xt)break;return N._promise("readwrite",function(){return(function K(Q,Z,X){return w.query({trans:Q,values:!1,query:{index:_,range:Z},limit:X}).then(function(Y){var it=Y.result;return $({type:"delete",keys:it,trans:Q}).then(function(ot){return 0<ot.numFailures?Promise.reject(ot.failures[0]):it.length<X?{failures:[],numFailures:0,lastResult:void 0}:K(Q,i(i({},Z),{lower:it[it.length-1],lowerOpen:!0}),X)})})})(M.trans,M.range,1e4)},!0)}return w.mutate(M);function $(K){var Q,Z,X,Y=Ft.trans,it=K.keys||To(_,K);if(it)return(K=K.type==="add"||K.type==="put"?i(i({},K),{keys:it}):i({},K)).type!=="delete"&&(K.values=a([],K.values)),K.keys&&(K.keys=a([],K.keys)),Q=w,X=it,((Z=K).type==="add"?Promise.resolve([]):Q.getMany({trans:Z.trans,keys:X,cache:"immutable"})).then(function(ot){var nt=it.map(function(pt,wt){var kt,Ot,At,It=ot[wt],jt={onerror:null,onsuccess:null};return K.type==="delete"?B.fire.call(jt,pt,It,Y):K.type==="add"||It===void 0?(kt=V.fire.call(jt,pt,K.values[wt],Y),pt==null&&kt!=null&&(K.keys[wt]=pt=kt,_.outbound||P(K.values[wt],_.keyPath,pt))):(kt=Co(It,K.values[wt]),(Ot=et.fire.call(jt,kt,pt,It,Y))&&(At=K.values[wt],Object.keys(Ot).forEach(function(Et){y(At,Et)?At[Et]=Ot[Et]:P(At,Et,Ot[Et])}))),jt});return w.mutate(K).then(function(pt){for(var wt=pt.failures,kt=pt.results,Ot=pt.numFailures,pt=pt.lastResult,At=0;At<it.length;++At){var It=(kt||it)[At],jt=nt[At];It==null?jt.onerror&&jt.onerror(wt[At]):jt.onsuccess&&jt.onsuccess(K.type==="put"&&ot[At]?K.values[At]:It)}return{failures:wt,results:kt,numFailures:Ot,lastResult:pt}}).catch(function(pt){return nt.forEach(function(wt){return wt.onerror&&wt.onerror(pt)}),Promise.reject(pt)})});throw new Error("Keys missing")}}})}})}};function Hl(m,v,w){try{if(!v||v.keys.length<m.length)return null;for(var _=[],M=0,N=0;M<v.keys.length&&N<m.length;++M)ue(v.keys[M],m[N])===0&&(_.push(w?Vt(v.values[M]):v.values[M]),++N);return _.length===m.length?_:null}catch{return null}}var mu={stack:"dbcore",level:-1,create:function(m){return{table:function(v){var w=m.table(v);return i(i({},w),{getMany:function(_){var M;return _.cache?(M=Hl(_.keys,_.trans._cache,_.cache==="clone"))?Lt.resolve(M):w.getMany(_).then(function(N){return _.trans._cache={keys:_.keys,values:_.cache==="clone"?Vt(N):N},N}):w.getMany(_)},mutate:function(_){return _.type!=="add"&&(_.trans._cache=null),w.mutate(_)}})}}}};function Qs(m,v){return m.trans.mode==="readonly"&&!!m.subscr&&!m.trans.explicit&&m.trans.db._options.cache!=="disabled"&&!v.schema.primaryKey.outbound}function gu(m,v){switch(m){case"query":return v.values&&!v.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var Td={stack:"dbcore",level:0,name:"Observability",create:function(m){var v=m.schema.name,w=new Mn(m.MIN_KEY,m.MAX_KEY);return i(i({},m),{transaction:function(_,M,N){if(Ft.subscr&&M!=="readonly")throw new Rt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ft.querier));return m.transaction(_,M,N)},table:function(_){function M(it){var Y,it=it.query;return[Y=it.index,new Mn((Y=(it=it.range).lower)!=null?Y:m.MIN_KEY,(Y=it.upper)!=null?Y:m.MAX_KEY)]}var N=m.table(_),j=N.schema,B=j.primaryKey,V=j.indexes,et=B.extractKey,$=B.outbound,K=B.autoIncrement&&V.filter(function(X){return X.compound&&X.keyPath.includes(B.keyPath)}),Q=i(i({},N),{mutate:function(X){function Y(Ut){return Ut="idb://".concat(v,"/").concat(_,"/").concat(Ut),wt[Ut]||(wt[Ut]=new Mn)}var it,ot,nt,pt=X.trans,wt=X.mutatedParts||(X.mutatedParts={}),kt=Y(""),Ot=Y(":dels"),At=X.type,jt=X.type==="deleteRange"?[X.range]:X.type==="delete"?[X.keys]:X.values.length<50?[To(B,X).filter(function(Ut){return Ut}),X.values]:[],It=jt[0],jt=jt[1],Et=X.trans._cache;return u(It)?(kt.addKeys(It),(At=At==="delete"||It.length===jt.length?Hl(It,Et):null)||Ot.addKeys(It),(At||jt)&&(it=Y,ot=At,nt=jt,j.indexes.forEach(function(Ut){var ee=it(Ut.name||"");function fe(ae){return ae!=null?Ut.extractKey(ae):null}function Yt(ae){Ut.multiEntry&&u(ae)?ae.forEach(function(Ue){return ee.addKey(Ue)}):ee.addKey(ae)}(ot||nt).forEach(function(ae,je){var Qn=ot&&fe(ot[je]),je=nt&&fe(nt[je]);ue(Qn,je)!==0&&(Qn!=null&&Yt(Qn),je!=null)&&Yt(je)})}))):It?(jt={from:(Et=It.lower)!=null?Et:m.MIN_KEY,to:(At=It.upper)!=null?At:m.MAX_KEY},Ot.add(jt),kt.add(jt)):(kt.add(w),Ot.add(w),j.indexes.forEach(function(Ut){return Y(Ut.name).add(w)})),N.mutate(X).then(function(Ut){return!It||X.type!=="add"&&X.type!=="put"||(kt.addKeys(Ut.results),K&&K.forEach(function(ee){for(var fe=X.values.map(function(Qn){return ee.extractKey(Qn)}),Yt=ee.keyPath.findIndex(function(Qn){return Qn===B.keyPath}),ae=0,Ue=Ut.results.length;ae<Ue;++ae)fe[ae][Yt]=Ut.results[ae];Y(ee.name).addKeys(fe)})),pt.mutatedParts=Eo(pt.mutatedParts||{},wt),Ut})}}),Z={get:function(X){return[B,new Mn(X.key)]},getMany:function(X){return[B,new Mn().addKeys(X.keys)]},count:M,query:M,openCursor:M};return c(Z).forEach(function(X){Q[X]=function(Y){var it=Ft.subscr,ot=!!it,nt=Qs(Ft,N)&&gu(X,Y)?Y.obsSet={}:it;if(ot){var pt,it=function(jt){return jt="idb://".concat(v,"/").concat(_,"/").concat(jt),nt[jt]||(nt[jt]=new Mn)},wt=it(""),kt=it(":dels"),ot=Z[X](Y),Ot=ot[0],ot=ot[1];if((X==="query"&&Ot.isPrimaryKey&&!Y.values?kt:it(Ot.name||"")).add(ot),!Ot.isPrimaryKey){if(X!=="count")return pt=X==="query"&&$&&Y.values&&N.query(i(i({},Y),{values:!1})),N[X].apply(this,arguments).then(function(jt){if(X==="query"){if($&&Y.values)return pt.then(function(fe){return fe=fe.result,wt.addKeys(fe),jt});var Et=Y.values?jt.result.map(et):jt.result;(Y.values?wt:kt).addKeys(Et)}else{var Ut,ee;if(X==="openCursor")return ee=Y.values,(Ut=jt)&&Object.create(Ut,{key:{get:function(){return kt.addKey(Ut.primaryKey),Ut.key}},primaryKey:{get:function(){var fe=Ut.primaryKey;return kt.addKey(fe),fe}},value:{get:function(){return ee&&wt.addKey(Ut.primaryKey),Ut.value}}})}return jt});kt.add(w)}}return N[X].apply(this,arguments)}}),Q}})}};function yu(m,v,w){var _;return w.numFailures===0?v:v.type==="deleteRange"||(_=v.keys?v.keys.length:"values"in v&&v.values?v.values.length:1,w.numFailures===_)?null:(_=i({},v),u(_.keys)&&(_.keys=_.keys.filter(function(M,N){return!(N in w.failures)})),"values"in _&&u(_.values)&&(_.values=_.values.filter(function(M,N){return!(N in w.failures)})),_)}function Ro(m,v){return w=m,((_=v).lower===void 0||(_.lowerOpen?0<ue(w,_.lower):0<=ue(w,_.lower)))&&(w=m,(_=v).upper===void 0||(_.upperOpen?ue(w,_.upper)<0:ue(w,_.upper)<=0));var w,_}function ql(m,v,w,_,M,N){var j,B,V,et,$,K;return!w||w.length===0||(j=v.query.index,B=j.multiEntry,V=v.query.range,et=_.schema.primaryKey.extractKey,$=j.extractKey,K=(j.lowLevelIndex||j).extractKey,(_=w.reduce(function(Q,Z){var X=Q,Y=[];if(Z.type==="add"||Z.type==="put")for(var it=new Mn,ot=Z.values.length-1;0<=ot;--ot){var nt,pt=Z.values[ot],wt=et(pt);!it.hasKey(wt)&&(nt=$(pt),B&&u(nt)?nt.some(function(jt){return Ro(jt,V)}):Ro(nt,V))&&(it.addKey(wt),Y.push(pt))}switch(Z.type){case"add":var kt=new Mn().addKeys(v.values?Q.map(function(Et){return et(Et)}):Q),X=Q.concat(v.values?Y.filter(function(Et){return Et=et(Et),!kt.hasKey(Et)&&(kt.addKey(Et),!0)}):Y.map(function(Et){return et(Et)}).filter(function(Et){return!kt.hasKey(Et)&&(kt.addKey(Et),!0)}));break;case"put":var Ot=new Mn().addKeys(Z.values.map(function(Et){return et(Et)}));X=Q.filter(function(Et){return!Ot.hasKey(v.values?et(Et):Et)}).concat(v.values?Y:Y.map(function(Et){return et(Et)}));break;case"delete":var At=new Mn().addKeys(Z.keys);X=Q.filter(function(Et){return!At.hasKey(v.values?et(Et):Et)});break;case"deleteRange":var It=Z.range;X=Q.filter(function(Et){return!Ro(et(Et),It)})}return X},m))===m)?m:(_.sort(function(Q,Z){return ue(K(Q),K(Z))||ue(et(Q),et(Z))}),v.limit&&v.limit<1/0&&(_.length>v.limit?_.length=v.limit:m.length===v.limit&&_.length<v.limit&&(M.dirty=!0)),N?Object.freeze(_):_)}function La(m,v){return ue(m.lower,v.lower)===0&&ue(m.upper,v.upper)===0&&!!m.lowerOpen==!!v.lowerOpen&&!!m.upperOpen==!!v.upperOpen}function Nr(m,v){return((w,_,M,N)=>{if(w===void 0)return _!==void 0?-1:0;if(_===void 0)return 1;if((w=ue(w,_))===0){if(M&&N)return 0;if(M)return 1;if(N)return-1}return w})(m.lower,v.lower,m.lowerOpen,v.lowerOpen)<=0&&0<=((w,_,M,N)=>{if(w===void 0)return _!==void 0?1:0;if(_===void 0)return-1;if((w=ue(w,_))===0){if(M&&N)return 0;if(M)return-1;if(N)return 1}return w})(m.upper,v.upper,m.upperOpen,v.upperOpen)}function Rd(m,v,w,_){m.subscribers.add(w),_.addEventListener("abort",function(){var M,N;m.subscribers.delete(w),m.subscribers.size===0&&(M=m,N=v,setTimeout(function(){M.subscribers.size===0&&yt(N,M)},3e3))})}var Mo={stack:"dbcore",level:0,name:"Cache",create:function(m){var v=m.schema.name;return i(i({},m),{transaction:function(w,_,M){var N,j,B=m.transaction(w,_,M);return _==="readwrite"&&(M=(N=new AbortController).signal,B.addEventListener("abort",(j=function(V){return function(){if(N.abort(),_==="readwrite"){for(var et=new Set,$=0,K=w;$<K.length;$++){var Q=K[$],Z=Ys["idb://".concat(v,"/").concat(Q)];if(Z){var X=m.table(Q),Y=Z.optimisticOps.filter(function(Ut){return Ut.trans===B});if(B._explicit&&V&&B.mutatedParts)for(var it=0,ot=Object.values(Z.queries.query);it<ot.length;it++)for(var nt=0,pt=(Ot=ot[it]).slice();nt<pt.length;nt++)Fl((At=pt[nt]).obsSet,B.mutatedParts)&&(yt(Ot,At),At.subscribers.forEach(function(Ut){return et.add(Ut)}));else if(0<Y.length){Z.optimisticOps=Z.optimisticOps.filter(function(Ut){return Ut.trans!==B});for(var wt=0,kt=Object.values(Z.queries.query);wt<kt.length;wt++)for(var Ot,At,It,jt=0,Et=(Ot=kt[wt]).slice();jt<Et.length;jt++)(At=Et[jt]).res!=null&&B.mutatedParts&&(V&&!At.dirty?(It=Object.isFrozen(At.res),It=ql(At.res,At.req,Y,X,At,It),At.dirty?(yt(Ot,At),At.subscribers.forEach(function(Ut){return et.add(Ut)})):It!==At.res&&(At.res=It,At.promise=Lt.resolve({result:It}))):(At.dirty&&yt(Ot,At),At.subscribers.forEach(function(Ut){return et.add(Ut)})))}}}et.forEach(function(Ut){return Ut()})}}})(!1),{signal:M}),B.addEventListener("error",j(!1),{signal:M}),B.addEventListener("complete",j(!0),{signal:M})),B},table:function(w){var _=m.table(w),M=_.schema.primaryKey;return i(i({},_),{mutate:function(N){var j,B=Ft.trans;return!M.outbound&&B.db._options.cache!=="disabled"&&!B.explicit&&B.idbtrans.mode==="readwrite"&&(j=Ys["idb://".concat(v,"/").concat(w)])?(B=_.mutate(N),N.type!=="add"&&N.type!=="put"||!(50<=N.values.length||To(M,N).some(function(V){return V==null}))?(j.optimisticOps.push(N),N.mutatedParts&&_o(N.mutatedParts),B.then(function(V){0<V.numFailures&&(yt(j.optimisticOps,N),(V=yu(0,N,V))&&j.optimisticOps.push(V),N.mutatedParts)&&_o(N.mutatedParts)}),B.catch(function(){yt(j.optimisticOps,N),N.mutatedParts&&_o(N.mutatedParts)})):B.then(function(V){var et=yu(0,i(i({},N),{values:N.values.map(function($,K){var Q;return V.failures[K]?$:(P(Q=(Q=M.keyPath)!=null&&Q.includes(".")?Vt($):i({},$),M.keyPath,V.results[K]),Q)})}),V);j.optimisticOps.push(et),queueMicrotask(function(){return N.mutatedParts&&_o(N.mutatedParts)})}),B):_.mutate(N)},query:function(N){var j,B,V,et,$,K,Q;return Qs(Ft,_)&&gu("query",N)?(j=((V=Ft.trans)==null?void 0:V.db._options.cache)==="immutable",B=(V=Ft).requery,V=V.signal,K=((Z,X,Y,it)=>{var ot=Ys["idb://".concat(Z,"/").concat(X)];if(!ot)return[];if(!(Z=ot.queries[Y]))return[null,!1,ot,null];var nt=Z[(it.query?it.query.index.name:null)||""];if(!nt)return[null,!1,ot,null];switch(Y){case"query":var pt=nt.find(function(wt){return wt.req.limit===it.limit&&wt.req.values===it.values&&La(wt.req.query.range,it.query.range)});return pt?[pt,!0,ot,nt]:[nt.find(function(wt){return("limit"in wt.req?wt.req.limit:1/0)>=it.limit&&(!it.values||wt.req.values)&&Nr(wt.req.query.range,it.query.range)}),!1,ot,nt];case"count":return pt=nt.find(function(wt){return La(wt.req.query.range,it.query.range)}),[pt,!!pt,ot,nt]}})(v,w,"query",N),Q=K[0],et=K[2],$=K[3],Q&&K[1]?Q.obsSet=N.obsSet:(K=_.query(N).then(function(Z){var X=Z.result;if(Q&&(Q.res=X),j){for(var Y=0,it=X.length;Y<it;++Y)Object.freeze(X[Y]);Object.freeze(X)}else Z.result=Vt(X);return Z}).catch(function(Z){return $&&Q&&yt($,Q),Promise.reject(Z)}),Q={obsSet:N.obsSet,promise:K,subscribers:new Set,type:"query",req:N,dirty:!1},$?$.push(Q):($=[Q],(et=et||(Ys["idb://".concat(v,"/").concat(w)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[N.query.index.name||""]=$)),Rd(Q,$,B,V),Q.promise.then(function(Z){return{result:ql(Z.result,N,et?.optimisticOps,_,Q,j)}})):_.query(N)}})}})}};function kr(m,v){return new Proxy(m,{get:function(w,_,M){return _==="db"?v:Reflect.get(w,_,M)}})}Ye.prototype.version=function(m){if(isNaN(m)||m<.1)throw new Rt.Type("Given version is not a positive number");if(m=Math.round(10*m)/10,this.idbdb||this._state.isBeingOpened)throw new Rt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,m);var v=this._versions,w=v.filter(function(_){return _._cfg.version===m})[0];return w||(w=new this.Version(m),v.push(w),v.sort(kl),w.stores({}),this._state.autoSchema=!1),w},Ye.prototype._whenReady=function(m){var v=this;return this.idbdb&&(this._state.openComplete||Ft.letThrough||this._vip)?m():new Lt(function(w,_){if(v._state.openComplete)return _(new Rt.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return void _(new Rt.DatabaseClosed);v.open().catch(Xt)}v._state.dbReadyPromise.then(w,_)}).then(m)},Ye.prototype.use=function(M){var v=M.stack,w=M.create,_=M.level,M=M.name,N=(M&&this.unuse({stack:v,name:M}),this._middlewares[v]||(this._middlewares[v]=[]));return N.push({stack:v,create:w,level:_??10,name:M}),N.sort(function(j,B){return j.level-B.level}),this},Ye.prototype.unuse=function(m){var v=m.stack,w=m.name,_=m.create;return v&&this._middlewares[v]&&(this._middlewares[v]=this._middlewares[v].filter(function(M){return _?M.create!==_:!!w&&M.name!==w})),this},Ye.prototype.open=function(){var m=this;return yi(jn,function(){return _d(m)})},Ye.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var m=this._state,v=zs.indexOf(this);if(0<=v&&zs.splice(v,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}m.isBeingOpened||(m.dbReadyPromise=new Lt(function(w){m.dbReadyResolve=w}),m.openCanceller=new Lt(function(w,_){m.cancelOpen=_}))},Ye.prototype.close=function(v){var v=(v===void 0?{disableAutoOpen:!0}:v).disableAutoOpen,w=this._state;v?(w.isBeingOpened&&w.cancelOpen(new Rt.DatabaseClosed),this._close(),w.autoOpen=!1,w.dbOpenError=new Rt.DatabaseClosed):(this._close(),w.autoOpen=this._options.autoOpen||w.isBeingOpened,w.openComplete=!1,w.dbOpenError=null)},Ye.prototype.delete=function(m){var v=this,w=(m===void 0&&(m={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),_=this._state;return new Lt(function(M,N){function j(){v.close(m);var B=v._deps.indexedDB.deleteDatabase(v.name);B.onsuccess=Ke(function(){var V,et,$;V=v._deps,et=v.name,So($=V.indexedDB)||et===xr||Ll($,V.IDBKeyRange).delete(et).catch(Xt),M()}),B.onerror=vi(N),B.onblocked=v._fireOnBlocked}if(w)throw new Rt.InvalidArgument("Invalid closeOptions argument to db.delete()");_.isBeingOpened?_.dbReadyPromise.then(j):j()})},Ye.prototype.backendDB=function(){return this.idbdb},Ye.prototype.isOpen=function(){return this.idbdb!==null},Ye.prototype.hasBeenClosed=function(){var m=this._state.dbOpenError;return m&&m.name==="DatabaseClosed"},Ye.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Ye.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Ye.prototype,"tables",{get:function(){var m=this;return c(this._allTables).map(function(v){return m._allTables[v]})},enumerable:!1,configurable:!0}),Ye.prototype.transaction=function(){var m=(function(v,w,_){var M=arguments.length;if(M<2)throw new Rt.InvalidArgument("Too few arguments");for(var N=new Array(M-1);--M;)N[M-1]=arguments[M];return _=N.pop(),[v,St(N),_]}).apply(this,arguments);return this._transaction.apply(this,m)},Ye.prototype._transaction=function(m,v,w){var _,M,N=this,j=Ft.trans,B=(j&&j.db===this&&m.indexOf("!")===-1||(j=null),m.indexOf("?")!==-1);m=m.replace("!","").replace("?","");try{if(M=v.map(function(et){if(et=et instanceof N.Table?et.name:et,typeof et!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return et}),m=="r"||m===Wi)_=Wi;else{if(m!="rw"&&m!=fs)throw new Rt.InvalidArgument("Invalid transaction mode: "+m);_=fs}if(j){if(j.mode===Wi&&_===fs){if(!B)throw new Rt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");j=null}j&&M.forEach(function(et){if(j&&j.storeNames.indexOf(et)===-1){if(!B)throw new Rt.SubTransaction("Table "+et+" not included in parent transaction.");j=null}}),B&&j&&!j.active&&(j=null)}}catch(et){return j?j._promise(null,function($,K){K(et)}):Ie(et)}var V=(function et($,K,Q,Z,X){return Lt.resolve().then(function(){var nt=Ft.transless||Ft,Y=$._createTransaction(K,Q,$._dbSchema,Z),nt=(Y.explicit=!0,{trans:Y,transless:nt});if(Z)Y.idbtrans=Z.idbtrans;else try{Y.create(),Y.idbtrans._explicit=!0,$._state.PR1398_maxLoop=3}catch(pt){return pt.name===he.InvalidState&&$.isOpen()&&0<--$._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),$.close({disableAutoOpen:!1}),$.open().then(function(){return et($,K,Q,null,X)})):Ie(pt)}var it,ot=F(X),nt=(ot&&un(),Lt.follow(function(){var pt;(it=X.call(Y,Y))&&(ot?(pt=Jn.bind(null,null),it.then(pt,pt)):typeof it.next=="function"&&typeof it.throw=="function"&&(it=Dr(it)))},nt));return(it&&typeof it.then=="function"?Lt.resolve(it).then(function(pt){return Y.active?pt:Ie(new Rt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):nt.then(function(){return it})).then(function(pt){return Z&&Y._resolve(),Y._completion.then(function(){return pt})}).catch(function(pt){return Y._reject(pt),Ie(pt)})})}).bind(null,this,_,M,j,w);return j?j._promise(_,V,"lock"):Ft.trans?yi(Ft.transless,function(){return N._whenReady(V)}):this._whenReady(V)},Ye.prototype.table=function(m){if(y(this._allTables,m))return this._allTables[m];throw new Rt.InvalidTable("Table ".concat(m," does not exist"))};var ji=Ye;function Ye(m,v){var w,_,M,N,j,B=this,V=(this._middlewares={},this.verno=0,Ye.dependencies),V=(this._options=v=i({addons:Ye.addons,autoOpen:!0,indexedDB:V.indexedDB,IDBKeyRange:V.IDBKeyRange,cache:"cloned"},v),this._deps={indexedDB:v.indexedDB,IDBKeyRange:v.IDBKeyRange},v.addons),et=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:Xt,dbReadyPromise:null,cancelOpen:Xt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:v.autoOpen}),$=(et.dbReadyPromise=new Lt(function(K){et.dbReadyResolve=K}),et.openCanceller=new Lt(function(K,Q){et.cancelOpen=Q}),this._state=et,this.name=m,this.on=Ar(this,"populate","blocked","versionchange","close",{ready:[Te,Xt]}),this.once=function(K,Q){var Z=function(){for(var X=[],Y=0;Y<arguments.length;Y++)X[Y]=arguments[Y];B.on(K).unsubscribe(Z),Q.apply(B,X)};return B.on(K,Z)},this.on.ready.subscribe=O(this.on.ready.subscribe,function(K){return function(Q,Z){Ye.vip(function(){var X,Y=B._state;Y.openComplete?(Y.dbOpenError||Lt.resolve().then(Q),Z&&K(Q)):Y.onReadyBeingFired?(Y.onReadyBeingFired.push(Q),Z&&K(Q)):(K(Q),X=B,Z||K(function it(){X.on.ready.unsubscribe(Q),X.on.ready.unsubscribe(it)}))})}}),this.Collection=(w=this,Tn(Sd.prototype,function(it,Y){this.db=w;var Z=Cl,X=null;if(Y)try{Z=Y()}catch(nt){X=nt}var Y=it._ctx,it=Y.table,ot=it.hook.reading.fire;this._ctx={table:it,index:Y.index,isPrimKey:!Y.index||it.schema.primKey.keyPath&&Y.index===it.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:X,or:Y.or,valueMapper:ot!==Ce?ot:null}})),this.Table=(_=this,Tn(Tl.prototype,function(K,Q,Z){this.db=_,this._tx=Z,this.name=K,this.schema=Q,this.hook=_._allTables[K]?_._allTables[K].hook:Ar(null,{creating:[Se,Xt],reading:[On,Ce],updating:[Ct,Xt],deleting:[Bs,Xt]})})),this.Transaction=(M=this,Tn(Nl.prototype,function(K,Q,Z,X,Y){var it=this;K!=="readonly"&&Q.forEach(function(ot){ot=(ot=Z[ot])==null?void 0:ot.yProps,ot&&(Q=Q.concat(ot.map(function(nt){return nt.updatesTable})))}),this.db=M,this.mode=K,this.storeNames=Q,this.schema=Z,this.chromeTransactionDurability=X,this.idbtrans=null,this.on=Ar(this,"complete","error","abort"),this.parent=Y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Lt(function(ot,nt){it._resolve=ot,it._reject=nt}),this._completion.then(function(){it.active=!1,it.on.complete.fire()},function(ot){var nt=it.active;return it.active=!1,it.on.error.fire(ot),it.parent?it.parent._reject(ot):nt&&it.idbtrans&&it.idbtrans.abort(),Ie(ot)})})),this.Version=(N=this,Tn(Ed.prototype,function(K){this.db=N,this._cfg={version:K,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(j=this,Tn(Gs.prototype,function(K,Q,Z){if(this.db=j,this._ctx={table:K,index:Q===":id"?null:Q,or:Z},this._cmp=this._ascending=ue,this._descending=function(X,Y){return ue(Y,X)},this._max=function(X,Y){return 0<ue(X,Y)?X:Y},this._min=function(X,Y){return ue(X,Y)<0?X:Y},this._IDBKeyRange=j._deps.IDBKeyRange,!this._IDBKeyRange)throw new Rt.MissingAPI})),this.on("versionchange",function(K){0<K.newVersion?console.warn("Another connection wants to upgrade database '".concat(B.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(B.name,"'. Closing db now to resume the delete request.")),B.close({disableAutoOpen:!1})}),this.on("blocked",function(K){!K.newVersion||K.newVersion<K.oldVersion?console.warn("Dexie.delete('".concat(B.name,"') was blocked")):console.warn("Upgrade '".concat(B.name,"' blocked by other connection holding version ").concat(K.oldVersion/10))}),this._maxKey=Da(v.IDBKeyRange),this._createTransaction=function(K,Q,Z,X){return new B.Transaction(K,Q,Z,B._options.chromeTransactionDurability,X)},this._fireOnBlocked=function(K){B.on("blocked").fire(K),zs.filter(function(Q){return Q.name===B.name&&Q!==B&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire(K)})},this.use(mu),this.use(Mo),this.use(Td),this.use(Cd),this.use(pu),new Proxy(this,{get:function(K,Q,Z){var X;return Q==="_vip"||(Q==="table"?function(Y){return kr(B.table(Y),$)}:(X=Reflect.get(K,Q,Z))instanceof Tl?kr(X,$):Q==="tables"?X.map(function(Y){return kr(Y,$)}):Q==="_createTransaction"?function(){return kr(X.apply(this,arguments),$)}:X)}}));this.vip=$,V.forEach(function(K){return K(B)})}var ja,Ws=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",bu=(Do.prototype.subscribe=function(m,v,w){return this._subscribe(m&&typeof m!="function"?m:{next:m,error:v,complete:w})},Do.prototype[Ws]=function(){return this},Do);function Do(m){this._subscribe=m}try{ja={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{ja={indexedDB:null,IDBKeyRange:null}}function vu(m){var v,w=!1,_=new bu(function(M){var N=F(m),j,B=!1,V={},et={},$={get closed(){return B},unsubscribe:function(){B||(B=!0,j&&j.abort(),K&&Rn.storagemutated.unsubscribe(Z))}},K=(M.start&&M.start($),!1),Q=function(){return ds(X)},Z=function(Y){Eo(V,Y),Fl(et,V)&&Q()},X=function(){var Y,it,ot;!B&&ja.indexedDB&&(V={},Y={},j&&j.abort(),j=new AbortController,ot=(nt=>{var pt=cs();try{N&&un();var wt=$e(m,nt);return wt=N?wt.finally(Jn):wt}finally{pt&&Ni()}})(it={subscr:Y,signal:j.signal,requery:Q,querier:m,trans:null}),Promise.resolve(ot).then(function(nt){w=!0,v=nt,B||it.signal.aborted||(V={},(pt=>{for(var wt in pt)if(y(pt,wt))return;return 1})(et=Y)||K||(Rn(Ra,Z),K=!0),ds(function(){return!B&&M.next&&M.next(nt)}))},function(nt){w=!1,["DatabaseClosedError","AbortError"].includes(nt?.name)||B||ds(function(){B||M.error&&M.error(nt)})}))};return setTimeout(Q,0),$});return _.hasValue=function(){return w},_.getValue=function(){return v},_}var Zs=ji;function Gl(m){var v=ys;try{ys=!0,Rn.storagemutated.fire(m),zl(m,!0)}finally{ys=v}}x(Zs,i(i({},J),{delete:function(m){return new Zs(m,{addons:[]}).delete()},exists:function(m){return new Zs(m,{addons:[]}).open().then(function(v){return v.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(m){try{return v=Zs.dependencies,w=v.indexedDB,v=v.IDBKeyRange,(So(w)?Promise.resolve(w.databases()).then(function(_){return _.map(function(M){return M.name}).filter(function(M){return M!==xr})}):Ll(w,v).toCollection().primaryKeys()).then(m)}catch{return Ie(new Rt.MissingAPI)}var v,w},defineClass:function(){return function(m){d(this,m)}},ignoreTransaction:function(m){return Ft.trans?yi(Ft.transless,m):m()},vip:jl,async:function(m){return function(){try{var v=Dr(m.apply(this,arguments));return v&&typeof v.then=="function"?v:Lt.resolve(v)}catch(w){return Ie(w)}}},spawn:function(m,v,w){try{var _=Dr(m.apply(w,v||[]));return _&&typeof _.then=="function"?_:Lt.resolve(_)}catch(M){return Ie(M)}},currentTransaction:{get:function(){return Ft.trans||null}},waitFor:function(m,v){return m=Lt.resolve(typeof m=="function"?Zs.ignoreTransaction(m):m).timeout(v||6e4),Ft.trans?Ft.trans.waitFor(m):m},Promise:Lt,debug:{get:function(){return Fe},set:function(m){ai(m)}},derive:E,extend:d,props:x,override:O,Events:Ar,on:Rn,liveQuery:vu,extendObservabilitySet:Eo,getByKeyPath:H,setByKeyPath:P,delByKeyPath:function(m,v){typeof v=="string"?P(m,v,void 0):"length"in v&&[].map.call(v,function(w){P(m,w,void 0)})},shallowClone:rt,deepClone:Vt,getObjectDiff:Co,cmp:ue,asap:z,minKey:-1/0,addons:[],connections:zs,errnames:he,dependencies:ja,cache:Ys,semVer:"4.3.0",version:"4.3.0".split(".").map(function(m){return parseInt(m)}).reduce(function(m,v,w){return m+v/Math.pow(10,2*w)})})),Zs.maxKey=Da(Zs.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Rn(Ra,function(m){ys||(m=new CustomEvent(Vs,{detail:m}),ys=!0,dispatchEvent(m),ys=!1)}),addEventListener(Vs,function(m){m=m.detail,ys||Gl(m)}));var Pa,ys=!1,Yn=function(){};return typeof BroadcastChannel<"u"&&((Yn=function(){(Pa=new BroadcastChannel(Vs)).onmessage=function(m){return m.data&&Gl(m.data)}})(),typeof Pa.unref=="function"&&Pa.unref(),Rn(Ra,function(m){ys||Pa.postMessage(m)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(m){if(!ji.disableBfCache&&m.persisted){Fe&&console.debug("Dexie: handling persisted pagehide"),Pa?.close();for(var v=0,w=zs;v<w.length;v++)w[v].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(m){!ji.disableBfCache&&m.persisted&&(Fe&&console.debug("Dexie: handling persisted pageshow"),Yn(),Gl({all:new Mn(-1/0,[[]])}))})),Lt.rejectionMapper=function(m,v){return!m||m instanceof xt||m instanceof TypeError||m instanceof SyntaxError||!m.name||!pe[m.name]?m:(v=new pe[m.name](v||m.message,m),"stack"in m&&A(v,"stack",{get:function(){return this.inner.stack}}),v)},ai(Fe),i(ji,Object.freeze({__proto__:null,Dexie:ji,Entity:ru,PropModification:Ta,RangeSet:Mn,add:function(m){return new Ta({add:m})},cmp:ue,default:ji,liveQuery:vu,mergeRanges:Xs,rangesOverlap:hu,remove:function(m){return new Ta({remove:m})},replacePrefix:function(m,v){return new Ta({replacePrefix:[m,v]})}}),{default:ji}),ji})})(Fh)),Fh.exports}var DC=MC();const Wp=Dv(DC),Q0=Symbol.for("Dexie"),Xh=globalThis[Q0]||(globalThis[Q0]=Wp);if(Wp.semVer!==Xh.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Wp.semVer} and ${Xh.semVer}`);const{liveQuery:xR,mergeRanges:wR,rangesOverlap:SR,RangeSet:AR,cmp:ER,Entity:_R,PropModification:CR,replacePrefix:TR,add:RR,remove:MR,DexieYProvider:DR}=Xh,Om=new Xh("WiseMarkDB");Om.version(1).stores({pdfs:"hash, filename, size, blob"});async function Dx(r){const t=await crypto.subtle.digest("SHA-256",r);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}async function Lm(r,t,e,i){await Om.pdfs.put({hash:r,filename:t,size:e,blob:i})}async function NC(r){const t=await Om.pdfs.get(r);return t?{data:t.blob,filename:t.filename,size:t.size}:null}async function kC(r){if(!r?.pdf_hash)return null;try{const{data:t}=await Hn.getPdf(r.id),e=(t instanceof ArrayBuffer,t),i=r.file_size??e?.byteLength??0;return await Lm(r.pdf_hash,r.filename||"",i,e),{data:e,filename:r.filename||"",size:i}}catch{const t=await NC(r.pdf_hash);return t||null}}const _s=["#f59e0b","#3b82f6","#10b981","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316"];function Tp(r){if(!r)return null;const t=new Date(r);return Number.isNaN(t.getTime())?null:t.toLocaleDateString("en-GB",{day:"numeric",month:"short",year:"numeric"})}function OC(){const{projectId:r}=ym(),t=wa(),e=so(),[i,a]=U.useState(!1),[l,c]=U.useState(""),[u,d]=U.useState(null),[f,p]=U.useState(""),[y,x]=U.useState(!1),[S,A]=U.useState(""),[E,R]=U.useState(null),[D,k]=U.useState(""),[O,I]=U.useState(null),[z,H]=U.useState(_s[0]),P=U.useRef(null),rt=U.useRef(null),ut=U.useRef(null),[St,_t]=U.useState(0),{data:Mt,isLoading:Vt}=is({queryKey:["project",r],queryFn:async()=>{const{data:Nt}=await Bc.get(r);return Nt},enabled:!!r}),{data:vt,isLoading:Ht}=is({queryKey:["documents",r],queryFn:async()=>{const{data:Nt}=await Hn.list({project:r});return Nt},enabled:!!r}),G=Array.isArray(vt)?vt:vt?.results??[],ct=Mi({mutationFn:({id:Nt,name:Se})=>Bc.update(Nt,{name:Se}),onSuccess:()=>{e.invalidateQueries({queryKey:["project",r]}),e.invalidateQueries({queryKey:["projects"]}),x(!1)}}),yt=Mi({mutationFn:({id:Nt,filename:Se})=>Hn.update(Nt,{filename:Se}),onSuccess:()=>{e.invalidateQueries({queryKey:["documents",r]}),d(null),p("")}}),Tt=Mi({mutationFn:Nt=>Hn.delete(Nt),onSuccess:()=>e.invalidateQueries({queryKey:["documents",r]})}),Pt=Mi({mutationFn:Nt=>Bc.delete(Nt),onSuccess:()=>{e.invalidateQueries({queryKey:["projects"]}),t("/app",{replace:!0})}}),F=async Nt=>{const Se=Nt.target.files?.[0];if(!Se||!Se.type.includes("pdf"))return;c(""),R(Se);const Bs=Se.name.replace(/\.pdf$/i,"")||Se.name;k(Bs),H(_s[G.length%_s.length]),I(null),P.current=null;try{const Ct=await Se.arrayBuffer(),ne=await Dx(Ct),Te={arrayBuffer:Ct,hash:ne,size:Se.size};I(Te),P.current={...Te,suggestedName:Bs}}catch(Ct){c(Ct.message||"Could not read file"),R(null),k("")}},J=()=>{R(null),k(""),I(null),H(_s[0]),c(""),P.current=null,_t(Nt=>Nt+1)},ht=()=>{ut.current?.click()},xt=async Nt=>{Nt.preventDefault();const Se=r,Ct=rt.current?.value?.trim()||D?.trim()||P.current?.suggestedName?.trim()||"",ne=P.current||O;if(!Se){c("Project not found.");return}if(!Ct){c("Please enter a name for the PDF.");return}if(!ne||!ne.hash||!ne.arrayBuffer){c("File data missing. Please close and select the file again.");return}const Te=Ct.toLowerCase().endsWith(".pdf")?Ct:`${Ct}.pdf`;c(""),a(!0);try{const Fe=new FormData;Fe.append("project",String(Se)),Fe.append("filename",Te),Fe.append("color",z),Fe.append("file",new Blob([ne.arrayBuffer]),Te),await Hn.createWithFile(Fe),await Lm(ne.hash,Te,ne.size,ne.arrayBuffer),e.invalidateQueries({queryKey:["documents",Se]}),R(null),k(""),I(null),P.current=null,_t(ai=>ai+1)}catch(Fe){const ai=Fe.response?.data?.detail||typeof Fe.response?.data=="object"&&Object.values(Fe.response?.data||{}).flat().join(" ")||Fe.message||"Upload failed";c(String(ai))}finally{a(!1)}},Dt=Nt=>{d(Nt.id),p(Nt.filename||"")},qt=()=>{if(u==null||!f.trim()){d(null);return}yt.mutate({id:u,filename:f.trim()})},Bt=()=>{d(null),p("")},he=()=>{A(Mt?.name??""),x(!0)},de=()=>{const Nt=S.trim();if(!Nt||Nt===Mt?.name){x(!1);return}ct.mutate({id:r,name:Nt})},Rt=()=>{x(!1),A("")},pe=Sa(Nt=>Nt.logout),{data:Xt}=is({queryKey:["me"],queryFn:async()=>{const{data:Nt}=await ml.me();return Nt}}),Ce=(Xt?.email?.[0]||Xt?.username?.[0]||"?").toUpperCase(),On=Mt?.color&&_s.includes(Mt.color)?Mt.color:Mt?_s[Mt.id%_s.length]:_s[0];return Vt||!Mt?C.jsx("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:C.jsx(Os,{className:"w-8 h-8 animate-spin text-slate-400"})}):C.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif",color:"#1e293b"},children:[C.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&family=JetBrains+Mono:wght@400;500&display=swap",rel:"stylesheet"}),C.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{type:"button",onClick:()=>t("/app"),className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Back to projects",children:C.jsx(od,{className:"w-4 h-4"})}),C.jsx("div",{className:"w-6 h-6 rounded-md bg-slate-700 flex items-center justify-center text-white text-xs font-semibold",style:{fontFamily:"'DM Sans', sans-serif"},children:"W"}),C.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{type:"button",onClick:()=>{pe(),t("/login",{replace:!0})},className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:C.jsx(km,{className:"w-4 h-4"})}),C.jsx("button",{type:"button",onClick:()=>t("/app/settings"),className:"w-8 h-8 rounded-full bg-slate-700 text-white flex items-center justify-center text-[13px] font-semibold hover:bg-slate-600 transition-colors cursor-pointer",title:"Account settings",children:Ce})]})]}),C.jsxs("div",{className:"max-w-[720px] mx-auto px-6 py-10",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsxs("div",{className:"flex items-start justify-between mb-2",children:[C.jsx("div",{className:"flex items-center gap-2 min-w-0",children:y?C.jsxs(C.Fragment,{children:[C.jsx("input",{type:"text",value:S,onChange:Nt=>A(Nt.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900 min-w-0 flex-1 max-w-md text-[28px]",style:{fontFamily:"'Instrument Serif', serif",fontWeight:700,letterSpacing:"0.01em"},autoFocus:!0,onKeyDown:Nt=>{Nt.key==="Enter"&&de(),Nt.key==="Escape"&&Rt()}}),C.jsx("button",{type:"button",onClick:de,className:"p-2 text-green-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Save",children:C.jsx($0,{className:"w-5 h-5"})}),C.jsx("button",{type:"button",onClick:Rt,className:"p-2 text-slate-500 hover:bg-slate-100 rounded-lg shrink-0",title:"Cancel",children:C.jsx($h,{className:"w-5 h-5"})})]}):C.jsxs(C.Fragment,{children:[C.jsx("h1",{className:"m-0 text-[28px] text-slate-950 truncate",style:{fontFamily:"'Instrument Serif', serif",fontWeight:700,letterSpacing:"0.01em"},children:Mt.name}),C.jsx("button",{type:"button",onClick:he,className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Edit project name",children:C.jsx(Yp,{className:"w-4 h-4"})}),C.jsx("button",{type:"button",onClick:()=>{window.confirm(`Delete project "${Mt.name}" and all its documents? This cannot be undone.`)&&Pt.mutate(r)},className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg shrink-0",title:"Delete project",disabled:Pt.isPending,children:C.jsx(zc,{className:"w-4 h-4"})})]})}),C.jsxs("button",{type:"button",onClick:ht,disabled:i,className:"flex items-center gap-1.5 px-4 py-2 text-sm font-medium rounded-lg text-white transition-colors hover:bg-slate-700 shrink-0 disabled:opacity-70",style:{background:"#1e293b",fontFamily:"'DM Sans', sans-serif"},children:[C.jsx(Qp,{className:"w-4 h-4"}),"Add PDF"]})]}),C.jsx("div",{className:"flex items-center gap-3 text-xs text-slate-400 mb-6 uppercase",style:{fontFamily:"'JetBrains Mono', monospace",letterSpacing:"0.08em"},children:C.jsxs("span",{children:[G.length," document",G.length!==1?"s":""]})}),C.jsx("input",{ref:ut,type:"file",accept:".pdf",onChange:F,className:"hidden","aria-hidden":"true",tabIndex:-1},St),l&&C.jsx("p",{className:"text-sm text-red-600 mb-4",children:l}),i&&C.jsxs("p",{className:"flex items-center gap-2 text-sm text-slate-600 mb-4",children:[C.jsx(Os,{className:"w-4 h-4 animate-spin"})," Uploading..."]}),Ht?C.jsxs("div",{className:"flex items-center gap-2 text-slate-500 py-12",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsx(Os,{className:"w-5 h-5 animate-spin"})," Loading PDFs"]}):G.length===0?C.jsxs("div",{className:"rounded-xl border border-slate-200 p-8 text-center text-slate-500",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsx(Mx,{className:"w-12 h-12 mx-auto mb-3 text-slate-400"}),C.jsx("p",{children:"No PDFs in this project yet. Add a PDF above."})]}):C.jsx("ul",{className:"space-y-2",children:G.map(Nt=>C.jsx("li",{className:"rounded-xl border border-slate-200 bg-white overflow-hidden transition-all duration-200 hover:shadow-[0_4px_12px_rgba(71,85,105,0.08)] hover:-translate-y-px cursor-pointer",children:u===Nt.id?C.jsxs("div",{className:"flex items-center gap-2 px-5 py-3",children:[C.jsx("input",{type:"text",value:f,onChange:Se=>p(Se.target.value),className:"flex-1 min-w-0 border border-slate-200 rounded-lg px-3 py-2 text-slate-900",autoFocus:!0,onKeyDown:Se=>{Se.key==="Enter"&&qt(),Se.key==="Escape"&&Bt()}}),C.jsx("button",{type:"button",onClick:qt,className:"p-2.5 text-green-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Save",children:C.jsx($0,{className:"w-4 h-4"})}),C.jsx("button",{type:"button",onClick:Bt,className:"p-2.5 text-slate-500 hover:bg-slate-100 rounded-lg shrink-0",title:"Cancel",children:C.jsx($h,{className:"w-4 h-4"})})]}):C.jsxs("div",{className:"flex items-center gap-4 px-5 py-3 cursor-pointer",onClick:()=>t(`/document/${Nt.id}`),children:[C.jsx("div",{className:"shrink-0 rounded-sm",style:{width:4,height:40,background:Nt.color&&_s.includes(Nt.color)?Nt.color:On}}),C.jsxs("div",{className:"flex-1 min-w-0 py-1 flex flex-col items-start gap-0.5",children:[C.jsx("span",{className:"text-base font-normal text-slate-900 truncate block w-full",style:{fontFamily:"'Instrument Serif', serif"},children:Nt.filename}),C.jsxs("span",{className:"text-xs text-slate-400 block",style:{fontFamily:"'JetBrains Mono', monospace"},children:[Nt.file_size!=null&&`${(Nt.file_size/1024).toFixed(1)} KB`,Nt.file_size!=null&&Tp(Nt.created_at)&&"  ",Tp(Nt.created_at)?`Uploaded ${Tp(Nt.created_at)}`:null]})]}),C.jsx("button",{type:"button",onClick:Se=>{Se.stopPropagation(),Dt(Nt)},className:"p-2 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Rename",children:C.jsx(Yp,{className:"w-4 h-4"})}),C.jsx("button",{type:"button",onClick:Se=>{Se.stopPropagation(),confirm("Delete this PDF?")&&Tt.mutate(Nt.id)},className:"p-2 text-slate-400 hover:text-red-600 hover:bg-red-50 rounded-lg shrink-0",title:"Delete",children:C.jsx(zc,{className:"w-4 h-4"})})]})},Nt.id))})]}),E&&C.jsx("div",{className:"fixed inset-0 z-[1000] flex items-center justify-center p-4 bg-slate-950/40 backdrop-blur-sm",onClick:J,children:C.jsxs("div",{className:"rounded-xl bg-white border border-slate-200 shadow-xl w-full max-w-md p-6",onClick:Nt=>Nt.stopPropagation(),children:[C.jsx("h2",{className:"m-0 text-xl font-normal text-slate-900 mb-4",style:{fontFamily:"'Instrument Serif', serif"},children:"Name this PDF"}),O?C.jsxs("div",{className:"space-y-4",children:[l&&C.jsx("p",{className:"text-sm text-red-600 bg-red-50 rounded-lg px-3 py-2",children:l}),C.jsx("input",{ref:rt,type:"text",value:D,onChange:Nt=>k(Nt.target.value),placeholder:"Document name",className:"w-full border border-slate-200 rounded-lg px-3 py-2.5 text-slate-900",autoFocus:!0,disabled:i}),C.jsx("label",{className:"block text-[13px] font-medium text-slate-600 mb-2 uppercase tracking-wider",style:{fontFamily:"'JetBrains Mono', monospace"},children:"Colour"}),C.jsx("div",{className:"flex gap-2",children:_s.map(Nt=>C.jsx("button",{type:"button",onClick:()=>H(Nt),disabled:i,className:"w-7 h-7 rounded-full shrink-0 transition-all border-2 border-transparent focus:outline-none focus:ring-2 focus:ring-slate-400 focus:ring-offset-2 disabled:opacity-60",style:{background:Nt,borderColor:z===Nt?"#1e293b":"transparent",outline:z===Nt?"2px solid #fff":"none",outlineOffset:-4}},Nt))}),C.jsxs("div",{className:"flex justify-end gap-3 pt-2",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsx("button",{type:"button",onClick:J,disabled:i,className:"px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:"Cancel"}),C.jsx("button",{type:"button",onClick:Nt=>{Nt.preventDefault(),xt(Nt)},disabled:i||!D.trim(),className:"px-4 py-2 text-sm font-medium rounded-lg text-white hover:bg-slate-700",style:{background:"#1e293b"},children:i?C.jsxs("span",{className:"inline-flex items-center gap-2",children:[C.jsx(Os,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Upload & save"})]})]}):C.jsxs("div",{className:"flex items-center gap-2 text-slate-600 py-4",children:[C.jsx(Os,{className:"w-5 h-5 animate-spin shrink-0"}),C.jsx("span",{children:"Reading file..."})]})]})})]})}const $i={yellow:{key:"yellow",label:"Yellow",name:"Key Metrics",hex:"#EAB308",rgba:"rgba(254, 243, 199, 0.5)",rgbaSoft:"rgba(234,179,8,0.18)",rgbaHover:"rgba(234,179,8,0.38)",solid:"#fbbf24"},green:{key:"green",label:"Green",name:"Competitive Advantages",hex:"#22C55E",rgba:"rgba(209, 250, 229, 0.5)",rgbaSoft:"rgba(34,197,94,0.18)",rgbaHover:"rgba(34,197,94,0.38)",solid:"#10b981"},blue:{key:"blue",label:"Blue",name:"Management Questions",hex:"#3B82F6",rgba:"rgba(219, 234, 254, 0.5)",rgbaSoft:"rgba(59,130,246,0.18)",rgbaHover:"rgba(59,130,246,0.38)",solid:"#3b82f6"},pink:{key:"pink",label:"Pink",name:"Investment Risks",hex:"#EC4899",rgba:"rgba(252, 231, 243, 0.5)",rgbaSoft:"rgba(236,72,153,0.18)",rgbaHover:"rgba(236,72,153,0.38)",solid:"#ec4899"},orange:{key:"orange",label:"Orange",name:"Commercial DD",hex:"#F97316",rgba:"rgba(254, 215, 170, 0.5)",rgbaSoft:"rgba(249,115,22,0.18)",rgbaHover:"rgba(249,115,22,0.38)",solid:"#f59e0b"}},jm=Object.keys($i);function W0(r,t=1){if(!r||!r.startsWith("#"))return`rgba(148,163,184,${t})`;const e=parseInt(r.slice(1),16),i=e>>16&255,a=e>>8&255,l=e&255;return`rgba(${i},${a},${l},${t})`}function Ns(r,t={},e){if(t&&typeof t[r]=="string"&&t[r].trim())return t[r].trim();if(e?.length){const i=e.find(a=>a.key===r);if(i?.display_name)return i.display_name}return $i[r]&&$i[r].name||r}const ni=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Zp=[.001,0,0,.001,0,0],Rp=1.35,Ci={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},rr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Hc="pdfjs_internal_editor_",oe={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},we={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},LC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Jp={TRIANGLES:1,LATTICE:2},En={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Ih={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},Sn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},il={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ld={ERRORS:0,WARNINGS:1,INFOS:5},qc={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Tc={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},jC={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let cd=ld.WARNINGS;function PC(r){Number.isInteger(r)&&(cd=r)}function BC(){return cd}function ud(r){cd>=ld.INFOS&&console.info(`Info: ${r}`)}function ie(r){cd>=ld.WARNINGS&&console.warn(`Warning: ${r}`)}function Le(r){throw new Error(r)}function Oe(r,t){r||Le(t)}function FC(r){switch(r?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Nx(r,t=null,e=null){if(!r)return null;if(e&&typeof r=="string"&&(e.addDefaultProtocol&&r.startsWith("www.")&&r.match(/\./g)?.length>=2&&(r=`http://${r}`),e.tryConvertEncoding))try{r=GC(r)}catch{}const i=t?URL.parse(r,t):URL.parse(r);return FC(i)?i:null}function kx(r,t,e=!1){const i=URL.parse(r);return i?(i.hash=t,i.href):e&&Nx(r,"http://example.com")?r.split("#",1)[0]+`${t?`#${t}`:""}`:""}function se(r,t,e,i=!1){return Object.defineProperty(r,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const ao=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class Z0 extends ao{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Mp extends ao{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class tm extends ao{constructor(t){super(t,"InvalidPDFException")}}class Yh extends ao{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class IC extends ao{constructor(t){super(t,"FormatError")}}class cr extends ao{constructor(t){super(t,"AbortException")}}function UC(r){(typeof r!="object"||r?.length===void 0)&&Le("Invalid argument for bytesToString");const t=r.length,e=8192;if(t<e)return String.fromCharCode.apply(null,r);const i=[];for(let a=0;a<t;a+=e){const l=Math.min(a+e,t),c=r.subarray(a,l);i.push(String.fromCharCode.apply(null,c))}return i.join("")}function hd(r){typeof r!="string"&&Le("Invalid argument for stringToBytes");const t=r.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=r.charCodeAt(i)&255;return e}function zC(r){return String.fromCharCode(r>>24&255,r>>16&255,r>>8&255,r&255)}function HC(){const r=new Uint8Array(4);return r[0]=1,new Uint32Array(r.buffer,0,1)[0]===1}function qC(){try{return new Function(""),!0}catch{return!1}}class Cn{static get isLittleEndian(){return se(this,"isLittleEndian",HC())}static get isEvalSupported(){return se(this,"isEvalSupported",qC())}static get isOffscreenCanvasSupported(){return se(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return se(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return se(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return se(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return se(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return se(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Dp=Array.from(Array(256).keys(),r=>r.toString(16).padStart(2,"0"));class zt{static makeHexColor(t,e,i){return`#${Dp[t]}${Dp[e]}${Dp[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const a=t[i],l=t[i+1];t[i]=a*e[0]+l*e[2]+e[4],t[i+1]=a*e[1]+l*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5];for(let p=0;p<6;p+=2){const y=t[i+p],x=t[i+p+1];t[i+p]=y*a+x*c+d,t[i+p+1]=y*l+x*u+f}}static applyInverseTransform(t,e){const i=t[0],a=t[1],l=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-a*e[2]+e[2]*e[5]-e[4]*e[3])/l,t[1]=(-i*e[1]+a*e[0]+e[4]*e[1]-e[5]*e[0])/l}static axialAlignedBoundingBox(t,e,i){const a=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5],p=t[0],y=t[1],x=t[2],S=t[3];let A=a*p+d,E=A,R=a*x+d,D=R,k=u*y+f,O=k,I=u*S+f,z=I;if(l!==0||c!==0){const H=l*p,P=l*x,rt=c*y,ut=c*S;A+=rt,D+=rt,R+=ut,E+=ut,k+=H,z+=H,I+=P,O+=P}i[0]=Math.min(i[0],A,R,E,D),i[1]=Math.min(i[1],k,I,O,z),i[2]=Math.max(i[2],A,R,E,D),i[3]=Math.max(i[3],k,I,O,z)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],a=t[1],l=t[2],c=t[3],u=i**2+a**2,d=i*l+a*c,f=l**2+c**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-d**2));e[0]=Math.sqrt(p+y||1),e[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),a=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>a)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return l>c?null:[i,l,a,c]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,a,l){l[0]=Math.min(l[0],t,i),l[1]=Math.min(l[1],e,a),l[2]=Math.max(l[2],t,i),l[3]=Math.max(l[3],e,a)}static#t(t,e,i,a,l,c,u,d,f,p){if(f<=0||f>=1)return;const y=1-f,x=f*f,S=x*f,A=y*(y*(y*t+3*f*e)+3*x*i)+S*a,E=y*(y*(y*l+3*f*c)+3*x*u)+S*d;p[0]=Math.min(p[0],A),p[1]=Math.min(p[1],E),p[2]=Math.max(p[2],A),p[3]=Math.max(p[3],E)}static#e(t,e,i,a,l,c,u,d,f,p,y,x){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,i,a,l,c,u,d,-y/p,x);return}const S=p**2-4*y*f;if(S<0)return;const A=Math.sqrt(S),E=2*f;this.#t(t,e,i,a,l,c,u,d,(-p+A)/E,x),this.#t(t,e,i,a,l,c,u,d,(-p-A)/E,x)}static bezierBoundingBox(t,e,i,a,l,c,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,i,l,u,e,a,c,d,3*(-t+3*(i-l)+u),6*(t-2*i+l),3*(i-t),f),this.#e(t,i,l,u,e,a,c,d,3*(-e+3*(a-c)+d),6*(e-2*a+c),3*(a-e),f)}}function GC(r){return decodeURIComponent(escape(r))}let Np=null,J0=null;function KC(r){return Np||(Np=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,J0=new Map([["","t"]])),r.replaceAll(Np,(t,e,i)=>e?e.normalize("NFKC"):J0.get(i))}function Ox(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const r=new Uint8Array(32);return crypto.getRandomValues(r),UC(r)}const rl="pdfjs_internal_id_";function VC(r,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,a,...l]=e;if(!r(i)&&!Number.isInteger(i)||!t(a))return!1;const c=l.length;let u=!0;switch(a.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const d of l)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function qn(r,t,e){return Math.min(Math.max(r,t),e)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(r){return r.reduce((t,e)=>t+e,0)});class Gc{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function a(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(Gc.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&e.push({str:c}),!!l.children)for(const d of l.children)a(d)}return a(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Lx{static setupStorage(t,e,i,a,l){const c=a.getValue(e,{value:null});switch(i.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(c.value===i.attributes.xfaOn?t.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{a.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{a.setValue(e,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of i.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;a.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:a,linkService:l}){const{attributes:c}=e,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${a}`);for(const[d,f]of Object.entries(c))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(t,c.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,a=t.xfaHtml,l=t.intent||"display",c=document.createElement(a.name);a.attributes&&this.setAttributes({html:c,element:a,intent:l,linkService:i});const u=l!=="richText",d=t.div;if(d.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=y}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(a.children.length===0){if(a.value){const y=document.createTextNode(a.value);c.append(y),u&&Gc.shouldBuildText(a.name)&&f.push(y)}return{textDivs:f}}const p=[[a,-1,c]];for(;p.length>0;){const[y,x,S]=p.at(-1);if(x+1===y.children.length){p.pop();continue}const A=y.children[++p.at(-1)[1]];if(A===null)continue;const{name:E}=A;if(E==="#text"){const D=document.createTextNode(A.value);f.push(D),S.append(D);continue}const R=A?.attributes?.xmlns?document.createElementNS(A.attributes.xmlns,E):document.createElement(E);if(S.append(R),A.attributes&&this.setAttributes({html:R,element:A,storage:e,intent:l,linkService:i}),A.children?.length>0)p.push([A,-1,R]);else if(A.value){const D=document.createTextNode(A.value);u&&Gc.shouldBuildText(E)&&f.push(D),R.append(D)}}for(const y of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const pa="http://www.w3.org/2000/svg";class yl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function tu(r,t="text"){if(Lc(r,document.baseURI)){const e=await fetch(r);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const a=new XMLHttpRequest;a.open("GET",r,!0),a.responseType=t,a.onreadystatechange=()=>{if(a.readyState===XMLHttpRequest.DONE){if(a.status===200||a.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(a.response);return}e(a.responseText);return}i(new Error(a.statusText))}},a.send(null)})}class eu{constructor({viewBox:t,userUnit:e,scale:i,rotation:a,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=a,this.offsetX=l,this.offsetY=c,i*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,x,S;switch(a%=360,a<0&&(a+=360),a){case 180:p=-1,y=0,x=0,S=1;break;case 90:p=0,y=1,x=1,S=0;break;case 270:p=0,y=-1,x=-1,S=0;break;case 0:p=1,y=0,x=0,S=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(x=-x,S=-S);let A,E,R,D;p===0?(A=Math.abs(f-t[1])*i+l,E=Math.abs(d-t[0])*i+c,R=(t[3]-t[1])*i,D=(t[2]-t[0])*i):(A=Math.abs(d-t[0])*i+l,E=Math.abs(f-t[1])*i+c,R=(t[2]-t[0])*i,D=(t[3]-t[1])*i),this.transform=[p*i,y*i,x*i,S*i,A-p*i*d-x*i*f,E-y*i*d-S*i*f],this.width=R,this.height=D}get rawDims(){const t=this.viewBox;return se(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:a=this.offsetY,dontFlip:l=!1}={}){return new eu({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}convertToViewportPoint(t,e){const i=[t,e];return zt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];zt.applyTransform(e,this.transform);const i=[t[2],t[3]];return zt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return zt.applyInverseTransform(i,this.transform),i}}class Pm extends ao{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function dd(r){const t=r.length;let e=0;for(;e<t&&r[e].trim()==="";)e++;return r.substring(e,e+5).toLowerCase()==="data:"}function Bm(r){return typeof r=="string"&&/\.pdf$/i.test(r)}function $C(r){return[r]=r.split(/[#?]/,1),r.substring(r.lastIndexOf("/")+1)}function XC(r,t="document.pdf"){if(typeof r!="string")return t;if(dd(r))return ie('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(r);if(!i)return t;const a=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},l=/\.pdf$/i,c=i.pathname.split("/").at(-1);if(l.test(c))return a(c);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const f of u)if(l.test(f))return a(f);const d=Array.from(i.searchParams.keys()).reverse();for(const f of d)if(l.test(f))return a(f)}if(i.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(d)return a(d[0])}return t}class tv{started=Object.create(null);times=[];time(t){t in this.started&&ie(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ie(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:a,end:l}of this.times)t.push(`${i.padEnd(e)} ${l-a}ms
`);return t.join("")}}function Lc(r,t){const e=t?URL.parse(r,t):URL.parse(r);return e?.protocol==="http:"||e?.protocol==="https:"}function Xi(r){r.preventDefault()}function on(r){r.preventDefault(),r.stopPropagation()}function YC(r){console.log("Deprecated API usage: "+r)}class em{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let a=parseInt(e[2],10);a=a>=1&&a<=12?a-1:0;let l=parseInt(e[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(e[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=p,u+=y):f==="+"&&(c-=p,u-=y),new Date(Date.UTC(i,a,l,c,u,d))}}function QC(r,{scale:t=1,rotation:e=0}){const{width:i,height:a}=r.attributes.style,l=[0,0,parseInt(i),parseInt(a)];return new eu({viewBox:l,userUnit:1,scale:t,rotation:e})}function nu(r){if(r.startsWith("#")){const t=parseInt(r.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return r.startsWith("rgb(")?r.slice(4,-1).split(",").map(t=>parseInt(t)):r.startsWith("rgba(")?r.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ie(`Not a valid color format: "${r}"`),[0,0,0])}function WC(r){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of r.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;r.set(e,nu(i))}t.remove()}function nn(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform();return[t,e,i,a,l,c]}function Cs(r){const{a:t,b:e,c:i,d:a,e:l,f:c}=r.getTransform().invertSelf();return[t,e,i,a,l,c]}function no(r,t,e=!1,i=!0){if(t instanceof eu){const{pageWidth:a,pageHeight:l}=t.rawDims,{style:c}=r,u=Cn.isCSSRoundSupported,d=`var(--total-scale-factor) * ${a}px`,f=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(c.width=p,c.height=y):(c.width=y,c.height=p)}i&&r.setAttribute("data-main-rotation",t.rotation)}class Ps{constructor(){const{pixelRatio:t}=Ps;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,a,l=-1){let c=1/0,u=1/0,d=1/0;i=Ps.capPixels(i,l),i>0&&(c=Math.sqrt(i/(t*e))),a!==-1&&(u=a/t,d=a/e);const f=Math.min(c,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const nm=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class ZC{static get isDarkMode(){return se(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class JC{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),se(this,"commentForegroundColor",nu(i))}}function tT(r,t,e,i){i=Math.min(Math.max(i??1,0),1);const a=255*(1-i);return r=Math.round(r*i+a),t=Math.round(t*i+a),e=Math.round(e*i+a),[r,t,e]}function ev(r,t){const e=r[0]/255,i=r[1]/255,a=r[2]/255,l=Math.max(e,i,a),c=Math.min(e,i,a),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const d=l-c;switch(t[1]=u<.5?d/(l+c):d/(2-l-c),l){case e:t[0]=((i-a)/d+(i<a?6:0))*60;break;case i:t[0]=((a-e)/d+2)*60;break;case a:t[0]=((e-i)/d+4)*60;break}}t[2]=u}function im(r,t){const e=r[0],i=r[1],a=r[2],l=(1-Math.abs(2*a-1))*i,c=l*(1-Math.abs(e/60%2-1)),u=a-l/2;switch(Math.floor(e/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function nv(r){return r<=.03928?r/12.92:((r+.055)/1.055)**2.4}function iv(r,t,e){im(r,e),e.map(nv);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];im(t,e),e.map(nv);const a=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>a?(i+.05)/(a+.05):(a+.05)/(i+.05)}const sv=new Map;function eT(r,t){const e=r[0]+r[1]*256+r[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=sv.get(e);if(i)return i;const a=new Float32Array(9),l=a.subarray(0,3),c=a.subarray(3,6);ev(r,c);const u=a.subarray(6,9);ev(t,u);const d=u[2]<.5,f=d?12:4.5;if(c[2]=d?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),iv(c,u,l)<f){let p,y;d?(p=c[2],y=1):(p=0,y=c[2]);const x=.005;for(;y-p>x;){const S=c[2]=(p+y)/2;d===iv(c,u,l)<f?p=S:y=S}c[2]=d?y:p}return im(c,l),i=zt.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),sv.set(e,i),i}function jx({html:r,dir:t,className:e},i){const a=document.createDocumentFragment();if(typeof r=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=r.split(/(?:\r\n?|\n)/);for(let u=0,d=c.length;u<d;++u){const f=c[u];l.append(document.createTextNode(f)),u<d-1&&l.append(document.createElement("br"))}a.append(l)}else Lx.render({xfaHtml:r,div:a,intent:"richText"});a.firstElementChild.classList.add("richText",e),i.append(a)}function Px(r){const t=new Path2D;if(!r)return t;for(let e=0,i=r.length;e<i;)switch(r[e++]){case Tc.moveTo:t.moveTo(r[e++],r[e++]);break;case Tc.lineTo:t.lineTo(r[e++],r[e++]);break;case Tc.curveTo:t.bezierCurveTo(r[e++],r[e++],r[e++],r[e++],r[e++],r[e++]);break;case Tc.quadraticCurveTo:t.quadraticCurveTo(r[e++],r[e++],r[e++],r[e++]);break;case Tc.closePath:t.closePath();break;default:ie(`Unrecognized drawing path operator: ${r[e-1]}`);break}return t}class Ne{static#t=null;static#e=null;static#i=null;static#n=0;static#s=[];get pagesNumber(){return Ne.#n}set pagesNumber(t){Ne.#n!==t&&(Ne.#n=t,t===0&&(Ne.#e=null,Ne.#t=null))}addListener(t){Ne.#s.push(t)}removeListener(t){const e=Ne.#s.indexOf(t);e>=0&&Ne.#s.splice(e,1)}#r(){for(const t of Ne.#s)t()}#a(t){if(Ne.#e)return;const e=Ne.#n,i=new Uint32Array(3*e),a=Ne.#e=i.subarray(0,e),l=Ne.#t=i.subarray(e,2*e);if(t)for(let c=0;c<e;c++)a[c]=l[c]=c+1;Ne.#i=i.subarray(2*e)}movePages(t,e,i){this.#a(!0);const a=Ne.#e,l=Ne.#t;Ne.#i.set(l);const c=e.length,u=new Uint32Array(c);let d=0;for(let S=0;S<c;S++){const A=e[S]-1;u[S]=a[A],A<i&&(d+=1)}const f=Ne.#n;let p=i-d;const y=f-c;p=qn(p,0,y);for(let S=0,A=0;S<f;S++)t.has(S+1)||(a[A++]=a[S]);a.copyWithin(p+c,p,y),a.set(u,p);let x=!1;for(let S=0,A=f;S<A;S++){const E=a[S];x||=E!==S+1,l[E-1]=S+1}this.#r(),x||(this.pagesNumber=0)}hasBeenAltered(){return Ne.#e!==null}getPageMappingForSaving(){return{pageIndices:Ne.#t?Ne.#t.map(t=>t-1):null}}getPrevPageNumber(t){return Ne.#i[Ne.#e[t-1]-1]}getPageNumber(t){return Ne.#t?.[t-1]??t}getPageId(t){return Ne.#e?.[t-1]??t}static get instance(){return se(this,"instance",new Ne)}getMapping(){return Ne.#e.subarray(0,this.pagesNumber)}}class Fc{#t=null;#e=null;#i;#n=null;#s=null;#r=null;#a=null;#o=null;static#c=null;constructor(t){this.#i=t,Fc.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",Xi,{signal:e}),t.addEventListener("pointerdown",Fc.#l,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const a=this.#i.toolbarPosition;if(a){const{style:l}=t,c=this.#i._uiManager.direction==="ltr"?1-a[0]:a[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*a[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,on(t)}#h(t){this.#i._focusEventsAllowed=!0,on(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",Xi,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#r?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",Fc.#c[t]),this.#f(i)&&i.addEventListener("click",a=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#g),this.#s=t}addComment(t,e=null){if(this.#r)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const a=this.#a=this.#g;e?(this.#n.insertBefore(i,e),this.#n.insertBefore(a,e)):this.#n.append(i,a),this.#r=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#g)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#g)}removeButton(t){t==="comment"&&(this.#r?.removeToolbarCommentButton(),this.#r=null,this.#a?.remove(),this.#a=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const a=this.#n.querySelector(i);a&&t==="comment"&&this.addComment(e,a)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class nT{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",Xi,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#r("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#r("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#s(t,e){let i=0,a=0;for(const l of t){const c=l.y+l.height;if(c<i)continue;const u=l.x+(e?l.width:0);if(c>i){a=u,i=c;continue}e?u>a&&(a=u):u<a&&(a=u)}return[e?1-a:a,i]}show(t,e,i){const[a,l]=this.#s(e,i),{style:c}=this.#e||=this.#n();t.append(this.#e),c.insetInlineEnd=`${100*a}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#r(t,e,i,a){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",e);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",i);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",Xi,{signal:u}),l.addEventListener("click",a,{signal:u})),this.#t.append(l)}}function Bx(r,t,e){for(const i of e)t.addEventListener(i,r[i].bind(r))}class ke{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(ke.#e||=new Set).add(t)}static setPointer(t,e){ke.#t||=e,ke.#n??=t}static setTimeStamp(t){ke.#i=t}static isSamePointerId(t){return ke.#t===t}static isSamePointerIdOrRemove(t){return ke.#t===t?!0:(ke.#e?.delete(t),!1)}static isSamePointerType(t){return ke.#n===t}static isInitializedAndDifferentPointerType(t){return ke.#n!==null&&!ke.isSamePointerType(t)}static isSameTimeStamp(t){return ke.#i===t}static isUsingMultiplePointers(){return ke.#e?.size>=1}static clearPointerType(){ke.#n=null}static clearPointerIds(){ke.#t=NaN,ke.#e=null}static clearTimeStamp(){ke.#i=NaN}}class iT{#t=0;get id(){return`${Hc}${this.#t++}`}}class Fm{#t=Ox();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),a=new Image;a.src=t;const l=a.decode().then(()=>(i.drawImage(a,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return se(this,"_isSVGFittingCanvas",l)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let a;if(typeof e=="string"?(i.url=e,a=await tu(e,"blob")):e instanceof File?a=i.file=e:e instanceof Blob&&(a=e),a.type==="image/svg+xml"){const l=Fm._isSVGFittingCanvas,c=new FileReader,u=new Image,d=new Promise((f,p)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,f()},c.onload=async()=>{const y=i.svgUrl=c.result;u.src=await l?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=p});c.readAsDataURL(a),await d}else i.bitmap=await createImageBitmap(a);i.refCounter=1}catch(a){ie(a),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:a,type:l}=t;return this.#n(`${e}_${i}_${a}_${l}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const a=new OffscreenCanvas(e.width,e.height);return a.getContext("2d").drawImage(e,0,0),i={bitmap:a.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const a=new OffscreenCanvas(i.width,i.height);a.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=a.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class sT{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:a,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(a&&t(),this.#e)return;const d={cmd:t,undo:e,post:i,type:l};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(d);return}if(c&&this.#t[this.#n].type===l){u&&(d.undo=this.#t[this.#n].undo),this.#t[this.#n]=d;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class iu{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=Cn.platform;for(const[i,a,l={}]of t)for(const c of i){const u=c.startsWith("mac+");e&&u?(this.callbacks.set(c.slice(4),{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1))):!e&&!u&&(this.callbacks.set(c,{callback:a,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:a,options:{bubbles:l=!1,args:c=[],checker:u=null}}=i;u&&!u(t,e)||(a.bind(t,...c,e)(),l||on(e))}}class Im{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return WC(t),se(this,"_colors",t)}convert(t){const e=nu(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,a]of this._colors)if(a.every((l,c)=>l===e[c]))return Im._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?zt.makeHexColor(...e):t}}class ur{#t=new AbortController;#e=null;#i=null;#n=new Map;#s=new Map;#r=null;#a=null;#o=null;#c=new sT;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#A=null;#x=null;#C=null;#w=!1;#_=null;#D=new iT;#R=!1;#M=!1;#B=!1;#k=null;#L=null;#F=null;#j=null;#G=null;#T=oe.NONE;#S=new Set;#O=null;#I=null;#z=null;#$=null;#V=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#P=null;#K=null;#Z=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=ur.prototype,e=c=>c.#K.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),i=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},a=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return se(this,"_keyboardManager",new iu([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#K.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#K.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-a,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[a,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-a],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,a],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:e}]]))}constructor(t,e,i,a,l,c,u,d,f,p,y,x,S,A,E,R){const D=this._signal=this.#t.signal;this.#K=t,this.#Z=e,this.#J=i,this.#r=a,this.#l=l,this.#I=c,this.#V=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:D}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:D}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:D}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:D}),u._on("setpreference",this.onSetPreference.bind(this),{signal:D}),u._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:D}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:D}),window.addEventListener("pointerdown",()=>{this.#M=!0},{capture:!0,signal:D}),window.addEventListener("pointerup",()=>{this.#M=!1},{capture:!0,signal:D}),this.#rt(),this.#dt(),this.#et(),this.#a=d.annotationStorage,this.#E=d.filterFactory,this.#z=f,this.#C=p||null,this.#y=y,this.#v=x,this.#b=S,this.#G=A||null,this.viewParameters={realScale:yl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=E||null,this._supportsPinchToZoom=R!==!1,l?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#p.clear(),this.#j?.clear(),this.#e=null,this.#S.clear(),this.#c.destroy(),this.#r?.destroy(),this.#l?.destroy(),this.#I?.destroy(),this.#_?.hide(),this.#_=null,this.#F?.destroy(),this.#F=null,this.#i=null,this.#A&&(clearTimeout(this.#A),this.#A=null),this.#P&&(clearTimeout(this.#P),this.#P=null),this._editorUndoBar?.destroy(),this.#V=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return se(this,"hcmFilter",this.#z?this.#E.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return se(this,"direction",getComputedStyle(this.#K).direction)}get _highlightColors(){return se(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return se(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[a,l]of t){const c=a.endsWith("_HCM");if(i&&c){e.set(a.replace("_HCM",""),l);continue}!i&&!c&&e.set(a,l)}return se(this,"highlightColors",e)}get highlightColorNames(){return se(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,e=!1){this.#r?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,a){this.#l?.showDialog(this,t,e,i,a)}selectComment(t,e){this.#s.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}deleteComment(t,e){const i=()=>{t.comment=e},a=()=>{this._editorUndoBar?.show(i,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:a,undo:i,mustExec:!0})}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#s.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),a=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",a),e())};this._eventBus.on("editorsrendered",a),await i}getSignature(t){this.#I?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#I}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=e)}onPagesEdited({pagesMapper:t}){for(const a of this.#n.values())a.updatePageIndex(t.getPrevPageNumber(a.pageIndex+1)-1);const e=this.#s,i=this.#s=new Map;for(const[a,l]of e){const c=t.getPrevPageNumber(a+1)-1;if(c===-1){l.destroy();continue}i.set(c,l),l.updatePageIndex(c)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#K.focus()}findParent(t,e){for(const i of this.#s.values()){const{x:a,y:l,width:c,height:u}=i.div.getBoundingClientRect();if(t>=a&&t<=a+c&&e>=l&&e<=l+u)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*yl.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#s.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u}=i,d=i.toString(),p=this.#W(i).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;i.empty();const x=this.#tt(p),S=this.#T===oe.NONE,A=()=>{const E=x?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:a,anchorOffset:l,focusNode:c,focusOffset:u,text:d});S&&this.showAllEditors("highlight",!0,!0),e&&E?.editComment()};if(S){this.switchToMode(oe.HIGHLIGHT,A);return}A()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#W(t).closest(".textLayer"),a=this.getSelectionBoxes(i);a&&(this.#_||=new nT(this),this.#_.show(i,a,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#a)return null;const e=`${Hc}${t}`,i=this.#a.getRawValue(e);return i&&this.#a.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#a&&!this.#a.has(t.id)&&this.#a.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#at(){const t=document.getSelection();if(!t||t.isCollapsed){this.#O&&(this.#_?.hide(),this.#O=null,this.#N({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#O)return;const a=this.#W(t).closest(".textLayer");if(!a){this.#O&&(this.#_?.hide(),this.#O=null,this.#N({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#O=e,this.#N({hasSelectedText:!0}),!(this.#T!==oe.HIGHLIGHT&&this.#T!==oe.NONE)&&(this.#T===oe.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#w=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===oe.HIGHLIGHT?this.#tt(a):null;if(l?.toggleDrawing(),this.#M){const c=new AbortController,u=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else l?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(t=""){this.#T===oe.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#rt(){document.addEventListener("selectionchange",this.#at.bind(this),{signal:this._signal})}#ot(){if(this.#x)return;this.#x=new AbortController;const t=this.combinedSignal(this.#x);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#x?.abort(),this.#x=null}blur(){if(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#S)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#k)return;this.#k=new AbortController;const t=this.combinedSignal(this.#k);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#k?.abort(),this.#k=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#S){const a=i.serialize(!0);a&&e.push(a)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const l of e.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(l){ie(`paste: "${l.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const a=this.currentLayer;try{const l=[];for(const d of i){const f=await a.deserialize(d);if(!f)return;l.push(f)}const c=()=>{for(const d of l)this.#nt(d);this.#it(l)},u=()=>{for(const d of l)d.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){ie(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==oe.NONE&&!this.isEditorHandlingKeyboard&&ur._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#w&&(this.#w=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#N(t){Object.entries(t).some(([i,a])=>this.#X[i]!==a)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#T===oe.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#q([[we.HIGHLIGHT_FREE,!0]]))}#q(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#N({isEditing:this.#T!==oe.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#N({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#q(e.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#s.get(this.#f)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#s.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,a=!1,l=!1,c=!1){if(this.#T!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===oe.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===oe.NONE){this.setEditingState(!1),this.#pt();for(const u of this.#n.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const u of this.#n.values())u.addStandaloneCommentButton();t===oe.SIGNATURE&&await this.#I?.loadSignatures(),i&&ke.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#s.values())u.updateMode(t);if(t===oe.POPUP){this.#i||=await this.#V.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#n.values()){const{annotationElementId:p,hasComment:y,deleted:x}=f;p&&u.add(p),y&&!x&&d.push(f.getData())}for(const f of this.#i){const{id:p,popupRef:y,contentsObj:x}=f;y&&x?.str&&!u.has(p)&&!this.#g.has(p)&&d.push(f)}this.#l?.showSidebar(d)}if(!e){a&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const u of this.#n.values())u.uid===e?(this.setSelected(u),c?u.editComment():l?u.enterInEditMode():u.focus()):u.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case we.CREATE:this.currentLayer.addNewEditor(e);return;case we.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#$||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#S)i.updateParams(t,e);else for(const i of this.#u)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const l of this.#n.values())l.editorType===t&&l.show(e);(this.#$?.get(we.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#q([[we.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#B!==t){this.#B=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#A&&clearTimeout(this.#A),this.#A=setTimeout(()=>{this.focusMainContainer(),this.#A=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#j?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#a?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#q(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#S);return t}updateUI(t){this.#mt===t&&this.#q(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#q(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#S.has(t)){this.#S.delete(t),t.unselect(),this.#N({hasSelectedEditor:this.hasSelection});return}this.#S.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#S)e!==t&&e.unselect();this.#S.clear(),this.#S.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#N({hasSelectedEditor:!0})}isSelected(t){return this.#S.has(t)}get firstSelectedEditor(){return this.#S.values().next().value}unselect(t){t.unselect(),this.#S.delete(t),this.#N({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#S.size!==0}get isEnterHandled(){return this.#S.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#N({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#N({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#S],i=()=>{this._editorUndoBar?.show(a,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},a=()=>{for(const l of e)this.#nt(l)};this.addCommands({cmd:i,undo:a,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#S)e.unselect();this.#S.clear();for(const e of t)e.isEmpty()||(this.#S.add(e),e.select());this.#N({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#S)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==oe.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#S)t.unselect();this.#S.clear(),this.#N({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[a,l]=this.#H,c=[...this.#S],u=1e3;this.#P&&clearTimeout(this.#P),this.#P=setTimeout(()=>{this.#P=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(a,l),d.translationDone())},undo:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(-a,-l),d.translationDone())},mustExec:!1})},u);for(const d of c)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#S)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let e=!1;for(const[{x:a,y:l,pageIndex:c},u]of t)u.newX=a,u.newY=l,u.newPageIndex=c,e||=a!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!e)return!1;const i=(a,l,c,u)=>{if(this.#n.has(a.id)){const d=this.#s.get(u);d?a._setParentAndPosition(d,l,c):(a.pageIndex=u,a.x=l,a.y=c)}};return this.addCommands({cmd:()=>{for(const[a,{newX:l,newY:c,newPageIndex:u}]of t)i(a,l,c,u)},undo:()=>{for(const[a,{savedX:l,savedY:c,savedPageIndex:u}]of t)i(a,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#m)for(const i of this.#m.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#S.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==oe.NONE}get imageManager(){return se(this,"imageManager",new Fm)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:a,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,x)=>({x:(p-a)/c,y:1-(f+y-i)/l,width:x/c,height:y/l});break;case"180":u=(f,p,y,x)=>({x:1-(f+y-i)/l,y:1-(p+x-a)/c,width:y/l,height:x/c});break;case"270":u=(f,p,y,x)=>({x:1-(p+x-a)/c,y:(f-i)/l,width:x/c,height:y/l});break;default:u=(f,p,y,x)=>({x:(f-i)/l,y:(p-a)/c,width:y/l,height:x/c});break}const d=[];for(let f=0,p=e.rangeCount;f<p;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x,y:S,width:A,height:E}of y.getClientRects())A===0||E===0||d.push(u(x,S,A,E))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#a.getRawValue(e);i&&(this.#T===oe.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const a=this.#j?.get(t);a&&(a.setCanvas(e,i),this.#j.delete(t))}addMissingCanvas(t,e){(this.#j||=new Map).set(t,e)}}class ks{#t=null;#e=!1;#i=null;#n=null;#s=null;#r=null;#a=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,ks.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){ks._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",ks.#f.missing),e.setAttribute("data-l10n-id",ks.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",Xi,{signal:i}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#a=!0,a(l))},{signal:i}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#a}),this.#a=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await ks._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:a,cancel:l=!1}){i&&(this.#l=i,this.#d=a),!(this.#t===t&&this.#e===e)&&(l||(this.#t=t,this.#e=e),this.#m())}toggle(t=!1){this.#i&&(!t&&this.#r&&(clearTimeout(this.#r),this.#r=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#s=null,this.#o?.remove(),this.#o=null}async#m(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",ks.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",ks.#f[`${this.#g}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const a=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#r),this.#r=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#r=setTimeout(()=>{this.#r=null,this.#s.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},a)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#r&&(clearTimeout(this.#r),this.#r=null),this.#s?.classList.remove("show")},{signal:l})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class Sh{#t=null;#e=null;#i=!1;#n=null;#s=null;#r=null;#a=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const a=this.#n.commentButtonColor;a&&(i.backgroundColor=a)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#n.parent.boundingClientRect;return[(t-a)/c,(e+i-l)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#n._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",Xi,{signal:i}),e&&(t.addEventListener("focusin",l=>{this.#n._focusEventsAllowed=!1,on(l)},{capture:!0,signal:i}),t.addEventListener("focusout",l=>{this.#n._focusEventsAllowed=!0,on(l)},{capture:!0,signal:i})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const a=l=>{l.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",a,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#i=!0,a(l))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,a;if(e)[i,a]=e;else{[i,a]=this.#n.commentButtonPosition;const{width:p,height:y,x,y:S}=this.#n;i=x+i*p,a=S+a*y}const l=this.#n.parent.boundingClientRect,{x:c,y:u,width:d,height:f}=l;this.#n._uiManager.editComment(this.#n,c+i*d,u+a*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#a===""}isEmpty(){return this.#a===null}hasBeenEdited(){return this.isDeleted()||this.#a!==this.#s}serialize(){return this.data}get data(){return{text:this.#a,richText:this.#r,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#a&&(this.#r=null),t===null){this.#a="",this.#c=!0;return}this.#a=t,this.#o=new Date,this.#c=!1}restoreData({text:t,richText:e,date:i}){this.#a=t,this.#r=e,this.#o=i,this.#c=!1}setInitialText(t,e=null){this.#s=t,this.data=t,this.#o=null,this.#r=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#a="",this.#r=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class fd{#t;#e=!1;#i=null;#n;#s;#r;#a;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:a=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#i=i,this.#n=e,this.#s=a,this.#r=l,this.#a=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ps.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const a=this.#o=new AbortController,l=AbortSignal.any([this.#c,a.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(on(f),d(f))},u),c.addEventListener("pointerup",d,u),c.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const a=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:a,capture:!1,passive:!1};l.addEventListener("touchmove",this.#g.bind(this),c);const u=this.#m.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",on,c),l.addEventListener("pointermove",on,c),l.addEventListener("pointercancel",on,c),l.addEventListener("pointerup",on,c),this.#s?.()}if(on(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;on(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:a,screenY:l}=e,{screenX:c,screenY:u}=i,d=this.#l,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:x}=d,S=y-f,A=x-p,E=c-a,R=u-l,D=Math.hypot(E,R)||1,k=Math.hypot(S,A)||1;if(!this.#e&&Math.abs(k-D)<=fd.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=a,d.touch0Y=l,d.touch1X=c,d.touch1Y=u,!this.#e){this.#e=!0;return}const O=[(a+c)/2,(l+u)/2];this.#r?.(O,k,D)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#a?.()),this.#l&&(on(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Wt{#t=null;#e=null;#i=null;#n=null;#s=null;#r=!1;#a=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#A=0;#x=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#w=!1;#_=Wt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Im;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Wt.prototype._resizeWithKeyboard,e=ur.TRANSLATE_SMALL,i=ur.TRANSLATE_BIG;return se(this,"_resizerKeyboardManager",new iu([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Wt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,a],this.pageTranslation=[l,c];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return se(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new aT({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Wt._l10n??=t,Wt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Wt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Wt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Le("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#w}set _isDraggable(t){this.#w=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#P(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,a){const[l,c]=this.parentDimensions;[i,a]=this.screenToPageTranslation(i,a),this.x=(t+i)/l,this.y=(e+a)/c,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,a]=this.parentDimensions;this.setAt(t*i,e*a,this.width*i,this.height*a),this._onTranslated()}#D([t,e],i,a){[i,a]=this.screenToPageTranslation(i,a),this.x+=i/t,this.y+=a/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#D(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[a,l]}=this;if(this.x+=t/a,this.y+=e/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:x}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,x)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[d,f]=this.getBaseTranslation();c+=d,u+=f;const{style:p}=i;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Wt,a=i/t,l=i/e;switch(this.rotation){case 90:return[-a,l];case 180:return[a,l];case 270:return[a,-l];default:return[-a,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,a]}=this;let{x:l,y:c,width:u,height:d}=this;if(u*=i,d*=a,l*=i,c*=a,this._mustFixPosition)switch(t){case 0:l=qn(l,0,i-u),c=qn(c,0,a-d);break;case 90:l=qn(l,0,i-d),c=qn(c,u,a);break;case 180:l=qn(l,u,i),c=qn(c,d,a);break;case 270:l=qn(l,d,i),c=qn(c,0,a-u);break}this.x=l/=i,this.y=c/=a;const[f,p]=this.getBaseTranslation();l+=f,c+=p,e.left=`${(100*l).toFixed(2)}%`,e.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Wt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Wt.#R(t,e,360-this.parentRotation)}#M(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#B(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const a=document.createElement("div");this.#c.append(a),a.classList.add("resizer",i),a.setAttribute("data-resizer-name",i),a.addEventListener("pointerdown",this.#k.bind(this,i),{signal:e}),a.addEventListener("contextmenu",Xi,{signal:e}),a.tabIndex=-1}this.div.prepend(this.#c)}#k(t,e){e.preventDefault();const{isMac:i}=Cn.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const a=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#j.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",on,{passive:!1,signal:c}),window.addEventListener("contextmenu",Xi,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=a,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#F()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#L(t,e,i,a){this.width=i,this.height=a,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:a}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,d=this.height;l===t&&c===e&&u===i&&d===a||this.addCommands({cmd:this.#L.bind(this,l,c,u,d),undo:this.#L.bind(this,t,e,i,a),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#j(t,e){const[i,a]=this.parentDimensions,l=this.x,c=this.y,u=this.width,d=this.height,f=Wt.MIN_SIZE/i,p=Wt.MIN_SIZE/a,y=this.#M(this.rotation),x=(G,ct)=>[y[0]*G+y[2]*ct,y[1]*G+y[3]*ct],S=this.#M(360-this.rotation),A=(G,ct)=>[S[0]*G+S[2]*ct,S[1]*G+S[3]*ct];let E,R,D=!1,k=!1;switch(t){case"topLeft":D=!0,E=(G,ct)=>[0,0],R=(G,ct)=>[G,ct];break;case"topMiddle":E=(G,ct)=>[G/2,0],R=(G,ct)=>[G/2,ct];break;case"topRight":D=!0,E=(G,ct)=>[G,0],R=(G,ct)=>[0,ct];break;case"middleRight":k=!0,E=(G,ct)=>[G,ct/2],R=(G,ct)=>[0,ct/2];break;case"bottomRight":D=!0,E=(G,ct)=>[G,ct],R=(G,ct)=>[0,0];break;case"bottomMiddle":E=(G,ct)=>[G/2,ct],R=(G,ct)=>[G/2,0];break;case"bottomLeft":D=!0,E=(G,ct)=>[0,ct],R=(G,ct)=>[G,0];break;case"middleLeft":k=!0,E=(G,ct)=>[0,ct/2],R=(G,ct)=>[G,ct/2];break}const O=E(u,d),I=R(u,d);let z=x(...I);const H=Wt._round(l+z[0]),P=Wt._round(c+z[1]);let rt=1,ut=1,St,_t;if(e.fromKeyboard)({deltaX:St,deltaY:_t}=e);else{const{screenX:G,screenY:ct}=e,[yt,Tt]=this.#l;[St,_t]=this.screenToPageTranslation(G-yt,ct-Tt),this.#l[0]=G,this.#l[1]=ct}if([St,_t]=A(St/i,_t/a),D){const G=Math.hypot(u,d);rt=ut=Math.max(Math.min(Math.hypot(I[0]-O[0]-St,I[1]-O[1]-_t)/G,1/u,1/d),f/u,p/d)}else k?rt=qn(Math.abs(I[0]-O[0]-St),f,1)/u:ut=qn(Math.abs(I[1]-O[1]-_t),p,1)/d;const Mt=Wt._round(u*rt),Vt=Wt._round(d*ut);z=x(...R(Mt,Vt));const vt=H-z[0],Ht=P-z[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=Mt,this.height=Vt,this.x=vt,this.y=Ht,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Fc(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(ks.initialize(Wt._l10n),this.#i=new ks(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new Sh(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#s){this._uiManager.isEditingMode()&&this.#s.classList.remove("hidden");return}this.hasComment&&(this.#s=this.#n.renderForStandalone(),this.div.append(this.#s))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#s=null}hideStandaloneCommentButton(){this.#s?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:t,text:e,date:i,deleted:a}}=this.#n;return{text:e,richText:t,date:i,deleted:a,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new Sh(this),typeof t=="object"&&t!==null?this.#n.restoreData(t):this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#n||=new Sh(this),this.#n.setInitialText(t,i),!this.annotationElementId))return;const a=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);a&&this.updateFromAnnotationLayer(a)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new Sh(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,a]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,d=a-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,a]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#r?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[a,l]=this.getInitialTranslation();return this.translate(a,l),Bx(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new fd({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#S.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,i){let l=.7*(i/e)+1-.7;if(l===1)return;const c=this.#M(this.rotation),u=(H,P)=>[c[0]*H+c[2]*P,c[1]*H+c[3]*P],[d,f]=this.parentDimensions,p=this.x,y=this.y,x=this.width,S=this.height,A=Wt.MIN_SIZE/d,E=Wt.MIN_SIZE/f;l=Math.max(Math.min(l,1/x,1/S),A/x,E/S);const R=Wt._round(x*l),D=Wt._round(S*l);if(R===x&&D===S)return;this.#u||=[p,y,x,S];const k=u(x/2,S/2),O=Wt._round(p+k[0]),I=Wt._round(y+k[1]),z=u(R/2,D/2);this.x=O-z[0],this.y=I-z[1],this.width=R,this.height=D,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#S(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=Cn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#I(t);return}this.#O(t)}#O(t){const{isMac:e}=Cn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#I(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const a=new AbortController,l=this._uiManager.combinedSignal(a),c={capture:!0,passive:!1,signal:l},u=f=>{a.abort(),this.#a=null,this.#m=!1,this._uiManager.endDragSession()||this.#O(f),i&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#A=t.clientY,this.#a=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:x}=f;if(x!==this.#a){on(f);return}const[S,A]=this.screenToPageTranslation(p-this.#E,y-this.#A);this.#E=p,this.#A=y,this._uiManager.dragSelectedEditors(S,A)},c),window.addEventListener("touchmove",on,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),on(f)},c));const d=f=>{if(!this.#a||this.#a===f.pointerId){u(f);return}on(f)};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const a=this.parentScale,[l,c]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/a,p=e/a,y=this.x*l,x=this.y*c,S=this.width*l,A=this.height*c;switch(i){case 0:return[y+f+u,c-x-p-A+d,y+f+S+u,c-x-p+d];case 90:return[y+p+u,c-x+f+d,y+p+A+u,c-x+f+S+d];case 180:return[y-f-S+u,c-x+p+d,y-f+u,c-x+p+A+d];case 270:return[y-p-A+u,c-x-f-S+d,y-p+u,c-x-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,a,l,c]=t,u=l-i,d=c-a;switch(this.rotation){case 0:return[i,e-c,u,d];case 90:return[i,e-a,d,u];case 180:return[l,e-a,u,d];case 270:return[l,e-c,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Wt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:a,deleted:l,richText:c},uid:u,pageIndex:d,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:i||p,popupRef:!l,color:e,opacity:a}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:a}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return e<c&&a>0&&t<l&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const a=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});a.rotation=t.rotation,a.#t=t.accessibilityData,a._isCopy=t.isCopy||!1;const[l,c]=a.pageDimensions,[u,d,f,p]=a.getRectInCurrentCoords(t.rect,c);return a.x=u/l,a.y=d/c,a.width=f/l,a.height=p/c,a}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#P(),this.removeEditToolbar(),this.#x){for(const t of this.#x.values())clearTimeout(t);this.#x=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#B(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,a,l,c]=this.getPDFRect();return[Wt._round(i+(l-i)*t),Wt._round(a+(c-a)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const c=this.#$.bind(this),u=this.#V.bind(this),d=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,p),{signal:d}),f.setAttribute("data-l10n-id",Wt._l10nResizer[p])}}const i=this.#e[0];let a=0;for(const c of e){if(c===i)break;a++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==a){if(l<a)for(let u=0;u<a-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>a)for(let u=0;u<l-a;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of e){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Wt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#$(t){Wt._resizerKeyboardManager.exec(this,t)}#V(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#P()}#X(t){this.#g=this.#v?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#j(this.#g,{deltaX:t,deltaY:e,fromKeyboard:!0})}#P(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#P(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#x||=new Map;const{action:i}=t;let a=this.#x.get(i);a&&clearTimeout(a),a=setTimeout(()=>{this._reportTelemetry(t),this.#x.delete(i),this.#x.size===0&&(this.#x=null)},Wt._telemetryTimeout),this.#x.set(i,a);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#r=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#r=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class aT extends Wt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const av=3285377520,Gi=4294901760,Ts=65535;class Fx{constructor(t){this.h1=t?t&4294967295:av,this.h2=t?t&4294967295:av}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let E=0,R=t.length;E<R;E++){const D=t.charCodeAt(E);D<=255?e[i++]=D:(e[i++]=D>>>8,e[i++]=D&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const a=i>>2,l=i-a*4,c=new Uint32Array(e.buffer,0,a);let u=0,d=0,f=this.h1,p=this.h2;const y=3432918353,x=461845907,S=y&Ts,A=x&Ts;for(let E=0;E<a;E++)E&1?(u=c[E],u=u*y&Gi|u*S&Ts,u=u<<15|u>>>17,u=u*x&Gi|u*A&Ts,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=c[E],d=d*y&Gi|d*S&Ts,d=d<<15|d>>>17,d=d*x&Gi|d*A&Ts,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=e[a*4+2]<<16;case 2:u^=e[a*4+1]<<8;case 1:u^=e[a*4],u=u*y&Gi|u*S&Ts,u=u<<15|u>>>17,u=u*x&Gi|u*A&Ts,a&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Gi|t*36045&Ts,e=e*4283543511&Gi|((e<<16|t>>>16)*2950163797&Gi)>>>16,t^=e>>>1,t=t*444984403&Gi|t*60499&Ts,e=e*3301882366&Gi|((e<<16|t>>>16)*3120437893&Gi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const sm=Object.freeze({map:null,hash:"",transfer:void 0});class Um{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof Wt&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#n.values())if(i instanceof Wt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let a=!1;if(i!==void 0)for(const[l,c]of Object.entries(e))i[l]!==c&&(a=!0,i[l]=c);else a=!0,this.#n.set(t,e);a&&this.#s(),e instanceof Wt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Ix(this)}get serializable(){if(this.#n.size===0)return sm;const t=new Map,e=new Fx,i=[],a=Object.create(null);let l=!1;for(const[c,u]of this.#n){const d=u instanceof Wt?u.serialize(!1,a):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(t.set(c,d),e.update(`${c}:${JSON.stringify(d)}`),l||=!!d.bitmap)}if(l)for(const c of t.values())c.bitmap&&i.push(c.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:sm}get editorStats(){let t=null;const e=new Map;let i=0,a=0;for(const l of this.#n.values()){if(!(l instanceof Wt)){l.popup&&(l.popup.deleted?a+=1:i+=1);continue}l.isCommentDeleted?a+=1:l.hasEditedComment&&(i+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;e.has(u)||e.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,p]of Object.entries(c)){if(f==="type")continue;let y=d.get(f);y||(y=new Map,d.set(f,y));const x=y.get(p)??0;y.set(p,x+1)}}if((a>0||i>0)&&(t||=Object.create(null),t.comments={deleted:a,edited:i}),!t)return null;for(const[l,c]of e)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#i?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Ix extends Um{#t;constructor(t){super();const{map:e,hash:i,transfer:a}=t.serializable,l=structuredClone(e,a?{transfer:a}:null);this.#t={map:l,hash:i,transfer:a}}get print(){Le("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return se(this,"modifiedIds",{ids:new Set,hash:""})}}class rT{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Oe(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:a,src:l,style:c}=t,u=new FontFace(a,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(a),i?.(t)}catch{ie(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Le("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(a){throw ie(`Failed to load font '${i.family}': '${a}'.`),t.disableFontFace=!0,a}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const a=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,a)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return se(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return se(this,"isSyncFontLoadingSupported",ni||Cn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Oe(!a.done,"completeRequest() cannot be called twice."),a.done=!0;i.length>0&&i[0].done;){const l=i.shift();setTimeout(l.callback,0)}}const{loadingRequests:i}=this,a={done:!1,complete:e,callback:t};return i.push(a),a}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return se(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(I,z){return I.charCodeAt(z)<<24|I.charCodeAt(z+1)<<16|I.charCodeAt(z+2)<<8|I.charCodeAt(z+3)&255}function a(I,z,H,P){const rt=I.substring(0,z),ut=I.substring(z+H);return rt+P+ut}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function p(I,z){if(++f>30){ie("Load test font never loaded."),z();return}if(d.font="30px "+I,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){z();return}setTimeout(p.bind(null,I,z))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let x=this._loadTestFont;x=a(x,976,y.length,y);const A=16,E=1482184792;let R=i(x,A);for(l=0,c=y.length-3;l<c;l+=4)R=R-E+i(y,l)|0;l<y.length&&(R=R-E+i(y+"XXX",l)|0),x=a(x,A,4,zC(R));const D=`url(data:font/opentype;base64,${btoa(x)});`,k=`@font-face {font-family:"${y}";src:${D}}`;this.insertRule(k);const O=this._document.createElement("div");O.style.visibility="hidden",O.style.width=O.style.height="10px",O.style.position="absolute",O.style.top=O.style.left="0px";for(const I of[t.loadedName,y]){const z=this._document.createElement("span");z.textContent="Hi",z.style.fontFamily=I,O.append(z)}this._document.body.append(O),p(y,()=>{O.remove(),e.complete()})}}class oT{#t;constructor(t,e=null,i,a){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),a&&(this.charProcOperatorList=a)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let a;try{a=t.get(i)}catch(c){ie(`getPathGenerator - ignoring character: "${c}".`)}const l=Px(a?.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){se(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){se(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class cl{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let a=0;for(const f of cl.strings){const p=e.encode(t[f]);i[f]=p,a+=4+p.length}const l=new ArrayBuffer(a),c=new Uint8Array(l),u=new DataView(l);let d=0;for(const f of cl.strings){const p=i[f],y=p.length;u.setUint32(d,y),c.set(p,d+4),d+=4+y}return Oe(d===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Oe(t<cl.strings.length,"Invalid string index");let e=0;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class ul{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let a=0;for(const x of ul.strings){const S=e.encode(t[x]);i[x]=S,a+=4+S.length}a+=4;let l,c,u=1+a;t.style&&(l=e.encode(t.style.style),c=e.encode(t.style.weight),u+=4+l.length+4+c.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,a=0;for(const x of ul.strings){const S=i[x],A=S.length;a+=4+A,p.setUint32(y,A),f.set(S,y+4),y+=4+A}return p.setUint32(y-a-4,a),t.style&&(p.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length,p.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Oe(y<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Oe(t<ul.strings.length,"Invalid string index");let e=5;for(let a=0;a<t;a++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const a=this.#e.getUint32(t),l=this.#i.decode(new Uint8Array(this.#t,t+4,a));return{style:i,weight:l}}}class Ge{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#s=this.#n+1+6;#r;#a;#o;constructor({data:t,extra:e}){this.#r=t,this.#a=new TextDecoder,this.#o=new DataView(this.#r),e&&Object.assign(this,e)}#c(t){Oe(t<Ge.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,a=this.#o.getUint8(e)>>i&3;return a===0?void 0:a===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Oe(t<Ge.numbers.length,"Invalid number index"),this.#o.getFloat64(Ge.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Ge.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<4;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Ge.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<6;a++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Ge.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let a=0;a<3;a++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Oe(t<Ge.strings.length,"Invalid string index");let e=Ge.#s+4;for(let l=0;l<t;l++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),a=new Uint8Array(i);return a.set(new Uint8Array(this.#r,e+4,i)),this.#a.decode(a)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Ge.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);if(l!==0)return new Uint8Array(this.#r,t+4,l)}clearData(){let t=Ge.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);t+=4+a;const l=this.#o.getUint32(t);new Uint8Array(this.#r,t+4,l).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Ge.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const a=this.#o.getUint32(t);if(a===0)return null;const l=new Uint8Array(a);return l.set(new Uint8Array(this.#r,t+4,a)),new cl(l.buffer)}get systemFontInfo(){let t=Ge.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const a=new Uint8Array(i);return a.set(new Uint8Array(this.#r,t+4,i)),new ul(a.buffer)}static write(t){const e=t.systemFontInfo?ul.write(t.systemFontInfo):null,i=t.cssFontInfo?cl.write(t.cssFontInfo):null,a=new TextEncoder,l={};let c=0;for(const E of Ge.strings)l[E]=a.encode(t[E]),c+=4+l[E].length;const u=Ge.#s+4+c+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;const x=Ge.bools.length;let S=0,A=0;for(let E=0;E<x;E++){const R=t[Ge.bools[E]];S|=(R===void 0?0:R?2:1)<<A,A+=2,(A===8||E===x-1)&&(p.setUint8(y++,S),S=0,A=0)}Oe(y===Ge.#t,"FontInfo.write: Boolean properties offset mismatch");for(const E of Ge.numbers)p.setFloat64(y,t[E]),y+=8;if(Oe(y===Ge.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const E of t.bbox)p.setInt16(y,E,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Oe(y===Ge.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const E of t.fontMatrix)p.setFloat64(y,E,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Oe(y===Ge.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const E of t.defaultVMetrics)p.setInt16(y,E,!0),y+=2}else p.setUint8(y++,0),y+=6;Oe(y===Ge.#s,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Ge.#s,0),y+=4;for(const E of Ge.strings){const R=l[E],D=R.length;p.setUint32(y,D),f.set(R,y+4),y+=4+D}if(p.setUint32(Ge.#s,y-Ge.#s-4),!e)p.setUint32(y,0),y+=4;else{const E=e.byteLength;p.setUint32(y,E),Oe(y+4+E<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),y+4),y+=4+E}if(!i)p.setUint32(y,0),y+=4;else{const E=i.byteLength;p.setUint32(y,E),Oe(y+4+E<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+E}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Oe(y<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(y)}}class Nn{static#t=0;static#e=1;static#i=2;static#n=3;static#s=4;static#r=8;static#a=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,a=[],l=[],c=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],c=t[3],e===1?a.push(...t[4],...t[5]):a.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,d=t[1],a=t[2],l=t[3],u=t[4]||[],i=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(a.length/2),y=Math.floor(l.length/3),x=c.length,S=u.length;let A=0;for(const z of u)A+=1,A=Math.ceil(A/4)*4,A+=4+z.coords.length*4,A+=4+z.colors.length*4,z.verticesPerRow!==void 0&&(A+=4);const E=20+p*8+y*3+x*8+(i?16:0)+(f?3:0)+A,R=new ArrayBuffer(E),D=new DataView(R),k=new Uint8Array(R);D.setUint8(Nn.#t,e),D.setUint8(Nn.#e,i?1:0),D.setUint8(Nn.#i,f?1:0),D.setUint8(Nn.#n,d),D.setUint32(Nn.#s,p,!0),D.setUint32(Nn.#r,y,!0),D.setUint32(Nn.#a,x,!0),D.setUint32(Nn.#o,S,!0);let O=20;new Float32Array(R,O,p*2).set(a),O+=p*8,k.set(l,O),O+=y*3;for(const[z,H]of c)D.setFloat32(O,z,!0),O+=4,D.setUint32(O,parseInt(H.slice(1),16),!0),O+=4;if(i)for(const z of i)D.setFloat32(O,z,!0),O+=4;f&&(k.set(f,O),O+=3);for(let z=0;z<u.length;z++){const H=u[z];D.setUint8(O,H.type),O+=1,O=Math.ceil(O/4)*4,D.setUint32(O,H.coords.length,!0),O+=4,new Int32Array(R,O,H.coords.length).set(H.coords),O+=H.coords.length*4,D.setUint32(O,H.colors.length,!0),O+=4,new Int32Array(R,O,H.colors.length).set(H.colors),O+=H.colors.length*4,H.verticesPerRow!==void 0&&(D.setUint32(O,H.verticesPerRow,!0),O+=4)}return R}getIR(){const t=this.view,e=this.data[Nn.#t],i=!!this.data[Nn.#e],a=!!this.data[Nn.#i],l=t.getUint32(Nn.#s,!0),c=t.getUint32(Nn.#r,!0),u=t.getUint32(Nn.#a,!0),d=t.getUint32(Nn.#o,!0);let f=20;const p=new Float32Array(this.buffer,f,l*2);f+=l*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const x=[];for(let R=0;R<u;++R){const D=t.getFloat32(f,!0);f+=4;const k=t.getUint32(f,!0);f+=4,x.push([D,`#${k.toString(16).padStart(6,"0")}`])}let S=null;if(i){S=[];for(let R=0;R<4;++R)S.push(t.getFloat32(f,!0)),f+=4}let A=null;a&&(A=new Uint8Array(this.buffer,f,3),f+=3);const E=[];for(let R=0;R<d;++R){const D=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const k=t.getUint32(f,!0);f+=4;const O=new Int32Array(this.buffer,f,k);f+=k*4;const I=t.getUint32(f,!0);f+=4;const z=new Int32Array(this.buffer,f,I);f+=I*4;const H={type:D,coords:O,colors:z};D===Jp.LATTICE&&(H.verticesPerRow=t.getUint32(f,!0),f+=4),E.push(H)}if(e===1)return["RadialAxial","axial",S,x,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",S,x,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(e===3){const R=this.data[Nn.#n];let D=null;if(p.length>0){let k=p[0],O=p[0],I=p[1],z=p[1];for(let H=0;H<p.length;H+=2){const P=p[H],rt=p[H+1];k=k>P?P:k,I=I>rt?rt:I,O=O<P?P:O,z=z<rt?rt:z}D=[k,I,O,z]}return["Mesh",R,p,y,E,D,S,A]}throw new Error(`Unsupported pattern kind: ${e}`)}}class lT{static write(t){let e,i;return Cn.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}#t;constructor(t){this.#t=t}get path(){return Cn.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function cT(r){if(r instanceof URL)return r.href;if(typeof r=="string"){if(ni)return r;const t=URL.parse(r,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function uT(r){if(ni&&typeof Buffer<"u"&&r instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength)return r;if(typeof r=="string")return hd(r);if(r instanceof ArrayBuffer||ArrayBuffer.isView(r)||typeof r=="object"&&!isNaN(r?.length))return new Uint8Array(r);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function Ah(r){if(typeof r!="string")return null;if(r.endsWith("/"))return r;throw new Error(`Invalid factory url: "${r}" must include trailing slash.`)}const am=r=>typeof r=="object"&&Number.isInteger(r?.num)&&r.num>=0&&Number.isInteger(r?.gen)&&r.gen>=0,hT=r=>typeof r=="object"&&typeof r?.name=="string",dT=VC.bind(null,am,hT);class fT{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[a]of this.#t)a.call(this,i)})}addEventListener(t,e,i=null){let a=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){ie("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,e);a=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(e,a)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const Eh={DATA:1,ERROR:2},wn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function rv(){}function fi(r){if(r instanceof cr||r instanceof tm||r instanceof Z0||r instanceof Yh||r instanceof Mp)return r;switch(r instanceof Error||typeof r=="object"&&r!==null||Le('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),r.name){case"AbortException":return new cr(r.message);case"InvalidPDFException":return new tm(r.message);case"PasswordException":return new Z0(r.message,r.code);case"ResponseException":return new Yh(r.message,r.status,r.missing);case"UnknownErrorException":return new Mp(r.message,r.details)}return new Mp(r.message,r.toString())}class jc{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,a=this.callbackCapabilities[i];if(!a)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===Eh.DATA)a.resolve(t.data);else if(t.callback===Eh.ERROR)a.reject(fi(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,a=t.sourceName,l=this.comObj;Promise.try(e,t.data).then(function(c){l.postMessage({sourceName:i,targetName:a,callback:Eh.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:i,targetName:a,callback:Eh.ERROR,callbackId:t.callbackId,reason:fi(c)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const a=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[a]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:a,data:e},i)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,e,i,a){const l=this.streamId++,c=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:e,desiredSize:f.desiredSize},a),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,d.postMessage({sourceName:c,targetName:u,stream:wn.PULL,streamId:l,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Oe(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,d.postMessage({sourceName:c,targetName:u,stream:wn.CANCEL,streamId:l,reason:fi(f)}),p.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],d={enqueue(f,p=1,y){if(this.isCancelled)return;const x=this.desiredSize;this.desiredSize-=p,x>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:a,stream:wn.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:wn.CLOSE,streamId:e}),delete c.streamSinks[e])},error(f){Oe(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:a,stream:wn.ERROR,streamId:e,reason:fi(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:wn.START_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:wn.START_COMPLETE,streamId:e,reason:fi(f)})})}#n(t){const e=t.streamId,i=this.sourceName,a=t.sourceName,l=this.comObj,c=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case wn.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(fi(t.reason));break;case wn.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(fi(t.reason));break;case wn.PULL:if(!u){l.postMessage({sourceName:i,targetName:a,stream:wn.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||rv).then(function(){l.postMessage({sourceName:i,targetName:a,stream:wn.PULL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:wn.PULL_COMPLETE,streamId:e,reason:fi(f)})});break;case wn.ENQUEUE:if(Oe(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case wn.CLOSE:if(Oe(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#s(c,e);break;case wn.ERROR:Oe(c,"error should have stream controller"),c.controller.error(fi(t.reason)),this.#s(c,e);break;case wn.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(fi(t.reason)),this.#s(c,e);break;case wn.CANCEL:if(!u)break;const d=fi(t.reason);Promise.try(u.onCancel||rv,d).then(function(){l.postMessage({sourceName:i,targetName:a,stream:wn.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:a,stream:wn.CANCEL_COMPLETE,streamId:e,reason:fi(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class Ux{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Le("Abstract method `_createCanvas` called.")}}class pT extends Ux{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class zx{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Le("Abstract method `_fetch` called.")}}class ov extends zx{async _fetch(t){const e=await tu(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):hd(e)}}class Hx{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,a,l){return"none"}destroy(t=!1){}}class mT extends Hx{#t;#e;#i;#n;#s;#r;#a=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#s=e}get#o(){return this.#e||=new Map}get#c(){return this.#r||=new Map}get#l(){if(!this.#i){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(pa,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#s.createElementNS(pa,"defs"),t.append(i),i.append(this.#i),this.#s.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=d[y]/255;const p=f.join(",");return[p,p,p]}const[e,i,a]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let d=0;d<256;d++)l[d]=e[d]/255,c[d]=i[d]/255,u[d]=a[d]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(dd(e)?ie('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=kx(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,a,l]=this.#d(t),c=t.length===1?i:`${i}${a}${l}`;if(e=this.#o.get(c),e)return this.#o.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#a++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(c,d);const f=this.#m(u);return this.#p(i,a,l,f),d}addHCMFilter(t,e){const i=`${t}-${e}`,a="base";let l=this.#c.get(a);if(l?.key===i||(l?(l.filter?.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},this.#c.set(a,l)),!t||!e))return l.url;const c=this.#v(t);t=zt.makeHexColor(...c);const u=this.#v(e);if(e=zt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return l.url;const d=new Array(256);for(let S=0;S<=255;S++){const A=S/255;d[S]=A<=.03928?A/12.92:((A+.055)/1.055)**2.4}const f=d.join(","),p=`g_${this.#n}_hcm_filter`,y=l.filter=this.#m(p);this.#p(f,f,f,y),this.#g(y);const x=(S,A)=>{const E=c[S]/255,R=u[S]/255,D=new Array(A+1);for(let k=0;k<=A;k++)D[k]=E+k/A*(R-E);return D.join(",")};return this.#p(x(0,5),x(1,5),x(2,5),y),l.url=this.#h(p),l.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),a=`alpha_${i}`;if(e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_alpha_map_${this.#a++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#y(i,u),c}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,a;if(t?([i]=this.#d([t]),a=`luminosity_${i}`):a="luminosity",e=this.#o.get(a),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_luminosity_map_${this.#a++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(a,c);const u=this.#m(l);return this.#f(u),t&&this.#y(i,u),c}addHighlightHCMFilter(t,e,i,a,l){const c=`${e}-${i}-${a}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!e||!i))return u.url;const[d,f]=[e,i].map(this.#v.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[x,S]=[a,l].map(this.#v.bind(this));y<p&&([p,y,x,S]=[y,p,S,x]),this.#l.style.color="";const A=(D,k,O)=>{const I=new Array(256),z=(y-p)/O,H=D/255,P=(k-D)/(255*O);let rt=0;for(let ut=0;ut<=O;ut++){const St=Math.round(p+ut*z),_t=H+ut*P;for(let Mt=rt;Mt<=St;Mt++)I[Mt]=_t;rt=St+1}for(let ut=rt;ut<256;ut++)I[ut]=I[rt-1];return I.join(",")},E=`g_${this.#n}_hcm_${t}_filter`,R=u.filter=this.#m(E);return this.#g(R),this.#p(A(x[0],S[0],5),A(x[1],S[1],5),A(x[2],S[2],5),R),u.url=this.#h(E),u.url}destroy(t=!1){t&&this.#r?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#r?.clear(),this.#r=null,this.#a=0)}#f(t){const e=this.#s.createElementNS(pa,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#s.createElementNS(pa,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#m(t){const e=this.#s.createElementNS(pa,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,i){const a=this.#s.createElementNS(pa,e);a.setAttribute("type","discrete"),a.setAttribute("tableValues",i),t.append(a)}#p(t,e,i,a){const l=this.#s.createElementNS(pa,"feComponentTransfer");a.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",e),this.#u(l,"feFuncB",i)}#y(t,e){const i=this.#s.createElementNS(pa,"feComponentTransfer");e.append(i),this.#u(i,"feFuncA",t)}#v(t){return this.#l.style.color=t,nu(getComputedStyle(this.#l).getPropertyValue("color"))}}class qx{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Le("Abstract method `_fetch` called.")}}class lv extends qx{async _fetch(t){const e=await tu(t,"arraybuffer");return new Uint8Array(e)}}class Gx{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Le("Abstract method `_fetch` called.")}}class cv extends Gx{async _fetch(t){const e=await tu(t,"arraybuffer");return new Uint8Array(e)}}ni&&ie("Please use the `legacy` build in Node.js environments.");async function zm(r){const e=await process.getBuiltinModule("fs").promises.readFile(r);return new Uint8Array(e)}class gT extends Hx{}class yT extends Ux{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class bT extends zx{async _fetch(t){return zm(t)}}class vT extends qx{async _fetch(t){return zm(t)}}class xT extends Gx{async _fetch(t){return zm(t)}}const nl="__forcedDependency",{floor:uv,ceil:hv}=Math;function _h(r,t,e,i,a,l){r[t*4+0]=Math.min(r[t*4+0],e),r[t*4+1]=Math.min(r[t*4+1],i),r[t*4+2]=Math.max(r[t*4+2],a),r[t*4+3]=Math.max(r[t*4+3],l)}const rm=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class wT{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===rm}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const Ch=(r,t)=>{if(!r)return;let e=r.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},r.set(t,e)),e};class ST{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[nl]:[]};#i=new Map;#n=[];#s=[];#r=[[1,0,0,1,0,0]];#a=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,e,i=!1){this.#f=t.width,this.#g=t.height,this.#y(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const i=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(i),this.#u=new Uint32Array(i),e&&e.length>0?(this.#u.set(e),this.#u.fill(rm,e.length)):this.#u.fill(rm)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[nl]:{__proto__:this.#e[nl]}},this.#a={__proto__:this.#a},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#a=Object.getPrototypeOf(this.#a);const i=this.#n.pop();return i!==void 0&&(Ch(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(Ch(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#s.push(t),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(Ch(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#r.push(zt.multiplyByDOMMatrix(this.#r.at(-1),t.getTransform())),this}popBaseTransform(){return this.#r.length>1&&this.#r.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#i.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(nl,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(nl,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,a,l,c){const u=zt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];zt.axialAlignedBoundingBox([i,l,a,c],u,d);const f=zt.intersect(this.#a,d);return f?(this.#a[0]=f[0],this.#a[1]=f[1],this.#a[2]=f[2],this.#a[3]=f[3]):(this.#a[0]=this.#a[1]=1/0,this.#a[2]=this.#a[3]=-1/0),this}recordBBox(t,e,i,a,l,c){const u=this.#a;if(u[0]===1/0)return this;const d=zt.multiplyByDOMMatrix(this.#r.at(-1),e.getTransform());if(u[0]===-1/0)return zt.axialAlignedBoundingBox([i,l,a,c],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return zt.axialAlignedBoundingBox([i,l,a,c],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,i,a=1,l=0,c=0,u){const d=i.bbox;let f,p;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(i),f!==!1&&(p=[0,0,0,0],zt.axialAlignedBoundingBox(d,i.fontMatrix,p),(a!==1||l!==0||c!==0)&&zt.scaleMinMax([a,0,0,-a,l,c],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return d&&p&&f===void 0&&(f=p[0]<=l-y.actualBoundingBoxLeft&&p[2]>=l+y.actualBoundingBoxRight&&p[1]<=c-y.actualBoundingBoxAscent&&p[3]>=c+y.actualBoundingBoxDescent,this.#h.set(i,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,l-y.actualBoundingBoxLeft,l+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#a[0]),this.#o[1]=Math.max(0,this.#a[1]),this.#o[2]=Math.min(this.#f,this.#a[2]),this.#o[3]=Math.min(this.#g,this.#a[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,a=this.#t,l=this.#e;for(const c of e)c in this.#t?i.add(a[c]):c in l&&l[c].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[nl]),this.#p){const i=Ch(this.#p,t),{dependencies:a}=i;this.#l.forEach(a.add,a),this.#n.forEach(a.add,a),this.#s.forEach(a.add,a),a.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=uv(this.#o[0]*256/this.#f),a=uv(this.#o[1]*256/this.#g),l=hv(this.#o[2]*256/this.#f),c=hv(this.#o[3]*256/this.#g);_h(this.#m,t,i,a,l,c);for(const u of this.#l)u!==t&&_h(this.#m,u,i,a,l,c);for(const u of this.#n)u!==t&&_h(this.#m,u,i,a,l,c);for(const u of this.#s)u!==t&&_h(this.#m,u,i,a,l,c);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const a of i)this.recordIncrementalData("sameLineText",a);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#a[0]=Math.max(this.#a[0],this.#o[0]),this.#a[1]=Math.max(this.#a[1],this.#o[1]),this.#a[2]=Math.min(this.#a[2],this.#o[2]),this.#a[3]=Math.min(this.#a[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new wT(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class Qh{#t;#e;#i;#n=0;#s=0;constructor(t,e,i){if(t instanceof Qh&&t.#i===!!i)return t;this.#t=t,this.#e=e,this.#i=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,a,l,c){return this.#i||this.#t.recordClipBox(this.#e,e,i,a,l,c),this}recordBBox(t,e,i,a,l,c){return this.#i||this.#t.recordBBox(this.#e,e,i,a,l,c),this}recordCharacterBBox(t,e,i,a,l,c,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,i,a,l,c,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const Ki={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},Gn={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function om(r,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],a=new Path2D;a.rect(t[0],t[1],e,i),r.clip(a)}class Hm{isModifyingCurrentTransform(){return!1}getPattern(){Le("Abstract method `getPattern` called.")}}class AT extends Hm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,a=this._p0,l=this._p1;if(e&&(a=a.slice(),l=l.slice(),zt.applyTransform(a,e),zt.applyTransform(l,e)),this._type==="axial")i=t.createLinearGradient(a[0],a[1],l[0],l[1]);else if(this._type==="radial"){let c=this._r0,u=this._r1;if(e){const d=new Float32Array(2);zt.singularValueDecompose2dScale(e,d),c*=d[0],u*=d[0]}i=t.createRadialGradient(a[0],a[1],c,l[0],l[1],u)}for(const c of this._colorStops)i.addColorStop(c[0],c[1]);return i}getPattern(t,e,i,a){let l;if(a===Gn.STROKE||a===Gn.FILL){if(this.isOriginBased()){let x=zt.transform(i,e.baseTransform);this.matrix&&(x=zt.transform(x,this.matrix));const S=.001,A=Math.hypot(x[0],x[1]),E=Math.hypot(x[2],x[3]),R=(x[0]*x[2]+x[1]*x[3])/(A*E);if(Math.abs(R)<S)if(this.isRadial()){if(Math.abs(A-E)<S)return this._createGradient(t,x)}else return this._createGradient(t,x)}const c=e.current.getClippedPathBoundingBox(a,nn(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),i=zt.transform(i,[1,0,0,1,c[0],c[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),om(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(i);l.setTransform(y)}else om(t,this._bbox),l=this._createGradient(t);return l}}function kp(r,t,e,i,a,l,c,u){const d=t.coords,f=t.colors,p=r.data,y=r.width*4;let x;d[e+1]>d[i+1]&&(x=e,e=i,i=x,x=l,l=c,c=x),d[i+1]>d[a+1]&&(x=i,i=a,a=x,x=c,c=u,u=x),d[e+1]>d[i+1]&&(x=e,e=i,i=x,x=l,l=c,c=x);const S=(d[e]+t.offsetX)*t.scaleX,A=(d[e+1]+t.offsetY)*t.scaleY,E=(d[i]+t.offsetX)*t.scaleX,R=(d[i+1]+t.offsetY)*t.scaleY,D=(d[a]+t.offsetX)*t.scaleX,k=(d[a+1]+t.offsetY)*t.scaleY;if(A>=k)return;const O=f[l],I=f[l+1],z=f[l+2],H=f[c],P=f[c+1],rt=f[c+2],ut=f[u],St=f[u+1],_t=f[u+2],Mt=Math.round(A),Vt=Math.round(k);let vt,Ht,G,ct,yt,Tt,Pt,F;for(let J=Mt;J<=Vt;J++){if(J<R){const Bt=J<A?0:(A-J)/(A-R);vt=S-(S-E)*Bt,Ht=O-(O-H)*Bt,G=I-(I-P)*Bt,ct=z-(z-rt)*Bt}else{let Bt;J>k?Bt=1:R===k?Bt=0:Bt=(R-J)/(R-k),vt=E-(E-D)*Bt,Ht=H-(H-ut)*Bt,G=P-(P-St)*Bt,ct=rt-(rt-_t)*Bt}let ht;J<A?ht=0:J>k?ht=1:ht=(A-J)/(A-k),yt=S-(S-D)*ht,Tt=O-(O-ut)*ht,Pt=I-(I-St)*ht,F=z-(z-_t)*ht;const xt=Math.round(Math.min(vt,yt)),Dt=Math.round(Math.max(vt,yt));let qt=y*J+xt*4;for(let Bt=xt;Bt<=Dt;Bt++)ht=(vt-Bt)/(vt-yt),ht<0?ht=0:ht>1&&(ht=1),p[qt++]=Ht-(Ht-Tt)*ht|0,p[qt++]=G-(G-Pt)*ht|0,p[qt++]=ct-(ct-F)*ht|0,p[qt++]=255}}function ET(r,t,e){const i=t.coords,a=t.colors;let l,c;switch(t.type){case Jp.LATTICE:const u=t.verticesPerRow,d=Math.floor(i.length/u)-1,f=u-1;for(l=0;l<d;l++){let p=l*u;for(let y=0;y<f;y++,p++)kp(r,e,i[p],i[p+1],i[p+u],a[p],a[p+1],a[p+u]),kp(r,e,i[p+u+1],i[p+1],i[p+u],a[p+u+1],a[p+1],a[p+u])}break;case Jp.TRIANGLES:for(l=0,c=i.length;l<c;l+=3)kp(r,e,i[l],i[l+1],i[l+2],a[l],a[l+1],a[l+2]);break;default:throw new Error("illegal figure")}}class _T extends Hm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),x=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),S=f/y,A=p/x,E={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/S,scaleY:1/A},R=y+4,D=x+4,k=i.getCanvas("mesh",R,D),O=k.context,I=O.createImageData(y,x);if(e){const H=I.data;for(let P=0,rt=H.length;P<rt;P+=4)H[P]=e[0],H[P+1]=e[1],H[P+2]=e[2],H[P+3]=255}for(const H of this._figures)ET(I,H,E);return O.putImageData(I,2,2),{canvas:k.canvas,offsetX:u-2*S,offsetY:d-2*A,scaleX:S,scaleY:A}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,a){om(t,this._bbox);const l=new Float32Array(2);if(a===Gn.SHADING)zt.singularValueDecompose2dScale(nn(t),l);else if(this.matrix){zt.singularValueDecompose2dScale(this.matrix,l);const[u,d]=l;zt.singularValueDecompose2dScale(e.baseTransform,l),l[0]*=u,l[1]*=d}else zt.singularValueDecompose2dScale(e.baseTransform,l);const c=this._createMeshCanvas(l,a===Gn.SHADING?null:this._background,e.cachedCanvases);return a!==Gn.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class CT extends Hm{getPattern(){return"hotpink"}}function TT(r){switch(r[0]){case"RadialAxial":return new AT(r);case"Mesh":return new _T(r);case"Dummy":return new CT}throw new Error(`Unknown IR type: ${r[0]}`)}const dv={COLORED:1,UNCOLORED:2};class qm{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,a){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=a}createPatternCanvas(t,e){const{bbox:i,operatorList:a,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),ud("TilingType: "+c);const y=i[0],x=i[1],S=i[2],A=i[3],E=S-y,R=A-x,D=new Float32Array(2);zt.singularValueDecompose2dScale(this.matrix,D);const[k,O]=D;zt.singularValueDecompose2dScale(this.baseTransform,D);const I=k*D[0],z=O*D[1];let H=E,P=R,rt=!1,ut=!1;const St=Math.ceil(f*I),_t=Math.ceil(p*z),Mt=Math.ceil(E*I),Vt=Math.ceil(R*z);St>=Mt?H=f:rt=!0,_t>=Vt?P=p:ut=!0;const vt=this.getSizeAndScale(H,this.ctx.canvas.width,I),Ht=this.getSizeAndScale(P,this.ctx.canvas.height,z),G=t.cachedCanvases.getCanvas("pattern",vt.size,Ht.size),ct=G.context,yt=d.createCanvasGraphics(ct,e);if(yt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(yt,l,u),ct.translate(-vt.scale*y,-Ht.scale*x),yt.transform(0,vt.scale,0,0,Ht.scale,0,0),ct.save(),yt.dependencyTracker?.save(),this.clipBbox(yt,y,x,S,A),yt.baseTransform=nn(yt.ctx),yt.executeOperatorList(a),yt.endDrawing(),yt.dependencyTracker?.restore(),ct.restore(),rt||ut){const Tt=G.canvas;rt&&(H=f),ut&&(P=p);const Pt=this.getSizeAndScale(H,this.ctx.canvas.width,I),F=this.getSizeAndScale(P,this.ctx.canvas.height,z),J=Pt.size,ht=F.size,xt=t.cachedCanvases.getCanvas("pattern-workaround",J,ht),Dt=xt.context,qt=rt?Math.floor(E/f):0,Bt=ut?Math.floor(R/p):0;for(let he=0;he<=qt;he++)for(let de=0;de<=Bt;de++)Dt.drawImage(Tt,J*he,ht*de,J,ht,0,0,J,ht);return{canvas:xt.canvas,scaleX:Pt.scale,scaleY:F.scale,offsetX:y,offsetY:x}}return{canvas:G.canvas,scaleX:vt.scale,scaleY:Ht.scale,offsetX:y,offsetY:x}}getSizeAndScale(t,e,i){const a=Math.max(qm.MAX_PATTERN_SIZE,e);let l=Math.ceil(t*i);return l>=a?l=a:i=l/t,{scale:i,size:l}}clipBbox(t,e,i,a,l){const c=a-e,u=l-i;t.ctx.rect(e,i,c,u),zt.axialAlignedBoundingBox([e,i,a,l],nn(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const a=t.ctx,l=t.current;switch(e){case dv.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;a.fillStyle=l.fillColor=c,a.strokeStyle=l.strokeColor=u;break;case dv.UNCOLORED:a.fillStyle=a.strokeStyle=i,l.fillColor=l.strokeColor=i;break;default:throw new IC(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,a,l){let c=i;a!==Gn.SHADING&&(c=zt.transform(c,e.baseTransform),this.matrix&&(c=zt.transform(c,this.matrix)));const u=this.createPatternCanvas(e,l);let d=new DOMMatrix(c);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function RT({src:r,srcPos:t=0,dest:e,width:i,height:a,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=Cn.isLittleEndian?4278190080:255,[d,f]=c?[l,u]:[u,l],p=i>>3,y=i&7,x=r.length;e=new Uint32Array(e.buffer);let S=0;for(let A=0;A<a;A++){for(const R=t+p;t<R;t++){const D=t<x?r[t]:255;e[S++]=D&128?f:d,e[S++]=D&64?f:d,e[S++]=D&32?f:d,e[S++]=D&16?f:d,e[S++]=D&8?f:d,e[S++]=D&4?f:d,e[S++]=D&2?f:d,e[S++]=D&1?f:d}if(y===0)continue;const E=t<x?r[t++]:255;for(let R=0;R<y;R++)e[S++]=E&1<<7-R?f:d}return{srcPos:t,destPos:S}}const fv=16,pv=100,MT=15,mv=10,pi=16,Op=new DOMMatrix,Ri=new Float32Array(2),ol=new Float32Array([1/0,1/0,-1/0,-1/0]);function DT(r,t){if(r._removeMirroring)throw new Error("Context is already forwarding operations.");r.__originalSave=r.save,r.__originalRestore=r.restore,r.__originalRotate=r.rotate,r.__originalScale=r.scale,r.__originalTranslate=r.translate,r.__originalTransform=r.transform,r.__originalSetTransform=r.setTransform,r.__originalResetTransform=r.resetTransform,r.__originalClip=r.clip,r.__originalMoveTo=r.moveTo,r.__originalLineTo=r.lineTo,r.__originalBezierCurveTo=r.bezierCurveTo,r.__originalRect=r.rect,r.__originalClosePath=r.closePath,r.__originalBeginPath=r.beginPath,r._removeMirroring=()=>{r.save=r.__originalSave,r.restore=r.__originalRestore,r.rotate=r.__originalRotate,r.scale=r.__originalScale,r.translate=r.__originalTranslate,r.transform=r.__originalTransform,r.setTransform=r.__originalSetTransform,r.resetTransform=r.__originalResetTransform,r.clip=r.__originalClip,r.moveTo=r.__originalMoveTo,r.lineTo=r.__originalLineTo,r.bezierCurveTo=r.__originalBezierCurveTo,r.rect=r.__originalRect,r.closePath=r.__originalClosePath,r.beginPath=r.__originalBeginPath,delete r._removeMirroring},r.save=function(){t.save(),this.__originalSave()},r.restore=function(){t.restore(),this.__originalRestore()},r.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},r.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},r.transform=function(e,i,a,l,c,u){t.transform(e,i,a,l,c,u),this.__originalTransform(e,i,a,l,c,u)},r.setTransform=function(e,i,a,l,c,u){t.setTransform(e,i,a,l,c,u),this.__originalSetTransform(e,i,a,l,c,u)},r.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},r.rotate=function(e){t.rotate(e),this.__originalRotate(e)},r.clip=function(e){t.clip(e),this.__originalClip(e)},r.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},r.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},r.bezierCurveTo=function(e,i,a,l,c,u){t.bezierCurveTo(e,i,a,l,c,u),this.__originalBezierCurveTo(e,i,a,l,c,u)},r.rect=function(e,i,a,l){t.rect(e,i,a,l),this.__originalRect(e,i,a,l)},r.closePath=function(){t.closePath(),this.__originalClosePath()},r.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class NT{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let a;return this.cache[t]!==void 0?(a=this.cache[t],this.canvasFactory.reset(a,e,i)):(a=this.canvasFactory.create(e,i),this.cache[t]=a),a}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function Th(r,t,e,i,a,l,c,u,d,f){const[p,y,x,S,A,E]=nn(r);if(y===0&&x===0){const k=c*p+A,O=Math.round(k),I=u*S+E,z=Math.round(I),H=(c+d)*p+A,P=Math.abs(Math.round(H)-O)||1,rt=(u+f)*S+E,ut=Math.abs(Math.round(rt)-z)||1;return r.setTransform(Math.sign(p),0,0,Math.sign(S),O,z),r.drawImage(t,e,i,a,l,0,0,P,ut),r.setTransform(p,y,x,S,A,E),[P,ut]}if(p===0&&S===0){const k=u*x+A,O=Math.round(k),I=c*y+E,z=Math.round(I),H=(u+f)*x+A,P=Math.abs(Math.round(H)-O)||1,rt=(c+d)*y+E,ut=Math.abs(Math.round(rt)-z)||1;return r.setTransform(0,Math.sign(y),Math.sign(x),0,O,z),r.drawImage(t,e,i,a,l,0,0,ut,P),r.setTransform(p,y,x,S,A,E),[ut,P]}r.drawImage(t,e,i,a,l,c,u,d,f);const R=Math.hypot(p,y),D=Math.hypot(x,S);return[R*d,D*f]}class gv{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Zp;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=En.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=ol.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=Gn.FILL,e=null){const i=this.minMax.slice();if(t===Gn.STROKE){e||Le("Stroke bounding box must include transform."),zt.singularValueDecompose2dScale(e,Ri);const a=Ri[0]*this.lineWidth/2,l=Ri[1]*this.lineWidth/2;i[0]-=a,i[1]-=l,i[2]+=a,i[3]+=l}return i}updateClipFromPath(){const t=zt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(ol,0)}getClippedPathBoundingBox(t=Gn.FILL,e=null){return zt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function yv(r,t){if(t instanceof ImageData){r.putImageData(t,0,0);return}const e=t.height,i=t.width,a=e%pi,l=(e-a)/pi,c=a===0?l:l+1,u=r.createImageData(i,pi);let d=0,f;const p=t.data,y=u.data;let x,S,A,E;if(t.kind===Ih.GRAYSCALE_1BPP){const R=p.byteLength,D=new Uint32Array(y.buffer,0,y.byteLength>>2),k=D.length,O=i+7>>3,I=4294967295,z=Cn.isLittleEndian?4278190080:255;for(x=0;x<c;x++){for(A=x<l?pi:a,f=0,S=0;S<A;S++){const H=R-d;let P=0;const rt=H>O?i:H*8-7,ut=rt&-8;let St=0,_t=0;for(;P<ut;P+=8)_t=p[d++],D[f++]=_t&128?I:z,D[f++]=_t&64?I:z,D[f++]=_t&32?I:z,D[f++]=_t&16?I:z,D[f++]=_t&8?I:z,D[f++]=_t&4?I:z,D[f++]=_t&2?I:z,D[f++]=_t&1?I:z;for(;P<rt;P++)St===0&&(_t=p[d++],St=128),D[f++]=_t&St?I:z,St>>=1}for(;f<k;)D[f++]=0;r.putImageData(u,0,x*pi)}}else if(t.kind===Ih.RGBA_32BPP){for(S=0,E=i*pi*4,x=0;x<l;x++)y.set(p.subarray(d,d+E)),d+=E,r.putImageData(u,0,S),S+=pi;x<c&&(E=i*a*4,y.set(p.subarray(d,d+E)),r.putImageData(u,0,S))}else if(t.kind===Ih.RGB_24BPP)for(A=pi,E=i*A,x=0;x<c;x++){for(x>=l&&(A=a,E=i*A),f=0,S=E;S--;)y[f++]=p[d++],y[f++]=p[d++],y[f++]=p[d++],y[f++]=255;r.putImageData(u,0,x*pi)}else throw new Error(`bad image kind: ${t.kind}`)}function bv(r,t){if(t.bitmap){r.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,a=e%pi,l=(e-a)/pi,c=a===0?l:l+1,u=r.createImageData(i,pi);let d=0;const f=t.data,p=u.data;for(let y=0;y<c;y++){const x=y<l?pi:a;({srcPos:d}=RT({src:f,srcPos:d,dest:p,width:i,height:x,nonBlackColor:0})),r.putImageData(u,0,y*pi)}}function Rc(r,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)r[i]!==void 0&&(t[i]=r[i]);r.setLineDash!==void 0&&(t.setLineDash(r.getLineDash()),t.lineDashOffset=r.lineDashOffset)}function Rh(r){r.strokeStyle=r.fillStyle="#000000",r.fillRule="nonzero",r.globalAlpha=1,r.lineWidth=1,r.lineCap="butt",r.lineJoin="miter",r.miterLimit=10,r.globalCompositeOperation="source-over",r.font="10px sans-serif",r.setLineDash!==void 0&&(r.setLineDash([]),r.lineDashOffset=0);const{filter:t}=r;t!=="none"&&t!==""&&(r.filter="none")}function vv(r,t){if(t)return!0;zt.singularValueDecompose2dScale(r,Ri);const e=Math.fround(Ps.pixelRatio*yl.PDF_TO_CSS_UNITS);return Ri[0]<=e&&Ri[1]<=e}const kT=["butt","round","square"],OT=["miter","round","bevel"],LT={},xv={};class hl{constructor(t,e,i,a,l,{optionalContentConfig:c,markedContentStack:u=null},d,f,p){this.ctx=t,this.current=new gv(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=a,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new NT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:a=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=a||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,i){const d=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...nn(this.compositeCtx))}this.ctx.save(),Rh(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=nn(this.ctx)}executeOperatorList(t,e,i,a,l){const c=t.argsArray,u=t.fnArray;let d=e||0;const f=c.length;if(f===d)return d;const p=f-d>mv&&typeof i=="function",y=p?Date.now()+MT:0;let x=0;const S=this.commonObjs,A=this.objs;let E,R;for(;;){if(a!==void 0&&d===a.nextBreakPoint)return a.breakIt(d,i),d;if(!l||l(d))if(E=u[d],R=c[d]??null,E!==qc.dependency)R===null?this[E](d):this[E](d,...R);else for(const D of R){this.dependencyTracker?.recordNamedData(D,d);const k=D.startsWith("g_")?S:A;if(!k.has(D))return k.get(D,i),d}if(d++,d===f)return d;if(p&&++x>mv){if(Date.now()>y)return i(),d;x=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,a=t.height??t.displayHeight;let l=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),u=i,d=a,f="prescale1",p,y;for(;l>2&&u>1||c>2&&d>1;){let x=u,S=d;l>2&&u>1&&(x=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/x),c>2&&d>1&&(S=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/S),p=this.cachedCanvases.getCanvas(f,x,S),y=p.context,y.clearRect(0,0,x,S),y.drawImage(t,0,0,u,d,0,0,x,S),t=p.canvas,u=x,d=S,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const i=this.ctx,{width:a,height:l}=e,c=this.current.fillColor,u=this.current.patternFill,d=nn(i);let f,p,y,x;if((e.bitmap||e.data)&&e.count>1){const St=e.bitmap||e.data.buffer;p=JSON.stringify(u?d:[d.slice(0,4),c]),f=this._cachedBitmapsMap.get(St),f||(f=new Map,this._cachedBitmapsMap.set(St,f));const _t=f.get(p);if(_t&&!u){const Mt=Math.round(Math.min(d[0],d[2])+d[4]),Vt=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,Ki.transformAndFill),{canvas:_t,offsetX:Mt,offsetY:Vt}}y=_t}y||(x=this.cachedCanvases.getCanvas("maskCanvas",a,l),bv(x.context,e));let S=zt.transform(d,[1/a,0,0,-1/l,0,0]);S=zt.transform(S,[1,0,0,1,0,-l]);const A=ol.slice();zt.axialAlignedBoundingBox([0,0,a,l],S,A);const[E,R,D,k]=A,O=Math.round(D-E)||1,I=Math.round(k-R)||1,z=this.cachedCanvases.getCanvas("fillCanvas",O,I),H=z.context,P=E,rt=R;H.translate(-P,-rt),H.transform(...S),y||(y=this._scaleImage(x.canvas,Cs(H)),y=y.img,f&&u&&f.set(p,y)),H.imageSmoothingEnabled=vv(nn(H),e.interpolate),Th(H,y,0,0,y.width,y.height,0,0,a,l),H.globalCompositeOperation="source-in";const ut=zt.transform(Cs(H),[1,0,0,1,-P,-rt]);return H.fillStyle=u?c.getPattern(i,this,ut,Gn.FILL,t):c,H.fillRect(0,0,a,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,z.canvas)),this.dependencyTracker?.recordDependencies(t,Ki.transformAndFill),{canvas:z.canvas,offsetX:Math.round(P),offsetY:Math.round(rt)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=kT[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=OT[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const a=this.ctx;a.setLineDash!==void 0&&(a.setLineDash(e),a.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,a]of e)switch(i){case"LW":this.setLineWidth(t,a);break;case"LC":this.setLineCap(t,a);break;case"LJ":this.setLineJoin(t,a);break;case"ML":this.setMiterLimit(t,a);break;case"D":this.setDash(t,a[0],a[1]);break;case"RI":this.setRenderingIntent(t,a);break;case"FL":this.setFlatness(t,a);break;case"Font":this.setFont(t,a[0],a[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=a;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=a;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=a;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=a?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(a);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,a="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(a,e,i);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),Rc(this.suspendedCtx,c),DT(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Rc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,a){const l=a[0],c=a[1],u=a[2]-l,d=a[3]-c;u===0||d===0||(this.genericComposeSMask(e.context,i,u,d,e.subtype,e.backdrop,e.transferMap,l,c,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,a,l,c,u,d,f,p,y){let x=t.canvas,S=d-p,A=f-y;if(c)if(S<0||A<0||S+i>x.width||A+a>x.height){const R=this.cachedCanvases.getCanvas("maskExtension",i,a),D=R.context;D.drawImage(x,-S,-A),D.globalCompositeOperation="destination-atop",D.fillStyle=c,D.fillRect(0,0,i,a),D.globalCompositeOperation="source-over",x=R.canvas,S=A=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const R=new Path2D;R.rect(S,A,i,a),t.clip(R),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(S,A,i,a),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const E=new Path2D;E.rect(d,f,i,a),e.clip(E),e.globalCompositeOperation="destination-in",e.drawImage(x,S,A,i,a,d,f,i,a),e.restore()}save(t){this.inSMaskMode&&Rc(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Rc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,a,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,a,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,a){let[l]=i;if(!a){l||=i[0]=new Path2D,this[e](t,l);return}if(this.dependencyTracker!==null){const c=e===qc.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,a[0]-c,a[2]+c,a[1]-c,a[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=i[0]=Px(l)),zt.axialAlignedBoundingBox(a,nn(this.ctx),this.current.minMax),this[e](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const a=this.ctx,l=this.current.strokeColor;if(a.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?a.getTransform():null;if(a.save(),a.strokeStyle=l.getPattern(a,this,Cs(a),Gn.STROKE,t),c){const u=new Path2D;u.addPath(e,a.getTransform().invertSelf().multiplySelf(c)),e=u}this.rescaleAndStroke(e,!1),a.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,Ki.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(Gn.STROKE,nn(this.ctx))),a.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const a=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?a.getTransform():null;if(this.dependencyTracker?.save(t),a.save(),a.fillStyle=l.getPattern(a,this,Cs(a),Gn.FILL,t),f){const p=new Path2D;p.addPath(e,a.getTransform().invertSelf().multiplySelf(f)),e=p}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(a.fill(e,"evenodd"),this.pendingEOFill=!1):a.fill(e)),this.dependencyTracker?.recordDependencies(t,Ki.fill),u&&(a.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,Ki.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=LT}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=xv}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:a}=this;e!==void 0&&a.recordFutureForcedDependency("textClip",a.getOpenMarker()).recordFutureForcedDependency("textClip",t),a.recordCloseMarker(t)}if(e!==void 0){const a=new Path2D,l=i.getTransform().invertSelf();for(const{transform:c,x:u,y:d,fontSize:f,path:p}of e)p&&a.addPath(p,new DOMMatrix(c).preMultiplySelf(l).translate(u,d).scale(f,-f));i.clip(a)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const a=this.commonObjs.get(e),l=this.current;if(!a)throw new Error(`Can't find font for ${e}`);if(l.fontMatrix=a.fontMatrix||Zp,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&ie("Invalid font matrix for font "+e),i<0?(i=-i,l.fontDirection=-1):l.fontDirection=1,this.current.font=a,this.current.fontSize=i,a.isType3Font)return;const c=a.loadedName||"sans-serif",u=a.systemFontInfo?.css||`"${c}", ${a.fallbackName}`;let d="normal";a.black?d="900":a.bold&&(d="bold");const f=a.italic?"italic":"normal";let p=i;i<fv?p=fv:i>pv&&(p=pv),this.current.fontSizeScale=i/p,this.ctx.font=`${f} ${d} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const a=new Path2D;return a.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),a}paintChar(t,e,i,a,l,c){const u=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,y=d.fontSize/d.fontSizeScale,x=p&En.FILL_STROKE_MASK,S=!!(p&En.ADD_TO_PATH_FLAG),A=d.patternFill&&!f.missingFile,E=d.patternStroke&&!f.missingFile;let R;if((f.disableFontFace||S||A||E)&&!f.missingFile&&(R=f.getPathGenerator(this.commonObjs,e)),R&&(f.disableFontFace||A||E)){u.save(),u.translate(i,a),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let D;if(x===En.FILL||x===En.FILL_STROKE)if(l){D=u.getTransform(),u.setTransform(...l);const k=this.#i(R,D,l);u.fill(k)}else u.fill(R);if(x===En.STROKE||x===En.FILL_STROKE)if(c){D||=u.getTransform(),u.setTransform(...c);const{a:k,b:O,c:I,d:z}=D,H=zt.inverseTransform(c),P=zt.transform([k,O,I,z,0,0],H);zt.singularValueDecompose2dScale(P,Ri),u.lineWidth*=Math.max(Ri[0],Ri[1])/y,u.stroke(this.#i(R,D,c))}else u.lineWidth/=y,u.stroke(R);u.restore()}else(x===En.FILL||x===En.FILL_STROKE)&&(u.fillText(e,i,a),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a,()=>u.measureText(e))),(x===En.STROKE||x===En.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a,()=>u.measureText(e)).recordDependencies(t,Ki.stroke),u.strokeText(e,i,a));S&&((this.pendingTextPaths||=[]).push({transform:nn(u),x:i,y:a,fontSize:y,path:R}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,a))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let a=3;a<e.length;a+=4)if(e[a]>0&&e[a]<255){i=!0;break}return se(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,Ki.showText).resetBBox(t),this.current.textRenderingMode&En.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,a=i.font;if(a.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const l=i.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=i.fontSizeScale,d=i.charSpacing,f=i.wordSpacing,p=i.fontDirection,y=i.textHScale*p,x=e.length,S=a.vertical,A=S?1:-1,E=a.defaultVMetrics,R=l*i.fontMatrix[0],D=i.textRenderingMode===En.FILL&&!a.disableFontFace&&!i.patternFill;c.save(),i.textMatrix&&c.transform(...i.textMatrix),c.translate(i.x,i.y+i.textRise),p>0?c.scale(y,-1):c.scale(y,1);let k,O;const I=i.textRenderingMode&En.FILL_STROKE_MASK,z=I===En.FILL||I===En.FILL_STROKE,H=I===En.STROKE||I===En.FILL_STROKE;if(z&&i.patternFill){c.save();const _t=i.fillColor.getPattern(c,this,Cs(c),Gn.FILL,t);k=nn(c),c.restore(),c.fillStyle=_t}if(H&&i.patternStroke){c.save();const _t=i.strokeColor.getPattern(c,this,Cs(c),Gn.STROKE,t);O=nn(c),c.restore(),c.strokeStyle=_t}let P=i.lineWidth;const rt=i.textMatrixScale;if(rt===0||P===0?H&&(P=this.getSinglePixelWidth()):P/=rt,u!==1&&(c.scale(u,u),P/=u),c.lineWidth=P,a.isInvalidPDFjsFont){const _t=[];let Mt=0;for(const vt of e)_t.push(vt.unicode),Mt+=vt.width;const Vt=_t.join("");if(c.fillText(Vt,0,0),this.dependencyTracker!==null){const vt=c.measureText(Vt);this.dependencyTracker.recordBBox(t,this.ctx,-vt.actualBoundingBoxLeft,vt.actualBoundingBoxRight,-vt.actualBoundingBoxAscent,vt.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=Mt*R*y,c.restore(),this.compose();return}let ut=0,St;for(St=0;St<x;++St){const _t=e[St];if(typeof _t=="number"){ut+=A*_t*l/1e3;continue}let Mt=!1;const Vt=(_t.isSpace?f:0)+d,vt=_t.fontChar,Ht=_t.accent;let G,ct,yt=_t.width;if(S){const F=_t.vmetric||E,J=-(_t.vmetric?F[1]:yt*.5)*R,ht=F[2]*R;yt=F?-F[0]:yt,G=J/u,ct=(ut+ht)/u}else G=ut/u,ct=0;let Tt;if(a.remeasure&&yt>0){Tt=c.measureText(vt);const F=Tt.width*1e3/l*u;if(yt<F&&this.isFontSubpixelAAEnabled){const J=yt/F;Mt=!0,c.save(),c.scale(J,1),G/=J}else yt!==F&&(G+=(yt-F)/2e3*l/u)}if(this.contentVisible&&(_t.isInFont||a.missingFile)){if(D&&!Ht)c.fillText(vt,G,ct),this.dependencyTracker?.recordCharacterBBox(t,c,Tt?{bbox:null}:a,l/u,G,ct,()=>Tt??c.measureText(vt));else if(this.paintChar(t,vt,G,ct,k,O),Ht){const F=G+l*Ht.offset.x/u,J=ct-l*Ht.offset.y/u;this.paintChar(t,Ht.fontChar,F,J,k,O)}}const Pt=S?yt*R-Vt*p:yt*R+Vt*p;ut+=Pt,Mt&&c.restore()}S?i.y-=ut:i.x+=ut*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,a=this.current,l=a.font,c=a.fontSize,u=a.fontDirection,d=l.vertical?1:-1,f=a.charSpacing,p=a.wordSpacing,y=a.textHScale*u,x=a.fontMatrix||Zp,S=e.length,A=a.textRenderingMode===En.INVISIBLE;let E,R,D,k;if(A||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),a.textMatrix&&i.transform(...a.textMatrix),i.translate(a.x,a.y+a.textRise),i.scale(y,u);const O=this.dependencyTracker;for(this.dependencyTracker=O?new Qh(O,t):null,E=0;E<S;++E){if(R=e[E],typeof R=="number"){k=d*R*c/1e3,this.ctx.translate(k,0),a.x+=k*y;continue}const I=(R.isSpace?p:0)+f,z=l.charProcOperatorList[R.operatorListId];z?this.contentVisible&&(this.save(),i.scale(c,c),i.transform(...x),this.executeOperatorList(z),this.restore()):ie(`Type3 character "${R.operatorListId}" is not available.`);const H=[R.width,0];zt.applyTransform(H,x),D=H[0]*c+I,i.translate(D,0),a.x+=D*y}i.restore(),O&&(this.dependencyTracker=O)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,a,l,c,u){const d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,a,c,l,u).recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const a=this.baseTransform||nn(this.ctx),l={createCanvasGraphics:(c,u)=>new hl(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new Qh(this.dependencyTracker,u,!0):null)};i=new qm(e,this.ctx,l,a)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let a;return this.cachedPatterns.has(e)?a=this.cachedPatterns.get(e):(a=TT(this.getObject(t,e)),this.cachedPatterns.set(e,a)),i&&(a.matrix=i),a}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const a=this._getPattern(t,e);i.fillStyle=a.getPattern(i,this,Cs(i),Gn.SHADING,t);const l=Cs(i);if(l){const{width:c,height:u}=i.canvas,d=ol.slice();zt.axialAlignedBoundingBox([0,0,c,u],l,d);const[f,p,y,x]=d;this.ctx.fillRect(f,p,y-f,x-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,Ki.transform).recordDependencies(t,Ki.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Le("Should not call beginInlineImage")}beginImageData(){Le("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=nn(this.ctx),i)){zt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[a,l,c,u]=i,d=new Path2D;d.rect(a,l,c-a,u-l),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,a,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||ud("TODO: Support non-isolated groups."),e.knockout&&ie("Knockout groups not supported.");const a=nn(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let l=ol.slice();zt.axialAlignedBoundingBox(e.bbox,nn(i),l);const c=[0,0,i.canvas.width,i.canvas.height];l=zt.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),d=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),p=Math.max(Math.ceil(l[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const x=this.cachedCanvases.getCanvas(y,f,p),S=x.context;S.translate(-u,-d),S.transform(...a);let A=new Path2D;const[E,R,D,k]=e.bbox;if(A.rect(E,R,D-E,k-R),e.matrix){const O=new Path2D;O.addPath(A,new DOMMatrix(e.matrix)),A=O}S.clip(A),e.smask&&this.smaskStack.push({canvas:x.canvas,context:S,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,d),i.save()),Rc(i,S),this.ctx=S,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,a=this.groupStack.pop();if(this.ctx=a,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=nn(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=ol.slice();zt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l,c),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,e,i,a,l,c){if(this.#t(),Rh(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],d=i[3]-i[1];if(c&&this.annotationCanvasMap){a=a.slice(),a[4]-=i[0],a[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=d,zt.singularValueDecompose2dScale(nn(this.ctx),Ri);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:x,context:S}=this.annotationCanvas;this.annotationCanvasMap.set(e,x),this.annotationCanvas.savedCtx=this.ctx,this.ctx=S,this.ctx.save(),this.ctx.setTransform(Ri[0],0,0,-Ri[1],0,d*Ri[1]),Rh(this.ctx)}else{Rh(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],u,d),this.ctx.clip(f)}}this.current=new gv(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...a),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const a=this.ctx,l=this._createMaskCanvas(t,e),c=l.canvas;a.save(),a.setTransform(1,0,0,1,0,0),a.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),a.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,a=0,l=0,c,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=nn(d);d.transform(i,a,l,c,0,0);const p=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,x=u.length;y<x;y+=2){const S=zt.transform(f,[i,a,l,c,u[y],u[y+1]]);d.drawImage(p.canvas,S[4],S[5]),this.dependencyTracker?.recordBBox(t,this.ctx,S[4],S[4]+p.canvas.width,S[5],S[5]+p.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,a=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,Ki.transformAndFill);for(const c of e){const{data:u,width:d,height:f,transform:p}=c,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),x=y.context;x.save();const S=this.getObject(t,u,c);bv(x,S),x.globalCompositeOperation="source-in",x.fillStyle=l?a.getPattern(x,this,Cs(i),Gn.FILL,t):a,x.fillRect(0,0,d,f),x.restore(),i.save(),i.transform(...p),i.scale(1,-1),Th(i,y.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,d,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){ie("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,a,l){if(!this.contentVisible)return;const c=this.getObject(t,e);if(!c){ie("Dependent image isn't ready yet");return}const u=c.width,d=c.height,f=[];for(let p=0,y=l.length;p<y;p+=2)f.push({transform:[i,0,0,a,l[p],l[p+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:a}=t,l=this.cachedCanvases.getCanvas("inlineImage",i,a),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(e,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,a=e.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/i,-1/a);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,a).context;yv(p,e),u=this.applyTransferMapsToCanvas(p)}const d=this._scaleImage(u,Cs(l));l.imageSmoothingEnabled=vv(nn(l),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,i,-a,0).recordDependencies(t,Ki.imageXObject).recordOperation(t),Th(l,d.img,0,0,d.paintWidth,d.paintHeight,0,-a,i,a),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const a=this.ctx;let l;if(e.bitmap)l=e.bitmap;else{const c=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;yv(f,e),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of i)a.save(),a.transform(...c.transform),a.scale(1,-1),Th(a,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,a,0,1,-1,0),a.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,Ki.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const a=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const l=this.ctx;this.pendingClip?(a||(this.pendingClip===xv?l.clip(e,"evenodd"):l.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=nn(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),a=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,a)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:a,d:l}=this.ctx.getTransform();let c,u;if(i===0&&a===0){const d=Math.abs(e),f=Math.abs(l);if(d===f)if(t===0)c=u=1/d;else{const p=d*t;c=u=p<1?1/p:1}else if(t===0)c=1/d,u=1/f;else{const p=d*t,y=f*t;c=p<1?1/p:1,u=y<1?1/y:1}}else{const d=Math.abs(e*l-i*a),f=Math.hypot(e,i),p=Math.hypot(a,l);if(t===0)c=p/d,u=f/d;else{const y=t*d;c=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:a}}=this,[l,c]=this.getScaleForStroking();if(l===c){i.lineWidth=(a||1)*l,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(l,c),Op.a=1/l,Op.d=1/c;const d=new Path2D;if(d.addPath(t,Op),u.length>0){const f=Math.max(l,c);i.setLineDash(u.map(p=>p/f)),i.lineDashOffset/=f}i.lineWidth=a||1,i.stroke(d),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const r in qc)hl.prototype[r]!==void 0&&(hl.prototype[qc[r]]=hl.prototype[r]);class dl{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class jT{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const sl=Symbol("INTERNAL");class PT{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:a,rbGroups:l}){this.#t=!!(t&Ci.DISPLAY),this.#e=!!(t&Ci.PRINT),this.name=e,this.intent=i,this.usage=a,this.rbGroups=l}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==sl&&Le("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class BT{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=Ci.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new PT(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(sl,!1);for(const i of t.on)this.#e.get(i)._setVisible(sl,!0);for(const i of t.off)this.#e.get(i)._setVisible(sl,!1);this.#i=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let a=1;a<e;a++){const l=t[a];let c;if(Array.isArray(l))c=this.#s(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return ie(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return ud("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ie(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ie(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ie(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ie(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ie(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ie(`Unknown optional content policy ${t.policy}.`),!0}return ie(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const a=this.#e.get(t);if(!a){ie(`Optional content group not found: ${t}`);return}if(i&&e&&a.rbGroups.length)for(const l of a.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(sl,!1,!0);a._setVisible(sl,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const a of t){switch(a){case"ON":case"OFF":case"Toggle":i=a;continue}const l=this.#e.get(a);if(l)switch(i){case"ON":this.setVisibility(a,!0,e);break;case"OFF":this.setVisibility(a,!1,e);break;case"Toggle":this.setVisibility(a,!l.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Fx;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class pd{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,e,i){this._source=t,this.#t=e,this.#e=i}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Oe(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new this.#e(this,t,e);return this._rangeReaders.add(i),i}cancelAllRequests(t){this._fullReader?.cancel(t);for(const e of new Set(this._rangeReaders))e.cancel(t)}}class md{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){Le("Abstract method `read` called")}cancel(t){Le("Abstract method `cancel` called")}}class gd{_stream=null;constructor(t,e,i){this._stream=t}async read(){Le("Abstract method `read` called")}cancel(t){Le("Abstract method `cancel` called")}}function wv(r){return r instanceof Uint8Array&&r.byteLength===r.buffer.byteLength?r.buffer:new Uint8Array(r).buffer}class FT extends pd{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,IT,UT);const{pdfDataRangeTransport:e}=t,{initialData:i,progressiveDone:a}=e;if(i?.length>0){const l=wv(i);this._queuedChunks.push(l)}this._progressiveDone=a,e.addRangeListener((l,c)=>{this.#t(l,c)}),e.addProgressListener((l,c)=>{c!==void 0&&this._fullReader?.onProgress?.({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this.#t(void 0,l)}),e.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),e.transportReady()}#t(t,e){const i=wv(e);if(t===void 0)this._fullReader?this._fullReader._enqueue(i):this._queuedChunks.push(i);else{const a=this._rangeReaders.keys().find(l=>l._begin===t);Oe(a,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),a._enqueue(i)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onDone=()=>this._rangeReaders.delete(i),this._source.pdfDataRangeTransport.requestDataRange(t,e)),i}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class IT extends md{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:e,disableRange:i,disableStream:a}=t._source,{length:l,contentDispositionFilename:c}=e;this._queuedChunks=t._queuedChunks||[];for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._done=t._progressiveDone,this._contentLength=l,this._isStreamingSupported=!a,this._isRangeSupported=!i,Bm(c)&&(this._filename=c),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class UT extends gd{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,e,i){super(t,e,i),this._begin=e}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function zT(r){let t=!0,e=i("filename\\*","i").exec(r);if(e){e=e[1];let p=u(e);return p=unescape(p),p=d(p),p=f(p),l(p)}if(e=c(r),e){const p=f(e);return l(p)}if(e=i("filename","i").exec(r),e){e=e[1];let p=u(e);return p=f(p),l(p)}function i(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function a(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const x=new TextDecoder(p,{fatal:!0}),S=hd(y);y=x.decode(S),t=!1}catch{}}return y}function l(p){return t&&/[\x80-\xff]/.test(p)&&(p=a("utf-8",p),t&&(p=a("iso-8859-1",p))),p}function c(p){const y=[];let x;const S=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(x=S.exec(p))!==null;){let[,E,R,D]=x;if(E=parseInt(E,10),E in y){if(E===0)break;continue}y[E]=[R,D]}const A=[];for(let E=0;E<y.length&&E in y;++E){let[R,D]=y[E];D=u(D),R&&(D=unescape(D),E===0&&(D=d(D))),A.push(D)}return A.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let x=0;x<y.length;++x){const S=y[x].indexOf('"');S!==-1&&(y[x]=y[x].slice(0,S),y.length=x+1),y[x]=y[x].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function d(p){const y=p.indexOf("'");if(y===-1)return p;const x=p.slice(0,y),A=p.slice(y+1).replace(/^[^']*'/,"");return a(x,A)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,x,S,A){if(S==="q"||S==="Q")return A=A.replaceAll("_"," "),A=A.replaceAll(/=([0-9a-fA-F]{2})/g,function(E,R){return String.fromCharCode(parseInt(R,16))}),a(x,A);try{A=atob(A)}catch{}return a(x,A)})}return""}function Kx(r,t){const e=new Headers;if(!r||!t||typeof t!="object")return e;for(const i in t){const a=t[i];a!==void 0&&e.append(i,a)}return e}function yd(r){return URL.parse(r)?.origin??null}function Vx({responseHeaders:r,isHttp:t,rangeChunkSize:e,disableRange:i}){const a={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(r.get("Content-Length"),10);return!Number.isInteger(l)||(a.suggestedLength=l,l<=2*e)||i||!t||r.get("Accept-Ranges")!=="bytes"||(r.get("Content-Encoding")||"identity")!=="identity"||(a.allowRangeRequests=!0),a}function $x(r){const t=r.get("Content-Disposition");if(t){let e=zT(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(Bm(e))return e}return null}function bd(r,t){return new Yh(`Unexpected server response (${r}) while retrieving PDF "${t}".`,r,r===404||r===0&&t.startsWith("file:"))}function Xx(r,t){if(r!==t)throw new Error(`Expected range response-origin "${r}" to match "${t}".`)}function Yx(r,t,e,i){return fetch(r,{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"})}function Qx(r,t){if(r!==200&&r!==206)throw bd(r,t)}function Wx(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ie(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class HT extends pd{_responseOrigin=null;constructor(t){super(t,qT,GT),this.isHttp=/^https?:/i.test(t.url),this.headers=Kx(this.isHttp,t.httpHeaders)}}class qT extends md{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:a,rangeChunkSize:l,url:c,withCredentials:u}=t._source;this._contentLength=a,this._isStreamingSupported=!i,this._isRangeSupported=!e;const d=new Headers(t.headers);Yx(c,d,u,this._abortController).then(f=>{t._responseOrigin=yd(f.url),Qx(f.status,c),this._reader=f.body.getReader();const p=f.headers,{allowRangeRequests:y,suggestedLength:x}=Vx({responseHeaders:p,isHttp:t.isHttp,rangeChunkSize:l,disableRange:e});this._isRangeSupported=y,this._contentLength=x||this._contentLength,this._filename=$x(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new cr("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Wx(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class GT extends gd{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const{url:a,withCredentials:l}=t._source,c=new Headers(t.headers);c.append("Range",`bytes=${e}-${i-1}`),Yx(a,c,l,this._abortController).then(u=>{const d=yd(u.url);Xx(d,t._responseOrigin),Qx(u.status,a),this._reader=u.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:Wx(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Lp=200,Sv=206;function KT(r){return typeof r!="string"?r:hd(r).buffer}class VT extends pd{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,$T,XT),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=Kx(this.isHttp,t.httpHeaders)}_request(t){const e=new XMLHttpRequest,i={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(e,i),e.open("GET",this.url),e.withCredentials=this._source.withCredentials;for(const[a,l]of this.headers)e.setRequestHeader(a,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.validateStatus=a=>a===Sv||a===Lp):i.validateStatus=a=>a===Lp,e.responseType="arraybuffer",Oe(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>t.onError(e.status),e.onreadystatechange=this.#i.bind(this,e),e.onprogress=this.#e.bind(this,e),e.send(null),e}#e(t,e){this.#t.get(t)?.onProgress?.(e)}#i(t,e){const i=this.#t.get(t);if(!i||(t.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){i.onError(t.status);return}const a=t.status||Lp;if(!i.validateStatus(a)){i.onError(t.status);return}const l=KT(t.response);if(a===Sv){const c=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(c)?i.onDone(l):(ie('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone(l):i.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onClosed=()=>this._rangeReaders.delete(i)),i}}class $T extends md{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:e}=t._source;this._contentLength=e,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:this.#n.bind(this)})}#t(){const t=this._stream,{disableRange:e,rangeChunkSize:i}=t._source,a=this._fullRequestXhr;t._responseOrigin=yd(a.responseURL);const l=a.getAllResponseHeaders(),c=new Headers(l?l.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[p,...y]=f.split(": ");return[p,y.join(": ")]}):[]),{allowRangeRequests:u,suggestedLength:d}=Vx({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:i,disableRange:e});u&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=$x(c),this._isRangeSupported&&t._abortRequest(a),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}#i(t){this._storedError=bd(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class XT extends gd{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,e,i){super(t,e,i),this._requestXhr=t._request({begin:e,end:i,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:null})}#t(){const t=yd(this._requestXhr?.responseURL);try{Xx(t,this._stream._responseOrigin)}catch(e){this._storedError=e,this.#i(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#i(t){this._storedError??=bd(t,this._stream.url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const YT=/^[a-z][a-z0-9\-+.]+:/i;function QT(r){if(YT.test(r))return new URL(r);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(r))}function Zx(r){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(r):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(r)}function Jx(r){return r instanceof Uint8Array?r.buffer:r instanceof ArrayBuffer?r:(ie(`getArrayBuffer - unexpected data format: ${r}`),new Uint8Array(r).buffer)}class WT extends pd{constructor(t){super(t,ZT,JT),this.url=QT(t.url),Oe(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class ZT extends md{_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:a,rangeChunkSize:l}=t._source;this._contentLength=a,this._isStreamingSupported=!i,this._isRangeSupported=!e;const c=t.url,u=process.getBuiltinModule("fs");u.promises.lstat(c).then(d=>{const f=u.createReadStream(c),p=Zx(f);this._reader=p.getReader();const{size:y}=d;y<=2*l&&(this._isRangeSupported=!1),this._contentLength=y,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new cr("Streaming is disabled.")),this._headersCapability.resolve()}).catch(d=>{d.code==="ENOENT"&&(d=bd(0,c.href)),this._headersCapability.reject(d)})}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Jx(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class JT extends gd{_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const a=t.url,l=process.getBuiltinModule("fs");try{const c=l.createReadStream(a,{start:e,end:i-1}),u=Zx(c);this._reader=u.getReader(),this._readCapability.resolve()}catch(c){this._readCapability.reject(c)}}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:Jx(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const Mc=Symbol("INITIAL_DATA");class tw{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Mc}}get(t,e=null){if(e){const a=this.#e(t);return a.promise.then(()=>e(a.data)),null}const i=this.#t[t];if(!i||i.data===Mc)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Mc}delete(t){const e=this.#t[t];return!e||e.data===Mc?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Mc&&(yield[t,e])}}}const t2=1e5,Av=30;class Ti{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#s=null;#r=null;#a=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#A=null;static#x=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=i.scale*Ps.pixelRatio,this.#d=i.rotation,this.#r={div:null,properties:null,ctx:null};const{pageWidth:a,pageHeight:l,pageX:c,pageY:u}=i.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#o=a,this.#a=l,Ti.#M(),e.style.setProperty("--min-font-size",Ti.#A),no(e,i),this.#t.promise.finally(()=>{Ti.#x.delete(this),this.#r=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=Cn.platform;return se(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),Ti.#x.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Ps.pixelRatio,a=t.rotation;if(a!==this.#d&&(e?.(),this.#d=a,no(this.#l,{rotation:a})),i!==this.#h){e?.(),this.#h=i;const l={div:null,properties:null,ctx:Ti.#D(this.#s)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#_(l)}}cancel(){const t=new cr("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#C(t){if(this.#i)return;this.#r.ctx??=Ti.#D(this.#s);const e=this.#u,i=this.#g;for(const a of t){if(e.length>t2){ie("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(a.str===void 0){if(a.type==="beginMarkedContentProps"||a.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),a.id&&this.#e.setAttribute("id",`${a.id}`),a.tag==="Artifact"&&(this.#e.ariaHidden=!0),l.append(this.#e)}else a.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(a.str),this.#w(a)}}#w(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const a=zt.transform(this.#y,t.transform);let l=Math.atan2(a[1],a[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#n&&c.fontSubstitution||c.fontFamily;u=Ti.fontFamilyMap.get(u)||u;const d=Math.hypot(a[2],a[3]),f=d*Ti.#B(u,c,this.#s);let p,y;l===0?(p=a[4],y=a[5]-f):(p=a[4]+f*Math.sin(l),y=a[5]-f*Math.cos(l));const x=e.style;x.left=`${(100*p/this.#o).toFixed(2)}%`,x.top=`${(100*y/this.#a).toFixed(2)}%`,x.setProperty("--font-height",`${d.toFixed(2)}px`),x.fontFamily=u,i.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(i.angle=l*(180/Math.PI));let S=!1;if(t.str.length>1)S=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const A=Math.abs(t.transform[0]),E=Math.abs(t.transform[3]);A!==E&&Math.max(A,E)/Math.min(A,E)>1.5&&(S=!0)}if(S&&(i.canvasWidth=c.vertical?t.height:t.width),this.#p.set(e,i),this.#r.div=e,this.#r.properties=i,this.#_(this.#r),i.hasText&&this.#e.append(e),i.hasEOL){const A=document.createElement("br");A.setAttribute("role","presentation"),this.#e.append(A)}}#_(t){const{div:e,properties:i,ctx:a}=t,{style:l}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=l,{canvasWidth:u,fontSize:d}=i;Ti.#R(a,d*this.#h,c);const{width:f}=a.measureText(e.textContent);f>0&&l.setProperty("--scale-x",u*this.#h/f)}i.angle!==0&&l.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#x.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#D(t=null){let e=this.#b.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#R(t,e,i){const a=this.#E.get(t);e===a.size&&i===a.family||(t.font=`${e}px ${i}`,a.size=e,a.family=i)}static#M(){if(this.#A!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#A=t.getBoundingClientRect().height,t.remove()}static#B(t,e,i){const a=this.#v.get(t);if(a)return a;const l=this.#D(i);l.canvas.width=l.canvas.height=Av,this.#R(l,Av,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,d=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+d):(Cn.platform.isFirefox&&ie("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}}const e2=100;function ew(r={}){typeof r=="string"||r instanceof URL?r={url:r}:(r instanceof ArrayBuffer||ArrayBuffer.isView(r))&&(r={data:r});const t=new Gm,{docId:e}=t,i=r.url?cT(r.url):null,a=r.data?uT(r.data):null,l=r.httpHeaders||null,c=r.withCredentials===!0,u=r.password??null,d=r.range instanceof nw?r.range:null,f=Number.isInteger(r.rangeChunkSize)&&r.rangeChunkSize>0?r.rangeChunkSize:2**16;let p=r.worker instanceof Kc?r.worker:null;const y=r.verbosity,x=typeof r.docBaseUrl=="string"&&!dd(r.docBaseUrl)?r.docBaseUrl:null,S=Ah(r.cMapUrl),A=r.cMapPacked!==!1,E=r.CMapReaderFactory||(ni?bT:ov),R=Ah(r.iccUrl),D=Ah(r.standardFontDataUrl),k=r.StandardFontDataFactory||(ni?vT:lv),O=Ah(r.wasmUrl),I=r.WasmFactory||(ni?xT:cv),z=r.stopAtErrors!==!0,H=Number.isInteger(r.maxImageSize)&&r.maxImageSize>-1?r.maxImageSize:-1,P=r.isEvalSupported!==!1,rt=typeof r.isOffscreenCanvasSupported=="boolean"?r.isOffscreenCanvasSupported:!ni,ut=typeof r.isImageDecoderSupported=="boolean"?r.isImageDecoderSupported:!ni&&(Cn.platform.isFirefox||!globalThis.chrome),St=Number.isInteger(r.canvasMaxAreaInBytes)?r.canvasMaxAreaInBytes:-1,_t=typeof r.disableFontFace=="boolean"?r.disableFontFace:ni,Mt=r.fontExtraProperties===!0,Vt=r.enableXfa===!0,vt=r.ownerDocument||globalThis.document,Ht=r.disableRange===!0,G=r.disableStream===!0,ct=r.disableAutoFetch===!0,yt=r.pdfBug===!0,Tt=r.CanvasFactory||(ni?yT:pT),Pt=r.FilterFactory||(ni?gT:mT),F=r.enableHWA===!0,J=r.useWasm!==!1,ht=d?d.length:r.length??NaN,xt=typeof r.useSystemFonts=="boolean"?r.useSystemFonts:!ni&&!_t,Dt=typeof r.useWorkerFetch=="boolean"?r.useWorkerFetch:!!(E===ov&&k===lv&&I===cv&&S&&D&&O&&Lc(S,document.baseURI)&&Lc(D,document.baseURI)&&Lc(O,document.baseURI)),qt=null;PC(y);const Bt={canvasFactory:new Tt({ownerDocument:vt,enableHWA:F}),filterFactory:new Pt({docId:e,ownerDocument:vt}),cMapReaderFactory:Dt?null:new E({baseUrl:S,isCompressed:A}),standardFontDataFactory:Dt?null:new k({baseUrl:D}),wasmFactory:Dt?null:new I({baseUrl:O})};p||(p=Kc.create({verbosity:y,port:dl.workerPort}),t._worker=p);const he={docId:e,apiVersion:"5.4.624",data:a,password:u,disableAutoFetch:ct,rangeChunkSize:f,length:ht,docBaseUrl:x,enableXfa:Vt,evaluatorOptions:{maxImageSize:H,disableFontFace:_t,ignoreErrors:z,isEvalSupported:P,isOffscreenCanvasSupported:rt,isImageDecoderSupported:ut,canvasMaxAreaInBytes:St,fontExtraProperties:Mt,useSystemFonts:xt,useWasm:J,useWorkerFetch:Dt,cMapUrl:S,iccUrl:R,standardFontDataUrl:D,wasmUrl:O}},de={ownerDocument:vt,pdfBug:yt,styleElement:qt,enableHWA:F,loadingParams:{disableAutoFetch:ct,enableXfa:Vt}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Rt=p.messageHandler.sendWithPromise("GetDocRequest",he,a?[a.buffer]:null);let pe;if(d)pe=new FT({pdfDataRangeTransport:d,disableRange:Ht,disableStream:G});else if(!a){if(!i)throw new Error("getDocument - no `url` parameter provided.");const Xt=Lc(i)?HT:ni?WT:VT;pe=new Xt({url:i,length:ht,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:Ht,disableStream:G})}return Rt.then(Xt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const Ce=new jc(e,Xt,p.port),On=new s2(Ce,t,pe,de,Bt);t._transport=On,Ce.send("Ready",null)})}).catch(t._capability.reject),t}class Gm{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Gm.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class nw{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#s=[];constructor(t,e,i=!1,a=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=a}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Le("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class n2{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return se(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class i2{#t=!1;#e=Ne.instance;constructor(t,e,i,a=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=a?new tv:null,this._pdfBug=a,this.commonObjs=i.commonObjs,this.objs=new tw,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:a=0,dontFlip:l=!1}={}){return new eu({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:a,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return se(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:a="display",annotationMode:l=rr.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:x=!1,recordOperations:S=!1,operationsFilter:A=null}){this._stats?.time("Overall");const E=this._transport.getRenderingIntent(a,l,y,x),{renderingIntent:R,cacheKey:D}=E;this.#t=!1,d||=this._transport.getOptionalContentConfig(R);let k=this._intentStates.get(D);k||(k=Object.create(null),this._intentStates.set(D,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const O=!!(R&Ci.PRINT);k.displayReadyCapability||(k.displayReadyCapability=Promise.withResolvers(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(E));const I=!!(this._pdfBug&&globalThis.StepperManager?.enabled),z=!this.recordedBBoxes&&(S||I),H=ut=>{if(k.renderTasks.delete(P),z){const St=P.gfx?.dependencyTracker.take();St&&(P.stepper&&P.stepper.setOperatorBBoxes(St,P.gfx.dependencyTracker.takeDebugMetadata()),S&&(this.recordedBBoxes=St))}O&&(this.#t=!0),this.#i(),ut?(P.capability.reject(ut),this._abortOperatorList({intentState:k,reason:ut instanceof Error?ut:new Error(ut)})):P.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},P=new ll({callback:H,params:{canvas:e,canvasContext:t,dependencyTracker:z?new ST(e,k.operatorList.length,I):null,viewport:i,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!O,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:A});(k.renderTasks||=new Set).add(P);const rt=P.task;return Promise.all([k.displayReadyCapability.promise,d]).then(([ut,St])=>{if(this.destroyed){H();return}if(this._stats?.time("Rendering"),!(St.renderingIntent&R))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");P.initializeGraphics({transparency:ut,optionalContentConfig:St}),P.operatorListChanged()}).catch(H),rt}getOperatorList({intent:t="display",annotationMode:e=rr.ENABLE,printAnnotationStorage:i=null,isEditing:a=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const c=this._transport.getRenderingIntent(t,e,i,a,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(a){return a.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Gc.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,a){function l(){c.read().then(function({value:d,done:f}){if(f){i(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),l()},a)}const c=e.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#i();return t&&e&&(this._stats&&=new tv),e}#i(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,a=t.length;i<a;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#i()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:a}){const{map:l,transfer:c}=i,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:l,modifiedIds:a},c).getReader(),f=this._intentStates.get(e);f.streamReader=d;const p=()=>{d.read().then(({value:y,done:x})=>{if(x){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const x of f.renderTasks)x.operatorListChanged();this.#i()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Pm){let a=e2;e.extraDelay>0&&e.extraDelay<1e3&&(a+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},a);return}}if(t.streamReader.cancel(new cr(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[a,l]of this._intentStates)if(l===t){this._intentStates.delete(a);break}this.cleanup()}}}get stats(){return this._stats}}var or,ns,ga,Xr,Zh,Yr,Qr,si,Uh,iw,sw,Pc,fl,zh;const tn=class tn{constructor({name:t=null,port:e=null,verbosity:i=BC()}={}){As(this,si);As(this,or,Promise.withResolvers());As(this,ns,null);As(this,ga,null);As(this,Xr,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Je(tn,Qr).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Je(tn,Qr).set(e,this),Es(this,si,iw).call(this,e)}else Es(this,si,sw).call(this)}get promise(){return Je(this,or).promise}get port(){return Je(this,ga)}get messageHandler(){return Je(this,ns)}destroy(){this.destroyed=!0,Je(this,Xr)?.terminate(),di(this,Xr,null),Je(tn,Qr).delete(Je(this,ga)),di(this,ga,null),Je(this,ns)?.destroy(),di(this,ns,null)}static create(t){const e=Je(this,Qr).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new tn(t)}static get workerSrc(){if(dl.workerSrc)return dl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return se(this,"_setupFakeWorkerGlobal",(async()=>Je(this,fl,zh)?Je(this,fl,zh):(await import(this.workerSrc)).WorkerMessageHandler)())}};or=new WeakMap,ns=new WeakMap,ga=new WeakMap,Xr=new WeakMap,Zh=new WeakMap,Yr=new WeakMap,Qr=new WeakMap,si=new WeakSet,Uh=function(){Je(this,or).resolve(),Je(this,ns).send("configure",{verbosity:this.verbosity})},iw=function(t){di(this,ga,t),di(this,ns,new jc("main","worker",t)),Je(this,ns).on("ready",()=>{}),Es(this,si,Uh).call(this)},sw=function(){if(Je(tn,Yr)||Je(tn,fl,zh)){Es(this,si,Pc).call(this);return}let{workerSrc:t}=tn;try{tn._isSameOrigin(window.location,t)||(t=tn._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new jc("main","worker",e),a=()=>{l.abort(),i.destroy(),e.terminate(),this.destroyed?Je(this,or).reject(new Error("Worker was destroyed")):Es(this,si,Pc).call(this)},l=new AbortController;e.addEventListener("error",()=>{Je(this,Xr)||a()},{signal:l.signal}),i.on("test",u=>{if(l.abort(),this.destroyed||!u){a();return}di(this,ns,i),di(this,ga,e),di(this,Xr,e),Es(this,si,Uh).call(this)}),i.on("ready",u=>{if(l.abort(),this.destroyed){a();return}try{c()}catch{Es(this,si,Pc).call(this)}});const c=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};c();return}catch{ud("The worker has been disabled.")}Es(this,si,Pc).call(this)},Pc=function(){Je(tn,Yr)||(ie("Setting up fake worker."),di(tn,Yr,!0)),tn._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Je(this,or).reject(new Error("Worker was destroyed"));return}const e=new fT;di(this,ga,e);const i=`fake${Jb(tn,Zh)._++}`,a=new jc(i+"_worker",i,e);t.setup(a,e),di(this,ns,new jc(i,i+"_worker",e)),Es(this,si,Uh).call(this)}).catch(t=>{Je(this,or).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},fl=new WeakSet,zh=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},As(tn,fl),As(tn,Zh,0),As(tn,Yr,!1),As(tn,Qr,new WeakMap),ni&&(di(tn,Yr,!0),dl.workerSrc||="./pdf.worker.mjs"),tn._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const a=new URL(e,i);return i.origin===a.origin},tn._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},tn.fromPort=t=>{if(YC("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return tn.create(t)};let Kc=tn;class s2{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#i=null;#n=new Map;#s=new Map;#r=new Map;#a=null;#o=Ne.instance;constructor(t,e,i,a,l){this.messageHandler=t,this.loadingTask=e,this.#i=i,this.commonObjs=new tw,this.fontLoader=new rT({ownerDocument:a.ownerDocument,styleElement:a.styleElement}),this.enableHWA=a.enableHWA,this.loadingParams=a.loadingParams,this._params=a,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const t=new Map,e=new Map;for(let i=0,a=this.#o.pagesNumber;i<a;i++){const l=this.#o.getPrevPageNumber(i+1)-1,c=this.#n.get(l);c&&t.set(i,c);const u=this.#s.get(l);u&&e.set(i,u)}this.#n=t,this.#s=e}#l(t,e=null){const i=this.#e.get(t);if(i)return i;const a=this.messageHandler.sendWithPromise(t,e);return this.#e.set(t,a),a}#d({loaded:t,total:e}){this.loadingTask.onProgress?.({loaded:t,total:e,percent:qn(Math.round(t/e*100),0,100)})}get annotationStorage(){return se(this,"annotationStorage",new Um)}getRenderingIntent(t,e=rr.ENABLE,i=null,a=!1,l=!1){let c=Ci.DISPLAY,u=sm;switch(t){case"any":c=Ci.ANY;break;case"display":break;case"print":c=Ci.PRINT;break;default:ie(`getRenderingIntent - invalid intent: ${t}`)}const d=c&Ci.PRINT&&i instanceof Ix?i:this.annotationStorage;switch(e){case rr.DISABLE:c+=Ci.ANNOTATIONS_DISABLE;break;case rr.ENABLE:break;case rr.ENABLE_FORMS:c+=Ci.ANNOTATIONS_FORMS;break;case rr.ENABLE_STORAGE:c+=Ci.ANNOTATIONS_STORAGE,u=d.serializable;break;default:ie(`getRenderingIntent - invalid annotationMode: ${e}`)}a&&(c+=Ci.IS_EDITING),l&&(c+=Ci.OPLIST);const{ids:f,hash:p}=d.modifiedIds,y=[c,u.hash,p];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#n.values())t.push(i._destroy());this.#n.clear(),this.#s.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),Ti.cleanup(),this.#i?.cancelAllRequests(new cr("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,a)=>{Oe(this.#i,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#i.getFullReader(),this.#t.onProgress=l=>this.#d(l),a.onPull=()=>{this.#t.read().then(function({value:l,done:c}){if(c){a.close();return}Oe(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{a.error(l)})},a.onCancel=l=>{this.#t.cancel(l),a.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async i=>{await this.#t.headersReady;const{isStreamingSupported:a,isRangeSupported:l,contentLength:c}=this.#t;return a&&l&&(this.#t.onProgress=null),{isStreamingSupported:a,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(i,a)=>{Oe(this.#i,"GetRangeReader - no `BasePDFStream` instance available.");const l=this.#i.getRangeReader(i.begin,i.end);if(!l){a.close();return}a.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){a.close();return}Oe(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),a.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{a.error(c)})},a.onCancel=c=>{l.cancel(c),a.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this.#o.pagesNumber=i.numPages,this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new n2(i,this))}),t.on("DocException",i=>{e._capability.reject(fi(i))}),t.on("PasswordRequest",i=>{this.#a=Promise.withResolvers();try{if(!e.onPassword)throw fi(i);const a=l=>{l instanceof Error?this.#a.reject(l):this.#a.resolve({password:l})};e.onPassword(a,i.code)}catch(a){this.#a.reject(a)}return this.#a.promise}),t.on("DataLoaded",i=>{this.#d({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#n.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,a,l])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(a){case"Font":if("error"in l){const y=l.error;ie(`Error during font loading: ${y}`),this.commonObjs.resolve(i,y);break}const c=new Ge(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,x)=>globalThis.FontInspector.fontAdded(y,x):null,d=new oT(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:f}=l;Oe(f,"The imageRef must be defined.");for(const y of this.#n.values())for(const[,x]of y.objs)if(x?.ref===f)return x.dataLen?(this.commonObjs.resolve(i,structuredClone(x)),x.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new lT(l));break;case"Image":this.commonObjs.resolve(i,l);break;case"Pattern":const p=new Nn(l);this.commonObjs.resolve(i,p.getIR());break;default:throw new Error(`Got unknown common object type ${a}`)}return null}),t.on("obj",([i,a,l,c])=>{if(this.destroyed)return;const u=this.#n.get(a);if(!u.objs.has(i)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(i,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",i=>{this.destroyed||this.#d(i)}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const a=this[i.type];if(!a)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return a.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ie("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#o.getPageId(t)-1,a=this.#s.get(e);if(a)return a;const l=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(c=>{if(this.destroyed)throw new Error("Transport destroyed");c.refStr&&this.#r.set(c.refStr,i);const u=new i2(e,c,this,this._params.pdfBug);return this.#n.set(e,u),u});return this.#s.set(e,l),l}async getPageIndex(t){if(!am(t))throw new Error("Invalid pageIndex request.");const e=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#o.getPageNumber(e+1)-1}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(t+1)-1,intent:e})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#l("GetOptionalContentConfig").then(e=>new BT(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#e.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(a=>({info:a[0],metadata:a[1]?new jT(a[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:a[2]}));return this.#e.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#n.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),Ti.cleanup()}}cachedPageNumber(t){if(!am(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,i=this.#r.get(e);return i>=0?this.#o.getPageNumber(i+1):null}}class a2{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this._internalRenderTask;return t.form||t.canvas&&e?.size>0}}class ll{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:a,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:x=null,enableHWA:S=!1,operationsFilter:A=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=a,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=y,this.pageColors=x,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new a2(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=S,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=A}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(ll.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");ll.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:a,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new hl(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:a,viewport:i,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),ll.#e.delete(this._canvas),t||=new Pm(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),ll.#e.delete(this._canvas),this.callback())))}}const r2="5.4.624",o2="384c6208b";let aw=class Ms{#t=null;#e=null;#i;#n=null;#s=!1;#r=!1;#a=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return se(this,"_keyboardManager",new iu([[["Escape","mac+Escape"],Ms.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],Ms.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],Ms.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],Ms.prototype._moveToPrevious],[["Home","mac+Home"],Ms.prototype._moveToBeginning],[["End","mac+End"],Ms.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#r=!1,this.#a=t):this.#r=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",Ms.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#a&&(t.ariaControls=`${this.#a.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",Xi,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#a&&(t.id=`${this.#a.id}_colorpicker_dropdown`);for(const[i,a]of this.#l.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",a),l.title=i,l.setAttribute("data-l10n-id",Ms.#d[i]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=a,l.ariaSelected=a===this.#i,l.addEventListener("click",this.#f.bind(this,a),{signal:e}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:we.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#n.lastElementChild?.focus()}#g(t){Ms._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#s=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#r){if(!this.#p){this.#a?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}};class Vc{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Vc.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:i}=this.#e,a=this.#t=document.createElement("input");return a.type="color",a.value=i||"#000000",a.className="basicColorPicker",a.tabIndex=0,a.setAttribute("data-l10n-id",Vc.#n[t]),a.addEventListener("input",()=>{this.#i.updateParams(e,a.value)},{signal:this.#i._signal}),a}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function Ev(r){return Math.floor(Math.max(0,Math.min(1,r))*255).toString(16).padStart(2,"0")}function Dc(r){return Math.max(0,Math.min(255,255*r))}class _v{static CMYK_G([t,e,i,a]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+a)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=Dc(t),[t,t,t]}static G_HTML([t]){const e=Ev(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(Dc)}static RGB_HTML(t){return`#${t.map(Ev).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,a]){return["RGB",1-Math.min(1,t+a),1-Math.min(1,i+a),1-Math.min(1,e+a)]}static CMYK_rgb([t,e,i,a]){return[Dc(1-Math.min(1,t+a)),Dc(1-Math.min(1,i+a)),Dc(1-Math.min(1,e+a))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const a=1-t,l=1-e,c=1-i,u=Math.min(a,l,c);return["CMYK",a,l,c,u]}}class l2{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const a=this._createSVG("svg:svg");return a.setAttribute("version","1.1"),i||(a.setAttribute("width",`${t}px`),a.setAttribute("height",`${e}px`)),a.setAttribute("preserveAspectRatio","none"),a.setAttribute("viewBox",`0 0 ${t} ${e}`),a}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Le("Abstract method `_createSVG` called.")}}class Wh extends l2{_createSVG(t){return document.createElementNS(pa,t)}}const c2=9,io=new WeakSet,u2=new Date().getTimezoneOffset()*60*1e3;class jp{static create(t){switch(t.data.annotationType){case Sn.LINK:return new Km(t);case Sn.TEXT:return new d2(t);case Sn.WIDGET:switch(t.data.fieldType){case"Tx":return new f2(t);case"Btn":return t.data.radioButton?new rw(t):t.data.checkBox?new m2(t):new g2(t);case"Ch":return new y2(t);case"Sig":return new p2(t)}return new ro(t);case Sn.POPUP:return new lm(t);case Sn.FREETEXT:return new ow(t);case Sn.LINE:return new v2(t);case Sn.SQUARE:return new x2(t);case Sn.CIRCLE:return new w2(t);case Sn.POLYLINE:return new lw(t);case Sn.CARET:return new A2(t);case Sn.INK:return new Vm(t);case Sn.POLYGON:return new S2(t);case Sn.HIGHLIGHT:return new cw(t);case Sn.UNDERLINE:return new E2(t);case Sn.SQUIGGLY:return new _2(t);case Sn.STRIKEOUT:return new C2(t);case Sn.STAMP:return new uw(t);case Sn.FILEATTACHMENT:return new T2(t);default:return new sn(t)}}}class sn{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:a=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),a&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return sn._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:a}=this.data;let l=-1/0,c=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>c?(c=e[u+1],l=e[u+2]):e[u+1]===c&&(l=Math.max(l,e[u+2]));return[l,c]}if(i?.length>=1){for(const u of i)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>c?(c=u[d+1],l=u[d]):u[d+1]===c&&(l=Math.max(l,u[d]));if(l!==1/0)return[l,c]}return a?[a[2],a[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:a,pageX:l,pageY:c}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-l)/i,t[1]=100*(t[1]-c)/a,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Hc}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Hc}${e.id}`,{id:e.id,annotationType:e.annotationType,page:this.parent.page,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#n(e);let a=this.#i?.popup||this.popup;!a&&i?.text&&(this._createPopup(i),a=this.#i.popup),a&&(a.updateEdited(t),i?.deleted&&(a.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:i,rotation:a},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:d}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/l}%`,e.top=`${100*(c-t[3]+d)/c}%`,a===0?(e.width=`${100*(t[2]-t[0])/l}%`,e.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(a)}_createContainer(t){const{data:e,parent:{page:i,viewport:a}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",e.id),!(this instanceof ro)&&!(this instanceof Km)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(l.title=e.alternativeText),e.noRotate&&l.classList.add("norotate"),!e.rect||this instanceof lm){const{rotation:E}=e;return!e.hasOwnCanvas&&E!==0&&this.setRotation(E,l),l}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){c.borderWidth=`${e.borderStyle.width}px`;const E=e.borderStyle.horizontalCornerRadius,R=e.borderStyle.verticalCornerRadius;if(E>0||R>0){const k=`calc(${E}px * var(--total-scale-factor)) / calc(${R}px * var(--total-scale-factor))`;c.borderRadius=k}else if(this instanceof rw){const k=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;c.borderRadius=k}switch(e.borderStyle.style){case il.SOLID:c.borderStyle="solid";break;case il.DASHED:c.borderStyle="dashed";break;case il.BEVELED:ie("Unimplemented border style: beveled");break;case il.INSET:ie("Unimplemented border style: inset");break;case il.UNDERLINE:c.borderBottomStyle="solid";break}const D=e.borderColor||null;D?(this.#e=!0,c.borderColor=zt.makeHexColor(D[0]|0,D[1]|0,D[2]|0)):c.borderWidth=0}const f=zt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:y,pageX:x,pageY:S}=a.rawDims;c.left=`${100*(f[0]-x)/p}%`,c.top=`${100*(f[1]-S)/y}%`;const{rotation:A}=e;return e.hasOwnCanvas||A===0?(c.width=`${100*u/p}%`,c.height=`${100*d/y}%`):this.setRotation(A,l),l}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:a}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),e.style.width=`${100*l/i}%`,e.style.height=`${100*c/a}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,a)=>{const l=a.detail[e],c=l[0],u=l.slice(1);a.target.style[i]=_v[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:_v[`${c}_rgb`](u)})};return se(this,"_commonActions",{display:e=>{const{display:i}=e.detail,a=i%2===1;this.container.style.visibility=a?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:a,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const a of Object.keys(e.detail))(t[a]||i[a])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[a,l]of Object.entries(e)){const c=i[a];if(c){const u={detail:{[a]:l},target:t};c(u),delete e[a]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,a,l]=this.data.rect.map(E=>Math.fround(E));if(t.length===8){const[E,R,D,k]=t.subarray(2,6);if(a===E&&l===R&&e===D&&i===k)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:E,borderWidth:R}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${E}" stroke-width="${R}">`],this.container.classList.add("hasBorder")}const d=a-e,f=l-i,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const x=p.createElement("defs");y.append(x);const S=p.createElement("clipPath"),A=`clippath_${this.data.id}`;S.setAttribute("id",A),S.setAttribute("clipPathUnits","objectBoundingBox"),x.append(S);for(let E=2,R=t.length;E<R;E+=8){const D=t[E],k=t[E+1],O=t[E+2],I=t[E+3],z=p.createElement("rect"),H=(O-e)/d,P=(l-k)/f,rt=(D-O)/d,ut=(k-I)/f;z.setAttribute("x",H),z.setAttribute("y",P),z.setAttribute("width",rt),z.setAttribute("height",ut),S.append(z),u?.push(`<rect vector-effect="non-scaling-stroke" x="${H}" y="${P}" width="${rt}" height="${ut}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${A})`}_createPopup(t=null){const{data:e}=this;let i,a;t?(i={str:t.text},a=t.date):(i=e.contentsObj,a=e.modificationDate),this.#i=new lm({data:{color:e.color,titleObj:e.titleObj,modificationDate:a,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Le("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const a=this._fieldObjects[t];if(a)for(const{page:l,id:c,exportValues:u}of a){if(l===-1||c===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!io.has(f)){ie(`_getElementsByName - element not allowed: ${c}`);continue}i.push({id:c,exportValue:d,domElement:f})}return i}for(const a of document.getElementsByName(t)){const{exportValue:l}=a,c=a.getAttribute("data-element-id");c!==e&&io.has(a)&&i.push({id:c,exportValue:l,domElement:a})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class h2 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class Km extends sn{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let a=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),a=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),a=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),a=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),a=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),a=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),a=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),a=!0):this.isTooltipOnly&&!a&&(this._bindLink(i,""),a=!0)),this.container.classList.add("linkAnnotation"),a&&(this.contentElement=i,this.container.append(i)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",a=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,a),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const a of Object.keys(e.actions)){const l=i.get(a);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:a}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ie('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:a,refs:l,include:c}=e,u=[];if(a.length!==0||l.length!==0){const p=new Set(l);for(const y of a){const x=this._fieldObjects[y]||[];for(const{id:S}of x)p.add(S)}for(const y of Object.values(this._fieldObjects))for(const x of y)p.has(x.id)===c&&u.push(x)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const S=p.defaultValue||"";d.setValue(y,{value:S});break}case"checkbox":case"radiobutton":{const S=p.defaultValue===p.exportValues;d.setValue(y,{value:S});break}case"combobox":case"listbox":{const S=p.defaultValue||"";d.setValue(y,{value:S});break}default:continue}const x=document.querySelector(`[data-element-id="${y}"]`);if(x){if(!io.has(x)){ie(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;x.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class d2 extends sn{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class ro extends sn{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return Cn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,a,l){i.includes("mouse")?t.addEventListener(i,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(i,c=>{if(i==="blur"){if(!e.focused||!c.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:a,value:l(c)}})})}_setEventListeners(t,e,i,a){for(const[l,c]of i)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,l,c,a),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":zt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,a=this.data.defaultAppearanceData.fontSize||c2,l=t.style;let c;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(Rp*a))||1,y=f/p;c=Math.min(a,d(y/Rp))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(a,d(f/Rp))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=zt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(l.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class f2 extends ro{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,a){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[e]=i),l.setValue(c.id,{[a]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const a=t.getValue(e,{value:this.data.fieldValue});let l=a.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=a.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),io.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,x=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",A=>{t.setValue(e,{value:A.target.value}),this.setPropertyOnSiblings(i,"value",A.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",A=>{const E=this.data.defaultFieldValue??"";i.value=d.userValue=E,d.formattedValue=null});let S=A=>{const{formattedValue:E}=d;E!=null&&(A.target.value=E),A.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",E=>{if(d.focused)return;const{target:R}=E;if(x&&(R.type=p,y&&(R.step=y)),d.userValue){const D=d.userValue;if(x)if(p==="time"){const k=new Date(D),O=[k.getHours(),k.getMinutes(),k.getSeconds()];R.value=O.map(I=>I.toString().padStart(2,"0")).join(":")}else R.value=new Date(D-u2).toISOString().split(p==="date"?"T":".",1)[0];else R.value=D}d.lastCommittedValue=R.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",E=>{this.showElementAndHideCanvas(E.target);const R={value(D){d.userValue=D.detail.value??"",x||t.setValue(e,{value:d.userValue.toString()}),D.target.value=d.userValue},formattedValue(D){const{formattedValue:k}=D.detail;d.formattedValue=k,k!=null&&D.target!==document.activeElement&&(D.target.value=k);const O={formattedValue:k};x&&(O.value=k),t.setValue(e,O)},selRange(D){D.target.setSelectionRange(...D.detail.selRange)},charLimit:D=>{const{charLimit:k}=D.detail,{target:O}=D;if(k===0){O.removeAttribute("maxLength");return}O.setAttribute("maxLength",k);let I=d.userValue;!I||I.length<=k||(I=I.slice(0,k),O.value=d.userValue=I,t.setValue(e,{value:I}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:I,willCommit:!0,commitKey:1,selStart:O.selectionStart,selEnd:O.selectionEnd}}))}};this._dispatchEventFromSandbox(R,E)}),i.addEventListener("keydown",E=>{d.commitKey=1;let R=-1;if(E.key==="Escape"?R=0:E.key==="Enter"&&!this.data.multiLine?R=2:E.key==="Tab"&&(d.commitKey=3),R===-1)return;const{value:D}=E.target;d.lastCommittedValue!==D&&(d.lastCommittedValue=D,d.userValue=D,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,willCommit:!0,commitKey:R,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}}))});const A=S;S=null,i.addEventListener("blur",E=>{if(!d.focused||!E.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:R}=E;let{value:D}=R;if(x){if(D&&p==="time"){const k=D.split(":").map(O=>parseInt(O,10));D=new Date(2e3,0,1,k[0],k[1],k[2]||0).valueOf(),R.step=""}else D.includes("T")||(D=`${D}T00:00`),D=new Date(D).valueOf();R.type="text"}d.userValue=D,d.lastCommittedValue!==D&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:D,willCommit:!0,commitKey:d.commitKey,selStart:E.target.selectionStart,selEnd:E.target.selectionEnd}}),A(E)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",E=>{d.lastCommittedValue=null;const{data:R,target:D}=E,{value:k,selectionStart:O,selectionEnd:I}=D;let z=O,H=I;switch(E.inputType){case"deleteWordBackward":{const P=k.substring(0,O).match(/\w*[^\w]*$/);P&&(z-=P[0].length);break}case"deleteWordForward":{const P=k.substring(O).match(/^[^\w]*\w*/);P&&(H+=P[0].length);break}case"deleteContentBackward":O===I&&(z-=1);break;case"deleteContentForward":O===I&&(H+=1);break}E.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,change:R||"",willCommit:!1,selStart:z,selEnd:H}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],E=>E.target.value)}if(S&&i.addEventListener("blur",S),this.data.comb){const E=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${E}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class p2 extends ro{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class m2 extends ro{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof a=="string"&&(a=a!=="Off",t.setValue(i,{value:a})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return io.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.setAttribute("exportValue",e.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i)){const p=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue||"Off";c.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(i,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class rw extends ro{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let a=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof a=="string"&&(a=a!==e.buttonValue,t.setValue(i,{value:a})),a)for(const c of this._getElementsByName(e.fieldName,i))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(io.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=e.fieldName,a&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue;c.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const c=e.buttonValue;l.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const p=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const x=p&&y.id===i;y.domElement&&(y.domElement.checked=x),t.setValue(y.id,{value:x})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class g2 extends Km{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class y2 extends ro{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),a=document.createElement("select");io.add(a),a.setAttribute("data-element-id",e),a.disabled=this.data.readOnly,this._setRequired(a,this.data.required),a.name=this.data.fieldName,a.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(a.size=this.data.options.length,this.data.multiSelect&&(a.multiple=!0)),a.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const x of a.options)x.selected=x.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,i.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),l=!1),a.append(y)}let c=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),a.prepend(p),c=()=>{p.remove(),a.removeEventListener("input",c),c=null},a.addEventListener("input",c)}const u=p=>{const y=p?"value":"textContent",{options:x,multiple:S}=a;return S?Array.prototype.filter.call(x,A=>A.selected).map(A=>A[y]):x.selectedIndex===-1?null:x[x.selectedIndex][y]};let d=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,x=>({displayValue:x.textContent,exportValue:x.value}))};return this.enableScripting&&this.hasJSActions?(a.addEventListener("updatefromsandbox",p=>{const y={value(x){c?.();const S=x.detail.value,A=new Set(Array.isArray(S)?S:[S]);for(const E of a.options)E.selected=A.has(E.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(x){a.multiple=!0},remove(x){const S=a.options,A=x.detail.remove;S[A].selected=!1,a.remove(A),S.length>0&&Array.prototype.findIndex.call(S,R=>R.selected)===-1&&(S[0].selected=!0),t.setValue(e,{value:u(!0),items:f(x)}),d=u(!1)},clear(x){for(;a.length!==0;)a.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(x){const{index:S,displayValue:A,exportValue:E}=x.detail.insert,R=a.children[S],D=document.createElement("option");D.textContent=A,D.value=E,R?R.before(D):a.append(D),t.setValue(e,{value:u(!0),items:f(x)}),d=u(!1)},items(x){const{items:S}=x.detail;for(;a.length!==0;)a.remove(0);for(const A of S){const{displayValue:E,exportValue:R}=A,D=document.createElement("option");D.textContent=E,D.value=R,a.append(D)}a.options.length>0&&(a.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(x)}),d=u(!1)},indices(x){const S=new Set(x.detail.indices);for(const A of x.target.options)A.selected=S.has(A.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(x){x.target.disabled=!x.detail.editable}};this._dispatchEventFromSandbox(y,p)}),a.addEventListener("input",p=>{const y=u(!0),x=u(!1);t.setValue(e,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:x,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(a,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):a.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(a),this._setBackgroundColor(a),this._setDefaultPropertiesFromJS(a),this.container.append(a),this.container}}class lm extends sn{constructor(t){const{data:e,elements:i,parent:a}=t,l=!!a._commentManager;if(super(t,{isRenderable:!l&&sn._hasPopupData(e)}),this.elements=i,l&&sn._hasPopupData(e)){const c=this.popup=this.#t();for(const u of i)u.popup=c}else this.popup=null}#t(){return new b2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const a of this.elements)a.popup=e,a.container.ariaHasPopup="dialog",i.push(a.data.id),a.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(a=>`${rl}${a}`).join(",")),this.container}}class b2{#t=null;#e=this.#G.bind(this);#i=this.#I.bind(this);#n=this.#O.bind(this);#s=this.#S.bind(this);#r=null;#a=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#A=null;#x=null;#C=!1;#w=null;#_=null;constructor({container:t,color:e,elements:i,titleObj:a,modificationDate:l,contentsObj:c,richText:u,parent:d,rect:f,parentRect:p,open:y,commentManager:x=null}){this.#a=t,this.#A=a,this.#o=c,this.#E=u,this.#d=d,this.#r=e,this.#b=f,this.#h=p,this.#l=i,this.#t=x,this.#w=i[0],this.#c=em.toDateObject(l),this.trigger=i.flatMap(S=>S.getElementsToTriggerPopup()),x||(this.#D(),this.#a.hidden=!0,y&&this.#S())}#D(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const e of this.trigger)e.addEventListener("click",this.#s,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#w.container.after(this.#p);return}if(this.#y||this.#R(),!this.#y)return;const{signal:t}=this.#m=new AbortController,e=this.#w.hasOwnCommentButton,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},a=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#w.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#w.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#B(),this.#M(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",a,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#M(){if(this.#w.extraPopupElement&&!this.#w.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#y,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#B(){this.#w.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#w.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}=this.#w.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:a,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#w.commentText,this.#_}set comment(t){t!==this.comment&&(this.#w.commentText=this.#_=t)}focus(){this.#w.container?.focus()}get parentBoundingClientRect(){return this.#w.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:a,y:l,width:c,height:u}=this.#w.layer.getBoundingClientRect();return[(t-a)/c,(e+i-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#v||this.commentButtonPosition.map(f=>f/100),a=this.parentBoundingClientRect,{x:l,y:c,width:u,height:d}=a;this.#t.showDialog(null,this,l+e*u,c+i*d,{...t,parentDimensions:a})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#r){const i=t.style.outlineColor=zt.makeHexColor(...this.#r);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#A?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#A}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}jx({html:this.#k||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#a.append(t)}get#k(){const t=this.#E,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#L(){return this.#k?.attributes?.style?.fontSize||0}get#F(){return this.#k?.attributes?.style?.color||null}#j(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},a={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))e.push({name:"span",value:l,attributes:a});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#S()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#_=null):e&&(e.deleted?this.remove():(this.#B(),this.#_=e.text)),t&&(this.#y=null,this.#R(),this.#M());return}if(i||e?.deleted){this.remove();return}this.#D(),this.#x||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),e&&e.text&&(this.#E=this.#j(e.text),this.#c=em.toDateObject(e.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#x&&({contentsObj:this.#o,richText:this.#E}=this.#x,this.#x=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:a,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const A of this.#l)if(!u||zt.intersect(A.data.rect,u)!==null){u=A.data.rect,c=!0;break}const d=zt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=c?u[2]-u[0]+5:0,y=d[0]+p,x=d[1];this.#u=[100*(y-a)/e,100*(x-l)/i];const{style:S}=this.#a;S.left=`${this.#u[0]}%`,S.top=`${this.#u[1]}%`}#S(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#O(),this.#a.addEventListener("click",this.#s),this.#a.addEventListener("keydown",this.#e)):(this.#I(),this.#a.removeEventListener("click",this.#s),this.#a.removeEventListener("keydown",this.#e))}#O(){this.#g||this.render(),this.isVisible?this.#f&&this.#a.classList.add("focused"):(this.#T(),this.#a.hidden=!1,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)+1e3)}#I(){this.#a.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#a.hidden=!0,this.#a.style.zIndex=parseInt(this.#a.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#a.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#C&&(this.#g||this.#O(),this.#C=!1,this.#a.hidden=!1))}get isVisible(){return this.#t?!1:this.#a.hidden===!1}}class ow extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=oe.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class v2 extends sn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),a.append(l),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class x2 extends sn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",e-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class w2 extends sn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,a=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",e/2),c.setAttribute("cy",i/2),c.setAttribute("rx",e/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),a.append(c),this.container.append(a),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class lw extends sn{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:a},width:l,height:c}=this;if(!e)return this.container;const u=this.svgFactory.create(l,c,!0);let d=[];for(let p=0,y=e.length;p<y;p+=2){const x=e[p]-t[0],S=t[3]-e[p+1];d.push(`${x},${S}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!a&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class S2 extends lw{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class A2 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Vm extends sn{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?oe.HIGHLIGHT:oe.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:a,popupRef:l}}=this,{transform:c,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",a.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let y=0,x=i.length;y<x;y++){const S=this.svgFactory.createElement(this.svgElementName);this.#e.push(S),S.setAttribute("points",i[y].join(",")),p.append(S)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:a}=t,l=this.#t;if(e>=0&&l.setAttribute("stroke-width",e||1),i)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",i[c].join(","));if(a){const{transform:c,width:u,height:d}=this.#i(this.data.rotation,a);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class cw extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=oe.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class E2 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class _2 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class C2 extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class uw extends sn{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=oe.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class T2 extends sn{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:a}=Cn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(a?l.metaKey:l.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class $m{#t=null;#e=null;#i=null;#n=new Map;#s=null;#r=null;#a=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:a,page:l,viewport:c,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:p}){this.div=t,this.#t=e,this.#e=i,this.#s=u||null,this.#r=f||null,this.#i=p||new Um,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=a,this._commentManager=d||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,i=this.div;no(i,this.viewport);const a=new Map,l=[],c={data:null,layer:i,linkService:this.#r,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Wh,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const d=u.annotationType===Sn.POPUP;if(d){const y=a.get(u.id);if(!y)continue;if(!this._commentManager){l.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=jp.create(c);if(!f.isRenderable)continue;if(!d&&(this.#a.push(f),u.popupRef)){const y=a.get(u.popupRef);y?y.push(f):a.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const d=c.elements=a.get(u.id);c.data=u;const f=jp.create(c);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${rl}${u.id}`,u.hidden&&(p.style.visibility="hidden"),d.at(-1).container.after(p)}this.#l()}async#c(){if(this.#a.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:i,data:{id:a}}of this.#a){const l=i.id=`${rl}${a}`;t.push(this.#s?.getAriaAttributes(l).then(c=>{if(c)for(const[u,d]of c)i.setAttribute(u,d)}))}}this.#a.sort(({data:{rect:[i,a,l,c]}},{data:{rect:[u,d,f,p]}})=>{if(i===l&&a===c)return 1;if(u===f&&d===p)return-1;const y=c,x=a,S=(a+c)/2,A=p,E=d,R=(d+p)/2;if(S>=A&&R<=x)return-1;if(R>=y&&S<=E)return 1;const D=(i+l)/2,k=(u+f)/2;return D-k});const e=document.createDocumentFragment();for(const i of this.#a)e.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&e.append(i.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const i of this.#a)this.#t.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#r,svgFactory:new Wh,parent:this};for(const i of t){i.borderStyle||=$m._defaultBorderStyle,e.data=i;const a=jp.create(e);a.isRenderable&&(a.render(),a.contentElement.id=`${rl}${i.id}`,this.#a.push(a))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,no(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const a=t.querySelector(`[data-annotation-id="${e}"]`);if(!a)continue;i.className="annotationContent";const{firstChild:l}=a;l?l.nodeName==="CANVAS"?l.replaceWith(i):l.classList.contains("annotationContent")?l.after(i):l.before(i):a.append(i);const c=this.#n.get(e);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,a.id,i),c._hasNoCanvas=!1):c.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:a}=t,l=new h2({data:{id:i,rect:t.getPDFRect(),rotation:a},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#r,annotationStorage:this.#i});return l.render(),l.contentElement.id=`${rl}${i}`,l.createOrUpdatePopup(),this.#a.push(l),l}removeAnnotation(t){const e=this.#a.findIndex(a=>a.data.id===t);if(e<0)return;const[i]=this.#a.splice(e,1);this.#t?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return se(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:il.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Mh=/\r\n?|\n/g;class kn extends Wt{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=kn.prototype,e=l=>l.isEmpty(),i=ur.TRANSLATE_SMALL,a=ur.TRANSLATE_BIG;return se(this,"_keyboardManager",new iu([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-a,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[a,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-a],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,a],checker:e}]]))}static _type="freetext";static _editorType=oe.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||kn._defaultColor||Wt._defaultLineColor,this.#n=t.fontSize||kn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){Wt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case we.FREETEXT_SIZE:kn._defaultFontSize=e;break;case we.FREETEXT_COLOR:kn._defaultColor=e;break}}updateParams(t,e){switch(t){case we.FREETEXT_SIZE:this.#s(e);break;case we.FREETEXT_COLOR:this.#r(e);break}}static get defaultPropertiesToUpdate(){return[[we.FREETEXT_SIZE,kn._defaultFontSize],[we.FREETEXT_COLOR,kn._defaultColor||Wt._defaultLineColor]]}get propertiesToUpdate(){return[[we.FREETEXT_SIZE,this.#n],[we.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Vc(this),[["colorPicker",this._colorPicker]]}get colorType(){return we.FREETEXT_COLOR}#s(t){const e=a=>{this.editorDiv.style.fontSize=`calc(${a}px * var(--total-scale-factor))`,this.translate(0,-(a-this.#n)*this.parentScale),this.#n=a,this.#o()},i=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#r(t){const e=a=>{this.color=a,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-kn._internalPadding*t,-(kn._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#a(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(kn.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:a,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",a.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#a().trimEnd();if(t===e)return;const i=a=>{if(this.#t=a,!a){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){kn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[a,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,p]=this.pageDimensions,[y,x]=this.pageTranslation;let S,A;switch(this.rotation){case 0:S=t+(c[0]-y)/f,A=e+this.height-(c[1]-x)/p;break;case 90:S=t+(c[0]-y)/f,A=e-(c[1]-x)/p,[u,d]=[d,-u];break;case 180:S=t-this.width+(c[0]-y)/f,A=e-(c[1]-x)/p,[u,d]=[-u,-d];break;case 270:S=t+(c[0]-y-this.height*p)/f,A=e+(c[1]-x-this.width*f)/p,[u,d]=[-d,u];break}this.setAt(S*a,A*l,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Mh,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const a=kn.#h(e.getData("text")||"").replaceAll(Mh,`
`);if(!a)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!a.includes(`
`)){c.insertNode(document.createTextNode(a)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:d}=c,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const S=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(Mh,"")),S!==this.editorDiv){let A=f;for(const E of this.editorDiv.childNodes){if(E===S){A=p;continue}A.push(kn.#c(E))}}f.push(u.nodeValue.slice(0,d).replaceAll(Mh,""))}else if(u===this.editorDiv){let S=f,A=0;for(const E of this.editorDiv.childNodes)A++===d&&(S=p),S.push(kn.#c(E))}this.#t=`${f.join(`
`)}${a}${p.join(`
`)}`,this.#l();const y=new Range;let x=Math.sumPrecise(f.map(S=>S.length));for(const{firstChild:S}of this.editorDiv.childNodes)if(S.nodeType===Node.TEXT_NODE){const A=S.nodeValue.length;if(x<=A){y.setStart(S,x),y.setEnd(S,x);break}x-=A}l.removeAllRanges(),l.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=kn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let a=null;if(t instanceof ow){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:f,id:p,popupRef:y,richText:x,contentsObj:S,creationDate:A,modificationDate:E},textContent:R,textPosition:D,parent:{page:{pageNumber:k}}}=t;if(!R||R.length===0)return null;a=t={annotationType:oe.FREETEXT,color:Array.from(u),fontSize:c,value:R.join(`
`),position:D,pageIndex:k-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:S?.str||null,richText:x,creationDate:A,modificationDate:E}}const l=await super.deserialize(t,e,i);return l.#n=t.fontSize,l.color=zt.makeHexColor(...t.color),l.#t=kn.#h(t.value),l._initialData=a,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Wt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((c,u)=>c!==a[u])||t.pageIndex!==l}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const a of this.#t.split(`
`)){const l=document.createElement("div");l.append(a?document.createTextNode(a):document.createElement("br")),e.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Gt{static PRECISION=1e-4;toSVGPath(){Le("Abstract method `toSVGPath` must be implemented.")}get box(){Le("Abstract getter `box` must be implemented.")}serialize(t,e){Le("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u]*a,c[u+1]=i+t[u+1]*l;return c}static _rescaleAndSwap(t,e,i,a,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u+1]*a,c[u+1]=i+t[u]*l;return c}static _translate(t,e,i,a){a||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)a[l]=e+t[l],a[l+1]=i+t[l+1];return a}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,a,l){switch(l){case 90:return[1-e/i,t/a];case 180:return[1-t/i,1-e/a];case 270:return[e/i,1-t/a];default:return[t/i,e/a]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,a,l,c){return[(t+5*i)/6,(e+5*a)/6,(5*i+l)/6,(5*a+c)/6,(i+l)/2,(a+c)/2]}}class $r{#t;#e=[];#i;#n;#s=[];#r=new Float32Array(18);#a;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=$r.#g+$r.#m;constructor({x:t,y:e},i,a,l,c,u=0){this.#t=i,this.#h=l*a,this.#n=c,this.#r.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=$r.#g*a,this.#c=$r.#u*a,this.#d=a,this.#f.push(t,e)}isEmpty(){return isNaN(this.#r[8])}#p(){const t=this.#r.subarray(4,6),e=this.#r.subarray(16,18),[i,a,l,c]=this.#t;return[(this.#a+(t[0]-e[0])/2-i)/l,(this.#o+(t[1]-e[1])/2-a)/c,(this.#a+(e[0]-t[0])/2-i)/l,(this.#o+(e[1]-t[1])/2-a)/c]}add({x:t,y:e}){this.#a=t,this.#o=e;const[i,a,l,c]=this.#t;let[u,d,f,p]=this.#r.subarray(8,12);const y=t-f,x=e-p,S=Math.hypot(y,x);if(S<this.#c)return!1;const A=S-this.#l,E=A/S,R=E*y,D=E*x;let k=u,O=d;u=f,d=p,f+=R,p+=D,this.#f?.push(t,e);const I=-D/A,z=R/A,H=I*this.#h,P=z*this.#h;return this.#r.set(this.#r.subarray(2,8),0),this.#r.set([f+H,p+P],4),this.#r.set(this.#r.subarray(14,18),12),this.#r.set([f-H,p-P],16),isNaN(this.#r[6])?(this.#s.length===0&&(this.#r.set([u+H,d+P],2),this.#s.push(NaN,NaN,NaN,NaN,(u+H-i)/l,(d+P-a)/c),this.#r.set([u-H,d-P],14),this.#e.push(NaN,NaN,NaN,NaN,(u-H-i)/l,(d-P-a)/c)),this.#r.set([k,O,u,d,f,p],6),!this.isEmpty()):(this.#r.set([k,O,u,d,f,p],6),Math.abs(Math.atan2(O-d,k-u)-Math.atan2(D,R))<Math.PI/2?([u,d,f,p]=this.#r.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((u+f)/2-i)/l,((d+p)/2-a)/c),[u,d,k,O]=this.#r.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((k+u)/2-i)/l,((O+d)/2-a)/c),!0):([k,O,u,d,f,p]=this.#r.subarray(0,6),this.#s.push(((k+5*u)/6-i)/l,((O+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+p)/6-a)/c,((u+f)/2-i)/l,((d+p)/2-a)/c),[f,p,u,d,k,O]=this.#r.subarray(12,18),this.#e.push(((k+5*u)/6-i)/l,((O+5*d)/6-a)/c,((5*u+f)/6-i)/l,((5*d+p)/6-a)/c,((u+f)/2-i)/l,((d+p)/2-a)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#r[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let a=6;a<t.length;a+=6)isNaN(t[a])?i.push(`L${t[a+4]} ${t[a+5]}`):i.push(`C${t[a]} ${t[a+1]} ${t[a+2]} ${t[a+3]} ${t[a+4]} ${t[a+5]}`);this.#b(i);for(let a=e.length-6;a>=6;a-=6)isNaN(e[a])?i.push(`L${e[a+4]} ${e[a+5]}`):i.push(`C${e[a]} ${e[a+1]} ${e[a+2]} ${e[a+3]} ${e[a+4]} ${e[a+5]}`);return this.#v(i),i.join(" ")}#y(){const[t,e,i,a]=this.#t,[l,c,u,d]=this.#p();return`M${(this.#r[2]-t)/i} ${(this.#r[3]-e)/a} L${(this.#r[4]-t)/i} ${(this.#r[5]-e)/a} L${l} ${c} L${u} ${d} L${(this.#r[16]-t)/i} ${(this.#r[17]-e)/a} L${(this.#r[14]-t)/i} ${(this.#r[15]-e)/a} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,i,a,l]=this.#t,c=this.#r.subarray(4,6),u=this.#r.subarray(16,18),[d,f,p,y]=this.#p();t.push(`L${(c[0]-e)/a} ${(c[1]-i)/l} L${d} ${f} L${p} ${y} L${(u[0]-e)/a} ${(u[1]-i)/l}`)}newFreeDrawOutline(t,e,i,a,l,c){return new hw(t,e,i,a,l,c)}getOutlines(){const t=this.#s,e=this.#e,i=this.#r,[a,l,c,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let y=0,x=d.length-2;y<x;y+=2)d[y]=(this.#f[y]-a)/c,d[y+1]=(this.#f[y+1]-l)/u;if(d[d.length-2]=(this.#a-a)/c,d[d.length-1]=(this.#o-l)/u,isNaN(i[6])&&!this.isEmpty())return this.#E(d);const f=new Float32Array(this.#s.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#x(f,p);for(let y=e.length-6;y>=6;y-=6)for(let x=0;x<6;x+=2){if(isNaN(e[y+x])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[y+x],f[p+1]=e[y+x+1],p+=2}return this.#A(f,p),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#n)}#E(t){const e=this.#r,[i,a,l,c]=this.#t,[u,d,f,p]=this.#p(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-i)/l,(e[3]-a)/c,NaN,NaN,NaN,NaN,(e[4]-i)/l,(e[5]-a)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-i)/l,(e[17]-a)/c,NaN,NaN,NaN,NaN,(e[14]-i)/l,(e[15]-a)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#i,this.#n)}#A(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#x(t,e){const i=this.#r.subarray(4,6),a=this.#r.subarray(16,18),[l,c,u,d]=this.#t,[f,p,y,x]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-c)/d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,x,NaN,NaN,NaN,NaN,(a[0]-l)/u,(a[1]-c)/d],e),e+=24}}class hw extends Gt{#t;#e=new Float32Array(4);#i;#n;#s;#r;#a;constructor(t,e,i,a,l,c){super(),this.#a=t,this.#s=e,this.#t=i,this.#r=a,this.#i=l,this.#n=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,d,f,p]=this.#e;for(let y=0,x=t.length;y<x;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-d)/p;for(let y=0,x=e.length;y<x;y+=2)e[y]=(e[y]-u)/f,e[y+1]=(e[y+1]-d)/p}toSVGPath(){const t=[`M${this.#a[4]} ${this.#a[5]}`];for(let e=6,i=this.#a.length;e<i;e+=6){if(isNaN(this.#a[e])){t.push(`L${this.#a[e+4]} ${this.#a[e+5]}`);continue}t.push(`C${this.#a[e]} ${this.#a[e+1]} ${this.#a[e+2]} ${this.#a[e+3]} ${this.#a[e+4]} ${this.#a[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,a],l){const c=i-t,u=a-e;let d,f;switch(l){case 0:d=Gt._rescale(this.#a,t,a,c,-u),f=Gt._rescale(this.#s,t,a,c,-u);break;case 90:d=Gt._rescaleAndSwap(this.#a,t,e,c,u),f=Gt._rescaleAndSwap(this.#s,t,e,c,u);break;case 180:d=Gt._rescale(this.#a,i,e,-c,u),f=Gt._rescale(this.#s,i,e,-c,u);break;case 270:d=Gt._rescaleAndSwap(this.#a,i,a,-c,-u),f=Gt._rescaleAndSwap(this.#s,i,a,-c,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#a;let i=e[4],a=e[5];const l=[i,a,i,a];let c=i,u=a,d=i,f=a;const p=t?Math.max:Math.min,y=new Float32Array(4);for(let S=6,A=e.length;S<A;S+=6){const E=e[S+4],R=e[S+5];isNaN(e[S])?(zt.pointBoundingBox(E,R,l),u>R?(c=E,u=R):u===R&&(c=p(c,E)),f<R?(d=E,f=R):f===R&&(d=p(d,E))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,zt.bezierBoundingBox(i,a,...e.slice(S,S+6),y),zt.rectBoundingBox(y[0],y[1],y[2],y[3],l),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=p(c,y[0])),f<y[3]?(d=y[2],f=y[3]):f===y[3]&&(d=p(d,y[2]))),i=E,a=R}const x=this.#e;x[0]=l[0]-this.#i,x[1]=l[1]-this.#i,x[2]=l[2]-l[0]+2*this.#i,x[3]=l[3]-l[1]+2*this.#i,this.firstPoint=[c,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,i,a,l,c=0){return new $r(t,e,i,a,l,c)}getNewOutline(t,e){const[i,a,l,c]=this.#e,[u,d,f,p]=this.#t,y=l*f,x=c*p,S=i*f+u,A=a*p+d,E=this.newOutliner({x:this.#s[0]*y+S,y:this.#s[1]*x+A},this.#t,this.#r,t,this.#n,e??this.#i);for(let R=2;R<this.#s.length;R+=2)E.add({x:this.#s[R]*y+S,y:this.#s[R+1]*x+A});return E.getOutlines()}}class cm{#t;#e;#i;#n=[];#s=[];constructor(t,e=0,i=0,a=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:E,y:R,width:D,height:k}of t){const O=Math.floor((E-e)/c)*c,I=Math.ceil((E+D+e)/c)*c,z=Math.floor((R-e)/c)*c,H=Math.ceil((R+k+e)/c)*c,P=[O,z,H,!0],rt=[I,z,H,!1];this.#n.push(P,rt),zt.rectBoundingBox(O,z,I,H,l)}const u=l[2]-l[0]+2*i,d=l[3]-l[1]+2*i,f=l[0]-i,p=l[1]-i;let y=a?-1/0:1/0,x=1/0;const S=this.#n.at(a?-1:-2),A=[S[0],S[2]];for(const E of this.#n){const[R,D,k,O]=E;!O&&a?D<x?(x=D,y=R):D===x&&(y=Math.max(y,R)):O&&!a&&(D<x?(x=D,y=R):D===x&&(y=Math.min(y,R))),E[0]=(R-f)/u,E[1]=(D-p)/d,E[2]=(k-p)/d}this.#t=new Float32Array([f,p,u,d]),this.#e=[y,x],this.#i=A}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#r(t)}#r(t){const e=[],i=new Set;for(const c of t){const[u,d,f]=c;e.push([u,d,c],[u,f,c])}e.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=e.length;c<u;c+=2){const d=e[c][2],f=e[c+1][2];d.push(f),f.push(d),i.add(d),i.add(f)}const a=[];let l;for(;i.size>0;){const c=i.values().next().value;let[u,d,f,p,y]=c;i.delete(c);let x=u,S=d;for(l=[u,f],a.push(l);;){let A;if(i.has(p))A=p;else if(i.has(y))A=y;else break;i.delete(A),[u,d,f,p,y]=A,x!==u&&(l.push(x,S,u,S===d?d:f),x=u),S=S===d?f:d}l.push(x,S)}return new R2(a,this.#t,this.#e,this.#i)}#a(t){const e=this.#s;let i=0,a=e.length-1;for(;i<=a;){const l=i+a>>1,c=e[l][0];if(c===t)return l;c<t?i=l+1:a=l-1}return a+1}#o([,t,e]){const i=this.#a(t);this.#s.splice(i,0,[t,e])}#c([,t,e]){const i=this.#a(t);for(let a=i;a<this.#s.length;a++){const[l,c]=this.#s[a];if(l!==t)break;if(l===t&&c===e){this.#s.splice(a,1);return}}for(let a=i-1;a>=0;a--){const[l,c]=this.#s[a];if(l!==t)break;if(l===t&&c===e){this.#s.splice(a,1);return}}}#l(t){const[e,i,a]=t,l=[[e,i,a]],c=this.#a(a);for(let u=0;u<c;u++){const[d,f]=this.#s[u];for(let p=0,y=l.length;p<y;p++){const[,x,S]=l[p];if(!(f<=x||S<=d)){if(x>=d){if(S>f)l[p][1]=f;else{if(y===1)return[];l.splice(p,1),p--,y--}continue}l[p][2]=d,S>f&&l.push([e,f,S])}}}return l}}class R2 extends Gt{#t;#e;constructor(t,e,i,a){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=a}toSVGPath(){const t=[];for(const e of this.#e){let[i,a]=e;t.push(`M${i} ${a}`);for(let l=2;l<e.length;l+=2){const c=e[l],u=e[l+1];c===i?(t.push(`V${u}`),a=u):u===a&&(t.push(`H${c}`),i=c)}t.push("Z")}return t.join(" ")}serialize([t,e,i,a],l){const c=[],u=i-t,d=a-e;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=a-f[y+1]*d;c.push(p)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class um extends $r{newFreeDrawOutline(t,e,i,a,l,c){return new M2(t,e,i,a,l,c)}}class M2 extends hw{newOutliner(t,e,i,a,l,c=0){return new um(t,e,i,a,l,c)}}class pn extends Wt{#t=null;#e=0;#i;#n=null;#s=null;#r=null;#a=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=oe.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=pn.prototype;return se(this,"_keyboardManager",new iu([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||pn._defaultColor,this.#p=t.thickness||pn._defaultThickness,this.opacity=t.opacity||pn._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#w()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#a=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#w(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new cm(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new cm(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#r=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:a}=this.#r;this.#g=[(a[0]-this.x)/this.width,(a[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const a=1.5;if(this.#r=t.getNewOutline(this.#p/2+a,.0025),e>=0)this.#d=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:pn.#_(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:pn.#_(this.#r.box,y),path:{d:this.#r.toSVGPath()}})}const[l,c,u,d]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=d;break;case 90:{const[y,x]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*x/y,this.height=d*y/x;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=d;break;case 270:{const[y,x]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*x/y,this.height=d*y/x;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/d];const{lastPoint:p}=this.#r;this.#g=[(p[0]-l)/u,(p[1]-c)/d]}static initialize(t,e){Wt.initialize(t,e),pn._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case we.HIGHLIGHT_COLOR:pn._defaultColor=e;break;case we.HIGHLIGHT_THICKNESS:pn._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case we.HIGHLIGHT_COLOR:this.#E(e);break;case we.HIGHLIGHT_THICKNESS:this.#A(e);break}}static get defaultPropertiesToUpdate(){return[[we.HIGHLIGHT_COLOR,pn._defaultColor],[we.HIGHLIGHT_THICKNESS,pn._defaultThickness]]}get propertiesToUpdate(){return[[we.HIGHLIGHT_COLOR,this.color||pn._defaultColor],[we.HIGHLIGHT_THICKNESS,this.#p||pn._defaultThickness],[we.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#s?.updateColor(this.color),super.onUpdatedColor()}#E(t){const e=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},i=this.color,a=this.opacity;this.addCommands({cmd:e.bind(this,t,pn._defaultOpacity),undo:e.bind(this,i,a),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#A(t){const e=this.#p,i=a=>{this.#p=a,this.#x(a)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:we.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new aw({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#M())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#w(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#w(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#x(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#w(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#r.box,path:{d:this.#r.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#_([t,e,i,a],l){switch(l){case 90:return[1-e-a,t,a,i];case 180:return[1-t-i,1-e-a,i,a];case 270:return[e,1-t-i,a,i]}return[t,e,i,a]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=pn.#_(this.#l.box,t)):i=pn.#_([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#m,{bbox:pn.#_(this.#r.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),Bx(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#D(t){pn._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#a,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#M(){return this.#h?this.rotation:0}#B(){if(this.#h)return null;const[t,e]=this.pageDimensions,[i,a]=this.pageTranslation,l=this.#i,c=new Float32Array(l.length*8);let u=0;for(const{x:d,y:f,width:p,height:y}of l){const x=d*t+i,S=(1-f)*e+a;c[u]=c[u+4]=x,c[u+1]=c[u+3]=S,c[u+2]=c[u+6]=x+p*t,c[u+5]=c[u+7]=S-y*e,u+=8}return c}#k(t){return this.#l.serialize(t,this.#M())}static startHighlighting(t,e,{target:i,x:a,y:l}){const{x:c,y:u,width:d,height:f}=i.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),x=S=>{p.abort(),this.#F(t,S)};window.addEventListener("blur",x,{signal:y}),window.addEventListener("pointerup",x,{signal:y}),window.addEventListener("pointerdown",on,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",Xi,{signal:y}),i.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new um({x:a,y:l},[c,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let a=null;if(t instanceof cw){const{data:{quadPoints:A,rect:E,rotation:R,id:D,color:k,opacity:O,popupRef:I,richText:z,contentsObj:H,creationDate:P,modificationDate:rt},parent:{page:{pageNumber:ut}}}=t;a=t={annotationType:oe.HIGHLIGHT,color:Array.from(k),opacity:O,quadPoints:A,boxes:null,pageIndex:ut-1,rect:E.slice(0),rotation:R,annotationElementId:D,id:D,deleted:!1,popupRef:I,richText:z,comment:H?.str||null,creationDate:P,modificationDate:rt}}else if(t instanceof Vm){const{data:{inkLists:A,rect:E,rotation:R,id:D,color:k,borderStyle:{rawWidth:O},popupRef:I,richText:z,contentsObj:H,creationDate:P,modificationDate:rt},parent:{page:{pageNumber:ut}}}=t;a=t={annotationType:oe.HIGHLIGHT,color:Array.from(k),thickness:O,inkLists:A,boxes:null,pageIndex:ut-1,rect:E.slice(0),rotation:R,annotationElementId:D,id:D,deleted:!1,popupRef:I,richText:z,comment:H?.str||null,creationDate:P,modificationDate:rt}}const{color:l,quadPoints:c,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,i);f.color=zt.makeHexColor(...l),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=a,t.comment&&f.setCommentData(t);const[p,y]=f.pageDimensions,[x,S]=f.pageTranslation;if(c){const A=f.#i=[];for(let E=0;E<c.length;E+=8)A.push({x:(c[E]-x)/p,y:1-(c[E+1]-S)/y,width:(c[E+2]-c[E])/p,height:(c[E+1]-c[E+5])/y});f.#v(),f.#w(),f.rotate(f.rotation)}else if(u){f.#h=!0;const A=u[0],E={x:A[0]-x,y:y-(A[1]-S)},R=new um(E,[0,0,p,y],1,f.#p/2,!0,.001);for(let O=0,I=A.length;O<I;O+=2)E.x=A[O]-x,E.y=y-(A[O+1]-S),R.add(E);const{id:D,clipPathId:k}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:R.toSVGPath()}},!0,!0);f.#b({highlightOutlines:R.getOutlines(),highlightId:D,clipPathId:k}),f.#w(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Wt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#B(),outlines:this.#k(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#j(i)?null:(i.id=this.annotationElementId,i)}#j(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,a)=>i!==e[a])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class dw{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Le("Not implemented")}}class De extends Wt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#s=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#r(t),this.#c())}#r({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#a(t,this.parent),this.#h(t.box)}#a(t,e){const{id:i}=e.drawLayer.draw(De._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[a,l]of Object.entries(e))i.has(a)?Object.assign(t[a],l):t[a]=l;return t}static getDefaultDrawingOptions(t){Le("Not implemented")}static get typesMap(){Le("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(De.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,a]of this.typesMap)t.push([i,e[a]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,a]of this.constructor.typesMap)t.push([i,e[a]]);return t}_updateProperty(t,e,i){const a=this._drawingOptions,l=a[e],c=u=>{a.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,a.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,De._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,De._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,De._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#a(this.#t,t)}}#l([t,e,i,a]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(c/l),a*(l/c)];case 180:return[1-t,1-e,i,a];case 270:return[1-e,t,i*(c/l),a*(l/c)];default:return[t,e,i,a]}}#d(){const{x:t,y:e,width:i,height:a,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(l/c),a*(c/l)];case 180:return[1-t,1-e,i,a];case 270:return[e,1-t,i*(l/c),a*(c/l)];default:return[t,e,i,a]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:i,height:a,rotation:l,parentRotation:c,parentDimensions:[u,d]}=this;switch((l*4+c)/90){case 1:return[1-e-a,t,a,i];case 2:return[1-t-i,1-e-a,i,a];case 3:return[e,1-t-i,a,i];case 4:return[t,e-i*(u/d),a*(d/u),i*(u/d)];case 5:return[1-e,t,i*(u/d),a*(d/u)];case 6:return[1-t-a*(d/u),1-e,a*(d/u),i*(u/d)];case 7:return[e-i*(u/d),1-t-a*(d/u),i*(u/d),a*(d/u)];case 8:return[t-i,e-a,i,a];case 9:return[1-e,t-i,a,i];case 10:return[1-t,1-e,i,a];case 11:return[e-a,1-t,a,i];case 12:return[t-a*(d/u),e,a*(d/u),i*(u/d)];case 13:return[1-e-i*(u/d),t-a*(d/u),i*(u/d),a*(d/u)];case 14:return[1-t,1-e-i*(u/d),a*(d/u),i*(u/d)];case 15:return[e,1-t,i*(u/d),a*(d/u)];default:return[t,e,i,a]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,De._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const a=document.createElement("div");return i.append(a),a.setAttribute("aria-hidden","true"),a.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,a,l){Le("Not implemented")}static startDrawing(t,e,i,a){const{target:l,offsetX:c,offsetY:u,pointerId:d,pointerType:f}=a;if(ke.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=t,{width:y,height:x}=l.getBoundingClientRect(),S=De.#n=new AbortController,A=t.combinedSignal(S);if(ke.setPointer(f,d),window.addEventListener("pointerup",E=>{ke.isSamePointerIdOrRemove(E.pointerId)&&this._endDraw(E)},{signal:A}),window.addEventListener("pointercancel",E=>{ke.isSamePointerIdOrRemove(E.pointerId)&&this._currentParent.endDrawingSession()},{signal:A}),window.addEventListener("pointerdown",E=>{ke.isSamePointerType(E.pointerType)&&(ke.initializeAndAddPointerId(E.pointerId),De.#i.isCancellable()&&(De.#i.removeLastElement(),De.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:A}),window.addEventListener("contextmenu",Xi,{signal:A}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:A}),l.addEventListener("touchmove",E=>{ke.isSameTimeStamp(E.timeStamp)&&on(E)},{signal:A}),t.toggleDrawing(),e._editorUndoBar?.hide(),De.#i){t.drawLayer.updateProperties(this._currentDrawId,De.#i.startNew(c,u,y,x,p));return}e.updateUIForDefaultProperties(this),De.#i=this.createDrawerInstance(c,u,y,x,p),De.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(De.#s.toSVGProperties(),De.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(ke.isSameTimeStamp(t.timeStamp),!De.#i)return;const{offsetX:e,offsetY:i,pointerId:a}=t;if(ke.isSamePointerId(a)){if(ke.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,De.#i.add(e,i)),ke.setTimeStamp(t.timeStamp),on(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,De.#i=null,De.#s=null,ke.clearTimeStamp()),De.#n&&(De.#n.abort(),De.#n=null,ke.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,De.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=De.#i,a=this._currentDrawId,l=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(a,i.setLastElement(l))},undo:()=>{e.drawLayer.updateProperties(a,i.removeLastElement())},mustExec:!1,type:we.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(we.DRAW_STEP),!De.#i.isEmpty()){const{pageDimensions:[i,a],scale:l}=e,c=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:De.#i.getOutlines(i*l,a*l,l,this._INNER_MARGIN),drawingOptions:De.#s,mustBeCommitted:!t});return this._cleanup(!0),c}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,a,l,c){Le("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:a,pageHeight:l,pageX:c,pageY:u}}=e.viewport,d=this.deserializeDraw(c,u,a,l,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#r({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[a,l]=this.pageDimensions;return this.#t.serialize([e,i,a,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class D2{#t=new Float64Array(6);#e;#i;#n;#s;#r;#a="";#o=0;#c=new su;#l;#d;constructor(t,e,i,a,l,c){this.#l=i,this.#d=a,this.#n=l,this.#s=c,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e],this.#i=[{line:u,points:this.#r}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#h(t,e){return Gt._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#r.length<=10}add(t,e){[t,e]=this.#h(t,e);const[i,a,l,c]=this.#t.subarray(2,6),u=t-l,d=e-c;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#r.push(t,e),isNaN(i)?(this.#t.set([l,c,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,a,l,c,t,e],0),this.#e.push(...Gt.createBezierPoints(i,a,l,c,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#r.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,a,l){this.#l=i,this.#d=a,this.#n=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#r=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:c,points:this.#r}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#r=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#a="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:a}=this.#i[t];this.#e=i,this.#r=a,this.#o=0,this.toSVGPath()}return{path:{d:this.#a}}}toSVGPath(){const t=Gt.svgRound(this.#e[4]),e=Gt.svgRound(this.#e[5]);if(this.#r.length===2)return this.#a=`${this.#a} M ${t} ${e} Z`,this.#a;if(this.#r.length<=6){const a=this.#a.lastIndexOf("M");this.#a=`${this.#a.slice(0,a)} M ${t} ${e}`,this.#o=6}if(this.#r.length===4){const a=Gt.svgRound(this.#e[10]),l=Gt.svgRound(this.#e[11]);return this.#a=`${this.#a} L ${a} ${l}`,this.#o=12,this.#a}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let a=this.#o,l=this.#e.length;a<l;a+=6){const[c,u,d,f,p,y]=this.#e.slice(a,a+6).map(Gt.svgRound);i.push(`C${c} ${u} ${d} ${f} ${p} ${y}`)}return this.#a+=i.join(" "),this.#o=this.#e.length,this.#a}getOutlines(t,e,i,a){const l=this.#i.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#i,t,e,i,this.#n,this.#s,a),this.#t=null,this.#e=null,this.#i=null,this.#a=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class su extends Gt{#t;#e=0;#i;#n;#s;#r;#a;#o;#c;build(t,e,i,a,l,c,u){this.#s=e,this.#r=i,this.#a=a,this.#o=l,this.#c=c,this.#i=u??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${Gt.svgRound(e[4])} ${Gt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Gt.svgRound(e[10])} ${Gt.svgRound(e[11])}`);continue}for(let i=6,a=e.length;i<a;i+=6){const[l,c,u,d,f,p]=e.subarray(i,i+6).map(Gt.svgRound);t.push(`C${l} ${c} ${u} ${d} ${f} ${p}`)}}return t.join("")}serialize([t,e,i,a],l){const c=[],u=[],[d,f,p,y]=this.#d();let x,S,A,E,R,D,k,O,I;switch(this.#o){case 0:I=Gt._rescale,x=t,S=e+a,A=i,E=-a,R=t+d*i,D=e+(1-f-y)*a,k=t+(d+p)*i,O=e+(1-f)*a;break;case 90:I=Gt._rescaleAndSwap,x=t,S=e,A=i,E=a,R=t+f*i,D=e+d*a,k=t+(f+y)*i,O=e+(d+p)*a;break;case 180:I=Gt._rescale,x=t+i,S=e,A=-i,E=a,R=t+(1-d-p)*i,D=e+f*a,k=t+(1-d)*i,O=e+(f+y)*a;break;case 270:I=Gt._rescaleAndSwap,x=t+i,S=e+a,A=-i,E=-a,R=t+(1-f-y)*i,D=e+(1-d-p)*a,k=t+(1-f)*i,O=e+(1-d)*a;break}for(const{line:z,points:H}of this.#n)c.push(I(z,x,S,A,E,l?new Array(z.length):null)),u.push(I(H,x,S,A,E,l?new Array(H.length):null));return{lines:c,points:u,rect:[R,D,k,O]}}static deserialize(t,e,i,a,l,{paths:{lines:c,points:u},rotation:d,thickness:f}){const p=[];let y,x,S,A,E;switch(d){case 0:E=Gt._rescale,y=-t/i,x=e/a+1,S=1/i,A=-1/a;break;case 90:E=Gt._rescaleAndSwap,y=-e/a,x=-t/i,S=1/a,A=1/i;break;case 180:E=Gt._rescale,y=t/i+1,x=-e/a,S=-1/i,A=1/a;break;case 270:E=Gt._rescaleAndSwap,y=e/a+1,x=t/i+1,S=-1/a,A=-1/i;break}if(!c){c=[];for(const D of u){const k=D.length;if(k===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1]]));continue}if(k===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,D[0],D[1],NaN,NaN,NaN,NaN,D[2],D[3]]));continue}const O=new Float32Array(3*(k-2));c.push(O);let[I,z,H,P]=D.subarray(0,4);O.set([NaN,NaN,NaN,NaN,I,z],0);for(let rt=4;rt<k;rt+=2){const ut=D[rt],St=D[rt+1];O.set(Gt.createBezierPoints(I,z,H,P,ut,St),(rt-2)*3),[I,z,H,P]=[H,P,ut,St]}}}for(let D=0,k=c.length;D<k;D++)p.push({line:E(c[D].map(O=>O??NaN),y,x,S,A),points:E(u[D].map(O=>O??NaN),y,x,S,A)});const R=new this.prototype.constructor;return R.build(p,i,a,1,d,f,l),R}#l(t=this.#c){const e=this.#i+t/2*this.#a;return this.#o%180===0?[e/this.#s,e/this.#r]:[e/this.#r,e/this.#s]}#d(){const[t,e,i,a]=this.#t,[l,c]=this.#l(0);return[t+l,e+c,i-2*l,a-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:a}of this.#n){if(a.length<=12){for(let u=4,d=a.length;u<d;u+=6)zt.pointBoundingBox(a[u],a[u+1],t);continue}let l=a[4],c=a[5];for(let u=6,d=a.length;u<d;u+=6){const[f,p,y,x,S,A]=a.subarray(u,u+6);zt.bezierBoundingBox(l,c,f,p,y,x,S,A,t),l=S,c=A}}const[e,i]=this.#l();t[0]=qn(t[0]-e,0,1),t[1]=qn(t[1]-i,0,1),t[2]=qn(t[2]+e,0,1),t[3]=qn(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[a,l]=this.#l(),[c,u]=[a-e,l-i],d=this.#t;return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateParentDimensions([t,e],i){const[a,l]=this.#l();this.#s=t,this.#r=e,this.#a=i;const[c,u]=this.#l(),d=c-a,f=u-l,p=this.#t;return p[0]-=d,p[1]-=f,p[2]+=2*d,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Gt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,a=0,l=0,c=0,u=0,d=0;switch(this.#e){case 90:a=e/t,l=-t/e,u=t;break;case 180:i=-1,c=-1,u=t,d=e;break;case 270:a=-e/t,l=t/e,d=e;break;default:return""}return`matrix(${i} ${a} ${l} ${c} ${Gt.svgRound(u)} ${Gt.svgRound(d)})`}getPathResizingSVGProperties([t,e,i,a]){const[l,c]=this.#l(),[u,d,f,p]=this.#t;if(Math.abs(f-l)<=Gt.PRECISION||Math.abs(p-c)<=Gt.PRECISION){const E=t+i/2-(u+f/2),R=e+a/2-(d+p/2);return{path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${E} ${R})`}}}const y=(i-2*l)/(f-2*l),x=(a-2*c)/(p-2*c),S=f/i,A=p/a;return{path:{"transform-origin":`${Gt.svgRound(u)} ${Gt.svgRound(d)}`,transform:`${this.rotationTransform} scale(${S} ${A}) translate(${Gt.svgRound(l)} ${Gt.svgRound(c)}) scale(${y} ${x}) translate(${Gt.svgRound(-l)} ${Gt.svgRound(-c)})`}}}getPathResizedSVGProperties([t,e,i,a]){const[l,c]=this.#l(),u=this.#t,[d,f,p,y]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=a,Math.abs(p-l)<=Gt.PRECISION||Math.abs(y-c)<=Gt.PRECISION){const R=t+i/2-(d+p/2),D=e+a/2-(f+y/2);for(const{line:k,points:O}of this.#n)Gt._translate(k,R,D,k),Gt._translate(O,R,D,O);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const x=(i-2*l)/(p-2*l),S=(a-2*c)/(y-2*c),A=-x*(d+l)+t+l,E=-S*(f+c)+e+c;if(x!==1||S!==1||A!==0||E!==0)for(const{line:R,points:D}of this.#n)Gt._rescale(R,A,E,x,S,R),Gt._rescale(D,A,E,x,S,D);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[a,l]=i,c=this.#t,u=t-c[0],d=e-c[1];if(this.#s===a&&this.#r===l)for(const{line:f,points:p}of this.#n)Gt._translate(f,u,d,f),Gt._translate(p,u,d,p);else{const f=this.#s/a,p=this.#r/l;this.#s=a,this.#r=l;for(const{line:y,points:x}of this.#n)Gt._rescale(y,u,d,f,p,y),Gt._rescale(x,u,d,f,p,x);c[2]*=f,c[3]*=p}return c[0]=t,c[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t[0])} ${Gt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class vd extends dw{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Wt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new vd(this._viewParameters);return t.updateAll(this),t}}class Xm extends De{static _type="ink";static _editorType=oe.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Wt.initialize(t,e),this._defaultDrawingOptions=new vd(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return se(this,"typesMap",new Map([[we.INK_THICKNESS,"stroke-width"],[we.INK_COLOR,"stroke"],[we.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,a,l){return new D2(t,e,i,a,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,a,l,c){return su.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){let a=null;if(t instanceof Vm){const{data:{inkLists:c,rect:u,rotation:d,id:f,color:p,opacity:y,borderStyle:{rawWidth:x},popupRef:S,richText:A,contentsObj:E,creationDate:R,modificationDate:D},parent:{page:{pageNumber:k}}}=t;a=t={annotationType:oe.INK,color:Array.from(p),thickness:x,opacity:y,paths:{points:c},boxes:null,pageIndex:k-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:S,richText:A,comment:E?.str||null,creationDate:R,modificationDate:D}}const l=await super.deserialize(t,e,i);return l._initialData=a,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new Vc(this),[["colorPicker",this._colorPicker]]}get colorType(){return we.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=Xm.getDefaultDrawingOptions({stroke:zt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:a,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:Wt._colorManager.convert(a),opacity:l,thickness:c,paths:{lines:e,points:i}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:a,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==e[u])||t.thickness!==i||t.opacity!==a||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class hm extends su{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Dh=8,Nc=3;class al{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,a){return i-=t,a-=e,i===0?a>0?0:4:i===1?a+6:2-a}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const p=(-f+d-u+16)%8,y=this.#i[2*p],x=this.#i[2*p+1];if(t[(i+y)*e+(a+x)]!==0)return p}return-1}static#s(t,e,i,a,l,c,u){const d=this.#e(i,a,l,c);for(let f=0;f<8;f++){const p=(f+d+u+16)%8,y=this.#i[2*p],x=this.#i[2*p+1];if(t[(i+y)*e+(a+x)]!==0)return p}return-1}static#r(t,e,i,a){const l=t.length,c=new Int32Array(l);for(let p=0;p<l;p++)c[p]=t[p]<=a?1:0;for(let p=1;p<i-1;p++)c[p*e]=c[p*e+e-1]=0;for(let p=0;p<e;p++)c[p]=c[e*i-1-p]=0;let u=1,d;const f=[];for(let p=1;p<i-1;p++){d=1;for(let y=1;y<e-1;y++){const x=p*e+y,S=c[x];if(S===0)continue;let A=p,E=y;if(S===1&&c[x-1]===0)u+=1,E-=1;else if(S>=1&&c[x+1]===0)u+=1,E+=1,S>1&&(d=S);else{S!==1&&(d=Math.abs(S));continue}const R=[y,p],D=E===y+1,k={isHole:D,points:R,id:u,parent:0};f.push(k);let O;for(const _t of f)if(_t.id===d){O=_t;break}O?O.isHole?k.parent=D?O.parent:d:k.parent=D?d:O.parent:k.parent=D?d:0;const I=this.#n(c,e,p,y,A,E,0);if(I===-1){c[x]=-u,c[x]!==1&&(d=Math.abs(c[x]));continue}let z=this.#i[2*I],H=this.#i[2*I+1];const P=p+z,rt=y+H;A=P,E=rt;let ut=p,St=y;for(;;){const _t=this.#s(c,e,ut,St,A,E,1);z=this.#i[2*_t],H=this.#i[2*_t+1];const Mt=ut+z,Vt=St+H;R.push(Vt,Mt);const vt=ut*e+St;if(c[vt+1]===0?c[vt]=-u:c[vt]===1&&(c[vt]=u),Mt===p&&Vt===y&&ut===P&&St===rt){c[x]!==1&&(d=Math.abs(c[x]));break}else A=ut,E=St,ut=Mt,St=Vt}}}return f}static#a(t,e,i,a){if(i-e<=4){for(let P=e;P<i-2;P+=2)a.push(t[P],t[P+1]);return}const l=t[e],c=t[e+1],u=t[i-4]-l,d=t[i-3]-c,f=Math.hypot(u,d),p=u/f,y=d/f,x=p*c-y*l,S=d/u,A=1/f,E=Math.atan(S),R=Math.cos(E),D=Math.sin(E),k=A*(Math.abs(R)+Math.abs(D)),O=A*(1-k+k**2),I=Math.max(Math.atan(Math.abs(D+R)*O),Math.atan(Math.abs(D-R)*O));let z=0,H=e;for(let P=e+2;P<i-2;P+=2){const rt=Math.abs(x-p*t[P+1]+y*t[P]);rt>z&&(H=P,z=rt)}z>(f*I)**2?(this.#a(t,e,H+2,a),this.#a(t,H,i,a)):a.push(l,c)}static#o(t){const e=[],i=t.length;return this.#a(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,a,l,c){const u=new Float32Array(c**2),d=-2*a**2,f=c>>1;for(let E=0;E<c;E++){const R=(E-f)**2;for(let D=0;D<c;D++)u[E*c+D]=Math.exp((R+(D-f)**2)/d)}const p=new Float32Array(256),y=-2*l**2;for(let E=0;E<256;E++)p[E]=Math.exp(E**2/y);const x=t.length,S=new Uint8Array(x),A=new Uint32Array(256);for(let E=0;E<i;E++)for(let R=0;R<e;R++){const D=E*e+R,k=t[D];let O=0,I=0;for(let H=0;H<c;H++){const P=E+H-f;if(!(P<0||P>=i))for(let rt=0;rt<c;rt++){const ut=R+rt-f;if(ut<0||ut>=e)continue;const St=t[P*e+ut],_t=u[H*c+rt]*p[Math.abs(St-k)];O+=St*_t,I+=_t}}const z=S[D]=Math.round(O/I);A[z]++}return[S,A]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let a=-1/0,l=1/0;for(let u=0,d=i.length;u<d;u++){const f=i[u]=t[u<<2];a=Math.max(a,f),l=Math.min(l,f)}const c=255/(a-l);for(let u=0,d=i.length;u<d;u++)i[u]=(i[u]-l)*c;return i}static#h(t){let e,i=-1/0,a=-1/0;const l=t.findIndex(d=>d!==0);let c=l,u=l;for(e=l;e<256;e++){const d=t[e];d>i&&(e-c>a&&(a=e-c,u=e-1),i=d,c=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:a}=t,{maxDim:l}=this.#t;let c=i,u=a;if(i>l||a>l){let x=i,S=a,A=Math.log2(Math.max(i,a)/l);const E=Math.floor(A);A=A===E?E-1:E;for(let D=0;D<A;D++){c=Math.ceil(x/2),u=Math.ceil(S/2);const k=new OffscreenCanvas(c,u);k.getContext("2d").drawImage(t,0,0,x,S,0,0,c,u),x=c,S=u,t!==e&&t.close(),t=k.transferToImageBitmap()}const R=Math.min(l/c,l/u);c=Math.round(c*R),u=Math.round(u*R)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const p=f.getImageData(0,0,c,u).data;return[this.#d(p),c,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:a},l,c,u,d){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,x=p.font=`${i} ${a} ${y}px ${e}`,{actualBoundingBoxLeft:S,actualBoundingBoxRight:A,actualBoundingBoxAscent:E,actualBoundingBoxDescent:R,fontBoundingBoxAscent:D,fontBoundingBoxDescent:k,width:O}=p.measureText(t),I=1.5,z=Math.ceil(Math.max(Math.abs(S)+Math.abs(A)||0,O)*I),H=Math.ceil(Math.max(Math.abs(E)+Math.abs(R)||y,Math.abs(D)+Math.abs(k)||y)*I);f=new OffscreenCanvas(z,H),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=x,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,z,H),p.fillStyle="black",p.fillText(t,z*(I-1)/2,H*(3-I)/2);const P=this.#d(p.getImageData(0,0,z,H).data),rt=this.#l(P),ut=this.#h(rt),St=this.#r(P,z,H,ut);return this.processDrawnLines({lines:{curves:St,width:z,height:H},pageWidth:l,pageHeight:c,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,i,a,l){const[c,u,d]=this.#f(t),[f,p]=this.#c(c,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(p),x=this.#r(f,u,d,y);return this.processDrawnLines({lines:{curves:x,width:u,height:d},pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:l,mustSmooth:c,areContours:u}){a%180!==0&&([e,i]=[i,e]);const{curves:d,width:f,height:p}=t,y=t.thickness??0,x=[],S=Math.min(e/f,i/p),A=S/e,E=S/i,R=[];for(const{points:k}of d){const O=c?this.#o(k):k;if(!O)continue;R.push(O);const I=O.length,z=new Float32Array(I),H=new Float32Array(3*(I===2?2:I-2));if(x.push({line:H,points:z}),I===2){z[0]=O[0]*A,z[1]=O[1]*E,H.set([NaN,NaN,NaN,NaN,z[0],z[1]],0);continue}let[P,rt,ut,St]=O;P*=A,rt*=E,ut*=A,St*=E,z.set([P,rt,ut,St],0),H.set([NaN,NaN,NaN,NaN,P,rt],0);for(let _t=4;_t<I;_t+=2){const Mt=z[_t]=O[_t]*A,Vt=z[_t+1]=O[_t+1]*E;H.set(Gt.createBezierPoints(P,rt,ut,St,Mt,Vt),(_t-2)*3),[P,rt,ut,St]=[ut,St,Mt,Vt]}}if(x.length===0)return null;const D=u?new hm:new su;return D.build(x,e,i,1,a,u?0:y,l),{outline:D,newCurves:R,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:a,height:l}){let c=1/0,u=-1/0,d=0;for(const O of t){d+=O.length;for(let I=2,z=O.length;I<z;I++){const H=O[I]-O[I-2];c=Math.min(c,H),u=Math.max(u,H)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=Dh+Nc*p,x=new Uint32Array(y);let S=0;x[S++]=y*Uint32Array.BYTES_PER_ELEMENT+(d-2*p)*f.BYTES_PER_ELEMENT,x[S++]=0,x[S++]=a,x[S++]=l,x[S++]=e?0:1,x[S++]=Math.max(0,Math.floor(i??0)),x[S++]=p,x[S++]=f.BYTES_PER_ELEMENT;for(const O of t)x[S++]=O.length-2,x[S++]=O[0],x[S++]=O[1];const A=new CompressionStream("deflate-raw"),E=A.writable.getWriter();await E.ready,E.write(x);const R=f.prototype.constructor;for(const O of t){const I=new R(O.length-2);for(let z=2,H=O.length;z<H;z++)I[z-2]=O[z]-O[z-2];E.write(I)}E.close();const D=await new Response(A.readable).arrayBuffer();return new Uint8Array(D).toBase64()}static async decompressSignature(t){try{const e=Uint8Array.fromBase64(t),{readable:i,writable:a}=new DecompressionStream("deflate-raw"),l=a.getWriter();await l.ready,l.write(e).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const O of i)c||=new Uint8Array(new Uint32Array(O.buffer,0,4)[0]),c.set(O,u),u+=O.length;const d=new Uint32Array(c.buffer,0,c.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=d[2],y=d[3],x=d[4]===0,S=d[5],A=d[6],E=d[7],R=[],D=(Dh+Nc*A)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(E){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(c.buffer,D);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(c.buffer,D);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(c.buffer,D);break}u=0;for(let O=0;O<A;O++){const I=d[Nc*O+Dh],z=new Float32Array(I+2);R.push(z);for(let H=0;H<Nc-1;H++)z[H]=d[Nc*O+Dh+H+1];for(let H=0;H<I;H++)z[H+2]=z[H]+k[u++]}return{areContours:x,thickness:S,outlines:R,width:p,height:y}}catch(e){return ie(`decompressSignature: ${e}`),null}}}class Ym extends dw{constructor(){super(),super.updateProperties({fill:Wt._defaultLineColor,"stroke-width":0})}clone(){const t=new Ym;return t.updateAll(this),t}}class Qm extends vd{constructor(t){super(t),super.updateProperties({stroke:Wt._defaultLineColor,"stroke-width":1})}clone(){const t=new Qm(this._viewParameters);return t.updateAll(this),t}}class Ds extends De{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=oe.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Wt.initialize(t,e),this._defaultDrawingOptions=new Ym,this._defaultDrawnSignatureOptions=new Qm(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return se(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:a,mustSmooth:l,areContours:c,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:p,pageHeight:y},rotation:x}=this.parent.viewport,S=al.processDrawnLines({lines:a,pageWidth:p,pageHeight:y,rotation:x,innerMargin:Ds._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(S,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:a,height:l}=this.#i,c=Math.max(a,l),u=al.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:i,width:a,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,a){const{x:l,y:c}=this,{outline:u}=this.#i=t;this.#t=u instanceof hm,this.description=i;let d;this.#t?d=Ds.getDefaultDrawingOptions():(d=Ds._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let p=e/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(a),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!a,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return al.process(t,e,i,a,Ds._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:a},rotation:l}=this.parent.viewport;return al.extractContoursFromText(t,e,i,a,l,Ds._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:a}=this.parent.viewport;return al.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:a,innerMargin:Ds._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Ds.getDefaultDrawingOptions():(this._drawingOptions=Ds._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":a}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:a});return this.addComment(l),t?(l.paths={lines:e,points:i},l.uuid=this.#n,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,i,a,l,c){return c.areContours?hm.deserialize(t,e,i,a,l,c):su.deserialize(t,e,i,a,l,c)}static async deserialize(t,e,i){const a=await super.deserialize(t,e,i);return a.#t=t.areContours,a.description=t.accessibilityData?.alt||"",a.#n=t.uuid,a}}class N2 extends Wt{#t=null;#e=null;#i=null;#n=null;#s=null;#r="";#a=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=oe.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Wt.initialize(t,e)}static isHandlingMimeForPasting(t){return nm.includes(t)}static paste(t,e){e.pasteEditor({mode:oe.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#r=t.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#a){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:a,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:a,width:l,height:c,channels:a.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#h(i,!0)).finally(()=>this.#f());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(a=>this.#h(a)).finally(()=>this.#f());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(a=>this.#h(a)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=nm.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const a=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(a)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#a?.remove(),this.#a=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#a===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#s||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:a}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,a&&(this.#t=a),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:e,height:i}=this.#t;const[a,l]=this.pageDimensions,c=.75;if(this.width)e=this.width*a,i=this.height*l;else if(e>c*a||i>c*l){const d=Math.min(c*a/e,c*l/i);e*=d,i*=d}this._uiManager.enableWaiting(!1);const u=this.#a=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/a,this.height=i/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#r&&this.div.setAttribute("aria-description",this.#r),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:a,height:l}=this.#t,c=new Ps;let u=this.#t,d=a,f=l,p=null;if(e){if(a>e||l>e){const H=Math.min(e/a,e/l);d=Math.floor(a*H),f=Math.floor(l*H)}p=document.createElement("canvas");const x=p.width=Math.ceil(d*c.sx),S=p.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(x,S));const A=p.getContext("2d");A.filter=this._uiManager.hcmFilter;let E="white",R="#cfcfd8";this._uiManager.hcmFilter!=="none"?R="black":ZC.isDarkMode&&(E="#8f8f9d",R="#42414d");const D=15,k=D*c.sx,O=D*c.sy,I=new OffscreenCanvas(k*2,O*2),z=I.getContext("2d");z.fillStyle=E,z.fillRect(0,0,k*2,O*2),z.fillStyle=R,z.fillRect(0,0,k,O),z.fillRect(k,O,k,O),A.fillStyle=A.createPattern(I,"repeat"),A.fillRect(0,0,x,S),A.drawImage(u,0,0,u.width,u.height,0,0,x,S)}let y=null;if(i){let x,S;if(c.symmetric&&u.width<t&&u.height<t)x=u.width,S=u.height;else if(u=this.#t,a>t||l>t){const R=Math.min(t/a,t/l);x=Math.floor(a*R),S=Math.floor(l*R),this.#l||(u=this.#u(x,S))}const E=new OffscreenCanvas(x,S).getContext("2d",{willReadFrequently:!0});E.drawImage(u,0,0,u.width,u.height,0,0,x,S),y={width:x,height:S,data:E.getImageData(0,0,x,S).data}}return{canvas:p,width:d,height:f,imageData:y}}#u(t,e){const{width:i,height:a}=this.#t;let l=i,c=a,u=this.#t;for(;l>2*t||c>2*e;){const d=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*e&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(l,c);p.getContext("2d").drawImage(u,0,0,d,f,0,0,l,c),u=p.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:i,height:a}=this,l=new Ps,c=Math.ceil(i*t*l.sx),u=Math.ceil(a*e*l.sy),d=this.#a;if(!d||d.width===c&&d.height===u)return;d.width=c,d.height=u;const f=this.#l?this.#t:this.#u(c,u),p=d.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const a=this._uiManager.imageManager.getSvgUrl(this.#e);if(a)return a}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,a=Math.round(this.width*e*yl.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*yl.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(a,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,a,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let a=null,l=!1;if(t instanceof uw){const{data:{rect:E,rotation:R,id:D,structParent:k,popupRef:O,richText:I,contentsObj:z,creationDate:H,modificationDate:P},container:rt,parent:{page:{pageNumber:ut}},canvas:St}=t;let _t,Mt;St?(delete t.canvas,{id:_t,bitmap:Mt}=i.imageManager.getFromCanvas(rt.id,St),St.remove()):(l=!0,t._hasNoCanvas=!0);const Vt=(await e._structTree.getAriaAttributes(`${rl}${D}`))?.get("aria-label")||"";a=t={annotationType:oe.STAMP,bitmapId:_t,bitmap:Mt,pageIndex:ut-1,rect:E.slice(0),rotation:R,annotationElementId:D,id:D,deleted:!1,accessibilityData:{decorative:!1,altText:Vt},isSvg:!1,structParent:k,popupRef:O,richText:I,comment:z?.str||null,creationDate:H,modificationDate:P}}const c=await super.deserialize(t,e,i),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:x}=t;l?(i.addMissingCanvas(t.id,c),c.#o=!0):p&&i.imageManager.isValidId(p)?(c.#e=p,d&&(c.#t=d)):c.#n=f,c.#l=y;const[S,A]=c.pageDimensions;return c.width=(u[2]-u[0])/S,c.height=(u[3]-u[1])/A,x&&(c.altTextData=x),c._initialData=a,t.comment&&c.setCommentData(t),c.#d=!!a,c}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:a,altText:l}=this.serializeAltText(!1);if(!a&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(i);return u.isSame?null:(u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const c=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:c,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return i}#v(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,a=t.pageIndex===e,l=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&a&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class ma{#t;#e=!1;#i=null;#n=null;#s=null;#r=new Map;#a=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([kn,Xm,N2,pn,Ds].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:a,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:d,viewport:f,l10n:p}){const y=[...ma.#p.values()];if(!ma._initialized){ma._initialized=!0;for(const x of y)x.initialize(p,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=e,this.div=i,this.#t=l,this.#i=c,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=a,this.#u.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#r.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===oe.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#x(),t){case oe.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case oe.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case oe.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===oe.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of ma.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#y(){return this.#r.size!==0?this.#r.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const i of this.#y)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#u.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#i;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#u.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const a=await this.deserialize(i);a&&(this.addOrRebuild(a),a.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const a=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:d,timeStamp:f}=l,p=this.#m;if(f-p>500){this.#m=f;return}this.#m=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const x=document.elementsFromPoint(u,d);if(y.toggle("getElements",!1),!this.div.contains(x[0]))return;let S;const A=new RegExp(`^${Hc}[0-9]+$`);for(const R of x)if(A.test(R.id)){S=R.id;break}if(!S)return;const E=this.#r.get(S);E?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),E.dblclick(l))},{signal:a,capture:!0})}const t=this.#i,e=[];if(t){const a=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){a.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=l.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=a.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#x(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const a of ma.#p.values())i.remove(`${a._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:i}=Cn.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),pn.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#r.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#r.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),Wt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#r.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#b(){return ma.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const e=this.#b;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:i,offsetY:a}=this.#A(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:i,y:a,uiManager:this.#u,isCentered:!0,...e});c&&this.add(c)}async deserialize(t){return await ma.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,i={}){const a=this.getNextId(),l=this.#E({parent:this,id:a,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...i});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#A(){const{x:t,y:e,width:i,height:a}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,e),u=Math.min(window.innerWidth,t+i),d=Math.min(window.innerHeight,e+a),f=(l+u)/2-t,p=(c+d)/2-e,[y,x]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:x}}addNewEditor(t={}){this.createAndAddNewEditor(this.#A(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=Cn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#a||(this.#a=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#u.getMode();if(i===oe.STAMP||i===oe.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===oe.HIGHLIGHT&&this.enableTextSelection(),this.#a){this.#a=!1;return}const{isMac:e}=Cn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#a=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const i=this.#u.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,e,i){const a=this.#u.findParent(e,i);return a===null||a===this?!1:(a.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#r.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#r.clear(),this.#u.removeLayer(this)}#x(){for(const t of this.#r.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,no(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#x();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,no(this.div,{rotation:i}),e!==i)for(const a of this.#r.values())a.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class zn{#t=null;#e=new Map;#i=new Map;static#n=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return se(this,"_svgFactory",new Wh)}static#s(t,[e,i,a,l]){const{style:c}=t;c.top=`${100*i}%`,c.left=`${100*e}%`,c.width=`${100*a}%`,c.height=`${100*l}%`}#r(){const t=zn._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#a(t,e){const i=zn._svgFactory.createElement("clipPath");t.append(i);const a=`clip_${e}`;i.setAttribute("id",a),i.setAttribute("clipPathUnits","objectBoundingBox");const l=zn._svgFactory.createElement("use");return i.append(l),l.setAttribute("href",`#${e}`),l.classList.add("clip"),a}#o(t,e){for(const[i,a]of Object.entries(e))a===null?t.removeAttribute(i):t.setAttribute(i,a)}draw(t,e=!1,i=!1){const a=zn.#n++,l=this.#r(),c=zn._svgFactory.createElement("defs");l.append(c);const u=zn._svgFactory.createElement("path");c.append(u);const d=`path_${a}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(a,u);const f=i?this.#a(c,d):null,p=zn._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(l,t),this.#e.set(a,l),{id:a,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=zn.#n++,a=this.#r(),l=zn._svgFactory.createElement("defs");a.append(l);const c=zn._svgFactory.createElement("path");l.append(c);const u=`path_${i}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const y=zn._svgFactory.createElement("mask");l.append(y),d=`mask_${i}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const x=zn._svgFactory.createElement("rect");y.append(x),x.setAttribute("width","1"),x.setAttribute("height","1"),x.setAttribute("fill","white");const S=zn._svgFactory.createElement("use");y.append(S),S.setAttribute("href",`#${u}`),S.setAttribute("stroke","none"),S.setAttribute("fill","black"),S.setAttribute("fill-rule","nonzero"),S.classList.add("mask")}const f=zn._svgFactory.createElement("use");a.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const p=f.cloneNode();return a.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(a,t),this.#e.set(i,a),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:a,rootClass:l,path:c}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#o(u,i),a&&zn.#s(u,a),l){const{classList:d}=u;for(const[f,p]of Object.entries(l))d.toggle(f,p)}if(c){const f=u.firstElementChild.firstElementChild;this.#o(f,c)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:cm};globalThis.pdfjsLib={AbortException:cr,AnnotationEditorLayer:ma,AnnotationEditorParamsType:we,AnnotationEditorType:oe,AnnotationEditorUIManager:ur,AnnotationLayer:$m,AnnotationMode:rr,AnnotationType:Sn,applyOpacity:tT,build:o2,ColorPicker:aw,createValidAbsoluteUrl:Nx,CSSConstants:JC,DOMSVGFactory:Wh,DrawLayer:zn,FeatureTest:Cn,fetchData:tu,findContrastColor:eT,getDocument:ew,getFilenameFromUrl:$C,getPdfFilenameFromUrl:XC,getRGB:nu,getUuid:Ox,getXfaPageViewport:QC,GlobalWorkerOptions:dl,ImageKind:Ih,InvalidPDFException:tm,isDataScheme:dd,isPdfFile:Bm,isValidExplicitDest:dT,MathClamp:qn,noContextMenu:Xi,normalizeUnicode:KC,OPS:qc,OutputScale:Ps,PagesMapper:Ne,PasswordResponses:jC,PDFDataRangeTransport:nw,PDFDateString:em,PDFWorker:Kc,PermissionFlag:LC,PixelsPerInch:yl,RenderingCancelledException:Pm,renderRichText:jx,ResponseException:Yh,setLayerDimensions:no,shadow:se,SignatureExtractor:al,stopEvent:on,SupportedImageMimeTypes:nm,TextLayer:Ti,TouchManager:fd,updateUrlHash:kx,Util:zt,VerbosityLevel:ld,version:r2,XfaLayer:Lx};dl.workerSrc=new URL("/static/frontend/assets/pdf.worker-BA9kU3Pw.mjs",import.meta.url).toString();const k2=()=>typeof window<"u"&&window.devicePixelRatio||1;function O2(r,t){const e=Math.sqrt(t[2]*t[2]+t[3]*t[3]),i=Math.sqrt(t[0]*t[0]+t[1]*t[1]),a=e,l=a,c=typeof r.width=="number"&&r.width>0?r.width*i:(r.str?.length||1)*l*.5,u=t[4],d=t[5]-a*.85;return{x:u,y:d,w:c,h:l}}function L2(r,t,e){const a=(typeof document<"u"?document.createElement("canvas"):null)?.getContext("2d"),l=[];let c=0,u=-999;const d=4;let f=0;return r.items.forEach(p=>{if(!p.str||p.str.trim()==="")return;const y=zt.transform(t.transform,p.transform),x=O2(p,y);Math.abs(x.y-u)>d&&(c+=1,u=x.y);const S=x.h,A=typeof p.width=="number"&&p.width>0?p.width*e:x.w,E=p.str.split(/(\s+)/);if(!a||E.length===0){l.push({id:f++,text:p.str,x:x.x,y:x.y,w:x.w,h:x.h,fontSize:x.h,lineIndex:c});return}a.font=`${S}px sans-serif`;const R=E.map(I=>({text:I,measured:a.measureText(I).width,isSpace:/^\s+$/.test(I)||I===""})),D=R.reduce((I,z)=>I+z.measured,0),k=D>0?A/D:1;let O=0;R.forEach(I=>{const z=I.measured*k;if(I.text===""||I.isSpace){O+=z;return}l.push({id:f,text:I.text,x:x.x+O,y:x.y,w:z,h:S,fontSize:S,lineIndex:c}),f+=1,O+=z})}),l}function fw(r){const t={};return r.forEach(e=>{const i=e.lineIndex??Math.round(e.y/4)*4;t[i]||(t[i]=[]),t[i].push(e)}),Object.values(t)}function Cv(r,t,e){let l=null,c=1/0;for(const u of r){if(!(e>=u.y-6&&e<=u.y+u.h+6))continue;if(t>=u.x-4&&t<=u.x+u.w+4)return u;const p=t<u.x?u.x-t:t-(u.x+u.w);p<c&&p<40&&(c=p,l=u)}return l}function j2(r){if(!r.length)return"";let t="";for(let e=0;e<r.length;e++){const i=r[e];if(e>0){const a=r[e-1];Math.abs(i.y-a.y)<6?i.x-(a.x+a.w)>1&&(t+=" "):t+=" "}t+=i.text}return t.trim()}function P2(r,t){return r.length?fw(r).map(i=>{const a=Math.min(...i.map(y=>y.x)),l=Math.max(...i.map(y=>y.x+y.w)),c=i.map(y=>y.y),u=c.sort((y,x)=>y-x)[Math.floor(c.length/2)],d=Math.max(...i.map(y=>y.h)),f=2;return{x:(a-1)/t,y:(u-f)/t,width:(l-a+2)/t,height:(d+f+3)/t}}):[]}function B2({pdfData:r,scale:t,highlights:e=[],hoveredHighlightId:i=null,activeHighlightId:a=null,selectionForPicker:l=null,presetColors:c=[],onSelectionComplete:u,onNumPages:d,onHighlightHover:f,onHighlightHoverEnd:p,onHighlightEdit:y,onHighlightDelete:x}){const[S,A]=U.useState(null),[E,R]=U.useState(0),[D,k]=U.useState(!0);return U.useEffect(()=>{if(!r)return;let O=!1;return(async()=>{k(!0);try{const z=r.slice(0),H=await ew({data:z}).promise;O||(A(H),R(H.numPages),d?.(H.numPages))}catch(z){console.error("Failed to load PDF",z)}O||k(!1)})(),()=>{O=!0}},[r,d]),D?C.jsx("div",{className:"flex items-center justify-center h-full",children:C.jsx(Os,{className:"w-6 h-6 text-slate-400 animate-spin"})}):S?C.jsx("div",{className:"flex flex-col items-center py-6 gap-4",children:Array.from({length:E},(O,I)=>C.jsx(F2,{pdf:S,pageNumber:I+1,scale:t,pageHighlights:e.filter(z=>z.page_number===I+1),hoveredHighlightId:i,activeHighlightId:a,selectionForPicker:l,presetColors:c,onSelectionComplete:u,onHighlightHover:f,onHighlightHoverEnd:p,onHighlightEdit:y,onHighlightDelete:x},I))}):null}function F2({pdf:r,pageNumber:t,scale:e,pageHighlights:i,hoveredHighlightId:a,activeHighlightId:l,selectionForPicker:c,presetColors:u=[],onSelectionComplete:d,onHighlightHover:f,onHighlightHoverEnd:p,onHighlightEdit:y,onHighlightDelete:x}){const S=U.useRef(null),A=U.useRef(null),E=U.useRef(null),R=U.useRef(null),[D,k]=U.useState({width:0,height:0}),[O,I]=U.useState([]),[z,H]=U.useState(null),[P,rt]=U.useState(null),[ut,St]=U.useState(!1),_t=U.useRef(null),Mt=U.useRef(null),Vt=U.useCallback(()=>{Mt.current&&clearTimeout(Mt.current),Mt.current=setTimeout(()=>{p?.(),Mt.current=null},1e3)},[p]),vt=U.useCallback(F=>{Mt.current&&(clearTimeout(Mt.current),Mt.current=null),f?.(F)},[f]);U.useEffect(()=>()=>{Mt.current&&clearTimeout(Mt.current)},[]),U.useEffect(()=>{let F=!1;return(async()=>{const ht=await r.getPage(t),xt=k2(),Dt=ht.getViewport({scale:e}),qt=ht.getViewport({scale:e*xt}),Bt=A.current;if(!Bt||F)return;const he=Bt.getContext("2d",{alpha:!1});he.imageSmoothingEnabled=!0,he.imageSmoothingQuality="high",Bt.width=qt.width,Bt.height=qt.height,Bt.style.width=`${Dt.width}px`,Bt.style.height=`${Dt.height}px`,k({width:Dt.width,height:Dt.height}),await ht.render({canvasContext:he,viewport:qt}).promise;const de=await ht.getTextContent();if(F)return;const Rt=L2(de,Dt,e);I(Rt);const pe=E.current;!pe||F||(pe.innerHTML="",pe.style.width=`${Dt.width}px`,pe.style.height=`${Dt.height}px`,Rt.forEach(Xt=>{const Ce=document.createElement("span");Ce.textContent=Xt.text,Ce.style.position="absolute",Ce.style.left=`${Xt.x}px`,Ce.style.top=`${Xt.y}px`,Ce.style.width=`${Xt.w}px`,Ce.style.height=`${Xt.h}px`,Ce.style.fontSize=`${Xt.fontSize}px`,Ce.style.fontFamily="sans-serif",Ce.style.color="transparent",Ce.style.whiteSpace="pre",Ce.style.pointerEvents="none",Ce.style.lineHeight="1",pe.appendChild(Ce)}))})(),()=>{F=!0}},[r,t,e]);const Ht=U.useMemo(()=>{if(c&&c.pageNumber===t){const ht=Math.min(c.spanStart,c.spanEnd),xt=Math.max(c.spanStart,c.spanEnd);return O.filter(Dt=>Dt.id>=ht&&Dt.id<=xt)}if(z==null||P==null)return[];const F=Math.min(z,P),J=Math.max(z,P);return O.filter(ht=>ht.id>=F&&ht.id<=J)},[O,c,t,z,P]);U.useEffect(()=>{c===null&&_t.current?.pageNumber===t&&(H(null),rt(null)),_t.current=c},[c,t]);const G=U.useCallback((F,J)=>{const ht=S.current?.getBoundingClientRect();return ht?{x:F-ht.left,y:J-ht.top}:{x:0,y:0}},[]),ct=U.useCallback(F=>{if(F.button!==0||!O.length)return;const{x:J,y:ht}=G(F.clientX,F.clientY),xt=Cv(O,J,ht);xt?(H(xt.id),rt(xt.id),St(!0)):(H(null),rt(null))},[O,G]),yt=U.useCallback(F=>{if(!ut)return;const{x:J,y:ht}=G(F.clientX,F.clientY),xt=Cv(O,J,ht);xt&&rt(xt.id)},[ut,O,G]),Tt=U.useCallback(F=>{if(F.button!==0||!ut)return;if(St(!1),Ht.length<2){H(null),rt(null);return}if(!d)return;const J=S.current?.getBoundingClientRect();if(!J)return;const ht={rects:P2(Ht,e)},xt=j2(Ht),Dt=Ht[Ht.length-1],qt={x:J.left+(Dt.x+Dt.w/2),y:J.top+(Dt.y-8)};d({pageNumber:t,position_data:ht,highlighted_text:xt,spanStart:Math.min(z,P),spanEnd:Math.max(z,P),pickerPosition:qt})},[ut,Ht,z,P,e,t,d]);U.useEffect(()=>{const F=R.current||S.current;if(F)return F.addEventListener("mousedown",ct),F.addEventListener("mousemove",yt),F.addEventListener("mouseup",Tt),F.addEventListener("mouseleave",Tt),()=>{F.removeEventListener("mousedown",ct),F.removeEventListener("mousemove",yt),F.removeEventListener("mouseup",Tt),F.removeEventListener("mouseleave",Tt)}},[ct,yt,Tt]);const Pt=U.useMemo(()=>fw(Ht),[Ht]);return C.jsxs("div",{ref:S,"data-page":t,className:"relative shadow-lg bg-white overflow-hidden select-none",style:{width:D.width||0,height:D.height||0,cursor:"text"},title:"Drag to highlight text",children:[C.jsx("canvas",{ref:A,className:"block w-full h-full",style:{display:"block"}}),C.jsxs("div",{ref:R,className:"absolute inset-0",style:{pointerEvents:"auto"},children:[i.map(F=>{const J=F.position_data?.rects||[],ht=(u??[]).find(pe=>pe.key===F.color),xt=$i[F.color]||$i.yellow,Dt=ht?.hex??xt?.hex??xt?.solid,qt=a!=null&&String(F.id)===String(a),Bt=l!=null&&String(F.id)===String(l),he=qt||Bt?W0(Dt,.38):W0(Dt,.18),de=y||x;let Rt=null;if(J.length>0){const pe=Math.min(...J.map(Nt=>Nt.x))*e,Xt=Math.min(...J.map(Nt=>Nt.y))*e,Ce=Math.max(...J.map(Nt=>(Nt.x||0)+(Nt.width||0)))*e,On=Math.max(...J.map(Nt=>(Nt.y||0)+(Nt.height||4)))*e;Rt={left:pe,top:Xt,width:Ce-pe,height:On-Xt}}return Rt?C.jsxs("div",{className:"absolute rounded-sm transition-colors duration-150 group",style:{left:Rt.left,top:Rt.top,width:Rt.width,height:Rt.height,pointerEvents:"auto"},onMouseEnter:()=>vt(F.id),onMouseLeave:Vt,children:[J.map((pe,Xt)=>C.jsx("div",{className:"absolute rounded-sm transition-colors duration-150",style:{left:(pe.x||0)*e-Rt.left,top:(pe.y||0)*e-Rt.top,width:Math.max(0,(pe.width||0)*e),height:Math.max(4,(pe.height||0)*e),backgroundColor:he,pointerEvents:"none"}},Xt)),de&&qt&&Rt&&C.jsxs("div",{className:"absolute flex items-center gap-0.5 rounded-md border border-slate-200 bg-white shadow-sm z-10",style:{left:0,bottom:"100%",marginBottom:4},onMouseEnter:()=>vt(F.id),onMouseLeave:Vt,children:[y&&C.jsx("button",{type:"button",onClick:pe=>{pe.stopPropagation(),y(F.id,pe)},className:"p-1.5 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-l-md transition-colors",title:"Edit note","aria-label":"Edit note",children:C.jsx(Yp,{className:"w-3.5 h-3.5",strokeWidth:2})}),x&&C.jsx("button",{type:"button",onClick:pe=>{pe.stopPropagation(),x(F.id)},className:"p-1.5 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded-r-md transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:C.jsx(zc,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]},F.id):null}),Pt.map((F,J)=>{const ht=Math.min(...F.map(Rt=>Rt.x)),xt=Math.max(...F.map(Rt=>Rt.x+Rt.w)),Dt=F.map(Rt=>Rt.y).sort((Rt,pe)=>Rt-pe),qt=Dt[Math.floor(Dt.length/2)],Bt=Math.max(...F.map(Rt=>Rt.h)),he=2;return C.jsx("div",{className:"absolute rounded-sm pointer-events-none",style:{left:`${ht-1}px`,top:`${qt-he}px`,width:`${xt-ht+2}px`,height:`${Bt+he+3}px`,backgroundColor:"rgba(59, 130, 246, 0.2)"}},J)})]}),C.jsx("div",{ref:E,className:"absolute inset-0 overflow-hidden pointer-events-none","aria-hidden":!0})]})}function I2({highlights:r,colorLabels:t,presetColors:e=[],documentColorKeys:i,activeHighlightId:a,onScrollToPage:l,onHighlightClick:c,onHighlightHover:u,onHighlightHoverEnd:d,onClearActive:f,documentId:p,onHighlightNoteUpdate:y,onHighlightDelete:x,openEditForHighlightId:S,onClearOpenEditForHighlightId:A}){const E=e?.length>0?e.map(vt=>vt.key):i?.length>0?i:jm,[R,D]=U.useState("all"),[k,O]=U.useState(!1),[I,z]=U.useState(""),[H,P]=U.useState(null),[rt,ut]=U.useState("");U.useEffect(()=>{if(S==null||!r?.length)return;const vt=r.find(Ht=>String(Ht.id)===String(S));vt&&(P(vt.id),ut(vt.note?.content??"")),A?.()},[S,r,A]);const St=U.useMemo(()=>{let vt=r||[];if(R!=="all"&&(vt=vt.filter(Ht=>Ht.color===R)),I.trim()){const Ht=I.trim().toLowerCase();vt=vt.filter(G=>G.highlighted_text&&G.highlighted_text.toLowerCase().includes(Ht)||G.note?.content&&G.note.content.toLowerCase().includes(Ht))}return vt},[r,R,I]),_t=vt=>{P(vt.id),ut(vt.note?.content??"")},Mt=async()=>{if(H==null||!p||!y){P(null);return}await y(H,rt.trim()||""),P(null)},Vt=()=>{P(null),ut("")};return C.jsxs("div",{className:`w-80 shrink-0 flex flex-col border-l ${Ls.default} ${js.surface}`,children:[C.jsxs("div",{className:`px-4 pt-5 pb-0 border-b ${Ls.default}`,children:[C.jsx("h2",{className:`text-[15px] font-semibold ${Jt.heading} mb-1`,children:"Annotations"}),C.jsxs("p",{className:`text-xs ${Jt.muted} mb-4`,children:[St.length," highlight",St.length!==1?"s":"",r?.length!==St.length&&` of ${r?.length||0}`]}),C.jsxs("div",{className:"space-y-2 mb-4",children:[C.jsx("div",{children:C.jsx("button",{type:"button",onClick:()=>{D("all"),f?.()},className:`text-[11px] font-semibold px-3 py-1 rounded-full border cursor-pointer transition-colors ${R==="all"?"bg-slate-900 text-white border-slate-900":`border-slate-200 ${Jt.secondary} hover:bg-slate-50`}`,children:"All"})}),C.jsxs("div",{children:[C.jsxs("button",{type:"button",onClick:()=>O(vt=>!vt),className:`flex items-center gap-1.5 text-[11px] font-semibold ${Jt.secondary} hover:text-slate-800 transition-colors`,children:[k?C.jsx(Y_,{className:"w-3.5 h-3.5 shrink-0"}):C.jsx($_,{className:"w-3.5 h-3.5 shrink-0"}),"Categories"]}),!k&&C.jsx("div",{className:"flex flex-wrap gap-1.5 mt-1.5",children:E.map(vt=>{const Ht=(r||[]).filter(F=>F.color===vt).length,G=$i[vt],yt=e?.find(F=>F.key===vt)?.hex??G?.hex??G?.solid??"#94a3b8",Tt=Ns(vt,t,e),Pt=R===vt;return C.jsxs("button",{type:"button",onClick:()=>{D(Pt?"all":vt),f?.()},className:`text-[11px] font-semibold px-2.5 py-1 rounded-full border cursor-pointer transition-colors flex items-center gap-1.5 ${Pt?"border-transparent":`border-slate-200 ${Jt.secondary} hover:bg-slate-50`}`,style:Pt?{backgroundColor:`${yt}25`,color:yt}:void 0,children:[C.jsx("span",{className:"w-2 h-2 rounded-full shrink-0",style:{backgroundColor:yt,opacity:1}}),C.jsx("span",{children:Tt}),C.jsxs("span",{className:Pt?"opacity-80":Jt.muted,children:["(",Ht,")"]})]},vt)})})]})]}),C.jsxs("div",{className:"relative mb-4",children:[C.jsx(pC,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400",strokeWidth:2}),C.jsx("input",{type:"text",placeholder:"Search highlights...",value:I,onChange:vt=>z(vt.target.value),className:`w-full pl-8 pr-3 py-1.5 text-xs border ${Ls.default} rounded-lg bg-slate-50 outline-none ${Jt.body} placeholder:${Jt.muted}`})]})]}),C.jsx("div",{className:"flex-1 overflow-auto px-3 pb-5",children:r?.length?St.length?C.jsx("ul",{className:"space-y-1.5",children:St.map(vt=>{const Ht=$i[vt.color]||$i.yellow,ct=e?.find(Pt=>Pt.key===vt.color)?.hex??Ht?.hex??Ht?.solid??"#94a3b8",yt=vt.note?.content,Tt=a!=null&&String(vt.id)===String(a);return C.jsx("li",{children:C.jsxs("div",{role:"button",tabIndex:0,className:`w-full text-left rounded-[10px] p-3 transition-all cursor-pointer border ${Tt?"border-slate-300":"border-transparent hover:border-slate-200"} hover:bg-slate-50`,onClick:()=>{c?.(vt.id),l?.(vt.page_number)},onKeyDown:Pt=>{Pt.target.tagName==="TEXTAREA"||Pt.target.tagName==="INPUT"||Pt.target.isContentEditable||(Pt.key==="Enter"||Pt.key===" ")&&(Pt.preventDefault(),c?.(vt.id),l?.(vt.page_number))},onMouseEnter:()=>u?.(vt.id),onMouseLeave:d,children:[C.jsxs("div",{className:"flex gap-2.5",children:[C.jsx("div",{className:"w-0.5 min-h-9 shrink-0 rounded-full transition-opacity",style:{backgroundColor:ct,opacity:Tt?1:.6}}),C.jsx("div",{className:"flex-1 min-w-0",children:C.jsx("p",{className:`text-xs leading-snug ${Jt.body} line-clamp-3`,children:vt.highlighted_text||"(No text captured)"})})]}),H===vt.id?C.jsxs("div",{className:"mt-2 pl-3.5 space-y-1.5",children:[C.jsx("textarea",{value:rt,onChange:Pt=>ut(Pt.target.value),placeholder:"Add a comment...",rows:2,className:`w-full text-[11.5px] border ${Ls.default} rounded-lg px-2 py-1.5 resize-none outline-none focus:ring-1 focus:ring-slate-300 ${Jt.body}`}),C.jsxs("div",{className:"flex gap-1.5",children:[C.jsx("button",{type:"button",onClick:Mt,className:"text-[11px] font-medium px-2 py-1 rounded bg-slate-800 text-white hover:bg-slate-700",children:"Save"}),C.jsx("button",{type:"button",onClick:Vt,className:"text-[11px] font-medium px-2 py-1 rounded text-slate-600 hover:bg-slate-100",children:"Cancel"})]})]}):C.jsxs(C.Fragment,{children:[yt&&C.jsx("p",{className:`text-[11.5px] ${Jt.muted} mt-2 pl-3.5 leading-snug italic`,children:yt}),p&&y&&C.jsx("button",{type:"button",onClick:()=>_t(vt),className:"mt-1.5 pl-3.5 text-[11px] text-slate-500 hover:text-slate-700",children:yt?"Edit comment":"Add comment"})]}),C.jsxs("div",{className:"mt-2 pl-3.5 flex items-center gap-2 flex-wrap",children:[C.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:ct,backgroundColor:`${ct}12`},children:Ns(vt.color,t,e)}),C.jsxs("span",{className:"text-[10px] text-slate-400",children:["p.",vt.page_number]}),p&&x&&C.jsx("button",{type:"button",onClick:Pt=>{Pt.stopPropagation(),x(vt.id)},className:"ml-auto p-1 rounded text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:C.jsx(zc,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]})},vt.id)})}):C.jsx("div",{className:`py-6 text-center ${Jt.muted} text-sm`,children:"No matching highlights."}):C.jsxs("div",{className:`py-8 text-center ${Jt.muted} text-sm`,children:[C.jsx(Mx,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),C.jsx("p",{children:"No highlights yet."}),C.jsx("p",{className:"mt-1 text-xs",children:"Select text on the document to create your first highlight."})]})})]})}const dm=[{colorKey:"yellow",color:"#FBBF24",shortcut:"1"},{colorKey:"green",color:"#34D399",shortcut:"2"},{colorKey:"blue",color:"#60A5FA",shortcut:"3"},{colorKey:"pink",color:"#F472B6",shortcut:"4"},{colorKey:"orange",color:"#FB923C",shortcut:"5"}];function U2(r,t){return r?.length?[...r].sort((i,a)=>(i.sort_order??0)-(a.sort_order??0)).map((i,a)=>({colorKey:i.key,color:i.hex,shortcut:String(a+1)})):t?.length>0?t.map(e=>dm.find(i=>i.colorKey===e)).filter(Boolean):dm}function z2({position:r,onSelect:t,onClose:e,colorLabels:i,documentColorKeys:a,presetColors:l=[]}){const c=U.useRef(null),u=U.useRef(null),[d,f]=U.useState(null),[p,y]=U.useState(""),[x,S]=U.useState(!1),[A,E]=U.useState(!1),R=U.useMemo(()=>U2(l,a),[l,a]),D=R.length>0?R:dm,k=U.useCallback(H=>Ns(H,i,l),[i,l]);U.useEffect(()=>{x&&u.current&&u.current.focus()},[x]);const O=U.useCallback(H=>{f(H.colorKey),x||(t(H.colorKey,""),E(!0),setTimeout(()=>e(),400))},[x,t,e]),I=U.useCallback(()=>{d&&(t(d,p.trim()||void 0),E(!0),setTimeout(()=>e(),400))},[d,p,t,e]);if(U.useEffect(()=>{const H=P=>{if(P.key==="Escape"){e();return}if(!x){const rt=parseInt(P.key,10);if(rt>=1&&rt<=D.length){const ut=D[rt-1];ut&&O(ut)}}x&&P.key==="Enter"&&(P.metaKey||P.ctrlKey)&&(P.preventDefault(),I())};return window.addEventListener("keydown",H),()=>window.removeEventListener("keydown",H)},[x,d,p,e,O,I,D]),U.useEffect(()=>{const H=P=>{c.current&&!c.current.contains(P.target)&&e()};return document.addEventListener("mousedown",H),()=>document.removeEventListener("mousedown",H)},[e]),U.useEffect(()=>{y(""),f(null),S(!1),E(!1)},[r]),!r)return null;const z=d?D.find(H=>H.colorKey===d):null;return C.jsx("div",{ref:c,className:"fixed z-[1000]",style:{left:r.x,top:r.y-48,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:A?C.jsxs("div",{className:"flex items-center gap-2 rounded-[10px] px-3.5 py-2 bg-white border border-slate-200 shadow-md",children:[C.jsx("div",{className:"flex h-[18px] w-[18px] items-center justify-center rounded-full",style:{background:z?.color??"#64748b"},children:C.jsx("svg",{width:"10",height:"10",viewBox:"0 0 12 12",fill:"none",children:C.jsx("path",{d:"M2 6L5 9L10 3",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),C.jsx("span",{className:"text-[13px] font-medium text-slate-800",children:"Saved"})]}):C.jsxs("div",{className:"overflow-hidden rounded-xl bg-white border border-slate-200 shadow-lg",style:{width:x?280:"auto",transition:"width 0.2s cubic-bezier(0.16, 1, 0.3, 1)"},children:[C.jsxs("div",{className:"flex items-center gap-0.5 p-1.5",children:[D.map((H,P)=>C.jsx("button",{type:"button",onClick:()=>O(H),className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 hover:bg-slate-100",style:{background:d===H.colorKey?`${H.color}25`:"transparent"},children:C.jsx("div",{className:"h-4 w-4 rounded-full transition-[box-shadow,transform] duration-150",style:{background:H.color,boxShadow:d===H.colorKey?`0 0 0 2px ${H.color}80`:"none",transform:d===H.colorKey?"scale(1.15)":"scale(1)"}})},H.colorKey)),C.jsx("div",{className:"mx-0.5 h-4 w-px bg-slate-200"}),C.jsx("button",{type:"button",onClick:()=>S(!x),title:"Add note",className:`flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 ${x?"bg-slate-100":"hover:bg-slate-100"}`,children:C.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",children:[C.jsx("path",{d:"M13 2.5H3C2.72386 2.5 2.5 2.72386 2.5 3V13C2.5 13.2761 2.72386 13.5 3 13.5H10L13.5 10V3C13.5 2.72386 13.2761 2.5 13 2.5Z",stroke:x?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),C.jsx("path",{d:"M5.5 6H10.5",stroke:x?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),C.jsx("path",{d:"M5.5 8.5H8.5",stroke:x?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),C.jsx("path",{d:"M10 13.5V10H13.5",stroke:x?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),C.jsx("button",{type:"button",onClick:e,className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 bg-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-700 transition-colors duration-150",children:C.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:C.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]}),x&&C.jsxs("div",{className:"px-2 pb-2 border-t border-slate-100 pt-2",style:{animation:"expandIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[!z&&C.jsx("div",{className:"px-1.5 pb-2 pt-1 text-[11px] text-slate-500",children:"Pick a category above, then add your note"}),z&&C.jsxs("div",{className:"flex items-center gap-1.5 px-1.5 pb-2 pt-0.5",children:[C.jsx("div",{className:"h-2 w-2 rounded-full shrink-0",style:{background:z.color}}),C.jsx("span",{className:"text-[11px] font-medium text-slate-600",children:k(z.colorKey)})]}),C.jsx("textarea",{ref:u,value:p,onChange:H=>y(H.target.value),placeholder:"Add a note...",rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200"}),C.jsx("div",{className:"mt-1.5 flex items-center justify-end",children:C.jsx("button",{type:"button",onClick:I,disabled:!z,className:"rounded-lg border-0 px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-default transition-colors",children:"Save"})})]})]})})}const H2=["#FBBF24","#34D399","#60A5FA","#F472B6","#FB923C","#f59e0b","#3b82f6","#10b981","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316","#84cc16","#14b8a6"],Tv=10;function q2({preset:r,documentId:t,onClose:e}){const i=so(),a=r?.colors??[],l=!r||r.is_system,[c,u]=U.useState(null),[d,f]=U.useState(""),p=()=>{i.invalidateQueries({queryKey:["presets"]}),i.invalidateQueries({queryKey:["document",t]})},y=Mi({mutationFn:k=>ya.addColor(r.id,k),onSuccess:()=>{p(),u(null),f("")}}),x=Mi({mutationFn:k=>ya.removeColor(r.id,k),onSuccess:p}),S=Mi({mutationFn:({colorId:k,data:O})=>ya.updateColor(r.id,k,O),onSuccess:p}),A=new Set(a.map(k=>k.hex.toLowerCase())),E=H2.filter(k=>!A.has(k.toLowerCase())),R=()=>{!c||!d.trim()||y.mutate({key:`custom_${Date.now()}`,display_name:d.trim(),hex:c})},D=C.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40",onClick:e,children:C.jsxs("div",{role:"dialog","aria-modal":"true",className:`relative z-10 ${js.surface} rounded-xl shadow-xl border ${Ls.default} w-full max-w-md mx-4 overflow-hidden max-h-[90vh] flex flex-col`,onClick:k=>k.stopPropagation(),onMouseDown:k=>k.stopPropagation(),children:[C.jsxs("div",{className:"px-5 pt-5 pb-3 border-b border-slate-100 shrink-0",children:[C.jsx("h3",{className:`text-base font-semibold ${Jt.heading}`,children:"Edit preset"}),r&&C.jsx("p",{className:`text-xs ${Jt.muted} mt-0.5`,children:r.name})]}),C.jsx("div",{className:"px-5 py-4 space-y-4 overflow-auto flex-1 min-h-0",children:l?C.jsx("p",{className:`text-sm ${Jt.secondary}`,children:"System presets cannot be edited. Create a custom preset from Settings to customise colours."}):C.jsxs(C.Fragment,{children:[C.jsxs("div",{children:[C.jsxs("p",{className:`text-xs ${Jt.muted} mb-2.5 uppercase tracking-wider font-medium`,children:["Colours (",a.length,"/",Tv,")"]}),C.jsx("div",{className:"space-y-2",children:a.map(k=>C.jsxs("div",{className:"flex items-center gap-2.5",children:[C.jsx("div",{className:"w-7 h-7 rounded-full shrink-0 border-2 border-slate-200",style:{backgroundColor:k.hex}}),C.jsx("input",{type:"text",defaultValue:k.display_name,placeholder:"Label",onBlur:O=>{const I=O.target.value.trim();I&&I!==k.display_name&&S.mutate({colorId:k.id,data:{display_name:I}})},className:`flex-1 min-w-0 rounded-lg border ${Ls.default} px-2.5 py-1.5 text-sm ${Jt.body} placeholder:text-slate-400 outline-none focus:ring-2 focus:ring-slate-200`}),a.length>1&&C.jsx("button",{type:"button",onClick:()=>x.mutate(k.id),className:"shrink-0 p-1.5 rounded-lg text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors",disabled:x.isPending,children:C.jsx($h,{className:"w-3.5 h-3.5",strokeWidth:2.5})})]},k.id))})]}),a.length<Tv&&E.length>0&&C.jsx("div",{className:"pt-3 border-t border-slate-100",children:c?C.jsxs("div",{className:"space-y-2.5",children:[C.jsxs("div",{className:"flex items-center gap-2.5",children:[C.jsx("div",{className:"w-7 h-7 rounded-full shrink-0 border-2 border-slate-300",style:{backgroundColor:c}}),C.jsx("input",{type:"text",value:d,onChange:k=>f(k.target.value),placeholder:"Label, e.g. Key Metrics",autoFocus:!0,onKeyDown:k=>{k.key==="Enter"&&R()},className:`flex-1 min-w-0 rounded-lg border ${Ls.default} px-2.5 py-1.5 text-sm ${Jt.body} placeholder:text-slate-400 outline-none focus:ring-2 focus:ring-slate-200`})]}),C.jsxs("div",{className:"flex justify-end gap-2",children:[C.jsx("button",{type:"button",onClick:()=>{u(null),f("")},className:"px-3 py-1.5 text-xs text-slate-500 hover:bg-slate-100 rounded-lg",children:"Cancel"}),C.jsx("button",{type:"button",onClick:R,disabled:!d.trim()||y.isPending,className:"px-3 py-1.5 text-xs font-medium rounded-lg bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50",children:y.isPending?"Adding":"Add"})]})]}):C.jsxs(C.Fragment,{children:[C.jsx("p",{className:`text-xs ${Jt.muted} mb-2`,children:"Add a colour"}),C.jsx("div",{className:"flex flex-wrap gap-2",children:E.map(k=>C.jsx("button",{type:"button",onClick:()=>{u(k),f("")},className:"w-7 h-7 rounded-full border-2 border-transparent hover:border-slate-400 transition-all hover:scale-110",style:{backgroundColor:k}},k))})]})})]})}),C.jsx("div",{className:"px-5 py-3 border-t border-slate-100 flex justify-end shrink-0",children:C.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-slate-600 hover:bg-slate-100 rounded-lg",children:"Done"})})]})});return typeof document>"u"||!document.body?D:yA.createPortal(D,document.body)}function G2({position:r,initialValue:t="",onSave:e,onClose:i}){const[a,l]=U.useState(t),c=U.useRef(null),u=U.useRef(null);return U.useEffect(()=>{l(t)},[t,r]),U.useEffect(()=>{u.current?.focus()},[r]),U.useEffect(()=>{const d=f=>{f.key==="Escape"&&i(),f.key==="Enter"&&(f.metaKey||f.ctrlKey)&&(f.preventDefault(),e(a.trim()))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[a,e,i]),U.useEffect(()=>{const d=f=>{c.current&&!c.current.contains(f.target)&&i()};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[i]),r?C.jsxs("div",{ref:c,className:"fixed z-[1001] w-64 rounded-xl border border-slate-200 bg-white p-3 shadow-lg",style:{left:r.x,top:r.y+6,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[C.jsx("textarea",{ref:u,value:a,onChange:d=>l(d.target.value),placeholder:"Add a note...",rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200 mb-2"}),C.jsxs("div",{className:"flex items-center justify-end gap-2",children:[C.jsx("button",{type:"button",onClick:i,className:"rounded-lg px-2.5 py-1.5 text-xs font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Cancel"}),C.jsx("button",{type:"button",onClick:()=>e(a.trim()),className:"rounded-lg px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 transition-colors",children:"Save"})]})]}):null}function K2(){const{id:r}=ym(),t=wa(),e=so(),[i,a]=U.useState(null),[l,c]=U.useState(!1),[u,d]=U.useState(!0),[f,p]=U.useState(1.3),[y,x]=U.useState(!0),[S,A]=U.useState(null),[E,R]=U.useState(null),[D,k]=U.useState(null),[O,I]=U.useState(null),[z,H]=U.useState(null),[P,rt]=U.useState(0),[ut,St]=U.useState(1),[_t,Mt]=U.useState(!1),[Vt,vt]=U.useState(null),[Ht,G]=U.useState(null),[ct,yt]=U.useState(null),{data:Tt,isLoading:Pt,isError:F}=is({queryKey:["document",r],queryFn:async()=>{const{data:Ct}=await Hn.get(r);return Ct},enabled:!!r});U.useEffect(()=>{if(!Tt||!r)return;let Ct=!1;return(async()=>{d(!0);try{const Te=await kC(Tt);Ct||(Te?a(Te.data):c(!0))}finally{Ct||d(!1)}})(),()=>{Ct=!0}},[Tt,r]);const{data:J=[]}=is({queryKey:["highlights",r],queryFn:async()=>{const{data:Ct}=await Hn.highlights(r);return Ct},enabled:!!r}),{data:ht=[]}=is({queryKey:["presets"],queryFn:async()=>{const{data:Ct}=await ya.list();return Ct}}),xt=U.useMemo(()=>ht.length?Tt?.highlight_preset!=null?ht.find(Ct=>Ct.id===Tt.highlight_preset)??null:ht.find(Ct=>Ct.is_system)??ht[0]??null:null,[ht,Tt?.highlight_preset]),Dt=U.useMemo(()=>xt?.colors??Tt?.highlight_preset_detail?.colors??[],[xt?.colors,Tt?.highlight_preset_detail?.colors]),qt=U.useMemo(()=>{if(Dt?.length)return Dt.map(ne=>ne.key);const Ct=Object.keys(Tt?.color_labels||{});return Ct.length>0?Ct:[...jm]},[Dt,Tt?.color_labels]),Bt=Mi({mutationFn:({documentId:Ct,payload:ne})=>Hn.update(Ct,ne),onSuccess:(Ct,{documentId:ne})=>{e.invalidateQueries({queryKey:["document",ne]})}}),he=U.useCallback(async Ct=>{if(r)try{await Hn.createHighlight(r,Ct),e.invalidateQueries({queryKey:["highlights",r]}),k(null),I(null),H(null)}catch(ne){console.error("Failed to save highlight",ne)}},[r,e]),de=U.useCallback(Ct=>{k({page_number:Ct.pageNumber,position_data:Ct.position_data,highlighted_text:Ct.highlighted_text}),I(Ct.pickerPosition),H({pageNumber:Ct.pageNumber,spanStart:Ct.spanStart,spanEnd:Ct.spanEnd})},[]),Rt=U.useCallback((Ct,ne)=>{D&&he({...D,color:Ct,comment:ne})},[D,he]),pe=U.useCallback(()=>{k(null),I(null),H(null)},[]),Xt=U.useCallback(Ct=>{St(Ct),window.document.getElementById("pdf-scroll-container")?.querySelector(`[data-page="${Ct}"]`)?.scrollIntoView({behavior:"smooth",block:"start"})},[]),Ce=U.useCallback(Ct=>{R(ne=>ne!=null&&String(ne)===String(Ct)?null:Ct)},[]),On=U.useCallback(Ct=>rt(Ct??0),[]),Nt=U.useCallback(()=>{if(ut<=1)return;const Ct=ut-1;St(Ct),Xt(Ct)},[ut,Xt]),Se=U.useCallback(()=>{if(ut>=P)return;const Ct=ut+1;St(Ct),Xt(Ct)},[ut,P,Xt]),Bs=async Ct=>{const ne=Ct.target.files?.[0];if(!ne||!Tt||!r)return;const Te=await ne.arrayBuffer(),Fe=await Dx(Te);if(Fe!==Tt.pdf_hash){alert("This file does not match the original document.");return}try{const ai=new FormData;ai.append("file",new Blob([Te],{type:"application/pdf"}),ne.name||Tt.filename||"document.pdf"),await Hn.uploadPdf(r,ai)}catch(ai){const Yi=ai.response?.data?.detail??ai.message??"Upload failed";alert(typeof Yi=="string"?Yi:JSON.stringify(Yi));return}await Lm(Fe,Tt.filename||ne.name,ne.size,Te),a(Te),c(!1)};return r?Pt||u?C.jsx("div",{className:`${Zr} flex items-center justify-center min-h-[50vh]`,children:C.jsx(Os,{className:`w-8 h-8 ${Jt.muted} animate-spin`})}):F||!Tt&&!Pt?C.jsxs("div",{className:`${Zr} flex flex-col items-center justify-center min-h-[50vh]`,children:[C.jsx("h2",{className:`text-lg font-semibold ${Jt.heading} mb-2`,children:"Document not found"}),C.jsx("p",{className:`text-sm ${Jt.secondary} mb-4`,children:"It may have been deleted or you dont have access to it."}),C.jsx("button",{type:"button",onClick:()=>t(Tt?.project?`/project/${Tt.project}`:"/"),className:gl,children:"Back to project"})]}):l?C.jsxs("div",{className:`${Zr} flex flex-col items-center justify-center`,children:[C.jsx(Qp,{className:`w-12 h-12 ${Jt.muted} mb-4`}),C.jsx("h2",{className:`text-lg font-semibold ${Jt.heading} mb-2`,children:"PDF needed on this device"}),C.jsxs("p",{className:`text-sm ${Jt.secondary} mb-4 text-center max-w-sm`,children:["Upload the same file to open ",C.jsx("strong",{children:Tt?.filename}),"."]}),C.jsxs("label",{className:`${gl} inline-flex items-center gap-2`,children:[C.jsx(Qp,{className:"w-4 h-4"})," Upload PDF",C.jsx("input",{type:"file",accept:".pdf",onChange:Bs,className:"hidden"})]}),C.jsx("button",{type:"button",onClick:()=>t(Tt?.project?`/project/${Tt.project}`:"/"),className:`mt-4 text-sm ${Jt.muted} hover:underline`,children:"Back to project"})]}):C.jsxs("div",{className:`h-screen flex flex-col ${js.page} overflow-hidden`,children:[C.jsxs("header",{className:`${Tx} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx("button",{type:"button",onClick:()=>t(Tt?.project?`/project/${Tt.project}`:"/"),className:Oc,title:"Back to project",children:C.jsx(od,{className:"w-4 h-4"})}),C.jsx("p",{className:`text-sm font-medium ${Jt.heading} truncate max-w-xs`,children:Tt?.filename})]}),C.jsxs("div",{className:"flex items-center gap-2",children:[ht.length>0&&C.jsx("select",{value:Tt?.highlight_preset!=null?String(Tt.highlight_preset):ht.find(Ct=>Ct.is_system)?.id??"",onChange:Ct=>{const ne=Ct.target.value,Te=ne===""?null:Number(ne);r&&(J.length>0?yt(Te):Bt.mutate({documentId:r,payload:{highlight_preset:Te}}))},className:`text-xs rounded-lg border ${Ls.default} ${js.surface} py-1.5 pl-2 pr-7 ${Jt.body} cursor-pointer max-w-44`,title:"Highlight colour preset",children:ht.map(Ct=>C.jsx("option",{value:Ct.id,children:Ct.name},Ct.id))}),C.jsx("button",{type:"button",onClick:()=>Mt(!0),className:Oc,title:"Edit preset",children:C.jsx(gC,{className:"w-4 h-4"})}),C.jsx("button",{type:"button",onClick:()=>t(`/document/${r}/summary`),className:Oc,title:"Summary",children:C.jsx(W_,{className:"w-4 h-4"})}),C.jsx("div",{className:K0}),C.jsxs("div",{className:`flex items-center gap-1 ${js.muted} rounded-lg px-1 py-0.5`,children:[C.jsx("button",{type:"button",onClick:()=>p(Ct=>Math.max(.5,Ct-.1)),className:`p-1.5 ${Jt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:C.jsx(AC,{className:"w-3.5 h-3.5"})}),C.jsxs("span",{className:`text-xs ${Jt.secondary} w-12 text-center`,children:[Math.round(f*100),"%"]}),C.jsx("button",{type:"button",onClick:()=>p(Ct=>Math.min(3,Ct+.1)),className:`p-1.5 ${Jt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:C.jsx(wC,{className:"w-3.5 h-3.5"})})]}),C.jsx("div",{className:K0}),C.jsx("button",{type:"button",onClick:()=>x(Ct=>!Ct),className:Oc,title:y?"Close annotations":"Open annotations",children:y?C.jsx(lC,{className:"w-4 h-4"}):C.jsx(uC,{className:"w-4 h-4"})})]})]}),C.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[C.jsxs("div",{className:"flex-1 overflow-auto flex flex-col relative pb-14",id:"pdf-scroll-container",children:[i&&C.jsx(B2,{pdfData:i,scale:f,highlights:J,hoveredHighlightId:S,activeHighlightId:E,selectionForPicker:z,presetColors:Dt,onSelectionComplete:de,onNumPages:On,onHighlightHover:A,onHighlightHoverEnd:()=>A(null),onHighlightEdit:(Ct,ne)=>{const Te=ne?.target?.getBoundingClientRect?.();Te?G({highlightId:Ct,x:Te.left+Te.width/2,y:Te.bottom}):(vt(Ct),x(!0))},onHighlightDelete:async Ct=>{r&&(await Hn.deleteHighlight(r,Ct),e.invalidateQueries({queryKey:["highlights",r]}),String(E)===String(Ct)&&R(null),String(S)===String(Ct)&&A(null))}}),O&&C.jsx(z2,{position:O,onSelect:Rt,onClose:pe,colorLabels:Tt?.color_labels,documentColorKeys:qt,presetColors:Dt}),Ht&&C.jsx(G2,{position:{x:Ht.x,y:Ht.y},initialValue:(J||[]).find(Ct=>String(Ct.id)===String(Ht.highlightId))?.note?.content??"",onSave:async Ct=>{r&&(await Hn.updateHighlight(r,Ht.highlightId,{note:Ct}),e.invalidateQueries({queryKey:["highlights",r]}),G(null))},onClose:()=>G(null)}),_t&&C.jsx(q2,{preset:xt,documentId:r,onClose:()=>Mt(!1)}),ct!==null&&C.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40",onClick:()=>yt(null),children:C.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-slate-200 w-full max-w-sm mx-4 p-5",onClick:Ct=>Ct.stopPropagation(),children:[C.jsx("h3",{className:"text-base font-semibold text-slate-800 mb-2",children:"Switch preset?"}),C.jsxs("p",{className:"text-sm text-slate-600 mb-5",children:["This document has ",C.jsx("strong",{children:J.length})," highlight",J.length!==1?"s":"",". Switching presets will ",C.jsx("strong",{children:"delete all existing highlights"})," because the colour categories will change."]}),C.jsxs("div",{className:"flex justify-end gap-2",children:[C.jsx("button",{type:"button",onClick:()=>yt(null),className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancel"}),C.jsx("button",{type:"button",onClick:async()=>{const Ct=ct;yt(null);for(const ne of J)await Hn.deleteHighlight(r,ne.id);e.invalidateQueries({queryKey:["highlights",r]}),R(null),A(null),Bt.mutate({documentId:r,payload:{highlight_preset:Ct}})},className:"px-4 py-2 text-sm font-medium rounded-lg bg-red-600 text-white hover:bg-red-700",children:"Delete highlights & switch"})]})]})})]}),y&&C.jsx(I2,{highlights:J,colorLabels:Tt?.color_labels,presetColors:Dt,documentColorKeys:qt,activeHighlightId:E,onScrollToPage:Xt,onHighlightClick:Ce,onHighlightHover:A,onHighlightHoverEnd:()=>A(null),onClearActive:()=>R(null),documentId:r,openEditForHighlightId:Vt,onClearOpenEditForHighlightId:()=>vt(null),onHighlightNoteUpdate:async(Ct,ne)=>{r&&(await Hn.updateHighlight(r,Ct,{note:ne}),e.invalidateQueries({queryKey:["highlights",r]}))},onHighlightDelete:async Ct=>{r&&(await Hn.deleteHighlight(r,Ct),e.invalidateQueries({queryKey:["highlights",r]}),String(E)===String(Ct)&&R(null),String(S)===String(Ct)&&A(null))}})]}),P>0&&C.jsxs("div",{className:`fixed bottom-0 left-0 z-10 flex items-center justify-center gap-2 border-t border-slate-200 bg-white py-2.5 shadow-[0_-2px_8px_rgba(0,0,0,0.06)] ${y?"right-80":"right-0"}`,children:[C.jsx("button",{type:"button",onClick:Nt,disabled:ut<=1,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""}),C.jsxs("span",{className:"min-w-[80px] text-center text-xs text-slate-500",children:["Page ",ut," of ",P]}),C.jsx("button",{type:"button",onClick:Se,disabled:ut>=P,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""})]})]}):(t("/",{replace:!0}),null)}const Nh="sequence",kh="topic";function V2(){const{id:r}=ym(),t=wa(),[e,i]=U.useState(Nh),{data:a,isLoading:l,isError:c}=is({queryKey:["document",r],queryFn:async()=>{const{data:x}=await Hn.get(r);return x},enabled:!!r}),{data:u=[]}=is({queryKey:["highlights",r],queryFn:async()=>{const{data:x}=await Hn.highlights(r);return x},enabled:!!r}),d=a?.color_labels||{},f=U.useMemo(()=>a?.highlight_preset_detail?.colors??[],[a?.highlight_preset_detail?.colors]),p=U.useMemo(()=>{const x=[...u||[]];return e===Nh?(x.sort((S,A)=>S.page_number!==A.page_number?S.page_number-A.page_number:new Date(S.created_at)-new Date(A.created_at)),x):(x.sort((S,A)=>{const E=Ns(S.color,d,f),R=Ns(A.color,d,f);return E!==R?E.localeCompare(R):S.page_number!==A.page_number?S.page_number-A.page_number:new Date(S.created_at)-new Date(A.created_at)}),x)},[u,e,d,f]),y=U.useMemo(()=>{if(e!==kh)return[];const x=f?.length?f.map(A=>A.key):jm,S={};return(u||[]).forEach(A=>{const E=Ns(A.color,d,f);S[E]||(S[E]=[]),S[E].push(A)}),x.forEach(A=>{const E=Ns(A,d,f);S[E]&&S[E].sort((R,D)=>R.page_number!==D.page_number?R.page_number-D.page_number:new Date(R.created_at)-new Date(D.created_at))}),x.map(A=>({topic:Ns(A,d,f),colorKey:A,items:S[Ns(A,d,f)]||[]})).filter(A=>A.items.length>0)},[u,e,d,f]);return r?l?C.jsx("div",{className:`${Zr} flex items-center justify-center min-h-[50vh]`,children:C.jsx(Os,{className:`w-8 h-8 ${Jt.muted} animate-spin`})}):c||!a?C.jsxs("div",{className:`${Zr} flex flex-col items-center justify-center min-h-[50vh]`,children:[C.jsx("h2",{className:`text-lg font-semibold ${Jt.heading} mb-2`,children:"Document not found"}),C.jsx("button",{type:"button",onClick:()=>t(a?.project?`/project/${a.project}`:"/"),className:gl,children:"Back to project"})]}):C.jsxs("div",{className:`min-h-screen flex flex-col ${js.page}`,children:[C.jsxs("header",{className:`${Tx} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[C.jsxs("div",{className:"flex items-center gap-3",children:[C.jsx("button",{type:"button",onClick:()=>t(`/document/${r}`),className:Oc,children:C.jsx(od,{className:"w-4 h-4"})}),C.jsxs("div",{children:[C.jsx("h1",{className:`text-sm font-semibold ${Jt.heading}`,children:"Summary"}),C.jsx("p",{className:`text-xs ${Jt.muted} truncate max-w-[200px]`,children:a.filename})]})]}),C.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 p-0.5 bg-slate-50",children:[C.jsxs("button",{type:"button",onClick:()=>i(Nh),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===Nh?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[C.jsx(nC,{className:"w-3.5 h-3.5"}),"Sequence"]}),C.jsxs("button",{type:"button",onClick:()=>i(kh),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===kh?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[C.jsx(tC,{className:"w-3.5 h-3.5"}),"Topic"]})]})]}),C.jsx("main",{className:"flex-1 overflow-auto p-6 max-w-3xl mx-auto w-full",children:u?.length?e===kh&&y.length>0?C.jsx("div",{className:"space-y-8",children:y.map(({topic:x,colorKey:S,items:A})=>{const E=f?.find(k=>k.key===S),R=$i[S]||$i.yellow,D=E?.hex??R?.hex??R?.solid??"#94a3b8";return C.jsxs("section",{children:[C.jsxs("h2",{className:"text-sm font-semibold text-slate-800 mb-3 pb-2 border-b border-slate-200 flex items-center gap-2",children:[C.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:D}}),x,C.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:["(",A.length,")"]})]}),C.jsx("ul",{className:"space-y-3",children:A.map(k=>C.jsxs("li",{className:`rounded-lg border ${Ls.default} ${js.surface} p-4`,children:[C.jsx("p",{className:`text-sm ${Jt.body} leading-snug`,children:k.highlighted_text||"(No text captured)"}),k.note?.content&&C.jsx("p",{className:`text-xs ${Jt.muted} mt-2 italic`,children:k.note.content}),C.jsxs("p",{className:`text-[11px] ${Jt.muted} mt-2`,children:["p.",k.page_number]})]},k.id))})]},x)})}):C.jsx("ul",{className:"space-y-3",children:p.map(x=>{const S=f?.find(D=>D.key===x.color),A=$i[x.color]||$i.yellow,E=S?.hex??A?.hex??A?.solid??"#94a3b8",R=Ns(x.color,d,f);return C.jsxs("li",{className:`rounded-lg border ${Ls.default} ${js.surface} p-4 flex gap-3`,children:[C.jsx("div",{className:"w-1 min-h-8 rounded-full shrink-0",style:{backgroundColor:E}}),C.jsxs("div",{className:"min-w-0 flex-1",children:[C.jsx("p",{className:`text-sm ${Jt.body} leading-snug`,children:x.highlighted_text||"(No text captured)"}),x.note?.content&&C.jsx("p",{className:`text-xs ${Jt.muted} mt-2 italic`,children:x.note.content}),C.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[C.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:A.hex??A.solid,backgroundColor:`${A.hex??A.solid}18`},children:R}),C.jsxs("span",{className:`text-[11px] ${Jt.muted}`,children:["p.",x.page_number]})]})]})]},x.id)})}):C.jsxs("div",{className:`py-12 text-center ${Jt.muted} text-sm`,children:[C.jsx("p",{children:"No highlights yet."}),C.jsx("p",{className:"mt-1",children:"Select text in the document to create highlights, then return here for a summary."}),C.jsx("button",{type:"button",onClick:()=>t(`/document/${r}`),className:`${gl} mt-4`,children:"Open document"})]})})]}):(t("/",{replace:!0}),null)}const Rv=["#FBBF24","#34D399","#60A5FA","#F472B6","#FB923C","#f59e0b","#3b82f6","#10b981","#ef4444","#8b5cf6","#ec4899","#06b6d4","#f97316","#84cc16","#14b8a6"],$2=10;function X2(){const r=so(),[t,e]=U.useState(0),[i,a]=U.useState(""),[l,c]=U.useState(null),[u,d]=U.useState(""),[f,p]=U.useState(null),[y,x]=U.useState(null),[S,A]=U.useState(""),{data:E=[]}=is({queryKey:["presets"],queryFn:async()=>{const{data:P}=await ya.list();return P}}),R=()=>{e(0),a(""),c(null),d("")},D=Mi({mutationFn:P=>ya.create(P),onSuccess:()=>{r.invalidateQueries({queryKey:["presets"]}),R()}}),k=Mi({mutationFn:P=>ya.delete(P),onSuccess:()=>r.invalidateQueries({queryKey:["presets"]})}),O=Mi({mutationFn:({presetId:P,data:rt})=>ya.addColor(P,rt),onSuccess:()=>{r.invalidateQueries({queryKey:["presets"]}),p(null),x(null),A("")}}),I=Mi({mutationFn:({presetId:P,colorId:rt})=>ya.removeColor(P,rt),onSuccess:()=>r.invalidateQueries({queryKey:["presets"]})}),z=()=>{!i.trim()||!l||!u.trim()||D.mutate({name:i.trim(),colors:[{key:`color_${Date.now()}`,display_name:u.trim(),hex:l}]})},H=()=>{!f||!y||!S.trim()||O.mutate({presetId:f,data:{key:`custom_${Date.now()}`,display_name:S.trim(),hex:y}})};return C.jsxs("section",{className:"mt-8 p-6 bg-white border border-slate-200 rounded-xl",children:[C.jsxs("h2",{className:"text-base font-semibold text-slate-800 mb-1 flex items-center gap-2",children:[C.jsx(rC,{className:"w-4 h-4 text-slate-500"}),"Highlight presets"]}),C.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Create custom colour presets for documents. System presets are available to everyone."}),C.jsx("ul",{className:"space-y-2 mb-4",children:E.map(P=>C.jsxs("li",{className:"py-2.5 px-3 rounded-lg bg-slate-50 border border-slate-100",children:[C.jsxs("div",{className:"flex items-center justify-between gap-2 mb-1.5",children:[C.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[C.jsx("span",{className:"font-medium text-slate-800 truncate",children:P.name}),P.is_system&&C.jsx("span",{className:"text-[10px] font-medium px-1.5 py-0.5 rounded bg-slate-200 text-slate-600 shrink-0",children:"System"})]}),!P.is_system&&C.jsx("button",{type:"button",onClick:()=>{window.confirm(`Delete preset "${P.name}"?`)&&k.mutate(P.id)},className:"p-1 rounded text-slate-400 hover:text-red-600 hover:bg-red-50 shrink-0",title:"Delete preset",children:C.jsx(zc,{className:"w-3.5 h-3.5"})})]}),C.jsxs("div",{className:"flex flex-wrap gap-1.5 items-center",children:[(P.colors??[]).map(rt=>C.jsxs("div",{className:"relative group flex items-center gap-1 bg-white rounded-full border border-slate-200 pl-1 pr-2 py-0.5",children:[C.jsx("div",{className:"w-4 h-4 rounded-full shrink-0",style:{backgroundColor:rt.hex}}),C.jsx("span",{className:"text-[11px] text-slate-600",children:rt.display_name}),!P.is_system&&(P.colors?.length??0)>1&&C.jsx("button",{type:"button",onClick:()=>I.mutate({presetId:P.id,colorId:rt.id}),className:"ml-0.5 text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:C.jsx($h,{className:"w-3 h-3",strokeWidth:2.5})})]},rt.id)),!P.is_system&&(P.colors?.length??0)<$2&&C.jsx("button",{type:"button",onClick:()=>{p(P.id),x(null),A("")},className:"w-5 h-5 rounded-full border-2 border-dashed border-slate-300 flex items-center justify-center text-slate-400 hover:border-slate-400 hover:text-slate-500 transition-colors",title:"Add colour",children:C.jsx(X0,{className:"w-3 h-3",strokeWidth:2.5})})]})]},P.id))}),C.jsxs("button",{type:"button",onClick:()=>e(1),className:"flex items-center gap-2 px-4 py-2 text-sm font-medium rounded-lg border border-slate-200 bg-white text-slate-700 hover:bg-slate-50",children:[C.jsx(X0,{className:"w-4 h-4"}),"Create preset"]}),t>0&&C.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40",onClick:()=>!D.isPending&&R(),children:C.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-slate-200 w-full max-w-sm mx-4 p-5",onClick:P=>P.stopPropagation(),children:[t===1&&C.jsxs(C.Fragment,{children:[C.jsx("h3",{className:"text-base font-semibold text-slate-800 mb-3",children:"New preset"}),C.jsx("label",{className:"block text-xs text-slate-500 mb-1",children:"Preset name"}),C.jsx("input",{type:"text",value:i,onChange:P=>a(P.target.value),placeholder:"e.g. Private Equity",autoFocus:!0,onKeyDown:P=>{P.key==="Enter"&&i.trim()&&e(2)},className:"w-full rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 outline-none focus:ring-2 focus:ring-slate-300 mb-4"}),C.jsxs("div",{className:"flex justify-end gap-2",children:[C.jsx("button",{type:"button",onClick:R,className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancel"}),C.jsx("button",{type:"button",onClick:()=>e(2),disabled:!i.trim(),className:"px-4 py-2 text-sm font-medium rounded-lg bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50",children:"Next"})]})]}),t===2&&C.jsxs(C.Fragment,{children:[C.jsx("h3",{className:"text-base font-semibold text-slate-800 mb-1",children:"Add your first colour"}),C.jsx("p",{className:"text-xs text-slate-500 mb-3",children:"Pick a colour, then give it a label."}),C.jsx("div",{className:"flex flex-wrap gap-2 mb-3",children:Rv.map(P=>C.jsx("button",{type:"button",onClick:()=>c(P),className:"w-7 h-7 rounded-full shrink-0 transition-all border-2 focus:outline-none",style:{background:P,borderColor:l===P?"#1e293b":"transparent",transform:l===P?"scale(1.15)":"scale(1)"}},P))}),l&&C.jsxs("div",{className:"flex items-center gap-2.5 mb-4",children:[C.jsx("div",{className:"w-6 h-6 rounded-full shrink-0 border-2 border-slate-200",style:{backgroundColor:l}}),C.jsx("input",{type:"text",value:u,onChange:P=>d(P.target.value),placeholder:"Label, e.g. Key Metrics",autoFocus:!0,onKeyDown:P=>{P.key==="Enter"&&z()},className:"flex-1 rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-800 placeholder:text-slate-400 outline-none focus:ring-2 focus:ring-slate-300"})]}),C.jsxs("div",{className:"flex justify-end gap-2",children:[C.jsx("button",{type:"button",onClick:()=>e(1),className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg",children:"Back"}),C.jsx("button",{type:"button",onClick:z,disabled:!l||!u.trim()||D.isPending,className:"px-4 py-2 text-sm font-medium rounded-lg bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50",children:D.isPending?"Creating":"Create preset"})]})]})]})}),f&&C.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40",onClick:()=>!O.isPending&&p(null),children:C.jsxs("div",{className:"bg-white rounded-xl shadow-xl border border-slate-200 w-full max-w-sm mx-4 p-5",onClick:P=>P.stopPropagation(),children:[C.jsx("h3",{className:"text-base font-semibold text-slate-800 mb-3",children:"Add colour"}),y?C.jsx("div",{className:"space-y-2.5",children:C.jsxs("div",{className:"flex items-center gap-2.5",children:[C.jsx("div",{className:"w-7 h-7 rounded-full shrink-0 border-2 border-slate-300",style:{backgroundColor:y}}),C.jsx("input",{type:"text",value:S,onChange:P=>A(P.target.value),placeholder:"Label, e.g. Investment Risks",autoFocus:!0,onKeyDown:P=>{P.key==="Enter"&&H()},className:"flex-1 min-w-0 rounded-lg border border-slate-200 px-2.5 py-1.5 text-sm text-slate-800 placeholder:text-slate-400 outline-none focus:ring-2 focus:ring-slate-300"})]})}):C.jsxs(C.Fragment,{children:[C.jsx("p",{className:"text-xs text-slate-500 mb-2",children:"Pick a colour"}),C.jsx("div",{className:"flex flex-wrap gap-2",children:(()=>{const P=E.find(ut=>ut.id===f),rt=new Set((P?.colors??[]).map(ut=>ut.hex.toLowerCase()));return Rv.filter(ut=>!rt.has(ut.toLowerCase()))})().map(P=>C.jsx("button",{type:"button",onClick:()=>x(P),className:"w-7 h-7 rounded-full border-2 border-transparent hover:border-slate-400 transition-all hover:scale-110",style:{backgroundColor:P}},P))})]}),C.jsxs("div",{className:"flex justify-end gap-2 mt-4",children:[C.jsx("button",{type:"button",onClick:()=>{y?(x(null),A("")):p(null)},disabled:O.isPending,className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg",children:y?"Back":"Cancel"}),y&&C.jsx("button",{type:"button",onClick:H,disabled:!S.trim()||O.isPending,className:"px-4 py-2 text-sm font-medium rounded-lg bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50",children:O.isPending?"Adding":"Add"})]})]})})]})}function Y2({onClose:r,onConfirm:t,isDeleting:e}){return C.jsx("div",{className:"fixed inset-0 bg-slate-950/40 backdrop-blur-sm flex items-center justify-center z-[1000]",onClick:r,children:C.jsxs("div",{className:"bg-white rounded-xl p-6 w-full max-w-[400px] mx-4 shadow-xl",onClick:i=>i.stopPropagation(),children:[C.jsx("h3",{className:"m-0 text-lg font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"Delete account?"}),C.jsx("p",{className:"mt-2 mb-6 text-sm text-slate-600",style:{fontFamily:"'DM Sans', sans-serif"},children:"This will permanently delete your account and all your data. This cannot be undone."}),C.jsxs("div",{className:"flex justify-end gap-2",children:[C.jsx("button",{type:"button",onClick:r,disabled:e,className:"px-4 py-2 text-sm font-medium border border-slate-200 rounded-lg bg-white text-slate-600 hover:bg-slate-50",children:"Cancel"}),C.jsx("button",{type:"button",onClick:t,disabled:e,className:"px-4 py-2 text-sm font-medium rounded-lg text-white bg-red-600 hover:bg-red-700 disabled:opacity-70",children:e?C.jsxs(C.Fragment,{children:[C.jsx(Os,{className:"w-4 h-4 animate-spin inline-block mr-1.5 align-middle"}),"Deleting"]}):"Delete account"})]})]})})}function Q2(){const r=wa(),t=Sa(p=>p.logout),[e,i]=U.useState(!1),[a,l]=U.useState(!1),[c,u]=U.useState(""),d=()=>{t(),r("/login",{replace:!0})},f=async()=>{u(""),l(!0);try{await ml.deleteAccount(),t(),r("/",{replace:!0})}catch(p){u(p.response?.data?.detail||p.message||"Something went wrong."),l(!1)}};return C.jsxs("div",{className:"min-h-screen bg-slate-50 antialiased",style:{fontFamily:"'DM Sans', sans-serif"},children:[C.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&display=swap",rel:"stylesheet"}),C.jsxs("header",{className:"bg-white/92 backdrop-blur-md border-b border-slate-200 py-4 px-10 flex items-center justify-between",children:[C.jsxs("div",{className:"flex items-center gap-2",children:[C.jsx("button",{type:"button",onClick:()=>r("/app"),className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Back to projects",children:C.jsx(od,{className:"w-4 h-4"})}),C.jsx("span",{className:"text-[1.05rem] font-semibold text-slate-900",style:{fontFamily:"'Instrument Serif', serif"},children:"WiseMark"})]}),C.jsx("button",{type:"button",onClick:d,className:"p-2 rounded-lg text-slate-500 hover:text-slate-700 hover:bg-slate-100",title:"Sign out",children:C.jsx(km,{className:"w-4 h-4"})})]}),C.jsxs("div",{className:"max-w-[560px] mx-auto px-6 py-10",children:[C.jsx("h1",{className:"m-0 text-[28px] font-normal text-slate-950 tracking-tight",style:{fontFamily:"'Instrument Serif', serif"},children:"Account settings"}),C.jsx(X2,{}),C.jsxs("section",{className:"mt-8 p-6 bg-white border border-slate-200 rounded-xl",children:[C.jsx("h2",{className:"text-base font-semibold text-slate-800 mb-1",children:"Delete account"}),C.jsx("p",{className:"text-sm text-slate-500 mb-4",children:"Permanently delete your account and all your projects and documents."}),C.jsx("button",{type:"button",onClick:()=>i(!0),className:"px-4 py-2 text-sm font-medium rounded-lg text-red-600 border border-red-200 bg-white hover:bg-red-50",children:"Delete account"})]}),c&&C.jsx("p",{className:"mt-4 text-sm text-red-600",children:c})]}),e&&C.jsx(Y2,{onClose:()=>!a&&i(!1),onConfirm:f,isDeleting:a})]})}const W2=new zA({defaultOptions:{queries:{staleTime:3e4,retry:1}}});function kc({children:r}){return Sa(e=>e.token)?r:C.jsx(qh,{to:"/login",replace:!0})}function Mv({children:r}){return Sa(e=>e.token)?C.jsx(qh,{to:"/app",replace:!0}):r}function Z2(){return C.jsx(HA,{client:W2,children:C.jsx(oA,{children:C.jsxs(BS,{children:[C.jsx(Rs,{path:"/login",element:C.jsx(Mv,{children:C.jsx(B_,{})})}),C.jsx(Rs,{path:"/register",element:C.jsx(Mv,{children:C.jsx(F_,{})})}),C.jsx(Rs,{path:"/",element:C.jsx(qh,{to:"/app",replace:!0})}),C.jsx(Rs,{path:"/app",element:C.jsx(kc,{children:C.jsx(TC,{})})}),C.jsx(Rs,{path:"/app/settings",element:C.jsx(kc,{children:C.jsx(Q2,{})})}),C.jsx(Rs,{path:"/project/:projectId",element:C.jsx(kc,{children:C.jsx(OC,{})})}),C.jsx(Rs,{path:"/document/:id",element:C.jsx(kc,{children:C.jsx(K2,{})})}),C.jsx(Rs,{path:"/document/:id/summary",element:C.jsx(kc,{children:C.jsx(V2,{})})}),C.jsx(Rs,{path:"*",element:C.jsx(qh,{to:"/app",replace:!0})})]})})})}U1.createRoot(document.getElementById("root")).render(C.jsx(U.StrictMode,{children:C.jsx(Z2,{})}));
