var Xb=a=>{throw TypeError(a)};var lp=(a,t,e)=>t.has(a)||Xb("Cannot "+e);var Ke=(a,t,e)=>(lp(a,t,"read from private field"),e?e.call(a):t.get(a)),bs=(a,t,e)=>t.has(a)?Xb("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(a):t.set(a,e),ci=(a,t,e,i)=>(lp(a,t,"write to private field"),i?i.call(a,e):t.set(a,e),e),vs=(a,t,e)=>(lp(a,t,"access private method"),e);var Yb=(a,t,e,i)=>({set _(r){ci(a,t,r,e)},get _(){return Ke(a,t,i)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function e(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerPolicy&&(l.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?l.credentials="include":r.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(r){if(r.ep)return;r.ep=!0;const l=e(r);fetch(r.href,l)}})();var Ex=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function S0(a){return a&&a.__esModule&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a}var cp={exports:{}},bc={};var Qb;function _x(){if(Qb)return bc;Qb=1;var a=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function e(i,r,l){var c=null;if(l!==void 0&&(c=""+l),r.key!==void 0&&(c=""+r.key),"key"in r){l={};for(var u in r)u!=="key"&&(l[u]=r[u])}else l=r;return r=l.ref,{$$typeof:a,type:i,key:c,ref:r!==void 0?r:null,props:l}}return bc.Fragment=t,bc.jsx=e,bc.jsxs=e,bc}var Wb;function Cx(){return Wb||(Wb=1,cp.exports=_x()),cp.exports}var O=Cx(),up={exports:{}},re={};var Zb;function Tx(){if(Zb)return re;Zb=1;var a=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),e=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),y=Symbol.for("react.activity"),w=Symbol.iterator;function A(I){return I===null||typeof I!="object"?null:(I=w&&I[w]||I["@@iterator"],typeof I=="function"?I:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},S=Object.assign,C={};function M(I,J,mt){this.props=I,this.context=J,this.refs=C,this.updater=mt||_}M.prototype.isReactComponent={},M.prototype.setState=function(I,J){if(typeof I!="object"&&typeof I!="function"&&I!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,I,J,"setState")},M.prototype.forceUpdate=function(I){this.updater.enqueueForceUpdate(this,I,"forceUpdate")};function k(){}k.prototype=M.prototype;function L(I,J,mt){this.props=I,this.context=J,this.refs=C,this.updater=mt||_}var j=L.prototype=new k;j.constructor=L,S(j,M.prototype),j.isPureReactComponent=!0;var F=Array.isArray;function z(){}var H={H:null,A:null,T:null,S:null},ut=Object.prototype.hasOwnProperty;function ft(I,J,mt){var xt=mt.ref;return{$$typeof:a,type:I,key:J,ref:xt!==void 0?xt:null,props:mt}}function _t(I,J){return ft(I.type,J,I.props)}function ct(I){return typeof I=="object"&&I!==null&&I.$$typeof===a}function Tt(I){var J={"=":"=0",":":"=2"};return"$"+I.replace(/[=:]/g,function(mt){return J[mt]})}var Lt=/\/+/g;function Bt(I,J){return typeof I=="object"&&I!==null&&I.key!=null?Tt(""+I.key):J.toString(36)}function Vt(I){switch(I.status){case"fulfilled":return I.value;case"rejected":throw I.reason;default:switch(typeof I.status=="string"?I.then(z,z):(I.status="pending",I.then(function(J){I.status==="pending"&&(I.status="fulfilled",I.value=J)},function(J){I.status==="pending"&&(I.status="rejected",I.reason=J)})),I.status){case"fulfilled":return I.value;case"rejected":throw I.reason}}throw I}function G(I,J,mt,xt,It){var Ut=typeof I;(Ut==="undefined"||Ut==="boolean")&&(I=null);var Ot=!1;if(I===null)Ot=!0;else switch(Ut){case"bigint":case"string":case"number":Ot=!0;break;case"object":switch(I.$$typeof){case a:case t:Ot=!0;break;case p:return Ot=I._init,G(Ot(I._payload),J,mt,xt,It)}}if(Ot)return It=It(I),Ot=xt===""?"."+Bt(I,0):xt,F(It)?(mt="",Ot!=null&&(mt=Ot.replace(Lt,"$&/")+"/"),G(It,J,mt,"",function(kt){return kt})):It!=null&&(ct(It)&&(It=_t(It,mt+(It.key==null||I&&I.key===It.key?"":(""+It.key).replace(Lt,"$&/")+"/")+Ot)),J.push(It)),1;Ot=0;var Rt=xt===""?".":xt+":";if(F(I))for(var jt=0;jt<I.length;jt++)xt=I[jt],Ut=Rt+Bt(xt,jt),Ot+=G(xt,J,mt,Ut,It);else if(jt=A(I),typeof jt=="function")for(I=jt.call(I),jt=0;!(xt=I.next()).done;)xt=xt.value,Ut=Rt+Bt(xt,jt++),Ot+=G(xt,J,mt,Ut,It);else if(Ut==="object"){if(typeof I.then=="function")return G(Vt(I),J,mt,xt,It);throw J=String(I),Error("Objects are not valid as a React child (found: "+(J==="[object Object]"?"object with keys {"+Object.keys(I).join(", ")+"}":J)+"). If you meant to render a collection of children, use an array instead.")}return Ot}function st(I,J,mt){if(I==null)return I;var xt=[],It=0;return G(I,xt,"","",function(Ut){return J.call(mt,Ut,It++)}),xt}function wt(I){if(I._status===-1){var J=I._result;J=J(),J.then(function(mt){(I._status===0||I._status===-1)&&(I._status=1,I._result=mt)},function(mt){(I._status===0||I._status===-1)&&(I._status=2,I._result=mt)}),I._status===-1&&(I._status=0,I._result=J)}if(I._status===1)return I._result.default;throw I._result}var Yt=typeof reportError=="function"?reportError:function(I){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var J=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof I=="object"&&I!==null&&typeof I.message=="string"?String(I.message):String(I),error:I});if(!window.dispatchEvent(J))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",I);return}console.error(I)},Ct={map:st,forEach:function(I,J,mt){st(I,function(){J.apply(this,arguments)},mt)},count:function(I){var J=0;return st(I,function(){J++}),J},toArray:function(I){return st(I,function(J){return J})||[]},only:function(I){if(!ct(I))throw Error("React.Children.only expected to receive a single React element child.");return I}};return re.Activity=y,re.Children=Ct,re.Component=M,re.Fragment=e,re.Profiler=r,re.PureComponent=L,re.StrictMode=i,re.Suspense=d,re.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,re.__COMPILER_RUNTIME={__proto__:null,c:function(I){return H.H.useMemoCache(I)}},re.cache=function(I){return function(){return I.apply(null,arguments)}},re.cacheSignal=function(){return null},re.cloneElement=function(I,J,mt){if(I==null)throw Error("The argument must be a React element, but you passed "+I+".");var xt=S({},I.props),It=I.key;if(J!=null)for(Ut in J.key!==void 0&&(It=""+J.key),J)!ut.call(J,Ut)||Ut==="key"||Ut==="__self"||Ut==="__source"||Ut==="ref"&&J.ref===void 0||(xt[Ut]=J[Ut]);var Ut=arguments.length-2;if(Ut===1)xt.children=mt;else if(1<Ut){for(var Ot=Array(Ut),Rt=0;Rt<Ut;Rt++)Ot[Rt]=arguments[Rt+2];xt.children=Ot}return ft(I.type,It,xt)},re.createContext=function(I){return I={$$typeof:c,_currentValue:I,_currentValue2:I,_threadCount:0,Provider:null,Consumer:null},I.Provider=I,I.Consumer={$$typeof:l,_context:I},I},re.createElement=function(I,J,mt){var xt,It={},Ut=null;if(J!=null)for(xt in J.key!==void 0&&(Ut=""+J.key),J)ut.call(J,xt)&&xt!=="key"&&xt!=="__self"&&xt!=="__source"&&(It[xt]=J[xt]);var Ot=arguments.length-2;if(Ot===1)It.children=mt;else if(1<Ot){for(var Rt=Array(Ot),jt=0;jt<Ot;jt++)Rt[jt]=arguments[jt+2];It.children=Rt}if(I&&I.defaultProps)for(xt in Ot=I.defaultProps,Ot)It[xt]===void 0&&(It[xt]=Ot[xt]);return ft(I,Ut,It)},re.createRef=function(){return{current:null}},re.forwardRef=function(I){return{$$typeof:u,render:I}},re.isValidElement=ct,re.lazy=function(I){return{$$typeof:p,_payload:{_status:-1,_result:I},_init:wt}},re.memo=function(I,J){return{$$typeof:f,type:I,compare:J===void 0?null:J}},re.startTransition=function(I){var J=H.T,mt={};H.T=mt;try{var xt=I(),It=H.S;It!==null&&It(mt,xt),typeof xt=="object"&&xt!==null&&typeof xt.then=="function"&&xt.then(z,Yt)}catch(Ut){Yt(Ut)}finally{J!==null&&mt.types!==null&&(J.types=mt.types),H.T=J}},re.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},re.use=function(I){return H.H.use(I)},re.useActionState=function(I,J,mt){return H.H.useActionState(I,J,mt)},re.useCallback=function(I,J){return H.H.useCallback(I,J)},re.useContext=function(I){return H.H.useContext(I)},re.useDebugValue=function(){},re.useDeferredValue=function(I,J){return H.H.useDeferredValue(I,J)},re.useEffect=function(I,J){return H.H.useEffect(I,J)},re.useEffectEvent=function(I){return H.H.useEffectEvent(I)},re.useId=function(){return H.H.useId()},re.useImperativeHandle=function(I,J,mt){return H.H.useImperativeHandle(I,J,mt)},re.useInsertionEffect=function(I,J){return H.H.useInsertionEffect(I,J)},re.useLayoutEffect=function(I,J){return H.H.useLayoutEffect(I,J)},re.useMemo=function(I,J){return H.H.useMemo(I,J)},re.useOptimistic=function(I,J){return H.H.useOptimistic(I,J)},re.useReducer=function(I,J,mt){return H.H.useReducer(I,J,mt)},re.useRef=function(I){return H.H.useRef(I)},re.useState=function(I){return H.H.useState(I)},re.useSyncExternalStore=function(I,J,mt){return H.H.useSyncExternalStore(I,J,mt)},re.useTransition=function(){return H.H.useTransition()},re.version="19.2.4",re}var Jb;function lm(){return Jb||(Jb=1,up.exports=Tx()),up.exports}var U=lm();const dh=S0(U);var hp={exports:{}},vc={},dp={exports:{}},fp={};var tv;function Rx(){return tv||(tv=1,(function(a){function t(G,st){var wt=G.length;G.push(st);t:for(;0<wt;){var Yt=wt-1>>>1,Ct=G[Yt];if(0<r(Ct,st))G[Yt]=st,G[wt]=Ct,wt=Yt;else break t}}function e(G){return G.length===0?null:G[0]}function i(G){if(G.length===0)return null;var st=G[0],wt=G.pop();if(wt!==st){G[0]=wt;t:for(var Yt=0,Ct=G.length,I=Ct>>>1;Yt<I;){var J=2*(Yt+1)-1,mt=G[J],xt=J+1,It=G[xt];if(0>r(mt,wt))xt<Ct&&0>r(It,mt)?(G[Yt]=It,G[xt]=wt,Yt=xt):(G[Yt]=mt,G[J]=wt,Yt=J);else if(xt<Ct&&0>r(It,wt))G[Yt]=It,G[xt]=wt,Yt=xt;else break t}}return st}function r(G,st){var wt=G.sortIndex-st.sortIndex;return wt!==0?wt:G.id-st.id}if(a.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;a.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();a.unstable_now=function(){return c.now()-u}}var d=[],f=[],p=1,y=null,w=3,A=!1,_=!1,S=!1,C=!1,M=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,L=typeof setImmediate<"u"?setImmediate:null;function j(G){for(var st=e(f);st!==null;){if(st.callback===null)i(f);else if(st.startTime<=G)i(f),st.sortIndex=st.expirationTime,t(d,st);else break;st=e(f)}}function F(G){if(S=!1,j(G),!_)if(e(d)!==null)_=!0,z||(z=!0,Tt());else{var st=e(f);st!==null&&Vt(F,st.startTime-G)}}var z=!1,H=-1,ut=5,ft=-1;function _t(){return C?!0:!(a.unstable_now()-ft<ut)}function ct(){if(C=!1,z){var G=a.unstable_now();ft=G;var st=!0;try{t:{_=!1,S&&(S=!1,k(H),H=-1),A=!0;var wt=w;try{e:{for(j(G),y=e(d);y!==null&&!(y.expirationTime>G&&_t());){var Yt=y.callback;if(typeof Yt=="function"){y.callback=null,w=y.priorityLevel;var Ct=Yt(y.expirationTime<=G);if(G=a.unstable_now(),typeof Ct=="function"){y.callback=Ct,j(G),st=!0;break e}y===e(d)&&i(d),j(G)}else i(d);y=e(d)}if(y!==null)st=!0;else{var I=e(f);I!==null&&Vt(F,I.startTime-G),st=!1}}break t}finally{y=null,w=wt,A=!1}st=void 0}}finally{st?Tt():z=!1}}}var Tt;if(typeof L=="function")Tt=function(){L(ct)};else if(typeof MessageChannel<"u"){var Lt=new MessageChannel,Bt=Lt.port2;Lt.port1.onmessage=ct,Tt=function(){Bt.postMessage(null)}}else Tt=function(){M(ct,0)};function Vt(G,st){H=M(function(){G(a.unstable_now())},st)}a.unstable_IdlePriority=5,a.unstable_ImmediatePriority=1,a.unstable_LowPriority=4,a.unstable_NormalPriority=3,a.unstable_Profiling=null,a.unstable_UserBlockingPriority=2,a.unstable_cancelCallback=function(G){G.callback=null},a.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):ut=0<G?Math.floor(1e3/G):5},a.unstable_getCurrentPriorityLevel=function(){return w},a.unstable_next=function(G){switch(w){case 1:case 2:case 3:var st=3;break;default:st=w}var wt=w;w=st;try{return G()}finally{w=wt}},a.unstable_requestPaint=function(){C=!0},a.unstable_runWithPriority=function(G,st){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var wt=w;w=G;try{return st()}finally{w=wt}},a.unstable_scheduleCallback=function(G,st,wt){var Yt=a.unstable_now();switch(typeof wt=="object"&&wt!==null?(wt=wt.delay,wt=typeof wt=="number"&&0<wt?Yt+wt:Yt):wt=Yt,G){case 1:var Ct=-1;break;case 2:Ct=250;break;case 5:Ct=1073741823;break;case 4:Ct=1e4;break;default:Ct=5e3}return Ct=wt+Ct,G={id:p++,callback:st,priorityLevel:G,startTime:wt,expirationTime:Ct,sortIndex:-1},wt>Yt?(G.sortIndex=wt,t(f,G),e(d)===null&&G===e(f)&&(S?(k(H),H=-1):S=!0,Vt(F,wt-Yt))):(G.sortIndex=Ct,t(d,G),_||A||(_=!0,z||(z=!0,Tt()))),G},a.unstable_shouldYield=_t,a.unstable_wrapCallback=function(G){var st=w;return function(){var wt=w;w=st;try{return G.apply(this,arguments)}finally{w=wt}}}})(fp)),fp}var ev;function Mx(){return ev||(ev=1,dp.exports=Rx()),dp.exports}var pp={exports:{}},Kn={};var nv;function Dx(){if(nv)return Kn;nv=1;var a=lm();function t(d){var f="https://react.dev/errors/"+d;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function e(){}var i={d:{f:e,r:function(){throw Error(t(522))},D:e,C:e,L:e,m:e,X:e,S:e,M:e},p:0,findDOMNode:null},r=Symbol.for("react.portal");function l(d,f,p){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:y==null?null:""+y,children:d,containerInfo:f,implementation:p}}var c=a.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(d,f){if(d==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return Kn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,Kn.createPortal=function(d,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(t(299));return l(d,f,null,p)},Kn.flushSync=function(d){var f=c.T,p=i.p;try{if(c.T=null,i.p=2,d)return d()}finally{c.T=f,i.p=p,i.d.f()}},Kn.preconnect=function(d,f){typeof d=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,i.d.C(d,f))},Kn.prefetchDNS=function(d){typeof d=="string"&&i.d.D(d)},Kn.preinit=function(d,f){if(typeof d=="string"&&f&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin),w=typeof f.integrity=="string"?f.integrity:void 0,A=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?i.d.S(d,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:y,integrity:w,fetchPriority:A}):p==="script"&&i.d.X(d,{crossOrigin:y,integrity:w,fetchPriority:A,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},Kn.preinitModule=function(d,f){if(typeof d=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);i.d.M(d,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&i.d.M(d)},Kn.preload=function(d,f){if(typeof d=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,y=u(p,f.crossOrigin);i.d.L(d,p,{crossOrigin:y,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},Kn.preloadModule=function(d,f){if(typeof d=="string")if(f){var p=u(f.as,f.crossOrigin);i.d.m(d,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else i.d.m(d)},Kn.requestFormReset=function(d){i.d.r(d)},Kn.unstable_batchedUpdates=function(d,f){return d(f)},Kn.useFormState=function(d,f,p){return c.H.useFormState(d,f,p)},Kn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Kn.version="19.2.4",Kn}var iv;function E0(){if(iv)return pp.exports;iv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(t){console.error(t)}}return a(),pp.exports=Dx(),pp.exports}var sv;function Ox(){if(sv)return vc;sv=1;var a=Mx(),t=lm(),e=E0();function i(n){var s="https://react.dev/errors/"+n;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)s+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+n+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var s=n,o=n;if(n.alternate)for(;s.return;)s=s.return;else{n=s;do s=n,(s.flags&4098)!==0&&(o=s.return),n=s.return;while(n)}return s.tag===3?o:null}function c(n){if(n.tag===13){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function u(n){if(n.tag===31){var s=n.memoizedState;if(s===null&&(n=n.alternate,n!==null&&(s=n.memoizedState)),s!==null)return s.dehydrated}return null}function d(n){if(l(n)!==n)throw Error(i(188))}function f(n){var s=n.alternate;if(!s){if(s=l(n),s===null)throw Error(i(188));return s!==n?null:n}for(var o=n,h=s;;){var g=o.return;if(g===null)break;var b=g.alternate;if(b===null){if(h=g.return,h!==null){o=h;continue}break}if(g.child===b.child){for(b=g.child;b;){if(b===o)return d(g),n;if(b===h)return d(g),s;b=b.sibling}throw Error(i(188))}if(o.return!==h.return)o=g,h=b;else{for(var T=!1,N=g.child;N;){if(N===o){T=!0,o=g,h=b;break}if(N===h){T=!0,h=g,o=b;break}N=N.sibling}if(!T){for(N=b.child;N;){if(N===o){T=!0,o=b,h=g;break}if(N===h){T=!0,h=b,o=g;break}N=N.sibling}if(!T)throw Error(i(189))}}if(o.alternate!==h)throw Error(i(190))}if(o.tag!==3)throw Error(i(188));return o.stateNode.current===o?n:s}function p(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n;for(n=n.child;n!==null;){if(s=p(n),s!==null)return s;n=n.sibling}return null}var y=Object.assign,w=Symbol.for("react.element"),A=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),C=Symbol.for("react.strict_mode"),M=Symbol.for("react.profiler"),k=Symbol.for("react.consumer"),L=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),F=Symbol.for("react.suspense"),z=Symbol.for("react.suspense_list"),H=Symbol.for("react.memo"),ut=Symbol.for("react.lazy"),ft=Symbol.for("react.activity"),_t=Symbol.for("react.memo_cache_sentinel"),ct=Symbol.iterator;function Tt(n){return n===null||typeof n!="object"?null:(n=ct&&n[ct]||n["@@iterator"],typeof n=="function"?n:null)}var Lt=Symbol.for("react.client.reference");function Bt(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===Lt?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case S:return"Fragment";case M:return"Profiler";case C:return"StrictMode";case F:return"Suspense";case z:return"SuspenseList";case ft:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case _:return"Portal";case L:return n.displayName||"Context";case k:return(n._context.displayName||"Context")+".Consumer";case j:var s=n.render;return n=n.displayName,n||(n=s.displayName||s.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case H:return s=n.displayName||null,s!==null?s:Bt(n.type)||"Memo";case ut:s=n._payload,n=n._init;try{return Bt(n(s))}catch{}}return null}var Vt=Array.isArray,G=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,st=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,wt={pending:!1,data:null,method:null,action:null},Yt=[],Ct=-1;function I(n){return{current:n}}function J(n){0>Ct||(n.current=Yt[Ct],Yt[Ct]=null,Ct--)}function mt(n,s){Ct++,Yt[Ct]=n.current,n.current=s}var xt=I(null),It=I(null),Ut=I(null),Ot=I(null);function Rt(n,s){switch(mt(Ut,s),mt(It,n),mt(xt,null),s.nodeType){case 9:case 11:n=(n=s.documentElement)&&(n=n.namespaceURI)?yb(n):0;break;default:if(n=s.tagName,s=s.namespaceURI)s=yb(s),n=bb(s,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}J(xt),mt(xt,n)}function jt(){J(xt),J(It),J(Ut)}function kt(n){n.memoizedState!==null&&mt(Ot,n);var s=xt.current,o=bb(s,n.type);s!==o&&(mt(It,n),mt(xt,o))}function we(n){It.current===n&&(J(xt),J(It)),Ot.current===n&&(J(Ot),pc._currentValue=wt)}var pt,fe;function ve(n){if(pt===void 0)try{throw Error()}catch(o){var s=o.stack.trim().match(/\n( *(at )?)/);pt=s&&s[1]||"",fe=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+pt+n+fe}var An=!1;function gl(n,s){if(!n||An)return"";An=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(s){var vt=function(){throw Error()};if(Object.defineProperty(vt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(vt,[])}catch(dt){var lt=dt}Reflect.construct(n,[],vt)}else{try{vt.call()}catch(dt){lt=dt}n.call(vt.prototype)}}else{try{throw Error()}catch(dt){lt=dt}(vt=n())&&typeof vt.catch=="function"&&vt.catch(function(){})}}catch(dt){if(dt&&lt&&typeof dt.stack=="string")return[dt.stack,lt.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var b=h.DetermineComponentFrameRoot(),T=b[0],N=b[1];if(T&&N){var q=T.split(`
`),at=N.split(`
`);for(g=h=0;h<q.length&&!q[h].includes("DetermineComponentFrameRoot");)h++;for(;g<at.length&&!at[g].includes("DetermineComponentFrameRoot");)g++;if(h===q.length||g===at.length)for(h=q.length-1,g=at.length-1;1<=h&&0<=g&&q[h]!==at[g];)g--;for(;1<=h&&0<=g;h--,g--)if(q[h]!==at[g]){if(h!==1||g!==1)do if(h--,g--,0>g||q[h]!==at[g]){var yt=`
`+q[h].replace(" at new "," at ");return n.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",n.displayName)),yt}while(1<=h&&0<=g);break}}}finally{An=!1,Error.prepareStackTrace=o}return(o=n?n.displayName||n.name:"")?ve(o):""}function fd(n,s){switch(n.tag){case 26:case 27:case 5:return ve(n.type);case 16:return ve("Lazy");case 13:return n.child!==s&&s!==null?ve("Suspense Fallback"):ve("Suspense");case 19:return ve("SuspenseList");case 0:case 15:return gl(n.type,!1);case 11:return gl(n.type.render,!1);case 1:return gl(n.type,!0);case 31:return ve("Activity");default:return""}}function Wc(n){try{var s="",o=null;do s+=fd(n,o),o=n,n=n.return;while(n);return s}catch(h){return`
Error generating stack: `+h.message+`
`+h.stack}}var yl=Object.prototype.hasOwnProperty,ia=a.unstable_scheduleCallback,ni=a.unstable_cancelCallback,Zc=a.unstable_shouldYield,sa=a.unstable_requestPaint,zn=a.unstable_now,ra=a.unstable_getCurrentPriorityLevel,Hn=a.unstable_ImmediatePriority,ns=a.unstable_UserBlockingPriority,hr=a.unstable_NormalPriority,aa=a.unstable_LowPriority,to=a.unstable_IdlePriority,eo=a.log,Rs=a.unstable_setDisableYieldValue,is=null,Dn=null;function On(n){if(typeof eo=="function"&&Rs(n),Dn&&typeof Dn.setStrictMode=="function")try{Dn.setStrictMode(is,n)}catch{}}var Ft=Math.clz32?Math.clz32:no,oa=Math.log,Ms=Math.LN2;function no(n){return n>>>=0,n===0?32:31-(oa(n)/Ms|0)|0}var Nt=256,dr=262144,la=4194304;function Vi(n){var s=n&42;if(s!==0)return s;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return n&261888;case 262144:case 524288:case 1048576:case 2097152:return n&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function ca(n,s,o){var h=n.pendingLanes;if(h===0)return 0;var g=0,b=n.suspendedLanes,T=n.pingedLanes;n=n.warmLanes;var N=h&134217727;return N!==0?(h=N&~b,h!==0?g=Vi(h):(T&=N,T!==0?g=Vi(T):o||(o=N&~n,o!==0&&(g=Vi(o))))):(N=h&~b,N!==0?g=Vi(N):T!==0?g=Vi(T):o||(o=h&~n,o!==0&&(g=Vi(o)))),g===0?0:s!==0&&s!==g&&(s&b)===0&&(b=g&-g,o=s&-s,b>=o||b===32&&(o&4194048)!==0)?s:g}function Ds(n,s){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&s)===0}function pd(n,s){switch(n){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Jc(){var n=la;return la<<=1,(la&62914560)===0&&(la=4194304),n}function ss(n){for(var s=[],o=0;31>o;o++)s.push(n);return s}function Mi(n,s){n.pendingLanes|=s,s!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function bl(n,s,o,h,g,b){var T=n.pendingLanes;n.pendingLanes=o,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=o,n.entangledLanes&=o,n.errorRecoveryDisabledLanes&=o,n.shellSuspendCounter=0;var N=n.entanglements,q=n.expirationTimes,at=n.hiddenUpdates;for(o=T&~o;0<o;){var yt=31-Ft(o),vt=1<<yt;N[yt]=0,q[yt]=-1;var lt=at[yt];if(lt!==null)for(at[yt]=null,yt=0;yt<lt.length;yt++){var dt=lt[yt];dt!==null&&(dt.lane&=-536870913)}o&=~vt}h!==0&&ua(n,h,0),b!==0&&g===0&&n.tag!==0&&(n.suspendedLanes|=b&~(T&~s))}function ua(n,s,o){n.pendingLanes|=s,n.suspendedLanes&=~s;var h=31-Ft(s);n.entangledLanes|=s,n.entanglements[h]=n.entanglements[h]|1073741824|o&261930}function Ie(n,s){var o=n.entangledLanes|=s;for(n=n.entanglements;o;){var h=31-Ft(o),g=1<<h;g&s|n[h]&s&&(n[h]|=s),o&=~g}}function nn(n,s){var o=s&-s;return o=(o&42)!==0?1:vl(o),(o&(n.suspendedLanes|s))!==0?0:o}function vl(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function fr(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function ha(){var n=st.p;return n!==0?n:(n=window.event,n===void 0?32:zb(n.type))}function da(n,s){var o=st.p;try{return st.p=n,s()}finally{st.p=o}}var rs=Math.random().toString(36).slice(2),ze="__reactFiber$"+rs,sn="__reactProps$"+rs,Yn="__reactContainer$"+rs,pr="__reactEvents$"+rs,md="__reactListeners$"+rs,as="__reactHandles$"+rs,wl="__reactResources$"+rs,mi="__reactMarker$"+rs;function io(n){delete n[ze],delete n[sn],delete n[pr],delete n[md],delete n[as]}function os(n){var s=n[ze];if(s)return s;for(var o=n.parentNode;o;){if(s=o[Yn]||o[ze]){if(o=s.alternate,s.child!==null||o!==null&&o.child!==null)for(n=_b(n);n!==null;){if(o=n[ze])return o;n=_b(n)}return s}n=o,o=n.parentNode}return null}function ke(n){if(n=n[ze]||n[Yn]){var s=n.tag;if(s===5||s===6||s===13||s===31||s===26||s===27||s===3)return n}return null}function gi(n){var s=n.tag;if(s===5||s===26||s===27||s===6)return n.stateNode;throw Error(i(33))}function qn(n){var s=n[wl];return s||(s=n[wl]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function rn(n){n[mi]=!0}var Os=new Set,fa={};function Ki(n,s){ls(n,s),ls(n+"Capture",s)}function ls(n,s){for(fa[n]=s,n=0;n<s.length;n++)Os.add(s[n])}var Ns=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),xl={},pa={};function tu(n){return yl.call(pa,n)?!0:yl.call(xl,n)?!1:Ns.test(n)?pa[n]=!0:(xl[n]=!0,!1)}function ce(n,s,o){if(tu(s))if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":n.removeAttribute(s);return;case"boolean":var h=s.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){n.removeAttribute(s);return}}n.setAttribute(s,""+o)}}function ma(n,s,o){if(o===null)n.removeAttribute(s);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(s);return}n.setAttribute(s,""+o)}}function Di(n,s,o,h){if(h===null)n.removeAttribute(o);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(o);return}n.setAttributeNS(s,o,""+h)}}function Nn(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function mr(n){var s=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function eu(n,s,o){var h=Object.getOwnPropertyDescriptor(n.constructor.prototype,s);if(!n.hasOwnProperty(s)&&typeof h<"u"&&typeof h.get=="function"&&typeof h.set=="function"){var g=h.get,b=h.set;return Object.defineProperty(n,s,{configurable:!0,get:function(){return g.call(this)},set:function(T){o=""+T,b.call(this,T)}}),Object.defineProperty(n,s,{enumerable:h.enumerable}),{getValue:function(){return o},setValue:function(T){o=""+T},stopTracking:function(){n._valueTracker=null,delete n[s]}}}}function so(n){if(!n._valueTracker){var s=mr(n)?"checked":"value";n._valueTracker=eu(n,s,""+n[s])}}function Al(n){if(!n)return!1;var s=n._valueTracker;if(!s)return!0;var o=s.getValue(),h="";return n&&(h=mr(n)?n.checked?"true":"false":n.value),n=h,n!==o?(s.setValue(n),!0):!1}function Se(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var ga=/[\n"\\]/g;function Sn(n){return n.replace(ga,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function cs(n,s,o,h,g,b,T,N){n.name="",T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"?n.type=T:n.removeAttribute("type"),s!=null?T==="number"?(s===0&&n.value===""||n.value!=s)&&(n.value=""+Nn(s)):n.value!==""+Nn(s)&&(n.value=""+Nn(s)):T!=="submit"&&T!=="reset"||n.removeAttribute("value"),s!=null?ya(n,T,Nn(s)):o!=null?ya(n,T,Nn(o)):h!=null&&n.removeAttribute("value"),g==null&&b!=null&&(n.defaultChecked=!!b),g!=null&&(n.checked=g&&typeof g!="function"&&typeof g!="symbol"),N!=null&&typeof N!="function"&&typeof N!="symbol"&&typeof N!="boolean"?n.name=""+Nn(N):n.removeAttribute("name")}function ro(n,s,o,h,g,b,T,N){if(b!=null&&typeof b!="function"&&typeof b!="symbol"&&typeof b!="boolean"&&(n.type=b),s!=null||o!=null){if(!(b!=="submit"&&b!=="reset"||s!=null)){so(n);return}o=o!=null?""+Nn(o):"",s=s!=null?""+Nn(s):o,N||s===n.value||(n.value=s),n.defaultValue=s}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,n.checked=N?n.checked:!!h,n.defaultChecked=!!h,T!=null&&typeof T!="function"&&typeof T!="symbol"&&typeof T!="boolean"&&(n.name=T),so(n)}function ya(n,s,o){s==="number"&&Se(n.ownerDocument)===n||n.defaultValue===""+o||(n.defaultValue=""+o)}function Xi(n,s,o,h){if(n=n.options,s){s={};for(var g=0;g<o.length;g++)s["$"+o[g]]=!0;for(o=0;o<n.length;o++)g=s.hasOwnProperty("$"+n[o].value),n[o].selected!==g&&(n[o].selected=g),g&&h&&(n[o].defaultSelected=!0)}else{for(o=""+Nn(o),s=null,g=0;g<n.length;g++){if(n[g].value===o){n[g].selected=!0,h&&(n[g].defaultSelected=!0);return}s!==null||n[g].disabled||(s=n[g])}s!==null&&(s.selected=!0)}}function Sl(n,s,o){if(s!=null&&(s=""+Nn(s),s!==n.value&&(n.value=s),o==null)){n.defaultValue!==s&&(n.defaultValue=s);return}n.defaultValue=o!=null?""+Nn(o):""}function ba(n,s,o,h){if(s==null){if(h!=null){if(o!=null)throw Error(i(92));if(Vt(h)){if(1<h.length)throw Error(i(93));h=h[0]}o=h}o==null&&(o=""),s=o}o=Nn(s),n.defaultValue=o,h=n.textContent,h===o&&h!==""&&h!==null&&(n.value=h),so(n)}function ks(n,s){if(s){var o=n.firstChild;if(o&&o===n.lastChild&&o.nodeType===3){o.nodeValue=s;return}}n.textContent=s}var gd=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ge(n,s,o){var h=s.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?h?n.setProperty(s,""):s==="float"?n.cssFloat="":n[s]="":h?n.setProperty(s,o):typeof o!="number"||o===0||gd.has(s)?s==="float"?n.cssFloat=o:n[s]=(""+o).trim():n[s]=o+"px"}function El(n,s,o){if(s!=null&&typeof s!="object")throw Error(i(62));if(n=n.style,o!=null){for(var h in o)!o.hasOwnProperty(h)||s!=null&&s.hasOwnProperty(h)||(h.indexOf("--")===0?n.setProperty(h,""):h==="float"?n.cssFloat="":n[h]="");for(var g in s)h=s[g],s.hasOwnProperty(g)&&o[g]!==h&&ge(n,g,h)}else for(var b in s)s.hasOwnProperty(b)&&ge(n,b,s[b])}function _l(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var yd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Qn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Yi(n){return Qn.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}function ii(){}var Oi=null;function ao(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Ls=null,He=null;function yi(n){var s=ke(n);if(s&&(n=s.stateNode)){var o=n[sn]||null;t:switch(n=s.stateNode,s.type){case"input":if(cs(n,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),s=o.name,o.type==="radio"&&s!=null){for(o=n;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Sn(""+s)+'"][type="radio"]'),s=0;s<o.length;s++){var h=o[s];if(h!==n&&h.form===n.form){var g=h[sn]||null;if(!g)throw Error(i(90));cs(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(s=0;s<o.length;s++)h=o[s],h.form===n.form&&Al(h)}break t;case"textarea":Sl(n,o.value,o.defaultValue);break t;case"select":s=o.value,s!=null&&Xi(n,!!o.multiple,s,!1)}}}var Ps=!1;function gr(n,s,o){if(Ps)return n(s,o);Ps=!0;try{var h=n(s);return h}finally{if(Ps=!1,(Ls!==null||He!==null)&&(Gu(),Ls&&(s=Ls,n=He,He=Ls=null,yi(s),n)))for(s=0;s<n.length;s++)yi(n[s])}}function Bs(n,s){var o=n.stateNode;if(o===null)return null;var h=o[sn]||null;if(h===null)return null;o=h[s];t:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(n=n.type,h=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!h;break t;default:n=!1}if(n)return null;if(o&&typeof o!="function")throw Error(i(231,s,typeof o));return o}var En=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Cl=!1;if(En)try{var Gn={};Object.defineProperty(Gn,"passive",{get:function(){Cl=!0}}),window.addEventListener("test",Gn,Gn),window.removeEventListener("test",Gn,Gn)}catch{Cl=!1}var Ni=null,oo=null,yr=null;function br(){if(yr)return yr;var n,s=oo,o=s.length,h,g="value"in Ni?Ni.value:Ni.textContent,b=g.length;for(n=0;n<o&&s[n]===g[n];n++);var T=o-n;for(h=1;h<=T&&s[o-h]===g[b-h];h++);return yr=g.slice(n,1<h?1-h:void 0)}function vr(n){var s=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&s===13&&(n=13)):n=s,n===10&&(n=13),32<=n||n===13?n:0}function va(){return!0}function nu(){return!1}function hn(n){function s(o,h,g,b,T){this._reactName=o,this._targetInst=g,this.type=h,this.nativeEvent=b,this.target=T,this.currentTarget=null;for(var N in n)n.hasOwnProperty(N)&&(o=n[N],this[N]=o?o(b):b[N]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?va:nu,this.isPropagationStopped=nu,this}return y(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=va)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=va)},persist:function(){},isPersistent:va}),s}var js={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},lo=hn(js),us=y({},js,{view:0,detail:0}),co=hn(us),wa,Tl,xa,uo=y({},us,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Fs,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==xa&&(xa&&n.type==="mousemove"?(wa=n.screenX-xa.screenX,Tl=n.screenY-xa.screenY):Tl=wa=0,xa=n),wa)},movementY:function(n){return"movementY"in n?n.movementY:Tl}}),ho=hn(uo),Rl=y({},uo,{dataTransfer:0}),iu=hn(Rl),fo=y({},us,{relatedTarget:0}),wr=hn(fo),po=y({},js,{animationName:0,elapsedTime:0,pseudoElement:0}),su=hn(po),bd=y({},js,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),xr=hn(bd),Ml=y({},js,{data:0}),mo=hn(Ml),Dl={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ol={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_n={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Aa(n){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(n):(n=_n[n])?!!s[n]:!1}function Fs(){return Aa}var ru=y({},us,{key:function(n){if(n.key){var s=Dl[n.key]||n.key;if(s!=="Unidentified")return s}return n.type==="keypress"?(n=vr(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?Ol[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Fs,charCode:function(n){return n.type==="keypress"?vr(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?vr(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),go=hn(ru),au=y({},uo,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Nl=hn(au),yo=y({},us,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Fs}),kl=hn(yo),Is=y({},js,{propertyName:0,elapsedTime:0,pseudoElement:0}),Ll=hn(Is),Pl=y({},uo,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),bo=hn(Pl),Bl=y({},js,{newState:0,oldState:0}),ou=hn(Bl),vd=[9,13,27,32],Sa=En&&"CompositionEvent"in window,hs=null;En&&"documentMode"in document&&(hs=document.documentMode);var wd=En&&"TextEvent"in window&&!hs,vo=En&&(!Sa||hs&&8<hs&&11>=hs),wo=" ",lu=!1;function jl(n,s){switch(n){case"keyup":return vd.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function cu(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Us=!1;function uu(n,s){switch(n){case"compositionend":return cu(s);case"keypress":return s.which!==32?null:(lu=!0,wo);case"textInput":return n=s.data,n===wo&&lu?null:n;default:return null}}function xd(n,s){if(Us)return n==="compositionend"||!Sa&&jl(n,s)?(n=br(),yr=oo=Ni=null,Us=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return vo&&s.locale!=="ko"?null:s.data;default:return null}}var hu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xo(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s==="input"?!!hu[n.type]:s==="textarea"}function Fl(n,s,o,h){Ls?He?He.push(h):He=[h]:Ls=h,s=Wu(s,"onChange"),0<s.length&&(o=new lo("onChange","change",null,o,h),n.push({event:o,listeners:s}))}var Ar=null,Ea=null;function Ad(n){hb(n,0)}function Ao(n){var s=gi(n);if(Al(s))return n}function _a(n,s){if(n==="change")return s}var ki=!1;if(En){var qe;if(En){var Sr="oninput"in document;if(!Sr){var zs=document.createElement("div");zs.setAttribute("oninput","return;"),Sr=typeof zs.oninput=="function"}qe=Sr}else qe=!1;ki=qe&&(!document.documentMode||9<document.documentMode)}function du(){Ar&&(Ar.detachEvent("onpropertychange",So),Ea=Ar=null)}function So(n){if(n.propertyName==="value"&&Ao(Ea)){var s=[];Fl(s,Ea,n,ao(n)),gr(Ad,s)}}function fu(n,s,o){n==="focusin"?(du(),Ar=s,Ea=o,Ar.attachEvent("onpropertychange",So)):n==="focusout"&&du()}function Hs(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Ao(Ea)}function Il(n,s){if(n==="click")return Ao(s)}function Er(n,s){if(n==="input"||n==="change")return Ao(s)}function ds(n,s){return n===s&&(n!==0||1/n===1/s)||n!==n&&s!==s}var $n=typeof Object.is=="function"?Object.is:ds;function m(n,s){if($n(n,s))return!0;if(typeof n!="object"||n===null||typeof s!="object"||s===null)return!1;var o=Object.keys(n),h=Object.keys(s);if(o.length!==h.length)return!1;for(h=0;h<o.length;h++){var g=o[h];if(!yl.call(s,g)||!$n(n[g],s[g]))return!1}return!0}function v(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function x(n,s){var o=v(n);n=0;for(var h;o;){if(o.nodeType===3){if(h=n+o.textContent.length,n<=s&&h>=s)return{node:o,offset:s-n};n=h}t:{for(;o;){if(o.nextSibling){o=o.nextSibling;break t}o=o.parentNode}o=void 0}o=v(o)}}function E(n,s){return n&&s?n===s?!0:n&&n.nodeType===3?!1:s&&s.nodeType===3?E(n,s.parentNode):"contains"in n?n.contains(s):n.compareDocumentPosition?!!(n.compareDocumentPosition(s)&16):!1:!1}function R(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var s=Se(n.document);s instanceof n.HTMLIFrameElement;){try{var o=typeof s.contentWindow.location.href=="string"}catch{o=!1}if(o)n=s.contentWindow;else break;s=Se(n.document)}return s}function D(n){var s=n&&n.nodeName&&n.nodeName.toLowerCase();return s&&(s==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||s==="textarea"||n.contentEditable==="true")}var P=En&&"documentMode"in document&&11>=document.documentMode,B=null,V=null,et=null,K=!1;function $(n,s,o){var h=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;K||B==null||B!==Se(h)||(h=B,"selectionStart"in h&&D(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),et&&m(et,h)||(et=h,h=Wu(V,"onSelect"),0<h.length&&(s=new lo("onSelect","select",null,s,o),n.push({event:s,listeners:h}),s.target=B)))}function Q(n,s){var o={};return o[n.toLowerCase()]=s.toLowerCase(),o["Webkit"+n]="webkit"+s,o["Moz"+n]="moz"+s,o}var Z={animationend:Q("Animation","AnimationEnd"),animationiteration:Q("Animation","AnimationIteration"),animationstart:Q("Animation","AnimationStart"),transitionrun:Q("Transition","TransitionRun"),transitionstart:Q("Transition","TransitionStart"),transitioncancel:Q("Transition","TransitionCancel"),transitionend:Q("Transition","TransitionEnd")},X={},Y={};En&&(Y=document.createElement("div").style,"AnimationEvent"in window||(delete Z.animationend.animation,delete Z.animationiteration.animation,delete Z.animationstart.animation),"TransitionEvent"in window||delete Z.transitionend.transition);function it(n){if(X[n])return X[n];if(!Z[n])return n;var s=Z[n],o;for(o in s)if(s.hasOwnProperty(o)&&o in Y)return X[n]=s[o];return n}var ot=it("animationend"),nt=it("animationiteration"),gt=it("animationstart"),At=it("transitionrun"),Mt=it("transitionstart"),Dt=it("transitioncancel"),St=it("transitionend"),zt=new Map,Pt="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Pt.push("scrollEnd");function Et(n,s){zt.set(n,s),Ki(s,[n])}var Ht=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)},ee=[],ue=0,Qt=0;function se(){for(var n=ue,s=Qt=ue=0;s<n;){var o=ee[s];ee[s++]=null;var h=ee[s];ee[s++]=null;var g=ee[s];ee[s++]=null;var b=ee[s];if(ee[s++]=null,h!==null&&g!==null){var T=h.pending;T===null?g.next=g:(g.next=T.next,T.next=g),h.pending=g}b!==0&&fs(o,g,b)}}function Le(n,s,o,h){ee[ue++]=n,ee[ue++]=s,ee[ue++]=o,ee[ue++]=h,Qt|=h,n.lanes|=h,n=n.alternate,n!==null&&(n.lanes|=h)}function Vn(n,s,o,h){return Le(n,s,o,h),_r(n)}function De(n,s){return Le(n,null,null,s),_r(n)}function fs(n,s,o){n.lanes|=o;var h=n.alternate;h!==null&&(h.lanes|=o);for(var g=!1,b=n.return;b!==null;)b.childLanes|=o,h=b.alternate,h!==null&&(h.childLanes|=o),b.tag===22&&(n=b.stateNode,n===null||n._visibility&1||(g=!0)),n=b,b=b.return;return n.tag===3?(b=n.stateNode,g&&s!==null&&(g=31-Ft(o),n=b.hiddenUpdates,h=n[g],h===null?n[g]=[s]:h.push(s),s.lane=o|536870912),b):null}function _r(n){if(50<oc)throw oc=0,Nf=null,Error(i(185));for(var s=n.return;s!==null;)n=s,s=n.return;return n.tag===3?n.stateNode:null}var Eo={};function o1(n,s,o,h){this.tag=n,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bi(n,s,o,h){return new o1(n,s,o,h)}function Sd(n){return n=n.prototype,!(!n||!n.isReactComponent)}function qs(n,s){var o=n.alternate;return o===null?(o=bi(n.tag,s,n.key,n.mode),o.elementType=n.elementType,o.type=n.type,o.stateNode=n.stateNode,o.alternate=n,n.alternate=o):(o.pendingProps=s,o.type=n.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=n.flags&65011712,o.childLanes=n.childLanes,o.lanes=n.lanes,o.child=n.child,o.memoizedProps=n.memoizedProps,o.memoizedState=n.memoizedState,o.updateQueue=n.updateQueue,s=n.dependencies,o.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},o.sibling=n.sibling,o.index=n.index,o.ref=n.ref,o.refCleanup=n.refCleanup,o}function Km(n,s){n.flags&=65011714;var o=n.alternate;return o===null?(n.childLanes=0,n.lanes=s,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=o.childLanes,n.lanes=o.lanes,n.child=o.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=o.memoizedProps,n.memoizedState=o.memoizedState,n.updateQueue=o.updateQueue,n.type=o.type,s=o.dependencies,n.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),n}function pu(n,s,o,h,g,b){var T=0;if(h=n,typeof n=="function")Sd(n)&&(T=1);else if(typeof n=="string")T=dx(n,o,xt.current)?26:n==="html"||n==="head"||n==="body"?27:5;else t:switch(n){case ft:return n=bi(31,o,s,g),n.elementType=ft,n.lanes=b,n;case S:return Ca(o.children,g,b,s);case C:T=8,g|=24;break;case M:return n=bi(12,o,s,g|2),n.elementType=M,n.lanes=b,n;case F:return n=bi(13,o,s,g),n.elementType=F,n.lanes=b,n;case z:return n=bi(19,o,s,g),n.elementType=z,n.lanes=b,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case L:T=10;break t;case k:T=9;break t;case j:T=11;break t;case H:T=14;break t;case ut:T=16,h=null;break t}T=29,o=Error(i(130,n===null?"null":typeof n,"")),h=null}return s=bi(T,o,s,g),s.elementType=n,s.type=h,s.lanes=b,s}function Ca(n,s,o,h){return n=bi(7,n,h,s),n.lanes=o,n}function Ed(n,s,o){return n=bi(6,n,null,s),n.lanes=o,n}function Xm(n){var s=bi(18,null,null,0);return s.stateNode=n,s}function _d(n,s,o){return s=bi(4,n.children!==null?n.children:[],n.key,s),s.lanes=o,s.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},s}var Ym=new WeakMap;function Li(n,s){if(typeof n=="object"&&n!==null){var o=Ym.get(n);return o!==void 0?o:(s={value:n,source:s,stack:Wc(s)},Ym.set(n,s),s)}return{value:n,source:s,stack:Wc(s)}}var _o=[],Co=0,mu=null,Ul=0,Pi=[],Bi=0,Cr=null,ps=1,ms="";function Gs(n,s){_o[Co++]=Ul,_o[Co++]=mu,mu=n,Ul=s}function Qm(n,s,o){Pi[Bi++]=ps,Pi[Bi++]=ms,Pi[Bi++]=Cr,Cr=n;var h=ps;n=ms;var g=32-Ft(h)-1;h&=~(1<<g),o+=1;var b=32-Ft(s)+g;if(30<b){var T=g-g%5;b=(h&(1<<T)-1).toString(32),h>>=T,g-=T,ps=1<<32-Ft(s)+g|o<<g|h,ms=b+n}else ps=1<<b|o<<g|h,ms=n}function Cd(n){n.return!==null&&(Gs(n,1),Qm(n,1,0))}function Td(n){for(;n===mu;)mu=_o[--Co],_o[Co]=null,Ul=_o[--Co],_o[Co]=null;for(;n===Cr;)Cr=Pi[--Bi],Pi[Bi]=null,ms=Pi[--Bi],Pi[Bi]=null,ps=Pi[--Bi],Pi[Bi]=null}function Wm(n,s){Pi[Bi++]=ps,Pi[Bi++]=ms,Pi[Bi++]=Cr,ps=s.id,ms=s.overflow,Cr=n}var kn=null,Ge=null,ye=!1,Tr=null,ji=!1,Rd=Error(i(519));function Rr(n){var s=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw zl(Li(s,n)),Rd}function Zm(n){var s=n.stateNode,o=n.type,h=n.memoizedProps;switch(s[ze]=n,s[sn]=h,o){case"dialog":de("cancel",s),de("close",s);break;case"iframe":case"object":case"embed":de("load",s);break;case"video":case"audio":for(o=0;o<cc.length;o++)de(cc[o],s);break;case"source":de("error",s);break;case"img":case"image":case"link":de("error",s),de("load",s);break;case"details":de("toggle",s);break;case"input":de("invalid",s),ro(s,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0);break;case"select":de("invalid",s);break;case"textarea":de("invalid",s),ba(s,h.value,h.defaultValue,h.children)}o=h.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||s.textContent===""+o||h.suppressHydrationWarning===!0||mb(s.textContent,o)?(h.popover!=null&&(de("beforetoggle",s),de("toggle",s)),h.onScroll!=null&&de("scroll",s),h.onScrollEnd!=null&&de("scrollend",s),h.onClick!=null&&(s.onclick=ii),s=!0):s=!1,s||Rr(n,!0)}function Jm(n){for(kn=n.return;kn;)switch(kn.tag){case 5:case 31:case 13:ji=!1;return;case 27:case 3:ji=!0;return;default:kn=kn.return}}function To(n){if(n!==kn)return!1;if(!ye)return Jm(n),ye=!0,!1;var s=n.tag,o;if((o=s!==3&&s!==27)&&((o=s===5)&&(o=n.type,o=!(o!=="form"&&o!=="button")||Kf(n.type,n.memoizedProps)),o=!o),o&&Ge&&Rr(n),Jm(n),s===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Ge=Eb(n)}else if(s===31){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(317));Ge=Eb(n)}else s===27?(s=Ge,Hr(n.type)?(n=Zf,Zf=null,Ge=n):Ge=s):Ge=kn?Ii(n.stateNode.nextSibling):null;return!0}function Ta(){Ge=kn=null,ye=!1}function Md(){var n=Tr;return n!==null&&(oi===null?oi=n:oi.push.apply(oi,n),Tr=null),n}function zl(n){Tr===null?Tr=[n]:Tr.push(n)}var Dd=I(null),Ra=null,$s=null;function Mr(n,s,o){mt(Dd,s._currentValue),s._currentValue=o}function Vs(n){n._currentValue=Dd.current,J(Dd)}function Od(n,s,o){for(;n!==null;){var h=n.alternate;if((n.childLanes&s)!==s?(n.childLanes|=s,h!==null&&(h.childLanes|=s)):h!==null&&(h.childLanes&s)!==s&&(h.childLanes|=s),n===o)break;n=n.return}}function Nd(n,s,o,h){var g=n.child;for(g!==null&&(g.return=n);g!==null;){var b=g.dependencies;if(b!==null){var T=g.child;b=b.firstContext;t:for(;b!==null;){var N=b;b=g;for(var q=0;q<s.length;q++)if(N.context===s[q]){b.lanes|=o,N=b.alternate,N!==null&&(N.lanes|=o),Od(b.return,o,n),h||(T=null);break t}b=N.next}}else if(g.tag===18){if(T=g.return,T===null)throw Error(i(341));T.lanes|=o,b=T.alternate,b!==null&&(b.lanes|=o),Od(T,o,n),T=null}else T=g.child;if(T!==null)T.return=g;else for(T=g;T!==null;){if(T===n){T=null;break}if(g=T.sibling,g!==null){g.return=T.return,T=g;break}T=T.return}g=T}}function Ro(n,s,o,h){n=null;for(var g=s,b=!1;g!==null;){if(!b){if((g.flags&524288)!==0)b=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var T=g.alternate;if(T===null)throw Error(i(387));if(T=T.memoizedProps,T!==null){var N=g.type;$n(g.pendingProps.value,T.value)||(n!==null?n.push(N):n=[N])}}else if(g===Ot.current){if(T=g.alternate,T===null)throw Error(i(387));T.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(n!==null?n.push(pc):n=[pc])}g=g.return}n!==null&&Nd(s,n,o,h),s.flags|=262144}function gu(n){for(n=n.firstContext;n!==null;){if(!$n(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function Ma(n){Ra=n,$s=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function Ln(n){return tg(Ra,n)}function yu(n,s){return Ra===null&&Ma(n),tg(n,s)}function tg(n,s){var o=s._currentValue;if(s={context:s,memoizedValue:o,next:null},$s===null){if(n===null)throw Error(i(308));$s=s,n.dependencies={lanes:0,firstContext:s},n.flags|=524288}else $s=$s.next=s;return o}var l1=typeof AbortController<"u"?AbortController:function(){var n=[],s=this.signal={aborted:!1,addEventListener:function(o,h){n.push(h)}};this.abort=function(){s.aborted=!0,n.forEach(function(o){return o()})}},c1=a.unstable_scheduleCallback,u1=a.unstable_NormalPriority,dn={$$typeof:L,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kd(){return{controller:new l1,data:new Map,refCount:0}}function Hl(n){n.refCount--,n.refCount===0&&c1(u1,function(){n.controller.abort()})}var ql=null,Ld=0,Mo=0,Do=null;function h1(n,s){if(ql===null){var o=ql=[];Ld=0,Mo=Ff(),Do={status:"pending",value:void 0,then:function(h){o.push(h)}}}return Ld++,s.then(eg,eg),s}function eg(){if(--Ld===0&&ql!==null){Do!==null&&(Do.status="fulfilled");var n=ql;ql=null,Mo=0,Do=null;for(var s=0;s<n.length;s++)(0,n[s])()}}function d1(n,s){var o=[],h={status:"pending",value:null,reason:null,then:function(g){o.push(g)}};return n.then(function(){h.status="fulfilled",h.value=s;for(var g=0;g<o.length;g++)(0,o[g])(s)},function(g){for(h.status="rejected",h.reason=g,g=0;g<o.length;g++)(0,o[g])(void 0)}),h}var ng=G.S;G.S=function(n,s){Iy=zn(),typeof s=="object"&&s!==null&&typeof s.then=="function"&&h1(n,s),ng!==null&&ng(n,s)};var Da=I(null);function Pd(){var n=Da.current;return n!==null?n:Ue.pooledCache}function bu(n,s){s===null?mt(Da,Da.current):mt(Da,s.pool)}function ig(){var n=Pd();return n===null?null:{parent:dn._currentValue,pool:n}}var Oo=Error(i(460)),Bd=Error(i(474)),vu=Error(i(542)),wu={then:function(){}};function sg(n){return n=n.status,n==="fulfilled"||n==="rejected"}function rg(n,s,o){switch(o=n[o],o===void 0?n.push(s):o!==s&&(s.then(ii,ii),s=o),s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,og(n),n;default:if(typeof s.status=="string")s.then(ii,ii);else{if(n=Ue,n!==null&&100<n.shellSuspendCounter)throw Error(i(482));n=s,n.status="pending",n.then(function(h){if(s.status==="pending"){var g=s;g.status="fulfilled",g.value=h}},function(h){if(s.status==="pending"){var g=s;g.status="rejected",g.reason=h}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw n=s.reason,og(n),n}throw Na=s,Oo}}function Oa(n){try{var s=n._init;return s(n._payload)}catch(o){throw o!==null&&typeof o=="object"&&typeof o.then=="function"?(Na=o,Oo):o}}var Na=null;function ag(){if(Na===null)throw Error(i(459));var n=Na;return Na=null,n}function og(n){if(n===Oo||n===vu)throw Error(i(483))}var No=null,Gl=0;function xu(n){var s=Gl;return Gl+=1,No===null&&(No=[]),rg(No,n,s)}function $l(n,s){s=s.props.ref,n.ref=s!==void 0?s:null}function Au(n,s){throw s.$$typeof===w?Error(i(525)):(n=Object.prototype.toString.call(s),Error(i(31,n==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":n)))}function lg(n){function s(tt,W){if(n){var rt=tt.deletions;rt===null?(tt.deletions=[W],tt.flags|=16):rt.push(W)}}function o(tt,W){if(!n)return null;for(;W!==null;)s(tt,W),W=W.sibling;return null}function h(tt){for(var W=new Map;tt!==null;)tt.key!==null?W.set(tt.key,tt):W.set(tt.index,tt),tt=tt.sibling;return W}function g(tt,W){return tt=qs(tt,W),tt.index=0,tt.sibling=null,tt}function b(tt,W,rt){return tt.index=rt,n?(rt=tt.alternate,rt!==null?(rt=rt.index,rt<W?(tt.flags|=67108866,W):rt):(tt.flags|=67108866,W)):(tt.flags|=1048576,W)}function T(tt){return n&&tt.alternate===null&&(tt.flags|=67108866),tt}function N(tt,W,rt,bt){return W===null||W.tag!==6?(W=Ed(rt,tt.mode,bt),W.return=tt,W):(W=g(W,rt),W.return=tt,W)}function q(tt,W,rt,bt){var Wt=rt.type;return Wt===S?yt(tt,W,rt.props.children,bt,rt.key):W!==null&&(W.elementType===Wt||typeof Wt=="object"&&Wt!==null&&Wt.$$typeof===ut&&Oa(Wt)===W.type)?(W=g(W,rt.props),$l(W,rt),W.return=tt,W):(W=pu(rt.type,rt.key,rt.props,null,tt.mode,bt),$l(W,rt),W.return=tt,W)}function at(tt,W,rt,bt){return W===null||W.tag!==4||W.stateNode.containerInfo!==rt.containerInfo||W.stateNode.implementation!==rt.implementation?(W=_d(rt,tt.mode,bt),W.return=tt,W):(W=g(W,rt.children||[]),W.return=tt,W)}function yt(tt,W,rt,bt,Wt){return W===null||W.tag!==7?(W=Ca(rt,tt.mode,bt,Wt),W.return=tt,W):(W=g(W,rt),W.return=tt,W)}function vt(tt,W,rt){if(typeof W=="string"&&W!==""||typeof W=="number"||typeof W=="bigint")return W=Ed(""+W,tt.mode,rt),W.return=tt,W;if(typeof W=="object"&&W!==null){switch(W.$$typeof){case A:return rt=pu(W.type,W.key,W.props,null,tt.mode,rt),$l(rt,W),rt.return=tt,rt;case _:return W=_d(W,tt.mode,rt),W.return=tt,W;case ut:return W=Oa(W),vt(tt,W,rt)}if(Vt(W)||Tt(W))return W=Ca(W,tt.mode,rt,null),W.return=tt,W;if(typeof W.then=="function")return vt(tt,xu(W),rt);if(W.$$typeof===L)return vt(tt,yu(tt,W),rt);Au(tt,W)}return null}function lt(tt,W,rt,bt){var Wt=W!==null?W.key:null;if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return Wt!==null?null:N(tt,W,""+rt,bt);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case A:return rt.key===Wt?q(tt,W,rt,bt):null;case _:return rt.key===Wt?at(tt,W,rt,bt):null;case ut:return rt=Oa(rt),lt(tt,W,rt,bt)}if(Vt(rt)||Tt(rt))return Wt!==null?null:yt(tt,W,rt,bt,null);if(typeof rt.then=="function")return lt(tt,W,xu(rt),bt);if(rt.$$typeof===L)return lt(tt,W,yu(tt,rt),bt);Au(tt,rt)}return null}function dt(tt,W,rt,bt,Wt){if(typeof bt=="string"&&bt!==""||typeof bt=="number"||typeof bt=="bigint")return tt=tt.get(rt)||null,N(W,tt,""+bt,Wt);if(typeof bt=="object"&&bt!==null){switch(bt.$$typeof){case A:return tt=tt.get(bt.key===null?rt:bt.key)||null,q(W,tt,bt,Wt);case _:return tt=tt.get(bt.key===null?rt:bt.key)||null,at(W,tt,bt,Wt);case ut:return bt=Oa(bt),dt(tt,W,rt,bt,Wt)}if(Vt(bt)||Tt(bt))return tt=tt.get(rt)||null,yt(W,tt,bt,Wt,null);if(typeof bt.then=="function")return dt(tt,W,rt,xu(bt),Wt);if(bt.$$typeof===L)return dt(tt,W,rt,yu(W,bt),Wt);Au(W,bt)}return null}function $t(tt,W,rt,bt){for(var Wt=null,xe=null,Xt=W,le=W=0,me=null;Xt!==null&&le<rt.length;le++){Xt.index>le?(me=Xt,Xt=null):me=Xt.sibling;var Ae=lt(tt,Xt,rt[le],bt);if(Ae===null){Xt===null&&(Xt=me);break}n&&Xt&&Ae.alternate===null&&s(tt,Xt),W=b(Ae,W,le),xe===null?Wt=Ae:xe.sibling=Ae,xe=Ae,Xt=me}if(le===rt.length)return o(tt,Xt),ye&&Gs(tt,le),Wt;if(Xt===null){for(;le<rt.length;le++)Xt=vt(tt,rt[le],bt),Xt!==null&&(W=b(Xt,W,le),xe===null?Wt=Xt:xe.sibling=Xt,xe=Xt);return ye&&Gs(tt,le),Wt}for(Xt=h(Xt);le<rt.length;le++)me=dt(Xt,tt,le,rt[le],bt),me!==null&&(n&&me.alternate!==null&&Xt.delete(me.key===null?le:me.key),W=b(me,W,le),xe===null?Wt=me:xe.sibling=me,xe=me);return n&&Xt.forEach(function(Kr){return s(tt,Kr)}),ye&&Gs(tt,le),Wt}function Jt(tt,W,rt,bt){if(rt==null)throw Error(i(151));for(var Wt=null,xe=null,Xt=W,le=W=0,me=null,Ae=rt.next();Xt!==null&&!Ae.done;le++,Ae=rt.next()){Xt.index>le?(me=Xt,Xt=null):me=Xt.sibling;var Kr=lt(tt,Xt,Ae.value,bt);if(Kr===null){Xt===null&&(Xt=me);break}n&&Xt&&Kr.alternate===null&&s(tt,Xt),W=b(Kr,W,le),xe===null?Wt=Kr:xe.sibling=Kr,xe=Kr,Xt=me}if(Ae.done)return o(tt,Xt),ye&&Gs(tt,le),Wt;if(Xt===null){for(;!Ae.done;le++,Ae=rt.next())Ae=vt(tt,Ae.value,bt),Ae!==null&&(W=b(Ae,W,le),xe===null?Wt=Ae:xe.sibling=Ae,xe=Ae);return ye&&Gs(tt,le),Wt}for(Xt=h(Xt);!Ae.done;le++,Ae=rt.next())Ae=dt(Xt,tt,le,Ae.value,bt),Ae!==null&&(n&&Ae.alternate!==null&&Xt.delete(Ae.key===null?le:Ae.key),W=b(Ae,W,le),xe===null?Wt=Ae:xe.sibling=Ae,xe=Ae);return n&&Xt.forEach(function(Sx){return s(tt,Sx)}),ye&&Gs(tt,le),Wt}function je(tt,W,rt,bt){if(typeof rt=="object"&&rt!==null&&rt.type===S&&rt.key===null&&(rt=rt.props.children),typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case A:t:{for(var Wt=rt.key;W!==null;){if(W.key===Wt){if(Wt=rt.type,Wt===S){if(W.tag===7){o(tt,W.sibling),bt=g(W,rt.props.children),bt.return=tt,tt=bt;break t}}else if(W.elementType===Wt||typeof Wt=="object"&&Wt!==null&&Wt.$$typeof===ut&&Oa(Wt)===W.type){o(tt,W.sibling),bt=g(W,rt.props),$l(bt,rt),bt.return=tt,tt=bt;break t}o(tt,W);break}else s(tt,W);W=W.sibling}rt.type===S?(bt=Ca(rt.props.children,tt.mode,bt,rt.key),bt.return=tt,tt=bt):(bt=pu(rt.type,rt.key,rt.props,null,tt.mode,bt),$l(bt,rt),bt.return=tt,tt=bt)}return T(tt);case _:t:{for(Wt=rt.key;W!==null;){if(W.key===Wt)if(W.tag===4&&W.stateNode.containerInfo===rt.containerInfo&&W.stateNode.implementation===rt.implementation){o(tt,W.sibling),bt=g(W,rt.children||[]),bt.return=tt,tt=bt;break t}else{o(tt,W);break}else s(tt,W);W=W.sibling}bt=_d(rt,tt.mode,bt),bt.return=tt,tt=bt}return T(tt);case ut:return rt=Oa(rt),je(tt,W,rt,bt)}if(Vt(rt))return $t(tt,W,rt,bt);if(Tt(rt)){if(Wt=Tt(rt),typeof Wt!="function")throw Error(i(150));return rt=Wt.call(rt),Jt(tt,W,rt,bt)}if(typeof rt.then=="function")return je(tt,W,xu(rt),bt);if(rt.$$typeof===L)return je(tt,W,yu(tt,rt),bt);Au(tt,rt)}return typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint"?(rt=""+rt,W!==null&&W.tag===6?(o(tt,W.sibling),bt=g(W,rt),bt.return=tt,tt=bt):(o(tt,W),bt=Ed(rt,tt.mode,bt),bt.return=tt,tt=bt),T(tt)):o(tt,W)}return function(tt,W,rt,bt){try{Gl=0;var Wt=je(tt,W,rt,bt);return No=null,Wt}catch(Xt){if(Xt===Oo||Xt===vu)throw Xt;var xe=bi(29,Xt,null,tt.mode);return xe.lanes=bt,xe.return=tt,xe}}}var ka=lg(!0),cg=lg(!1),Dr=!1;function jd(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Fd(n,s){n=n.updateQueue,s.updateQueue===n&&(s.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Or(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Nr(n,s,o){var h=n.updateQueue;if(h===null)return null;if(h=h.shared,(Ee&2)!==0){var g=h.pending;return g===null?s.next=s:(s.next=g.next,g.next=s),h.pending=s,s=_r(n),fs(n,null,o),s}return Le(n,h,s,o),_r(n)}function Vl(n,s,o){if(s=s.updateQueue,s!==null&&(s=s.shared,(o&4194048)!==0)){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ie(n,o)}}function Id(n,s){var o=n.updateQueue,h=n.alternate;if(h!==null&&(h=h.updateQueue,o===h)){var g=null,b=null;if(o=o.firstBaseUpdate,o!==null){do{var T={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};b===null?g=b=T:b=b.next=T,o=o.next}while(o!==null);b===null?g=b=s:b=b.next=s}else g=b=s;o={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:b,shared:h.shared,callbacks:h.callbacks},n.updateQueue=o;return}n=o.lastBaseUpdate,n===null?o.firstBaseUpdate=s:n.next=s,o.lastBaseUpdate=s}var Ud=!1;function Kl(){if(Ud){var n=Do;if(n!==null)throw n}}function Xl(n,s,o,h){Ud=!1;var g=n.updateQueue;Dr=!1;var b=g.firstBaseUpdate,T=g.lastBaseUpdate,N=g.shared.pending;if(N!==null){g.shared.pending=null;var q=N,at=q.next;q.next=null,T===null?b=at:T.next=at,T=q;var yt=n.alternate;yt!==null&&(yt=yt.updateQueue,N=yt.lastBaseUpdate,N!==T&&(N===null?yt.firstBaseUpdate=at:N.next=at,yt.lastBaseUpdate=q))}if(b!==null){var vt=g.baseState;T=0,yt=at=q=null,N=b;do{var lt=N.lane&-536870913,dt=lt!==N.lane;if(dt?(pe&lt)===lt:(h&lt)===lt){lt!==0&&lt===Mo&&(Ud=!0),yt!==null&&(yt=yt.next={lane:0,tag:N.tag,payload:N.payload,callback:null,next:null});t:{var $t=n,Jt=N;lt=s;var je=o;switch(Jt.tag){case 1:if($t=Jt.payload,typeof $t=="function"){vt=$t.call(je,vt,lt);break t}vt=$t;break t;case 3:$t.flags=$t.flags&-65537|128;case 0:if($t=Jt.payload,lt=typeof $t=="function"?$t.call(je,vt,lt):$t,lt==null)break t;vt=y({},vt,lt);break t;case 2:Dr=!0}}lt=N.callback,lt!==null&&(n.flags|=64,dt&&(n.flags|=8192),dt=g.callbacks,dt===null?g.callbacks=[lt]:dt.push(lt))}else dt={lane:lt,tag:N.tag,payload:N.payload,callback:N.callback,next:null},yt===null?(at=yt=dt,q=vt):yt=yt.next=dt,T|=lt;if(N=N.next,N===null){if(N=g.shared.pending,N===null)break;dt=N,N=dt.next,dt.next=null,g.lastBaseUpdate=dt,g.shared.pending=null}}while(!0);yt===null&&(q=vt),g.baseState=q,g.firstBaseUpdate=at,g.lastBaseUpdate=yt,b===null&&(g.shared.lanes=0),jr|=T,n.lanes=T,n.memoizedState=vt}}function ug(n,s){if(typeof n!="function")throw Error(i(191,n));n.call(s)}function hg(n,s){var o=n.callbacks;if(o!==null)for(n.callbacks=null,n=0;n<o.length;n++)ug(o[n],s)}var ko=I(null),Su=I(0);function dg(n,s){n=er,mt(Su,n),mt(ko,s),er=n|s.baseLanes}function zd(){mt(Su,er),mt(ko,ko.current)}function Hd(){er=Su.current,J(ko),J(Su)}var vi=I(null),Fi=null;function kr(n){var s=n.alternate;mt(an,an.current&1),mt(vi,n),Fi===null&&(s===null||ko.current!==null||s.memoizedState!==null)&&(Fi=n)}function qd(n){mt(an,an.current),mt(vi,n),Fi===null&&(Fi=n)}function fg(n){n.tag===22?(mt(an,an.current),mt(vi,n),Fi===null&&(Fi=n)):Lr()}function Lr(){mt(an,an.current),mt(vi,vi.current)}function wi(n){J(vi),Fi===n&&(Fi=null),J(an)}var an=I(0);function Eu(n){for(var s=n;s!==null;){if(s.tag===13){var o=s.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||Qf(o)||Wf(o)))return s}else if(s.tag===19&&(s.memoizedProps.revealOrder==="forwards"||s.memoizedProps.revealOrder==="backwards"||s.memoizedProps.revealOrder==="unstable_legacy-backwards"||s.memoizedProps.revealOrder==="together")){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ks=0,oe=null,Pe=null,fn=null,_u=!1,Lo=!1,La=!1,Cu=0,Yl=0,Po=null,f1=0;function Ze(){throw Error(i(321))}function Gd(n,s){if(s===null)return!1;for(var o=0;o<s.length&&o<n.length;o++)if(!$n(n[o],s[o]))return!1;return!0}function $d(n,s,o,h,g,b){return Ks=b,oe=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,G.H=n===null||n.memoizedState===null?Qg:of,La=!1,b=o(h,g),La=!1,Lo&&(b=mg(s,o,h,g)),pg(n),b}function pg(n){G.H=Zl;var s=Pe!==null&&Pe.next!==null;if(Ks=0,fn=Pe=oe=null,_u=!1,Yl=0,Po=null,s)throw Error(i(300));n===null||pn||(n=n.dependencies,n!==null&&gu(n)&&(pn=!0))}function mg(n,s,o,h){oe=n;var g=0;do{if(Lo&&(Po=null),Yl=0,Lo=!1,25<=g)throw Error(i(301));if(g+=1,fn=Pe=null,n.updateQueue!=null){var b=n.updateQueue;b.lastEffect=null,b.events=null,b.stores=null,b.memoCache!=null&&(b.memoCache.index=0)}G.H=Wg,b=s(o,h)}while(Lo);return b}function p1(){var n=G.H,s=n.useState()[0];return s=typeof s.then=="function"?Ql(s):s,n=n.useState()[0],(Pe!==null?Pe.memoizedState:null)!==n&&(oe.flags|=1024),s}function Vd(){var n=Cu!==0;return Cu=0,n}function Kd(n,s,o){s.updateQueue=n.updateQueue,s.flags&=-2053,n.lanes&=~o}function Xd(n){if(_u){for(n=n.memoizedState;n!==null;){var s=n.queue;s!==null&&(s.pending=null),n=n.next}_u=!1}Ks=0,fn=Pe=oe=null,Lo=!1,Yl=Cu=0,Po=null}function Wn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?oe.memoizedState=fn=n:fn=fn.next=n,fn}function on(){if(Pe===null){var n=oe.alternate;n=n!==null?n.memoizedState:null}else n=Pe.next;var s=fn===null?oe.memoizedState:fn.next;if(s!==null)fn=s,Pe=n;else{if(n===null)throw oe.alternate===null?Error(i(467)):Error(i(310));Pe=n,n={memoizedState:Pe.memoizedState,baseState:Pe.baseState,baseQueue:Pe.baseQueue,queue:Pe.queue,next:null},fn===null?oe.memoizedState=fn=n:fn=fn.next=n}return fn}function Tu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ql(n){var s=Yl;return Yl+=1,Po===null&&(Po=[]),n=rg(Po,n,s),s=oe,(fn===null?s.memoizedState:fn.next)===null&&(s=s.alternate,G.H=s===null||s.memoizedState===null?Qg:of),n}function Ru(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return Ql(n);if(n.$$typeof===L)return Ln(n)}throw Error(i(438,String(n)))}function Yd(n){var s=null,o=oe.updateQueue;if(o!==null&&(s=o.memoCache),s==null){var h=oe.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(s={data:h.data.map(function(g){return g.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),o===null&&(o=Tu(),oe.updateQueue=o),o.memoCache=s,o=s.data[s.index],o===void 0)for(o=s.data[s.index]=Array(n),h=0;h<n;h++)o[h]=_t;return s.index++,o}function Xs(n,s){return typeof s=="function"?s(n):s}function Mu(n){var s=on();return Qd(s,Pe,n)}function Qd(n,s,o){var h=n.queue;if(h===null)throw Error(i(311));h.lastRenderedReducer=o;var g=n.baseQueue,b=h.pending;if(b!==null){if(g!==null){var T=g.next;g.next=b.next,b.next=T}s.baseQueue=g=b,h.pending=null}if(b=n.baseState,g===null)n.memoizedState=b;else{s=g.next;var N=T=null,q=null,at=s,yt=!1;do{var vt=at.lane&-536870913;if(vt!==at.lane?(pe&vt)===vt:(Ks&vt)===vt){var lt=at.revertLane;if(lt===0)q!==null&&(q=q.next={lane:0,revertLane:0,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),vt===Mo&&(yt=!0);else if((Ks&lt)===lt){at=at.next,lt===Mo&&(yt=!0);continue}else vt={lane:0,revertLane:at.revertLane,gesture:null,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},q===null?(N=q=vt,T=b):q=q.next=vt,oe.lanes|=lt,jr|=lt;vt=at.action,La&&o(b,vt),b=at.hasEagerState?at.eagerState:o(b,vt)}else lt={lane:vt,revertLane:at.revertLane,gesture:at.gesture,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null},q===null?(N=q=lt,T=b):q=q.next=lt,oe.lanes|=vt,jr|=vt;at=at.next}while(at!==null&&at!==s);if(q===null?T=b:q.next=N,!$n(b,n.memoizedState)&&(pn=!0,yt&&(o=Do,o!==null)))throw o;n.memoizedState=b,n.baseState=T,n.baseQueue=q,h.lastRenderedState=b}return g===null&&(h.lanes=0),[n.memoizedState,h.dispatch]}function Wd(n){var s=on(),o=s.queue;if(o===null)throw Error(i(311));o.lastRenderedReducer=n;var h=o.dispatch,g=o.pending,b=s.memoizedState;if(g!==null){o.pending=null;var T=g=g.next;do b=n(b,T.action),T=T.next;while(T!==g);$n(b,s.memoizedState)||(pn=!0),s.memoizedState=b,s.baseQueue===null&&(s.baseState=b),o.lastRenderedState=b}return[b,h]}function gg(n,s,o){var h=oe,g=on(),b=ye;if(b){if(o===void 0)throw Error(i(407));o=o()}else o=s();var T=!$n((Pe||g).memoizedState,o);if(T&&(g.memoizedState=o,pn=!0),g=g.queue,tf(vg.bind(null,h,g,n),[n]),g.getSnapshot!==s||T||fn!==null&&fn.memoizedState.tag&1){if(h.flags|=2048,Bo(9,{destroy:void 0},bg.bind(null,h,g,o,s),null),Ue===null)throw Error(i(349));b||(Ks&127)!==0||yg(h,s,o)}return o}function yg(n,s,o){n.flags|=16384,n={getSnapshot:s,value:o},s=oe.updateQueue,s===null?(s=Tu(),oe.updateQueue=s,s.stores=[n]):(o=s.stores,o===null?s.stores=[n]:o.push(n))}function bg(n,s,o,h){s.value=o,s.getSnapshot=h,wg(s)&&xg(n)}function vg(n,s,o){return o(function(){wg(s)&&xg(n)})}function wg(n){var s=n.getSnapshot;n=n.value;try{var o=s();return!$n(n,o)}catch{return!0}}function xg(n){var s=De(n,2);s!==null&&li(s,n,2)}function Zd(n){var s=Wn();if(typeof n=="function"){var o=n;if(n=o(),La){On(!0);try{o()}finally{On(!1)}}}return s.memoizedState=s.baseState=n,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:n},s}function Ag(n,s,o,h){return n.baseState=o,Qd(n,Pe,typeof h=="function"?h:Xs)}function m1(n,s,o,h,g){if(Nu(n))throw Error(i(485));if(n=s.action,n!==null){var b={payload:g,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(T){b.listeners.push(T)}};G.T!==null?o(!0):b.isTransition=!1,h(b),o=s.pending,o===null?(b.next=s.pending=b,Sg(s,b)):(b.next=o.next,s.pending=o.next=b)}}function Sg(n,s){var o=s.action,h=s.payload,g=n.state;if(s.isTransition){var b=G.T,T={};G.T=T;try{var N=o(g,h),q=G.S;q!==null&&q(T,N),Eg(n,s,N)}catch(at){Jd(n,s,at)}finally{b!==null&&T.types!==null&&(b.types=T.types),G.T=b}}else try{b=o(g,h),Eg(n,s,b)}catch(at){Jd(n,s,at)}}function Eg(n,s,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(h){_g(n,s,h)},function(h){return Jd(n,s,h)}):_g(n,s,o)}function _g(n,s,o){s.status="fulfilled",s.value=o,Cg(s),n.state=o,s=n.pending,s!==null&&(o=s.next,o===s?n.pending=null:(o=o.next,s.next=o,Sg(n,o)))}function Jd(n,s,o){var h=n.pending;if(n.pending=null,h!==null){h=h.next;do s.status="rejected",s.reason=o,Cg(s),s=s.next;while(s!==h)}n.action=null}function Cg(n){n=n.listeners;for(var s=0;s<n.length;s++)(0,n[s])()}function Tg(n,s){return s}function Rg(n,s){if(ye){var o=Ue.formState;if(o!==null){t:{var h=oe;if(ye){if(Ge){e:{for(var g=Ge,b=ji;g.nodeType!==8;){if(!b){g=null;break e}if(g=Ii(g.nextSibling),g===null){g=null;break e}}b=g.data,g=b==="F!"||b==="F"?g:null}if(g){Ge=Ii(g.nextSibling),h=g.data==="F!";break t}}Rr(h)}h=!1}h&&(s=o[0])}}return o=Wn(),o.memoizedState=o.baseState=s,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Tg,lastRenderedState:s},o.queue=h,o=Kg.bind(null,oe,h),h.dispatch=o,h=Zd(!1),b=af.bind(null,oe,!1,h.queue),h=Wn(),g={state:s,dispatch:null,action:n,pending:null},h.queue=g,o=m1.bind(null,oe,g,b,o),g.dispatch=o,h.memoizedState=n,[s,o,!1]}function Mg(n){var s=on();return Dg(s,Pe,n)}function Dg(n,s,o){if(s=Qd(n,s,Tg)[0],n=Mu(Xs)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var h=Ql(s)}catch(T){throw T===Oo?vu:T}else h=s;s=on();var g=s.queue,b=g.dispatch;return o!==s.memoizedState&&(oe.flags|=2048,Bo(9,{destroy:void 0},g1.bind(null,g,o),null)),[h,b,n]}function g1(n,s){n.action=s}function Og(n){var s=on(),o=Pe;if(o!==null)return Dg(s,o,n);on(),s=s.memoizedState,o=on();var h=o.queue.dispatch;return o.memoizedState=n,[s,h,!1]}function Bo(n,s,o,h){return n={tag:n,create:o,deps:h,inst:s,next:null},s=oe.updateQueue,s===null&&(s=Tu(),oe.updateQueue=s),o=s.lastEffect,o===null?s.lastEffect=n.next=n:(h=o.next,o.next=n,n.next=h,s.lastEffect=n),n}function Ng(){return on().memoizedState}function Du(n,s,o,h){var g=Wn();oe.flags|=n,g.memoizedState=Bo(1|s,{destroy:void 0},o,h===void 0?null:h)}function Ou(n,s,o,h){var g=on();h=h===void 0?null:h;var b=g.memoizedState.inst;Pe!==null&&h!==null&&Gd(h,Pe.memoizedState.deps)?g.memoizedState=Bo(s,b,o,h):(oe.flags|=n,g.memoizedState=Bo(1|s,b,o,h))}function kg(n,s){Du(8390656,8,n,s)}function tf(n,s){Ou(2048,8,n,s)}function y1(n){oe.flags|=4;var s=oe.updateQueue;if(s===null)s=Tu(),oe.updateQueue=s,s.events=[n];else{var o=s.events;o===null?s.events=[n]:o.push(n)}}function Lg(n){var s=on().memoizedState;return y1({ref:s,nextImpl:n}),function(){if((Ee&2)!==0)throw Error(i(440));return s.impl.apply(void 0,arguments)}}function Pg(n,s){return Ou(4,2,n,s)}function Bg(n,s){return Ou(4,4,n,s)}function jg(n,s){if(typeof s=="function"){n=n();var o=s(n);return function(){typeof o=="function"?o():s(null)}}if(s!=null)return n=n(),s.current=n,function(){s.current=null}}function Fg(n,s,o){o=o!=null?o.concat([n]):null,Ou(4,4,jg.bind(null,s,n),o)}function ef(){}function Ig(n,s){var o=on();s=s===void 0?null:s;var h=o.memoizedState;return s!==null&&Gd(s,h[1])?h[0]:(o.memoizedState=[n,s],n)}function Ug(n,s){var o=on();s=s===void 0?null:s;var h=o.memoizedState;if(s!==null&&Gd(s,h[1]))return h[0];if(h=n(),La){On(!0);try{n()}finally{On(!1)}}return o.memoizedState=[h,s],h}function nf(n,s,o){return o===void 0||(Ks&1073741824)!==0&&(pe&261930)===0?n.memoizedState=s:(n.memoizedState=o,n=zy(),oe.lanes|=n,jr|=n,o)}function zg(n,s,o,h){return $n(o,s)?o:ko.current!==null?(n=nf(n,o,h),$n(n,s)||(pn=!0),n):(Ks&42)===0||(Ks&1073741824)!==0&&(pe&261930)===0?(pn=!0,n.memoizedState=o):(n=zy(),oe.lanes|=n,jr|=n,s)}function Hg(n,s,o,h,g){var b=st.p;st.p=b!==0&&8>b?b:8;var T=G.T,N={};G.T=N,af(n,!1,s,o);try{var q=g(),at=G.S;if(at!==null&&at(N,q),q!==null&&typeof q=="object"&&typeof q.then=="function"){var yt=d1(q,h);Wl(n,s,yt,Si(n))}else Wl(n,s,h,Si(n))}catch(vt){Wl(n,s,{then:function(){},status:"rejected",reason:vt},Si())}finally{st.p=b,T!==null&&N.types!==null&&(T.types=N.types),G.T=T}}function b1(){}function sf(n,s,o,h){if(n.tag!==5)throw Error(i(476));var g=qg(n).queue;Hg(n,g,s,wt,o===null?b1:function(){return Gg(n),o(h)})}function qg(n){var s=n.memoizedState;if(s!==null)return s;s={memoizedState:wt,baseState:wt,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:wt},next:null};var o={};return s.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Xs,lastRenderedState:o},next:null},n.memoizedState=s,n=n.alternate,n!==null&&(n.memoizedState=s),s}function Gg(n){var s=qg(n);s.next===null&&(s=n.alternate.memoizedState),Wl(n,s.next.queue,{},Si())}function rf(){return Ln(pc)}function $g(){return on().memoizedState}function Vg(){return on().memoizedState}function v1(n){for(var s=n.return;s!==null;){switch(s.tag){case 24:case 3:var o=Si();n=Or(o);var h=Nr(s,n,o);h!==null&&(li(h,s,o),Vl(h,s,o)),s={cache:kd()},n.payload=s;return}s=s.return}}function w1(n,s,o){var h=Si();o={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null},Nu(n)?Xg(s,o):(o=Vn(n,s,o,h),o!==null&&(li(o,n,h),Yg(o,s,h)))}function Kg(n,s,o){var h=Si();Wl(n,s,o,h)}function Wl(n,s,o,h){var g={lane:h,revertLane:0,gesture:null,action:o,hasEagerState:!1,eagerState:null,next:null};if(Nu(n))Xg(s,g);else{var b=n.alternate;if(n.lanes===0&&(b===null||b.lanes===0)&&(b=s.lastRenderedReducer,b!==null))try{var T=s.lastRenderedState,N=b(T,o);if(g.hasEagerState=!0,g.eagerState=N,$n(N,T))return Le(n,s,g,0),Ue===null&&se(),!1}catch{}if(o=Vn(n,s,g,h),o!==null)return li(o,n,h),Yg(o,s,h),!0}return!1}function af(n,s,o,h){if(h={lane:2,revertLane:Ff(),gesture:null,action:h,hasEagerState:!1,eagerState:null,next:null},Nu(n)){if(s)throw Error(i(479))}else s=Vn(n,o,h,2),s!==null&&li(s,n,2)}function Nu(n){var s=n.alternate;return n===oe||s!==null&&s===oe}function Xg(n,s){Lo=_u=!0;var o=n.pending;o===null?s.next=s:(s.next=o.next,o.next=s),n.pending=s}function Yg(n,s,o){if((o&4194048)!==0){var h=s.lanes;h&=n.pendingLanes,o|=h,s.lanes=o,Ie(n,o)}}var Zl={readContext:Ln,use:Ru,useCallback:Ze,useContext:Ze,useEffect:Ze,useImperativeHandle:Ze,useLayoutEffect:Ze,useInsertionEffect:Ze,useMemo:Ze,useReducer:Ze,useRef:Ze,useState:Ze,useDebugValue:Ze,useDeferredValue:Ze,useTransition:Ze,useSyncExternalStore:Ze,useId:Ze,useHostTransitionStatus:Ze,useFormState:Ze,useActionState:Ze,useOptimistic:Ze,useMemoCache:Ze,useCacheRefresh:Ze};Zl.useEffectEvent=Ze;var Qg={readContext:Ln,use:Ru,useCallback:function(n,s){return Wn().memoizedState=[n,s===void 0?null:s],n},useContext:Ln,useEffect:kg,useImperativeHandle:function(n,s,o){o=o!=null?o.concat([n]):null,Du(4194308,4,jg.bind(null,s,n),o)},useLayoutEffect:function(n,s){return Du(4194308,4,n,s)},useInsertionEffect:function(n,s){Du(4,2,n,s)},useMemo:function(n,s){var o=Wn();s=s===void 0?null:s;var h=n();if(La){On(!0);try{n()}finally{On(!1)}}return o.memoizedState=[h,s],h},useReducer:function(n,s,o){var h=Wn();if(o!==void 0){var g=o(s);if(La){On(!0);try{o(s)}finally{On(!1)}}}else g=s;return h.memoizedState=h.baseState=g,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:g},h.queue=n,n=n.dispatch=w1.bind(null,oe,n),[h.memoizedState,n]},useRef:function(n){var s=Wn();return n={current:n},s.memoizedState=n},useState:function(n){n=Zd(n);var s=n.queue,o=Kg.bind(null,oe,s);return s.dispatch=o,[n.memoizedState,o]},useDebugValue:ef,useDeferredValue:function(n,s){var o=Wn();return nf(o,n,s)},useTransition:function(){var n=Zd(!1);return n=Hg.bind(null,oe,n.queue,!0,!1),Wn().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,s,o){var h=oe,g=Wn();if(ye){if(o===void 0)throw Error(i(407));o=o()}else{if(o=s(),Ue===null)throw Error(i(349));(pe&127)!==0||yg(h,s,o)}g.memoizedState=o;var b={value:o,getSnapshot:s};return g.queue=b,kg(vg.bind(null,h,b,n),[n]),h.flags|=2048,Bo(9,{destroy:void 0},bg.bind(null,h,b,o,s),null),o},useId:function(){var n=Wn(),s=Ue.identifierPrefix;if(ye){var o=ms,h=ps;o=(h&~(1<<32-Ft(h)-1)).toString(32)+o,s="_"+s+"R_"+o,o=Cu++,0<o&&(s+="H"+o.toString(32)),s+="_"}else o=f1++,s="_"+s+"r_"+o.toString(32)+"_";return n.memoizedState=s},useHostTransitionStatus:rf,useFormState:Rg,useActionState:Rg,useOptimistic:function(n){var s=Wn();s.memoizedState=s.baseState=n;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=o,s=af.bind(null,oe,!0,o),o.dispatch=s,[n,s]},useMemoCache:Yd,useCacheRefresh:function(){return Wn().memoizedState=v1.bind(null,oe)},useEffectEvent:function(n){var s=Wn(),o={impl:n};return s.memoizedState=o,function(){if((Ee&2)!==0)throw Error(i(440));return o.impl.apply(void 0,arguments)}}},of={readContext:Ln,use:Ru,useCallback:Ig,useContext:Ln,useEffect:tf,useImperativeHandle:Fg,useInsertionEffect:Pg,useLayoutEffect:Bg,useMemo:Ug,useReducer:Mu,useRef:Ng,useState:function(){return Mu(Xs)},useDebugValue:ef,useDeferredValue:function(n,s){var o=on();return zg(o,Pe.memoizedState,n,s)},useTransition:function(){var n=Mu(Xs)[0],s=on().memoizedState;return[typeof n=="boolean"?n:Ql(n),s]},useSyncExternalStore:gg,useId:$g,useHostTransitionStatus:rf,useFormState:Mg,useActionState:Mg,useOptimistic:function(n,s){var o=on();return Ag(o,Pe,n,s)},useMemoCache:Yd,useCacheRefresh:Vg};of.useEffectEvent=Lg;var Wg={readContext:Ln,use:Ru,useCallback:Ig,useContext:Ln,useEffect:tf,useImperativeHandle:Fg,useInsertionEffect:Pg,useLayoutEffect:Bg,useMemo:Ug,useReducer:Wd,useRef:Ng,useState:function(){return Wd(Xs)},useDebugValue:ef,useDeferredValue:function(n,s){var o=on();return Pe===null?nf(o,n,s):zg(o,Pe.memoizedState,n,s)},useTransition:function(){var n=Wd(Xs)[0],s=on().memoizedState;return[typeof n=="boolean"?n:Ql(n),s]},useSyncExternalStore:gg,useId:$g,useHostTransitionStatus:rf,useFormState:Og,useActionState:Og,useOptimistic:function(n,s){var o=on();return Pe!==null?Ag(o,Pe,n,s):(o.baseState=n,[n,o.queue.dispatch])},useMemoCache:Yd,useCacheRefresh:Vg};Wg.useEffectEvent=Lg;function lf(n,s,o,h){s=n.memoizedState,o=o(h,s),o=o==null?s:y({},s,o),n.memoizedState=o,n.lanes===0&&(n.updateQueue.baseState=o)}var cf={enqueueSetState:function(n,s,o){n=n._reactInternals;var h=Si(),g=Or(h);g.payload=s,o!=null&&(g.callback=o),s=Nr(n,g,h),s!==null&&(li(s,n,h),Vl(s,n,h))},enqueueReplaceState:function(n,s,o){n=n._reactInternals;var h=Si(),g=Or(h);g.tag=1,g.payload=s,o!=null&&(g.callback=o),s=Nr(n,g,h),s!==null&&(li(s,n,h),Vl(s,n,h))},enqueueForceUpdate:function(n,s){n=n._reactInternals;var o=Si(),h=Or(o);h.tag=2,s!=null&&(h.callback=s),s=Nr(n,h,o),s!==null&&(li(s,n,o),Vl(s,n,o))}};function Zg(n,s,o,h,g,b,T){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(h,b,T):s.prototype&&s.prototype.isPureReactComponent?!m(o,h)||!m(g,b):!0}function Jg(n,s,o,h){n=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(o,h),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(o,h),s.state!==n&&cf.enqueueReplaceState(s,s.state,null)}function Pa(n,s){var o=s;if("ref"in s){o={};for(var h in s)h!=="ref"&&(o[h]=s[h])}if(n=n.defaultProps){o===s&&(o=y({},o));for(var g in n)o[g]===void 0&&(o[g]=n[g])}return o}function ty(n){Ht(n)}function ey(n){console.error(n)}function ny(n){Ht(n)}function ku(n,s){try{var o=n.onUncaughtError;o(s.value,{componentStack:s.stack})}catch(h){setTimeout(function(){throw h})}}function iy(n,s,o){try{var h=n.onCaughtError;h(o.value,{componentStack:o.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function uf(n,s,o){return o=Or(o),o.tag=3,o.payload={element:null},o.callback=function(){ku(n,s)},o}function sy(n){return n=Or(n),n.tag=3,n}function ry(n,s,o,h){var g=o.type.getDerivedStateFromError;if(typeof g=="function"){var b=h.value;n.payload=function(){return g(b)},n.callback=function(){iy(s,o,h)}}var T=o.stateNode;T!==null&&typeof T.componentDidCatch=="function"&&(n.callback=function(){iy(s,o,h),typeof g!="function"&&(Fr===null?Fr=new Set([this]):Fr.add(this));var N=h.stack;this.componentDidCatch(h.value,{componentStack:N!==null?N:""})})}function x1(n,s,o,h,g){if(o.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(s=o.alternate,s!==null&&Ro(s,o,g,!0),o=vi.current,o!==null){switch(o.tag){case 31:case 13:return Fi===null?$u():o.alternate===null&&Je===0&&(Je=3),o.flags&=-257,o.flags|=65536,o.lanes=g,h===wu?o.flags|=16384:(s=o.updateQueue,s===null?o.updateQueue=new Set([h]):s.add(h),Pf(n,h,g)),!1;case 22:return o.flags|=65536,h===wu?o.flags|=16384:(s=o.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([h])},o.updateQueue=s):(o=s.retryQueue,o===null?s.retryQueue=new Set([h]):o.add(h)),Pf(n,h,g)),!1}throw Error(i(435,o.tag))}return Pf(n,h,g),$u(),!1}if(ye)return s=vi.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=g,h!==Rd&&(n=Error(i(422),{cause:h}),zl(Li(n,o)))):(h!==Rd&&(s=Error(i(423),{cause:h}),zl(Li(s,o))),n=n.current.alternate,n.flags|=65536,g&=-g,n.lanes|=g,h=Li(h,o),g=uf(n.stateNode,h,g),Id(n,g),Je!==4&&(Je=2)),!1;var b=Error(i(520),{cause:h});if(b=Li(b,o),ac===null?ac=[b]:ac.push(b),Je!==4&&(Je=2),s===null)return!0;h=Li(h,o),o=s;do{switch(o.tag){case 3:return o.flags|=65536,n=g&-g,o.lanes|=n,n=uf(o.stateNode,h,n),Id(o,n),!1;case 1:if(s=o.type,b=o.stateNode,(o.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(Fr===null||!Fr.has(b))))return o.flags|=65536,g&=-g,o.lanes|=g,g=sy(g),ry(g,n,o,h),Id(o,g),!1}o=o.return}while(o!==null);return!1}var hf=Error(i(461)),pn=!1;function Pn(n,s,o,h){s.child=n===null?cg(s,null,o,h):ka(s,n.child,o,h)}function ay(n,s,o,h,g){o=o.render;var b=s.ref;if("ref"in h){var T={};for(var N in h)N!=="ref"&&(T[N]=h[N])}else T=h;return Ma(s),h=$d(n,s,o,T,b,g),N=Vd(),n!==null&&!pn?(Kd(n,s,g),Ys(n,s,g)):(ye&&N&&Cd(s),s.flags|=1,Pn(n,s,h,g),s.child)}function oy(n,s,o,h,g){if(n===null){var b=o.type;return typeof b=="function"&&!Sd(b)&&b.defaultProps===void 0&&o.compare===null?(s.tag=15,s.type=b,ly(n,s,b,h,g)):(n=pu(o.type,null,h,s,s.mode,g),n.ref=s.ref,n.return=s,s.child=n)}if(b=n.child,!vf(n,g)){var T=b.memoizedProps;if(o=o.compare,o=o!==null?o:m,o(T,h)&&n.ref===s.ref)return Ys(n,s,g)}return s.flags|=1,n=qs(b,h),n.ref=s.ref,n.return=s,s.child=n}function ly(n,s,o,h,g){if(n!==null){var b=n.memoizedProps;if(m(b,h)&&n.ref===s.ref)if(pn=!1,s.pendingProps=h=b,vf(n,g))(n.flags&131072)!==0&&(pn=!0);else return s.lanes=n.lanes,Ys(n,s,g)}return df(n,s,o,h,g)}function cy(n,s,o,h){var g=h.children,b=n!==null?n.memoizedState:null;if(n===null&&s.stateNode===null&&(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),h.mode==="hidden"){if((s.flags&128)!==0){if(b=b!==null?b.baseLanes|o:o,n!==null){for(h=s.child=n.child,g=0;h!==null;)g=g|h.lanes|h.childLanes,h=h.sibling;h=g&~b}else h=0,s.child=null;return uy(n,s,b,o,h)}if((o&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},n!==null&&bu(s,b!==null?b.cachePool:null),b!==null?dg(s,b):zd(),fg(s);else return h=s.lanes=536870912,uy(n,s,b!==null?b.baseLanes|o:o,o,h)}else b!==null?(bu(s,b.cachePool),dg(s,b),Lr(),s.memoizedState=null):(n!==null&&bu(s,null),zd(),Lr());return Pn(n,s,g,o),s.child}function Jl(n,s){return n!==null&&n.tag===22||s.stateNode!==null||(s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),s.sibling}function uy(n,s,o,h,g){var b=Pd();return b=b===null?null:{parent:dn._currentValue,pool:b},s.memoizedState={baseLanes:o,cachePool:b},n!==null&&bu(s,null),zd(),fg(s),n!==null&&Ro(n,s,h,!0),s.childLanes=g,null}function Lu(n,s){return s=Bu({mode:s.mode,children:s.children},n.mode),s.ref=n.ref,n.child=s,s.return=n,s}function hy(n,s,o){return ka(s,n.child,null,o),n=Lu(s,s.pendingProps),n.flags|=2,wi(s),s.memoizedState=null,n}function A1(n,s,o){var h=s.pendingProps,g=(s.flags&128)!==0;if(s.flags&=-129,n===null){if(ye){if(h.mode==="hidden")return n=Lu(s,h),s.lanes=536870912,Jl(null,n);if(qd(s),(n=Ge)?(n=Sb(n,ji),n=n!==null&&n.data==="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Cr!==null?{id:ps,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},o=Xm(n),o.return=s,s.child=o,kn=s,Ge=null)):n=null,n===null)throw Rr(s);return s.lanes=536870912,null}return Lu(s,h)}var b=n.memoizedState;if(b!==null){var T=b.dehydrated;if(qd(s),g)if(s.flags&256)s.flags&=-257,s=hy(n,s,o);else if(s.memoizedState!==null)s.child=n.child,s.flags|=128,s=null;else throw Error(i(558));else if(pn||Ro(n,s,o,!1),g=(o&n.childLanes)!==0,pn||g){if(h=Ue,h!==null&&(T=nn(h,o),T!==0&&T!==b.retryLane))throw b.retryLane=T,De(n,T),li(h,n,T),hf;$u(),s=hy(n,s,o)}else n=b.treeContext,Ge=Ii(T.nextSibling),kn=s,ye=!0,Tr=null,ji=!1,n!==null&&Wm(s,n),s=Lu(s,h),s.flags|=4096;return s}return n=qs(n.child,{mode:h.mode,children:h.children}),n.ref=s.ref,s.child=n,n.return=s,n}function Pu(n,s){var o=s.ref;if(o===null)n!==null&&n.ref!==null&&(s.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(i(284));(n===null||n.ref!==o)&&(s.flags|=4194816)}}function df(n,s,o,h,g){return Ma(s),o=$d(n,s,o,h,void 0,g),h=Vd(),n!==null&&!pn?(Kd(n,s,g),Ys(n,s,g)):(ye&&h&&Cd(s),s.flags|=1,Pn(n,s,o,g),s.child)}function dy(n,s,o,h,g,b){return Ma(s),s.updateQueue=null,o=mg(s,h,o,g),pg(n),h=Vd(),n!==null&&!pn?(Kd(n,s,b),Ys(n,s,b)):(ye&&h&&Cd(s),s.flags|=1,Pn(n,s,o,b),s.child)}function fy(n,s,o,h,g){if(Ma(s),s.stateNode===null){var b=Eo,T=o.contextType;typeof T=="object"&&T!==null&&(b=Ln(T)),b=new o(h,b),s.memoizedState=b.state!==null&&b.state!==void 0?b.state:null,b.updater=cf,s.stateNode=b,b._reactInternals=s,b=s.stateNode,b.props=h,b.state=s.memoizedState,b.refs={},jd(s),T=o.contextType,b.context=typeof T=="object"&&T!==null?Ln(T):Eo,b.state=s.memoizedState,T=o.getDerivedStateFromProps,typeof T=="function"&&(lf(s,o,T,h),b.state=s.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof b.getSnapshotBeforeUpdate=="function"||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(T=b.state,typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount(),T!==b.state&&cf.enqueueReplaceState(b,b.state,null),Xl(s,h,b,g),Kl(),b.state=s.memoizedState),typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!0}else if(n===null){b=s.stateNode;var N=s.memoizedProps,q=Pa(o,N);b.props=q;var at=b.context,yt=o.contextType;T=Eo,typeof yt=="object"&&yt!==null&&(T=Ln(yt));var vt=o.getDerivedStateFromProps;yt=typeof vt=="function"||typeof b.getSnapshotBeforeUpdate=="function",N=s.pendingProps!==N,yt||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(N||at!==T)&&Jg(s,b,h,T),Dr=!1;var lt=s.memoizedState;b.state=lt,Xl(s,h,b,g),Kl(),at=s.memoizedState,N||lt!==at||Dr?(typeof vt=="function"&&(lf(s,o,vt,h),at=s.memoizedState),(q=Dr||Zg(s,o,q,h,lt,at,T))?(yt||typeof b.UNSAFE_componentWillMount!="function"&&typeof b.componentWillMount!="function"||(typeof b.componentWillMount=="function"&&b.componentWillMount(),typeof b.UNSAFE_componentWillMount=="function"&&b.UNSAFE_componentWillMount()),typeof b.componentDidMount=="function"&&(s.flags|=4194308)):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=h,s.memoizedState=at),b.props=h,b.state=at,b.context=T,h=q):(typeof b.componentDidMount=="function"&&(s.flags|=4194308),h=!1)}else{b=s.stateNode,Fd(n,s),T=s.memoizedProps,yt=Pa(o,T),b.props=yt,vt=s.pendingProps,lt=b.context,at=o.contextType,q=Eo,typeof at=="object"&&at!==null&&(q=Ln(at)),N=o.getDerivedStateFromProps,(at=typeof N=="function"||typeof b.getSnapshotBeforeUpdate=="function")||typeof b.UNSAFE_componentWillReceiveProps!="function"&&typeof b.componentWillReceiveProps!="function"||(T!==vt||lt!==q)&&Jg(s,b,h,q),Dr=!1,lt=s.memoizedState,b.state=lt,Xl(s,h,b,g),Kl();var dt=s.memoizedState;T!==vt||lt!==dt||Dr||n!==null&&n.dependencies!==null&&gu(n.dependencies)?(typeof N=="function"&&(lf(s,o,N,h),dt=s.memoizedState),(yt=Dr||Zg(s,o,yt,h,lt,dt,q)||n!==null&&n.dependencies!==null&&gu(n.dependencies))?(at||typeof b.UNSAFE_componentWillUpdate!="function"&&typeof b.componentWillUpdate!="function"||(typeof b.componentWillUpdate=="function"&&b.componentWillUpdate(h,dt,q),typeof b.UNSAFE_componentWillUpdate=="function"&&b.UNSAFE_componentWillUpdate(h,dt,q)),typeof b.componentDidUpdate=="function"&&(s.flags|=4),typeof b.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),s.memoizedProps=h,s.memoizedState=dt),b.props=h,b.state=dt,b.context=q,h=yt):(typeof b.componentDidUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=4),typeof b.getSnapshotBeforeUpdate!="function"||T===n.memoizedProps&&lt===n.memoizedState||(s.flags|=1024),h=!1)}return b=h,Pu(n,s),h=(s.flags&128)!==0,b||h?(b=s.stateNode,o=h&&typeof o.getDerivedStateFromError!="function"?null:b.render(),s.flags|=1,n!==null&&h?(s.child=ka(s,n.child,null,g),s.child=ka(s,null,o,g)):Pn(n,s,o,g),s.memoizedState=b.state,n=s.child):n=Ys(n,s,g),n}function py(n,s,o,h){return Ta(),s.flags|=256,Pn(n,s,o,h),s.child}var ff={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function pf(n){return{baseLanes:n,cachePool:ig()}}function mf(n,s,o){return n=n!==null?n.childLanes&~o:0,s&&(n|=Ai),n}function my(n,s,o){var h=s.pendingProps,g=!1,b=(s.flags&128)!==0,T;if((T=b)||(T=n!==null&&n.memoizedState===null?!1:(an.current&2)!==0),T&&(g=!0,s.flags&=-129),T=(s.flags&32)!==0,s.flags&=-33,n===null){if(ye){if(g?kr(s):Lr(),(n=Ge)?(n=Sb(n,ji),n=n!==null&&n.data!=="&"?n:null,n!==null&&(s.memoizedState={dehydrated:n,treeContext:Cr!==null?{id:ps,overflow:ms}:null,retryLane:536870912,hydrationErrors:null},o=Xm(n),o.return=s,s.child=o,kn=s,Ge=null)):n=null,n===null)throw Rr(s);return Wf(n)?s.lanes=32:s.lanes=536870912,null}var N=h.children;return h=h.fallback,g?(Lr(),g=s.mode,N=Bu({mode:"hidden",children:N},g),h=Ca(h,g,o,null),N.return=s,h.return=s,N.sibling=h,s.child=N,h=s.child,h.memoizedState=pf(o),h.childLanes=mf(n,T,o),s.memoizedState=ff,Jl(null,h)):(kr(s),gf(s,N))}var q=n.memoizedState;if(q!==null&&(N=q.dehydrated,N!==null)){if(b)s.flags&256?(kr(s),s.flags&=-257,s=yf(n,s,o)):s.memoizedState!==null?(Lr(),s.child=n.child,s.flags|=128,s=null):(Lr(),N=h.fallback,g=s.mode,h=Bu({mode:"visible",children:h.children},g),N=Ca(N,g,o,null),N.flags|=2,h.return=s,N.return=s,h.sibling=N,s.child=h,ka(s,n.child,null,o),h=s.child,h.memoizedState=pf(o),h.childLanes=mf(n,T,o),s.memoizedState=ff,s=Jl(null,h));else if(kr(s),Wf(N)){if(T=N.nextSibling&&N.nextSibling.dataset,T)var at=T.dgst;T=at,h=Error(i(419)),h.stack="",h.digest=T,zl({value:h,source:null,stack:null}),s=yf(n,s,o)}else if(pn||Ro(n,s,o,!1),T=(o&n.childLanes)!==0,pn||T){if(T=Ue,T!==null&&(h=nn(T,o),h!==0&&h!==q.retryLane))throw q.retryLane=h,De(n,h),li(T,n,h),hf;Qf(N)||$u(),s=yf(n,s,o)}else Qf(N)?(s.flags|=192,s.child=n.child,s=null):(n=q.treeContext,Ge=Ii(N.nextSibling),kn=s,ye=!0,Tr=null,ji=!1,n!==null&&Wm(s,n),s=gf(s,h.children),s.flags|=4096);return s}return g?(Lr(),N=h.fallback,g=s.mode,q=n.child,at=q.sibling,h=qs(q,{mode:"hidden",children:h.children}),h.subtreeFlags=q.subtreeFlags&65011712,at!==null?N=qs(at,N):(N=Ca(N,g,o,null),N.flags|=2),N.return=s,h.return=s,h.sibling=N,s.child=h,Jl(null,h),h=s.child,N=n.child.memoizedState,N===null?N=pf(o):(g=N.cachePool,g!==null?(q=dn._currentValue,g=g.parent!==q?{parent:q,pool:q}:g):g=ig(),N={baseLanes:N.baseLanes|o,cachePool:g}),h.memoizedState=N,h.childLanes=mf(n,T,o),s.memoizedState=ff,Jl(n.child,h)):(kr(s),o=n.child,n=o.sibling,o=qs(o,{mode:"visible",children:h.children}),o.return=s,o.sibling=null,n!==null&&(T=s.deletions,T===null?(s.deletions=[n],s.flags|=16):T.push(n)),s.child=o,s.memoizedState=null,o)}function gf(n,s){return s=Bu({mode:"visible",children:s},n.mode),s.return=n,n.child=s}function Bu(n,s){return n=bi(22,n,null,s),n.lanes=0,n}function yf(n,s,o){return ka(s,n.child,null,o),n=gf(s,s.pendingProps.children),n.flags|=2,s.memoizedState=null,n}function gy(n,s,o){n.lanes|=s;var h=n.alternate;h!==null&&(h.lanes|=s),Od(n.return,s,o)}function bf(n,s,o,h,g,b){var T=n.memoizedState;T===null?n.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:h,tail:o,tailMode:g,treeForkCount:b}:(T.isBackwards=s,T.rendering=null,T.renderingStartTime=0,T.last=h,T.tail=o,T.tailMode=g,T.treeForkCount=b)}function yy(n,s,o){var h=s.pendingProps,g=h.revealOrder,b=h.tail;h=h.children;var T=an.current,N=(T&2)!==0;if(N?(T=T&1|2,s.flags|=128):T&=1,mt(an,T),Pn(n,s,h,o),h=ye?Ul:0,!N&&n!==null&&(n.flags&128)!==0)t:for(n=s.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&gy(n,o,s);else if(n.tag===19)gy(n,o,s);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===s)break t;for(;n.sibling===null;){if(n.return===null||n.return===s)break t;n=n.return}n.sibling.return=n.return,n=n.sibling}switch(g){case"forwards":for(o=s.child,g=null;o!==null;)n=o.alternate,n!==null&&Eu(n)===null&&(g=o),o=o.sibling;o=g,o===null?(g=s.child,s.child=null):(g=o.sibling,o.sibling=null),bf(s,!1,g,o,b,h);break;case"backwards":case"unstable_legacy-backwards":for(o=null,g=s.child,s.child=null;g!==null;){if(n=g.alternate,n!==null&&Eu(n)===null){s.child=g;break}n=g.sibling,g.sibling=o,o=g,g=n}bf(s,!0,o,null,b,h);break;case"together":bf(s,!1,null,null,void 0,h);break;default:s.memoizedState=null}return s.child}function Ys(n,s,o){if(n!==null&&(s.dependencies=n.dependencies),jr|=s.lanes,(o&s.childLanes)===0)if(n!==null){if(Ro(n,s,o,!1),(o&s.childLanes)===0)return null}else return null;if(n!==null&&s.child!==n.child)throw Error(i(153));if(s.child!==null){for(n=s.child,o=qs(n,n.pendingProps),s.child=o,o.return=s;n.sibling!==null;)n=n.sibling,o=o.sibling=qs(n,n.pendingProps),o.return=s;o.sibling=null}return s.child}function vf(n,s){return(n.lanes&s)!==0?!0:(n=n.dependencies,!!(n!==null&&gu(n)))}function S1(n,s,o){switch(s.tag){case 3:Rt(s,s.stateNode.containerInfo),Mr(s,dn,n.memoizedState.cache),Ta();break;case 27:case 5:kt(s);break;case 4:Rt(s,s.stateNode.containerInfo);break;case 10:Mr(s,s.type,s.memoizedProps.value);break;case 31:if(s.memoizedState!==null)return s.flags|=128,qd(s),null;break;case 13:var h=s.memoizedState;if(h!==null)return h.dehydrated!==null?(kr(s),s.flags|=128,null):(o&s.child.childLanes)!==0?my(n,s,o):(kr(s),n=Ys(n,s,o),n!==null?n.sibling:null);kr(s);break;case 19:var g=(n.flags&128)!==0;if(h=(o&s.childLanes)!==0,h||(Ro(n,s,o,!1),h=(o&s.childLanes)!==0),g){if(h)return yy(n,s,o);s.flags|=128}if(g=s.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),mt(an,an.current),h)break;return null;case 22:return s.lanes=0,cy(n,s,o,s.pendingProps);case 24:Mr(s,dn,n.memoizedState.cache)}return Ys(n,s,o)}function by(n,s,o){if(n!==null)if(n.memoizedProps!==s.pendingProps)pn=!0;else{if(!vf(n,o)&&(s.flags&128)===0)return pn=!1,S1(n,s,o);pn=(n.flags&131072)!==0}else pn=!1,ye&&(s.flags&1048576)!==0&&Qm(s,Ul,s.index);switch(s.lanes=0,s.tag){case 16:t:{var h=s.pendingProps;if(n=Oa(s.elementType),s.type=n,typeof n=="function")Sd(n)?(h=Pa(n,h),s.tag=1,s=fy(null,s,n,h,o)):(s.tag=0,s=df(null,s,n,h,o));else{if(n!=null){var g=n.$$typeof;if(g===j){s.tag=11,s=ay(null,s,n,h,o);break t}else if(g===H){s.tag=14,s=oy(null,s,n,h,o);break t}}throw s=Bt(n)||n,Error(i(306,s,""))}}return s;case 0:return df(n,s,s.type,s.pendingProps,o);case 1:return h=s.type,g=Pa(h,s.pendingProps),fy(n,s,h,g,o);case 3:t:{if(Rt(s,s.stateNode.containerInfo),n===null)throw Error(i(387));h=s.pendingProps;var b=s.memoizedState;g=b.element,Fd(n,s),Xl(s,h,null,o);var T=s.memoizedState;if(h=T.cache,Mr(s,dn,h),h!==b.cache&&Nd(s,[dn],o,!0),Kl(),h=T.element,b.isDehydrated)if(b={element:h,isDehydrated:!1,cache:T.cache},s.updateQueue.baseState=b,s.memoizedState=b,s.flags&256){s=py(n,s,h,o);break t}else if(h!==g){g=Li(Error(i(424)),s),zl(g),s=py(n,s,h,o);break t}else for(n=s.stateNode.containerInfo,n.nodeType===9?n=n.body:n=n.nodeName==="HTML"?n.ownerDocument.body:n,Ge=Ii(n.firstChild),kn=s,ye=!0,Tr=null,ji=!0,o=cg(s,null,h,o),s.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling;else{if(Ta(),h===g){s=Ys(n,s,o);break t}Pn(n,s,h,o)}s=s.child}return s;case 26:return Pu(n,s),n===null?(o=Mb(s.type,null,s.pendingProps,null))?s.memoizedState=o:ye||(o=s.type,n=s.pendingProps,h=Zu(Ut.current).createElement(o),h[ze]=s,h[sn]=n,Bn(h,o,n),rn(h),s.stateNode=h):s.memoizedState=Mb(s.type,n.memoizedProps,s.pendingProps,n.memoizedState),null;case 27:return kt(s),n===null&&ye&&(h=s.stateNode=Cb(s.type,s.pendingProps,Ut.current),kn=s,ji=!0,g=Ge,Hr(s.type)?(Zf=g,Ge=Ii(h.firstChild)):Ge=g),Pn(n,s,s.pendingProps.children,o),Pu(n,s),n===null&&(s.flags|=4194304),s.child;case 5:return n===null&&ye&&((g=h=Ge)&&(h=J1(h,s.type,s.pendingProps,ji),h!==null?(s.stateNode=h,kn=s,Ge=Ii(h.firstChild),ji=!1,g=!0):g=!1),g||Rr(s)),kt(s),g=s.type,b=s.pendingProps,T=n!==null?n.memoizedProps:null,h=b.children,Kf(g,b)?h=null:T!==null&&Kf(g,T)&&(s.flags|=32),s.memoizedState!==null&&(g=$d(n,s,p1,null,null,o),pc._currentValue=g),Pu(n,s),Pn(n,s,h,o),s.child;case 6:return n===null&&ye&&((n=o=Ge)&&(o=tx(o,s.pendingProps,ji),o!==null?(s.stateNode=o,kn=s,Ge=null,n=!0):n=!1),n||Rr(s)),null;case 13:return my(n,s,o);case 4:return Rt(s,s.stateNode.containerInfo),h=s.pendingProps,n===null?s.child=ka(s,null,h,o):Pn(n,s,h,o),s.child;case 11:return ay(n,s,s.type,s.pendingProps,o);case 7:return Pn(n,s,s.pendingProps,o),s.child;case 8:return Pn(n,s,s.pendingProps.children,o),s.child;case 12:return Pn(n,s,s.pendingProps.children,o),s.child;case 10:return h=s.pendingProps,Mr(s,s.type,h.value),Pn(n,s,h.children,o),s.child;case 9:return g=s.type._context,h=s.pendingProps.children,Ma(s),g=Ln(g),h=h(g),s.flags|=1,Pn(n,s,h,o),s.child;case 14:return oy(n,s,s.type,s.pendingProps,o);case 15:return ly(n,s,s.type,s.pendingProps,o);case 19:return yy(n,s,o);case 31:return A1(n,s,o);case 22:return cy(n,s,o,s.pendingProps);case 24:return Ma(s),h=Ln(dn),n===null?(g=Pd(),g===null&&(g=Ue,b=kd(),g.pooledCache=b,b.refCount++,b!==null&&(g.pooledCacheLanes|=o),g=b),s.memoizedState={parent:h,cache:g},jd(s),Mr(s,dn,g)):((n.lanes&o)!==0&&(Fd(n,s),Xl(s,null,null,o),Kl()),g=n.memoizedState,b=s.memoizedState,g.parent!==h?(g={parent:h,cache:h},s.memoizedState=g,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=g),Mr(s,dn,h)):(h=b.cache,Mr(s,dn,h),h!==g.cache&&Nd(s,[dn],o,!0))),Pn(n,s,s.pendingProps.children,o),s.child;case 29:throw s.pendingProps}throw Error(i(156,s.tag))}function Qs(n){n.flags|=4}function wf(n,s,o,h,g){if((s=(n.mode&32)!==0)&&(s=!1),s){if(n.flags|=16777216,(g&335544128)===g)if(n.stateNode.complete)n.flags|=8192;else if($y())n.flags|=8192;else throw Na=wu,Bd}else n.flags&=-16777217}function vy(n,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!Lb(s))if($y())n.flags|=8192;else throw Na=wu,Bd}function ju(n,s){s!==null&&(n.flags|=4),n.flags&16384&&(s=n.tag!==22?Jc():536870912,n.lanes|=s,Uo|=s)}function tc(n,s){if(!ye)switch(n.tailMode){case"hidden":s=n.tail;for(var o=null;s!==null;)s.alternate!==null&&(o=s),s=s.sibling;o===null?n.tail=null:o.sibling=null;break;case"collapsed":o=n.tail;for(var h=null;o!==null;)o.alternate!==null&&(h=o),o=o.sibling;h===null?s||n.tail===null?n.tail=null:n.tail.sibling=null:h.sibling=null}}function $e(n){var s=n.alternate!==null&&n.alternate.child===n.child,o=0,h=0;if(s)for(var g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=n,g=g.sibling;else for(g=n.child;g!==null;)o|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=n,g=g.sibling;return n.subtreeFlags|=h,n.childLanes=o,s}function E1(n,s,o){var h=s.pendingProps;switch(Td(s),s.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $e(s),null;case 1:return $e(s),null;case 3:return o=s.stateNode,h=null,n!==null&&(h=n.memoizedState.cache),s.memoizedState.cache!==h&&(s.flags|=2048),Vs(dn),jt(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(n===null||n.child===null)&&(To(s)?Qs(s):n===null||n.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,Md())),$e(s),null;case 26:var g=s.type,b=s.memoizedState;return n===null?(Qs(s),b!==null?($e(s),vy(s,b)):($e(s),wf(s,g,null,h,o))):b?b!==n.memoizedState?(Qs(s),$e(s),vy(s,b)):($e(s),s.flags&=-16777217):(n=n.memoizedProps,n!==h&&Qs(s),$e(s),wf(s,g,n,h,o)),null;case 27:if(we(s),o=Ut.current,g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Qs(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return $e(s),null}n=xt.current,To(s)?Zm(s):(n=Cb(g,h,o),s.stateNode=n,Qs(s))}return $e(s),null;case 5:if(we(s),g=s.type,n!==null&&s.stateNode!=null)n.memoizedProps!==h&&Qs(s);else{if(!h){if(s.stateNode===null)throw Error(i(166));return $e(s),null}if(b=xt.current,To(s))Zm(s);else{var T=Zu(Ut.current);switch(b){case 1:b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case 2:b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;default:switch(g){case"svg":b=T.createElementNS("http://www.w3.org/2000/svg",g);break;case"math":b=T.createElementNS("http://www.w3.org/1998/Math/MathML",g);break;case"script":b=T.createElement("div"),b.innerHTML="<script><\/script>",b=b.removeChild(b.firstChild);break;case"select":b=typeof h.is=="string"?T.createElement("select",{is:h.is}):T.createElement("select"),h.multiple?b.multiple=!0:h.size&&(b.size=h.size);break;default:b=typeof h.is=="string"?T.createElement(g,{is:h.is}):T.createElement(g)}}b[ze]=s,b[sn]=h;t:for(T=s.child;T!==null;){if(T.tag===5||T.tag===6)b.appendChild(T.stateNode);else if(T.tag!==4&&T.tag!==27&&T.child!==null){T.child.return=T,T=T.child;continue}if(T===s)break t;for(;T.sibling===null;){if(T.return===null||T.return===s)break t;T=T.return}T.sibling.return=T.return,T=T.sibling}s.stateNode=b;t:switch(Bn(b,g,h),g){case"button":case"input":case"select":case"textarea":h=!!h.autoFocus;break t;case"img":h=!0;break t;default:h=!1}h&&Qs(s)}}return $e(s),wf(s,s.type,n===null?null:n.memoizedProps,s.pendingProps,o),null;case 6:if(n&&s.stateNode!=null)n.memoizedProps!==h&&Qs(s);else{if(typeof h!="string"&&s.stateNode===null)throw Error(i(166));if(n=Ut.current,To(s)){if(n=s.stateNode,o=s.memoizedProps,h=null,g=kn,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}n[ze]=s,n=!!(n.nodeValue===o||h!==null&&h.suppressHydrationWarning===!0||mb(n.nodeValue,o)),n||Rr(s,!0)}else n=Zu(n).createTextNode(h),n[ze]=s,s.stateNode=n}return $e(s),null;case 31:if(o=s.memoizedState,n===null||n.memoizedState!==null){if(h=To(s),o!==null){if(n===null){if(!h)throw Error(i(318));if(n=s.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(i(557));n[ze]=s}else Ta(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;$e(s),n=!1}else o=Md(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=o),n=!0;if(!n)return s.flags&256?(wi(s),s):(wi(s),null);if((s.flags&128)!==0)throw Error(i(558))}return $e(s),null;case 13:if(h=s.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(g=To(s),h!==null&&h.dehydrated!==null){if(n===null){if(!g)throw Error(i(318));if(g=s.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(i(317));g[ze]=s}else Ta(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;$e(s),g=!1}else g=Md(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=g),g=!0;if(!g)return s.flags&256?(wi(s),s):(wi(s),null)}return wi(s),(s.flags&128)!==0?(s.lanes=o,s):(o=h!==null,n=n!==null&&n.memoizedState!==null,o&&(h=s.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool),b=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(b=h.memoizedState.cachePool.pool),b!==g&&(h.flags|=2048)),o!==n&&o&&(s.child.flags|=8192),ju(s,s.updateQueue),$e(s),null);case 4:return jt(),n===null&&Hf(s.stateNode.containerInfo),$e(s),null;case 10:return Vs(s.type),$e(s),null;case 19:if(J(an),h=s.memoizedState,h===null)return $e(s),null;if(g=(s.flags&128)!==0,b=h.rendering,b===null)if(g)tc(h,!1);else{if(Je!==0||n!==null&&(n.flags&128)!==0)for(n=s.child;n!==null;){if(b=Eu(n),b!==null){for(s.flags|=128,tc(h,!1),n=b.updateQueue,s.updateQueue=n,ju(s,n),s.subtreeFlags=0,n=o,o=s.child;o!==null;)Km(o,n),o=o.sibling;return mt(an,an.current&1|2),ye&&Gs(s,h.treeForkCount),s.child}n=n.sibling}h.tail!==null&&zn()>Hu&&(s.flags|=128,g=!0,tc(h,!1),s.lanes=4194304)}else{if(!g)if(n=Eu(b),n!==null){if(s.flags|=128,g=!0,n=n.updateQueue,s.updateQueue=n,ju(s,n),tc(h,!0),h.tail===null&&h.tailMode==="hidden"&&!b.alternate&&!ye)return $e(s),null}else 2*zn()-h.renderingStartTime>Hu&&o!==536870912&&(s.flags|=128,g=!0,tc(h,!1),s.lanes=4194304);h.isBackwards?(b.sibling=s.child,s.child=b):(n=h.last,n!==null?n.sibling=b:s.child=b,h.last=b)}return h.tail!==null?(n=h.tail,h.rendering=n,h.tail=n.sibling,h.renderingStartTime=zn(),n.sibling=null,o=an.current,mt(an,g?o&1|2:o&1),ye&&Gs(s,h.treeForkCount),n):($e(s),null);case 22:case 23:return wi(s),Hd(),h=s.memoizedState!==null,n!==null?n.memoizedState!==null!==h&&(s.flags|=8192):h&&(s.flags|=8192),h?(o&536870912)!==0&&(s.flags&128)===0&&($e(s),s.subtreeFlags&6&&(s.flags|=8192)):$e(s),o=s.updateQueue,o!==null&&ju(s,o.retryQueue),o=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),h=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(h=s.memoizedState.cachePool.pool),h!==o&&(s.flags|=2048),n!==null&&J(Da),null;case 24:return o=null,n!==null&&(o=n.memoizedState.cache),s.memoizedState.cache!==o&&(s.flags|=2048),Vs(dn),$e(s),null;case 25:return null;case 30:return null}throw Error(i(156,s.tag))}function _1(n,s){switch(Td(s),s.tag){case 1:return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 3:return Vs(dn),jt(),n=s.flags,(n&65536)!==0&&(n&128)===0?(s.flags=n&-65537|128,s):null;case 26:case 27:case 5:return we(s),null;case 31:if(s.memoizedState!==null){if(wi(s),s.alternate===null)throw Error(i(340));Ta()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 13:if(wi(s),n=s.memoizedState,n!==null&&n.dehydrated!==null){if(s.alternate===null)throw Error(i(340));Ta()}return n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 19:return J(an),null;case 4:return jt(),null;case 10:return Vs(s.type),null;case 22:case 23:return wi(s),Hd(),n!==null&&J(Da),n=s.flags,n&65536?(s.flags=n&-65537|128,s):null;case 24:return Vs(dn),null;case 25:return null;default:return null}}function wy(n,s){switch(Td(s),s.tag){case 3:Vs(dn),jt();break;case 26:case 27:case 5:we(s);break;case 4:jt();break;case 31:s.memoizedState!==null&&wi(s);break;case 13:wi(s);break;case 19:J(an);break;case 10:Vs(s.type);break;case 22:case 23:wi(s),Hd(),n!==null&&J(Da);break;case 24:Vs(dn)}}function ec(n,s){try{var o=s.updateQueue,h=o!==null?o.lastEffect:null;if(h!==null){var g=h.next;o=g;do{if((o.tag&n)===n){h=void 0;var b=o.create,T=o.inst;h=b(),T.destroy=h}o=o.next}while(o!==g)}}catch(N){Ne(s,s.return,N)}}function Pr(n,s,o){try{var h=s.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var b=g.next;h=b;do{if((h.tag&n)===n){var T=h.inst,N=T.destroy;if(N!==void 0){T.destroy=void 0,g=s;var q=o,at=N;try{at()}catch(yt){Ne(g,q,yt)}}}h=h.next}while(h!==b)}}catch(yt){Ne(s,s.return,yt)}}function xy(n){var s=n.updateQueue;if(s!==null){var o=n.stateNode;try{hg(s,o)}catch(h){Ne(n,n.return,h)}}}function Ay(n,s,o){o.props=Pa(n.type,n.memoizedProps),o.state=n.memoizedState;try{o.componentWillUnmount()}catch(h){Ne(n,s,h)}}function nc(n,s){try{var o=n.ref;if(o!==null){switch(n.tag){case 26:case 27:case 5:var h=n.stateNode;break;case 30:h=n.stateNode;break;default:h=n.stateNode}typeof o=="function"?n.refCleanup=o(h):o.current=h}}catch(g){Ne(n,s,g)}}function gs(n,s){var o=n.ref,h=n.refCleanup;if(o!==null)if(typeof h=="function")try{h()}catch(g){Ne(n,s,g)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(g){Ne(n,s,g)}else o.current=null}function Sy(n){var s=n.type,o=n.memoizedProps,h=n.stateNode;try{t:switch(s){case"button":case"input":case"select":case"textarea":o.autoFocus&&h.focus();break t;case"img":o.src?h.src=o.src:o.srcSet&&(h.srcset=o.srcSet)}}catch(g){Ne(n,n.return,g)}}function xf(n,s,o){try{var h=n.stateNode;K1(h,n.type,o,s),h[sn]=s}catch(g){Ne(n,n.return,g)}}function Ey(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Hr(n.type)||n.tag===4}function Af(n){t:for(;;){for(;n.sibling===null;){if(n.return===null||Ey(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Hr(n.type)||n.flags&2||n.child===null||n.tag===4)continue t;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Sf(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(n,s):(s=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,s.appendChild(n),o=o._reactRootContainer,o!=null||s.onclick!==null||(s.onclick=ii));else if(h!==4&&(h===27&&Hr(n.type)&&(o=n.stateNode,s=null),n=n.child,n!==null))for(Sf(n,s,o),n=n.sibling;n!==null;)Sf(n,s,o),n=n.sibling}function Fu(n,s,o){var h=n.tag;if(h===5||h===6)n=n.stateNode,s?o.insertBefore(n,s):o.appendChild(n);else if(h!==4&&(h===27&&Hr(n.type)&&(o=n.stateNode),n=n.child,n!==null))for(Fu(n,s,o),n=n.sibling;n!==null;)Fu(n,s,o),n=n.sibling}function _y(n){var s=n.stateNode,o=n.memoizedProps;try{for(var h=n.type,g=s.attributes;g.length;)s.removeAttributeNode(g[0]);Bn(s,h,o),s[ze]=n,s[sn]=o}catch(b){Ne(n,n.return,b)}}var Ws=!1,mn=!1,Ef=!1,Cy=typeof WeakSet=="function"?WeakSet:Set,Cn=null;function C1(n,s){if(n=n.containerInfo,$f=rh,n=R(n),D(n)){if("selectionStart"in n)var o={start:n.selectionStart,end:n.selectionEnd};else t:{o=(o=n.ownerDocument)&&o.defaultView||window;var h=o.getSelection&&o.getSelection();if(h&&h.rangeCount!==0){o=h.anchorNode;var g=h.anchorOffset,b=h.focusNode;h=h.focusOffset;try{o.nodeType,b.nodeType}catch{o=null;break t}var T=0,N=-1,q=-1,at=0,yt=0,vt=n,lt=null;e:for(;;){for(var dt;vt!==o||g!==0&&vt.nodeType!==3||(N=T+g),vt!==b||h!==0&&vt.nodeType!==3||(q=T+h),vt.nodeType===3&&(T+=vt.nodeValue.length),(dt=vt.firstChild)!==null;)lt=vt,vt=dt;for(;;){if(vt===n)break e;if(lt===o&&++at===g&&(N=T),lt===b&&++yt===h&&(q=T),(dt=vt.nextSibling)!==null)break;vt=lt,lt=vt.parentNode}vt=dt}o=N===-1||q===-1?null:{start:N,end:q}}else o=null}o=o||{start:0,end:0}}else o=null;for(Vf={focusedElem:n,selectionRange:o},rh=!1,Cn=s;Cn!==null;)if(s=Cn,n=s.child,(s.subtreeFlags&1028)!==0&&n!==null)n.return=s,Cn=n;else for(;Cn!==null;){switch(s=Cn,b=s.alternate,n=s.flags,s.tag){case 0:if((n&4)!==0&&(n=s.updateQueue,n=n!==null?n.events:null,n!==null))for(o=0;o<n.length;o++)g=n[o],g.ref.impl=g.nextImpl;break;case 11:case 15:break;case 1:if((n&1024)!==0&&b!==null){n=void 0,o=s,g=b.memoizedProps,b=b.memoizedState,h=o.stateNode;try{var $t=Pa(o.type,g);n=h.getSnapshotBeforeUpdate($t,b),h.__reactInternalSnapshotBeforeUpdate=n}catch(Jt){Ne(o,o.return,Jt)}}break;case 3:if((n&1024)!==0){if(n=s.stateNode.containerInfo,o=n.nodeType,o===9)Yf(n);else if(o===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Yf(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(i(163))}if(n=s.sibling,n!==null){n.return=s.return,Cn=n;break}Cn=s.return}}function Ty(n,s,o){var h=o.flags;switch(o.tag){case 0:case 11:case 15:Js(n,o),h&4&&ec(5,o);break;case 1:if(Js(n,o),h&4)if(n=o.stateNode,s===null)try{n.componentDidMount()}catch(T){Ne(o,o.return,T)}else{var g=Pa(o.type,s.memoizedProps);s=s.memoizedState;try{n.componentDidUpdate(g,s,n.__reactInternalSnapshotBeforeUpdate)}catch(T){Ne(o,o.return,T)}}h&64&&xy(o),h&512&&nc(o,o.return);break;case 3:if(Js(n,o),h&64&&(n=o.updateQueue,n!==null)){if(s=null,o.child!==null)switch(o.child.tag){case 27:case 5:s=o.child.stateNode;break;case 1:s=o.child.stateNode}try{hg(n,s)}catch(T){Ne(o,o.return,T)}}break;case 27:s===null&&h&4&&_y(o);case 26:case 5:Js(n,o),s===null&&h&4&&Sy(o),h&512&&nc(o,o.return);break;case 12:Js(n,o);break;case 31:Js(n,o),h&4&&Dy(n,o);break;case 13:Js(n,o),h&4&&Oy(n,o),h&64&&(n=o.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(o=P1.bind(null,o),ex(n,o))));break;case 22:if(h=o.memoizedState!==null||Ws,!h){s=s!==null&&s.memoizedState!==null||mn,g=Ws;var b=mn;Ws=h,(mn=s)&&!b?tr(n,o,(o.subtreeFlags&8772)!==0):Js(n,o),Ws=g,mn=b}break;case 30:break;default:Js(n,o)}}function Ry(n){var s=n.alternate;s!==null&&(n.alternate=null,Ry(s)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(s=n.stateNode,s!==null&&io(s)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var Ve=null,si=!1;function Zs(n,s,o){for(o=o.child;o!==null;)My(n,s,o),o=o.sibling}function My(n,s,o){if(Dn&&typeof Dn.onCommitFiberUnmount=="function")try{Dn.onCommitFiberUnmount(is,o)}catch{}switch(o.tag){case 26:mn||gs(o,s),Zs(n,s,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:mn||gs(o,s);var h=Ve,g=si;Hr(o.type)&&(Ve=o.stateNode,si=!1),Zs(n,s,o),hc(o.stateNode),Ve=h,si=g;break;case 5:mn||gs(o,s);case 6:if(h=Ve,g=si,Ve=null,Zs(n,s,o),Ve=h,si=g,Ve!==null)if(si)try{(Ve.nodeType===9?Ve.body:Ve.nodeName==="HTML"?Ve.ownerDocument.body:Ve).removeChild(o.stateNode)}catch(b){Ne(o,s,b)}else try{Ve.removeChild(o.stateNode)}catch(b){Ne(o,s,b)}break;case 18:Ve!==null&&(si?(n=Ve,xb(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,o.stateNode),Xo(n)):xb(Ve,o.stateNode));break;case 4:h=Ve,g=si,Ve=o.stateNode.containerInfo,si=!0,Zs(n,s,o),Ve=h,si=g;break;case 0:case 11:case 14:case 15:Pr(2,o,s),mn||Pr(4,o,s),Zs(n,s,o);break;case 1:mn||(gs(o,s),h=o.stateNode,typeof h.componentWillUnmount=="function"&&Ay(o,s,h)),Zs(n,s,o);break;case 21:Zs(n,s,o);break;case 22:mn=(h=mn)||o.memoizedState!==null,Zs(n,s,o),mn=h;break;default:Zs(n,s,o)}}function Dy(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null))){n=n.dehydrated;try{Xo(n)}catch(o){Ne(s,s.return,o)}}}function Oy(n,s){if(s.memoizedState===null&&(n=s.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Xo(n)}catch(o){Ne(s,s.return,o)}}function T1(n){switch(n.tag){case 31:case 13:case 19:var s=n.stateNode;return s===null&&(s=n.stateNode=new Cy),s;case 22:return n=n.stateNode,s=n._retryCache,s===null&&(s=n._retryCache=new Cy),s;default:throw Error(i(435,n.tag))}}function Iu(n,s){var o=T1(n);s.forEach(function(h){if(!o.has(h)){o.add(h);var g=B1.bind(null,n,h);h.then(g,g)}})}function ri(n,s){var o=s.deletions;if(o!==null)for(var h=0;h<o.length;h++){var g=o[h],b=n,T=s,N=T;t:for(;N!==null;){switch(N.tag){case 27:if(Hr(N.type)){Ve=N.stateNode,si=!1;break t}break;case 5:Ve=N.stateNode,si=!1;break t;case 3:case 4:Ve=N.stateNode.containerInfo,si=!0;break t}N=N.return}if(Ve===null)throw Error(i(160));My(b,T,g),Ve=null,si=!1,b=g.alternate,b!==null&&(b.return=null),g.return=null}if(s.subtreeFlags&13886)for(s=s.child;s!==null;)Ny(s,n),s=s.sibling}var Qi=null;function Ny(n,s){var o=n.alternate,h=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:ri(s,n),ai(n),h&4&&(Pr(3,n,n.return),ec(3,n),Pr(5,n,n.return));break;case 1:ri(s,n),ai(n),h&512&&(mn||o===null||gs(o,o.return)),h&64&&Ws&&(n=n.updateQueue,n!==null&&(h=n.callbacks,h!==null&&(o=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=o===null?h:o.concat(h))));break;case 26:var g=Qi;if(ri(s,n),ai(n),h&512&&(mn||o===null||gs(o,o.return)),h&4){var b=o!==null?o.memoizedState:null;if(h=n.memoizedState,o===null)if(h===null)if(n.stateNode===null){t:{h=n.type,o=n.memoizedProps,g=g.ownerDocument||g;e:switch(h){case"title":b=g.getElementsByTagName("title")[0],(!b||b[mi]||b[ze]||b.namespaceURI==="http://www.w3.org/2000/svg"||b.hasAttribute("itemprop"))&&(b=g.createElement(h),g.head.insertBefore(b,g.querySelector("head > title"))),Bn(b,h,o),b[ze]=n,rn(b),h=b;break t;case"link":var T=Nb("link","href",g).get(h+(o.href||""));if(T){for(var N=0;N<T.length;N++)if(b=T[N],b.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&b.getAttribute("rel")===(o.rel==null?null:o.rel)&&b.getAttribute("title")===(o.title==null?null:o.title)&&b.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){T.splice(N,1);break e}}b=g.createElement(h),Bn(b,h,o),g.head.appendChild(b);break;case"meta":if(T=Nb("meta","content",g).get(h+(o.content||""))){for(N=0;N<T.length;N++)if(b=T[N],b.getAttribute("content")===(o.content==null?null:""+o.content)&&b.getAttribute("name")===(o.name==null?null:o.name)&&b.getAttribute("property")===(o.property==null?null:o.property)&&b.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&b.getAttribute("charset")===(o.charSet==null?null:o.charSet)){T.splice(N,1);break e}}b=g.createElement(h),Bn(b,h,o),g.head.appendChild(b);break;default:throw Error(i(468,h))}b[ze]=n,rn(b),h=b}n.stateNode=h}else kb(g,n.type,n.stateNode);else n.stateNode=Ob(g,h,n.memoizedProps);else b!==h?(b===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):b.count--,h===null?kb(g,n.type,n.stateNode):Ob(g,h,n.memoizedProps)):h===null&&n.stateNode!==null&&xf(n,n.memoizedProps,o.memoizedProps)}break;case 27:ri(s,n),ai(n),h&512&&(mn||o===null||gs(o,o.return)),o!==null&&h&4&&xf(n,n.memoizedProps,o.memoizedProps);break;case 5:if(ri(s,n),ai(n),h&512&&(mn||o===null||gs(o,o.return)),n.flags&32){g=n.stateNode;try{ks(g,"")}catch($t){Ne(n,n.return,$t)}}h&4&&n.stateNode!=null&&(g=n.memoizedProps,xf(n,g,o!==null?o.memoizedProps:g)),h&1024&&(Ef=!0);break;case 6:if(ri(s,n),ai(n),h&4){if(n.stateNode===null)throw Error(i(162));h=n.memoizedProps,o=n.stateNode;try{o.nodeValue=h}catch($t){Ne(n,n.return,$t)}}break;case 3:if(eh=null,g=Qi,Qi=Ju(s.containerInfo),ri(s,n),Qi=g,ai(n),h&4&&o!==null&&o.memoizedState.isDehydrated)try{Xo(s.containerInfo)}catch($t){Ne(n,n.return,$t)}Ef&&(Ef=!1,ky(n));break;case 4:h=Qi,Qi=Ju(n.stateNode.containerInfo),ri(s,n),ai(n),Qi=h;break;case 12:ri(s,n),ai(n);break;case 31:ri(s,n),ai(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Iu(n,h)));break;case 13:ri(s,n),ai(n),n.child.flags&8192&&n.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(zu=zn()),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Iu(n,h)));break;case 22:g=n.memoizedState!==null;var q=o!==null&&o.memoizedState!==null,at=Ws,yt=mn;if(Ws=at||g,mn=yt||q,ri(s,n),mn=yt,Ws=at,ai(n),h&8192)t:for(s=n.stateNode,s._visibility=g?s._visibility&-2:s._visibility|1,g&&(o===null||q||Ws||mn||Ba(n)),o=null,s=n;;){if(s.tag===5||s.tag===26){if(o===null){q=o=s;try{if(b=q.stateNode,g)T=b.style,typeof T.setProperty=="function"?T.setProperty("display","none","important"):T.display="none";else{N=q.stateNode;var vt=q.memoizedProps.style,lt=vt!=null&&vt.hasOwnProperty("display")?vt.display:null;N.style.display=lt==null||typeof lt=="boolean"?"":(""+lt).trim()}}catch($t){Ne(q,q.return,$t)}}}else if(s.tag===6){if(o===null){q=s;try{q.stateNode.nodeValue=g?"":q.memoizedProps}catch($t){Ne(q,q.return,$t)}}}else if(s.tag===18){if(o===null){q=s;try{var dt=q.stateNode;g?Ab(dt,!0):Ab(q.stateNode,!1)}catch($t){Ne(q,q.return,$t)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===n)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===n)break t;for(;s.sibling===null;){if(s.return===null||s.return===n)break t;o===s&&(o=null),s=s.return}o===s&&(o=null),s.sibling.return=s.return,s=s.sibling}h&4&&(h=n.updateQueue,h!==null&&(o=h.retryQueue,o!==null&&(h.retryQueue=null,Iu(n,o))));break;case 19:ri(s,n),ai(n),h&4&&(h=n.updateQueue,h!==null&&(n.updateQueue=null,Iu(n,h)));break;case 30:break;case 21:break;default:ri(s,n),ai(n)}}function ai(n){var s=n.flags;if(s&2){try{for(var o,h=n.return;h!==null;){if(Ey(h)){o=h;break}h=h.return}if(o==null)throw Error(i(160));switch(o.tag){case 27:var g=o.stateNode,b=Af(n);Fu(n,b,g);break;case 5:var T=o.stateNode;o.flags&32&&(ks(T,""),o.flags&=-33);var N=Af(n);Fu(n,N,T);break;case 3:case 4:var q=o.stateNode.containerInfo,at=Af(n);Sf(n,at,q);break;default:throw Error(i(161))}}catch(yt){Ne(n,n.return,yt)}n.flags&=-3}s&4096&&(n.flags&=-4097)}function ky(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var s=n;ky(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),n=n.sibling}}function Js(n,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Ty(n,s.alternate,s),s=s.sibling}function Ba(n){for(n=n.child;n!==null;){var s=n;switch(s.tag){case 0:case 11:case 14:case 15:Pr(4,s,s.return),Ba(s);break;case 1:gs(s,s.return);var o=s.stateNode;typeof o.componentWillUnmount=="function"&&Ay(s,s.return,o),Ba(s);break;case 27:hc(s.stateNode);case 26:case 5:gs(s,s.return),Ba(s);break;case 22:s.memoizedState===null&&Ba(s);break;case 30:Ba(s);break;default:Ba(s)}n=n.sibling}}function tr(n,s,o){for(o=o&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var h=s.alternate,g=n,b=s,T=b.flags;switch(b.tag){case 0:case 11:case 15:tr(g,b,o),ec(4,b);break;case 1:if(tr(g,b,o),h=b,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(at){Ne(h,h.return,at)}if(h=b,g=h.updateQueue,g!==null){var N=h.stateNode;try{var q=g.shared.hiddenCallbacks;if(q!==null)for(g.shared.hiddenCallbacks=null,g=0;g<q.length;g++)ug(q[g],N)}catch(at){Ne(h,h.return,at)}}o&&T&64&&xy(b),nc(b,b.return);break;case 27:_y(b);case 26:case 5:tr(g,b,o),o&&h===null&&T&4&&Sy(b),nc(b,b.return);break;case 12:tr(g,b,o);break;case 31:tr(g,b,o),o&&T&4&&Dy(g,b);break;case 13:tr(g,b,o),o&&T&4&&Oy(g,b);break;case 22:b.memoizedState===null&&tr(g,b,o),nc(b,b.return);break;case 30:break;default:tr(g,b,o)}s=s.sibling}}function _f(n,s){var o=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(o=n.memoizedState.cachePool.pool),n=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(n=s.memoizedState.cachePool.pool),n!==o&&(n!=null&&n.refCount++,o!=null&&Hl(o))}function Cf(n,s){n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Hl(n))}function Wi(n,s,o,h){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ly(n,s,o,h),s=s.sibling}function Ly(n,s,o,h){var g=s.flags;switch(s.tag){case 0:case 11:case 15:Wi(n,s,o,h),g&2048&&ec(9,s);break;case 1:Wi(n,s,o,h);break;case 3:Wi(n,s,o,h),g&2048&&(n=null,s.alternate!==null&&(n=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==n&&(s.refCount++,n!=null&&Hl(n)));break;case 12:if(g&2048){Wi(n,s,o,h),n=s.stateNode;try{var b=s.memoizedProps,T=b.id,N=b.onPostCommit;typeof N=="function"&&N(T,s.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(q){Ne(s,s.return,q)}}else Wi(n,s,o,h);break;case 31:Wi(n,s,o,h);break;case 13:Wi(n,s,o,h);break;case 23:break;case 22:b=s.stateNode,T=s.alternate,s.memoizedState!==null?b._visibility&2?Wi(n,s,o,h):ic(n,s):b._visibility&2?Wi(n,s,o,h):(b._visibility|=2,jo(n,s,o,h,(s.subtreeFlags&10256)!==0||!1)),g&2048&&_f(T,s);break;case 24:Wi(n,s,o,h),g&2048&&Cf(s.alternate,s);break;default:Wi(n,s,o,h)}}function jo(n,s,o,h,g){for(g=g&&((s.subtreeFlags&10256)!==0||!1),s=s.child;s!==null;){var b=n,T=s,N=o,q=h,at=T.flags;switch(T.tag){case 0:case 11:case 15:jo(b,T,N,q,g),ec(8,T);break;case 23:break;case 22:var yt=T.stateNode;T.memoizedState!==null?yt._visibility&2?jo(b,T,N,q,g):ic(b,T):(yt._visibility|=2,jo(b,T,N,q,g)),g&&at&2048&&_f(T.alternate,T);break;case 24:jo(b,T,N,q,g),g&&at&2048&&Cf(T.alternate,T);break;default:jo(b,T,N,q,g)}s=s.sibling}}function ic(n,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var o=n,h=s,g=h.flags;switch(h.tag){case 22:ic(o,h),g&2048&&_f(h.alternate,h);break;case 24:ic(o,h),g&2048&&Cf(h.alternate,h);break;default:ic(o,h)}s=s.sibling}}var sc=8192;function Fo(n,s,o){if(n.subtreeFlags&sc)for(n=n.child;n!==null;)Py(n,s,o),n=n.sibling}function Py(n,s,o){switch(n.tag){case 26:Fo(n,s,o),n.flags&sc&&n.memoizedState!==null&&fx(o,Qi,n.memoizedState,n.memoizedProps);break;case 5:Fo(n,s,o);break;case 3:case 4:var h=Qi;Qi=Ju(n.stateNode.containerInfo),Fo(n,s,o),Qi=h;break;case 22:n.memoizedState===null&&(h=n.alternate,h!==null&&h.memoizedState!==null?(h=sc,sc=16777216,Fo(n,s,o),sc=h):Fo(n,s,o));break;default:Fo(n,s,o)}}function By(n){var s=n.alternate;if(s!==null&&(n=s.child,n!==null)){s.child=null;do s=n.sibling,n.sibling=null,n=s;while(n!==null)}}function rc(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Cn=h,Fy(h,n)}By(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)jy(n),n=n.sibling}function jy(n){switch(n.tag){case 0:case 11:case 15:rc(n),n.flags&2048&&Pr(9,n,n.return);break;case 3:rc(n);break;case 12:rc(n);break;case 22:var s=n.stateNode;n.memoizedState!==null&&s._visibility&2&&(n.return===null||n.return.tag!==13)?(s._visibility&=-3,Uu(n)):rc(n);break;default:rc(n)}}function Uu(n){var s=n.deletions;if((n.flags&16)!==0){if(s!==null)for(var o=0;o<s.length;o++){var h=s[o];Cn=h,Fy(h,n)}By(n)}for(n=n.child;n!==null;){switch(s=n,s.tag){case 0:case 11:case 15:Pr(8,s,s.return),Uu(s);break;case 22:o=s.stateNode,o._visibility&2&&(o._visibility&=-3,Uu(s));break;default:Uu(s)}n=n.sibling}}function Fy(n,s){for(;Cn!==null;){var o=Cn;switch(o.tag){case 0:case 11:case 15:Pr(8,o,s);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var h=o.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:Hl(o.memoizedState.cache)}if(h=o.child,h!==null)h.return=o,Cn=h;else t:for(o=n;Cn!==null;){h=Cn;var g=h.sibling,b=h.return;if(Ry(h),h===o){Cn=null;break t}if(g!==null){g.return=b,Cn=g;break t}Cn=b}}}var R1={getCacheForType:function(n){var s=Ln(dn),o=s.data.get(n);return o===void 0&&(o=n(),s.data.set(n,o)),o},cacheSignal:function(){return Ln(dn).controller.signal}},M1=typeof WeakMap=="function"?WeakMap:Map,Ee=0,Ue=null,he=null,pe=0,Oe=0,xi=null,Br=!1,Io=!1,Tf=!1,er=0,Je=0,jr=0,ja=0,Rf=0,Ai=0,Uo=0,ac=null,oi=null,Mf=!1,zu=0,Iy=0,Hu=1/0,qu=null,Fr=null,bn=0,Ir=null,zo=null,nr=0,Df=0,Of=null,Uy=null,oc=0,Nf=null;function Si(){return(Ee&2)!==0&&pe!==0?pe&-pe:G.T!==null?Ff():ha()}function zy(){if(Ai===0)if((pe&536870912)===0||ye){var n=dr;dr<<=1,(dr&3932160)===0&&(dr=262144),Ai=n}else Ai=536870912;return n=vi.current,n!==null&&(n.flags|=32),Ai}function li(n,s,o){(n===Ue&&(Oe===2||Oe===9)||n.cancelPendingCommit!==null)&&(Ho(n,0),Ur(n,pe,Ai,!1)),Mi(n,o),((Ee&2)===0||n!==Ue)&&(n===Ue&&((Ee&2)===0&&(ja|=o),Je===4&&Ur(n,pe,Ai,!1)),ys(n))}function Hy(n,s,o){if((Ee&6)!==0)throw Error(i(327));var h=!o&&(s&127)===0&&(s&n.expiredLanes)===0||Ds(n,s),g=h?N1(n,s):Lf(n,s,!0),b=h;do{if(g===0){Io&&!h&&Ur(n,s,0,!1);break}else{if(o=n.current.alternate,b&&!D1(o)){g=Lf(n,s,!1),b=!1;continue}if(g===2){if(b=s,n.errorRecoveryDisabledLanes&b)var T=0;else T=n.pendingLanes&-536870913,T=T!==0?T:T&536870912?536870912:0;if(T!==0){s=T;t:{var N=n;g=ac;var q=N.current.memoizedState.isDehydrated;if(q&&(Ho(N,T).flags|=256),T=Lf(N,T,!1),T!==2){if(Tf&&!q){N.errorRecoveryDisabledLanes|=b,ja|=b,g=4;break t}b=oi,oi=g,b!==null&&(oi===null?oi=b:oi.push.apply(oi,b))}g=T}if(b=!1,g!==2)continue}}if(g===1){Ho(n,0),Ur(n,s,0,!0);break}t:{switch(h=n,b=g,b){case 0:case 1:throw Error(i(345));case 4:if((s&4194048)!==s)break;case 6:Ur(h,s,Ai,!Br);break t;case 2:oi=null;break;case 3:case 5:break;default:throw Error(i(329))}if((s&62914560)===s&&(g=zu+300-zn(),10<g)){if(Ur(h,s,Ai,!Br),ca(h,0,!0)!==0)break t;nr=s,h.timeoutHandle=vb(qy.bind(null,h,o,oi,qu,Mf,s,Ai,ja,Uo,Br,b,"Throttled",-0,0),g);break t}qy(h,o,oi,qu,Mf,s,Ai,ja,Uo,Br,b,null,-0,0)}}break}while(!0);ys(n)}function qy(n,s,o,h,g,b,T,N,q,at,yt,vt,lt,dt){if(n.timeoutHandle=-1,vt=s.subtreeFlags,vt&8192||(vt&16785408)===16785408){vt={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:ii},Py(s,b,vt);var $t=(b&62914560)===b?zu-zn():(b&4194048)===b?Iy-zn():0;if($t=px(vt,$t),$t!==null){nr=b,n.cancelPendingCommit=$t(Wy.bind(null,n,s,b,o,h,g,T,N,q,yt,vt,null,lt,dt)),Ur(n,b,T,!at);return}}Wy(n,s,b,o,h,g,T,N,q)}function D1(n){for(var s=n;;){var o=s.tag;if((o===0||o===11||o===15)&&s.flags&16384&&(o=s.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var h=0;h<o.length;h++){var g=o[h],b=g.getSnapshot;g=g.value;try{if(!$n(b(),g))return!1}catch{return!1}}if(o=s.child,s.subtreeFlags&16384&&o!==null)o.return=s,s=o;else{if(s===n)break;for(;s.sibling===null;){if(s.return===null||s.return===n)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ur(n,s,o,h){s&=~Rf,s&=~ja,n.suspendedLanes|=s,n.pingedLanes&=~s,h&&(n.warmLanes|=s),h=n.expirationTimes;for(var g=s;0<g;){var b=31-Ft(g),T=1<<b;h[b]=-1,g&=~T}o!==0&&ua(n,o,s)}function Gu(){return(Ee&6)===0?(lc(0),!1):!0}function kf(){if(he!==null){if(Oe===0)var n=he.return;else n=he,$s=Ra=null,Xd(n),No=null,Gl=0,n=he;for(;n!==null;)wy(n.alternate,n),n=n.return;he=null}}function Ho(n,s){var o=n.timeoutHandle;o!==-1&&(n.timeoutHandle=-1,Q1(o)),o=n.cancelPendingCommit,o!==null&&(n.cancelPendingCommit=null,o()),nr=0,kf(),Ue=n,he=o=qs(n.current,null),pe=s,Oe=0,xi=null,Br=!1,Io=Ds(n,s),Tf=!1,Uo=Ai=Rf=ja=jr=Je=0,oi=ac=null,Mf=!1,(s&8)!==0&&(s|=s&32);var h=n.entangledLanes;if(h!==0)for(n=n.entanglements,h&=s;0<h;){var g=31-Ft(h),b=1<<g;s|=n[g],h&=~b}return er=s,se(),o}function Gy(n,s){oe=null,G.H=Zl,s===Oo||s===vu?(s=ag(),Oe=3):s===Bd?(s=ag(),Oe=4):Oe=s===hf?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,xi=s,he===null&&(Je=1,ku(n,Li(s,n.current)))}function $y(){var n=vi.current;return n===null?!0:(pe&4194048)===pe?Fi===null:(pe&62914560)===pe||(pe&536870912)!==0?n===Fi:!1}function Vy(){var n=G.H;return G.H=Zl,n===null?Zl:n}function Ky(){var n=G.A;return G.A=R1,n}function $u(){Je=4,Br||(pe&4194048)!==pe&&vi.current!==null||(Io=!0),(jr&134217727)===0&&(ja&134217727)===0||Ue===null||Ur(Ue,pe,Ai,!1)}function Lf(n,s,o){var h=Ee;Ee|=2;var g=Vy(),b=Ky();(Ue!==n||pe!==s)&&(qu=null,Ho(n,s)),s=!1;var T=Je;t:do try{if(Oe!==0&&he!==null){var N=he,q=xi;switch(Oe){case 8:kf(),T=6;break t;case 3:case 2:case 9:case 6:vi.current===null&&(s=!0);var at=Oe;if(Oe=0,xi=null,qo(n,N,q,at),o&&Io){T=0;break t}break;default:at=Oe,Oe=0,xi=null,qo(n,N,q,at)}}O1(),T=Je;break}catch(yt){Gy(n,yt)}while(!0);return s&&n.shellSuspendCounter++,$s=Ra=null,Ee=h,G.H=g,G.A=b,he===null&&(Ue=null,pe=0,se()),T}function O1(){for(;he!==null;)Xy(he)}function N1(n,s){var o=Ee;Ee|=2;var h=Vy(),g=Ky();Ue!==n||pe!==s?(qu=null,Hu=zn()+500,Ho(n,s)):Io=Ds(n,s);t:do try{if(Oe!==0&&he!==null){s=he;var b=xi;e:switch(Oe){case 1:Oe=0,xi=null,qo(n,s,b,1);break;case 2:case 9:if(sg(b)){Oe=0,xi=null,Yy(s);break}s=function(){Oe!==2&&Oe!==9||Ue!==n||(Oe=7),ys(n)},b.then(s,s);break t;case 3:Oe=7;break t;case 4:Oe=5;break t;case 7:sg(b)?(Oe=0,xi=null,Yy(s)):(Oe=0,xi=null,qo(n,s,b,7));break;case 5:var T=null;switch(he.tag){case 26:T=he.memoizedState;case 5:case 27:var N=he;if(T?Lb(T):N.stateNode.complete){Oe=0,xi=null;var q=N.sibling;if(q!==null)he=q;else{var at=N.return;at!==null?(he=at,Vu(at)):he=null}break e}}Oe=0,xi=null,qo(n,s,b,5);break;case 6:Oe=0,xi=null,qo(n,s,b,6);break;case 8:kf(),Je=6;break t;default:throw Error(i(462))}}k1();break}catch(yt){Gy(n,yt)}while(!0);return $s=Ra=null,G.H=h,G.A=g,Ee=o,he!==null?0:(Ue=null,pe=0,se(),Je)}function k1(){for(;he!==null&&!Zc();)Xy(he)}function Xy(n){var s=by(n.alternate,n,er);n.memoizedProps=n.pendingProps,s===null?Vu(n):he=s}function Yy(n){var s=n,o=s.alternate;switch(s.tag){case 15:case 0:s=dy(o,s,s.pendingProps,s.type,void 0,pe);break;case 11:s=dy(o,s,s.pendingProps,s.type.render,s.ref,pe);break;case 5:Xd(s);default:wy(o,s),s=he=Km(s,er),s=by(o,s,er)}n.memoizedProps=n.pendingProps,s===null?Vu(n):he=s}function qo(n,s,o,h){$s=Ra=null,Xd(s),No=null,Gl=0;var g=s.return;try{if(x1(n,g,s,o,pe)){Je=1,ku(n,Li(o,n.current)),he=null;return}}catch(b){if(g!==null)throw he=g,b;Je=1,ku(n,Li(o,n.current)),he=null;return}s.flags&32768?(ye||h===1?n=!0:Io||(pe&536870912)!==0?n=!1:(Br=n=!0,(h===2||h===9||h===3||h===6)&&(h=vi.current,h!==null&&h.tag===13&&(h.flags|=16384))),Qy(s,n)):Vu(s)}function Vu(n){var s=n;do{if((s.flags&32768)!==0){Qy(s,Br);return}n=s.return;var o=E1(s.alternate,s,er);if(o!==null){he=o;return}if(s=s.sibling,s!==null){he=s;return}he=s=n}while(s!==null);Je===0&&(Je=5)}function Qy(n,s){do{var o=_1(n.alternate,n);if(o!==null){o.flags&=32767,he=o;return}if(o=n.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!s&&(n=n.sibling,n!==null)){he=n;return}he=n=o}while(n!==null);Je=6,he=null}function Wy(n,s,o,h,g,b,T,N,q){n.cancelPendingCommit=null;do Ku();while(bn!==0);if((Ee&6)!==0)throw Error(i(327));if(s!==null){if(s===n.current)throw Error(i(177));if(b=s.lanes|s.childLanes,b|=Qt,bl(n,o,b,T,N,q),n===Ue&&(he=Ue=null,pe=0),zo=s,Ir=n,nr=o,Df=b,Of=g,Uy=h,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,j1(hr,function(){return nb(),null})):(n.callbackNode=null,n.callbackPriority=0),h=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||h){h=G.T,G.T=null,g=st.p,st.p=2,T=Ee,Ee|=4;try{C1(n,s,o)}finally{Ee=T,st.p=g,G.T=h}}bn=1,Zy(),Jy(),tb()}}function Zy(){if(bn===1){bn=0;var n=Ir,s=zo,o=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||o){o=G.T,G.T=null;var h=st.p;st.p=2;var g=Ee;Ee|=4;try{Ny(s,n);var b=Vf,T=R(n.containerInfo),N=b.focusedElem,q=b.selectionRange;if(T!==N&&N&&N.ownerDocument&&E(N.ownerDocument.documentElement,N)){if(q!==null&&D(N)){var at=q.start,yt=q.end;if(yt===void 0&&(yt=at),"selectionStart"in N)N.selectionStart=at,N.selectionEnd=Math.min(yt,N.value.length);else{var vt=N.ownerDocument||document,lt=vt&&vt.defaultView||window;if(lt.getSelection){var dt=lt.getSelection(),$t=N.textContent.length,Jt=Math.min(q.start,$t),je=q.end===void 0?Jt:Math.min(q.end,$t);!dt.extend&&Jt>je&&(T=je,je=Jt,Jt=T);var tt=x(N,Jt),W=x(N,je);if(tt&&W&&(dt.rangeCount!==1||dt.anchorNode!==tt.node||dt.anchorOffset!==tt.offset||dt.focusNode!==W.node||dt.focusOffset!==W.offset)){var rt=vt.createRange();rt.setStart(tt.node,tt.offset),dt.removeAllRanges(),Jt>je?(dt.addRange(rt),dt.extend(W.node,W.offset)):(rt.setEnd(W.node,W.offset),dt.addRange(rt))}}}}for(vt=[],dt=N;dt=dt.parentNode;)dt.nodeType===1&&vt.push({element:dt,left:dt.scrollLeft,top:dt.scrollTop});for(typeof N.focus=="function"&&N.focus(),N=0;N<vt.length;N++){var bt=vt[N];bt.element.scrollLeft=bt.left,bt.element.scrollTop=bt.top}}rh=!!$f,Vf=$f=null}finally{Ee=g,st.p=h,G.T=o}}n.current=s,bn=2}}function Jy(){if(bn===2){bn=0;var n=Ir,s=zo,o=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||o){o=G.T,G.T=null;var h=st.p;st.p=2;var g=Ee;Ee|=4;try{Ty(n,s.alternate,s)}finally{Ee=g,st.p=h,G.T=o}}bn=3}}function tb(){if(bn===4||bn===3){bn=0,sa();var n=Ir,s=zo,o=nr,h=Uy;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?bn=5:(bn=0,zo=Ir=null,eb(n,n.pendingLanes));var g=n.pendingLanes;if(g===0&&(Fr=null),fr(o),s=s.stateNode,Dn&&typeof Dn.onCommitFiberRoot=="function")try{Dn.onCommitFiberRoot(is,s,void 0,(s.current.flags&128)===128)}catch{}if(h!==null){s=G.T,g=st.p,st.p=2,G.T=null;try{for(var b=n.onRecoverableError,T=0;T<h.length;T++){var N=h[T];b(N.value,{componentStack:N.stack})}}finally{G.T=s,st.p=g}}(nr&3)!==0&&Ku(),ys(n),g=n.pendingLanes,(o&261930)!==0&&(g&42)!==0?n===Nf?oc++:(oc=0,Nf=n):oc=0,lc(0)}}function eb(n,s){(n.pooledCacheLanes&=s)===0&&(s=n.pooledCache,s!=null&&(n.pooledCache=null,Hl(s)))}function Ku(){return Zy(),Jy(),tb(),nb()}function nb(){if(bn!==5)return!1;var n=Ir,s=Df;Df=0;var o=fr(nr),h=G.T,g=st.p;try{st.p=32>o?32:o,G.T=null,o=Of,Of=null;var b=Ir,T=nr;if(bn=0,zo=Ir=null,nr=0,(Ee&6)!==0)throw Error(i(331));var N=Ee;if(Ee|=4,jy(b.current),Ly(b,b.current,T,o),Ee=N,lc(0,!1),Dn&&typeof Dn.onPostCommitFiberRoot=="function")try{Dn.onPostCommitFiberRoot(is,b)}catch{}return!0}finally{st.p=g,G.T=h,eb(n,s)}}function ib(n,s,o){s=Li(o,s),s=uf(n.stateNode,s,2),n=Nr(n,s,2),n!==null&&(Mi(n,2),ys(n))}function Ne(n,s,o){if(n.tag===3)ib(n,n,o);else for(;s!==null;){if(s.tag===3){ib(s,n,o);break}else if(s.tag===1){var h=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Fr===null||!Fr.has(h))){n=Li(o,n),o=sy(2),h=Nr(s,o,2),h!==null&&(ry(o,h,s,n),Mi(h,2),ys(h));break}}s=s.return}}function Pf(n,s,o){var h=n.pingCache;if(h===null){h=n.pingCache=new M1;var g=new Set;h.set(s,g)}else g=h.get(s),g===void 0&&(g=new Set,h.set(s,g));g.has(o)||(Tf=!0,g.add(o),n=L1.bind(null,n,s,o),s.then(n,n))}function L1(n,s,o){var h=n.pingCache;h!==null&&h.delete(s),n.pingedLanes|=n.suspendedLanes&o,n.warmLanes&=~o,Ue===n&&(pe&o)===o&&(Je===4||Je===3&&(pe&62914560)===pe&&300>zn()-zu?(Ee&2)===0&&Ho(n,0):Rf|=o,Uo===pe&&(Uo=0)),ys(n)}function sb(n,s){s===0&&(s=Jc()),n=De(n,s),n!==null&&(Mi(n,s),ys(n))}function P1(n){var s=n.memoizedState,o=0;s!==null&&(o=s.retryLane),sb(n,o)}function B1(n,s){var o=0;switch(n.tag){case 31:case 13:var h=n.stateNode,g=n.memoizedState;g!==null&&(o=g.retryLane);break;case 19:h=n.stateNode;break;case 22:h=n.stateNode._retryCache;break;default:throw Error(i(314))}h!==null&&h.delete(s),sb(n,o)}function j1(n,s){return ia(n,s)}var Xu=null,Go=null,Bf=!1,Yu=!1,jf=!1,zr=0;function ys(n){n!==Go&&n.next===null&&(Go===null?Xu=Go=n:Go=Go.next=n),Yu=!0,Bf||(Bf=!0,I1())}function lc(n,s){if(!jf&&Yu){jf=!0;do for(var o=!1,h=Xu;h!==null;){if(n!==0){var g=h.pendingLanes;if(g===0)var b=0;else{var T=h.suspendedLanes,N=h.pingedLanes;b=(1<<31-Ft(42|n)+1)-1,b&=g&~(T&~N),b=b&201326741?b&201326741|1:b?b|2:0}b!==0&&(o=!0,lb(h,b))}else b=pe,b=ca(h,h===Ue?b:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(b&3)===0||Ds(h,b)||(o=!0,lb(h,b));h=h.next}while(o);jf=!1}}function F1(){rb()}function rb(){Yu=Bf=!1;var n=0;zr!==0&&Y1()&&(n=zr);for(var s=zn(),o=null,h=Xu;h!==null;){var g=h.next,b=ab(h,s);b===0?(h.next=null,o===null?Xu=g:o.next=g,g===null&&(Go=o)):(o=h,(n!==0||(b&3)!==0)&&(Yu=!0)),h=g}bn!==0&&bn!==5||lc(n),zr!==0&&(zr=0)}function ab(n,s){for(var o=n.suspendedLanes,h=n.pingedLanes,g=n.expirationTimes,b=n.pendingLanes&-62914561;0<b;){var T=31-Ft(b),N=1<<T,q=g[T];q===-1?((N&o)===0||(N&h)!==0)&&(g[T]=pd(N,s)):q<=s&&(n.expiredLanes|=N),b&=~N}if(s=Ue,o=pe,o=ca(n,n===s?o:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h=n.callbackNode,o===0||n===s&&(Oe===2||Oe===9)||n.cancelPendingCommit!==null)return h!==null&&h!==null&&ni(h),n.callbackNode=null,n.callbackPriority=0;if((o&3)===0||Ds(n,o)){if(s=o&-o,s===n.callbackPriority)return s;switch(h!==null&&ni(h),fr(o)){case 2:case 8:o=ns;break;case 32:o=hr;break;case 268435456:o=to;break;default:o=hr}return h=ob.bind(null,n),o=ia(o,h),n.callbackPriority=s,n.callbackNode=o,s}return h!==null&&h!==null&&ni(h),n.callbackPriority=2,n.callbackNode=null,2}function ob(n,s){if(bn!==0&&bn!==5)return n.callbackNode=null,n.callbackPriority=0,null;var o=n.callbackNode;if(Ku()&&n.callbackNode!==o)return null;var h=pe;return h=ca(n,n===Ue?h:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),h===0?null:(Hy(n,h,s),ab(n,zn()),n.callbackNode!=null&&n.callbackNode===o?ob.bind(null,n):null)}function lb(n,s){if(Ku())return null;Hy(n,s,!0)}function I1(){W1(function(){(Ee&6)!==0?ia(Hn,F1):rb()})}function Ff(){if(zr===0){var n=Mo;n===0&&(n=Nt,Nt<<=1,(Nt&261888)===0&&(Nt=256)),zr=n}return zr}function cb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Yi(""+n)}function ub(n,s){var o=s.ownerDocument.createElement("input");return o.name=s.name,o.value=s.value,n.id&&o.setAttribute("form",n.id),s.parentNode.insertBefore(o,s),n=new FormData(n),o.parentNode.removeChild(o),n}function U1(n,s,o,h,g){if(s==="submit"&&o&&o.stateNode===g){var b=cb((g[sn]||null).action),T=h.submitter;T&&(s=(s=T[sn]||null)?cb(s.formAction):T.getAttribute("formAction"),s!==null&&(b=s,T=null));var N=new lo("action","action",null,h,g);n.push({event:N,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(zr!==0){var q=T?ub(g,T):new FormData(g);sf(o,{pending:!0,data:q,method:g.method,action:b},null,q)}}else typeof b=="function"&&(N.preventDefault(),q=T?ub(g,T):new FormData(g),sf(o,{pending:!0,data:q,method:g.method,action:b},b,q))},currentTarget:g}]})}}for(var If=0;If<Pt.length;If++){var Uf=Pt[If],z1=Uf.toLowerCase(),H1=Uf[0].toUpperCase()+Uf.slice(1);Et(z1,"on"+H1)}Et(ot,"onAnimationEnd"),Et(nt,"onAnimationIteration"),Et(gt,"onAnimationStart"),Et("dblclick","onDoubleClick"),Et("focusin","onFocus"),Et("focusout","onBlur"),Et(At,"onTransitionRun"),Et(Mt,"onTransitionStart"),Et(Dt,"onTransitionCancel"),Et(St,"onTransitionEnd"),ls("onMouseEnter",["mouseout","mouseover"]),ls("onMouseLeave",["mouseout","mouseover"]),ls("onPointerEnter",["pointerout","pointerover"]),ls("onPointerLeave",["pointerout","pointerover"]),Ki("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ki("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ki("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ki("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ki("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ki("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),q1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(cc));function hb(n,s){s=(s&4)!==0;for(var o=0;o<n.length;o++){var h=n[o],g=h.event;h=h.listeners;t:{var b=void 0;if(s)for(var T=h.length-1;0<=T;T--){var N=h[T],q=N.instance,at=N.currentTarget;if(N=N.listener,q!==b&&g.isPropagationStopped())break t;b=N,g.currentTarget=at;try{b(g)}catch(yt){Ht(yt)}g.currentTarget=null,b=q}else for(T=0;T<h.length;T++){if(N=h[T],q=N.instance,at=N.currentTarget,N=N.listener,q!==b&&g.isPropagationStopped())break t;b=N,g.currentTarget=at;try{b(g)}catch(yt){Ht(yt)}g.currentTarget=null,b=q}}}}function de(n,s){var o=s[pr];o===void 0&&(o=s[pr]=new Set);var h=n+"__bubble";o.has(h)||(db(s,n,2,!1),o.add(h))}function zf(n,s,o){var h=0;s&&(h|=4),db(o,n,h,s)}var Qu="_reactListening"+Math.random().toString(36).slice(2);function Hf(n){if(!n[Qu]){n[Qu]=!0,Os.forEach(function(o){o!=="selectionchange"&&(q1.has(o)||zf(o,!1,n),zf(o,!0,n))});var s=n.nodeType===9?n:n.ownerDocument;s===null||s[Qu]||(s[Qu]=!0,zf("selectionchange",!1,s))}}function db(n,s,o,h){switch(zb(s)){case 2:var g=yx;break;case 8:g=bx;break;default:g=ip}o=g.bind(null,s,o,n),g=void 0,!Cl||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(g=!0),h?g!==void 0?n.addEventListener(s,o,{capture:!0,passive:g}):n.addEventListener(s,o,!0):g!==void 0?n.addEventListener(s,o,{passive:g}):n.addEventListener(s,o,!1)}function qf(n,s,o,h,g){var b=h;if((s&1)===0&&(s&2)===0&&h!==null)t:for(;;){if(h===null)return;var T=h.tag;if(T===3||T===4){var N=h.stateNode.containerInfo;if(N===g)break;if(T===4)for(T=h.return;T!==null;){var q=T.tag;if((q===3||q===4)&&T.stateNode.containerInfo===g)return;T=T.return}for(;N!==null;){if(T=os(N),T===null)return;if(q=T.tag,q===5||q===6||q===26||q===27){h=b=T;continue t}N=N.parentNode}}h=h.return}gr(function(){var at=b,yt=ao(o),vt=[];t:{var lt=zt.get(n);if(lt!==void 0){var dt=lo,$t=n;switch(n){case"keypress":if(vr(o)===0)break t;case"keydown":case"keyup":dt=go;break;case"focusin":$t="focus",dt=wr;break;case"focusout":$t="blur",dt=wr;break;case"beforeblur":case"afterblur":dt=wr;break;case"click":if(o.button===2)break t;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":dt=ho;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":dt=iu;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":dt=kl;break;case ot:case nt:case gt:dt=su;break;case St:dt=Ll;break;case"scroll":case"scrollend":dt=co;break;case"wheel":dt=bo;break;case"copy":case"cut":case"paste":dt=xr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":dt=Nl;break;case"toggle":case"beforetoggle":dt=ou}var Jt=(s&4)!==0,je=!Jt&&(n==="scroll"||n==="scrollend"),tt=Jt?lt!==null?lt+"Capture":null:lt;Jt=[];for(var W=at,rt;W!==null;){var bt=W;if(rt=bt.stateNode,bt=bt.tag,bt!==5&&bt!==26&&bt!==27||rt===null||tt===null||(bt=Bs(W,tt),bt!=null&&Jt.push(uc(W,bt,rt))),je)break;W=W.return}0<Jt.length&&(lt=new dt(lt,$t,null,o,yt),vt.push({event:lt,listeners:Jt}))}}if((s&7)===0){t:{if(lt=n==="mouseover"||n==="pointerover",dt=n==="mouseout"||n==="pointerout",lt&&o!==Oi&&($t=o.relatedTarget||o.fromElement)&&(os($t)||$t[Yn]))break t;if((dt||lt)&&(lt=yt.window===yt?yt:(lt=yt.ownerDocument)?lt.defaultView||lt.parentWindow:window,dt?($t=o.relatedTarget||o.toElement,dt=at,$t=$t?os($t):null,$t!==null&&(je=l($t),Jt=$t.tag,$t!==je||Jt!==5&&Jt!==27&&Jt!==6)&&($t=null)):(dt=null,$t=at),dt!==$t)){if(Jt=ho,bt="onMouseLeave",tt="onMouseEnter",W="mouse",(n==="pointerout"||n==="pointerover")&&(Jt=Nl,bt="onPointerLeave",tt="onPointerEnter",W="pointer"),je=dt==null?lt:gi(dt),rt=$t==null?lt:gi($t),lt=new Jt(bt,W+"leave",dt,o,yt),lt.target=je,lt.relatedTarget=rt,bt=null,os(yt)===at&&(Jt=new Jt(tt,W+"enter",$t,o,yt),Jt.target=rt,Jt.relatedTarget=je,bt=Jt),je=bt,dt&&$t)e:{for(Jt=G1,tt=dt,W=$t,rt=0,bt=tt;bt;bt=Jt(bt))rt++;bt=0;for(var Wt=W;Wt;Wt=Jt(Wt))bt++;for(;0<rt-bt;)tt=Jt(tt),rt--;for(;0<bt-rt;)W=Jt(W),bt--;for(;rt--;){if(tt===W||W!==null&&tt===W.alternate){Jt=tt;break e}tt=Jt(tt),W=Jt(W)}Jt=null}else Jt=null;dt!==null&&fb(vt,lt,dt,Jt,!1),$t!==null&&je!==null&&fb(vt,je,$t,Jt,!0)}}t:{if(lt=at?gi(at):window,dt=lt.nodeName&&lt.nodeName.toLowerCase(),dt==="select"||dt==="input"&&lt.type==="file")var xe=_a;else if(xo(lt))if(ki)xe=Er;else{xe=Hs;var Xt=fu}else dt=lt.nodeName,!dt||dt.toLowerCase()!=="input"||lt.type!=="checkbox"&&lt.type!=="radio"?at&&_l(at.elementType)&&(xe=_a):xe=Il;if(xe&&(xe=xe(n,at))){Fl(vt,xe,o,yt);break t}Xt&&Xt(n,lt,at),n==="focusout"&&at&&lt.type==="number"&&at.memoizedProps.value!=null&&ya(lt,"number",lt.value)}switch(Xt=at?gi(at):window,n){case"focusin":(xo(Xt)||Xt.contentEditable==="true")&&(B=Xt,V=at,et=null);break;case"focusout":et=V=B=null;break;case"mousedown":K=!0;break;case"contextmenu":case"mouseup":case"dragend":K=!1,$(vt,o,yt);break;case"selectionchange":if(P)break;case"keydown":case"keyup":$(vt,o,yt)}var le;if(Sa)t:{switch(n){case"compositionstart":var me="onCompositionStart";break t;case"compositionend":me="onCompositionEnd";break t;case"compositionupdate":me="onCompositionUpdate";break t}me=void 0}else Us?jl(n,o)&&(me="onCompositionEnd"):n==="keydown"&&o.keyCode===229&&(me="onCompositionStart");me&&(vo&&o.locale!=="ko"&&(Us||me!=="onCompositionStart"?me==="onCompositionEnd"&&Us&&(le=br()):(Ni=yt,oo="value"in Ni?Ni.value:Ni.textContent,Us=!0)),Xt=Wu(at,me),0<Xt.length&&(me=new mo(me,n,null,o,yt),vt.push({event:me,listeners:Xt}),le?me.data=le:(le=cu(o),le!==null&&(me.data=le)))),(le=wd?uu(n,o):xd(n,o))&&(me=Wu(at,"onBeforeInput"),0<me.length&&(Xt=new mo("onBeforeInput","beforeinput",null,o,yt),vt.push({event:Xt,listeners:me}),Xt.data=le)),U1(vt,n,at,o,yt)}hb(vt,s)})}function uc(n,s,o){return{instance:n,listener:s,currentTarget:o}}function Wu(n,s){for(var o=s+"Capture",h=[];n!==null;){var g=n,b=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||b===null||(g=Bs(n,o),g!=null&&h.unshift(uc(n,g,b)),g=Bs(n,s),g!=null&&h.push(uc(n,g,b))),n.tag===3)return h;n=n.return}return[]}function G1(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function fb(n,s,o,h,g){for(var b=s._reactName,T=[];o!==null&&o!==h;){var N=o,q=N.alternate,at=N.stateNode;if(N=N.tag,q!==null&&q===h)break;N!==5&&N!==26&&N!==27||at===null||(q=at,g?(at=Bs(o,b),at!=null&&T.unshift(uc(o,at,q))):g||(at=Bs(o,b),at!=null&&T.push(uc(o,at,q)))),o=o.return}T.length!==0&&n.push({event:s,listeners:T})}var $1=/\r\n?/g,V1=/\u0000|\uFFFD/g;function pb(n){return(typeof n=="string"?n:""+n).replace($1,`
`).replace(V1,"")}function mb(n,s){return s=pb(s),pb(n)===s}function Be(n,s,o,h,g,b){switch(o){case"children":typeof h=="string"?s==="body"||s==="textarea"&&h===""||ks(n,h):(typeof h=="number"||typeof h=="bigint")&&s!=="body"&&ks(n,""+h);break;case"className":ma(n,"class",h);break;case"tabIndex":ma(n,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":ma(n,o,h);break;case"style":El(n,h,b);break;case"data":if(s!=="object"){ma(n,"data",h);break}case"src":case"href":if(h===""&&(s!=="a"||o!=="href")){n.removeAttribute(o);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Yi(""+h),n.setAttribute(o,h);break;case"action":case"formAction":if(typeof h=="function"){n.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof b=="function"&&(o==="formAction"?(s!=="input"&&Be(n,s,"name",g.name,g,null),Be(n,s,"formEncType",g.formEncType,g,null),Be(n,s,"formMethod",g.formMethod,g,null),Be(n,s,"formTarget",g.formTarget,g,null)):(Be(n,s,"encType",g.encType,g,null),Be(n,s,"method",g.method,g,null),Be(n,s,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){n.removeAttribute(o);break}h=Yi(""+h),n.setAttribute(o,h);break;case"onClick":h!=null&&(n.onclick=ii);break;case"onScroll":h!=null&&de("scroll",n);break;case"onScrollEnd":h!=null&&de("scrollend",n);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"multiple":n.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":n.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){n.removeAttribute("xlink:href");break}o=Yi(""+h),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""+h):n.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,""):n.removeAttribute(o);break;case"capture":case"download":h===!0?n.setAttribute(o,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?n.setAttribute(o,h):n.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?n.setAttribute(o,h):n.removeAttribute(o);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?n.removeAttribute(o):n.setAttribute(o,h);break;case"popover":de("beforetoggle",n),de("toggle",n),ce(n,"popover",h);break;case"xlinkActuate":Di(n,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":Di(n,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":Di(n,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":Di(n,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":Di(n,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":Di(n,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":Di(n,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":Di(n,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":Di(n,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":ce(n,"is",h);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=yd.get(o)||o,ce(n,o,h))}}function Gf(n,s,o,h,g,b){switch(o){case"style":El(n,h,b);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(i(61));if(o=h.__html,o!=null){if(g.children!=null)throw Error(i(60));n.innerHTML=o}}break;case"children":typeof h=="string"?ks(n,h):(typeof h=="number"||typeof h=="bigint")&&ks(n,""+h);break;case"onScroll":h!=null&&de("scroll",n);break;case"onScrollEnd":h!=null&&de("scrollend",n);break;case"onClick":h!=null&&(n.onclick=ii);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!fa.hasOwnProperty(o))t:{if(o[0]==="o"&&o[1]==="n"&&(g=o.endsWith("Capture"),s=o.slice(2,g?o.length-7:void 0),b=n[sn]||null,b=b!=null?b[o]:null,typeof b=="function"&&n.removeEventListener(s,b,g),typeof h=="function")){typeof b!="function"&&b!==null&&(o in n?n[o]=null:n.hasAttribute(o)&&n.removeAttribute(o)),n.addEventListener(s,h,g);break t}o in n?n[o]=h:h===!0?n.setAttribute(o,""):ce(n,o,h)}}}function Bn(n,s,o){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":de("error",n),de("load",n);var h=!1,g=!1,b;for(b in o)if(o.hasOwnProperty(b)){var T=o[b];if(T!=null)switch(b){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Be(n,s,b,T,o,null)}}g&&Be(n,s,"srcSet",o.srcSet,o,null),h&&Be(n,s,"src",o.src,o,null);return;case"input":de("invalid",n);var N=b=T=g=null,q=null,at=null;for(h in o)if(o.hasOwnProperty(h)){var yt=o[h];if(yt!=null)switch(h){case"name":g=yt;break;case"type":T=yt;break;case"checked":q=yt;break;case"defaultChecked":at=yt;break;case"value":b=yt;break;case"defaultValue":N=yt;break;case"children":case"dangerouslySetInnerHTML":if(yt!=null)throw Error(i(137,s));break;default:Be(n,s,h,yt,o,null)}}ro(n,b,N,q,at,T,g,!1);return;case"select":de("invalid",n),h=T=b=null;for(g in o)if(o.hasOwnProperty(g)&&(N=o[g],N!=null))switch(g){case"value":b=N;break;case"defaultValue":T=N;break;case"multiple":h=N;default:Be(n,s,g,N,o,null)}s=b,o=T,n.multiple=!!h,s!=null?Xi(n,!!h,s,!1):o!=null&&Xi(n,!!h,o,!0);return;case"textarea":de("invalid",n),b=g=h=null;for(T in o)if(o.hasOwnProperty(T)&&(N=o[T],N!=null))switch(T){case"value":h=N;break;case"defaultValue":g=N;break;case"children":b=N;break;case"dangerouslySetInnerHTML":if(N!=null)throw Error(i(91));break;default:Be(n,s,T,N,o,null)}ba(n,h,g,b);return;case"option":for(q in o)o.hasOwnProperty(q)&&(h=o[q],h!=null)&&(q==="selected"?n.selected=h&&typeof h!="function"&&typeof h!="symbol":Be(n,s,q,h,o,null));return;case"dialog":de("beforetoggle",n),de("toggle",n),de("cancel",n),de("close",n);break;case"iframe":case"object":de("load",n);break;case"video":case"audio":for(h=0;h<cc.length;h++)de(cc[h],n);break;case"image":de("error",n),de("load",n);break;case"details":de("toggle",n);break;case"embed":case"source":case"link":de("error",n),de("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(at in o)if(o.hasOwnProperty(at)&&(h=o[at],h!=null))switch(at){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,s));default:Be(n,s,at,h,o,null)}return;default:if(_l(s)){for(yt in o)o.hasOwnProperty(yt)&&(h=o[yt],h!==void 0&&Gf(n,s,yt,h,o,void 0));return}}for(N in o)o.hasOwnProperty(N)&&(h=o[N],h!=null&&Be(n,s,N,h,o,null))}function K1(n,s,o,h){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,b=null,T=null,N=null,q=null,at=null,yt=null;for(dt in o){var vt=o[dt];if(o.hasOwnProperty(dt)&&vt!=null)switch(dt){case"checked":break;case"value":break;case"defaultValue":q=vt;default:h.hasOwnProperty(dt)||Be(n,s,dt,null,h,vt)}}for(var lt in h){var dt=h[lt];if(vt=o[lt],h.hasOwnProperty(lt)&&(dt!=null||vt!=null))switch(lt){case"type":b=dt;break;case"name":g=dt;break;case"checked":at=dt;break;case"defaultChecked":yt=dt;break;case"value":T=dt;break;case"defaultValue":N=dt;break;case"children":case"dangerouslySetInnerHTML":if(dt!=null)throw Error(i(137,s));break;default:dt!==vt&&Be(n,s,lt,dt,h,vt)}}cs(n,T,N,q,at,yt,b,g);return;case"select":dt=T=N=lt=null;for(b in o)if(q=o[b],o.hasOwnProperty(b)&&q!=null)switch(b){case"value":break;case"multiple":dt=q;default:h.hasOwnProperty(b)||Be(n,s,b,null,h,q)}for(g in h)if(b=h[g],q=o[g],h.hasOwnProperty(g)&&(b!=null||q!=null))switch(g){case"value":lt=b;break;case"defaultValue":N=b;break;case"multiple":T=b;default:b!==q&&Be(n,s,g,b,h,q)}s=N,o=T,h=dt,lt!=null?Xi(n,!!o,lt,!1):!!h!=!!o&&(s!=null?Xi(n,!!o,s,!0):Xi(n,!!o,o?[]:"",!1));return;case"textarea":dt=lt=null;for(N in o)if(g=o[N],o.hasOwnProperty(N)&&g!=null&&!h.hasOwnProperty(N))switch(N){case"value":break;case"children":break;default:Be(n,s,N,null,h,g)}for(T in h)if(g=h[T],b=o[T],h.hasOwnProperty(T)&&(g!=null||b!=null))switch(T){case"value":lt=g;break;case"defaultValue":dt=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(i(91));break;default:g!==b&&Be(n,s,T,g,h,b)}Sl(n,lt,dt);return;case"option":for(var $t in o)lt=o[$t],o.hasOwnProperty($t)&&lt!=null&&!h.hasOwnProperty($t)&&($t==="selected"?n.selected=!1:Be(n,s,$t,null,h,lt));for(q in h)lt=h[q],dt=o[q],h.hasOwnProperty(q)&&lt!==dt&&(lt!=null||dt!=null)&&(q==="selected"?n.selected=lt&&typeof lt!="function"&&typeof lt!="symbol":Be(n,s,q,lt,h,dt));return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Jt in o)lt=o[Jt],o.hasOwnProperty(Jt)&&lt!=null&&!h.hasOwnProperty(Jt)&&Be(n,s,Jt,null,h,lt);for(at in h)if(lt=h[at],dt=o[at],h.hasOwnProperty(at)&&lt!==dt&&(lt!=null||dt!=null))switch(at){case"children":case"dangerouslySetInnerHTML":if(lt!=null)throw Error(i(137,s));break;default:Be(n,s,at,lt,h,dt)}return;default:if(_l(s)){for(var je in o)lt=o[je],o.hasOwnProperty(je)&&lt!==void 0&&!h.hasOwnProperty(je)&&Gf(n,s,je,void 0,h,lt);for(yt in h)lt=h[yt],dt=o[yt],!h.hasOwnProperty(yt)||lt===dt||lt===void 0&&dt===void 0||Gf(n,s,yt,lt,h,dt);return}}for(var tt in o)lt=o[tt],o.hasOwnProperty(tt)&&lt!=null&&!h.hasOwnProperty(tt)&&Be(n,s,tt,null,h,lt);for(vt in h)lt=h[vt],dt=o[vt],!h.hasOwnProperty(vt)||lt===dt||lt==null&&dt==null||Be(n,s,vt,lt,h,dt)}function gb(n){switch(n){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function X1(){if(typeof performance.getEntriesByType=="function"){for(var n=0,s=0,o=performance.getEntriesByType("resource"),h=0;h<o.length;h++){var g=o[h],b=g.transferSize,T=g.initiatorType,N=g.duration;if(b&&N&&gb(T)){for(T=0,N=g.responseEnd,h+=1;h<o.length;h++){var q=o[h],at=q.startTime;if(at>N)break;var yt=q.transferSize,vt=q.initiatorType;yt&&gb(vt)&&(q=q.responseEnd,T+=yt*(q<N?1:(N-at)/(q-at)))}if(--h,s+=8*(b+T)/(g.duration/1e3),n++,10<n)break}}if(0<n)return s/n/1e6}return navigator.connection&&(n=navigator.connection.downlink,typeof n=="number")?n:5}var $f=null,Vf=null;function Zu(n){return n.nodeType===9?n:n.ownerDocument}function yb(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function bb(n,s){if(n===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&s==="foreignObject"?0:n}function Kf(n,s){return n==="textarea"||n==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Xf=null;function Y1(){var n=window.event;return n&&n.type==="popstate"?n===Xf?!1:(Xf=n,!0):(Xf=null,!1)}var vb=typeof setTimeout=="function"?setTimeout:void 0,Q1=typeof clearTimeout=="function"?clearTimeout:void 0,wb=typeof Promise=="function"?Promise:void 0,W1=typeof queueMicrotask=="function"?queueMicrotask:typeof wb<"u"?function(n){return wb.resolve(null).then(n).catch(Z1)}:vb;function Z1(n){setTimeout(function(){throw n})}function Hr(n){return n==="head"}function xb(n,s){var o=s,h=0;do{var g=o.nextSibling;if(n.removeChild(o),g&&g.nodeType===8)if(o=g.data,o==="/$"||o==="/&"){if(h===0){n.removeChild(g),Xo(s);return}h--}else if(o==="$"||o==="$?"||o==="$~"||o==="$!"||o==="&")h++;else if(o==="html")hc(n.ownerDocument.documentElement);else if(o==="head"){o=n.ownerDocument.head,hc(o);for(var b=o.firstChild;b;){var T=b.nextSibling,N=b.nodeName;b[mi]||N==="SCRIPT"||N==="STYLE"||N==="LINK"&&b.rel.toLowerCase()==="stylesheet"||o.removeChild(b),b=T}}else o==="body"&&hc(n.ownerDocument.body);o=g}while(o);Xo(s)}function Ab(n,s){var o=n;n=0;do{var h=o.nextSibling;if(o.nodeType===1?s?(o._stashedDisplay=o.style.display,o.style.display="none"):(o.style.display=o._stashedDisplay||"",o.getAttribute("style")===""&&o.removeAttribute("style")):o.nodeType===3&&(s?(o._stashedText=o.nodeValue,o.nodeValue=""):o.nodeValue=o._stashedText||""),h&&h.nodeType===8)if(o=h.data,o==="/$"){if(n===0)break;n--}else o!=="$"&&o!=="$?"&&o!=="$~"&&o!=="$!"||n++;o=h}while(o)}function Yf(n){var s=n.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var o=s;switch(s=s.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Yf(o),io(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}n.removeChild(o)}}function J1(n,s,o,h){for(;n.nodeType===1;){var g=o;if(n.nodeName.toLowerCase()!==s.toLowerCase()){if(!h&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(h){if(!n[mi])switch(s){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(b=n.getAttribute("rel"),b==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(b!==g.rel||n.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||n.getAttribute("title")!==(g.title==null?null:g.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(b=n.getAttribute("src"),(b!==(g.src==null?null:g.src)||n.getAttribute("type")!==(g.type==null?null:g.type)||n.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&b&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(s==="input"&&n.type==="hidden"){var b=g.name==null?null:""+g.name;if(g.type==="hidden"&&n.getAttribute("name")===b)return n}else return n;if(n=Ii(n.nextSibling),n===null)break}return null}function tx(n,s,o){if(s==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!o||(n=Ii(n.nextSibling),n===null))return null;return n}function Sb(n,s){for(;n.nodeType!==8;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!s||(n=Ii(n.nextSibling),n===null))return null;return n}function Qf(n){return n.data==="$?"||n.data==="$~"}function Wf(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState!=="loading"}function ex(n,s){var o=n.ownerDocument;if(n.data==="$~")n._reactRetry=s;else if(n.data!=="$?"||o.readyState!=="loading")s();else{var h=function(){s(),o.removeEventListener("DOMContentLoaded",h)};o.addEventListener("DOMContentLoaded",h),n._reactRetry=h}}function Ii(n){for(;n!=null;n=n.nextSibling){var s=n.nodeType;if(s===1||s===3)break;if(s===8){if(s=n.data,s==="$"||s==="$!"||s==="$?"||s==="$~"||s==="&"||s==="F!"||s==="F")break;if(s==="/$"||s==="/&")return null}}return n}var Zf=null;function Eb(n){n=n.nextSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="/$"||o==="/&"){if(s===0)return Ii(n.nextSibling);s--}else o!=="$"&&o!=="$!"&&o!=="$?"&&o!=="$~"&&o!=="&"||s++}n=n.nextSibling}return null}function _b(n){n=n.previousSibling;for(var s=0;n;){if(n.nodeType===8){var o=n.data;if(o==="$"||o==="$!"||o==="$?"||o==="$~"||o==="&"){if(s===0)return n;s--}else o!=="/$"&&o!=="/&"||s++}n=n.previousSibling}return null}function Cb(n,s,o){switch(s=Zu(o),n){case"html":if(n=s.documentElement,!n)throw Error(i(452));return n;case"head":if(n=s.head,!n)throw Error(i(453));return n;case"body":if(n=s.body,!n)throw Error(i(454));return n;default:throw Error(i(451))}}function hc(n){for(var s=n.attributes;s.length;)n.removeAttributeNode(s[0]);io(n)}var Ui=new Map,Tb=new Set;function Ju(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ir=st.d;st.d={f:nx,r:ix,D:sx,C:rx,L:ax,m:ox,X:cx,S:lx,M:ux};function nx(){var n=ir.f(),s=Gu();return n||s}function ix(n){var s=ke(n);s!==null&&s.tag===5&&s.type==="form"?Gg(s):ir.r(n)}var $o=typeof document>"u"?null:document;function Rb(n,s,o){var h=$o;if(h&&typeof s=="string"&&s){var g=Sn(s);g='link[rel="'+n+'"][href="'+g+'"]',typeof o=="string"&&(g+='[crossorigin="'+o+'"]'),Tb.has(g)||(Tb.add(g),n={rel:n,crossOrigin:o,href:s},h.querySelector(g)===null&&(s=h.createElement("link"),Bn(s,"link",n),rn(s),h.head.appendChild(s)))}}function sx(n){ir.D(n),Rb("dns-prefetch",n,null)}function rx(n,s){ir.C(n,s),Rb("preconnect",n,s)}function ax(n,s,o){ir.L(n,s,o);var h=$o;if(h&&n&&s){var g='link[rel="preload"][as="'+Sn(s)+'"]';s==="image"&&o&&o.imageSrcSet?(g+='[imagesrcset="'+Sn(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(g+='[imagesizes="'+Sn(o.imageSizes)+'"]')):g+='[href="'+Sn(n)+'"]';var b=g;switch(s){case"style":b=Vo(n);break;case"script":b=Ko(n)}Ui.has(b)||(n=y({rel:"preload",href:s==="image"&&o&&o.imageSrcSet?void 0:n,as:s},o),Ui.set(b,n),h.querySelector(g)!==null||s==="style"&&h.querySelector(dc(b))||s==="script"&&h.querySelector(fc(b))||(s=h.createElement("link"),Bn(s,"link",n),rn(s),h.head.appendChild(s)))}}function ox(n,s){ir.m(n,s);var o=$o;if(o&&n){var h=s&&typeof s.as=="string"?s.as:"script",g='link[rel="modulepreload"][as="'+Sn(h)+'"][href="'+Sn(n)+'"]',b=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":b=Ko(n)}if(!Ui.has(b)&&(n=y({rel:"modulepreload",href:n},s),Ui.set(b,n),o.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(fc(b)))return}h=o.createElement("link"),Bn(h,"link",n),rn(h),o.head.appendChild(h)}}}function lx(n,s,o){ir.S(n,s,o);var h=$o;if(h&&n){var g=qn(h).hoistableStyles,b=Vo(n);s=s||"default";var T=g.get(b);if(!T){var N={loading:0,preload:null};if(T=h.querySelector(dc(b)))N.loading=5;else{n=y({rel:"stylesheet",href:n,"data-precedence":s},o),(o=Ui.get(b))&&Jf(n,o);var q=T=h.createElement("link");rn(q),Bn(q,"link",n),q._p=new Promise(function(at,yt){q.onload=at,q.onerror=yt}),q.addEventListener("load",function(){N.loading|=1}),q.addEventListener("error",function(){N.loading|=2}),N.loading|=4,th(T,s,h)}T={type:"stylesheet",instance:T,count:1,state:N},g.set(b,T)}}}function cx(n,s){ir.X(n,s);var o=$o;if(o&&n){var h=qn(o).hoistableScripts,g=Ko(n),b=h.get(g);b||(b=o.querySelector(fc(g)),b||(n=y({src:n,async:!0},s),(s=Ui.get(g))&&tp(n,s),b=o.createElement("script"),rn(b),Bn(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function ux(n,s){ir.M(n,s);var o=$o;if(o&&n){var h=qn(o).hoistableScripts,g=Ko(n),b=h.get(g);b||(b=o.querySelector(fc(g)),b||(n=y({src:n,async:!0,type:"module"},s),(s=Ui.get(g))&&tp(n,s),b=o.createElement("script"),rn(b),Bn(b,"link",n),o.head.appendChild(b)),b={type:"script",instance:b,count:1,state:null},h.set(g,b))}}function Mb(n,s,o,h){var g=(g=Ut.current)?Ju(g):null;if(!g)throw Error(i(446));switch(n){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(s=Vo(o.href),o=qn(g).hoistableStyles,h=o.get(s),h||(h={type:"style",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){n=Vo(o.href);var b=qn(g).hoistableStyles,T=b.get(n);if(T||(g=g.ownerDocument||g,T={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},b.set(n,T),(b=g.querySelector(dc(n)))&&!b._p&&(T.instance=b,T.state.loading=5),Ui.has(n)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Ui.set(n,o),b||hx(g,n,o,T.state))),s&&h===null)throw Error(i(528,""));return T}if(s&&h!==null)throw Error(i(529,""));return null;case"script":return s=o.async,o=o.src,typeof o=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=Ko(o),o=qn(g).hoistableScripts,h=o.get(s),h||(h={type:"script",instance:null,count:0,state:null},o.set(s,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,n))}}function Vo(n){return'href="'+Sn(n)+'"'}function dc(n){return'link[rel="stylesheet"]['+n+"]"}function Db(n){return y({},n,{"data-precedence":n.precedence,precedence:null})}function hx(n,s,o,h){n.querySelector('link[rel="preload"][as="style"]['+s+"]")?h.loading=1:(s=n.createElement("link"),h.preload=s,s.addEventListener("load",function(){return h.loading|=1}),s.addEventListener("error",function(){return h.loading|=2}),Bn(s,"link",o),rn(s),n.head.appendChild(s))}function Ko(n){return'[src="'+Sn(n)+'"]'}function fc(n){return"script[async]"+n}function Ob(n,s,o){if(s.count++,s.instance===null)switch(s.type){case"style":var h=n.querySelector('style[data-href~="'+Sn(o.href)+'"]');if(h)return s.instance=h,rn(h),h;var g=y({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return h=(n.ownerDocument||n).createElement("style"),rn(h),Bn(h,"style",g),th(h,o.precedence,n),s.instance=h;case"stylesheet":g=Vo(o.href);var b=n.querySelector(dc(g));if(b)return s.state.loading|=4,s.instance=b,rn(b),b;h=Db(o),(g=Ui.get(g))&&Jf(h,g),b=(n.ownerDocument||n).createElement("link"),rn(b);var T=b;return T._p=new Promise(function(N,q){T.onload=N,T.onerror=q}),Bn(b,"link",h),s.state.loading|=4,th(b,o.precedence,n),s.instance=b;case"script":return b=Ko(o.src),(g=n.querySelector(fc(b)))?(s.instance=g,rn(g),g):(h=o,(g=Ui.get(b))&&(h=y({},o),tp(h,g)),n=n.ownerDocument||n,g=n.createElement("script"),rn(g),Bn(g,"link",h),n.head.appendChild(g),s.instance=g);case"void":return null;default:throw Error(i(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(h=s.instance,s.state.loading|=4,th(h,o.precedence,n));return s.instance}function th(n,s,o){for(var h=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,b=g,T=0;T<h.length;T++){var N=h[T];if(N.dataset.precedence===s)b=N;else if(b!==g)break}b?b.parentNode.insertBefore(n,b.nextSibling):(s=o.nodeType===9?o.head:o,s.insertBefore(n,s.firstChild))}function Jf(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.title==null&&(n.title=s.title)}function tp(n,s){n.crossOrigin==null&&(n.crossOrigin=s.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=s.referrerPolicy),n.integrity==null&&(n.integrity=s.integrity)}var eh=null;function Nb(n,s,o){if(eh===null){var h=new Map,g=eh=new Map;g.set(o,h)}else g=eh,h=g.get(o),h||(h=new Map,g.set(o,h));if(h.has(n))return h;for(h.set(n,null),o=o.getElementsByTagName(n),g=0;g<o.length;g++){var b=o[g];if(!(b[mi]||b[ze]||n==="link"&&b.getAttribute("rel")==="stylesheet")&&b.namespaceURI!=="http://www.w3.org/2000/svg"){var T=b.getAttribute(s)||"";T=n+T;var N=h.get(T);N?N.push(b):h.set(T,[b])}}return h}function kb(n,s,o){n=n.ownerDocument||n,n.head.insertBefore(o,s==="title"?n.querySelector("head > title"):null)}function dx(n,s,o){if(o===1||s.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;return s.rel==="stylesheet"?(n=s.disabled,typeof s.precedence=="string"&&n==null):!0;case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Lb(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}function fx(n,s,o,h){if(o.type==="stylesheet"&&(typeof h.media!="string"||matchMedia(h.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Vo(h.href),b=s.querySelector(dc(g));if(b){s=b._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(n.count++,n=nh.bind(n),s.then(n,n)),o.state.loading|=4,o.instance=b,rn(b);return}b=s.ownerDocument||s,h=Db(h),(g=Ui.get(g))&&Jf(h,g),b=b.createElement("link"),rn(b);var T=b;T._p=new Promise(function(N,q){T.onload=N,T.onerror=q}),Bn(b,"link",h),o.instance=b}n.stylesheets===null&&(n.stylesheets=new Map),n.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(n.count++,o=nh.bind(n),s.addEventListener("load",o),s.addEventListener("error",o))}}var ep=0;function px(n,s){return n.stylesheets&&n.count===0&&sh(n,n.stylesheets),0<n.count||0<n.imgCount?function(o){var h=setTimeout(function(){if(n.stylesheets&&sh(n,n.stylesheets),n.unsuspend){var b=n.unsuspend;n.unsuspend=null,b()}},6e4+s);0<n.imgBytes&&ep===0&&(ep=62500*X1());var g=setTimeout(function(){if(n.waitingForImages=!1,n.count===0&&(n.stylesheets&&sh(n,n.stylesheets),n.unsuspend)){var b=n.unsuspend;n.unsuspend=null,b()}},(n.imgBytes>ep?50:800)+s);return n.unsuspend=o,function(){n.unsuspend=null,clearTimeout(h),clearTimeout(g)}}:null}function nh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sh(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var ih=null;function sh(n,s){n.stylesheets=null,n.unsuspend!==null&&(n.count++,ih=new Map,s.forEach(mx,n),ih=null,nh.call(n))}function mx(n,s){if(!(s.state.loading&4)){var o=ih.get(n);if(o)var h=o.get(null);else{o=new Map,ih.set(n,o);for(var g=n.querySelectorAll("link[data-precedence],style[data-precedence]"),b=0;b<g.length;b++){var T=g[b];(T.nodeName==="LINK"||T.getAttribute("media")!=="not all")&&(o.set(T.dataset.precedence,T),h=T)}h&&o.set(null,h)}g=s.instance,T=g.getAttribute("data-precedence"),b=o.get(T)||h,b===h&&o.set(null,g),o.set(T,g),this.count++,h=nh.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),b?b.parentNode.insertBefore(g,b.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(g,n.firstChild)),s.state.loading|=4}}var pc={$$typeof:L,Provider:null,Consumer:null,_currentValue:wt,_currentValue2:wt,_threadCount:0};function gx(n,s,o,h,g,b,T,N,q){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ss(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ss(0),this.hiddenUpdates=ss(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=b,this.onRecoverableError=T,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=q,this.incompleteTransitions=new Map}function Pb(n,s,o,h,g,b,T,N,q,at,yt,vt){return n=new gx(n,s,o,T,q,at,yt,vt,N),s=1,b===!0&&(s|=24),b=bi(3,null,null,s),n.current=b,b.stateNode=n,s=kd(),s.refCount++,n.pooledCache=s,s.refCount++,b.memoizedState={element:h,isDehydrated:o,cache:s},jd(b),n}function Bb(n){return n?(n=Eo,n):Eo}function jb(n,s,o,h,g,b){g=Bb(g),h.context===null?h.context=g:h.pendingContext=g,h=Or(s),h.payload={element:o},b=b===void 0?null:b,b!==null&&(h.callback=b),o=Nr(n,h,s),o!==null&&(li(o,n,s),Vl(o,n,s))}function Fb(n,s){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var o=n.retryLane;n.retryLane=o!==0&&o<s?o:s}}function np(n,s){Fb(n,s),(n=n.alternate)&&Fb(n,s)}function Ib(n){if(n.tag===13||n.tag===31){var s=De(n,67108864);s!==null&&li(s,n,67108864),np(n,67108864)}}function Ub(n){if(n.tag===13||n.tag===31){var s=Si();s=vl(s);var o=De(n,s);o!==null&&li(o,n,s),np(n,s)}}var rh=!0;function yx(n,s,o,h){var g=G.T;G.T=null;var b=st.p;try{st.p=2,ip(n,s,o,h)}finally{st.p=b,G.T=g}}function bx(n,s,o,h){var g=G.T;G.T=null;var b=st.p;try{st.p=8,ip(n,s,o,h)}finally{st.p=b,G.T=g}}function ip(n,s,o,h){if(rh){var g=sp(h);if(g===null)qf(n,s,h,ah,o),Hb(n,h);else if(wx(g,n,s,o,h))h.stopPropagation();else if(Hb(n,h),s&4&&-1<vx.indexOf(n)){for(;g!==null;){var b=ke(g);if(b!==null)switch(b.tag){case 3:if(b=b.stateNode,b.current.memoizedState.isDehydrated){var T=Vi(b.pendingLanes);if(T!==0){var N=b;for(N.pendingLanes|=2,N.entangledLanes|=2;T;){var q=1<<31-Ft(T);N.entanglements[1]|=q,T&=~q}ys(b),(Ee&6)===0&&(Hu=zn()+500,lc(0))}}break;case 31:case 13:N=De(b,2),N!==null&&li(N,b,2),Gu(),np(b,2)}if(b=sp(h),b===null&&qf(n,s,h,ah,o),b===g)break;g=b}g!==null&&h.stopPropagation()}else qf(n,s,h,null,o)}}function sp(n){return n=ao(n),rp(n)}var ah=null;function rp(n){if(ah=null,n=os(n),n!==null){var s=l(n);if(s===null)n=null;else{var o=s.tag;if(o===13){if(n=c(s),n!==null)return n;n=null}else if(o===31){if(n=u(s),n!==null)return n;n=null}else if(o===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;n=null}else s!==n&&(n=null)}}return ah=n,null}function zb(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(ra()){case Hn:return 2;case ns:return 8;case hr:case aa:return 32;case to:return 268435456;default:return 32}default:return 32}}var ap=!1,qr=null,Gr=null,$r=null,mc=new Map,gc=new Map,Vr=[],vx="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Hb(n,s){switch(n){case"focusin":case"focusout":qr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":$r=null;break;case"pointerover":case"pointerout":mc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":gc.delete(s.pointerId)}}function yc(n,s,o,h,g,b){return n===null||n.nativeEvent!==b?(n={blockedOn:s,domEventName:o,eventSystemFlags:h,nativeEvent:b,targetContainers:[g]},s!==null&&(s=ke(s),s!==null&&Ib(s)),n):(n.eventSystemFlags|=h,s=n.targetContainers,g!==null&&s.indexOf(g)===-1&&s.push(g),n)}function wx(n,s,o,h,g){switch(s){case"focusin":return qr=yc(qr,n,s,o,h,g),!0;case"dragenter":return Gr=yc(Gr,n,s,o,h,g),!0;case"mouseover":return $r=yc($r,n,s,o,h,g),!0;case"pointerover":var b=g.pointerId;return mc.set(b,yc(mc.get(b)||null,n,s,o,h,g)),!0;case"gotpointercapture":return b=g.pointerId,gc.set(b,yc(gc.get(b)||null,n,s,o,h,g)),!0}return!1}function qb(n){var s=os(n.target);if(s!==null){var o=l(s);if(o!==null){if(s=o.tag,s===13){if(s=c(o),s!==null){n.blockedOn=s,da(n.priority,function(){Ub(o)});return}}else if(s===31){if(s=u(o),s!==null){n.blockedOn=s,da(n.priority,function(){Ub(o)});return}}else if(s===3&&o.stateNode.current.memoizedState.isDehydrated){n.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}n.blockedOn=null}function oh(n){if(n.blockedOn!==null)return!1;for(var s=n.targetContainers;0<s.length;){var o=sp(n.nativeEvent);if(o===null){o=n.nativeEvent;var h=new o.constructor(o.type,o);Oi=h,o.target.dispatchEvent(h),Oi=null}else return s=ke(o),s!==null&&Ib(s),n.blockedOn=o,!1;s.shift()}return!0}function Gb(n,s,o){oh(n)&&o.delete(s)}function xx(){ap=!1,qr!==null&&oh(qr)&&(qr=null),Gr!==null&&oh(Gr)&&(Gr=null),$r!==null&&oh($r)&&($r=null),mc.forEach(Gb),gc.forEach(Gb)}function lh(n,s){n.blockedOn===s&&(n.blockedOn=null,ap||(ap=!0,a.unstable_scheduleCallback(a.unstable_NormalPriority,xx)))}var ch=null;function $b(n){ch!==n&&(ch=n,a.unstable_scheduleCallback(a.unstable_NormalPriority,function(){ch===n&&(ch=null);for(var s=0;s<n.length;s+=3){var o=n[s],h=n[s+1],g=n[s+2];if(typeof h!="function"){if(rp(h||o)===null)continue;break}var b=ke(o);b!==null&&(n.splice(s,3),s-=3,sf(b,{pending:!0,data:g,method:o.method,action:h},h,g))}}))}function Xo(n){function s(q){return lh(q,n)}qr!==null&&lh(qr,n),Gr!==null&&lh(Gr,n),$r!==null&&lh($r,n),mc.forEach(s),gc.forEach(s);for(var o=0;o<Vr.length;o++){var h=Vr[o];h.blockedOn===n&&(h.blockedOn=null)}for(;0<Vr.length&&(o=Vr[0],o.blockedOn===null);)qb(o),o.blockedOn===null&&Vr.shift();if(o=(n.ownerDocument||n).$$reactFormReplay,o!=null)for(h=0;h<o.length;h+=3){var g=o[h],b=o[h+1],T=g[sn]||null;if(typeof b=="function")T||$b(o);else if(T){var N=null;if(b&&b.hasAttribute("formAction")){if(g=b,T=b[sn]||null)N=T.formAction;else if(rp(g)!==null)continue}else N=T.action;typeof N=="function"?o[h+1]=N:(o.splice(h,3),h-=3),$b(o)}}}function Vb(){function n(b){b.canIntercept&&b.info==="react-transition"&&b.intercept({handler:function(){return new Promise(function(T){return g=T})},focusReset:"manual",scroll:"manual"})}function s(){g!==null&&(g(),g=null),h||setTimeout(o,20)}function o(){if(!h&&!navigation.transition){var b=navigation.currentEntry;b&&b.url!=null&&navigation.navigate(b.url,{state:b.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var h=!1,g=null;return navigation.addEventListener("navigate",n),navigation.addEventListener("navigatesuccess",s),navigation.addEventListener("navigateerror",s),setTimeout(o,100),function(){h=!0,navigation.removeEventListener("navigate",n),navigation.removeEventListener("navigatesuccess",s),navigation.removeEventListener("navigateerror",s),g!==null&&(g(),g=null)}}}function op(n){this._internalRoot=n}uh.prototype.render=op.prototype.render=function(n){var s=this._internalRoot;if(s===null)throw Error(i(409));var o=s.current,h=Si();jb(o,h,n,s,null,null)},uh.prototype.unmount=op.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var s=n.containerInfo;jb(n.current,2,null,n,null,null),Gu(),s[Yn]=null}};function uh(n){this._internalRoot=n}uh.prototype.unstable_scheduleHydration=function(n){if(n){var s=ha();n={blockedOn:null,target:n,priority:s};for(var o=0;o<Vr.length&&s!==0&&s<Vr[o].priority;o++);Vr.splice(o,0,n),o===0&&qb(n)}};var Kb=t.version;if(Kb!=="19.2.4")throw Error(i(527,Kb,"19.2.4"));st.findDOMNode=function(n){var s=n._reactInternals;if(s===void 0)throw typeof n.render=="function"?Error(i(188)):(n=Object.keys(n).join(","),Error(i(268,n)));return n=f(s),n=n!==null?p(n):null,n=n===null?null:n.stateNode,n};var Ax={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:G,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var hh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!hh.isDisabled&&hh.supportsFiber)try{is=hh.inject(Ax),Dn=hh}catch{}}return vc.createRoot=function(n,s){if(!r(n))throw Error(i(299));var o=!1,h="",g=ty,b=ey,T=ny;return s!=null&&(s.unstable_strictMode===!0&&(o=!0),s.identifierPrefix!==void 0&&(h=s.identifierPrefix),s.onUncaughtError!==void 0&&(g=s.onUncaughtError),s.onCaughtError!==void 0&&(b=s.onCaughtError),s.onRecoverableError!==void 0&&(T=s.onRecoverableError)),s=Pb(n,1,!1,null,null,o,h,null,g,b,T,Vb),n[Yn]=s.current,Hf(n),new op(s)},vc.hydrateRoot=function(n,s,o){if(!r(n))throw Error(i(299));var h=!1,g="",b=ty,T=ey,N=ny,q=null;return o!=null&&(o.unstable_strictMode===!0&&(h=!0),o.identifierPrefix!==void 0&&(g=o.identifierPrefix),o.onUncaughtError!==void 0&&(b=o.onUncaughtError),o.onCaughtError!==void 0&&(T=o.onCaughtError),o.onRecoverableError!==void 0&&(N=o.onRecoverableError),o.formState!==void 0&&(q=o.formState)),s=Pb(n,1,!0,s,o??null,h,g,q,b,T,N,Vb),s.context=Bb(null),o=s.current,h=Si(),h=vl(h),g=Or(h),g.callback=null,Nr(o,g,h),o=h,s.current.lanes=o,Mi(s,o),ys(s),n[Yn]=s.current,Hf(n),new uh(s)},vc.version="19.2.4",vc}var rv;function Nx(){if(rv)return hp.exports;rv=1;function a(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(a)}catch(t){console.error(t)}}return a(),hp.exports=Ox(),hp.exports}var kx=Nx();var av="popstate";function Lx(a={}){function t(i,r){let{pathname:l,search:c,hash:u}=i.location;return Dp("",{pathname:l,search:c,hash:u},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function e(i,r){return typeof r=="string"?r:Nc(r)}return Bx(t,e,null,a)}function Ye(a,t){if(a===!1||a===null||typeof a>"u")throw new Error(t)}function Ji(a,t){if(!a){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function Px(){return Math.random().toString(36).substring(2,10)}function ov(a,t){return{usr:a.state,key:a.key,idx:t}}function Dp(a,t,e=null,i){return{pathname:typeof a=="string"?a:a.pathname,search:"",hash:"",...typeof t=="string"?ul(t):t,state:e,key:t&&t.key||i||Px()}}function Nc({pathname:a="/",search:t="",hash:e=""}){return t&&t!=="?"&&(a+=t.charAt(0)==="?"?t:"?"+t),e&&e!=="#"&&(a+=e.charAt(0)==="#"?e:"#"+e),a}function ul(a){let t={};if(a){let e=a.indexOf("#");e>=0&&(t.hash=a.substring(e),a=a.substring(0,e));let i=a.indexOf("?");i>=0&&(t.search=a.substring(i),a=a.substring(0,i)),a&&(t.pathname=a)}return t}function Bx(a,t,e,i={}){let{window:r=document.defaultView,v5Compat:l=!1}=i,c=r.history,u="POP",d=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function y(){u="POP";let C=p(),M=C==null?null:C-f;f=C,d&&d({action:u,location:S.location,delta:M})}function w(C,M){u="PUSH";let k=Dp(S.location,C,M);f=p()+1;let L=ov(k,f),j=S.createHref(k);try{c.pushState(L,"",j)}catch(F){if(F instanceof DOMException&&F.name==="DataCloneError")throw F;r.location.assign(j)}l&&d&&d({action:u,location:S.location,delta:1})}function A(C,M){u="REPLACE";let k=Dp(S.location,C,M);f=p();let L=ov(k,f),j=S.createHref(k);c.replaceState(L,"",j),l&&d&&d({action:u,location:S.location,delta:0})}function _(C){return jx(C)}let S={get action(){return u},get location(){return a(r,c)},listen(C){if(d)throw new Error("A history only accepts one active listener");return r.addEventListener(av,y),d=C,()=>{r.removeEventListener(av,y),d=null}},createHref(C){return t(r,C)},createURL:_,encodeLocation(C){let M=_(C);return{pathname:M.pathname,search:M.search,hash:M.hash}},push:w,replace:A,go(C){return c.go(C)}};return S}function jx(a,t=!1){let e="http://localhost";typeof window<"u"&&(e=window.location.origin!=="null"?window.location.origin:window.location.href),Ye(e,"No window.location.(origin|href) available to create URL");let i=typeof a=="string"?a:Nc(a);return i=i.replace(/ $/,"%20"),!t&&i.startsWith("//")&&(i=e+i),new URL(i,e)}function _0(a,t,e="/"){return Fx(a,t,e,!1)}function Fx(a,t,e,i){let r=typeof t=="string"?ul(t):t,l=ur(r.pathname||"/",e);if(l==null)return null;let c=C0(a);Ix(c);let u=null;for(let d=0;u==null&&d<c.length;++d){let f=Qx(l);u=Xx(c[d],f,i)}return u}function C0(a,t=[],e=[],i="",r=!1){let l=(c,u,d=r,f)=>{let p={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(i)&&d)return;Ye(p.relativePath.startsWith(i),`Absolute route path "${p.relativePath}" nested under path "${i}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(i.length)}let y=cr([i,p.relativePath]),w=e.concat(p);c.children&&c.children.length>0&&(Ye(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${y}".`),C0(c.children,t,w,y,d)),!(c.path==null&&!c.index)&&t.push({path:y,score:Vx(y,c.index),routesMeta:w})};return a.forEach((c,u)=>{if(c.path===""||!c.path?.includes("?"))l(c,u);else for(let d of T0(c.path))l(c,u,!0,d)}),t}function T0(a){let t=a.split("/");if(t.length===0)return[];let[e,...i]=t,r=e.endsWith("?"),l=e.replace(/\?$/,"");if(i.length===0)return r?[l,""]:[l];let c=T0(i.join("/")),u=[];return u.push(...c.map(d=>d===""?l:[l,d].join("/"))),r&&u.push(...c),u.map(d=>a.startsWith("/")&&d===""?"/":d)}function Ix(a){a.sort((t,e)=>t.score!==e.score?e.score-t.score:Kx(t.routesMeta.map(i=>i.childrenIndex),e.routesMeta.map(i=>i.childrenIndex)))}var Ux=/^:[\w-]+$/,zx=3,Hx=2,qx=1,Gx=10,$x=-2,lv=a=>a==="*";function Vx(a,t){let e=a.split("/"),i=e.length;return e.some(lv)&&(i+=$x),t&&(i+=Hx),e.filter(r=>!lv(r)).reduce((r,l)=>r+(Ux.test(l)?zx:l===""?qx:Gx),i)}function Kx(a,t){return a.length===t.length&&a.slice(0,-1).every((i,r)=>i===t[r])?a[a.length-1]-t[t.length-1]:0}function Xx(a,t,e=!1){let{routesMeta:i}=a,r={},l="/",c=[];for(let u=0;u<i.length;++u){let d=i[u],f=u===i.length-1,p=l==="/"?t:t.slice(l.length)||"/",y=Fh({path:d.relativePath,caseSensitive:d.caseSensitive,end:f},p),w=d.route;if(!y&&f&&e&&!i[i.length-1].route.index&&(y=Fh({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},p)),!y)return null;Object.assign(r,y.params),c.push({params:r,pathname:cr([l,y.pathname]),pathnameBase:tA(cr([l,y.pathnameBase])),route:w}),y.pathnameBase!=="/"&&(l=cr([l,y.pathnameBase]))}return c}function Fh(a,t){typeof a=="string"&&(a={path:a,caseSensitive:!1,end:!0});let[e,i]=Yx(a.path,a.caseSensitive,a.end),r=t.match(e);if(!r)return null;let l=r[0],c=l.replace(/(.)\/+$/,"$1"),u=r.slice(1);return{params:i.reduce((f,{paramName:p,isOptional:y},w)=>{if(p==="*"){let _=u[w]||"";c=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const A=u[w];return y&&!A?f[p]=void 0:f[p]=(A||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:a}}function Yx(a,t=!1,e=!0){Ji(a==="*"||!a.endsWith("*")||a.endsWith("/*"),`Route path "${a}" will be treated as if it were "${a.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${a.replace(/\*$/,"/*")}".`);let i=[],r="^"+a.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,d)=>(i.push({paramName:u,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return a.endsWith("*")?(i.push({paramName:"*"}),r+=a==="*"||a==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):e?r+="\\/*$":a!==""&&a!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,t?void 0:"i"),i]}function Qx(a){try{return a.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Ji(!1,`The URL path "${a}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),a}}function ur(a,t){if(t==="/")return a;if(!a.toLowerCase().startsWith(t.toLowerCase()))return null;let e=t.endsWith("/")?t.length-1:t.length,i=a.charAt(e);return i&&i!=="/"?null:a.slice(e)||"/"}var Wx=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i;function Zx(a,t="/"){let{pathname:e,search:i="",hash:r=""}=typeof a=="string"?ul(a):a,l;return e?(e=e.replace(/\/\/+/g,"/"),e.startsWith("/")?l=cv(e.substring(1),"/"):l=cv(e,t)):l=t,{pathname:l,search:eA(i),hash:nA(r)}}function cv(a,t){let e=t.replace(/\/+$/,"").split("/");return a.split("/").forEach(r=>{r===".."?e.length>1&&e.pop():r!=="."&&e.push(r)}),e.length>1?e.join("/"):"/"}function mp(a,t,e,i){return`Cannot include a '${a}' character in a manually specified \`to.${t}\` field [${JSON.stringify(i)}].  Please separate it out to the \`to.${e}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Jx(a){return a.filter((t,e)=>e===0||t.route.path&&t.route.path.length>0)}function cm(a){let t=Jx(a);return t.map((e,i)=>i===t.length-1?e.pathname:e.pathnameBase)}function um(a,t,e,i=!1){let r;typeof a=="string"?r=ul(a):(r={...a},Ye(!r.pathname||!r.pathname.includes("?"),mp("?","pathname","search",r)),Ye(!r.pathname||!r.pathname.includes("#"),mp("#","pathname","hash",r)),Ye(!r.search||!r.search.includes("#"),mp("#","search","hash",r)));let l=a===""||r.pathname==="",c=l?"/":r.pathname,u;if(c==null)u=e;else{let y=t.length-1;if(!i&&c.startsWith("..")){let w=c.split("/");for(;w[0]==="..";)w.shift(),y-=1;r.pathname=w.join("/")}u=y>=0?t[y]:"/"}let d=Zx(r,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&e.endsWith("/");return!d.pathname.endsWith("/")&&(f||p)&&(d.pathname+="/"),d}var cr=a=>a.join("/").replace(/\/\/+/g,"/"),tA=a=>a.replace(/\/+$/,"").replace(/^\/*/,"/"),eA=a=>!a||a==="?"?"":a.startsWith("?")?a:"?"+a,nA=a=>!a||a==="#"?"":a.startsWith("#")?a:"#"+a,iA=class{constructor(a,t,e,i=!1){this.status=a,this.statusText=t||"",this.internal=i,e instanceof Error?(this.data=e.toString(),this.error=e):this.data=e}};function sA(a){return a!=null&&typeof a.status=="number"&&typeof a.statusText=="string"&&typeof a.internal=="boolean"&&"data"in a}function rA(a){return a.map(t=>t.route.path).filter(Boolean).join("/").replace(/\/\/*/g,"/")||"/"}var R0=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function M0(a,t){let e=a;if(typeof e!="string"||!Wx.test(e))return{absoluteURL:void 0,isExternal:!1,to:e};let i=e,r=!1;if(R0)try{let l=new URL(window.location.href),c=e.startsWith("//")?new URL(l.protocol+e):new URL(e),u=ur(c.pathname,t);c.origin===l.origin&&u!=null?e=u+c.search+c.hash:r=!0}catch{Ji(!1,`<Link to="${e}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}return{absoluteURL:i,isExternal:r,to:e}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var D0=["POST","PUT","PATCH","DELETE"];new Set(D0);var aA=["GET",...D0];new Set(aA);var hl=U.createContext(null);hl.displayName="DataRouter";var Xh=U.createContext(null);Xh.displayName="DataRouterState";var oA=U.createContext(!1),O0=U.createContext({isTransitioning:!1});O0.displayName="ViewTransition";var lA=U.createContext(new Map);lA.displayName="Fetchers";var cA=U.createContext(null);cA.displayName="Await";var Ri=U.createContext(null);Ri.displayName="Navigation";var Ic=U.createContext(null);Ic.displayName="Location";var ts=U.createContext({outlet:null,matches:[],isDataRoute:!1});ts.displayName="Route";var hm=U.createContext(null);hm.displayName="RouteError";var N0="REACT_ROUTER_ERROR",uA="REDIRECT",hA="ROUTE_ERROR_RESPONSE";function dA(a){if(a.startsWith(`${N0}:${uA}:{`))try{let t=JSON.parse(a.slice(28));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.location=="string"&&typeof t.reloadDocument=="boolean"&&typeof t.replace=="boolean")return t}catch{}}function fA(a){if(a.startsWith(`${N0}:${hA}:{`))try{let t=JSON.parse(a.slice(40));if(typeof t=="object"&&t&&typeof t.status=="number"&&typeof t.statusText=="string")return new iA(t.status,t.statusText,t.data)}catch{}}function pA(a,{relative:t}={}){Ye(dl(),"useHref() may be used only in the context of a <Router> component.");let{basename:e,navigator:i}=U.useContext(Ri),{hash:r,pathname:l,search:c}=Uc(a,{relative:t}),u=l;return e!=="/"&&(u=l==="/"?e:cr([e,l])),i.createHref({pathname:u,search:c,hash:r})}function dl(){return U.useContext(Ic)!=null}function ta(){return Ye(dl(),"useLocation() may be used only in the context of a <Router> component."),U.useContext(Ic).location}var k0="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function L0(a){U.useContext(Ri).static||U.useLayoutEffect(a)}function ea(){let{isDataRoute:a}=U.useContext(ts);return a?TA():mA()}function mA(){Ye(dl(),"useNavigate() may be used only in the context of a <Router> component.");let a=U.useContext(hl),{basename:t,navigator:e}=U.useContext(Ri),{matches:i}=U.useContext(ts),{pathname:r}=ta(),l=JSON.stringify(cm(i)),c=U.useRef(!1);return L0(()=>{c.current=!0}),U.useCallback((d,f={})=>{if(Ji(c.current,k0),!c.current)return;if(typeof d=="number"){e.go(d);return}let p=um(d,JSON.parse(l),r,f.relative==="path");a==null&&t!=="/"&&(p.pathname=p.pathname==="/"?t:cr([t,p.pathname])),(f.replace?e.replace:e.push)(p,f.state,f)},[t,e,l,r,a])}U.createContext(null);function dm(){let{matches:a}=U.useContext(ts),t=a[a.length-1];return t?t.params:{}}function Uc(a,{relative:t}={}){let{matches:e}=U.useContext(ts),{pathname:i}=ta(),r=JSON.stringify(cm(e));return U.useMemo(()=>um(a,JSON.parse(r),i,t==="path"),[a,r,i,t])}function gA(a,t){return P0(a,t)}function P0(a,t,e,i,r){Ye(dl(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=U.useContext(Ri),{matches:c}=U.useContext(ts),u=c[c.length-1],d=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",y=u&&u.route;{let k=y&&y.path||"";j0(f,!y||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let w=ta(),A;if(t){let k=typeof t=="string"?ul(t):t;Ye(p==="/"||k.pathname?.startsWith(p),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${k.pathname}" was given in the \`location\` prop.`),A=k}else A=w;let _=A.pathname||"/",S=_;if(p!=="/"){let k=p.replace(/^\//,"").split("/");S="/"+_.replace(/^\//,"").split("/").slice(k.length).join("/")}let C=_0(a,{pathname:S});Ji(y||C!=null,`No routes matched location "${A.pathname}${A.search}${A.hash}" `),Ji(C==null||C[C.length-1].route.element!==void 0||C[C.length-1].route.Component!==void 0||C[C.length-1].route.lazy!==void 0,`Matched leaf route at location "${A.pathname}${A.search}${A.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let M=xA(C&&C.map(k=>Object.assign({},k,{params:Object.assign({},d,k.params),pathname:cr([p,l.encodeLocation?l.encodeLocation(k.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?p:cr([p,l.encodeLocation?l.encodeLocation(k.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:k.pathnameBase])})),c,e,i,r);return t&&M?U.createElement(Ic.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...A},navigationType:"POP"}},M):M}function yA(){let a=CA(),t=sA(a)?`${a.status} ${a.statusText}`:a instanceof Error?a.message:JSON.stringify(a),e=a instanceof Error?a.stack:null,i="rgba(200,200,200, 0.5)",r={padding:"0.5rem",backgroundColor:i},l={padding:"2px 4px",backgroundColor:i},c=null;return console.error("Error handled by React Router default ErrorBoundary:",a),c=U.createElement(U.Fragment,null,U.createElement("p",null," Hey developer "),U.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",U.createElement("code",{style:l},"ErrorBoundary")," or"," ",U.createElement("code",{style:l},"errorElement")," prop on your route.")),U.createElement(U.Fragment,null,U.createElement("h2",null,"Unexpected Application Error!"),U.createElement("h3",{style:{fontStyle:"italic"}},t),e?U.createElement("pre",{style:r},e):null,c)}var bA=U.createElement(yA,null),B0=class extends U.Component{constructor(a){super(a),this.state={location:a.location,revalidation:a.revalidation,error:a.error}}static getDerivedStateFromError(a){return{error:a}}static getDerivedStateFromProps(a,t){return t.location!==a.location||t.revalidation!=="idle"&&a.revalidation==="idle"?{error:a.error,location:a.location,revalidation:a.revalidation}:{error:a.error!==void 0?a.error:t.error,location:t.location,revalidation:a.revalidation||t.revalidation}}componentDidCatch(a,t){this.props.onError?this.props.onError(a,t):console.error("React Router caught the following error during render",a)}render(){let a=this.state.error;if(this.context&&typeof a=="object"&&a&&"digest"in a&&typeof a.digest=="string"){const e=fA(a.digest);e&&(a=e)}let t=a!==void 0?U.createElement(ts.Provider,{value:this.props.routeContext},U.createElement(hm.Provider,{value:a,children:this.props.component})):this.props.children;return this.context?U.createElement(vA,{error:a},t):t}};B0.contextType=oA;var gp=new WeakMap;function vA({children:a,error:t}){let{basename:e}=U.useContext(Ri);if(typeof t=="object"&&t&&"digest"in t&&typeof t.digest=="string"){let i=dA(t.digest);if(i){let r=gp.get(t);if(r)throw r;let l=M0(i.location,e);if(R0&&!gp.get(t))if(l.isExternal||i.reloadDocument)window.location.href=l.absoluteURL||l.to;else{const c=Promise.resolve().then(()=>window.__reactRouterDataRouter.navigate(l.to,{replace:i.replace}));throw gp.set(t,c),c}return U.createElement("meta",{httpEquiv:"refresh",content:`0;url=${l.absoluteURL||l.to}`})}}return a}function wA({routeContext:a,match:t,children:e}){let i=U.useContext(hl);return i&&i.static&&i.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(i.staticContext._deepestRenderedBoundaryId=t.route.id),U.createElement(ts.Provider,{value:a},e)}function xA(a,t=[],e=null,i=null,r=null){if(a==null){if(!e)return null;if(e.errors)a=e.matches;else if(t.length===0&&!e.initialized&&e.matches.length>0)a=e.matches;else return null}let l=a,c=e?.errors;if(c!=null){let p=l.findIndex(y=>y.route.id&&c?.[y.route.id]!==void 0);Ye(p>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,p+1))}let u=!1,d=-1;if(e)for(let p=0;p<l.length;p++){let y=l[p];if((y.route.HydrateFallback||y.route.hydrateFallbackElement)&&(d=p),y.route.id){let{loaderData:w,errors:A}=e,_=y.route.loader&&!w.hasOwnProperty(y.route.id)&&(!A||A[y.route.id]===void 0);if(y.route.lazy||_){u=!0,d>=0?l=l.slice(0,d+1):l=[l[0]];break}}}let f=e&&i?(p,y)=>{i(p,{location:e.location,params:e.matches?.[0]?.params??{},unstable_pattern:rA(e.matches),errorInfo:y})}:void 0;return l.reduceRight((p,y,w)=>{let A,_=!1,S=null,C=null;e&&(A=c&&y.route.id?c[y.route.id]:void 0,S=y.route.errorElement||bA,u&&(d<0&&w===0?(j0("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,C=null):d===w&&(_=!0,C=y.route.hydrateFallbackElement||null)));let M=t.concat(l.slice(0,w+1)),k=()=>{let L;return A?L=S:_?L=C:y.route.Component?L=U.createElement(y.route.Component,null):y.route.element?L=y.route.element:L=p,U.createElement(wA,{match:y,routeContext:{outlet:p,matches:M,isDataRoute:e!=null},children:L})};return e&&(y.route.ErrorBoundary||y.route.errorElement||w===0)?U.createElement(B0,{location:e.location,revalidation:e.revalidation,component:S,error:A,children:k(),routeContext:{outlet:null,matches:M,isDataRoute:!0},onError:f}):k()},null)}function fm(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function AA(a){let t=U.useContext(hl);return Ye(t,fm(a)),t}function SA(a){let t=U.useContext(Xh);return Ye(t,fm(a)),t}function EA(a){let t=U.useContext(ts);return Ye(t,fm(a)),t}function pm(a){let t=EA(a),e=t.matches[t.matches.length-1];return Ye(e.route.id,`${a} can only be used on routes that contain a unique "id"`),e.route.id}function _A(){return pm("useRouteId")}function CA(){let a=U.useContext(hm),t=SA("useRouteError"),e=pm("useRouteError");return a!==void 0?a:t.errors?.[e]}function TA(){let{router:a}=AA("useNavigate"),t=pm("useNavigate"),e=U.useRef(!1);return L0(()=>{e.current=!0}),U.useCallback(async(r,l={})=>{Ji(e.current,k0),e.current&&(typeof r=="number"?await a.navigate(r):await a.navigate(r,{fromRouteId:t,...l}))},[a,t])}var uv={};function j0(a,t,e){!t&&!uv[a]&&(uv[a]=!0,Ji(!1,e))}U.memo(RA);function RA({routes:a,future:t,state:e,onError:i}){return P0(a,void 0,e,i,t)}function mm({to:a,replace:t,state:e,relative:i}){Ye(dl(),"<Navigate> may be used only in the context of a <Router> component.");let{static:r}=U.useContext(Ri);Ji(!r,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=U.useContext(ts),{pathname:c}=ta(),u=ea(),d=um(a,cm(l),c,i==="path"),f=JSON.stringify(d);return U.useEffect(()=>{u(JSON.parse(f),{replace:t,state:e,relative:i})},[u,f,i,t,e]),null}function Xr(a){Ye(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function MA({basename:a="/",children:t=null,location:e,navigationType:i="POP",navigator:r,static:l=!1,unstable_useTransitions:c}){Ye(!dl(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=a.replace(/^\/*/,"/"),d=U.useMemo(()=>({basename:u,navigator:r,static:l,unstable_useTransitions:c,future:{}}),[u,r,l,c]);typeof e=="string"&&(e=ul(e));let{pathname:f="/",search:p="",hash:y="",state:w=null,key:A="default"}=e,_=U.useMemo(()=>{let S=ur(f,u);return S==null?null:{location:{pathname:S,search:p,hash:y,state:w,key:A},navigationType:i}},[u,f,p,y,w,A,i]);return Ji(_!=null,`<Router basename="${u}"> is not able to match the URL "${f}${p}${y}" because it does not start with the basename, so the <Router> won't render anything.`),_==null?null:U.createElement(Ri.Provider,{value:d},U.createElement(Ic.Provider,{children:t,value:_}))}function DA({children:a,location:t}){return gA(Op(a),t)}function Op(a,t=[]){let e=[];return U.Children.forEach(a,(i,r)=>{if(!U.isValidElement(i))return;let l=[...t,r];if(i.type===U.Fragment){e.push.apply(e,Op(i.props.children,l));return}Ye(i.type===Xr,`[${typeof i.type=="string"?i.type:i.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ye(!i.props.index||!i.props.children,"An index route cannot have child routes.");let c={id:i.props.id||l.join("-"),caseSensitive:i.props.caseSensitive,element:i.props.element,Component:i.props.Component,index:i.props.index,path:i.props.path,middleware:i.props.middleware,loader:i.props.loader,action:i.props.action,hydrateFallbackElement:i.props.hydrateFallbackElement,HydrateFallback:i.props.HydrateFallback,errorElement:i.props.errorElement,ErrorBoundary:i.props.ErrorBoundary,hasErrorBoundary:i.props.hasErrorBoundary===!0||i.props.ErrorBoundary!=null||i.props.errorElement!=null,shouldRevalidate:i.props.shouldRevalidate,handle:i.props.handle,lazy:i.props.lazy};i.props.children&&(c.children=Op(i.props.children,l)),e.push(c)}),e}var Rh="get",Mh="application/x-www-form-urlencoded";function Yh(a){return typeof HTMLElement<"u"&&a instanceof HTMLElement}function OA(a){return Yh(a)&&a.tagName.toLowerCase()==="button"}function NA(a){return Yh(a)&&a.tagName.toLowerCase()==="form"}function kA(a){return Yh(a)&&a.tagName.toLowerCase()==="input"}function LA(a){return!!(a.metaKey||a.altKey||a.ctrlKey||a.shiftKey)}function PA(a,t){return a.button===0&&(!t||t==="_self")&&!LA(a)}var fh=null;function BA(){if(fh===null)try{new FormData(document.createElement("form"),0),fh=!1}catch{fh=!0}return fh}var jA=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function yp(a){return a!=null&&!jA.has(a)?(Ji(!1,`"${a}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Mh}"`),null):a}function FA(a,t){let e,i,r,l,c;if(NA(a)){let u=a.getAttribute("action");i=u?ur(u,t):null,e=a.getAttribute("method")||Rh,r=yp(a.getAttribute("enctype"))||Mh,l=new FormData(a)}else if(OA(a)||kA(a)&&(a.type==="submit"||a.type==="image")){let u=a.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=a.getAttribute("formaction")||u.getAttribute("action");if(i=d?ur(d,t):null,e=a.getAttribute("formmethod")||u.getAttribute("method")||Rh,r=yp(a.getAttribute("formenctype"))||yp(u.getAttribute("enctype"))||Mh,l=new FormData(u,a),!BA()){let{name:f,type:p,value:y}=a;if(p==="image"){let w=f?`${f}.`:"";l.append(`${w}x`,"0"),l.append(`${w}y`,"0")}else f&&l.append(f,y)}}else{if(Yh(a))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');e=Rh,i=null,r=Mh,c=a}return l&&r==="text/plain"&&(c=l,l=void 0),{action:i,method:e.toLowerCase(),encType:r,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function gm(a,t){if(a===!1||a===null||typeof a>"u")throw new Error(t)}function IA(a,t,e,i){let r=typeof a=="string"?new URL(a,typeof window>"u"?"server://singlefetch/":window.location.origin):a;return e?r.pathname.endsWith("/")?r.pathname=`${r.pathname}_.${i}`:r.pathname=`${r.pathname}.${i}`:r.pathname==="/"?r.pathname=`_root.${i}`:t&&ur(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${i}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${i}`,r}async function UA(a,t){if(a.id in t)return t[a.id];try{let e=await import(a.module);return t[a.id]=e,e}catch(e){return console.error(`Error loading route module \`${a.module}\`, reloading page...`),console.error(e),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function zA(a){return a==null?!1:a.href==null?a.rel==="preload"&&typeof a.imageSrcSet=="string"&&typeof a.imageSizes=="string":typeof a.rel=="string"&&typeof a.href=="string"}async function HA(a,t,e){let i=await Promise.all(a.map(async r=>{let l=t.routes[r.route.id];if(l){let c=await UA(l,e);return c.links?c.links():[]}return[]}));return VA(i.flat(1).filter(zA).filter(r=>r.rel==="stylesheet"||r.rel==="preload").map(r=>r.rel==="stylesheet"?{...r,rel:"prefetch",as:"style"}:{...r,rel:"prefetch"}))}function hv(a,t,e,i,r,l){let c=(d,f)=>e[f]?d.route.id!==e[f].route.id:!0,u=(d,f)=>e[f].pathname!==d.pathname||e[f].route.path?.endsWith("*")&&e[f].params["*"]!==d.params["*"];return l==="assets"?t.filter((d,f)=>c(d,f)||u(d,f)):l==="data"?t.filter((d,f)=>{let p=i.routes[d.route.id];if(!p||!p.hasLoader)return!1;if(c(d,f)||u(d,f))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(r.pathname+r.search+r.hash,window.origin),currentParams:e[0]?.params||{},nextUrl:new URL(a,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function qA(a,t,{includeHydrateFallback:e}={}){return GA(a.map(i=>{let r=t.routes[i.route.id];if(!r)return[];let l=[r.module];return r.clientActionModule&&(l=l.concat(r.clientActionModule)),r.clientLoaderModule&&(l=l.concat(r.clientLoaderModule)),e&&r.hydrateFallbackModule&&(l=l.concat(r.hydrateFallbackModule)),r.imports&&(l=l.concat(r.imports)),l}).flat(1))}function GA(a){return[...new Set(a)]}function $A(a){let t={},e=Object.keys(a).sort();for(let i of e)t[i]=a[i];return t}function VA(a,t){let e=new Set;return new Set(t),a.reduce((i,r)=>{let l=JSON.stringify($A(r));return e.has(l)||(e.add(l),i.push({key:l,link:r})),i},[])}function F0(){let a=U.useContext(hl);return gm(a,"You must render this element inside a <DataRouterContext.Provider> element"),a}function KA(){let a=U.useContext(Xh);return gm(a,"You must render this element inside a <DataRouterStateContext.Provider> element"),a}var ym=U.createContext(void 0);ym.displayName="FrameworkContext";function I0(){let a=U.useContext(ym);return gm(a,"You must render this element inside a <HydratedRouter> element"),a}function XA(a,t){let e=U.useContext(ym),[i,r]=U.useState(!1),[l,c]=U.useState(!1),{onFocus:u,onBlur:d,onMouseEnter:f,onMouseLeave:p,onTouchStart:y}=t,w=U.useRef(null);U.useEffect(()=>{if(a==="render"&&c(!0),a==="viewport"){let S=M=>{M.forEach(k=>{c(k.isIntersecting)})},C=new IntersectionObserver(S,{threshold:.5});return w.current&&C.observe(w.current),()=>{C.disconnect()}}},[a]),U.useEffect(()=>{if(i){let S=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(S)}}},[i]);let A=()=>{r(!0)},_=()=>{r(!1),c(!1)};return e?a!=="intent"?[l,w,{}]:[l,w,{onFocus:wc(u,A),onBlur:wc(d,_),onMouseEnter:wc(f,A),onMouseLeave:wc(p,_),onTouchStart:wc(y,A)}]:[!1,w,{}]}function wc(a,t){return e=>{a&&a(e),e.defaultPrevented||t(e)}}function YA({page:a,...t}){let{router:e}=F0(),i=U.useMemo(()=>_0(e.routes,a,e.basename),[e.routes,a,e.basename]);return i?U.createElement(WA,{page:a,matches:i,...t}):null}function QA(a){let{manifest:t,routeModules:e}=I0(),[i,r]=U.useState([]);return U.useEffect(()=>{let l=!1;return HA(a,t,e).then(c=>{l||r(c)}),()=>{l=!0}},[a,t,e]),i}function WA({page:a,matches:t,...e}){let i=ta(),{future:r,manifest:l,routeModules:c}=I0(),{basename:u}=F0(),{loaderData:d,matches:f}=KA(),p=U.useMemo(()=>hv(a,t,f,l,i,"data"),[a,t,f,l,i]),y=U.useMemo(()=>hv(a,t,f,l,i,"assets"),[a,t,f,l,i]),w=U.useMemo(()=>{if(a===i.pathname+i.search+i.hash)return[];let S=new Set,C=!1;if(t.forEach(k=>{let L=l.routes[k.route.id];!L||!L.hasLoader||(!p.some(j=>j.route.id===k.route.id)&&k.route.id in d&&c[k.route.id]?.shouldRevalidate||L.hasClientLoader?C=!0:S.add(k.route.id))}),S.size===0)return[];let M=IA(a,u,r.unstable_trailingSlashAwareDataRequests,"data");return C&&S.size>0&&M.searchParams.set("_routes",t.filter(k=>S.has(k.route.id)).map(k=>k.route.id).join(",")),[M.pathname+M.search]},[u,r.unstable_trailingSlashAwareDataRequests,d,i,l,p,t,a,c]),A=U.useMemo(()=>qA(y,l),[y,l]),_=QA(y);return U.createElement(U.Fragment,null,w.map(S=>U.createElement("link",{key:S,rel:"prefetch",as:"fetch",href:S,...e})),A.map(S=>U.createElement("link",{key:S,rel:"modulepreload",href:S,...e})),_.map(({key:S,link:C})=>U.createElement("link",{key:S,nonce:e.nonce,...C,crossOrigin:C.crossOrigin??e.crossOrigin})))}function ZA(...a){return t=>{a.forEach(e=>{typeof e=="function"?e(t):e!=null&&(e.current=t)})}}var JA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{JA&&(window.__reactRouterVersion="7.13.0")}catch{}function tS({basename:a,children:t,unstable_useTransitions:e,window:i}){let r=U.useRef();r.current==null&&(r.current=Lx({window:i,v5Compat:!0}));let l=r.current,[c,u]=U.useState({action:l.action,location:l.location}),d=U.useCallback(f=>{e===!1?u(f):U.startTransition(()=>u(f))},[e]);return U.useLayoutEffect(()=>l.listen(d),[l,d]),U.createElement(MA,{basename:a,children:t,location:c.location,navigationType:c.action,navigator:l,unstable_useTransitions:e})}var U0=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ol=U.forwardRef(function({onClick:t,discover:e="render",prefetch:i="none",relative:r,reloadDocument:l,replace:c,state:u,target:d,to:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w,...A},_){let{basename:S,unstable_useTransitions:C}=U.useContext(Ri),M=typeof f=="string"&&U0.test(f),k=M0(f,S);f=k.to;let L=pA(f,{relative:r}),[j,F,z]=XA(i,A),H=sS(f,{replace:c,state:u,target:d,preventScrollReset:p,relative:r,viewTransition:y,unstable_defaultShouldRevalidate:w,unstable_useTransitions:C});function ut(_t){t&&t(_t),_t.defaultPrevented||H(_t)}let ft=U.createElement("a",{...A,...z,href:k.absoluteURL||L,onClick:k.isExternal||l?t:ut,ref:ZA(_,F),target:d,"data-discover":!M&&e==="render"?"true":void 0});return j&&!M?U.createElement(U.Fragment,null,ft,U.createElement(YA,{page:L})):ft});ol.displayName="Link";var eS=U.forwardRef(function({"aria-current":t="page",caseSensitive:e=!1,className:i="",end:r=!1,style:l,to:c,viewTransition:u,children:d,...f},p){let y=Uc(c,{relative:f.relative}),w=ta(),A=U.useContext(Xh),{navigator:_,basename:S}=U.useContext(Ri),C=A!=null&&cS(y)&&u===!0,M=_.encodeLocation?_.encodeLocation(y).pathname:y.pathname,k=w.pathname,L=A&&A.navigation&&A.navigation.location?A.navigation.location.pathname:null;e||(k=k.toLowerCase(),L=L?L.toLowerCase():null,M=M.toLowerCase()),L&&S&&(L=ur(L,S)||L);const j=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let F=k===M||!r&&k.startsWith(M)&&k.charAt(j)==="/",z=L!=null&&(L===M||!r&&L.startsWith(M)&&L.charAt(M.length)==="/"),H={isActive:F,isPending:z,isTransitioning:C},ut=F?t:void 0,ft;typeof i=="function"?ft=i(H):ft=[i,F?"active":null,z?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let _t=typeof l=="function"?l(H):l;return U.createElement(ol,{...f,"aria-current":ut,className:ft,ref:p,style:_t,to:c,viewTransition:u},typeof d=="function"?d(H):d)});eS.displayName="NavLink";var nS=U.forwardRef(({discover:a="render",fetcherKey:t,navigate:e,reloadDocument:i,replace:r,state:l,method:c=Rh,action:u,onSubmit:d,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w,...A},_)=>{let{unstable_useTransitions:S}=U.useContext(Ri),C=oS(),M=lS(u,{relative:f}),k=c.toLowerCase()==="get"?"get":"post",L=typeof u=="string"&&U0.test(u),j=F=>{if(d&&d(F),F.defaultPrevented)return;F.preventDefault();let z=F.nativeEvent.submitter,H=z?.getAttribute("formmethod")||c,ut=()=>C(z||F.currentTarget,{fetcherKey:t,method:H,navigate:e,replace:r,state:l,relative:f,preventScrollReset:p,viewTransition:y,unstable_defaultShouldRevalidate:w});S&&e!==!1?U.startTransition(()=>ut()):ut()};return U.createElement("form",{ref:_,method:k,action:M,onSubmit:i?d:j,...A,"data-discover":!L&&a==="render"?"true":void 0})});nS.displayName="Form";function iS(a){return`${a} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function z0(a){let t=U.useContext(hl);return Ye(t,iS(a)),t}function sS(a,{target:t,replace:e,state:i,preventScrollReset:r,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u,unstable_useTransitions:d}={}){let f=ea(),p=ta(),y=Uc(a,{relative:l});return U.useCallback(w=>{if(PA(w,t)){w.preventDefault();let A=e!==void 0?e:Nc(p)===Nc(y),_=()=>f(a,{replace:A,state:i,preventScrollReset:r,relative:l,viewTransition:c,unstable_defaultShouldRevalidate:u});d?U.startTransition(()=>_()):_()}},[p,f,y,e,i,t,a,r,l,c,u,d])}var rS=0,aS=()=>`__${String(++rS)}__`;function oS(){let{router:a}=z0("useSubmit"),{basename:t}=U.useContext(Ri),e=_A(),i=a.fetch,r=a.navigate;return U.useCallback(async(l,c={})=>{let{action:u,method:d,encType:f,formData:p,body:y}=FA(l,t);if(c.navigate===!1){let w=c.fetcherKey||aS();await i(w,e,c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,flushSync:c.flushSync})}else await r(c.action||u,{unstable_defaultShouldRevalidate:c.unstable_defaultShouldRevalidate,preventScrollReset:c.preventScrollReset,formData:p,body:y,formMethod:c.method||d,formEncType:c.encType||f,replace:c.replace,state:c.state,fromRouteId:e,flushSync:c.flushSync,viewTransition:c.viewTransition})},[i,r,t,e])}function lS(a,{relative:t}={}){let{basename:e}=U.useContext(Ri),i=U.useContext(ts);Ye(i,"useFormAction must be used inside a RouteContext");let[r]=i.matches.slice(-1),l={...Uc(a||".",{relative:t})},c=ta();if(a==null){l.search=c.search;let u=new URLSearchParams(l.search),d=u.getAll("index");if(d.some(p=>p==="")){u.delete("index"),d.filter(y=>y).forEach(y=>u.append("index",y));let p=u.toString();l.search=p?`?${p}`:""}}return(!a||a===".")&&r.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),e!=="/"&&(l.pathname=l.pathname==="/"?e:cr([e,l.pathname])),Nc(l)}function cS(a,{relative:t}={}){let e=U.useContext(O0);Ye(e!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:i}=z0("useViewTransitionState"),r=Uc(a,{relative:t});if(!e.isTransitioning)return!1;let l=ur(e.currentLocation.pathname,i)||e.currentLocation.pathname,c=ur(e.nextLocation.pathname,i)||e.nextLocation.pathname;return Fh(r.pathname,c)!=null||Fh(r.pathname,l)!=null}var uS=E0(),fl=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(a){return this.listeners.add(a),this.onSubscribe(),()=>{this.listeners.delete(a),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},hS={setTimeout:(a,t)=>setTimeout(a,t),clearTimeout:a=>clearTimeout(a),setInterval:(a,t)=>setInterval(a,t),clearInterval:a=>clearInterval(a)},dS=class{#t=hS;#e=!1;setTimeoutProvider(a){this.#t=a}setTimeout(a,t){return this.#t.setTimeout(a,t)}clearTimeout(a){this.#t.clearTimeout(a)}setInterval(a,t){return this.#t.setInterval(a,t)}clearInterval(a){this.#t.clearInterval(a)}},Fa=new dS;function fS(a){setTimeout(a,0)}var Va=typeof window>"u"||"Deno"in globalThis;function Jn(){}function pS(a,t){return typeof a=="function"?a(t):a}function Np(a){return typeof a=="number"&&a>=0&&a!==1/0}function H0(a,t){return Math.max(a+(t||0)-Date.now(),0)}function Wr(a,t){return typeof a=="function"?a(t):a}function Gi(a,t){return typeof a=="function"?a(t):a}function dv(a,t){const{type:e="all",exact:i,fetchStatus:r,predicate:l,queryKey:c,stale:u}=a;if(c){if(i){if(t.queryHash!==bm(c,t.options))return!1}else if(!kc(t.queryKey,c))return!1}if(e!=="all"){const d=t.isActive();if(e==="active"&&!d||e==="inactive"&&d)return!1}return!(typeof u=="boolean"&&t.isStale()!==u||r&&r!==t.state.fetchStatus||l&&!l(t))}function fv(a,t){const{exact:e,status:i,predicate:r,mutationKey:l}=a;if(l){if(!t.options.mutationKey)return!1;if(e){if(Ka(t.options.mutationKey)!==Ka(l))return!1}else if(!kc(t.options.mutationKey,l))return!1}return!(i&&t.state.status!==i||r&&!r(t))}function bm(a,t){return(t?.queryKeyHashFn||Ka)(a)}function Ka(a){return JSON.stringify(a,(t,e)=>kp(e)?Object.keys(e).sort().reduce((i,r)=>(i[r]=e[r],i),{}):e)}function kc(a,t){return a===t?!0:typeof a!=typeof t?!1:a&&t&&typeof a=="object"&&typeof t=="object"?Object.keys(t).every(e=>kc(a[e],t[e])):!1}var mS=Object.prototype.hasOwnProperty;function q0(a,t,e=0){if(a===t)return a;if(e>500)return t;const i=pv(a)&&pv(t);if(!i&&!(kp(a)&&kp(t)))return t;const l=(i?a:Object.keys(a)).length,c=i?t:Object.keys(t),u=c.length,d=i?new Array(u):{};let f=0;for(let p=0;p<u;p++){const y=i?p:c[p],w=a[y],A=t[y];if(w===A){d[y]=w,(i?p<l:mS.call(a,y))&&f++;continue}if(w===null||A===null||typeof w!="object"||typeof A!="object"){d[y]=A;continue}const _=q0(w,A,e+1);d[y]=_,_===w&&f++}return l===u&&f===l?a:d}function Ih(a,t){if(!t||Object.keys(a).length!==Object.keys(t).length)return!1;for(const e in a)if(a[e]!==t[e])return!1;return!0}function pv(a){return Array.isArray(a)&&a.length===Object.keys(a).length}function kp(a){if(!mv(a))return!1;const t=a.constructor;if(t===void 0)return!0;const e=t.prototype;return!(!mv(e)||!e.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(a)!==Object.prototype)}function mv(a){return Object.prototype.toString.call(a)==="[object Object]"}function gS(a){return new Promise(t=>{Fa.setTimeout(t,a)})}function Lp(a,t,e){return typeof e.structuralSharing=="function"?e.structuralSharing(a,t):e.structuralSharing!==!1?q0(a,t):t}function yS(a,t,e=0){const i=[...a,t];return e&&i.length>e?i.slice(1):i}function bS(a,t,e=0){const i=[t,...a];return e&&i.length>e?i.slice(0,-1):i}var vm=Symbol();function G0(a,t){return!a.queryFn&&t?.initialPromise?()=>t.initialPromise:!a.queryFn||a.queryFn===vm?()=>Promise.reject(new Error(`Missing queryFn: '${a.queryHash}'`)):a.queryFn}function wm(a,t){return typeof a=="function"?a(...t):!!a}function vS(a,t,e){let i=!1,r;return Object.defineProperty(a,"signal",{enumerable:!0,get:()=>(r??=t(),i||(i=!0,r.aborted?e():r.addEventListener("abort",e,{once:!0})),r)}),a}var wS=class extends fl{#t;#e;#i;constructor(){super(),this.#i=a=>{if(!Va&&window.addEventListener){const t=()=>a();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(a){this.#i=a,this.#e?.(),this.#e=a(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(a){this.#t!==a&&(this.#t=a,this.onFocus())}onFocus(){const a=this.isFocused();this.listeners.forEach(t=>{t(a)})}isFocused(){return typeof this.#t=="boolean"?this.#t:globalThis.document?.visibilityState!=="hidden"}},xm=new wS;function Pp(){let a,t;const e=new Promise((r,l)=>{a=r,t=l});e.status="pending",e.catch(()=>{});function i(r){Object.assign(e,r),delete e.resolve,delete e.reject}return e.resolve=r=>{i({status:"fulfilled",value:r}),a(r)},e.reject=r=>{i({status:"rejected",reason:r}),t(r)},e}var xS=fS;function AS(){let a=[],t=0,e=u=>{u()},i=u=>{u()},r=xS;const l=u=>{t?a.push(u):r(()=>{e(u)})},c=()=>{const u=a;a=[],u.length&&r(()=>{i(()=>{u.forEach(d=>{e(d)})})})};return{batch:u=>{let d;t++;try{d=u()}finally{t--,t||c()}return d},batchCalls:u=>(...d)=>{l(()=>{u(...d)})},schedule:l,setNotifyFunction:u=>{e=u},setBatchNotifyFunction:u=>{i=u},setScheduler:u=>{r=u}}}var wn=AS(),SS=class extends fl{#t=!0;#e;#i;constructor(){super(),this.#i=a=>{if(!Va&&window.addEventListener){const t=()=>a(!0),e=()=>a(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",e,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",e)}}}}onSubscribe(){this.#e||this.setEventListener(this.#i)}onUnsubscribe(){this.hasListeners()||(this.#e?.(),this.#e=void 0)}setEventListener(a){this.#i=a,this.#e?.(),this.#e=a(this.setOnline.bind(this))}setOnline(a){this.#t!==a&&(this.#t=a,this.listeners.forEach(e=>{e(a)}))}isOnline(){return this.#t}},Uh=new SS;function ES(a){return Math.min(1e3*2**a,3e4)}function $0(a){return(a??"online")==="online"?Uh.isOnline():!0}var Bp=class extends Error{constructor(a){super("CancelledError"),this.revert=a?.revert,this.silent=a?.silent}};function V0(a){let t=!1,e=0,i;const r=Pp(),l=()=>r.status!=="pending",c=S=>{if(!l()){const C=new Bp(S);w(C),a.onCancel?.(C)}},u=()=>{t=!0},d=()=>{t=!1},f=()=>xm.isFocused()&&(a.networkMode==="always"||Uh.isOnline())&&a.canRun(),p=()=>$0(a.networkMode)&&a.canRun(),y=S=>{l()||(i?.(),r.resolve(S))},w=S=>{l()||(i?.(),r.reject(S))},A=()=>new Promise(S=>{i=C=>{(l()||f())&&S(C)},a.onPause?.()}).then(()=>{i=void 0,l()||a.onContinue?.()}),_=()=>{if(l())return;let S;const C=e===0?a.initialPromise:void 0;try{S=C??a.fn()}catch(M){S=Promise.reject(M)}Promise.resolve(S).then(y).catch(M=>{if(l())return;const k=a.retry??(Va?0:3),L=a.retryDelay??ES,j=typeof L=="function"?L(e,M):L,F=k===!0||typeof k=="number"&&e<k||typeof k=="function"&&k(e,M);if(t||!F){w(M);return}e++,a.onFail?.(e,M),gS(j).then(()=>f()?void 0:A()).then(()=>{t?w(M):_()})})};return{promise:r,status:()=>r.status,cancel:c,continue:()=>(i?.(),r),cancelRetry:u,continueRetry:d,canStart:p,start:()=>(p()?_():A().then(_),r)}}var K0=class{#t;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Np(this.gcTime)&&(this.#t=Fa.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(a){this.gcTime=Math.max(this.gcTime||0,a??(Va?1/0:300*1e3))}clearGcTimeout(){this.#t&&(Fa.clearTimeout(this.#t),this.#t=void 0)}},_S=class extends K0{#t;#e;#i;#n;#s;#a;#r;constructor(a){super(),this.#r=!1,this.#a=a.defaultOptions,this.setOptions(a.options),this.observers=[],this.#n=a.client,this.#i=this.#n.getQueryCache(),this.queryKey=a.queryKey,this.queryHash=a.queryHash,this.#t=yv(this.options),this.state=a.state??this.#t,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#s?.promise}setOptions(a){if(this.options={...this.#a,...a},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=yv(this.options);t.data!==void 0&&(this.setState(gv(t.data,t.dataUpdatedAt)),this.#t=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#i.remove(this)}setData(a,t){const e=Lp(this.state.data,a,this.options);return this.#o({data:e,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),e}setState(a,t){this.#o({type:"setState",state:a,setStateOptions:t})}cancel(a){const t=this.#s?.promise;return this.#s?.cancel(a),t?t.then(Jn).catch(Jn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#t)}isActive(){return this.observers.some(a=>Gi(a.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===vm||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(a=>Wr(a.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(a=>a.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(a=0){return this.state.data===void 0?!0:a==="static"?!1:this.state.isInvalidated?!0:!H0(this.state.dataUpdatedAt,a)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#s?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#s?.continue()}addObserver(a){this.observers.includes(a)||(this.observers.push(a),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",query:this,observer:a}))}removeObserver(a){this.observers.includes(a)&&(this.observers=this.observers.filter(t=>t!==a),this.observers.length||(this.#s&&(this.#r?this.#s.cancel({revert:!0}):this.#s.cancelRetry()),this.scheduleGc()),this.#i.notify({type:"observerRemoved",query:this,observer:a}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#o({type:"invalidate"})}async fetch(a,t){if(this.state.fetchStatus!=="idle"&&this.#s?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#s)return this.#s.continueRetry(),this.#s.promise}if(a&&this.setOptions(a),!this.options.queryFn){const u=this.observers.find(d=>d.options.queryFn);u&&this.setOptions(u.options)}const e=new AbortController,i=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(this.#r=!0,e.signal)})},r=()=>{const u=G0(this.options,t),f=(()=>{const p={client:this.#n,queryKey:this.queryKey,meta:this.meta};return i(p),p})();return this.#r=!1,this.options.persister?this.options.persister(u,f,this):u(f)},c=(()=>{const u={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#n,state:this.state,fetchFn:r};return i(u),u})();this.options.behavior?.onFetch(c,this),this.#e=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==c.fetchOptions?.meta)&&this.#o({type:"fetch",meta:c.fetchOptions?.meta}),this.#s=V0({initialPromise:t?.initialPromise,fn:c.fetchFn,onCancel:u=>{u instanceof Bp&&u.revert&&this.setState({...this.#e,fetchStatus:"idle"}),e.abort()},onFail:(u,d)=>{this.#o({type:"failed",failureCount:u,error:d})},onPause:()=>{this.#o({type:"pause"})},onContinue:()=>{this.#o({type:"continue"})},retry:c.options.retry,retryDelay:c.options.retryDelay,networkMode:c.options.networkMode,canRun:()=>!0});try{const u=await this.#s.start();if(u===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(u),this.#i.config.onSuccess?.(u,this),this.#i.config.onSettled?.(u,this.state.error,this),u}catch(u){if(u instanceof Bp){if(u.silent)return this.#s.promise;if(u.revert){if(this.state.data===void 0)throw u;return this.state.data}}throw this.#o({type:"error",error:u}),this.#i.config.onError?.(u,this),this.#i.config.onSettled?.(this.state.data,u,this),u}finally{this.scheduleGc()}}#o(a){const t=e=>{switch(a.type){case"failed":return{...e,fetchFailureCount:a.failureCount,fetchFailureReason:a.error};case"pause":return{...e,fetchStatus:"paused"};case"continue":return{...e,fetchStatus:"fetching"};case"fetch":return{...e,...X0(e.data,this.options),fetchMeta:a.meta??null};case"success":const i={...e,...gv(a.data,a.dataUpdatedAt),dataUpdateCount:e.dataUpdateCount+1,...!a.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#e=a.manual?i:void 0,i;case"error":const r=a.error;return{...e,error:r,errorUpdateCount:e.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:e.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...e,isInvalidated:!0};case"setState":return{...e,...a.state}}};this.state=t(this.state),wn.batch(()=>{this.observers.forEach(e=>{e.onQueryUpdate()}),this.#i.notify({query:this,type:"updated",action:a})})}};function X0(a,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:$0(t.networkMode)?"fetching":"paused",...a===void 0&&{error:null,status:"pending"}}}function gv(a,t){return{data:a,dataUpdatedAt:t??Date.now(),error:null,isInvalidated:!1,status:"success"}}function yv(a){const t=typeof a.initialData=="function"?a.initialData():a.initialData,e=t!==void 0,i=e?typeof a.initialDataUpdatedAt=="function"?a.initialDataUpdatedAt():a.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:e?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:e?"success":"pending",fetchStatus:"idle"}}var CS=class extends fl{constructor(a,t){super(),this.options=t,this.#t=a,this.#o=null,this.#r=Pp(),this.bindMethods(),this.setOptions(t)}#t;#e=void 0;#i=void 0;#n=void 0;#s;#a;#r;#o;#c;#l;#d;#h;#f;#g;#m=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#e.addObserver(this),bv(this.#e,this.options)?this.#u():this.updateResult(),this.#b())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return jp(this.#e,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return jp(this.#e,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#E(),this.#S(),this.#e.removeObserver(this)}setOptions(a){const t=this.options,e=this.#e;if(this.options=this.#t.defaultQueryOptions(a),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof Gi(this.options.enabled,this.#e)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#w(),this.#e.setOptions(this.options),t._defaulted&&!Ih(this.options,t)&&this.#t.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#e,observer:this});const i=this.hasListeners();i&&vv(this.#e,e,this.options,t)&&this.#u(),this.updateResult(),i&&(this.#e!==e||Gi(this.options.enabled,this.#e)!==Gi(t.enabled,this.#e)||Wr(this.options.staleTime,this.#e)!==Wr(t.staleTime,this.#e))&&this.#p();const r=this.#y();i&&(this.#e!==e||Gi(this.options.enabled,this.#e)!==Gi(t.enabled,this.#e)||r!==this.#g)&&this.#v(r)}getOptimisticResult(a){const t=this.#t.getQueryCache().build(this.#t,a),e=this.createResult(t,a);return RS(this,e)&&(this.#n=e,this.#a=this.options,this.#s=this.#e.state),e}getCurrentResult(){return this.#n}trackResult(a,t){return new Proxy(a,{get:(e,i)=>(this.trackProp(i),t?.(i),i==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#r.status==="pending"&&this.#r.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(e,i))})}trackProp(a){this.#m.add(a)}getCurrentQuery(){return this.#e}refetch({...a}={}){return this.fetch({...a})}fetchOptimistic(a){const t=this.#t.defaultQueryOptions(a),e=this.#t.getQueryCache().build(this.#t,t);return e.fetch().then(()=>this.createResult(e,t))}fetch(a){return this.#u({...a,cancelRefetch:a.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#n))}#u(a){this.#w();let t=this.#e.fetch(this.options,a);return a?.throwOnError||(t=t.catch(Jn)),t}#p(){this.#E();const a=Wr(this.options.staleTime,this.#e);if(Va||this.#n.isStale||!Np(a))return;const e=H0(this.#n.dataUpdatedAt,a)+1;this.#h=Fa.setTimeout(()=>{this.#n.isStale||this.updateResult()},e)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#e):this.options.refetchInterval)??!1}#v(a){this.#S(),this.#g=a,!(Va||Gi(this.options.enabled,this.#e)===!1||!Np(this.#g)||this.#g===0)&&(this.#f=Fa.setInterval(()=>{(this.options.refetchIntervalInBackground||xm.isFocused())&&this.#u()},this.#g))}#b(){this.#p(),this.#v(this.#y())}#E(){this.#h&&(Fa.clearTimeout(this.#h),this.#h=void 0)}#S(){this.#f&&(Fa.clearInterval(this.#f),this.#f=void 0)}createResult(a,t){const e=this.#e,i=this.options,r=this.#n,l=this.#s,c=this.#a,d=a!==e?a.state:this.#i,{state:f}=a;let p={...f},y=!1,w;if(t._optimisticResults){const ut=this.hasListeners(),ft=!ut&&bv(a,t),_t=ut&&vv(a,e,t,i);(ft||_t)&&(p={...p,...X0(f.data,a.options)}),t._optimisticResults==="isRestoring"&&(p.fetchStatus="idle")}let{error:A,errorUpdatedAt:_,status:S}=p;w=p.data;let C=!1;if(t.placeholderData!==void 0&&w===void 0&&S==="pending"){let ut;r?.isPlaceholderData&&t.placeholderData===c?.placeholderData?(ut=r.data,C=!0):ut=typeof t.placeholderData=="function"?t.placeholderData(this.#d?.state.data,this.#d):t.placeholderData,ut!==void 0&&(S="success",w=Lp(r?.data,ut,t),y=!0)}if(t.select&&w!==void 0&&!C)if(r&&w===l?.data&&t.select===this.#c)w=this.#l;else try{this.#c=t.select,w=t.select(w),w=Lp(r?.data,w,t),this.#l=w,this.#o=null}catch(ut){this.#o=ut}this.#o&&(A=this.#o,w=this.#l,_=Date.now(),S="error");const M=p.fetchStatus==="fetching",k=S==="pending",L=S==="error",j=k&&M,F=w!==void 0,H={status:S,fetchStatus:p.fetchStatus,isPending:k,isSuccess:S==="success",isError:L,isInitialLoading:j,isLoading:j,data:w,dataUpdatedAt:p.dataUpdatedAt,error:A,errorUpdatedAt:_,failureCount:p.fetchFailureCount,failureReason:p.fetchFailureReason,errorUpdateCount:p.errorUpdateCount,isFetched:p.dataUpdateCount>0||p.errorUpdateCount>0,isFetchedAfterMount:p.dataUpdateCount>d.dataUpdateCount||p.errorUpdateCount>d.errorUpdateCount,isFetching:M,isRefetching:M&&!k,isLoadingError:L&&!F,isPaused:p.fetchStatus==="paused",isPlaceholderData:y,isRefetchError:L&&F,isStale:Am(a,t),refetch:this.refetch,promise:this.#r,isEnabled:Gi(t.enabled,a)!==!1};if(this.options.experimental_prefetchInRender){const ut=H.data!==void 0,ft=H.status==="error"&&!ut,_t=Lt=>{ft?Lt.reject(H.error):ut&&Lt.resolve(H.data)},ct=()=>{const Lt=this.#r=H.promise=Pp();_t(Lt)},Tt=this.#r;switch(Tt.status){case"pending":a.queryHash===e.queryHash&&_t(Tt);break;case"fulfilled":(ft||H.data!==Tt.value)&&ct();break;case"rejected":(!ft||H.error!==Tt.reason)&&ct();break}}return H}updateResult(){const a=this.#n,t=this.createResult(this.#e,this.options);if(this.#s=this.#e.state,this.#a=this.options,this.#s.data!==void 0&&(this.#d=this.#e),Ih(t,a))return;this.#n=t;const e=()=>{if(!a)return!0;const{notifyOnChangeProps:i}=this.options,r=typeof i=="function"?i():i;if(r==="all"||!r&&!this.#m.size)return!0;const l=new Set(r??this.#m);return this.options.throwOnError&&l.add("error"),Object.keys(this.#n).some(c=>{const u=c;return this.#n[u]!==a[u]&&l.has(u)})};this.#C({listeners:e()})}#w(){const a=this.#t.getQueryCache().build(this.#t,this.options);if(a===this.#e)return;const t=this.#e;this.#e=a,this.#i=a.state,this.hasListeners()&&(t?.removeObserver(this),a.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#b()}#C(a){wn.batch(()=>{a.listeners&&this.listeners.forEach(t=>{t(this.#n)}),this.#t.getQueryCache().notify({query:this.#e,type:"observerResultsUpdated"})})}};function TS(a,t){return Gi(t.enabled,a)!==!1&&a.state.data===void 0&&!(a.state.status==="error"&&t.retryOnMount===!1)}function bv(a,t){return TS(a,t)||a.state.data!==void 0&&jp(a,t,t.refetchOnMount)}function jp(a,t,e){if(Gi(t.enabled,a)!==!1&&Wr(t.staleTime,a)!=="static"){const i=typeof e=="function"?e(a):e;return i==="always"||i!==!1&&Am(a,t)}return!1}function vv(a,t,e,i){return(a!==t||Gi(i.enabled,a)===!1)&&(!e.suspense||a.state.status!=="error")&&Am(a,e)}function Am(a,t){return Gi(t.enabled,a)!==!1&&a.isStaleByTime(Wr(t.staleTime,a))}function RS(a,t){return!Ih(a.getCurrentResult(),t)}function wv(a){return{onFetch:(t,e)=>{const i=t.options,r=t.fetchOptions?.meta?.fetchMore?.direction,l=t.state.data?.pages||[],c=t.state.data?.pageParams||[];let u={pages:[],pageParams:[]},d=0;const f=async()=>{let p=!1;const y=_=>{vS(_,()=>t.signal,()=>p=!0)},w=G0(t.options,t.fetchOptions),A=async(_,S,C)=>{if(p)return Promise.reject();if(S==null&&_.pages.length)return Promise.resolve(_);const k=(()=>{const z={client:t.client,queryKey:t.queryKey,pageParam:S,direction:C?"backward":"forward",meta:t.options.meta};return y(z),z})(),L=await w(k),{maxPages:j}=t.options,F=C?bS:yS;return{pages:F(_.pages,L,j),pageParams:F(_.pageParams,S,j)}};if(r&&l.length){const _=r==="backward",S=_?MS:xv,C={pages:l,pageParams:c},M=S(i,C);u=await A(C,M,_)}else{const _=a??l.length;do{const S=d===0?c[0]??i.initialPageParam:xv(i,u);if(d>0&&S==null)break;u=await A(u,S),d++}while(d<_)}return u};t.options.persister?t.fetchFn=()=>t.options.persister?.(f,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},e):t.fetchFn=f}}}function xv(a,{pages:t,pageParams:e}){const i=t.length-1;return t.length>0?a.getNextPageParam(t[i],t,e[i],e):void 0}function MS(a,{pages:t,pageParams:e}){return t.length>0?a.getPreviousPageParam?.(t[0],t,e[0],e):void 0}var DS=class extends K0{#t;#e;#i;#n;constructor(a){super(),this.#t=a.client,this.mutationId=a.mutationId,this.#i=a.mutationCache,this.#e=[],this.state=a.state||Y0(),this.setOptions(a.options),this.scheduleGc()}setOptions(a){this.options=a,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(a){this.#e.includes(a)||(this.#e.push(a),this.clearGcTimeout(),this.#i.notify({type:"observerAdded",mutation:this,observer:a}))}removeObserver(a){this.#e=this.#e.filter(t=>t!==a),this.scheduleGc(),this.#i.notify({type:"observerRemoved",mutation:this,observer:a})}optionalRemove(){this.#e.length||(this.state.status==="pending"?this.scheduleGc():this.#i.remove(this))}continue(){return this.#n?.continue()??this.execute(this.state.variables)}async execute(a){const t=()=>{this.#s({type:"continue"})},e={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#n=V0({fn:()=>this.options.mutationFn?this.options.mutationFn(a,e):Promise.reject(new Error("No mutationFn found")),onFail:(l,c)=>{this.#s({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#s({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#i.canRun(this)});const i=this.state.status==="pending",r=!this.#n.canStart();try{if(i)t();else{this.#s({type:"pending",variables:a,isPaused:r}),this.#i.config.onMutate&&await this.#i.config.onMutate(a,this,e);const c=await this.options.onMutate?.(a,e);c!==this.state.context&&this.#s({type:"pending",context:c,variables:a,isPaused:r})}const l=await this.#n.start();return await this.#i.config.onSuccess?.(l,a,this.state.context,this,e),await this.options.onSuccess?.(l,a,this.state.context,e),await this.#i.config.onSettled?.(l,null,this.state.variables,this.state.context,this,e),await this.options.onSettled?.(l,null,a,this.state.context,e),this.#s({type:"success",data:l}),l}catch(l){try{await this.#i.config.onError?.(l,a,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onError?.(l,a,this.state.context,e)}catch(c){Promise.reject(c)}try{await this.#i.config.onSettled?.(void 0,l,this.state.variables,this.state.context,this,e)}catch(c){Promise.reject(c)}try{await this.options.onSettled?.(void 0,l,a,this.state.context,e)}catch(c){Promise.reject(c)}throw this.#s({type:"error",error:l}),l}finally{this.#i.runNext(this)}}#s(a){const t=e=>{switch(a.type){case"failed":return{...e,failureCount:a.failureCount,failureReason:a.error};case"pause":return{...e,isPaused:!0};case"continue":return{...e,isPaused:!1};case"pending":return{...e,context:a.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:a.isPaused,status:"pending",variables:a.variables,submittedAt:Date.now()};case"success":return{...e,data:a.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...e,data:void 0,error:a.error,failureCount:e.failureCount+1,failureReason:a.error,isPaused:!1,status:"error"}}};this.state=t(this.state),wn.batch(()=>{this.#e.forEach(e=>{e.onMutationUpdate(a)}),this.#i.notify({mutation:this,type:"updated",action:a})})}};function Y0(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var OS=class extends fl{constructor(a={}){super(),this.config=a,this.#t=new Set,this.#e=new Map,this.#i=0}#t;#e;#i;build(a,t,e){const i=new DS({client:a,mutationCache:this,mutationId:++this.#i,options:a.defaultMutationOptions(t),state:e});return this.add(i),i}add(a){this.#t.add(a);const t=ph(a);if(typeof t=="string"){const e=this.#e.get(t);e?e.push(a):this.#e.set(t,[a])}this.notify({type:"added",mutation:a})}remove(a){if(this.#t.delete(a)){const t=ph(a);if(typeof t=="string"){const e=this.#e.get(t);if(e)if(e.length>1){const i=e.indexOf(a);i!==-1&&e.splice(i,1)}else e[0]===a&&this.#e.delete(t)}}this.notify({type:"removed",mutation:a})}canRun(a){const t=ph(a);if(typeof t=="string"){const i=this.#e.get(t)?.find(r=>r.state.status==="pending");return!i||i===a}else return!0}runNext(a){const t=ph(a);return typeof t=="string"?this.#e.get(t)?.find(i=>i!==a&&i.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){wn.batch(()=>{this.#t.forEach(a=>{this.notify({type:"removed",mutation:a})}),this.#t.clear(),this.#e.clear()})}getAll(){return Array.from(this.#t)}find(a){const t={exact:!0,...a};return this.getAll().find(e=>fv(t,e))}findAll(a={}){return this.getAll().filter(t=>fv(a,t))}notify(a){wn.batch(()=>{this.listeners.forEach(t=>{t(a)})})}resumePausedMutations(){const a=this.getAll().filter(t=>t.state.isPaused);return wn.batch(()=>Promise.all(a.map(t=>t.continue().catch(Jn))))}};function ph(a){return a.options.scope?.id}var NS=class extends fl{#t;#e=void 0;#i;#n;constructor(t,e){super(),this.#t=t,this.setOptions(e),this.bindMethods(),this.#s()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(t){const e=this.options;this.options=this.#t.defaultMutationOptions(t),Ih(this.options,e)||this.#t.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#i,observer:this}),e?.mutationKey&&this.options.mutationKey&&Ka(e.mutationKey)!==Ka(this.options.mutationKey)?this.reset():this.#i?.state.status==="pending"&&this.#i.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#i?.removeObserver(this)}onMutationUpdate(t){this.#s(),this.#a(t)}getCurrentResult(){return this.#e}reset(){this.#i?.removeObserver(this),this.#i=void 0,this.#s(),this.#a()}mutate(t,e){return this.#n=e,this.#i?.removeObserver(this),this.#i=this.#t.getMutationCache().build(this.#t,this.options),this.#i.addObserver(this),this.#i.execute(t)}#s(){const t=this.#i?.state??Y0();this.#e={...t,isPending:t.status==="pending",isSuccess:t.status==="success",isError:t.status==="error",isIdle:t.status==="idle",mutate:this.mutate,reset:this.reset}}#a(t){wn.batch(()=>{if(this.#n&&this.hasListeners()){const e=this.#e.variables,i=this.#e.context,r={client:this.#t,meta:this.options.meta,mutationKey:this.options.mutationKey};if(t?.type==="success"){try{this.#n.onSuccess?.(t.data,e,i,r)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(t.data,null,e,i,r)}catch(l){Promise.reject(l)}}else if(t?.type==="error"){try{this.#n.onError?.(t.error,e,i,r)}catch(l){Promise.reject(l)}try{this.#n.onSettled?.(void 0,t.error,e,i,r)}catch(l){Promise.reject(l)}}}this.listeners.forEach(e=>{e(this.#e)})})}},kS=class extends fl{constructor(a={}){super(),this.config=a,this.#t=new Map}#t;build(a,t,e){const i=t.queryKey,r=t.queryHash??bm(i,t);let l=this.get(r);return l||(l=new _S({client:a,queryKey:i,queryHash:r,options:a.defaultQueryOptions(t),state:e,defaultOptions:a.getQueryDefaults(i)}),this.add(l)),l}add(a){this.#t.has(a.queryHash)||(this.#t.set(a.queryHash,a),this.notify({type:"added",query:a}))}remove(a){const t=this.#t.get(a.queryHash);t&&(a.destroy(),t===a&&this.#t.delete(a.queryHash),this.notify({type:"removed",query:a}))}clear(){wn.batch(()=>{this.getAll().forEach(a=>{this.remove(a)})})}get(a){return this.#t.get(a)}getAll(){return[...this.#t.values()]}find(a){const t={exact:!0,...a};return this.getAll().find(e=>dv(t,e))}findAll(a={}){const t=this.getAll();return Object.keys(a).length>0?t.filter(e=>dv(a,e)):t}notify(a){wn.batch(()=>{this.listeners.forEach(t=>{t(a)})})}onFocus(){wn.batch(()=>{this.getAll().forEach(a=>{a.onFocus()})})}onOnline(){wn.batch(()=>{this.getAll().forEach(a=>{a.onOnline()})})}},LS=class{#t;#e;#i;#n;#s;#a;#r;#o;constructor(a={}){this.#t=a.queryCache||new kS,this.#e=a.mutationCache||new OS,this.#i=a.defaultOptions||{},this.#n=new Map,this.#s=new Map,this.#a=0}mount(){this.#a++,this.#a===1&&(this.#r=xm.subscribe(async a=>{a&&(await this.resumePausedMutations(),this.#t.onFocus())}),this.#o=Uh.subscribe(async a=>{a&&(await this.resumePausedMutations(),this.#t.onOnline())}))}unmount(){this.#a--,this.#a===0&&(this.#r?.(),this.#r=void 0,this.#o?.(),this.#o=void 0)}isFetching(a){return this.#t.findAll({...a,fetchStatus:"fetching"}).length}isMutating(a){return this.#e.findAll({...a,status:"pending"}).length}getQueryData(a){const t=this.defaultQueryOptions({queryKey:a});return this.#t.get(t.queryHash)?.state.data}ensureQueryData(a){const t=this.defaultQueryOptions(a),e=this.#t.build(this,t),i=e.state.data;return i===void 0?this.fetchQuery(a):(a.revalidateIfStale&&e.isStaleByTime(Wr(t.staleTime,e))&&this.prefetchQuery(t),Promise.resolve(i))}getQueriesData(a){return this.#t.findAll(a).map(({queryKey:t,state:e})=>{const i=e.data;return[t,i]})}setQueryData(a,t,e){const i=this.defaultQueryOptions({queryKey:a}),l=this.#t.get(i.queryHash)?.state.data,c=pS(t,l);if(c!==void 0)return this.#t.build(this,i).setData(c,{...e,manual:!0})}setQueriesData(a,t,e){return wn.batch(()=>this.#t.findAll(a).map(({queryKey:i})=>[i,this.setQueryData(i,t,e)]))}getQueryState(a){const t=this.defaultQueryOptions({queryKey:a});return this.#t.get(t.queryHash)?.state}removeQueries(a){const t=this.#t;wn.batch(()=>{t.findAll(a).forEach(e=>{t.remove(e)})})}resetQueries(a,t){const e=this.#t;return wn.batch(()=>(e.findAll(a).forEach(i=>{i.reset()}),this.refetchQueries({type:"active",...a},t)))}cancelQueries(a,t={}){const e={revert:!0,...t},i=wn.batch(()=>this.#t.findAll(a).map(r=>r.cancel(e)));return Promise.all(i).then(Jn).catch(Jn)}invalidateQueries(a,t={}){return wn.batch(()=>(this.#t.findAll(a).forEach(e=>{e.invalidate()}),a?.refetchType==="none"?Promise.resolve():this.refetchQueries({...a,type:a?.refetchType??a?.type??"active"},t)))}refetchQueries(a,t={}){const e={...t,cancelRefetch:t.cancelRefetch??!0},i=wn.batch(()=>this.#t.findAll(a).filter(r=>!r.isDisabled()&&!r.isStatic()).map(r=>{let l=r.fetch(void 0,e);return e.throwOnError||(l=l.catch(Jn)),r.state.fetchStatus==="paused"?Promise.resolve():l}));return Promise.all(i).then(Jn)}fetchQuery(a){const t=this.defaultQueryOptions(a);t.retry===void 0&&(t.retry=!1);const e=this.#t.build(this,t);return e.isStaleByTime(Wr(t.staleTime,e))?e.fetch(t):Promise.resolve(e.state.data)}prefetchQuery(a){return this.fetchQuery(a).then(Jn).catch(Jn)}fetchInfiniteQuery(a){return a.behavior=wv(a.pages),this.fetchQuery(a)}prefetchInfiniteQuery(a){return this.fetchInfiniteQuery(a).then(Jn).catch(Jn)}ensureInfiniteQueryData(a){return a.behavior=wv(a.pages),this.ensureQueryData(a)}resumePausedMutations(){return Uh.isOnline()?this.#e.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#t}getMutationCache(){return this.#e}getDefaultOptions(){return this.#i}setDefaultOptions(a){this.#i=a}setQueryDefaults(a,t){this.#n.set(Ka(a),{queryKey:a,defaultOptions:t})}getQueryDefaults(a){const t=[...this.#n.values()],e={};return t.forEach(i=>{kc(a,i.queryKey)&&Object.assign(e,i.defaultOptions)}),e}setMutationDefaults(a,t){this.#s.set(Ka(a),{mutationKey:a,defaultOptions:t})}getMutationDefaults(a){const t=[...this.#s.values()],e={};return t.forEach(i=>{kc(a,i.mutationKey)&&Object.assign(e,i.defaultOptions)}),e}defaultQueryOptions(a){if(a._defaulted)return a;const t={...this.#i.queries,...this.getQueryDefaults(a.queryKey),...a,_defaulted:!0};return t.queryHash||(t.queryHash=bm(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===vm&&(t.enabled=!1),t}defaultMutationOptions(a){return a?._defaulted?a:{...this.#i.mutations,...a?.mutationKey&&this.getMutationDefaults(a.mutationKey),...a,_defaulted:!0}}clear(){this.#t.clear(),this.#e.clear()}},Q0=U.createContext(void 0),pl=a=>{const t=U.useContext(Q0);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},PS=({client:a,children:t})=>(U.useEffect(()=>(a.mount(),()=>{a.unmount()}),[a]),O.jsx(Q0.Provider,{value:a,children:t})),W0=U.createContext(!1),BS=()=>U.useContext(W0);W0.Provider;function jS(){let a=!1;return{clearReset:()=>{a=!1},reset:()=>{a=!0},isReset:()=>a}}var FS=U.createContext(jS()),IS=()=>U.useContext(FS),US=(a,t,e)=>{const i=e?.state.error&&typeof a.throwOnError=="function"?wm(a.throwOnError,[e.state.error,e]):a.throwOnError;(a.suspense||a.experimental_prefetchInRender||i)&&(t.isReset()||(a.retryOnMount=!1))},zS=a=>{U.useEffect(()=>{a.clearReset()},[a])},HS=({result:a,errorResetBoundary:t,throwOnError:e,query:i,suspense:r})=>a.isError&&!t.isReset()&&!a.isFetching&&i&&(r&&a.data===void 0||wm(e,[a.error,i])),qS=a=>{if(a.suspense){const e=r=>r==="static"?r:Math.max(r??1e3,1e3),i=a.staleTime;a.staleTime=typeof i=="function"?(...r)=>e(i(...r)):e(i),typeof a.gcTime=="number"&&(a.gcTime=Math.max(a.gcTime,1e3))}},GS=(a,t)=>a.isLoading&&a.isFetching&&!t,$S=(a,t)=>a?.suspense&&t.isPending,Av=(a,t,e)=>t.fetchOptimistic(a).catch(()=>{e.clearReset()});function VS(a,t,e){const i=BS(),r=IS(),l=pl(),c=l.defaultQueryOptions(a);l.getDefaultOptions().queries?._experimental_beforeQuery?.(c);const u=l.getQueryCache().get(c.queryHash);c._optimisticResults=i?"isRestoring":"optimistic",qS(c),US(c,r,u),zS(r);const d=!l.getQueryCache().get(c.queryHash),[f]=U.useState(()=>new t(l,c)),p=f.getOptimisticResult(c),y=!i&&a.subscribed!==!1;if(U.useSyncExternalStore(U.useCallback(w=>{const A=y?f.subscribe(wn.batchCalls(w)):Jn;return f.updateResult(),A},[f,y]),()=>f.getCurrentResult(),()=>f.getCurrentResult()),U.useEffect(()=>{f.setOptions(c)},[c,f]),$S(c,p))throw Av(c,f,r);if(HS({result:p,errorResetBoundary:r,throwOnError:c.throwOnError,query:u,suspense:c.suspense}))throw p.error;return l.getDefaultOptions().queries?._experimental_afterQuery?.(c,p),c.experimental_prefetchInRender&&!Va&&GS(p,i)&&(d?Av(c,f,r):u?.promise)?.catch(Jn).finally(()=>{f.updateResult()}),c.notifyOnChangeProps?p:f.trackResult(p)}function Xa(a,t){return VS(a,CS)}function Dc(a,t){const e=pl(),[i]=U.useState(()=>new NS(e,a));U.useEffect(()=>{i.setOptions(a)},[i,a]);const r=U.useSyncExternalStore(U.useCallback(c=>i.subscribe(wn.batchCalls(c)),[i]),()=>i.getCurrentResult(),()=>i.getCurrentResult()),l=U.useCallback((c,u)=>{i.mutate(c,u).catch(Jn)},[i]);if(r.error&&wm(i.options.throwOnError,[r.error]))throw r.error;return{...r,mutate:l,mutateAsync:r.mutate}}const Sv=a=>{let t;const e=new Set,i=(f,p)=>{const y=typeof f=="function"?f(t):f;if(!Object.is(y,t)){const w=t;t=p??(typeof y!="object"||y===null)?y:Object.assign({},t,y),e.forEach(A=>A(t,w))}},r=()=>t,u={setState:i,getState:r,getInitialState:()=>d,subscribe:f=>(e.add(f),()=>e.delete(f))},d=t=a(i,r,u);return u},KS=(a=>a?Sv(a):Sv),XS=a=>a;function YS(a,t=XS){const e=dh.useSyncExternalStore(a.subscribe,dh.useCallback(()=>t(a.getState()),[a,t]),dh.useCallback(()=>t(a.getInitialState()),[a,t]));return dh.useDebugValue(e),e}const Ev=a=>{const t=KS(a),e=i=>YS(t,i);return Object.assign(e,t),e},QS=(a=>a?Ev(a):Ev);function WS(a,t){let e;try{e=a()}catch{return}return{getItem:r=>{var l;const c=d=>d===null?null:JSON.parse(d,void 0),u=(l=e.getItem(r))!=null?l:null;return u instanceof Promise?u.then(c):c(u)},setItem:(r,l)=>e.setItem(r,JSON.stringify(l,void 0)),removeItem:r=>e.removeItem(r)}}const Fp=a=>t=>{try{const e=a(t);return e instanceof Promise?e:{then(i){return Fp(i)(e)},catch(i){return this}}}catch(e){return{then(i){return this},catch(i){return Fp(i)(e)}}}},ZS=(a,t)=>(e,i,r)=>{let l={storage:WS(()=>window.localStorage),partialize:C=>C,version:0,merge:(C,M)=>({...M,...C}),...t},c=!1,u=0;const d=new Set,f=new Set;let p=l.storage;if(!p)return a((...C)=>{console.warn(`[zustand persist middleware] Unable to update item '${l.name}', the given storage is currently unavailable.`),e(...C)},i,r);const y=()=>{const C=l.partialize({...i()});return p.setItem(l.name,{state:C,version:l.version})},w=r.setState;r.setState=(C,M)=>(w(C,M),y());const A=a((...C)=>(e(...C),y()),i,r);r.getInitialState=()=>A;let _;const S=()=>{var C,M;if(!p)return;const k=++u;c=!1,d.forEach(j=>{var F;return j((F=i())!=null?F:A)});const L=((M=l.onRehydrateStorage)==null?void 0:M.call(l,(C=i())!=null?C:A))||void 0;return Fp(p.getItem.bind(p))(l.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==l.version){if(l.migrate){const F=l.migrate(j.state,j.version);return F instanceof Promise?F.then(z=>[!0,z]):[!0,F]}console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var F;if(k!==u)return;const[z,H]=j;if(_=l.merge(H,(F=i())!=null?F:A),e(_,!0),z)return y()}).then(()=>{k===u&&(L?.(_,void 0),_=i(),c=!0,f.forEach(j=>j(_)))}).catch(j=>{k===u&&L?.(void 0,j)})};return r.persist={setOptions:C=>{l={...l,...C},C.storage&&(p=C.storage)},clearStorage:()=>{p?.removeItem(l.name)},getOptions:()=>l,rehydrate:()=>S(),hasHydrated:()=>c,onHydrate:C=>(d.add(C),()=>{d.delete(C)}),onFinishHydration:C=>(f.add(C),()=>{f.delete(C)})},l.skipHydration||S(),_||A},JS=ZS,na=QS(JS(a=>({token:null,setToken:t=>a({token:t}),logout:()=>a({token:null})}),{name:"wisemark-auth",partialize:a=>({token:a.token})}));function Z0(a,t){return function(){return a.apply(t,arguments)}}const{toString:tE}=Object.prototype,{getPrototypeOf:Sm}=Object,{iterator:Qh,toStringTag:J0}=Symbol,Wh=(a=>t=>{const e=tE.call(t);return a[e]||(a[e]=e.slice(8,-1).toLowerCase())})(Object.create(null)),es=a=>(a=a.toLowerCase(),t=>Wh(t)===a),Zh=a=>t=>typeof t===a,{isArray:ml}=Array,ll=Zh("undefined");function zc(a){return a!==null&&!ll(a)&&a.constructor!==null&&!ll(a.constructor)&&fi(a.constructor.isBuffer)&&a.constructor.isBuffer(a)}const tw=es("ArrayBuffer");function eE(a){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(a):t=a&&a.buffer&&tw(a.buffer),t}const nE=Zh("string"),fi=Zh("function"),ew=Zh("number"),Hc=a=>a!==null&&typeof a=="object",iE=a=>a===!0||a===!1,Dh=a=>{if(Wh(a)!=="object")return!1;const t=Sm(a);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(J0 in a)&&!(Qh in a)},sE=a=>{if(!Hc(a)||zc(a))return!1;try{return Object.keys(a).length===0&&Object.getPrototypeOf(a)===Object.prototype}catch{return!1}},rE=es("Date"),aE=es("File"),oE=es("Blob"),lE=es("FileList"),cE=a=>Hc(a)&&fi(a.pipe),uE=a=>{let t;return a&&(typeof FormData=="function"&&a instanceof FormData||fi(a.append)&&((t=Wh(a))==="formdata"||t==="object"&&fi(a.toString)&&a.toString()==="[object FormData]"))},hE=es("URLSearchParams"),[dE,fE,pE,mE]=["ReadableStream","Request","Response","Headers"].map(es),gE=a=>a.trim?a.trim():a.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function qc(a,t,{allOwnKeys:e=!1}={}){if(a===null||typeof a>"u")return;let i,r;if(typeof a!="object"&&(a=[a]),ml(a))for(i=0,r=a.length;i<r;i++)t.call(null,a[i],i,a);else{if(zc(a))return;const l=e?Object.getOwnPropertyNames(a):Object.keys(a),c=l.length;let u;for(i=0;i<c;i++)u=l[i],t.call(null,a[u],u,a)}}function nw(a,t){if(zc(a))return null;t=t.toLowerCase();const e=Object.keys(a);let i=e.length,r;for(;i-- >0;)if(r=e[i],t===r.toLowerCase())return r;return null}const Ia=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,iw=a=>!ll(a)&&a!==Ia;function Ip(){const{caseless:a,skipUndefined:t}=iw(this)&&this||{},e={},i=(r,l)=>{if(l==="__proto__"||l==="constructor"||l==="prototype")return;const c=a&&nw(e,l)||l;Dh(e[c])&&Dh(r)?e[c]=Ip(e[c],r):Dh(r)?e[c]=Ip({},r):ml(r)?e[c]=r.slice():(!t||!ll(r))&&(e[c]=r)};for(let r=0,l=arguments.length;r<l;r++)arguments[r]&&qc(arguments[r],i);return e}const yE=(a,t,e,{allOwnKeys:i}={})=>(qc(t,(r,l)=>{e&&fi(r)?Object.defineProperty(a,l,{value:Z0(r,e),writable:!0,enumerable:!0,configurable:!0}):Object.defineProperty(a,l,{value:r,writable:!0,enumerable:!0,configurable:!0})},{allOwnKeys:i}),a),bE=a=>(a.charCodeAt(0)===65279&&(a=a.slice(1)),a),vE=(a,t,e,i)=>{a.prototype=Object.create(t.prototype,i),Object.defineProperty(a.prototype,"constructor",{value:a,writable:!0,enumerable:!1,configurable:!0}),Object.defineProperty(a,"super",{value:t.prototype}),e&&Object.assign(a.prototype,e)},wE=(a,t,e,i)=>{let r,l,c;const u={};if(t=t||{},a==null)return t;do{for(r=Object.getOwnPropertyNames(a),l=r.length;l-- >0;)c=r[l],(!i||i(c,a,t))&&!u[c]&&(t[c]=a[c],u[c]=!0);a=e!==!1&&Sm(a)}while(a&&(!e||e(a,t))&&a!==Object.prototype);return t},xE=(a,t,e)=>{a=String(a),(e===void 0||e>a.length)&&(e=a.length),e-=t.length;const i=a.indexOf(t,e);return i!==-1&&i===e},AE=a=>{if(!a)return null;if(ml(a))return a;let t=a.length;if(!ew(t))return null;const e=new Array(t);for(;t-- >0;)e[t]=a[t];return e},SE=(a=>t=>a&&t instanceof a)(typeof Uint8Array<"u"&&Sm(Uint8Array)),EE=(a,t)=>{const i=(a&&a[Qh]).call(a);let r;for(;(r=i.next())&&!r.done;){const l=r.value;t.call(a,l[0],l[1])}},_E=(a,t)=>{let e;const i=[];for(;(e=a.exec(t))!==null;)i.push(e);return i},CE=es("HTMLFormElement"),TE=a=>a.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,i,r){return i.toUpperCase()+r}),_v=(({hasOwnProperty:a})=>(t,e)=>a.call(t,e))(Object.prototype),RE=es("RegExp"),sw=(a,t)=>{const e=Object.getOwnPropertyDescriptors(a),i={};qc(e,(r,l)=>{let c;(c=t(r,l,a))!==!1&&(i[l]=c||r)}),Object.defineProperties(a,i)},ME=a=>{sw(a,(t,e)=>{if(fi(a)&&["arguments","caller","callee"].indexOf(e)!==-1)return!1;const i=a[e];if(fi(i)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+e+"'")})}})},DE=(a,t)=>{const e={},i=r=>{r.forEach(l=>{e[l]=!0})};return ml(a)?i(a):i(String(a).split(t)),e},OE=()=>{},NE=(a,t)=>a!=null&&Number.isFinite(a=+a)?a:t;function kE(a){return!!(a&&fi(a.append)&&a[J0]==="FormData"&&a[Qh])}const LE=a=>{const t=new Array(10),e=(i,r)=>{if(Hc(i)){if(t.indexOf(i)>=0)return;if(zc(i))return i;if(!("toJSON"in i)){t[r]=i;const l=ml(i)?[]:{};return qc(i,(c,u)=>{const d=e(c,r+1);!ll(d)&&(l[u]=d)}),t[r]=void 0,l}}return i};return e(a,0)},PE=es("AsyncFunction"),BE=a=>a&&(Hc(a)||fi(a))&&fi(a.then)&&fi(a.catch),rw=((a,t)=>a?setImmediate:t?((e,i)=>(Ia.addEventListener("message",({source:r,data:l})=>{r===Ia&&l===e&&i.length&&i.shift()()},!1),r=>{i.push(r),Ia.postMessage(e,"*")}))(`axios@${Math.random()}`,[]):e=>setTimeout(e))(typeof setImmediate=="function",fi(Ia.postMessage)),jE=typeof queueMicrotask<"u"?queueMicrotask.bind(Ia):typeof process<"u"&&process.nextTick||rw,FE=a=>a!=null&&fi(a[Qh]),ht={isArray:ml,isArrayBuffer:tw,isBuffer:zc,isFormData:uE,isArrayBufferView:eE,isString:nE,isNumber:ew,isBoolean:iE,isObject:Hc,isPlainObject:Dh,isEmptyObject:sE,isReadableStream:dE,isRequest:fE,isResponse:pE,isHeaders:mE,isUndefined:ll,isDate:rE,isFile:aE,isBlob:oE,isRegExp:RE,isFunction:fi,isStream:cE,isURLSearchParams:hE,isTypedArray:SE,isFileList:lE,forEach:qc,merge:Ip,extend:yE,trim:gE,stripBOM:bE,inherits:vE,toFlatObject:wE,kindOf:Wh,kindOfTest:es,endsWith:xE,toArray:AE,forEachEntry:EE,matchAll:_E,isHTMLForm:CE,hasOwnProperty:_v,hasOwnProp:_v,reduceDescriptors:sw,freezeMethods:ME,toObjectSet:DE,toCamelCase:TE,noop:OE,toFiniteNumber:NE,findKey:nw,global:Ia,isContextDefined:iw,isSpecCompliantForm:kE,toJSONObject:LE,isAsyncFn:PE,isThenable:BE,setImmediate:rw,asap:jE,isIterable:FE};let te=class aw extends Error{static from(t,e,i,r,l,c){const u=new aw(t.message,e||t.code,i,r,l);return u.cause=t,u.name=t.name,c&&Object.assign(u,c),u}constructor(t,e,i,r,l){super(t),this.name="AxiosError",this.isAxiosError=!0,e&&(this.code=e),i&&(this.config=i),r&&(this.request=r),l&&(this.response=l,this.status=l.status)}toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:ht.toJSONObject(this.config),code:this.code,status:this.status}}};te.ERR_BAD_OPTION_VALUE="ERR_BAD_OPTION_VALUE";te.ERR_BAD_OPTION="ERR_BAD_OPTION";te.ECONNABORTED="ECONNABORTED";te.ETIMEDOUT="ETIMEDOUT";te.ERR_NETWORK="ERR_NETWORK";te.ERR_FR_TOO_MANY_REDIRECTS="ERR_FR_TOO_MANY_REDIRECTS";te.ERR_DEPRECATED="ERR_DEPRECATED";te.ERR_BAD_RESPONSE="ERR_BAD_RESPONSE";te.ERR_BAD_REQUEST="ERR_BAD_REQUEST";te.ERR_CANCELED="ERR_CANCELED";te.ERR_NOT_SUPPORT="ERR_NOT_SUPPORT";te.ERR_INVALID_URL="ERR_INVALID_URL";const IE=null;function Up(a){return ht.isPlainObject(a)||ht.isArray(a)}function ow(a){return ht.endsWith(a,"[]")?a.slice(0,-2):a}function Cv(a,t,e){return a?a.concat(t).map(function(r,l){return r=ow(r),!e&&l?"["+r+"]":r}).join(e?".":""):t}function UE(a){return ht.isArray(a)&&!a.some(Up)}const zE=ht.toFlatObject(ht,{},null,function(t){return/^is[A-Z]/.test(t)});function Jh(a,t,e){if(!ht.isObject(a))throw new TypeError("target must be an object");t=t||new FormData,e=ht.toFlatObject(e,{metaTokens:!0,dots:!1,indexes:!1},!1,function(S,C){return!ht.isUndefined(C[S])});const i=e.metaTokens,r=e.visitor||p,l=e.dots,c=e.indexes,d=(e.Blob||typeof Blob<"u"&&Blob)&&ht.isSpecCompliantForm(t);if(!ht.isFunction(r))throw new TypeError("visitor must be a function");function f(_){if(_===null)return"";if(ht.isDate(_))return _.toISOString();if(ht.isBoolean(_))return _.toString();if(!d&&ht.isBlob(_))throw new te("Blob is not supported. Use a Buffer instead.");return ht.isArrayBuffer(_)||ht.isTypedArray(_)?d&&typeof Blob=="function"?new Blob([_]):Buffer.from(_):_}function p(_,S,C){let M=_;if(_&&!C&&typeof _=="object"){if(ht.endsWith(S,"{}"))S=i?S:S.slice(0,-2),_=JSON.stringify(_);else if(ht.isArray(_)&&UE(_)||(ht.isFileList(_)||ht.endsWith(S,"[]"))&&(M=ht.toArray(_)))return S=ow(S),M.forEach(function(L,j){!(ht.isUndefined(L)||L===null)&&t.append(c===!0?Cv([S],j,l):c===null?S:S+"[]",f(L))}),!1}return Up(_)?!0:(t.append(Cv(C,S,l),f(_)),!1)}const y=[],w=Object.assign(zE,{defaultVisitor:p,convertValue:f,isVisitable:Up});function A(_,S){if(!ht.isUndefined(_)){if(y.indexOf(_)!==-1)throw Error("Circular reference detected in "+S.join("."));y.push(_),ht.forEach(_,function(M,k){(!(ht.isUndefined(M)||M===null)&&r.call(t,M,ht.isString(k)?k.trim():k,S,w))===!0&&A(M,S?S.concat(k):[k])}),y.pop()}}if(!ht.isObject(a))throw new TypeError("data must be an object");return A(a),t}function Tv(a){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(a).replace(/[!'()~]|%20|%00/g,function(i){return t[i]})}function Em(a,t){this._pairs=[],a&&Jh(a,this,t)}const lw=Em.prototype;lw.append=function(t,e){this._pairs.push([t,e])};lw.toString=function(t){const e=t?function(i){return t.call(this,i,Tv)}:Tv;return this._pairs.map(function(r){return e(r[0])+"="+e(r[1])},"").join("&")};function HE(a){return encodeURIComponent(a).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+")}function cw(a,t,e){if(!t)return a;const i=e&&e.encode||HE,r=ht.isFunction(e)?{serialize:e}:e,l=r&&r.serialize;let c;if(l?c=l(t,r):c=ht.isURLSearchParams(t)?t.toString():new Em(t,r).toString(i),c){const u=a.indexOf("#");u!==-1&&(a=a.slice(0,u)),a+=(a.indexOf("?")===-1?"?":"&")+c}return a}class Rv{constructor(){this.handlers=[]}use(t,e,i){return this.handlers.push({fulfilled:t,rejected:e,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){ht.forEach(this.handlers,function(i){i!==null&&t(i)})}}const _m={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1,legacyInterceptorReqResOrdering:!0},qE=typeof URLSearchParams<"u"?URLSearchParams:Em,GE=typeof FormData<"u"?FormData:null,$E=typeof Blob<"u"?Blob:null,VE={isBrowser:!0,classes:{URLSearchParams:qE,FormData:GE,Blob:$E},protocols:["http","https","file","blob","url","data"]},Cm=typeof window<"u"&&typeof document<"u",zp=typeof navigator=="object"&&navigator||void 0,KE=Cm&&(!zp||["ReactNative","NativeScript","NS"].indexOf(zp.product)<0),XE=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",YE=Cm&&window.location.href||"http://localhost",QE=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:Cm,hasStandardBrowserEnv:KE,hasStandardBrowserWebWorkerEnv:XE,navigator:zp,origin:YE},Symbol.toStringTag,{value:"Module"})),Xn={...QE,...VE};function WE(a,t){return Jh(a,new Xn.classes.URLSearchParams,{visitor:function(e,i,r,l){return Xn.isNode&&ht.isBuffer(e)?(this.append(i,e.toString("base64")),!1):l.defaultVisitor.apply(this,arguments)},...t})}function ZE(a){return ht.matchAll(/\w+|\[(\w*)]/g,a).map(t=>t[0]==="[]"?"":t[1]||t[0])}function JE(a){const t={},e=Object.keys(a);let i;const r=e.length;let l;for(i=0;i<r;i++)l=e[i],t[l]=a[l];return t}function uw(a){function t(e,i,r,l){let c=e[l++];if(c==="__proto__")return!0;const u=Number.isFinite(+c),d=l>=e.length;return c=!c&&ht.isArray(r)?r.length:c,d?(ht.hasOwnProp(r,c)?r[c]=[r[c],i]:r[c]=i,!u):((!r[c]||!ht.isObject(r[c]))&&(r[c]=[]),t(e,i,r[c],l)&&ht.isArray(r[c])&&(r[c]=JE(r[c])),!u)}if(ht.isFormData(a)&&ht.isFunction(a.entries)){const e={};return ht.forEachEntry(a,(i,r)=>{t(ZE(i),r,e,0)}),e}return null}function t_(a,t,e){if(ht.isString(a))try{return(t||JSON.parse)(a),ht.trim(a)}catch(i){if(i.name!=="SyntaxError")throw i}return(e||JSON.stringify)(a)}const Gc={transitional:_m,adapter:["xhr","http","fetch"],transformRequest:[function(t,e){const i=e.getContentType()||"",r=i.indexOf("application/json")>-1,l=ht.isObject(t);if(l&&ht.isHTMLForm(t)&&(t=new FormData(t)),ht.isFormData(t))return r?JSON.stringify(uw(t)):t;if(ht.isArrayBuffer(t)||ht.isBuffer(t)||ht.isStream(t)||ht.isFile(t)||ht.isBlob(t)||ht.isReadableStream(t))return t;if(ht.isArrayBufferView(t))return t.buffer;if(ht.isURLSearchParams(t))return e.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let u;if(l){if(i.indexOf("application/x-www-form-urlencoded")>-1)return WE(t,this.formSerializer).toString();if((u=ht.isFileList(t))||i.indexOf("multipart/form-data")>-1){const d=this.env&&this.env.FormData;return Jh(u?{"files[]":t}:t,d&&new d,this.formSerializer)}}return l||r?(e.setContentType("application/json",!1),t_(t)):t}],transformResponse:[function(t){const e=this.transitional||Gc.transitional,i=e&&e.forcedJSONParsing,r=this.responseType==="json";if(ht.isResponse(t)||ht.isReadableStream(t))return t;if(t&&ht.isString(t)&&(i&&!this.responseType||r)){const c=!(e&&e.silentJSONParsing)&&r;try{return JSON.parse(t,this.parseReviver)}catch(u){if(c)throw u.name==="SyntaxError"?te.from(u,te.ERR_BAD_RESPONSE,this,null,this.response):u}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Xn.classes.FormData,Blob:Xn.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};ht.forEach(["delete","get","head","post","put","patch"],a=>{Gc.headers[a]={}});const e_=ht.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),n_=a=>{const t={};let e,i,r;return a&&a.split(`
`).forEach(function(c){r=c.indexOf(":"),e=c.substring(0,r).trim().toLowerCase(),i=c.substring(r+1).trim(),!(!e||t[e]&&e_[e])&&(e==="set-cookie"?t[e]?t[e].push(i):t[e]=[i]:t[e]=t[e]?t[e]+", "+i:i)}),t},Mv=Symbol("internals");function xc(a){return a&&String(a).trim().toLowerCase()}function Oh(a){return a===!1||a==null?a:ht.isArray(a)?a.map(Oh):String(a)}function i_(a){const t=Object.create(null),e=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=e.exec(a);)t[i[1]]=i[2];return t}const s_=a=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(a.trim());function bp(a,t,e,i,r){if(ht.isFunction(i))return i.call(this,t,e);if(r&&(t=e),!!ht.isString(t)){if(ht.isString(i))return t.indexOf(i)!==-1;if(ht.isRegExp(i))return i.test(t)}}function r_(a){return a.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,e,i)=>e.toUpperCase()+i)}function a_(a,t){const e=ht.toCamelCase(" "+t);["get","set","has"].forEach(i=>{Object.defineProperty(a,i+e,{value:function(r,l,c){return this[i].call(this,t,r,l,c)},configurable:!0})})}let pi=class{constructor(t){t&&this.set(t)}set(t,e,i){const r=this;function l(u,d,f){const p=xc(d);if(!p)throw new Error("header name must be a non-empty string");const y=ht.findKey(r,p);(!y||r[y]===void 0||f===!0||f===void 0&&r[y]!==!1)&&(r[y||d]=Oh(u))}const c=(u,d)=>ht.forEach(u,(f,p)=>l(f,p,d));if(ht.isPlainObject(t)||t instanceof this.constructor)c(t,e);else if(ht.isString(t)&&(t=t.trim())&&!s_(t))c(n_(t),e);else if(ht.isObject(t)&&ht.isIterable(t)){let u={},d,f;for(const p of t){if(!ht.isArray(p))throw TypeError("Object iterator must return a key-value pair");u[f=p[0]]=(d=u[f])?ht.isArray(d)?[...d,p[1]]:[d,p[1]]:p[1]}c(u,e)}else t!=null&&l(e,t,i);return this}get(t,e){if(t=xc(t),t){const i=ht.findKey(this,t);if(i){const r=this[i];if(!e)return r;if(e===!0)return i_(r);if(ht.isFunction(e))return e.call(this,r,i);if(ht.isRegExp(e))return e.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,e){if(t=xc(t),t){const i=ht.findKey(this,t);return!!(i&&this[i]!==void 0&&(!e||bp(this,this[i],i,e)))}return!1}delete(t,e){const i=this;let r=!1;function l(c){if(c=xc(c),c){const u=ht.findKey(i,c);u&&(!e||bp(i,i[u],u,e))&&(delete i[u],r=!0)}}return ht.isArray(t)?t.forEach(l):l(t),r}clear(t){const e=Object.keys(this);let i=e.length,r=!1;for(;i--;){const l=e[i];(!t||bp(this,this[l],l,t,!0))&&(delete this[l],r=!0)}return r}normalize(t){const e=this,i={};return ht.forEach(this,(r,l)=>{const c=ht.findKey(i,l);if(c){e[c]=Oh(r),delete e[l];return}const u=t?r_(l):String(l).trim();u!==l&&delete e[l],e[u]=Oh(r),i[u]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const e=Object.create(null);return ht.forEach(this,(i,r)=>{i!=null&&i!==!1&&(e[r]=t&&ht.isArray(i)?i.join(", "):i)}),e}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,e])=>t+": "+e).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...e){const i=new this(t);return e.forEach(r=>i.set(r)),i}static accessor(t){const i=(this[Mv]=this[Mv]={accessors:{}}).accessors,r=this.prototype;function l(c){const u=xc(c);i[u]||(a_(r,c),i[u]=!0)}return ht.isArray(t)?t.forEach(l):l(t),this}};pi.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);ht.reduceDescriptors(pi.prototype,({value:a},t)=>{let e=t[0].toUpperCase()+t.slice(1);return{get:()=>a,set(i){this[e]=i}}});ht.freezeMethods(pi);function vp(a,t){const e=this||Gc,i=t||e,r=pi.from(i.headers);let l=i.data;return ht.forEach(a,function(u){l=u.call(e,l,r.normalize(),t?t.status:void 0)}),r.normalize(),l}function hw(a){return!!(a&&a.__CANCEL__)}let $c=class extends te{constructor(t,e,i){super(t??"canceled",te.ERR_CANCELED,e,i),this.name="CanceledError",this.__CANCEL__=!0}};function dw(a,t,e){const i=e.config.validateStatus;!e.status||!i||i(e.status)?a(e):t(new te("Request failed with status code "+e.status,[te.ERR_BAD_REQUEST,te.ERR_BAD_RESPONSE][Math.floor(e.status/100)-4],e.config,e.request,e))}function o_(a){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(a);return t&&t[1]||""}function l_(a,t){a=a||10;const e=new Array(a),i=new Array(a);let r=0,l=0,c;return t=t!==void 0?t:1e3,function(d){const f=Date.now(),p=i[l];c||(c=f),e[r]=d,i[r]=f;let y=l,w=0;for(;y!==r;)w+=e[y++],y=y%a;if(r=(r+1)%a,r===l&&(l=(l+1)%a),f-c<t)return;const A=p&&f-p;return A?Math.round(w*1e3/A):void 0}}function c_(a,t){let e=0,i=1e3/t,r,l;const c=(f,p=Date.now())=>{e=p,r=null,l&&(clearTimeout(l),l=null),a(...f)};return[(...f)=>{const p=Date.now(),y=p-e;y>=i?c(f,p):(r=f,l||(l=setTimeout(()=>{l=null,c(r)},i-y)))},()=>r&&c(r)]}const zh=(a,t,e=3)=>{let i=0;const r=l_(50,250);return c_(l=>{const c=l.loaded,u=l.lengthComputable?l.total:void 0,d=c-i,f=r(d),p=c<=u;i=c;const y={loaded:c,total:u,progress:u?c/u:void 0,bytes:d,rate:f||void 0,estimated:f&&u&&p?(u-c)/f:void 0,event:l,lengthComputable:u!=null,[t?"download":"upload"]:!0};a(y)},e)},Dv=(a,t)=>{const e=a!=null;return[i=>t[0]({lengthComputable:e,total:a,loaded:i}),t[1]]},Ov=a=>(...t)=>ht.asap(()=>a(...t)),u_=Xn.hasStandardBrowserEnv?((a,t)=>e=>(e=new URL(e,Xn.origin),a.protocol===e.protocol&&a.host===e.host&&(t||a.port===e.port)))(new URL(Xn.origin),Xn.navigator&&/(msie|trident)/i.test(Xn.navigator.userAgent)):()=>!0,h_=Xn.hasStandardBrowserEnv?{write(a,t,e,i,r,l,c){if(typeof document>"u")return;const u=[`${a}=${encodeURIComponent(t)}`];ht.isNumber(e)&&u.push(`expires=${new Date(e).toUTCString()}`),ht.isString(i)&&u.push(`path=${i}`),ht.isString(r)&&u.push(`domain=${r}`),l===!0&&u.push("secure"),ht.isString(c)&&u.push(`SameSite=${c}`),document.cookie=u.join("; ")},read(a){if(typeof document>"u")return null;const t=document.cookie.match(new RegExp("(?:^|; )"+a+"=([^;]*)"));return t?decodeURIComponent(t[1]):null},remove(a){this.write(a,"",Date.now()-864e5,"/")}}:{write(){},read(){return null},remove(){}};function d_(a){return typeof a!="string"?!1:/^([a-z][a-z\d+\-.]*:)?\/\//i.test(a)}function f_(a,t){return t?a.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):a}function fw(a,t,e){let i=!d_(t);return a&&(i||e==!1)?f_(a,t):t}const Nv=a=>a instanceof pi?{...a}:a;function Ya(a,t){t=t||{};const e={};function i(f,p,y,w){return ht.isPlainObject(f)&&ht.isPlainObject(p)?ht.merge.call({caseless:w},f,p):ht.isPlainObject(p)?ht.merge({},p):ht.isArray(p)?p.slice():p}function r(f,p,y,w){if(ht.isUndefined(p)){if(!ht.isUndefined(f))return i(void 0,f,y,w)}else return i(f,p,y,w)}function l(f,p){if(!ht.isUndefined(p))return i(void 0,p)}function c(f,p){if(ht.isUndefined(p)){if(!ht.isUndefined(f))return i(void 0,f)}else return i(void 0,p)}function u(f,p,y){if(y in t)return i(f,p);if(y in a)return i(void 0,f)}const d={url:l,method:l,data:l,baseURL:c,transformRequest:c,transformResponse:c,paramsSerializer:c,timeout:c,timeoutMessage:c,withCredentials:c,withXSRFToken:c,adapter:c,responseType:c,xsrfCookieName:c,xsrfHeaderName:c,onUploadProgress:c,onDownloadProgress:c,decompress:c,maxContentLength:c,maxBodyLength:c,beforeRedirect:c,transport:c,httpAgent:c,httpsAgent:c,cancelToken:c,socketPath:c,responseEncoding:c,validateStatus:u,headers:(f,p,y)=>r(Nv(f),Nv(p),y,!0)};return ht.forEach(Object.keys({...a,...t}),function(p){if(p==="__proto__"||p==="constructor"||p==="prototype")return;const y=ht.hasOwnProp(d,p)?d[p]:r,w=y(a[p],t[p],p);ht.isUndefined(w)&&y!==u||(e[p]=w)}),e}const pw=a=>{const t=Ya({},a);let{data:e,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:l,headers:c,auth:u}=t;if(t.headers=c=pi.from(c),t.url=cw(fw(t.baseURL,t.url,t.allowAbsoluteUrls),a.params,a.paramsSerializer),u&&c.set("Authorization","Basic "+btoa((u.username||"")+":"+(u.password?unescape(encodeURIComponent(u.password)):""))),ht.isFormData(e)){if(Xn.hasStandardBrowserEnv||Xn.hasStandardBrowserWebWorkerEnv)c.setContentType(void 0);else if(ht.isFunction(e.getHeaders)){const d=e.getHeaders(),f=["content-type","content-length"];Object.entries(d).forEach(([p,y])=>{f.includes(p.toLowerCase())&&c.set(p,y)})}}if(Xn.hasStandardBrowserEnv&&(i&&ht.isFunction(i)&&(i=i(t)),i||i!==!1&&u_(t.url))){const d=r&&l&&h_.read(l);d&&c.set(r,d)}return t},p_=typeof XMLHttpRequest<"u",m_=p_&&function(a){return new Promise(function(e,i){const r=pw(a);let l=r.data;const c=pi.from(r.headers).normalize();let{responseType:u,onUploadProgress:d,onDownloadProgress:f}=r,p,y,w,A,_;function S(){A&&A(),_&&_(),r.cancelToken&&r.cancelToken.unsubscribe(p),r.signal&&r.signal.removeEventListener("abort",p)}let C=new XMLHttpRequest;C.open(r.method.toUpperCase(),r.url,!0),C.timeout=r.timeout;function M(){if(!C)return;const L=pi.from("getAllResponseHeaders"in C&&C.getAllResponseHeaders()),F={data:!u||u==="text"||u==="json"?C.responseText:C.response,status:C.status,statusText:C.statusText,headers:L,config:a,request:C};dw(function(H){e(H),S()},function(H){i(H),S()},F),C=null}"onloadend"in C?C.onloadend=M:C.onreadystatechange=function(){!C||C.readyState!==4||C.status===0&&!(C.responseURL&&C.responseURL.indexOf("file:")===0)||setTimeout(M)},C.onabort=function(){C&&(i(new te("Request aborted",te.ECONNABORTED,a,C)),C=null)},C.onerror=function(j){const F=j&&j.message?j.message:"Network Error",z=new te(F,te.ERR_NETWORK,a,C);z.event=j||null,i(z),C=null},C.ontimeout=function(){let j=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const F=r.transitional||_m;r.timeoutErrorMessage&&(j=r.timeoutErrorMessage),i(new te(j,F.clarifyTimeoutError?te.ETIMEDOUT:te.ECONNABORTED,a,C)),C=null},l===void 0&&c.setContentType(null),"setRequestHeader"in C&&ht.forEach(c.toJSON(),function(j,F){C.setRequestHeader(F,j)}),ht.isUndefined(r.withCredentials)||(C.withCredentials=!!r.withCredentials),u&&u!=="json"&&(C.responseType=r.responseType),f&&([w,_]=zh(f,!0),C.addEventListener("progress",w)),d&&C.upload&&([y,A]=zh(d),C.upload.addEventListener("progress",y),C.upload.addEventListener("loadend",A)),(r.cancelToken||r.signal)&&(p=L=>{C&&(i(!L||L.type?new $c(null,a,C):L),C.abort(),C=null)},r.cancelToken&&r.cancelToken.subscribe(p),r.signal&&(r.signal.aborted?p():r.signal.addEventListener("abort",p)));const k=o_(r.url);if(k&&Xn.protocols.indexOf(k)===-1){i(new te("Unsupported protocol "+k+":",te.ERR_BAD_REQUEST,a));return}C.send(l||null)})},g_=(a,t)=>{const{length:e}=a=a?a.filter(Boolean):[];if(t||e){let i=new AbortController,r;const l=function(f){if(!r){r=!0,u();const p=f instanceof Error?f:this.reason;i.abort(p instanceof te?p:new $c(p instanceof Error?p.message:p))}};let c=t&&setTimeout(()=>{c=null,l(new te(`timeout of ${t}ms exceeded`,te.ETIMEDOUT))},t);const u=()=>{a&&(c&&clearTimeout(c),c=null,a.forEach(f=>{f.unsubscribe?f.unsubscribe(l):f.removeEventListener("abort",l)}),a=null)};a.forEach(f=>f.addEventListener("abort",l));const{signal:d}=i;return d.unsubscribe=()=>ht.asap(u),d}},y_=function*(a,t){let e=a.byteLength;if(e<t){yield a;return}let i=0,r;for(;i<e;)r=i+t,yield a.slice(i,r),i=r},b_=async function*(a,t){for await(const e of v_(a))yield*y_(e,t)},v_=async function*(a){if(a[Symbol.asyncIterator]){yield*a;return}const t=a.getReader();try{for(;;){const{done:e,value:i}=await t.read();if(e)break;yield i}}finally{await t.cancel()}},kv=(a,t,e,i)=>{const r=b_(a,t);let l=0,c,u=d=>{c||(c=!0,i&&i(d))};return new ReadableStream({async pull(d){try{const{done:f,value:p}=await r.next();if(f){u(),d.close();return}let y=p.byteLength;if(e){let w=l+=y;e(w)}d.enqueue(new Uint8Array(p))}catch(f){throw u(f),f}},cancel(d){return u(d),r.return()}},{highWaterMark:2})},Lv=64*1024,{isFunction:mh}=ht,w_=(({Request:a,Response:t})=>({Request:a,Response:t}))(ht.global),{ReadableStream:Pv,TextEncoder:Bv}=ht.global,jv=(a,...t)=>{try{return!!a(...t)}catch{return!1}},x_=a=>{a=ht.merge.call({skipUndefined:!0},w_,a);const{fetch:t,Request:e,Response:i}=a,r=t?mh(t):typeof fetch=="function",l=mh(e),c=mh(i);if(!r)return!1;const u=r&&mh(Pv),d=r&&(typeof Bv=="function"?(_=>S=>_.encode(S))(new Bv):async _=>new Uint8Array(await new e(_).arrayBuffer())),f=l&&u&&jv(()=>{let _=!1;const S=new e(Xn.origin,{body:new Pv,method:"POST",get duplex(){return _=!0,"half"}}).headers.has("Content-Type");return _&&!S}),p=c&&u&&jv(()=>ht.isReadableStream(new i("").body)),y={stream:p&&(_=>_.body)};r&&["text","arrayBuffer","blob","formData","stream"].forEach(_=>{!y[_]&&(y[_]=(S,C)=>{let M=S&&S[_];if(M)return M.call(S);throw new te(`Response type '${_}' is not supported`,te.ERR_NOT_SUPPORT,C)})});const w=async _=>{if(_==null)return 0;if(ht.isBlob(_))return _.size;if(ht.isSpecCompliantForm(_))return(await new e(Xn.origin,{method:"POST",body:_}).arrayBuffer()).byteLength;if(ht.isArrayBufferView(_)||ht.isArrayBuffer(_))return _.byteLength;if(ht.isURLSearchParams(_)&&(_=_+""),ht.isString(_))return(await d(_)).byteLength},A=async(_,S)=>{const C=ht.toFiniteNumber(_.getContentLength());return C??w(S)};return async _=>{let{url:S,method:C,data:M,signal:k,cancelToken:L,timeout:j,onDownloadProgress:F,onUploadProgress:z,responseType:H,headers:ut,withCredentials:ft="same-origin",fetchOptions:_t}=pw(_),ct=t||fetch;H=H?(H+"").toLowerCase():"text";let Tt=g_([k,L&&L.toAbortSignal()],j),Lt=null;const Bt=Tt&&Tt.unsubscribe&&(()=>{Tt.unsubscribe()});let Vt;try{if(z&&f&&C!=="get"&&C!=="head"&&(Vt=await A(ut,M))!==0){let I=new e(S,{method:"POST",body:M,duplex:"half"}),J;if(ht.isFormData(M)&&(J=I.headers.get("content-type"))&&ut.setContentType(J),I.body){const[mt,xt]=Dv(Vt,zh(Ov(z)));M=kv(I.body,Lv,mt,xt)}}ht.isString(ft)||(ft=ft?"include":"omit");const G=l&&"credentials"in e.prototype,st={..._t,signal:Tt,method:C.toUpperCase(),headers:ut.normalize().toJSON(),body:M,duplex:"half",credentials:G?ft:void 0};Lt=l&&new e(S,st);let wt=await(l?ct(Lt,_t):ct(S,st));const Yt=p&&(H==="stream"||H==="response");if(p&&(F||Yt&&Bt)){const I={};["status","statusText","headers"].forEach(It=>{I[It]=wt[It]});const J=ht.toFiniteNumber(wt.headers.get("content-length")),[mt,xt]=F&&Dv(J,zh(Ov(F),!0))||[];wt=new i(kv(wt.body,Lv,mt,()=>{xt&&xt(),Bt&&Bt()}),I)}H=H||"text";let Ct=await y[ht.findKey(y,H)||"text"](wt,_);return!Yt&&Bt&&Bt(),await new Promise((I,J)=>{dw(I,J,{data:Ct,headers:pi.from(wt.headers),status:wt.status,statusText:wt.statusText,config:_,request:Lt})})}catch(G){throw Bt&&Bt(),G&&G.name==="TypeError"&&/Load failed|fetch/i.test(G.message)?Object.assign(new te("Network Error",te.ERR_NETWORK,_,Lt,G&&G.response),{cause:G.cause||G}):te.from(G,G&&G.code,_,Lt,G&&G.response)}}},A_=new Map,mw=a=>{let t=a&&a.env||{};const{fetch:e,Request:i,Response:r}=t,l=[i,r,e];let c=l.length,u=c,d,f,p=A_;for(;u--;)d=l[u],f=p.get(d),f===void 0&&p.set(d,f=u?new Map:x_(t)),p=f;return f};mw();const Tm={http:IE,xhr:m_,fetch:{get:mw}};ht.forEach(Tm,(a,t)=>{if(a){try{Object.defineProperty(a,"name",{value:t})}catch{}Object.defineProperty(a,"adapterName",{value:t})}});const Fv=a=>`- ${a}`,S_=a=>ht.isFunction(a)||a===null||a===!1;function E_(a,t){a=ht.isArray(a)?a:[a];const{length:e}=a;let i,r;const l={};for(let c=0;c<e;c++){i=a[c];let u;if(r=i,!S_(i)&&(r=Tm[(u=String(i)).toLowerCase()],r===void 0))throw new te(`Unknown adapter '${u}'`);if(r&&(ht.isFunction(r)||(r=r.get(t))))break;l[u||"#"+c]=r}if(!r){const c=Object.entries(l).map(([d,f])=>`adapter ${d} `+(f===!1?"is not supported by the environment":"is not available in the build"));let u=e?c.length>1?`since :
`+c.map(Fv).join(`
`):" "+Fv(c[0]):"as no adapter specified";throw new te("There is no suitable adapter to dispatch the request "+u,"ERR_NOT_SUPPORT")}return r}const gw={getAdapter:E_,adapters:Tm};function wp(a){if(a.cancelToken&&a.cancelToken.throwIfRequested(),a.signal&&a.signal.aborted)throw new $c(null,a)}function Iv(a){return wp(a),a.headers=pi.from(a.headers),a.data=vp.call(a,a.transformRequest),["post","put","patch"].indexOf(a.method)!==-1&&a.headers.setContentType("application/x-www-form-urlencoded",!1),gw.getAdapter(a.adapter||Gc.adapter,a)(a).then(function(i){return wp(a),i.data=vp.call(a,a.transformResponse,i),i.headers=pi.from(i.headers),i},function(i){return hw(i)||(wp(a),i&&i.response&&(i.response.data=vp.call(a,a.transformResponse,i.response),i.response.headers=pi.from(i.response.headers))),Promise.reject(i)})}const yw="1.13.5",td={};["object","boolean","number","function","string","symbol"].forEach((a,t)=>{td[a]=function(i){return typeof i===a||"a"+(t<1?"n ":" ")+a}});const Uv={};td.transitional=function(t,e,i){function r(l,c){return"[Axios v"+yw+"] Transitional option '"+l+"'"+c+(i?". "+i:"")}return(l,c,u)=>{if(t===!1)throw new te(r(c," has been removed"+(e?" in "+e:"")),te.ERR_DEPRECATED);return e&&!Uv[c]&&(Uv[c]=!0,console.warn(r(c," has been deprecated since v"+e+" and will be removed in the near future"))),t?t(l,c,u):!0}};td.spelling=function(t){return(e,i)=>(console.warn(`${i} is likely a misspelling of ${t}`),!0)};function __(a,t,e){if(typeof a!="object")throw new te("options must be an object",te.ERR_BAD_OPTION_VALUE);const i=Object.keys(a);let r=i.length;for(;r-- >0;){const l=i[r],c=t[l];if(c){const u=a[l],d=u===void 0||c(u,l,a);if(d!==!0)throw new te("option "+l+" must be "+d,te.ERR_BAD_OPTION_VALUE);continue}if(e!==!0)throw new te("Unknown option "+l,te.ERR_BAD_OPTION)}}const Nh={assertOptions:__,validators:td},zi=Nh.validators;let $a=class{constructor(t){this.defaults=t||{},this.interceptors={request:new Rv,response:new Rv}}async request(t,e){try{return await this._request(t,e)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const l=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?l&&!String(i.stack).endsWith(l.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+l):i.stack=l}catch{}}throw i}}_request(t,e){typeof t=="string"?(e=e||{},e.url=t):e=t||{},e=Ya(this.defaults,e);const{transitional:i,paramsSerializer:r,headers:l}=e;i!==void 0&&Nh.assertOptions(i,{silentJSONParsing:zi.transitional(zi.boolean),forcedJSONParsing:zi.transitional(zi.boolean),clarifyTimeoutError:zi.transitional(zi.boolean),legacyInterceptorReqResOrdering:zi.transitional(zi.boolean)},!1),r!=null&&(ht.isFunction(r)?e.paramsSerializer={serialize:r}:Nh.assertOptions(r,{encode:zi.function,serialize:zi.function},!0)),e.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?e.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:e.allowAbsoluteUrls=!0),Nh.assertOptions(e,{baseUrl:zi.spelling("baseURL"),withXsrfToken:zi.spelling("withXSRFToken")},!0),e.method=(e.method||this.defaults.method||"get").toLowerCase();let c=l&&ht.merge(l.common,l[e.method]);l&&ht.forEach(["delete","get","head","post","put","patch","common"],_=>{delete l[_]}),e.headers=pi.concat(c,l);const u=[];let d=!0;this.interceptors.request.forEach(function(S){if(typeof S.runWhen=="function"&&S.runWhen(e)===!1)return;d=d&&S.synchronous;const C=e.transitional||_m;C&&C.legacyInterceptorReqResOrdering?u.unshift(S.fulfilled,S.rejected):u.push(S.fulfilled,S.rejected)});const f=[];this.interceptors.response.forEach(function(S){f.push(S.fulfilled,S.rejected)});let p,y=0,w;if(!d){const _=[Iv.bind(this),void 0];for(_.unshift(...u),_.push(...f),w=_.length,p=Promise.resolve(e);y<w;)p=p.then(_[y++],_[y++]);return p}w=u.length;let A=e;for(;y<w;){const _=u[y++],S=u[y++];try{A=_(A)}catch(C){S.call(this,C);break}}try{p=Iv.call(this,A)}catch(_){return Promise.reject(_)}for(y=0,w=f.length;y<w;)p=p.then(f[y++],f[y++]);return p}getUri(t){t=Ya(this.defaults,t);const e=fw(t.baseURL,t.url,t.allowAbsoluteUrls);return cw(e,t.params,t.paramsSerializer)}};ht.forEach(["delete","get","head","options"],function(t){$a.prototype[t]=function(e,i){return this.request(Ya(i||{},{method:t,url:e,data:(i||{}).data}))}});ht.forEach(["post","put","patch"],function(t){function e(i){return function(l,c,u){return this.request(Ya(u||{},{method:t,headers:i?{"Content-Type":"multipart/form-data"}:{},url:l,data:c}))}}$a.prototype[t]=e(),$a.prototype[t+"Form"]=e(!0)});let C_=class bw{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let e;this.promise=new Promise(function(l){e=l});const i=this;this.promise.then(r=>{if(!i._listeners)return;let l=i._listeners.length;for(;l-- >0;)i._listeners[l](r);i._listeners=null}),this.promise.then=r=>{let l;const c=new Promise(u=>{i.subscribe(u),l=u}).then(r);return c.cancel=function(){i.unsubscribe(l)},c},t(function(l,c,u){i.reason||(i.reason=new $c(l,c,u),e(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const e=this._listeners.indexOf(t);e!==-1&&this._listeners.splice(e,1)}toAbortSignal(){const t=new AbortController,e=i=>{t.abort(i)};return this.subscribe(e),t.signal.unsubscribe=()=>this.unsubscribe(e),t.signal}static source(){let t;return{token:new bw(function(r){t=r}),cancel:t}}};function T_(a){return function(e){return a.apply(null,e)}}function R_(a){return ht.isObject(a)&&a.isAxiosError===!0}const Hp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511,WebServerIsDown:521,ConnectionTimedOut:522,OriginIsUnreachable:523,TimeoutOccurred:524,SslHandshakeFailed:525,InvalidSslCertificate:526};Object.entries(Hp).forEach(([a,t])=>{Hp[t]=a});function vw(a){const t=new $a(a),e=Z0($a.prototype.request,t);return ht.extend(e,$a.prototype,t,{allOwnKeys:!0}),ht.extend(e,t,null,{allOwnKeys:!0}),e.create=function(r){return vw(Ya(a,r))},e}const cn=vw(Gc);cn.Axios=$a;cn.CanceledError=$c;cn.CancelToken=C_;cn.isCancel=hw;cn.VERSION=yw;cn.toFormData=Jh;cn.AxiosError=te;cn.Cancel=cn.CanceledError;cn.all=function(t){return Promise.all(t)};cn.spread=T_;cn.isAxiosError=R_;cn.mergeConfig=Ya;cn.AxiosHeaders=pi;cn.formToJSON=a=>uw(ht.isHTMLForm(a)?new FormData(a):a);cn.getAdapter=gw.getAdapter;cn.HttpStatusCode=Hp;cn.default=cn;const{Axios:q2,AxiosError:G2,CanceledError:$2,isCancel:V2,CancelToken:K2,VERSION:X2,all:Y2,Cancel:Q2,isAxiosError:W2,spread:Z2,toFormData:J2,AxiosHeaders:tR,HttpStatusCode:eR,formToJSON:nR,getAdapter:iR,mergeConfig:sR}=cn,tn=cn.create({baseURL:"/api",headers:{"Content-Type":"application/json"}});tn.interceptors.request.use(a=>{const t=na.getState().token;return t&&(a.headers.Authorization=`Token ${t}`),a.data instanceof FormData&&delete a.headers["Content-Type"],a});tn.interceptors.response.use(a=>a,a=>(a.response?.status===401&&na.getState().logout(),Promise.reject(a)));const qp={login:(a,t)=>tn.post("/auth/login/",{email:a,password:t}),register:a=>tn.post("/auth/register/",a),logout:()=>tn.post("/auth/logout/"),me:()=>tn.get("/auth/me/")},Hh={list:()=>tn.get("/projects/"),get:a=>tn.get(`/projects/${a}/`),create:a=>tn.post("/projects/",a),update:(a,t)=>tn.patch(`/projects/${a}/`,t),delete:a=>tn.delete(`/projects/${a}/`)},ti={list:a=>tn.get("/documents/",{params:a}),get:a=>tn.get(`/documents/${a}/`),create:a=>tn.post("/documents/",a),createWithFile:a=>tn.post("/documents/",a),getPdf:a=>tn.get(`/documents/${a}/pdf/`,{responseType:"arraybuffer"}),update:(a,t)=>tn.patch(`/documents/${a}/`,t),delete:a=>tn.delete(`/documents/${a}/`),highlights:a=>tn.get(`/documents/${a}/highlights/`),createHighlight:(a,t)=>tn.post(`/documents/${a}/highlights/`,t),updateHighlight:(a,t,e)=>tn.patch(`/documents/${a}/highlights/${t}/`,e),deleteHighlight:(a,t)=>tn.delete(`/documents/${a}/highlights/${t}/`)},M_={page:"bg-slate-50",surface:"bg-white",muted:"bg-slate-100",primary:"bg-slate-800"},Kt={body:"text-slate-800",heading:"text-slate-900",secondary:"text-slate-600",muted:"text-slate-500"},Un={default:"border-slate-200"},Cs="min-h-screen p-6",ww="bg-white border-b border-slate-200",Ti="bg-slate-800 text-white rounded-lg px-4 py-2 text-sm font-medium hover:bg-slate-700 cursor-pointer",Ua="p-2 rounded-lg text-slate-600 hover:bg-slate-100 cursor-pointer",zv="w-px h-6 bg-slate-200",Mn=M_;function D_(){const a=ea(),t=na(y=>y.setToken),[e,i]=U.useState(""),[r,l]=U.useState(""),[c,u]=U.useState(""),[d,f]=U.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{const{data:w}=await qp.login(e,r);t(w.token),a("/",{replace:!0})}catch(w){u(w.response?.data?.detail||w.response?.data?.email?.[0]||"Login failed")}finally{f(!1)}};return O.jsx("div",{className:`${Cs} ${Mn.page} flex items-center justify-center`,children:O.jsxs("div",{className:"w-full max-w-sm",children:[O.jsx("h1",{className:`text-2xl font-semibold ${Kt.heading} mb-6`,children:"Sign in"}),O.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&O.jsx("p",{className:"text-sm text-red-600",children:c}),O.jsxs("label",{className:"flex flex-col gap-1",children:[O.jsx("span",{className:`text-sm ${Kt.secondary}`,children:"Email"}),O.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),O.jsxs("label",{className:"flex flex-col gap-1",children:[O.jsx("span",{className:`text-sm ${Kt.secondary}`,children:"Password"}),O.jsx("input",{type:"password",value:r,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"current-password"})]}),O.jsx("button",{type:"submit",disabled:d,className:Ti,children:d?"Signing in...":"Sign in"})]}),O.jsxs("p",{className:`mt-4 text-sm ${Kt.muted}`,children:["No account? ",O.jsx(ol,{to:"/register",className:"text-slate-700 underline",children:"Register"})]})]})})}function O_(){const a=ea(),t=na(y=>y.setToken),[e,i]=U.useState(""),[r,l]=U.useState(""),[c,u]=U.useState(""),[d,f]=U.useState(!1),p=async y=>{y.preventDefault(),u(""),f(!0);try{await qp.register({email:e,password:r});const{data:w}=await qp.login(e,r);t(w.token),a("/",{replace:!0})}catch(w){const A=w.response?.data;u(A?.email?.[0]||A?.password?.[0]||"Registration failed")}finally{f(!1)}};return O.jsx("div",{className:`${Cs} ${Mn.page} flex items-center justify-center`,children:O.jsxs("div",{className:"w-full max-w-sm",children:[O.jsx("h1",{className:`text-2xl font-semibold ${Kt.heading} mb-6`,children:"Create account"}),O.jsxs("form",{onSubmit:p,className:"flex flex-col gap-4",children:[c&&O.jsx("p",{className:"text-sm text-red-600",children:c}),O.jsxs("label",{className:"flex flex-col gap-1",children:[O.jsx("span",{className:`text-sm ${Kt.secondary}`,children:"Email"}),O.jsx("input",{type:"email",value:e,onChange:y=>i(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"email"})]}),O.jsxs("label",{className:"flex flex-col gap-1",children:[O.jsx("span",{className:`text-sm ${Kt.secondary}`,children:"Password"}),O.jsx("input",{type:"password",value:r,onChange:y=>l(y.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900",required:!0,autoComplete:"new-password"})]}),O.jsx("button",{type:"submit",disabled:d,className:Ti,children:d?"Creating account...":"Register"})]}),O.jsxs("p",{className:`mt-4 text-sm ${Kt.muted}`,children:["Already have an account? ",O.jsx(ol,{to:"/login",className:"text-slate-700 underline",children:"Sign in"})]})]})})}function N_(){return O.jsxs("div",{className:`min-h-screen ${Mn.page} ${Kt.body}`,children:[O.jsxs("nav",{className:`fixed top-0 left-0 right-0 z-10 h-[52px] px-6 flex items-center justify-between border-b ${Un.default} ${Mn.surface}`,children:[O.jsxs("div",{className:`flex items-center gap-2 text-sm font-semibold ${Kt.heading}`,children:[O.jsx("div",{className:`w-5 h-5 rounded-md ${Mn.primary} flex items-center justify-center text-[10px] font-bold text-white`,children:"W"}),"WiseMark"]}),O.jsx(ol,{to:"/login",className:`${Ti} no-underline text-sm py-1.5 px-3.5 rounded-md`,children:"Request access"})]}),O.jsxs("section",{className:"landing-hero pt-[200px] pb-40 px-6 max-w-[680px] mx-auto text-center",children:[O.jsxs("h1",{className:`text-4xl sm:text-5xl md:text-6xl font-semibold leading-tight tracking-tight ${Kt.heading} mb-5`,children:["Never read the",O.jsx("br",{}),"same page ",O.jsx("em",{className:"landing-twice",children:"twice"})]}),O.jsx("p",{className:`text-base leading-relaxed max-w-[400px] mx-auto mb-9 ${Kt.muted}`,children:"PDF annotations for private equity. Highlight once, find it forever  without your deal docs ever leaving your device."}),O.jsxs(ol,{to:"/register",className:`${Ti} inline-flex items-center gap-2 py-2.5 px-5 rounded-lg text-sm font-semibold no-underline hover:opacity-90`,children:["Get early access",O.jsx("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",children:O.jsx("path",{d:"M3 8h10M9 4l4 4-4 4"})})]})]}),O.jsx("section",{className:`landing-features max-w-[560px] mx-auto px-6 pb-40 flex flex-col border-t ${Un.default}`,children:[{label:"Highlight and comment",desc:"Colour-coded annotations with notes, right on the original PDF"},{label:"Organise by deal",desc:"Group documents by project so nothing gets lost between deals"},{label:"Search every annotation",desc:"Across every deal, every document, in seconds"},{label:"Export everything",desc:"Notes and excerpts as structured Word docs or PDFs"},{label:"NDA & GDPR compliant",desc:"Your PDFs never touch a server. Only your notes sync"}].map(({label:a,desc:t})=>O.jsxs("div",{className:`flex flex-col sm:flex-row sm:items-baseline sm:justify-between gap-1 py-5 border-b ${Un.default}`,children:[O.jsx("span",{className:`text-sm font-medium ${Kt.heading}`,children:a}),O.jsx("span",{className:`text-sm sm:text-right sm:max-w-[240px] ${Kt.muted}`,children:t})]},a))}),O.jsx("footer",{className:`py-6 px-6 border-t ${Un.default} text-center text-xs ${Kt.muted}`,children:" 2026 WiseMark"}),O.jsx("style",{children:`
        @keyframes landingFade {
          from { opacity: 0; transform: translateY(12px); }
          to { opacity: 1; transform: translateY(0); }
        }
        .landing-hero { animation: landingFade 0.8s ease both; }
        .landing-features { animation: landingFade 0.8s ease 0.2s both; }
        .landing-twice {
          font-style: italic;
          background: linear-gradient(135deg, #475569 0%, #2563eb 50%, #6366f1 100%);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }
      `})]})}const xw=(...a)=>a.filter((t,e,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===e).join(" ").trim();const k_=a=>a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();const L_=a=>a.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,e,i)=>i?i.toUpperCase():e.toLowerCase());const Hv=a=>{const t=L_(a);return t.charAt(0).toUpperCase()+t.slice(1)};var P_={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const B_=a=>{for(const t in a)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};const j_=U.forwardRef(({color:a="currentColor",size:t=24,strokeWidth:e=2,absoluteStrokeWidth:i,className:r="",children:l,iconNode:c,...u},d)=>U.createElement("svg",{ref:d,...P_,width:t,height:t,stroke:a,strokeWidth:i?Number(e)*24/Number(t):e,className:xw("lucide",r),...!l&&!B_(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>U.createElement(f,p)),...Array.isArray(l)?l:[l]]));const un=(a,t)=>{const e=U.forwardRef(({className:i,...r},l)=>U.createElement(j_,{ref:l,iconNode:t,className:xw(`lucide-${k_(Hv(a))}`,`lucide-${a}`,i),...r}));return e.displayName=Hv(a),e};const F_=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],Rm=un("arrow-left",F_);const I_=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],qv=un("check",I_);const U_=[["path",{d:"M11 21a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1",key:"likhh7"}],["path",{d:"M16 16a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1V8a1 1 0 0 1 1-1",key:"17ky3x"}],["path",{d:"M21 6a2 2 0 0 0-.586-1.414l-2-2A2 2 0 0 0 17 2h-3a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1z",key:"1hyeo0"}]],z_=un("file-stack",U_);const H_=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],Aw=un("file-text",H_);const q_=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],Gv=un("folder-open",q_);const G_=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],$_=un("folder-plus",G_);const V_=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],K_=un("layers",V_);const X_=[["path",{d:"M11 5h10",key:"1cz7ny"}],["path",{d:"M11 12h10",key:"1438ji"}],["path",{d:"M11 19h10",key:"11t30w"}],["path",{d:"M4 4h1v5",key:"10yrso"}],["path",{d:"M4 9h2",key:"r1h2o0"}],["path",{d:"M6.5 20H3.4c0-1 2.6-1.925 2.6-3.5a1.5 1.5 0 0 0-2.6-1.02",key:"xtkcd5"}]],Y_=un("list-ordered",X_);const Q_=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],or=un("loader-circle",Q_);const W_=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Z_=un("log-out",W_);const J_=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],tC=un("panel-right-close",J_);const eC=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m10 15-3-3 3-3",key:"1pgupc"}]],nC=un("panel-right-open",eC);const iC=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Gp=un("pencil",iC);const sC=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],rC=un("plus",sC);const aC=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],oC=un("search",aC);const lC=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],cC=un("settings-2",lC);const uC=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Mm=un("trash-2",uC);const hC=[["path",{d:"M12 3v12",key:"1x0j5s"}],["path",{d:"m17 8-5-5-5 5",key:"7q97r8"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}]],$p=un("upload",hC);const dC=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Vp=un("x",dC);const fC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],pC=un("zoom-in",fC);const mC=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]],gC=un("zoom-out",mC);function yC(){const a=ea(),t=pl(),e=na(A=>A.logout),[i,r]=U.useState(""),[l,c]=U.useState(!1),{data:u,isLoading:d}=Xa({queryKey:["projects"],queryFn:async()=>{const{data:A}=await Hh.list();return A}}),f=Array.isArray(u)?u:u?.results??[],p=Dc({mutationFn:A=>Hh.create({name:A.trim()}),onSuccess:()=>{t.invalidateQueries({queryKey:["projects"]}),r(""),c(!1)}}),y=()=>{e(),a("/login",{replace:!0})},w=A=>{A.preventDefault();const _=i.trim();_&&p.mutate(_)};return O.jsxs("div",{className:`${Cs} ${Mn.page}`,children:[O.jsxs("header",{className:"flex items-center justify-between mb-8",children:[O.jsx("h1",{className:`text-xl font-semibold ${Kt.heading}`,children:"Projects"}),O.jsx("button",{type:"button",onClick:y,className:Ua,title:"Sign out",children:O.jsx(Z_,{className:"w-4 h-4"})})]}),l?O.jsxs("form",{onSubmit:w,className:"flex items-center gap-2 mb-6",children:[O.jsx("input",{type:"text",value:i,onChange:A=>r(A.target.value),placeholder:"Project name",className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900 flex-1 max-w-xs",autoFocus:!0}),O.jsx("button",{type:"submit",disabled:p.isPending,className:Ti,children:p.isPending?"Adding...":"Add"}),O.jsx("button",{type:"button",onClick:()=>{c(!1),r("")},className:"text-slate-500 hover:text-slate-700",children:"Cancel"})]}):O.jsxs("button",{type:"button",onClick:()=>c(!0),className:`flex items-center gap-2 mb-6 ${Ti}`,children:[O.jsx($_,{className:"w-4 h-4"}),"Add a project"]}),d?O.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[O.jsx(or,{className:"w-5 h-5 animate-spin"})," Loading projects..."]}):f.length===0?O.jsxs("div",{className:`rounded-xl border ${Un.default} p-8 text-center ${Kt.secondary}`,children:[O.jsx(Gv,{className:"w-12 h-12 mx-auto mb-3 text-slate-400"}),O.jsx("p",{children:"No projects yet. Add a project to get started, then add PDFs to it."})]}):O.jsx("ul",{className:"space-y-2",children:f.map(A=>O.jsx("li",{children:O.jsxs("button",{type:"button",onClick:()=>a(`/project/${A.id}`),className:`w-full flex items-center justify-between rounded-lg border ${Un.default} ${Mn.surface} px-4 py-3 hover:bg-slate-50 cursor-pointer text-left`,children:[O.jsx("span",{className:`font-medium ${Kt.body}`,children:A.name}),O.jsx(Gv,{className:"w-4 h-4 text-slate-400"})]})},A.id))})]})}var kh={exports:{}},bC=kh.exports,$v;function vC(){return $v||($v=1,(function(a,t){((e,i)=>{a.exports=i()})(bC,function(){var e=function(m,v){return(e=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(x,E){x.__proto__=E}:function(x,E){for(var R in E)Object.prototype.hasOwnProperty.call(E,R)&&(x[R]=E[R])}))(m,v)},i=function(){return(i=Object.assign||function(m){for(var v,x=1,E=arguments.length;x<E;x++)for(var R in v=arguments[x])Object.prototype.hasOwnProperty.call(v,R)&&(m[R]=v[R]);return m}).apply(this,arguments)};function r(m,v,x){for(var E,R=0,D=v.length;R<D;R++)!E&&R in v||((E=E||Array.prototype.slice.call(v,0,R))[R]=v[R]);return m.concat(E||Array.prototype.slice.call(v))}var l=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:Ex,c=Object.keys,u=Array.isArray;function d(m,v){return typeof v=="object"&&c(v).forEach(function(x){m[x]=v[x]}),m}typeof Promise>"u"||l.Promise||(l.Promise=Promise);var f=Object.getPrototypeOf,p={}.hasOwnProperty;function y(m,v){return p.call(m,v)}function w(m,v){typeof v=="function"&&(v=v(f(m))),(typeof Reflect>"u"?c:Reflect.ownKeys)(v).forEach(function(x){_(m,x,v[x])})}var A=Object.defineProperty;function _(m,v,x,E){A(m,v,d(x&&y(x,"get")&&typeof x.get=="function"?{get:x.get,set:x.set,configurable:!0}:{value:x,configurable:!0,writable:!0},E))}function S(m){return{from:function(v){return m.prototype=Object.create(v.prototype),_(m.prototype,"constructor",m),{extend:w.bind(null,m.prototype)}}}}var C=Object.getOwnPropertyDescriptor,M=[].slice;function k(m,v,x){return M.call(m,v,x)}function L(m,v){return v(m)}function j(m){if(!m)throw new Error("Assertion Failed")}function F(m){l.setImmediate?setImmediate(m):setTimeout(m,0)}function z(m,v){if(typeof v=="string"&&y(m,v))return m[v];if(!v)return m;if(typeof v!="string"){for(var x=[],E=0,R=v.length;E<R;++E){var D=z(m,v[E]);x.push(D)}return x}var P,B=v.indexOf(".");return B===-1||(P=m[v.substr(0,B)])==null?void 0:z(P,v.substr(B+1))}function H(m,v,x){if(m&&v!==void 0&&!("isFrozen"in Object&&Object.isFrozen(m)))if(typeof v!="string"&&"length"in v){j(typeof x!="string"&&"length"in x);for(var E=0,R=v.length;E<R;++E)H(m,v[E],x[E])}else{var D,P,B=v.indexOf(".");B!==-1?(D=v.substr(0,B),(B=v.substr(B+1))===""?x===void 0?u(m)&&!isNaN(parseInt(D))?m.splice(D,1):delete m[D]:m[D]=x:H(P=(P=m[D])&&y(m,D)?P:m[D]={},B,x)):x===void 0?u(m)&&!isNaN(parseInt(v))?m.splice(v,1):delete m[v]:m[v]=x}}function ut(m){var v,x={};for(v in m)y(m,v)&&(x[v]=m[v]);return x}var ft=[].concat;function _t(m){return ft.apply([],m)}var J="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(_t([8,16,32,64].map(function(m){return["Int","Uint","Float"].map(function(v){return v+m+"Array"})}))).filter(function(m){return l[m]}),ct=new Set(J.map(function(m){return l[m]})),Tt=null;function Lt(m){return Tt=new WeakMap,m=(function v(x){if(!x||typeof x!="object")return x;var E=Tt.get(x);if(E)return E;if(u(x)){E=[],Tt.set(x,E);for(var R=0,D=x.length;R<D;++R)E.push(v(x[R]))}else if(ct.has(x.constructor))E=x;else{var P,B=f(x);for(P in E=B===Object.prototype?{}:Object.create(B),Tt.set(x,E),x)y(x,P)&&(E[P]=v(x[P]))}return E})(m),Tt=null,m}var Bt={}.toString;function Vt(m){return Bt.call(m).slice(8,-1)}var G=typeof Symbol<"u"?Symbol.iterator:"@@iterator",st=typeof G=="symbol"?function(m){var v;return m!=null&&(v=m[G])&&v.apply(m)}:function(){return null};function wt(m,v){v=m.indexOf(v),0<=v&&m.splice(v,1)}var Yt={};function Ct(m){var v,x,E,R;if(arguments.length===1){if(u(m))return m.slice();if(this===Yt&&typeof m=="string")return[m];if(R=st(m))for(x=[];!(E=R.next()).done;)x.push(E.value);else{if(m==null)return[m];if(typeof(v=m.length)!="number")return[m];for(x=new Array(v);v--;)x[v]=m[v]}}else for(v=arguments.length,x=new Array(v);v--;)x[v]=arguments[v];return x}var I=typeof Symbol<"u"?function(m){return m[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},J=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Hn=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(J),mt={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function xt(m,v){this.name=m,this.message=v}function It(m,v){return m+". Errors: "+Object.keys(v).map(function(x){return v[x].toString()}).filter(function(x,E,R){return R.indexOf(x)===E}).join(`
`)}function Ut(m,v,x,E){this.failures=v,this.failedKeys=E,this.successCount=x,this.message=It(m,v)}function Ot(m,v){this.name="BulkError",this.failures=Object.keys(v).map(function(x){return v[x]}),this.failuresByPos=v,this.message=It(m,this.failures)}S(xt).from(Error).extend({toString:function(){return this.name+": "+this.message}}),S(Ut).from(xt),S(Ot).from(xt);var Rt=Hn.reduce(function(m,v){return m[v]=v+"Error",m},{}),jt=xt,kt=Hn.reduce(function(m,v){var x=v+"Error";function E(R,D){this.name=x,R?typeof R=="string"?(this.message="".concat(R).concat(D?`
 `+D:""),this.inner=D||null):typeof R=="object"&&(this.message="".concat(R.name," ").concat(R.message),this.inner=R):(this.message=mt[v]||x,this.inner=null)}return S(E).from(jt),m[v]=E,m},{}),we=(kt.Syntax=SyntaxError,kt.Type=TypeError,kt.Range=RangeError,J.reduce(function(m,v){return m[v+"Error"]=kt[v],m},{}));J=Hn.reduce(function(m,v){return["Syntax","Type","Range"].indexOf(v)===-1&&(m[v+"Error"]=kt[v]),m},{});function pt(){}function fe(m){return m}function ve(m,v){return m==null||m===fe?v:function(x){return v(m(x))}}function An(m,v){return function(){m.apply(this,arguments),v.apply(this,arguments)}}function gl(m,v){return m===pt?v:function(){var x=m.apply(this,arguments),E=(x!==void 0&&(arguments[0]=x),this.onsuccess),R=this.onerror,D=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return E&&(this.onsuccess=this.onsuccess?An(E,this.onsuccess):E),R&&(this.onerror=this.onerror?An(R,this.onerror):R),D!==void 0?D:x}}function fd(m,v){return m===pt?v:function(){m.apply(this,arguments);var x=this.onsuccess,E=this.onerror;this.onsuccess=this.onerror=null,v.apply(this,arguments),x&&(this.onsuccess=this.onsuccess?An(x,this.onsuccess):x),E&&(this.onerror=this.onerror?An(E,this.onerror):E)}}function Wc(m,v){return m===pt?v:function(R){var E=m.apply(this,arguments),R=(d(R,E),this.onsuccess),D=this.onerror,P=(this.onsuccess=null,this.onerror=null,v.apply(this,arguments));return R&&(this.onsuccess=this.onsuccess?An(R,this.onsuccess):R),D&&(this.onerror=this.onerror?An(D,this.onerror):D),E===void 0?P===void 0?void 0:P:d(E,P)}}function yl(m,v){return m===pt?v:function(){return v.apply(this,arguments)!==!1&&m.apply(this,arguments)}}function ia(m,v){return m===pt?v:function(){var x=m.apply(this,arguments);if(x&&typeof x.then=="function"){for(var E=this,R=arguments.length,D=new Array(R);R--;)D[R]=arguments[R];return x.then(function(){return v.apply(E,D)})}return v.apply(this,arguments)}}J.ModifyError=Ut,J.DexieError=xt,J.BulkError=Ot;var ni=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Zc(m){ni=m}var sa={},zn=100,ra=typeof Promise>"u"?[]:(Hn=Promise.resolve(),typeof crypto<"u"&&crypto.subtle?[ra=crypto.subtle.digest("SHA-512",new Uint8Array([0])),f(ra),Hn]:[Hn,f(Hn),Hn]),Hn=ra[0],zs=ra[1],zs=zs&&zs.then,ns=Hn&&Hn.constructor,hr=!!ra[2],aa=function(m,v){oa.push([m,v]),eo&&(queueMicrotask(Jc),eo=!1)},to=!0,eo=!0,Rs=[],is=[],Dn=fe,On={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:pt,pgp:!1,env:{},finalize:pt},Ft=On,oa=[],Ms=0,no=[];function Nt(m){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var v=this._PSD=Ft;if(typeof m!="function"){if(m!==sa)throw new TypeError("Not a function");this._state=arguments[1],this._value=arguments[2],this._state===!1&&Vi(this,this._value)}else this._state=null,this._value=null,++v.ref,(function x(E,R){try{R(function(D){if(E._state===null){if(D===E)throw new TypeError("A promise cannot be resolved with itself.");var P=E._lib&&ss();D&&typeof D.then=="function"?x(E,function(B,V){D instanceof Nt?D._then(B,V):D.then(B,V)}):(E._state=!0,E._value=D,ca(E)),P&&Mi()}},Vi.bind(null,E))}catch(D){Vi(E,D)}})(this,m)}var dr={get:function(){var m=Ft,v=da;function x(E,R){var D=this,P=!m.global&&(m!==Ft||v!==da),B=P&&!Yn(),V=new Nt(function(et,K){Ds(D,new la(io(E,m,P,B),io(R,m,P,B),et,K,m))});return this._consoleTask&&(V._consoleTask=this._consoleTask),V}return x.prototype=sa,x},set:function(m){_(this,"then",m&&m.prototype===sa?dr:{get:function(){return m},set:dr.set})}};function la(m,v,x,E,R){this.onFulfilled=typeof m=="function"?m:null,this.onRejected=typeof v=="function"?v:null,this.resolve=x,this.reject=E,this.psd=R}function Vi(m,v){var x,E;is.push(v),m._state===null&&(x=m._lib&&ss(),v=Dn(v),m._state=!1,m._value=v,E=m,Rs.some(function(R){return R._value===E._value})||Rs.push(E),ca(m),x)&&Mi()}function ca(m){var v=m._listeners;m._listeners=[];for(var x=0,E=v.length;x<E;++x)Ds(m,v[x]);var R=m._PSD;--R.ref||R.finalize(),Ms===0&&(++Ms,aa(function(){--Ms==0&&bl()},[]))}function Ds(m,v){if(m._state===null)m._listeners.push(v);else{var x=m._state?v.onFulfilled:v.onRejected;if(x===null)return(m._state?v.resolve:v.reject)(m._value);++v.psd.ref,++Ms,aa(pd,[x,m,v])}}function pd(m,v,x){try{var E,R=v._value;!v._state&&is.length&&(is=[]),E=ni&&v._consoleTask?v._consoleTask.run(function(){return m(R)}):m(R),v._state||is.indexOf(R)!==-1||(D=>{for(var P=Rs.length;P;)if(Rs[--P]._value===D._value)return Rs.splice(P,1)})(v),x.resolve(E)}catch(D){x.reject(D)}finally{--Ms==0&&bl(),--x.psd.ref||x.psd.finalize()}}function Jc(){mi(On,function(){ss()&&Mi()})}function ss(){var m=to;return eo=to=!1,m}function Mi(){var m,v,x;do for(;0<oa.length;)for(m=oa,oa=[],x=m.length,v=0;v<x;++v){var E=m[v];E[0].apply(null,E[1])}while(0<oa.length);eo=to=!0}function bl(){for(var m=Rs,v=(Rs=[],m.forEach(function(E){E._PSD.onunhandled.call(null,E._value,E)}),no.slice(0)),x=v.length;x;)v[--x]()}function ua(m){return new Nt(sa,!1,m)}function Ie(m,v){var x=Ft;return function(){var E=ss(),R=Ft;try{return as(x,!0),m.apply(this,arguments)}catch(D){v&&v(D)}finally{as(R,!1),E&&Mi()}}}w(Nt.prototype,{then:dr,_then:function(m,v){Ds(this,new la(null,null,m,v,Ft))},catch:function(m){var v,x;return arguments.length===1?this.then(null,m):(v=m,x=arguments[1],typeof v=="function"?this.then(null,function(E){return(E instanceof v?x:ua)(E)}):this.then(null,function(E){return(E&&E.name===v?x:ua)(E)}))},finally:function(m){return this.then(function(v){return Nt.resolve(m()).then(function(){return v})},function(v){return Nt.resolve(m()).then(function(){return ua(v)})})},timeout:function(m,v){var x=this;return m<1/0?new Nt(function(E,R){var D=setTimeout(function(){return R(new kt.Timeout(v))},m);x.then(E,R).finally(clearTimeout.bind(null,D))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&_(Nt.prototype,Symbol.toStringTag,"Dexie.Promise"),On.env=wl(),w(Nt,{all:function(){var m=Ct.apply(null,arguments).map(pr);return new Nt(function(v,x){m.length===0&&v([]);var E=m.length;m.forEach(function(R,D){return Nt.resolve(R).then(function(P){m[D]=P,--E||v(m)},x)})})},resolve:function(m){return m instanceof Nt?m:m&&typeof m.then=="function"?new Nt(function(v,x){m.then(v,x)}):new Nt(sa,!0,m)},reject:ua,race:function(){var m=Ct.apply(null,arguments).map(pr);return new Nt(function(v,x){m.map(function(E){return Nt.resolve(E).then(v,x)})})},PSD:{get:function(){return Ft},set:function(m){return Ft=m}},totalEchoes:{get:function(){return da}},newPSD:ze,usePSD:mi,scheduler:{get:function(){return aa},set:function(m){aa=m}},rejectionMapper:{get:function(){return Dn},set:function(m){Dn=m}},follow:function(m,v){return new Nt(function(x,E){return ze(function(R,D){var P=Ft;P.unhandleds=[],P.onunhandled=D,P.finalize=An(function(){var B,V=this;B=function(){V.unhandleds.length===0?R():D(V.unhandleds[0])},no.push(function et(){B(),no.splice(no.indexOf(et),1)}),++Ms,aa(function(){--Ms==0&&bl()},[])},P.finalize),m()},v,x,E)})}}),ns&&(ns.allSettled&&_(Nt,"allSettled",function(){var m=Ct.apply(null,arguments).map(pr);return new Nt(function(v){m.length===0&&v([]);var x=m.length,E=new Array(x);m.forEach(function(R,D){return Nt.resolve(R).then(function(P){return E[D]={status:"fulfilled",value:P}},function(P){return E[D]={status:"rejected",reason:P}}).then(function(){return--x||v(E)})})})}),ns.any&&typeof AggregateError<"u"&&_(Nt,"any",function(){var m=Ct.apply(null,arguments).map(pr);return new Nt(function(v,x){m.length===0&&x(new AggregateError([]));var E=m.length,R=new Array(E);m.forEach(function(D,P){return Nt.resolve(D).then(function(B){return v(B)},function(B){R[P]=B,--E||x(new AggregateError(R))})})})}),ns.withResolvers)&&(Nt.withResolvers=ns.withResolvers);var nn={awaits:0,echoes:0,id:0},vl=0,fr=[],ha=0,da=0,rs=0;function ze(m,P,x,E){var R=Ft,D=Object.create(R),P=(D.parent=R,D.ref=0,D.global=!1,D.id=++rs,On.env,D.env=hr?{Promise:Nt,PromiseProp:{value:Nt,configurable:!0,writable:!0},all:Nt.all,race:Nt.race,allSettled:Nt.allSettled,any:Nt.any,resolve:Nt.resolve,reject:Nt.reject}:{},P&&d(D,P),++R.ref,D.finalize=function(){--this.parent.ref||this.parent.finalize()},mi(D,m,x,E));return D.ref===0&&D.finalize(),P}function sn(){return nn.id||(nn.id=++vl),++nn.awaits,nn.echoes+=zn,nn.id}function Yn(){return!!nn.awaits&&(--nn.awaits==0&&(nn.id=0),nn.echoes=nn.awaits*zn,!0)}function pr(m){return nn.echoes&&m&&m.constructor===ns?(sn(),m.then(function(v){return Yn(),v},function(v){return Yn(),ke(v)})):m}function md(){var m=fr[fr.length-1];fr.pop(),as(m,!1)}function as(m,v){var x,E,R=Ft;(v?!nn.echoes||ha++&&m===Ft:!ha||--ha&&m===Ft)||queueMicrotask(v?(function(D){++da,nn.echoes&&--nn.echoes!=0||(nn.echoes=nn.awaits=nn.id=0),fr.push(Ft),as(D,!0)}).bind(null,m):md),m!==Ft&&(Ft=m,R===On&&(On.env=wl()),hr)&&(x=On.env.Promise,E=m.env,R.global||m.global)&&(Object.defineProperty(l,"Promise",E.PromiseProp),x.all=E.all,x.race=E.race,x.resolve=E.resolve,x.reject=E.reject,E.allSettled&&(x.allSettled=E.allSettled),E.any)&&(x.any=E.any)}function wl(){var m=l.Promise;return hr?{Promise:m,PromiseProp:Object.getOwnPropertyDescriptor(l,"Promise"),all:m.all,race:m.race,allSettled:m.allSettled,any:m.any,resolve:m.resolve,reject:m.reject}:{}}function mi(m,v,x,E,R){var D=Ft;try{return as(m,!0),v(x,E,R)}finally{as(D,!1)}}function io(m,v,x,E){return typeof m!="function"?m:function(){var R=Ft;x&&sn(),as(v,!0);try{return m.apply(this,arguments)}finally{as(R,!1),E&&queueMicrotask(Yn)}}}function os(m){Promise===ns&&nn.echoes===0?ha===0?m():enqueueNativeMicroTask(m):setTimeout(m,0)}(""+zs).indexOf("[native code]")===-1&&(sn=Yn=pt);var ke=Nt.reject,gi="",qn="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",rn="String expected.",Os=[],fa="__dbnames",Ki="readonly",ls="readwrite";function Ns(m,v){return m?v?function(){return m.apply(this,arguments)&&v.apply(this,arguments)}:m:v}var xl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function pa(m){return typeof m!="string"||/\./.test(m)?function(v){return v}:function(v){return v[m]===void 0&&m in v&&delete(v=Lt(v))[m],v}}function tu(){throw kt.Type("Entity instances must never be new:ed. Instances are generated by the framework bypassing the constructor.")}function ce(m,v){try{var x=ma(m),E=ma(v);if(x!==E)return x==="Array"?1:E==="Array"?-1:x==="binary"?1:E==="binary"?-1:x==="string"?1:E==="string"?-1:x==="Date"?1:E!=="Date"?NaN:-1;switch(x){case"number":case"Date":case"string":return v<m?1:m<v?-1:0;case"binary":for(var R=Di(m),D=Di(v),P=R.length,B=D.length,V=P<B?P:B,et=0;et<V;++et)if(R[et]!==D[et])return R[et]<D[et]?-1:1;return P===B?0:P<B?-1:1;case"Array":for(var K=m,$=v,Q=K.length,Z=$.length,X=Q<Z?Q:Z,Y=0;Y<X;++Y){var it=ce(K[Y],$[Y]);if(it!==0)return it}return Q===Z?0:Q<Z?-1:1}}catch{}return NaN}function ma(m){var v=typeof m;return v=="object"&&(ArrayBuffer.isView(m)||(v=Vt(m))==="ArrayBuffer")?"binary":v}function Di(m){return m instanceof Uint8Array?m:ArrayBuffer.isView(m)?new Uint8Array(m.buffer,m.byteOffset,m.byteLength):new Uint8Array(m)}function Nn(m,v,x){var E=m.schema.yProps;return E?(v&&0<x.numFailures&&(v=v.filter(function(R,D){return!x.failures[D]})),Promise.all(E.map(function(R){return R=R.updatesTable,v?m.db.table(R).where("k").anyOf(v).delete():m.db.table(R).clear()})).then(function(){return x})):x}eu.prototype.execute=function(m){var v=this["@@propmod"];if(v.add!==void 0){var x=v.add;if(u(x))return r(r([],u(m)?m:[],!0),x).sort();if(typeof x=="number")return(Number(m)||0)+x;if(typeof x=="bigint")try{return BigInt(m)+x}catch{return BigInt(0)+x}throw new TypeError("Invalid term ".concat(x))}if(v.remove!==void 0){var E=v.remove;if(u(E))return u(m)?m.filter(function(R){return!E.includes(R)}).sort():[];if(typeof E=="number")return Number(m)-E;if(typeof E=="bigint")try{return BigInt(m)-E}catch{return BigInt(0)-E}throw new TypeError("Invalid subtrahend ".concat(E))}return x=(x=v.replacePrefix)==null?void 0:x[0],x&&typeof m=="string"&&m.startsWith(x)?v.replacePrefix[1]+m.substring(x.length):m};var mr=eu;function eu(m){this["@@propmod"]=m}function so(m,v){for(var x=c(v),E=x.length,R=!1,D=0;D<E;++D){var P=x[D],B=v[P],V=z(m,P);B instanceof mr?(H(m,P,B.execute(V)),R=!0):V!==B&&(H(m,P,B),R=!0)}return R}Se.prototype._trans=function(m,v,x){var E=this._tx||Ft.trans,R=this.name,D=ni&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(m==="readonly"?"read":"write"," ").concat(this.name));function P(et,K,$){if($.schema[R])return v($.idbtrans,$);throw new kt.NotFound("Table "+R+" not part of transaction")}var B=ss();try{var V=E&&E.db._novip===this.db._novip?E===Ft.trans?E._promise(m,P,x):ze(function(){return E._promise(m,P,x)},{trans:E,transless:Ft.transless||Ft}):(function et(K,$,Q,Z){if(K.idbdb&&(K._state.openComplete||Ft.letThrough||K._vip)){var X=K._createTransaction($,Q,K._dbSchema);try{X.create(),K._state.PR1398_maxLoop=3}catch(Y){return Y.name===Rt.InvalidState&&K.isOpen()&&0<--K._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),K.close({disableAutoOpen:!1}),K.open().then(function(){return et(K,$,Q,Z)})):ke(Y)}return X._promise($,function(Y,it){return ze(function(){return Ft.trans=X,Z(Y,it,X)})}).then(function(Y){if($==="readwrite")try{X.idbtrans.commit()}catch{}return $==="readonly"?Y:X._completion.then(function(){return Y})})}if(K._state.openComplete)return ke(new kt.DatabaseClosed(K._state.dbOpenError));if(!K._state.isBeingOpened){if(!K._state.autoOpen)return ke(new kt.DatabaseClosed);K.open().catch(pt)}return K._state.dbReadyPromise.then(function(){return et(K,$,Q,Z)})})(this.db,m,[this.name],P);return D&&(V._consoleTask=D,V=V.catch(function(et){return console.trace(et),ke(et)})),V}finally{B&&Mi()}},Se.prototype.get=function(m,v){var x=this;return m&&m.constructor===Object?this.where(m).first(v):m==null?ke(new kt.Type("Invalid argument to Table.get()")):this._trans("readonly",function(E){return x.core.get({trans:E,key:m}).then(function(R){return x.hook.reading.fire(R)})}).then(v)},Se.prototype.where=function(m){if(typeof m=="string")return new this.db.WhereClause(this,m);if(u(m))return new this.db.WhereClause(this,"[".concat(m.join("+"),"]"));var v=c(m);if(v.length===1)return this.where(v[0]).equals(m[v[0]]);var x=this.schema.indexes.concat(this.schema.primKey).filter(function(B){if(B.compound&&v.every(function(et){return 0<=B.keyPath.indexOf(et)})){for(var V=0;V<v.length;++V)if(v.indexOf(B.keyPath[V])===-1)return!1;return!0}return!1}).sort(function(B,V){return B.keyPath.length-V.keyPath.length})[0];if(x&&this.db._maxKey!==gi)return P=x.keyPath.slice(0,v.length),this.where(P).equals(P.map(function(B){return m[B]}));!x&&ni&&console.warn("The query ".concat(JSON.stringify(m)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(v.join("+"),"]"));var E=this.schema.idxByName;function R(B,V){return ce(B,V)===0}var P=v.reduce(function(K,V){var et=K[0],K=K[1],$=E[V],Q=m[V];return[et||$,et||!$?Ns(K,$&&$.multi?function(Z){return Z=z(Z,V),u(Z)&&Z.some(function(X){return R(Q,X)})}:function(Z){return R(Q,z(Z,V))}):K]},[null,null]),D=P[0],P=P[1];return D?this.where(D.name).equals(m[D.keyPath]).filter(P):x?this.filter(P):this.where(v).equals("")},Se.prototype.filter=function(m){return this.toCollection().and(m)},Se.prototype.count=function(m){return this.toCollection().count(m)},Se.prototype.offset=function(m){return this.toCollection().offset(m)},Se.prototype.limit=function(m){return this.toCollection().limit(m)},Se.prototype.each=function(m){return this.toCollection().each(m)},Se.prototype.toArray=function(m){return this.toCollection().toArray(m)},Se.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Se.prototype.orderBy=function(m){return new this.db.Collection(new this.db.WhereClause(this,u(m)?"[".concat(m.join("+"),"]"):m))},Se.prototype.reverse=function(){return this.toCollection().reverse()},Se.prototype.mapToClass=function(m){for(var v=this.db,x=this.name,E=((this.schema.mappedClass=m).prototype instanceof tu&&(m=(P=>{var B=K,V=P;if(typeof V!="function"&&V!==null)throw new TypeError("Class extends value "+String(V)+" is not a constructor or null");function et(){this.constructor=B}function K(){return P!==null&&P.apply(this,arguments)||this}return e(B,V),B.prototype=V===null?Object.create(V):(et.prototype=V.prototype,new et),Object.defineProperty(K.prototype,"db",{get:function(){return v},enumerable:!1,configurable:!0}),K.prototype.table=function(){return x},K})(m)),new Set),R=m.prototype;R;R=f(R))Object.getOwnPropertyNames(R).forEach(function(P){return E.add(P)});function D(P){if(!P)return P;var B,V=Object.create(m.prototype);for(B in P)if(!E.has(B))try{V[B]=P[B]}catch{}return V}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=D,this.hook("reading",D),m},Se.prototype.defineClass=function(){return this.mapToClass(function(m){d(this,m)})},Se.prototype.add=function(m,v){var x=this,E=this.schema.primKey,R=E.auto,D=E.keyPath,P=m;return D&&R&&(P=pa(D)(m)),this._trans("readwrite",function(B){return x.core.mutate({trans:B,type:"add",keys:v!=null?[v]:null,values:[P]})}).then(function(B){return B.numFailures?Nt.reject(B.failures[0]):B.lastResult}).then(function(B){if(D)try{H(m,D,B)}catch{}return B})},Se.prototype.upsert=function(m,v){var x=this,E=this.schema.primKey.keyPath;return this._trans("readwrite",function(R){return x.core.get({trans:R,key:m}).then(function(D){var P=D??{};return so(P,v),E&&H(P,E,m),x.core.mutate({trans:R,type:"put",values:[P],keys:[m],upsert:!0,updates:{keys:[m],changeSpecs:[v]}}).then(function(B){return B.numFailures?Nt.reject(B.failures[0]):!!D})})})},Se.prototype.update=function(m,v){return typeof m!="object"||u(m)?this.where(":id").equals(m).modify(v):(m=z(m,this.schema.primKey.keyPath))===void 0?ke(new kt.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(m).modify(v)},Se.prototype.put=function(m,v){var x=this,E=this.schema.primKey,R=E.auto,D=E.keyPath,P=m;return D&&R&&(P=pa(D)(m)),this._trans("readwrite",function(B){return x.core.mutate({trans:B,type:"put",values:[P],keys:v!=null?[v]:null})}).then(function(B){return B.numFailures?Nt.reject(B.failures[0]):B.lastResult}).then(function(B){if(D)try{H(m,D,B)}catch{}return B})},Se.prototype.delete=function(m){var v=this;return this._trans("readwrite",function(x){return v.core.mutate({trans:x,type:"delete",keys:[m]}).then(function(E){return Nn(v,[m],E)}).then(function(E){return E.numFailures?Nt.reject(E.failures[0]):void 0})})},Se.prototype.clear=function(){var m=this;return this._trans("readwrite",function(v){return m.core.mutate({trans:v,type:"deleteRange",range:xl}).then(function(x){return Nn(m,null,x)})}).then(function(v){return v.numFailures?Nt.reject(v.failures[0]):void 0})},Se.prototype.bulkGet=function(m){var v=this;return this._trans("readonly",function(x){return v.core.getMany({keys:m,trans:x}).then(function(E){return E.map(function(R){return v.hook.reading.fire(R)})})})},Se.prototype.bulkAdd=function(m,v,x){var E=this,R=Array.isArray(v)?v:void 0,D=(x=x||(R?void 0:v))?x.allKeys:void 0;return this._trans("readwrite",function(P){var B=E.schema.primKey,et=B.auto,B=B.keyPath;if(B&&R)throw new kt.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(R&&R.length!==m.length)throw new kt.InvalidArgument("Arguments objects and keys must have the same length");var V=m.length,et=B&&et?m.map(pa(B)):m;return E.core.mutate({trans:P,type:"add",keys:R,values:et,wantResults:D}).then(function(K){var $=K.numFailures,Q=K.failures;if($===0)return D?K.results:K.lastResult;throw new Ot("".concat(E.name,".bulkAdd(): ").concat($," of ").concat(V," operations failed"),Q)})})},Se.prototype.bulkPut=function(m,v,x){var E=this,R=Array.isArray(v)?v:void 0,D=(x=x||(R?void 0:v))?x.allKeys:void 0;return this._trans("readwrite",function(P){var B=E.schema.primKey,et=B.auto,B=B.keyPath;if(B&&R)throw new kt.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(R&&R.length!==m.length)throw new kt.InvalidArgument("Arguments objects and keys must have the same length");var V=m.length,et=B&&et?m.map(pa(B)):m;return E.core.mutate({trans:P,type:"put",keys:R,values:et,wantResults:D}).then(function(K){var $=K.numFailures,Q=K.failures;if($===0)return D?K.results:K.lastResult;throw new Ot("".concat(E.name,".bulkPut(): ").concat($," of ").concat(V," operations failed"),Q)})})},Se.prototype.bulkUpdate=function(m){var v=this,x=this.core,E=m.map(function(P){return P.key}),R=m.map(function(P){return P.changes}),D=[];return this._trans("readwrite",function(P){return x.getMany({trans:P,keys:E,cache:"clone"}).then(function(B){var V=[],et=[],K=(m.forEach(function($,Q){var Z=$.key,X=$.changes,Y=B[Q];if(Y){for(var it=0,ot=Object.keys(X);it<ot.length;it++){var nt=ot[it],gt=X[nt];if(nt===v.schema.primKey.keyPath){if(ce(gt,Z)!==0)throw new kt.Constraint("Cannot update primary key in bulkUpdate()")}else H(Y,nt,gt)}D.push(Q),V.push(Z),et.push(Y)}}),V.length);return x.mutate({trans:P,type:"put",keys:V,values:et,updates:{keys:E,changeSpecs:R}}).then(function($){var Q=$.numFailures,Z=$.failures;if(Q===0)return K;for(var X=0,Y=Object.keys(Z);X<Y.length;X++){var it,ot=Y[X],nt=D[Number(ot)];nt!=null&&(it=Z[ot],delete Z[ot],Z[nt]=it)}throw new Ot("".concat(v.name,".bulkUpdate(): ").concat(Q," of ").concat(K," operations failed"),Z)})})})},Se.prototype.bulkDelete=function(m){var v=this,x=m.length;return this._trans("readwrite",function(E){return v.core.mutate({trans:E,type:"delete",keys:m}).then(function(R){return Nn(v,m,R)})}).then(function(E){var R=E.numFailures,D=E.failures;if(R===0)return E.lastResult;throw new Ot("".concat(v.name,".bulkDelete(): ").concat(R," of ").concat(x," operations failed"),D)})};var Al=Se;function Se(){}function ga(m){function v(P,B){if(B){for(var V=arguments.length,et=new Array(V-1);--V;)et[V-1]=arguments[V];return x[P].subscribe.apply(null,et),m}if(typeof P=="string")return x[P]}var x={};v.addEventType=D;for(var E=1,R=arguments.length;E<R;++E)D(arguments[E]);return v;function D(P,B,V){var et,K;if(typeof P!="object")return B=B||yl,K={subscribers:[],fire:V=V||pt,subscribe:function($){K.subscribers.indexOf($)===-1&&(K.subscribers.push($),K.fire=B(K.fire,$))},unsubscribe:function($){K.subscribers=K.subscribers.filter(function(Q){return Q!==$}),K.fire=K.subscribers.reduce(B,V)}},x[P]=v[P]=K;c(et=P).forEach(function($){var Q=et[$];if(u(Q))D($,et[$][0],et[$][1]);else{if(Q!=="asap")throw new kt.InvalidArgument("Invalid event config");var Z=D($,fe,function(){for(var X=arguments.length,Y=new Array(X);X--;)Y[X]=arguments[X];Z.subscribers.forEach(function(it){F(function(){it.apply(null,Y)})})})}})}}function Sn(m,v){return S(v).from({prototype:m}),v}function cs(m,v){return!(m.filter||m.algorithm||m.or)&&(v?m.justLimit:!m.replayFilter)}function ro(m,v){m.filter=Ns(m.filter,v)}function ya(m,v,x){var E=m.replayFilter;m.replayFilter=E?function(){return Ns(E(),v())}:v,m.justLimit=x&&!E}function Xi(m,v){if(m.isPrimKey)return v.primaryKey;var x=v.getIndexByKeyPath(m.index);if(x)return x;throw new kt.Schema("KeyPath "+m.index+" on object store "+v.name+" is not indexed")}function Sl(m,v,x){var E=Xi(m,v.schema);return v.openCursor({trans:x,values:!m.keysOnly,reverse:m.dir==="prev",unique:!!m.unique,query:{index:E,range:m.range}})}function ba(m,v,x,E){var R,D,P=m.replayFilter?Ns(m.filter,m.replayFilter()):m.filter;return m.or?(R={},D=function(B,V,et){var K,$;P&&!P(V,et,function(Q){return V.stop(Q)},function(Q){return V.fail(Q)})||(($=""+(K=V.primaryKey))=="[object ArrayBuffer]"&&($=""+new Uint8Array(K)),y(R,$))||(R[$]=!0,v(B,V,et))},Promise.all([m.or._iterate(D,x),ks(Sl(m,E,x),m.algorithm,D,!m.keysOnly&&m.valueMapper)])):ks(Sl(m,E,x),Ns(m.algorithm,P),v,!m.keysOnly&&m.valueMapper)}function ks(m,v,x,E){var R=Ie(E?function(D,P,B){return x(E(D),P,B)}:x);return m.then(function(D){if(D)return D.start(function(){var P=function(){return D.continue()};v&&!v(D,function(B){return P=B},function(B){D.stop(B),P=pt},function(B){D.fail(B),P=pt})||R(D.value,D,function(B){return P=B}),P()})})}ge.prototype._read=function(m,v){var x=this._ctx;return x.error?x.table._trans(null,ke.bind(null,x.error)):x.table._trans("readonly",m).then(v)},ge.prototype._write=function(m){var v=this._ctx;return v.error?v.table._trans(null,ke.bind(null,v.error)):v.table._trans("readwrite",m,"locked")},ge.prototype._addAlgorithm=function(m){var v=this._ctx;v.algorithm=Ns(v.algorithm,m)},ge.prototype._iterate=function(m,v){return ba(this._ctx,m,v,this._ctx.table.core)},ge.prototype.clone=function(m){var v=Object.create(this.constructor.prototype),x=Object.create(this._ctx);return m&&d(x,m),v._ctx=x,v},ge.prototype.raw=function(){return this._ctx.valueMapper=null,this},ge.prototype.each=function(m){var v=this._ctx;return this._read(function(x){return ba(v,m,x,v.table.core)})},ge.prototype.count=function(m){var v=this;return this._read(function(x){var E,R=v._ctx,D=R.table.core;return cs(R,!0)?D.count({trans:x,query:{index:Xi(R,D.schema),range:R.range}}).then(function(P){return Math.min(P,R.limit)}):(E=0,ba(R,function(){return++E,!1},x,D).then(function(){return E}))}).then(m)},ge.prototype.sortBy=function(m,v){var x=m.split(".").reverse(),E=x[0],R=x.length-1;function D(V,et){return et?D(V[x[et]],et-1):V[E]}var P=this._ctx.dir==="next"?1:-1;function B(V,et){return ce(D(V,R),D(et,R))*P}return this.toArray(function(V){return V.sort(B)}).then(v)},ge.prototype.toArray=function(m){var v=this;return this._read(function(x){var E,R,D,P=v._ctx;return P.dir==="next"&&cs(P,!0)&&0<P.limit?(E=P.valueMapper,R=Xi(P,P.table.core.schema),P.table.core.query({trans:x,limit:P.limit,values:!0,query:{index:R,range:P.range}}).then(function(B){return B=B.result,E?B.map(E):B})):(D=[],ba(P,function(B){return D.push(B)},x,P.table.core).then(function(){return D}))},m)},ge.prototype.offset=function(m){var v=this._ctx;return m<=0||(v.offset+=m,cs(v)?ya(v,function(){var x=m;return function(E,R){return x===0||(x===1?--x:R(function(){E.advance(x),x=0}),!1)}}):ya(v,function(){var x=m;return function(){return--x<0}})),this},ge.prototype.limit=function(m){return this._ctx.limit=Math.min(this._ctx.limit,m),ya(this._ctx,function(){var v=m;return function(x,E,R){return--v<=0&&E(R),0<=v}},!0),this},ge.prototype.until=function(m,v){return ro(this._ctx,function(x,E,R){return!m(x.value)||(E(R),v)}),this},ge.prototype.first=function(m){return this.limit(1).toArray(function(v){return v[0]}).then(m)},ge.prototype.last=function(m){return this.reverse().first(m)},ge.prototype.filter=function(m){var v;return ro(this._ctx,function(x){return m(x.value)}),(v=this._ctx).isMatch=Ns(v.isMatch,m),this},ge.prototype.and=function(m){return this.filter(m)},ge.prototype.or=function(m){return new this.db.WhereClause(this._ctx.table,m,this)},ge.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},ge.prototype.desc=function(){return this.reverse()},ge.prototype.eachKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(x,E){m(E.key,E)})},ge.prototype.eachUniqueKey=function(m){return this._ctx.unique="unique",this.eachKey(m)},ge.prototype.eachPrimaryKey=function(m){var v=this._ctx;return v.keysOnly=!v.isMatch,this.each(function(x,E){m(E.primaryKey,E)})},ge.prototype.keys=function(m){var v=this._ctx,x=(v.keysOnly=!v.isMatch,[]);return this.each(function(E,R){x.push(R.key)}).then(function(){return x}).then(m)},ge.prototype.primaryKeys=function(m){var v=this._ctx;if(v.dir==="next"&&cs(v,!0)&&0<v.limit)return this._read(function(E){var R=Xi(v,v.table.core.schema);return v.table.core.query({trans:E,values:!1,limit:v.limit,query:{index:R,range:v.range}})}).then(function(E){return E.result}).then(m);v.keysOnly=!v.isMatch;var x=[];return this.each(function(E,R){x.push(R.primaryKey)}).then(function(){return x}).then(m)},ge.prototype.uniqueKeys=function(m){return this._ctx.unique="unique",this.keys(m)},ge.prototype.firstKey=function(m){return this.limit(1).keys(function(v){return v[0]}).then(m)},ge.prototype.lastKey=function(m){return this.reverse().firstKey(m)},ge.prototype.distinct=function(){var m,v=this._ctx,v=v.index&&v.table.schema.idxByName[v.index];return v&&v.multi&&(m={},ro(this._ctx,function(E){var E=E.primaryKey.toString(),R=y(m,E);return m[E]=!0,!R})),this},ge.prototype.modify=function(m){var v=this,x=this._ctx;return this._write(function(E){function R(Y,it){var ot=it.failures;Q+=Y-it.numFailures;for(var nt=0,gt=c(ot);nt<gt.length;nt++){var At=gt[nt];$.push(ot[At])}}var D=typeof m=="function"?m:function(Y){return so(Y,m)},P=x.table.core,K=P.schema.primaryKey,B=K.outbound,V=K.extractKey,et=200,K=v.db._options.modifyChunkSize,$=(K&&(et=typeof K=="object"?K[P.name]||K["*"]||200:K),[]),Q=0,Z=[],X=m===El;return v.clone().primaryKeys().then(function(Y){function it(nt){var gt=Math.min(et,Y.length-nt),At=Y.slice(nt,nt+gt);return(X?Promise.resolve([]):P.getMany({trans:E,keys:At,cache:"immutable"})).then(function(Mt){var Dt=[],St=[],zt=B?[]:null,Pt=X?At:[];if(!X)for(var Et=0;Et<gt;++Et){var Ht=Mt[Et],ee={value:Lt(Ht),primKey:Y[nt+Et]};D.call(ee,ee.value,ee)!==!1&&(ee.value==null?Pt.push(Y[nt+Et]):B||ce(V(Ht),V(ee.value))===0?(St.push(ee.value),B&&zt.push(Y[nt+Et])):(Pt.push(Y[nt+Et]),Dt.push(ee.value)))}return Promise.resolve(0<Dt.length&&P.mutate({trans:E,type:"add",values:Dt}).then(function(ue){for(var Qt in ue.failures)Pt.splice(parseInt(Qt),1);R(Dt.length,ue)})).then(function(){return(0<St.length||ot&&typeof m=="object")&&P.mutate({trans:E,type:"put",keys:zt,values:St,criteria:ot,changeSpec:typeof m!="function"&&m,isAdditionalChunk:0<nt}).then(function(ue){return R(St.length,ue)})}).then(function(){return(0<Pt.length||ot&&X)&&P.mutate({trans:E,type:"delete",keys:Pt,criteria:ot,isAdditionalChunk:0<nt}).then(function(ue){return Nn(x.table,Pt,ue)}).then(function(ue){return R(Pt.length,ue)})}).then(function(){return Y.length>nt+gt&&it(nt+et)})})}var ot=cs(x)&&x.limit===1/0&&(typeof m!="function"||X)&&{index:x.index,range:x.range};return it(0).then(function(){if(0<$.length)throw new Ut("Error modifying one or more objects",$,Q,Z);return Y.length})})})},ge.prototype.delete=function(){var m=this._ctx,v=m.range;return!cs(m)||m.table.schema.yProps||!m.isPrimKey&&v.type!==3?this.modify(El):this._write(function(x){var E=m.table.core.schema.primaryKey,R=v;return m.table.core.count({trans:x,query:{index:E,range:R}}).then(function(D){return m.table.core.mutate({trans:x,type:"deleteRange",range:R}).then(function(V){var B=V.failures,V=V.numFailures;if(V)throw new Ut("Could not delete some values",Object.keys(B).map(function(et){return B[et]}),D-V);return D-V})})})};var gd=ge;function ge(){}var El=function(m,v){return v.value=null};function _l(m,v){return m<v?-1:m===v?0:1}function yd(m,v){return v<m?-1:m===v?0:1}function Qn(m,v,x){return m=m instanceof Ls?new m.Collection(m):m,m._ctx.error=new(x||TypeError)(v),m}function Yi(m){return new m.Collection(m,function(){return ao("")}).limit(0)}function ii(Z,v,x,E){var R,D,P,B,V,et,K,$=x.length;if(!x.every(function(Y){return typeof Y=="string"}))return Qn(Z,rn);function Q(Y){R=Y==="next"?function(ot){return ot.toUpperCase()}:function(ot){return ot.toLowerCase()},D=Y==="next"?function(ot){return ot.toLowerCase()}:function(ot){return ot.toUpperCase()},P=Y==="next"?_l:yd;var it=x.map(function(ot){return{lower:D(ot),upper:R(ot)}}).sort(function(ot,nt){return P(ot.lower,nt.lower)});B=it.map(function(ot){return ot.upper}),V=it.map(function(ot){return ot.lower}),K=(et=Y)==="next"?"":E}Q("next");var Z=new Z.Collection(Z,function(){return Oi(B[0],V[$-1]+E)}),X=(Z._ondirectionchange=function(Y){Q(Y)},0);return Z._addAlgorithm(function(Y,it,ot){var nt=Y.key;if(typeof nt=="string"){var gt=D(nt);if(v(gt,V,X))return!0;for(var At=null,Mt=X;Mt<$;++Mt){var Dt=((St,zt,Pt,Et,Ht,ee)=>{for(var ue=Math.min(St.length,Et.length),Qt=-1,se=0;se<ue;++se){var Le=zt[se];if(Le!==Et[se])return Ht(St[se],Pt[se])<0?St.substr(0,se)+Pt[se]+Pt.substr(se+1):Ht(St[se],Et[se])<0?St.substr(0,se)+Et[se]+Pt.substr(se+1):0<=Qt?St.substr(0,Qt)+zt[Qt]+Pt.substr(Qt+1):null;Ht(St[se],Le)<0&&(Qt=se)}return ue<Et.length&&ee==="next"?St+Pt.substr(St.length):ue<St.length&&ee==="prev"?St.substr(0,Pt.length):Qt<0?null:St.substr(0,Qt)+Et[Qt]+Pt.substr(Qt+1)})(nt,gt,B[Mt],V[Mt],P,et);Dt===null&&At===null?X=Mt+1:(At===null||0<P(At,Dt))&&(At=Dt)}it(At!==null?function(){Y.continue(At+K)}:ot)}return!1}),Z}function Oi(m,v,x,E){return{type:2,lower:m,upper:v,lowerOpen:x,upperOpen:E}}function ao(m){return{type:1,lower:m,upper:m}}Object.defineProperty(He.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),He.prototype.between=function(m,v,x,E){x=x!==!1,E=E===!0;try{return 0<this._cmp(m,v)||this._cmp(m,v)===0&&(x||E)&&(!x||!E)?Yi(this):new this.Collection(this,function(){return Oi(m,v,!x,!E)})}catch{return Qn(this,qn)}},He.prototype.equals=function(m){return m==null?Qn(this,qn):new this.Collection(this,function(){return ao(m)})},He.prototype.above=function(m){return m==null?Qn(this,qn):new this.Collection(this,function(){return Oi(m,void 0,!0)})},He.prototype.aboveOrEqual=function(m){return m==null?Qn(this,qn):new this.Collection(this,function(){return Oi(m,void 0,!1)})},He.prototype.below=function(m){return m==null?Qn(this,qn):new this.Collection(this,function(){return Oi(void 0,m,!1,!0)})},He.prototype.belowOrEqual=function(m){return m==null?Qn(this,qn):new this.Collection(this,function(){return Oi(void 0,m)})},He.prototype.startsWith=function(m){return typeof m!="string"?Qn(this,rn):this.between(m,m+gi,!0,!0)},He.prototype.startsWithIgnoreCase=function(m){return m===""?this.startsWith(m):ii(this,function(v,x){return v.indexOf(x[0])===0},[m],gi)},He.prototype.equalsIgnoreCase=function(m){return ii(this,function(v,x){return v===x[0]},[m],"")},He.prototype.anyOfIgnoreCase=function(){var m=Ct.apply(Yt,arguments);return m.length===0?Yi(this):ii(this,function(v,x){return x.indexOf(v)!==-1},m,"")},He.prototype.startsWithAnyOfIgnoreCase=function(){var m=Ct.apply(Yt,arguments);return m.length===0?Yi(this):ii(this,function(v,x){return x.some(function(E){return v.indexOf(E)===0})},m,gi)},He.prototype.anyOf=function(){var m,v,x=this,E=Ct.apply(Yt,arguments),R=this._cmp;try{E.sort(R)}catch{return Qn(this,qn)}return E.length===0?Yi(this):((m=new this.Collection(this,function(){return Oi(E[0],E[E.length-1])}))._ondirectionchange=function(D){R=D==="next"?x._ascending:x._descending,E.sort(R)},v=0,m._addAlgorithm(function(D,P,B){for(var V=D.key;0<R(V,E[v]);)if(++v===E.length)return P(B),!1;return R(V,E[v])===0||(P(function(){D.continue(E[v])}),!1)}),m)},He.prototype.notEqual=function(m){return this.inAnyRange([[-1/0,m],[m,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},He.prototype.noneOf=function(){var m=Ct.apply(Yt,arguments);if(m.length===0)return new this.Collection(this);try{m.sort(this._ascending)}catch{return Qn(this,qn)}var v=m.reduce(function(x,E){return x?x.concat([[x[x.length-1][1],E]]):[[-1/0,E]]},null);return v.push([m[m.length-1],this.db._maxKey]),this.inAnyRange(v,{includeLowers:!1,includeUppers:!1})},He.prototype.inAnyRange=function(m,ot){var x=this,E=this._cmp,R=this._ascending,D=this._descending,P=this._min,B=this._max;if(m.length===0)return Yi(this);if(!m.every(function(nt){return nt[0]!==void 0&&nt[1]!==void 0&&R(nt[0],nt[1])<=0}))return Qn(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",kt.InvalidArgument);var V=!ot||ot.includeLowers!==!1,et=ot&&ot.includeUppers===!0,K,$=R;function Q(nt,gt){return $(nt[0],gt[0])}try{(K=m.reduce(function(nt,gt){for(var At=0,Mt=nt.length;At<Mt;++At){var Dt=nt[At];if(E(gt[0],Dt[1])<0&&0<E(gt[1],Dt[0])){Dt[0]=P(Dt[0],gt[0]),Dt[1]=B(Dt[1],gt[1]);break}}return At===Mt&&nt.push(gt),nt},[])).sort(Q)}catch{return Qn(this,qn)}var Z=0,X=et?function(nt){return 0<R(nt,K[Z][1])}:function(nt){return 0<=R(nt,K[Z][1])},Y=V?function(nt){return 0<D(nt,K[Z][0])}:function(nt){return 0<=D(nt,K[Z][0])},it=X,ot=new this.Collection(this,function(){return Oi(K[0][0],K[K.length-1][1],!V,!et)});return ot._ondirectionchange=function(nt){$=nt==="next"?(it=X,R):(it=Y,D),K.sort(Q)},ot._addAlgorithm(function(nt,gt,At){for(var Mt,Dt=nt.key;it(Dt);)if(++Z===K.length)return gt(At),!1;return!X(Mt=Dt)&&!Y(Mt)||(x._cmp(Dt,K[Z][1])===0||x._cmp(Dt,K[Z][0])===0||gt(function(){$===R?nt.continue(K[Z][0]):nt.continue(K[Z][1])}),!1)}),ot},He.prototype.startsWithAnyOf=function(){var m=Ct.apply(Yt,arguments);return m.every(function(v){return typeof v=="string"})?m.length===0?Yi(this):this.inAnyRange(m.map(function(v){return[v,v+gi]})):Qn(this,"startsWithAnyOf() only works with strings")};var Ls=He;function He(){}function yi(m){return Ie(function(v){return Ps(v),m(v.target.error),!1})}function Ps(m){m.stopPropagation&&m.stopPropagation(),m.preventDefault&&m.preventDefault()}var gr="storagemutated",Bs="x-storagemutated-1",En=ga(null,gr),Cl=(Gn.prototype._lock=function(){return j(!Ft.global),++this._reculock,this._reculock!==1||Ft.global||(Ft.lockOwnerFor=this),this},Gn.prototype._unlock=function(){if(j(!Ft.global),--this._reculock==0)for(Ft.global||(Ft.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var m=this._blockedFuncs.shift();try{mi(m[1],m[0])}catch{}}return this},Gn.prototype._locked=function(){return this._reculock&&Ft.lockOwnerFor!==this},Gn.prototype.create=function(m){var v=this;if(this.mode){var x=this.db.idbdb,E=this.db._state.dbOpenError;if(j(!this.idbtrans),!m&&!x)switch(E&&E.name){case"DatabaseClosedError":throw new kt.DatabaseClosed(E);case"MissingAPIError":throw new kt.MissingAPI(E.message,E);default:throw new kt.OpenFailed(E)}if(!this.active)throw new kt.TransactionInactive;j(this._completion._state===null),(m=this.idbtrans=m||(this.db.core||x).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=Ie(function(R){Ps(R),v._reject(m.error)}),m.onabort=Ie(function(R){Ps(R),v.active&&v._reject(new kt.Abort(m.error)),v.active=!1,v.on("abort").fire(R)}),m.oncomplete=Ie(function(){v.active=!1,v._resolve(),"mutatedParts"in m&&En.storagemutated.fire(m.mutatedParts)})}return this},Gn.prototype._promise=function(m,v,x){var E,R=this;return m==="readwrite"&&this.mode!=="readwrite"?ke(new kt.ReadOnly("Transaction is readonly")):this.active?this._locked()?new Nt(function(D,P){R._blockedFuncs.push([function(){R._promise(m,v,x).then(D,P)},Ft])}):x?ze(function(){var D=new Nt(function(P,B){R._lock();var V=v(P,B,R);V&&V.then&&V.then(P,B)});return D.finally(function(){return R._unlock()}),D._lib=!0,D}):((E=new Nt(function(D,P){var B=v(D,P,R);B&&B.then&&B.then(D,P)}))._lib=!0,E):ke(new kt.TransactionInactive)},Gn.prototype._root=function(){return this.parent?this.parent._root():this},Gn.prototype.waitFor=function(m){var v,x=this._root(),E=Nt.resolve(m),R=(x._waitingFor?x._waitingFor=x._waitingFor.then(function(){return E}):(x._waitingFor=E,x._waitingQueue=[],v=x.idbtrans.objectStore(x.storeNames[0]),(function D(){for(++x._spinCount;x._waitingQueue.length;)x._waitingQueue.shift()();x._waitingFor&&(v.get(-1/0).onsuccess=D)})()),x._waitingFor);return new Nt(function(D,P){E.then(function(B){return x._waitingQueue.push(Ie(D.bind(null,B)))},function(B){return x._waitingQueue.push(Ie(P.bind(null,B)))}).finally(function(){x._waitingFor===R&&(x._waitingFor=null)})})},Gn.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new kt.Abort))},Gn.prototype.table=function(m){var v=this._memoizedTables||(this._memoizedTables={});if(y(v,m))return v[m];var x=this.schema[m];if(x)return(x=new this.db.Table(m,x,this)).core=this.db.core.table(m),v[m]=x;throw new kt.NotFound("Table "+m+" not part of transaction")},Gn);function Gn(){}function Ni(m,v,x,E,R,D,P,B){return{name:m,keyPath:v,unique:x,multi:E,auto:R,compound:D,src:(x&&!P?"&":"")+(E?"*":"")+(R?"++":"")+oo(v),type:B}}function oo(m){return typeof m=="string"?m:m?"["+[].join.call(m,"+")+"]":""}function yr(m,v,x){return{name:m,primKey:v,indexes:x,mappedClass:null,idxByName:(E=function(R){return[R.name,R]},x.reduce(function(R,D,P){return D=E(D,P),D&&(R[D[0]]=D[1]),R},{}))};var E}var br=function(m){try{return m.only([[]]),br=function(){return[[]]},[[]]}catch{return br=function(){return gi},gi}};function vr(m){return m==null?function(){}:typeof m=="string"?(v=m).split(".").length===1?function(x){return x[v]}:function(x){return z(x,v)}:function(x){return z(x,m)};var v}function va(m){return[].slice.call(m)}var nu=0;function hn(m){return m==null?":id":typeof m=="string"?m:"[".concat(m.join("+"),"]")}function js(m,v,V){function E(X){if(X.type===3)return null;if(X.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var $=X.lower,Q=X.upper,Z=X.lowerOpen,X=X.upperOpen;return $===void 0?Q===void 0?null:v.upperBound(Q,!!X):Q===void 0?v.lowerBound($,!!Z):v.bound($,Q,!!Z,!!X)}function R(K){var $,Q=K.name;return{name:Q,schema:K,mutate:function(Z){var X=Z.trans,Y=Z.type,it=Z.keys,ot=Z.values,nt=Z.range;return new Promise(function(gt,At){gt=Ie(gt);var Mt=X.objectStore(Q),Dt=Mt.keyPath==null,St=Y==="put"||Y==="add";if(!St&&Y!=="delete"&&Y!=="deleteRange")throw new Error("Invalid operation type: "+Y);var zt,Pt=(it||ot||{length:1}).length;if(it&&ot&&it.length!==ot.length)throw new Error("Given keys array must have same length as given values array.");if(Pt===0)return gt({numFailures:0,failures:{},results:[],lastResult:void 0});function Et(De){++ue,Ps(De)}var Ht=[],ee=[],ue=0;if(Y==="deleteRange"){if(nt.type===4)return gt({numFailures:ue,failures:ee,results:[],lastResult:void 0});nt.type===3?Ht.push(zt=Mt.clear()):Ht.push(zt=Mt.delete(E(nt)))}else{var Dt=St?Dt?[ot,it]:[ot,null]:[it,null],Qt=Dt[0],se=Dt[1];if(St)for(var Le=0;Le<Pt;++Le)Ht.push(zt=se&&se[Le]!==void 0?Mt[Y](Qt[Le],se[Le]):Mt[Y](Qt[Le])),zt.onerror=Et;else for(Le=0;Le<Pt;++Le)Ht.push(zt=Mt[Y](Qt[Le])),zt.onerror=Et}function Vn(De){De=De.target.result,Ht.forEach(function(fs,_r){return fs.error!=null&&(ee[_r]=fs.error)}),gt({numFailures:ue,failures:ee,results:Y==="delete"?it:Ht.map(function(fs){return fs.result}),lastResult:De})}zt.onerror=function(De){Et(De),Vn(De)},zt.onsuccess=Vn})},getMany:function(Z){var X=Z.trans,Y=Z.keys;return new Promise(function(it,ot){it=Ie(it);for(var nt,gt=X.objectStore(Q),At=Y.length,Mt=new Array(At),Dt=0,St=0,zt=function(Ht){Ht=Ht.target,Mt[Ht._pos]=Ht.result,++St===Dt&&it(Mt)},Pt=yi(ot),Et=0;Et<At;++Et)Y[Et]!=null&&((nt=gt.get(Y[Et]))._pos=Et,nt.onsuccess=zt,nt.onerror=Pt,++Dt);Dt===0&&it(Mt)})},get:function(Z){var X=Z.trans,Y=Z.key;return new Promise(function(it,ot){it=Ie(it);var nt=X.objectStore(Q).get(Y);nt.onsuccess=function(gt){return it(gt.target.result)},nt.onerror=yi(ot)})},query:($=B,function(Z){return new Promise(function(X,Y){X=Ie(X);var it,ot,nt,St=Z.trans,gt=Z.values,At=Z.limit,Dt=Z.query,Mt=At===1/0?void 0:At,zt=Dt.index,Dt=Dt.range,St=St.objectStore(Q),St=zt.isPrimaryKey?St:St.index(zt.name),zt=E(Dt);if(At===0)return X({result:[]});$?((Dt=gt?St.getAll(zt,Mt):St.getAllKeys(zt,Mt)).onsuccess=function(Pt){return X({result:Pt.target.result})},Dt.onerror=yi(Y)):(it=0,ot=!gt&&"openKeyCursor"in St?St.openKeyCursor(zt):St.openCursor(zt),nt=[],ot.onsuccess=function(Pt){var Et=ot.result;return!Et||(nt.push(gt?Et.value:Et.primaryKey),++it===At)?X({result:nt}):void Et.continue()},ot.onerror=yi(Y))})}),openCursor:function(Z){var X=Z.trans,Y=Z.values,it=Z.query,ot=Z.reverse,nt=Z.unique;return new Promise(function(gt,At){gt=Ie(gt);var St=it.index,Mt=it.range,Dt=X.objectStore(Q),Dt=St.isPrimaryKey?Dt:Dt.index(St.name),St=ot?nt?"prevunique":"prev":nt?"nextunique":"next",zt=!Y&&"openKeyCursor"in Dt?Dt.openKeyCursor(E(Mt),St):Dt.openCursor(E(Mt),St);zt.onerror=yi(At),zt.onsuccess=Ie(function(Pt){var Et,Ht,ee,ue,Qt=zt.result;Qt?(Qt.___id=++nu,Qt.done=!1,Et=Qt.continue.bind(Qt),Ht=(Ht=Qt.continuePrimaryKey)&&Ht.bind(Qt),ee=Qt.advance.bind(Qt),ue=function(){throw new Error("Cursor not stopped")},Qt.trans=X,Qt.stop=Qt.continue=Qt.continuePrimaryKey=Qt.advance=function(){throw new Error("Cursor not started")},Qt.fail=Ie(At),Qt.next=function(){var se=this,Le=1;return this.start(function(){return Le--?se.continue():se.stop()}).then(function(){return se})},Qt.start=function(se){function Le(){if(zt.result)try{se()}catch(De){Qt.fail(De)}else Qt.done=!0,Qt.start=function(){throw new Error("Cursor behind last entry")},Qt.stop()}var Vn=new Promise(function(De,fs){De=Ie(De),zt.onerror=yi(fs),Qt.fail=fs,Qt.stop=function(_r){Qt.stop=Qt.continue=Qt.continuePrimaryKey=Qt.advance=ue,De(_r)}});return zt.onsuccess=Ie(function(De){zt.onsuccess=Le,Le()}),Qt.continue=Et,Qt.continuePrimaryKey=Ht,Qt.advance=ee,Le(),Vn},gt(Qt)):gt(null)},At)})},count:function(Z){var X=Z.query,Y=Z.trans,it=X.index,ot=X.range;return new Promise(function(nt,gt){var At=Y.objectStore(Q),At=it.isPrimaryKey?At:At.index(it.name),Mt=E(ot),Mt=Mt?At.count(Mt):At.count();Mt.onsuccess=Ie(function(Dt){return nt(Dt.target.result)}),Mt.onerror=yi(gt)})}}}D=V,P=va((V=m).objectStoreNames);var D,V={schema:{name:V.name,tables:P.map(function(K){return D.objectStore(K)}).map(function(K){var $=K.keyPath,Q=K.autoIncrement,X=u($),Z={},X={name:K.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:$==null,compound:X,keyPath:$,autoIncrement:Q,unique:!0,extractKey:vr($)},indexes:va(K.indexNames).map(function(Y){return K.index(Y)}).map(function(nt){var gt=nt.name,it=nt.unique,ot=nt.multiEntry,nt=nt.keyPath,gt={name:gt,compound:u(nt),keyPath:nt,unique:it,multiEntry:ot,extractKey:vr(nt)};return Z[hn(nt)]=gt}),getIndexByKeyPath:function(Y){return Z[hn(Y)]}};return Z[":id"]=X.primaryKey,$!=null&&(Z[hn($)]=X.primaryKey),X})},hasGetAll:0<P.length&&"getAll"in D.objectStore(P[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)},P=V.schema,B=V.hasGetAll,V=P.tables.map(R),et={};return V.forEach(function(K){return et[K.name]=K}),{stack:"dbcore",transaction:m.transaction.bind(m),table:function(K){if(et[K])return et[K];throw new Error("Table '".concat(K,"' not found"))},MIN_KEY:-1/0,MAX_KEY:br(v),schema:P}}function lo(m,v,x,E){return x=x.IDBKeyRange,v=js(v,x,E),{dbcore:m.dbcore.reduce(function(R,D){return D=D.create,i(i({},R),D(R))},v)}}function us(m,v){var x=v.db,x=lo(m._middlewares,x,m._deps,v);m.core=x.dbcore,m.tables.forEach(function(E){var R=E.name;m.core.schema.tables.some(function(D){return D.name===R})&&(E.core=m.core.table(R),m[R]instanceof m.Table)&&(m[R].core=E.core)})}function co(m,v,x,E){x.forEach(function(R){var D=E[R];v.forEach(function(P){var B=(function V(et,K){return C(et,K)||(et=f(et))&&V(et,K)})(P,R);(!B||"value"in B&&B.value===void 0)&&(P===m.Transaction.prototype||P instanceof m.Transaction?_(P,R,{get:function(){return this.table(R)},set:function(V){A(this,R,{value:V,writable:!0,configurable:!0,enumerable:!0})}}):P[R]=new m.Table(R,D))})})}function wa(m,v){v.forEach(function(x){for(var E in x)x[E]instanceof m.Table&&delete x[E]})}function Tl(m,v){return m._cfg.version-v._cfg.version}function xa(m,v,x,E){var R=m._dbSchema,D=(x.objectStoreNames.contains("$meta")&&!R.$meta&&(R.$meta=yr("$meta",su("")[0],[]),m._storeNames.push("$meta")),m._createTransaction("readwrite",m._storeNames,R)),P=(D.create(x),D._completion.catch(E),D._reject.bind(D)),B=Ft.transless||Ft;ze(function(){if(Ft.trans=D,Ft.transless=B,v!==0)return us(m,x),et=v,((V=D).storeNames.includes("$meta")?V.table("$meta").get("version").then(function(K){return K??et}):Nt.resolve(et)).then(function(it){var $=m,Q=it,Z=D,X=x,Y=[],it=$._versions,ot=$._dbSchema=wr(0,$.idbdb,X);return(it=it.filter(function(nt){return nt._cfg.version>=Q})).length===0?Nt.resolve():(it.forEach(function(nt){Y.push(function(){var gt,At,Mt,Dt=ot,St=nt._cfg.dbschema,zt=(po($,Dt,X),po($,St,X),ot=$._dbSchema=St,ho(Dt,St)),Pt=(zt.add.forEach(function(Et){Rl(X,Et[0],Et[1].primKey,Et[1].indexes)}),zt.change.forEach(function(Et){if(Et.recreate)throw new kt.Upgrade("Not yet support for changing primary key");var Ht=X.objectStore(Et.name);Et.add.forEach(function(ee){return fo(Ht,ee)}),Et.change.forEach(function(ee){Ht.deleteIndex(ee.name),fo(Ht,ee)}),Et.del.forEach(function(ee){return Ht.deleteIndex(ee)})}),nt._cfg.contentUpgrade);if(Pt&&nt._cfg.version>Q)return us($,X),Z._memoizedTables={},gt=ut(St),zt.del.forEach(function(Et){gt[Et]=Dt[Et]}),wa($,[$.Transaction.prototype]),co($,[$.Transaction.prototype],c(gt),gt),Z.schema=gt,(At=I(Pt))&&sn(),St=Nt.follow(function(){var Et;(Mt=Pt(Z))&&At&&(Et=Yn.bind(null,null),Mt.then(Et,Et))}),Mt&&typeof Mt.then=="function"?Nt.resolve(Mt):St.then(function(){return Mt})}),Y.push(function(gt){var At,Mt,Dt=nt._cfg.dbschema;At=Dt,Mt=gt,[].slice.call(Mt.db.objectStoreNames).forEach(function(St){return At[St]==null&&Mt.db.deleteObjectStore(St)}),wa($,[$.Transaction.prototype]),co($,[$.Transaction.prototype],$._storeNames,$._dbSchema),Z.schema=$._dbSchema}),Y.push(function(gt){$.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil($.idbdb.version/10)===nt._cfg.version?($.idbdb.deleteObjectStore("$meta"),delete $._dbSchema.$meta,$._storeNames=$._storeNames.filter(function(At){return At!=="$meta"})):gt.objectStore("$meta").put(nt._cfg.version,"version"))})}),(function nt(){return Y.length?Nt.resolve(Y.shift()(Z.idbtrans)).then(nt):Nt.resolve()})().then(function(){iu(ot,X)}))}).catch(P);var V,et;c(R).forEach(function(K){Rl(x,K,R[K].primKey,R[K].indexes)}),us(m,x),Nt.follow(function(){return m.on.populate.fire(D)}).catch(P)})}function uo(m,v){iu(m._dbSchema,v),v.db.version%10!=0||v.objectStoreNames.contains("$meta")||v.db.createObjectStore("$meta").add(Math.ceil(v.db.version/10-1),"version");var x=wr(0,m.idbdb,v);po(m,m._dbSchema,v);for(var E=0,R=ho(x,m._dbSchema).change;E<R.length;E++){var D=(P=>{if(P.change.length||P.recreate)return console.warn("Unable to patch indexes of table ".concat(P.name," because it has changes on the type of index or primary key.")),{value:void 0};var B=v.objectStore(P.name);P.add.forEach(function(V){ni&&console.debug("Dexie upgrade patch: Creating missing index ".concat(P.name,".").concat(V.src)),fo(B,V)})})(R[E]);if(typeof D=="object")return D.value}}function ho(m,v){var x,E={del:[],add:[],change:[]};for(x in m)v[x]||E.del.push(x);for(x in v){var R=m[x],D=v[x];if(R){var P={name:x,def:D,recreate:!1,del:[],add:[],change:[]};if(""+(R.primKey.keyPath||"")!=""+(D.primKey.keyPath||"")||R.primKey.auto!==D.primKey.auto)P.recreate=!0,E.change.push(P);else{var B=R.idxByName,V=D.idxByName,et=void 0;for(et in B)V[et]||P.del.push(et);for(et in V){var K=B[et],$=V[et];K?K.src!==$.src&&P.change.push($):P.add.push($)}(0<P.del.length||0<P.add.length||0<P.change.length)&&E.change.push(P)}}else E.add.push([x,D])}return E}function Rl(m,v,x,E){var R=m.db.createObjectStore(v,x.keyPath?{keyPath:x.keyPath,autoIncrement:x.auto}:{autoIncrement:x.auto});E.forEach(function(D){return fo(R,D)})}function iu(m,v){c(m).forEach(function(x){v.db.objectStoreNames.contains(x)||(ni&&console.debug("Dexie: Creating missing table",x),Rl(v,x,m[x].primKey,m[x].indexes))})}function fo(m,v){m.createIndex(v.name,v.keyPath,{unique:v.unique,multiEntry:v.multi})}function wr(m,v,x){var E={};return k(v.objectStoreNames,0).forEach(function(R){for(var D=x.objectStore(R),P=Ni(oo(et=D.keyPath),et||"",!0,!1,!!D.autoIncrement,et&&typeof et!="string",!0),B=[],V=0;V<D.indexNames.length;++V){var K=D.index(D.indexNames[V]),et=K.keyPath,K=Ni(K.name,et,!!K.unique,!!K.multiEntry,!1,et&&typeof et!="string",!1);B.push(K)}E[R]=yr(R,P,B)}),E}function po(m,v,x){for(var E=x.db.objectStoreNames,R=0;R<E.length;++R){var D=E[R],P=x.objectStore(D);m._hasGetAll="getAll"in P;for(var B=0;B<P.indexNames.length;++B){var V,et=P.indexNames[B],K=P.index(et).keyPath,K=typeof K=="string"?K:"["+k(K).join("+")+"]";v[D]&&(V=v[D].idxByName[K])&&(V.name=et,delete v[D].idxByName[K],v[D].idxByName[et]=V)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&l.WorkerGlobalScope&&l instanceof l.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(m._hasGetAll=!1)}function su(m){return m.split(",").map(function(v,x){var R=v.split(":"),E=(E=R[1])==null?void 0:E.trim(),R=(v=R[0].trim()).replace(/([&*]|\+\+)/g,""),D=/^\[/.test(R)?R.match(/^\[(.*)\]$/)[1].split("+"):R;return Ni(R,D||null,/\&/.test(v),/\*/.test(v),/\+\+/.test(v),u(D),x===0,E)})}xr.prototype._createTableSchema=yr,xr.prototype._parseIndexSyntax=su,xr.prototype._parseStoresSpec=function(m,v){var x=this;c(m).forEach(function(E){if(m[E]!==null){var R=x._parseIndexSyntax(m[E]),D=R.shift();if(!D)throw new kt.Schema("Invalid schema for table "+E+": "+m[E]);if(D.unique=!0,D.multi)throw new kt.Schema("Primary key cannot be multiEntry*");R.forEach(function(P){if(P.auto)throw new kt.Schema("Only primary key can be marked as autoIncrement (++)");if(!P.keyPath)throw new kt.Schema("Index must have a name and cannot be an empty string")}),D=x._createTableSchema(E,D,R),v[E]=D}})},xr.prototype.stores=function(x){var v=this.db,x=(this._cfg.storesSource=this._cfg.storesSource?d(this._cfg.storesSource,x):x,v._versions),E={},R={};return x.forEach(function(D){d(E,D._cfg.storesSource),R=D._cfg.dbschema={},D._parseStoresSpec(E,R)}),v._dbSchema=R,wa(v,[v._allTables,v,v.Transaction.prototype]),co(v,[v._allTables,v,v.Transaction.prototype,this._cfg.tables],c(R),R),v._storeNames=c(R),this},xr.prototype.upgrade=function(m){return this._cfg.contentUpgrade=ia(this._cfg.contentUpgrade||pt,m),this};var bd=xr;function xr(){}function Ml(m,v){var x=m._dbNamesDB;return x||(x=m._dbNamesDB=new ki(fa,{addons:[],indexedDB:m,IDBKeyRange:v})).version(1).stores({dbnames:"name"}),x.table("dbnames")}function mo(m){return m&&typeof m.databases=="function"}function Dl(m){return ze(function(){return Ft.letThrough=!0,m()})}function Ol(m){return!("from"in m)}var _n=function(m,v){var x;if(!this)return x=new _n,m&&"d"in m&&d(x,m),x;d(this,arguments.length?{d:1,from:m,to:1<arguments.length?v:m}:{d:0})};function Aa(m,v,x){var E=ce(v,x);if(!isNaN(E)){if(0<E)throw RangeError();if(Ol(m))return d(m,{from:v,to:x,d:1});var E=m.l,R=m.r;if(ce(x,m.from)<0)return E?Aa(E,v,x):m.l={from:v,to:x,d:1,l:null,r:null},au(m);if(0<ce(v,m.to))return R?Aa(R,v,x):m.r={from:v,to:x,d:1,l:null,r:null},au(m);ce(v,m.from)<0&&(m.from=v,m.l=null,m.d=R?R.d+1:1),0<ce(x,m.to)&&(m.to=x,m.r=null,m.d=m.l?m.l.d+1:1),v=!m.r,E&&!m.l&&Fs(m,E),R&&v&&Fs(m,R)}}function Fs(m,v){Ol(v)||(function x(E,R){var D=R.from,P=R.l,B=R.r;Aa(E,D,R.to),P&&x(E,P),B&&x(E,B)})(m,v)}function ru(m,v){var x=go(v),E=x.next();if(!E.done)for(var R=E.value,D=go(m),P=D.next(R.from),B=P.value;!E.done&&!P.done;){if(ce(B.from,R.to)<=0&&0<=ce(B.to,R.from))return!0;ce(R.from,B.from)<0?R=(E=x.next(B.from)).value:B=(P=D.next(R.from)).value}return!1}function go(m){var v=Ol(m)?null:{s:0,n:m};return{next:function(x){for(var E=0<arguments.length;v;)switch(v.s){case 0:if(v.s=1,E)for(;v.n.l&&ce(x,v.n.from)<0;)v={up:v,n:v.n.l,s:1};else for(;v.n.l;)v={up:v,n:v.n.l,s:1};case 1:if(v.s=2,!E||ce(x,v.n.to)<=0)return{value:v.n,done:!1};case 2:if(v.n.r){v.s=3,v={up:v,n:v.n.r,s:0};continue}case 3:v=v.up}return{done:!0}}}}function au(m){var v,x,E,R=(((R=m.r)==null?void 0:R.d)||0)-(((R=m.l)==null?void 0:R.d)||0),R=1<R?"r":R<-1?"l":"";R&&(v=R=="r"?"l":"r",x=i({},m),E=m[R],m.from=E.from,m.to=E.to,m[R]=E[R],x[R]=E[v],(m[v]=x).d=Nl(x)),m.d=Nl(m)}function Nl(x){var v=x.r,x=x.l;return(v?x?Math.max(v.d,x.d):v.d:x?x.d:0)+1}function yo(m,v){return c(v).forEach(function(x){m[x]?Fs(m[x],v[x]):m[x]=(function E(R){var D,P,B={};for(D in R)y(R,D)&&(P=R[D],B[D]=!P||typeof P!="object"||ct.has(P.constructor)?P:E(P));return B})(v[x])}),m}function kl(m,v){return m.all||v.all||Object.keys(m).some(function(x){return v[x]&&ru(v[x],m[x])})}w(_n.prototype,((Hn={add:function(m){return Fs(this,m),this},addKey:function(m){return Aa(this,m,m),this},addKeys:function(m){var v=this;return m.forEach(function(x){return Aa(v,x,x)}),this},hasKey:function(m){var v=go(this).next(m).value;return v&&ce(v.from,m)<=0&&0<=ce(v.to,m)}})[G]=function(){return go(this)},Hn));var Is={},Ll={},Pl=!1;function bo(m){yo(Ll,m),Pl||(Pl=!0,setTimeout(function(){Pl=!1,Bl(Ll,!(Ll={}))},0))}function Bl(m,v){v===void 0&&(v=!1);var x=new Set;if(m.all)for(var E=0,R=Object.values(Is);E<R.length;E++)ou(B=R[E],m,x,v);else for(var D in m){var P,B,D=/^idb\:\/\/(.*)\/(.*)\//.exec(D);D&&(P=D[1],D=D[2],B=Is["idb://".concat(P,"/").concat(D)])&&ou(B,m,x,v)}x.forEach(function(V){return V()})}function ou(m,v,x,E){for(var R=[],D=0,P=Object.entries(m.queries.query);D<P.length;D++){for(var B=P[D],V=B[0],et=[],K=0,$=B[1];K<$.length;K++){var Q=$[K];kl(v,Q.obsSet)?Q.subscribers.forEach(function(it){return x.add(it)}):E&&et.push(Q)}E&&R.push([V,et])}if(E)for(var Z=0,X=R;Z<X.length;Z++){var Y=X[Z],V=Y[0],et=Y[1];m.queries.query[V]=et}}function vd(m){var v=m._state,x=m._deps.indexedDB;if(v.isBeingOpened||m.idbdb)return v.dbReadyPromise.then(function(){return v.dbOpenError?ke(v.dbOpenError):m});v.isBeingOpened=!0,v.dbOpenError=null,v.openComplete=!1;var E=v.openCanceller,R=Math.round(10*m.verno),D=!1;function P(){if(v.openCanceller!==E)throw new kt.DatabaseClosed("db.open() was cancelled")}function B(){return new Nt(function(Q,Z){if(P(),!x)throw new kt.MissingAPI;var X=m.name,Y=v.autoSchema||!R?x.open(X):x.open(X,R);if(!Y)throw new kt.MissingAPI;Y.onerror=yi(Z),Y.onblocked=Ie(m._fireOnBlocked),Y.onupgradeneeded=Ie(function(it){var ot;K=Y.transaction,v.autoSchema&&!m._options.allowEmptyDB?(Y.onerror=Ps,K.abort(),Y.result.close(),(ot=x.deleteDatabase(X)).onsuccess=ot.onerror=Ie(function(){Z(new kt.NoSuchDatabase("Database ".concat(X," doesnt exist")))})):(K.onerror=yi(Z),ot=it.oldVersion>Math.pow(2,62)?0:it.oldVersion,$=ot<1,m.idbdb=Y.result,D&&uo(m,K),xa(m,ot/10,K,Z))},Z),Y.onsuccess=Ie(function(){K=null;var it,ot,nt,gt,At,Mt,Dt=m.idbdb=Y.result,St=k(Dt.objectStoreNames);if(0<St.length)try{var zt=Dt.transaction((At=St).length===1?At[0]:At,"readonly");if(v.autoSchema)Mt=Dt,gt=zt,(nt=m).verno=Mt.version/10,gt=nt._dbSchema=wr(0,Mt,gt),nt._storeNames=k(Mt.objectStoreNames,0),co(nt,[nt._allTables],c(gt),gt);else if(po(m,m._dbSchema,zt),ot=zt,((ot=ho(wr(0,(it=m).idbdb,ot),it._dbSchema)).add.length||ot.change.some(function(Pt){return Pt.add.length||Pt.change.length}))&&!D)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Dt.close(),R=Dt.version+1,D=!0,Q(B());us(m,zt)}catch{}Os.push(m),Dt.onversionchange=Ie(function(Pt){v.vcFired=!0,m.on("versionchange").fire(Pt)}),Dt.onclose=Ie(function(){m.close({disableAutoOpen:!1})}),$&&(St=m._deps,At=X,mo(Mt=St.indexedDB)||At===fa||Ml(Mt,St.IDBKeyRange).put({name:At}).catch(pt)),Q()},Z)}).catch(function(Q){switch(Q?.name){case"UnknownError":if(0<v.PR1398_maxLoop)return v.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),B();break;case"VersionError":if(0<R)return R=0,B()}return Nt.reject(Q)})}var V,et=v.dbReadyResolve,K=null,$=!1;return Nt.race([E,(typeof navigator>"u"?Nt.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(Q){function Z(){return indexedDB.databases().finally(Q)}V=setInterval(Z,100),Z()}).finally(function(){return clearInterval(V)}):Promise.resolve()).then(B)]).then(function(){return P(),v.onReadyBeingFired=[],Nt.resolve(Dl(function(){return m.on.ready.fire(m.vip)})).then(function Q(){var Z;if(0<v.onReadyBeingFired.length)return Z=v.onReadyBeingFired.reduce(ia,pt),v.onReadyBeingFired=[],Nt.resolve(Dl(function(){return Z(m.vip)})).then(Q)})}).finally(function(){v.openCanceller===E&&(v.onReadyBeingFired=null,v.isBeingOpened=!1)}).catch(function(Q){v.dbOpenError=Q;try{K&&K.abort()}catch{}return E===v.openCanceller&&m._close(),ke(Q)}).finally(function(){v.openComplete=!0,et()}).then(function(){var Q;return $&&(Q={},m.tables.forEach(function(Z){Z.schema.indexes.forEach(function(X){X.name&&(Q["idb://".concat(m.name,"/").concat(Z.name,"/").concat(X.name)]=new _n(-1/0,[[[]]]))}),Q["idb://".concat(m.name,"/").concat(Z.name,"/")]=Q["idb://".concat(m.name,"/").concat(Z.name,"/:dels")]=new _n(-1/0,[[[]]])}),En(gr).fire(Q),Bl(Q,!0)),m})}function Sa(m){function v(D){return m.next(D)}var x=R(v),E=R(function(D){return m.throw(D)});function R(D){return function(B){var B=D(B),V=B.value;return B.done?V:V&&typeof V.then=="function"?V.then(x,E):u(V)?Promise.all(V).then(x,E):x(V)}}return R(v)()}function hs(m,v,x){for(var E=u(m)?m.slice():[m],R=0;R<x;++R)E.push(v);return E}var wd={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(m){return i(i({},m),{table:function(E){var x=m.table(E),E=x.schema,R={},D=[];function P(Q,Z,X){var nt=hn(Q),Y=R[nt]=R[nt]||[],it=Q==null?0:typeof Q=="string"?1:Q.length,ot=0<Z,nt=i(i({},X),{name:ot?"".concat(nt,"(virtual-from:").concat(X.name,")"):X.name,lowLevelIndex:X,isVirtual:ot,keyTail:Z,keyLength:it,extractKey:vr(Q),unique:!ot&&X.unique});return Y.push(nt),nt.isPrimaryKey||D.push(nt),1<it&&P(it===2?Q[0]:Q.slice(0,it-1),Z+1,X),Y.sort(function(gt,At){return gt.keyTail-At.keyTail}),nt}var B=P(E.primaryKey.keyPath,0,E.primaryKey);R[":id"]=[B];for(var V=0,et=E.indexes;V<et.length;V++){var K=et[V];P(K.keyPath,0,K)}function $(Q){var Z,X=Q.query.index;return X.isVirtual?i(i({},Q),{query:{index:X.lowLevelIndex,range:(Z=Q.query.range,X=X.keyTail,{type:Z.type===1?2:Z.type,lower:hs(Z.lower,Z.lowerOpen?m.MAX_KEY:m.MIN_KEY,X),lowerOpen:!0,upper:hs(Z.upper,Z.upperOpen?m.MIN_KEY:m.MAX_KEY,X),upperOpen:!0})}}):Q}return i(i({},x),{schema:i(i({},E),{primaryKey:B,indexes:D,getIndexByKeyPath:function(Q){return(Q=R[hn(Q)])&&Q[0]}}),count:function(Q){return x.count($(Q))},query:function(Q){return x.query($(Q))},openCursor:function(Q){var Z=Q.query.index,X=Z.keyTail,Y=Z.keyLength;return Z.isVirtual?x.openCursor($(Q)).then(function(ot){return ot&&it(ot)}):x.openCursor(Q);function it(ot){return Object.create(ot,{continue:{value:function(nt){nt!=null?ot.continue(hs(nt,Q.reverse?m.MAX_KEY:m.MIN_KEY,X)):Q.unique?ot.continue(ot.key.slice(0,Y).concat(Q.reverse?m.MIN_KEY:m.MAX_KEY,X)):ot.continue()}},continuePrimaryKey:{value:function(nt,gt){ot.continuePrimaryKey(hs(nt,m.MAX_KEY,X),gt)}},primaryKey:{get:function(){return ot.primaryKey}},key:{get:function(){var nt=ot.key;return Y===1?nt[0]:nt.slice(0,Y)}},value:{get:function(){return ot.value}}})}}})}})}};function vo(m,v,x,E){return x=x||{},E=E||"",c(m).forEach(function(R){var D,P,B;y(v,R)?(D=m[R],P=v[R],typeof D=="object"&&typeof P=="object"&&D&&P?(B=Vt(D))!==Vt(P)?x[E+R]=v[R]:B==="Object"?vo(D,P,x,E+R+"."):D!==P&&(x[E+R]=v[R]):D!==P&&(x[E+R]=v[R])):x[E+R]=void 0}),c(v).forEach(function(R){y(m,R)||(x[E+R]=v[R])}),x}function wo(m,v){return v.type==="delete"?v.keys:v.keys||v.values.map(m.extractKey)}var lu={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(m){return i(i({},m),{table:function(v){var x=m.table(v),E=x.schema.primaryKey;return i(i({},x),{mutate:function(R){var D=Ft.trans,P=D.table(v).hook,B=P.deleting,V=P.creating,et=P.updating;switch(R.type){case"add":if(V.fire===pt)break;return D._promise("readwrite",function(){return K(R)},!0);case"put":if(V.fire===pt&&et.fire===pt)break;return D._promise("readwrite",function(){return K(R)},!0);case"delete":if(B.fire===pt)break;return D._promise("readwrite",function(){return K(R)},!0);case"deleteRange":if(B.fire===pt)break;return D._promise("readwrite",function(){return(function $(Q,Z,X){return x.query({trans:Q,values:!1,query:{index:E,range:Z},limit:X}).then(function(Y){var it=Y.result;return K({type:"delete",keys:it,trans:Q}).then(function(ot){return 0<ot.numFailures?Promise.reject(ot.failures[0]):it.length<X?{failures:[],numFailures:0,lastResult:void 0}:$(Q,i(i({},Z),{lower:it[it.length-1],lowerOpen:!0}),X)})})})(R.trans,R.range,1e4)},!0)}return x.mutate(R);function K($){var Q,Z,X,Y=Ft.trans,it=$.keys||wo(E,$);if(it)return($=$.type==="add"||$.type==="put"?i(i({},$),{keys:it}):i({},$)).type!=="delete"&&($.values=r([],$.values)),$.keys&&($.keys=r([],$.keys)),Q=x,X=it,((Z=$).type==="add"?Promise.resolve([]):Q.getMany({trans:Z.trans,keys:X,cache:"immutable"})).then(function(ot){var nt=it.map(function(gt,At){var Mt,Dt,St,zt=ot[At],Pt={onerror:null,onsuccess:null};return $.type==="delete"?B.fire.call(Pt,gt,zt,Y):$.type==="add"||zt===void 0?(Mt=V.fire.call(Pt,gt,$.values[At],Y),gt==null&&Mt!=null&&($.keys[At]=gt=Mt,E.outbound||H($.values[At],E.keyPath,gt))):(Mt=vo(zt,$.values[At]),(Dt=et.fire.call(Pt,Mt,gt,zt,Y))&&(St=$.values[At],Object.keys(Dt).forEach(function(Et){y(St,Et)?St[Et]=Dt[Et]:H(St,Et,Dt[Et])}))),Pt});return x.mutate($).then(function(gt){for(var At=gt.failures,Mt=gt.results,Dt=gt.numFailures,gt=gt.lastResult,St=0;St<it.length;++St){var zt=(Mt||it)[St],Pt=nt[St];zt==null?Pt.onerror&&Pt.onerror(At[St]):Pt.onsuccess&&Pt.onsuccess($.type==="put"&&ot[St]?$.values[St]:zt)}return{failures:At,results:Mt,numFailures:Dt,lastResult:gt}}).catch(function(gt){return nt.forEach(function(At){return At.onerror&&At.onerror(gt)}),Promise.reject(gt)})});throw new Error("Keys missing")}}})}})}};function jl(m,v,x){try{if(!v||v.keys.length<m.length)return null;for(var E=[],R=0,D=0;R<v.keys.length&&D<m.length;++R)ce(v.keys[R],m[D])===0&&(E.push(x?Lt(v.values[R]):v.values[R]),++D);return E.length===m.length?E:null}catch{return null}}var cu={stack:"dbcore",level:-1,create:function(m){return{table:function(v){var x=m.table(v);return i(i({},x),{getMany:function(E){var R;return E.cache?(R=jl(E.keys,E.trans._cache,E.cache==="clone"))?Nt.resolve(R):x.getMany(E).then(function(D){return E.trans._cache={keys:E.keys,values:E.cache==="clone"?Lt(D):D},D}):x.getMany(E)},mutate:function(E){return E.type!=="add"&&(E.trans._cache=null),x.mutate(E)}})}}}};function Us(m,v){return m.trans.mode==="readonly"&&!!m.subscr&&!m.trans.explicit&&m.trans.db._options.cache!=="disabled"&&!v.schema.primaryKey.outbound}function uu(m,v){switch(m){case"query":return v.values&&!v.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var xd={stack:"dbcore",level:0,name:"Observability",create:function(m){var v=m.schema.name,x=new _n(m.MIN_KEY,m.MAX_KEY);return i(i({},m),{transaction:function(E,R,D){if(Ft.subscr&&R!=="readonly")throw new kt.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ft.querier));return m.transaction(E,R,D)},table:function(E){function R(it){var Y,it=it.query;return[Y=it.index,new _n((Y=(it=it.range).lower)!=null?Y:m.MIN_KEY,(Y=it.upper)!=null?Y:m.MAX_KEY)]}var D=m.table(E),P=D.schema,B=P.primaryKey,V=P.indexes,et=B.extractKey,K=B.outbound,$=B.autoIncrement&&V.filter(function(X){return X.compound&&X.keyPath.includes(B.keyPath)}),Q=i(i({},D),{mutate:function(X){function Y(Ht){return Ht="idb://".concat(v,"/").concat(E,"/").concat(Ht),At[Ht]||(At[Ht]=new _n)}var it,ot,nt,gt=X.trans,At=X.mutatedParts||(X.mutatedParts={}),Mt=Y(""),Dt=Y(":dels"),St=X.type,Pt=X.type==="deleteRange"?[X.range]:X.type==="delete"?[X.keys]:X.values.length<50?[wo(B,X).filter(function(Ht){return Ht}),X.values]:[],zt=Pt[0],Pt=Pt[1],Et=X.trans._cache;return u(zt)?(Mt.addKeys(zt),(St=St==="delete"||zt.length===Pt.length?jl(zt,Et):null)||Dt.addKeys(zt),(St||Pt)&&(it=Y,ot=St,nt=Pt,P.indexes.forEach(function(Ht){var ee=it(Ht.name||"");function ue(se){return se!=null?Ht.extractKey(se):null}function Qt(se){Ht.multiEntry&&u(se)?se.forEach(function(Le){return ee.addKey(Le)}):ee.addKey(se)}(ot||nt).forEach(function(se,De){var Vn=ot&&ue(ot[De]),De=nt&&ue(nt[De]);ce(Vn,De)!==0&&(Vn!=null&&Qt(Vn),De!=null)&&Qt(De)})}))):zt?(Pt={from:(Et=zt.lower)!=null?Et:m.MIN_KEY,to:(St=zt.upper)!=null?St:m.MAX_KEY},Dt.add(Pt),Mt.add(Pt)):(Mt.add(x),Dt.add(x),P.indexes.forEach(function(Ht){return Y(Ht.name).add(x)})),D.mutate(X).then(function(Ht){return!zt||X.type!=="add"&&X.type!=="put"||(Mt.addKeys(Ht.results),$&&$.forEach(function(ee){for(var ue=X.values.map(function(Vn){return ee.extractKey(Vn)}),Qt=ee.keyPath.findIndex(function(Vn){return Vn===B.keyPath}),se=0,Le=Ht.results.length;se<Le;++se)ue[se][Qt]=Ht.results[se];Y(ee.name).addKeys(ue)})),gt.mutatedParts=yo(gt.mutatedParts||{},At),Ht})}}),Z={get:function(X){return[B,new _n(X.key)]},getMany:function(X){return[B,new _n().addKeys(X.keys)]},count:R,query:R,openCursor:R};return c(Z).forEach(function(X){Q[X]=function(Y){var it=Ft.subscr,ot=!!it,nt=Us(Ft,D)&&uu(X,Y)?Y.obsSet={}:it;if(ot){var gt,it=function(Pt){return Pt="idb://".concat(v,"/").concat(E,"/").concat(Pt),nt[Pt]||(nt[Pt]=new _n)},At=it(""),Mt=it(":dels"),ot=Z[X](Y),Dt=ot[0],ot=ot[1];if((X==="query"&&Dt.isPrimaryKey&&!Y.values?Mt:it(Dt.name||"")).add(ot),!Dt.isPrimaryKey){if(X!=="count")return gt=X==="query"&&K&&Y.values&&D.query(i(i({},Y),{values:!1})),D[X].apply(this,arguments).then(function(Pt){if(X==="query"){if(K&&Y.values)return gt.then(function(ue){return ue=ue.result,At.addKeys(ue),Pt});var Et=Y.values?Pt.result.map(et):Pt.result;(Y.values?At:Mt).addKeys(Et)}else{var Ht,ee;if(X==="openCursor")return ee=Y.values,(Ht=Pt)&&Object.create(Ht,{key:{get:function(){return Mt.addKey(Ht.primaryKey),Ht.key}},primaryKey:{get:function(){var ue=Ht.primaryKey;return Mt.addKey(ue),ue}},value:{get:function(){return ee&&At.addKey(Ht.primaryKey),Ht.value}}})}return Pt});Mt.add(x)}}return D[X].apply(this,arguments)}}),Q}})}};function hu(m,v,x){var E;return x.numFailures===0?v:v.type==="deleteRange"||(E=v.keys?v.keys.length:"values"in v&&v.values?v.values.length:1,x.numFailures===E)?null:(E=i({},v),u(E.keys)&&(E.keys=E.keys.filter(function(R,D){return!(D in x.failures)})),"values"in E&&u(E.values)&&(E.values=E.values.filter(function(R,D){return!(D in x.failures)})),E)}function xo(m,v){return x=m,((E=v).lower===void 0||(E.lowerOpen?0<ce(x,E.lower):0<=ce(x,E.lower)))&&(x=m,(E=v).upper===void 0||(E.upperOpen?ce(x,E.upper)<0:ce(x,E.upper)<=0));var x,E}function Fl(m,v,x,E,R,D){var P,B,V,et,K,$;return!x||x.length===0||(P=v.query.index,B=P.multiEntry,V=v.query.range,et=E.schema.primaryKey.extractKey,K=P.extractKey,$=(P.lowLevelIndex||P).extractKey,(E=x.reduce(function(Q,Z){var X=Q,Y=[];if(Z.type==="add"||Z.type==="put")for(var it=new _n,ot=Z.values.length-1;0<=ot;--ot){var nt,gt=Z.values[ot],At=et(gt);!it.hasKey(At)&&(nt=K(gt),B&&u(nt)?nt.some(function(Pt){return xo(Pt,V)}):xo(nt,V))&&(it.addKey(At),Y.push(gt))}switch(Z.type){case"add":var Mt=new _n().addKeys(v.values?Q.map(function(Et){return et(Et)}):Q),X=Q.concat(v.values?Y.filter(function(Et){return Et=et(Et),!Mt.hasKey(Et)&&(Mt.addKey(Et),!0)}):Y.map(function(Et){return et(Et)}).filter(function(Et){return!Mt.hasKey(Et)&&(Mt.addKey(Et),!0)}));break;case"put":var Dt=new _n().addKeys(Z.values.map(function(Et){return et(Et)}));X=Q.filter(function(Et){return!Dt.hasKey(v.values?et(Et):Et)}).concat(v.values?Y:Y.map(function(Et){return et(Et)}));break;case"delete":var St=new _n().addKeys(Z.keys);X=Q.filter(function(Et){return!St.hasKey(v.values?et(Et):Et)});break;case"deleteRange":var zt=Z.range;X=Q.filter(function(Et){return!xo(et(Et),zt)})}return X},m))===m)?m:(E.sort(function(Q,Z){return ce($(Q),$(Z))||ce(et(Q),et(Z))}),v.limit&&v.limit<1/0&&(E.length>v.limit?E.length=v.limit:m.length===v.limit&&E.length<v.limit&&(R.dirty=!0)),D?Object.freeze(E):E)}function Ar(m,v){return ce(m.lower,v.lower)===0&&ce(m.upper,v.upper)===0&&!!m.lowerOpen==!!v.lowerOpen&&!!m.upperOpen==!!v.upperOpen}function Ea(m,v){return((x,E,R,D)=>{if(x===void 0)return E!==void 0?-1:0;if(E===void 0)return 1;if((x=ce(x,E))===0){if(R&&D)return 0;if(R)return 1;if(D)return-1}return x})(m.lower,v.lower,m.lowerOpen,v.lowerOpen)<=0&&0<=((x,E,R,D)=>{if(x===void 0)return E!==void 0?1:0;if(E===void 0)return-1;if((x=ce(x,E))===0){if(R&&D)return 0;if(R)return-1;if(D)return 1}return x})(m.upper,v.upper,m.upperOpen,v.upperOpen)}function Ad(m,v,x,E){m.subscribers.add(x),E.addEventListener("abort",function(){var R,D;m.subscribers.delete(x),m.subscribers.size===0&&(R=m,D=v,setTimeout(function(){R.subscribers.size===0&&wt(D,R)},3e3))})}var Ao={stack:"dbcore",level:0,name:"Cache",create:function(m){var v=m.schema.name;return i(i({},m),{transaction:function(x,E,R){var D,P,B=m.transaction(x,E,R);return E==="readwrite"&&(R=(D=new AbortController).signal,B.addEventListener("abort",(P=function(V){return function(){if(D.abort(),E==="readwrite"){for(var et=new Set,K=0,$=x;K<$.length;K++){var Q=$[K],Z=Is["idb://".concat(v,"/").concat(Q)];if(Z){var X=m.table(Q),Y=Z.optimisticOps.filter(function(Ht){return Ht.trans===B});if(B._explicit&&V&&B.mutatedParts)for(var it=0,ot=Object.values(Z.queries.query);it<ot.length;it++)for(var nt=0,gt=(Dt=ot[it]).slice();nt<gt.length;nt++)kl((St=gt[nt]).obsSet,B.mutatedParts)&&(wt(Dt,St),St.subscribers.forEach(function(Ht){return et.add(Ht)}));else if(0<Y.length){Z.optimisticOps=Z.optimisticOps.filter(function(Ht){return Ht.trans!==B});for(var At=0,Mt=Object.values(Z.queries.query);At<Mt.length;At++)for(var Dt,St,zt,Pt=0,Et=(Dt=Mt[At]).slice();Pt<Et.length;Pt++)(St=Et[Pt]).res!=null&&B.mutatedParts&&(V&&!St.dirty?(zt=Object.isFrozen(St.res),zt=Fl(St.res,St.req,Y,X,St,zt),St.dirty?(wt(Dt,St),St.subscribers.forEach(function(Ht){return et.add(Ht)})):zt!==St.res&&(St.res=zt,St.promise=Nt.resolve({result:zt}))):(St.dirty&&wt(Dt,St),St.subscribers.forEach(function(Ht){return et.add(Ht)})))}}}et.forEach(function(Ht){return Ht()})}}})(!1),{signal:R}),B.addEventListener("error",P(!1),{signal:R}),B.addEventListener("complete",P(!0),{signal:R})),B},table:function(x){var E=m.table(x),R=E.schema.primaryKey;return i(i({},E),{mutate:function(D){var P,B=Ft.trans;return!R.outbound&&B.db._options.cache!=="disabled"&&!B.explicit&&B.idbtrans.mode==="readwrite"&&(P=Is["idb://".concat(v,"/").concat(x)])?(B=E.mutate(D),D.type!=="add"&&D.type!=="put"||!(50<=D.values.length||wo(R,D).some(function(V){return V==null}))?(P.optimisticOps.push(D),D.mutatedParts&&bo(D.mutatedParts),B.then(function(V){0<V.numFailures&&(wt(P.optimisticOps,D),(V=hu(0,D,V))&&P.optimisticOps.push(V),D.mutatedParts)&&bo(D.mutatedParts)}),B.catch(function(){wt(P.optimisticOps,D),D.mutatedParts&&bo(D.mutatedParts)})):B.then(function(V){var et=hu(0,i(i({},D),{values:D.values.map(function(K,$){var Q;return V.failures[$]?K:(H(Q=(Q=R.keyPath)!=null&&Q.includes(".")?Lt(K):i({},K),R.keyPath,V.results[$]),Q)})}),V);P.optimisticOps.push(et),queueMicrotask(function(){return D.mutatedParts&&bo(D.mutatedParts)})}),B):E.mutate(D)},query:function(D){var P,B,V,et,K,$,Q;return Us(Ft,E)&&uu("query",D)?(P=((V=Ft.trans)==null?void 0:V.db._options.cache)==="immutable",B=(V=Ft).requery,V=V.signal,$=((Z,X,Y,it)=>{var ot=Is["idb://".concat(Z,"/").concat(X)];if(!ot)return[];if(!(Z=ot.queries[Y]))return[null,!1,ot,null];var nt=Z[(it.query?it.query.index.name:null)||""];if(!nt)return[null,!1,ot,null];switch(Y){case"query":var gt=nt.find(function(At){return At.req.limit===it.limit&&At.req.values===it.values&&Ar(At.req.query.range,it.query.range)});return gt?[gt,!0,ot,nt]:[nt.find(function(At){return("limit"in At.req?At.req.limit:1/0)>=it.limit&&(!it.values||At.req.values)&&Ea(At.req.query.range,it.query.range)}),!1,ot,nt];case"count":return gt=nt.find(function(At){return Ar(At.req.query.range,it.query.range)}),[gt,!!gt,ot,nt]}})(v,x,"query",D),Q=$[0],et=$[2],K=$[3],Q&&$[1]?Q.obsSet=D.obsSet:($=E.query(D).then(function(Z){var X=Z.result;if(Q&&(Q.res=X),P){for(var Y=0,it=X.length;Y<it;++Y)Object.freeze(X[Y]);Object.freeze(X)}else Z.result=Lt(X);return Z}).catch(function(Z){return K&&Q&&wt(K,Q),Promise.reject(Z)}),Q={obsSet:D.obsSet,promise:$,subscribers:new Set,type:"query",req:D,dirty:!1},K?K.push(Q):(K=[Q],(et=et||(Is["idb://".concat(v,"/").concat(x)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[D.query.index.name||""]=K)),Ad(Q,K,B,V),Q.promise.then(function(Z){return{result:Fl(Z.result,D,et?.optimisticOps,E,Q,P)}})):E.query(D)}})}})}};function _a(m,v){return new Proxy(m,{get:function(x,E,R){return E==="db"?v:Reflect.get(x,E,R)}})}qe.prototype.version=function(m){if(isNaN(m)||m<.1)throw new kt.Type("Given version is not a positive number");if(m=Math.round(10*m)/10,this.idbdb||this._state.isBeingOpened)throw new kt.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,m);var v=this._versions,x=v.filter(function(E){return E._cfg.version===m})[0];return x||(x=new this.Version(m),v.push(x),v.sort(Tl),x.stores({}),this._state.autoSchema=!1),x},qe.prototype._whenReady=function(m){var v=this;return this.idbdb&&(this._state.openComplete||Ft.letThrough||this._vip)?m():new Nt(function(x,E){if(v._state.openComplete)return E(new kt.DatabaseClosed(v._state.dbOpenError));if(!v._state.isBeingOpened){if(!v._state.autoOpen)return void E(new kt.DatabaseClosed);v.open().catch(pt)}v._state.dbReadyPromise.then(x,E)}).then(m)},qe.prototype.use=function(R){var v=R.stack,x=R.create,E=R.level,R=R.name,D=(R&&this.unuse({stack:v,name:R}),this._middlewares[v]||(this._middlewares[v]=[]));return D.push({stack:v,create:x,level:E??10,name:R}),D.sort(function(P,B){return P.level-B.level}),this},qe.prototype.unuse=function(m){var v=m.stack,x=m.name,E=m.create;return v&&this._middlewares[v]&&(this._middlewares[v]=this._middlewares[v].filter(function(R){return E?R.create!==E:!!x&&R.name!==x})),this},qe.prototype.open=function(){var m=this;return mi(On,function(){return vd(m)})},qe.prototype._close=function(){this.on.close.fire(new CustomEvent("close"));var m=this._state,v=Os.indexOf(this);if(0<=v&&Os.splice(v,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}m.isBeingOpened||(m.dbReadyPromise=new Nt(function(x){m.dbReadyResolve=x}),m.openCanceller=new Nt(function(x,E){m.cancelOpen=E}))},qe.prototype.close=function(v){var v=(v===void 0?{disableAutoOpen:!0}:v).disableAutoOpen,x=this._state;v?(x.isBeingOpened&&x.cancelOpen(new kt.DatabaseClosed),this._close(),x.autoOpen=!1,x.dbOpenError=new kt.DatabaseClosed):(this._close(),x.autoOpen=this._options.autoOpen||x.isBeingOpened,x.openComplete=!1,x.dbOpenError=null)},qe.prototype.delete=function(m){var v=this,x=(m===void 0&&(m={disableAutoOpen:!0}),0<arguments.length&&typeof arguments[0]!="object"),E=this._state;return new Nt(function(R,D){function P(){v.close(m);var B=v._deps.indexedDB.deleteDatabase(v.name);B.onsuccess=Ie(function(){var V,et,K;V=v._deps,et=v.name,mo(K=V.indexedDB)||et===fa||Ml(K,V.IDBKeyRange).delete(et).catch(pt),R()}),B.onerror=yi(D),B.onblocked=v._fireOnBlocked}if(x)throw new kt.InvalidArgument("Invalid closeOptions argument to db.delete()");E.isBeingOpened?E.dbReadyPromise.then(P):P()})},qe.prototype.backendDB=function(){return this.idbdb},qe.prototype.isOpen=function(){return this.idbdb!==null},qe.prototype.hasBeenClosed=function(){var m=this._state.dbOpenError;return m&&m.name==="DatabaseClosed"},qe.prototype.hasFailed=function(){return this._state.dbOpenError!==null},qe.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(qe.prototype,"tables",{get:function(){var m=this;return c(this._allTables).map(function(v){return m._allTables[v]})},enumerable:!1,configurable:!0}),qe.prototype.transaction=function(){var m=(function(v,x,E){var R=arguments.length;if(R<2)throw new kt.InvalidArgument("Too few arguments");for(var D=new Array(R-1);--R;)D[R-1]=arguments[R];return E=D.pop(),[v,_t(D),E]}).apply(this,arguments);return this._transaction.apply(this,m)},qe.prototype._transaction=function(m,v,x){var E,R,D=this,P=Ft.trans,B=(P&&P.db===this&&m.indexOf("!")===-1||(P=null),m.indexOf("?")!==-1);m=m.replace("!","").replace("?","");try{if(R=v.map(function(et){if(et=et instanceof D.Table?et.name:et,typeof et!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return et}),m=="r"||m===Ki)E=Ki;else{if(m!="rw"&&m!=ls)throw new kt.InvalidArgument("Invalid transaction mode: "+m);E=ls}if(P){if(P.mode===Ki&&E===ls){if(!B)throw new kt.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");P=null}P&&R.forEach(function(et){if(P&&P.storeNames.indexOf(et)===-1){if(!B)throw new kt.SubTransaction("Table "+et+" not included in parent transaction.");P=null}}),B&&P&&!P.active&&(P=null)}}catch(et){return P?P._promise(null,function(K,$){$(et)}):ke(et)}var V=(function et(K,$,Q,Z,X){return Nt.resolve().then(function(){var nt=Ft.transless||Ft,Y=K._createTransaction($,Q,K._dbSchema,Z),nt=(Y.explicit=!0,{trans:Y,transless:nt});if(Z)Y.idbtrans=Z.idbtrans;else try{Y.create(),Y.idbtrans._explicit=!0,K._state.PR1398_maxLoop=3}catch(gt){return gt.name===Rt.InvalidState&&K.isOpen()&&0<--K._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),K.close({disableAutoOpen:!1}),K.open().then(function(){return et(K,$,Q,null,X)})):ke(gt)}var it,ot=I(X),nt=(ot&&sn(),Nt.follow(function(){var gt;(it=X.call(Y,Y))&&(ot?(gt=Yn.bind(null,null),it.then(gt,gt)):typeof it.next=="function"&&typeof it.throw=="function"&&(it=Sa(it)))},nt));return(it&&typeof it.then=="function"?Nt.resolve(it).then(function(gt){return Y.active?gt:ke(new kt.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):nt.then(function(){return it})).then(function(gt){return Z&&Y._resolve(),Y._completion.then(function(){return gt})}).catch(function(gt){return Y._reject(gt),ke(gt)})})}).bind(null,this,E,R,P,x);return P?P._promise(E,V,"lock"):Ft.trans?mi(Ft.transless,function(){return D._whenReady(V)}):this._whenReady(V)},qe.prototype.table=function(m){if(y(this._allTables,m))return this._allTables[m];throw new kt.InvalidTable("Table ".concat(m," does not exist"))};var ki=qe;function qe(m,v){var x,E,R,D,P,B=this,V=(this._middlewares={},this.verno=0,qe.dependencies),V=(this._options=v=i({addons:qe.addons,autoOpen:!0,indexedDB:V.indexedDB,IDBKeyRange:V.IDBKeyRange,cache:"cloned"},v),this._deps={indexedDB:v.indexedDB,IDBKeyRange:v.IDBKeyRange},v.addons),et=(this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this,{dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:pt,dbReadyPromise:null,cancelOpen:pt,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:v.autoOpen}),K=(et.dbReadyPromise=new Nt(function($){et.dbReadyResolve=$}),et.openCanceller=new Nt(function($,Q){et.cancelOpen=Q}),this._state=et,this.name=m,this.on=ga(this,"populate","blocked","versionchange","close",{ready:[ia,pt]}),this.once=function($,Q){var Z=function(){for(var X=[],Y=0;Y<arguments.length;Y++)X[Y]=arguments[Y];B.on($).unsubscribe(Z),Q.apply(B,X)};return B.on($,Z)},this.on.ready.subscribe=L(this.on.ready.subscribe,function($){return function(Q,Z){qe.vip(function(){var X,Y=B._state;Y.openComplete?(Y.dbOpenError||Nt.resolve().then(Q),Z&&$(Q)):Y.onReadyBeingFired?(Y.onReadyBeingFired.push(Q),Z&&$(Q)):($(Q),X=B,Z||$(function it(){X.on.ready.unsubscribe(Q),X.on.ready.unsubscribe(it)}))})}}),this.Collection=(x=this,Sn(gd.prototype,function(it,Y){this.db=x;var Z=xl,X=null;if(Y)try{Z=Y()}catch(nt){X=nt}var Y=it._ctx,it=Y.table,ot=it.hook.reading.fire;this._ctx={table:it,index:Y.index,isPrimKey:!Y.index||it.schema.primKey.keyPath&&Y.index===it.schema.primKey.name,range:Z,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:X,or:Y.or,valueMapper:ot!==fe?ot:null}})),this.Table=(E=this,Sn(Al.prototype,function($,Q,Z){this.db=E,this._tx=Z,this.name=$,this.schema=Q,this.hook=E._allTables[$]?E._allTables[$].hook:ga(null,{creating:[gl,pt],reading:[ve,fe],updating:[Wc,pt],deleting:[fd,pt]})})),this.Transaction=(R=this,Sn(Cl.prototype,function($,Q,Z,X,Y){var it=this;$!=="readonly"&&Q.forEach(function(ot){ot=(ot=Z[ot])==null?void 0:ot.yProps,ot&&(Q=Q.concat(ot.map(function(nt){return nt.updatesTable})))}),this.db=R,this.mode=$,this.storeNames=Q,this.schema=Z,this.chromeTransactionDurability=X,this.idbtrans=null,this.on=ga(this,"complete","error","abort"),this.parent=Y||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new Nt(function(ot,nt){it._resolve=ot,it._reject=nt}),this._completion.then(function(){it.active=!1,it.on.complete.fire()},function(ot){var nt=it.active;return it.active=!1,it.on.error.fire(ot),it.parent?it.parent._reject(ot):nt&&it.idbtrans&&it.idbtrans.abort(),ke(ot)})})),this.Version=(D=this,Sn(bd.prototype,function($){this.db=D,this._cfg={version:$,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(P=this,Sn(Ls.prototype,function($,Q,Z){if(this.db=P,this._ctx={table:$,index:Q===":id"?null:Q,or:Z},this._cmp=this._ascending=ce,this._descending=function(X,Y){return ce(Y,X)},this._max=function(X,Y){return 0<ce(X,Y)?X:Y},this._min=function(X,Y){return ce(X,Y)<0?X:Y},this._IDBKeyRange=P._deps.IDBKeyRange,!this._IDBKeyRange)throw new kt.MissingAPI})),this.on("versionchange",function($){0<$.newVersion?console.warn("Another connection wants to upgrade database '".concat(B.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(B.name,"'. Closing db now to resume the delete request.")),B.close({disableAutoOpen:!1})}),this.on("blocked",function($){!$.newVersion||$.newVersion<$.oldVersion?console.warn("Dexie.delete('".concat(B.name,"') was blocked")):console.warn("Upgrade '".concat(B.name,"' blocked by other connection holding version ").concat($.oldVersion/10))}),this._maxKey=br(v.IDBKeyRange),this._createTransaction=function($,Q,Z,X){return new B.Transaction($,Q,Z,B._options.chromeTransactionDurability,X)},this._fireOnBlocked=function($){B.on("blocked").fire($),Os.filter(function(Q){return Q.name===B.name&&Q!==B&&!Q._state.vcFired}).map(function(Q){return Q.on("versionchange").fire($)})},this.use(cu),this.use(Ao),this.use(xd),this.use(wd),this.use(lu),new Proxy(this,{get:function($,Q,Z){var X;return Q==="_vip"||(Q==="table"?function(Y){return _a(B.table(Y),K)}:(X=Reflect.get($,Q,Z))instanceof Al?_a(X,K):Q==="tables"?X.map(function(Y){return _a(Y,K)}):Q==="_createTransaction"?function(){return _a(X.apply(this,arguments),K)}:X)}}));this.vip=K,V.forEach(function($){return $(B)})}var Sr,zs=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",du=(So.prototype.subscribe=function(m,v,x){return this._subscribe(m&&typeof m!="function"?m:{next:m,error:v,complete:x})},So.prototype[zs]=function(){return this},So);function So(m){this._subscribe=m}try{Sr={indexedDB:l.indexedDB||l.mozIndexedDB||l.webkitIndexedDB||l.msIndexedDB,IDBKeyRange:l.IDBKeyRange||l.webkitIDBKeyRange}}catch{Sr={indexedDB:null,IDBKeyRange:null}}function fu(m){var v,x=!1,E=new du(function(R){var D=I(m),P,B=!1,V={},et={},K={get closed(){return B},unsubscribe:function(){B||(B=!0,P&&P.abort(),$&&En.storagemutated.unsubscribe(Z))}},$=(R.start&&R.start(K),!1),Q=function(){return os(X)},Z=function(Y){yo(V,Y),kl(et,V)&&Q()},X=function(){var Y,it,ot;!B&&Sr.indexedDB&&(V={},Y={},P&&P.abort(),P=new AbortController,ot=(nt=>{var gt=ss();try{D&&sn();var At=ze(m,nt);return At=D?At.finally(Yn):At}finally{gt&&Mi()}})(it={subscr:Y,signal:P.signal,requery:Q,querier:m,trans:null}),Promise.resolve(ot).then(function(nt){x=!0,v=nt,B||it.signal.aborted||(V={},(gt=>{for(var At in gt)if(y(gt,At))return;return 1})(et=Y)||$||(En(gr,Z),$=!0),os(function(){return!B&&R.next&&R.next(nt)}))},function(nt){x=!1,["DatabaseClosedError","AbortError"].includes(nt?.name)||B||os(function(){B||R.error&&R.error(nt)})}))};return setTimeout(Q,0),K});return E.hasValue=function(){return x},E.getValue=function(){return v},E}var Hs=ki;function Il(m){var v=ds;try{ds=!0,En.storagemutated.fire(m),Bl(m,!0)}finally{ds=v}}w(Hs,i(i({},J),{delete:function(m){return new Hs(m,{addons:[]}).delete()},exists:function(m){return new Hs(m,{addons:[]}).open().then(function(v){return v.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(m){try{return v=Hs.dependencies,x=v.indexedDB,v=v.IDBKeyRange,(mo(x)?Promise.resolve(x.databases()).then(function(E){return E.map(function(R){return R.name}).filter(function(R){return R!==fa})}):Ml(x,v).toCollection().primaryKeys()).then(m)}catch{return ke(new kt.MissingAPI)}var v,x},defineClass:function(){return function(m){d(this,m)}},ignoreTransaction:function(m){return Ft.trans?mi(Ft.transless,m):m()},vip:Dl,async:function(m){return function(){try{var v=Sa(m.apply(this,arguments));return v&&typeof v.then=="function"?v:Nt.resolve(v)}catch(x){return ke(x)}}},spawn:function(m,v,x){try{var E=Sa(m.apply(x,v||[]));return E&&typeof E.then=="function"?E:Nt.resolve(E)}catch(R){return ke(R)}},currentTransaction:{get:function(){return Ft.trans||null}},waitFor:function(m,v){return m=Nt.resolve(typeof m=="function"?Hs.ignoreTransaction(m):m).timeout(v||6e4),Ft.trans?Ft.trans.waitFor(m):m},Promise:Nt,debug:{get:function(){return ni},set:function(m){Zc(m)}},derive:S,extend:d,props:w,override:L,Events:ga,on:En,liveQuery:fu,extendObservabilitySet:yo,getByKeyPath:z,setByKeyPath:H,delByKeyPath:function(m,v){typeof v=="string"?H(m,v,void 0):"length"in v&&[].map.call(v,function(x){H(m,x,void 0)})},shallowClone:ut,deepClone:Lt,getObjectDiff:vo,cmp:ce,asap:F,minKey:-1/0,addons:[],connections:Os,errnames:Rt,dependencies:Sr,cache:Is,semVer:"4.3.0",version:"4.3.0".split(".").map(function(m){return parseInt(m)}).reduce(function(m,v,x){return m+v/Math.pow(10,2*x)})})),Hs.maxKey=br(Hs.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(En(gr,function(m){ds||(m=new CustomEvent(Bs,{detail:m}),ds=!0,dispatchEvent(m),ds=!1)}),addEventListener(Bs,function(m){m=m.detail,ds||Il(m)}));var Er,ds=!1,$n=function(){};return typeof BroadcastChannel<"u"&&(($n=function(){(Er=new BroadcastChannel(Bs)).onmessage=function(m){return m.data&&Il(m.data)}})(),typeof Er.unref=="function"&&Er.unref(),En(gr,function(m){ds||Er.postMessage(m)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(m){if(!ki.disableBfCache&&m.persisted){ni&&console.debug("Dexie: handling persisted pagehide"),Er?.close();for(var v=0,x=Os;v<x.length;v++)x[v].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(m){!ki.disableBfCache&&m.persisted&&(ni&&console.debug("Dexie: handling persisted pageshow"),$n(),Il({all:new _n(-1/0,[[]])}))})),Nt.rejectionMapper=function(m,v){return!m||m instanceof xt||m instanceof TypeError||m instanceof SyntaxError||!m.name||!we[m.name]?m:(v=new we[m.name](v||m.message,m),"stack"in m&&_(v,"stack",{get:function(){return this.inner.stack}}),v)},Zc(ni),i(ki,Object.freeze({__proto__:null,Dexie:ki,Entity:tu,PropModification:mr,RangeSet:_n,add:function(m){return new mr({add:m})},cmp:ce,default:ki,liveQuery:fu,mergeRanges:Fs,rangesOverlap:ru,remove:function(m){return new mr({remove:m})},replacePrefix:function(m,v){return new mr({replacePrefix:[m,v]})}}),{default:ki}),ki})})(kh)),kh.exports}var wC=vC();const Kp=S0(wC),Vv=Symbol.for("Dexie"),qh=globalThis[Vv]||(globalThis[Vv]=Kp);if(Kp.semVer!==qh.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${Kp.semVer} and ${qh.semVer}`);const{liveQuery:rR,mergeRanges:aR,rangesOverlap:oR,RangeSet:lR,cmp:cR,Entity:uR,PropModification:hR,replacePrefix:dR,add:fR,remove:pR,DexieYProvider:mR}=qh,Dm=new qh("WiseMarkDB");Dm.version(1).stores({pdfs:"hash, filename, size, blob"});async function Sw(a){const t=await crypto.subtle.digest("SHA-256",a);return Array.from(new Uint8Array(t)).map(e=>e.toString(16).padStart(2,"0")).join("")}async function Om(a,t,e,i){await Dm.pdfs.put({hash:a,filename:t,size:e,blob:i})}async function xC(a){const t=await Dm.pdfs.get(a);return t?{data:t.blob,filename:t.filename,size:t.size}:null}async function AC(a){if(!a?.pdf_hash)return null;const t=await xC(a.pdf_hash);if(t)return t;try{const{data:e}=await ti.getPdf(a.id),i=(e instanceof ArrayBuffer,e),r=a.file_size??i.byteLength??0;return await Om(a.pdf_hash,a.filename||"",r,i),{data:i,filename:a.filename||"",size:r}}catch{return null}}function SC(){const{projectId:a}=dm(),t=ea(),e=pl(),[i,r]=U.useState(!1),[l,c]=U.useState(""),[u,d]=U.useState(null),[f,p]=U.useState(""),[y,w]=U.useState(!1),[A,_]=U.useState(""),[S,C]=U.useState(null),[M,k]=U.useState(""),[L,j]=U.useState(null),F=U.useRef(null),z=U.useRef(null),H=U.useRef(null),[ut,ft]=U.useState(0),{data:_t,isLoading:ct}=Xa({queryKey:["project",a],queryFn:async()=>{const{data:Rt}=await Hh.get(a);return Rt},enabled:!!a}),{data:Tt,isLoading:Lt}=Xa({queryKey:["documents",a],queryFn:async()=>{const{data:Rt}=await ti.list({project:a});return Rt},enabled:!!a}),Bt=Array.isArray(Tt)?Tt:Tt?.results??[],Vt=Dc({mutationFn:({id:Rt,name:jt})=>Hh.update(Rt,{name:jt}),onSuccess:()=>{e.invalidateQueries({queryKey:["project",a]}),e.invalidateQueries({queryKey:["projects"]}),w(!1)}}),G=Dc({mutationFn:({id:Rt,filename:jt})=>ti.update(Rt,{filename:jt}),onSuccess:()=>{e.invalidateQueries({queryKey:["documents",a]}),d(null),p("")}}),st=Dc({mutationFn:Rt=>ti.delete(Rt),onSuccess:()=>e.invalidateQueries({queryKey:["documents",a]})}),wt=async Rt=>{const jt=Rt.target.files?.[0];if(!jt||!jt.type.includes("pdf"))return;c(""),C(jt);const kt=jt.name.replace(/\.pdf$/i,"")||jt.name;k(kt),j(null),F.current=null;try{const we=await jt.arrayBuffer(),pt=await Sw(we),fe={arrayBuffer:we,hash:pt,size:jt.size};j(fe),F.current={...fe,suggestedName:kt}}catch(we){c(we.message||"Could not read file"),C(null),k("")}},Yt=()=>{C(null),k(""),j(null),c(""),F.current=null,ft(Rt=>Rt+1)},Ct=()=>{H.current?.click()},I=async Rt=>{Rt.preventDefault();const jt=a,we=z.current?.value?.trim()||M?.trim()||F.current?.suggestedName?.trim()||"",pt=F.current||L;if(!jt){c("Project not found.");return}if(!we){c("Please enter a name for the PDF.");return}if(!pt||!pt.hash||!pt.arrayBuffer){c("File data missing. Please close and select the file again.");return}const fe=we.toLowerCase().endsWith(".pdf")?we:`${we}.pdf`;c(""),r(!0);try{const ve=new FormData;ve.append("project",String(jt)),ve.append("filename",fe),ve.append("file",new Blob([pt.arrayBuffer]),fe),await ti.createWithFile(ve),await Om(pt.hash,fe,pt.size,pt.arrayBuffer),e.invalidateQueries({queryKey:["documents",jt]}),C(null),k(""),j(null),F.current=null,ft(An=>An+1)}catch(ve){const An=ve.response?.data?.detail||typeof ve.response?.data=="object"&&Object.values(ve.response?.data||{}).flat().join(" ")||ve.message||"Upload failed";c(String(An))}finally{r(!1)}},J=Rt=>{d(Rt.id),p(Rt.filename||"")},mt=()=>{if(u==null||!f.trim()){d(null);return}G.mutate({id:u,filename:f.trim()})},xt=()=>{d(null),p("")},It=()=>{_(_t?.name??""),w(!0)},Ut=()=>{const Rt=A.trim();if(!Rt||Rt===_t?.name){w(!1);return}Vt.mutate({id:a,name:Rt})},Ot=()=>{w(!1),_("")};return ct||!_t?O.jsx("div",{className:`${Cs} ${Mn.page} flex items-center justify-center`,children:O.jsx(or,{className:"w-8 h-8 animate-spin text-slate-400"})}):O.jsxs("div",{className:`${Cs} ${Mn.page}`,children:[O.jsx("header",{className:"flex items-center justify-between mb-6",children:O.jsxs("button",{type:"button",onClick:()=>t("/"),className:`flex items-center gap-2 ${Kt.secondary} hover:text-slate-900 ${Ua}`,children:[O.jsx(Rm,{className:"w-4 h-4"}),"Back"]})}),O.jsxs("div",{className:"mb-8",children:[O.jsx("div",{className:"flex items-center gap-2 mb-4",children:y?O.jsxs(O.Fragment,{children:[O.jsx("input",{type:"text",value:A,onChange:Rt=>_(Rt.target.value),className:"border border-slate-200 rounded-lg px-3 py-2 text-slate-900 text-xl font-semibold min-w-0 flex-1 max-w-md",autoFocus:!0,onKeyDown:Rt=>{Rt.key==="Enter"&&Ut(),Rt.key==="Escape"&&Ot()}}),O.jsx("button",{type:"button",onClick:Ut,className:"p-2 text-green-600 hover:bg-slate-100 rounded",title:"Save",children:O.jsx(qv,{className:"w-5 h-5"})}),O.jsx("button",{type:"button",onClick:Ot,className:"p-2 text-slate-500 hover:bg-slate-100 rounded",title:"Cancel",children:O.jsx(Vp,{className:"w-5 h-5"})})]}):O.jsxs(O.Fragment,{children:[O.jsx("h1",{className:`text-xl font-semibold ${Kt.heading}`,children:_t.name}),O.jsx("button",{type:"button",onClick:It,className:"p-2 text-slate-400 hover:text-slate-600 rounded",title:"Edit project name",children:O.jsx(Gp,{className:"w-4 h-4"})})]})}),O.jsxs("button",{type:"button",onClick:Ct,disabled:i,className:`${Ti} inline-flex items-center gap-2`,children:[O.jsx($p,{className:"w-4 h-4"}),"Add PDF"]}),O.jsx("input",{ref:H,type:"file",accept:".pdf",onChange:wt,className:"hidden","aria-hidden":"true",tabIndex:-1},ut)]}),S&&O.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50",onClick:Yt,children:O.jsxs("div",{className:`rounded-xl ${Mn.surface} border ${Un.default} shadow-xl w-full max-w-md p-6`,onClick:Rt=>Rt.stopPropagation(),children:[O.jsx("h2",{className:`text-lg font-semibold ${Kt.heading} mb-4`,children:"Name this PDF"}),L?O.jsxs("div",{className:"space-y-4",children:[l&&O.jsx("p",{className:"text-sm text-red-600 bg-red-50 rounded-lg px-3 py-2",children:l}),O.jsx("input",{ref:z,type:"text",value:M,onChange:Rt=>k(Rt.target.value),placeholder:"Document name",className:"w-full border border-slate-200 rounded-lg px-3 py-2.5 text-slate-900",autoFocus:!0,disabled:i}),O.jsxs("div",{className:"flex justify-end gap-3 pt-2",children:[O.jsx("button",{type:"button",onClick:Yt,disabled:i,className:"px-4 py-2 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-lg",children:"Cancel"}),O.jsx("button",{type:"button",onClick:Rt=>{Rt.preventDefault(),I(Rt)},disabled:i||!M.trim(),className:Ti,children:i?O.jsxs("span",{className:"inline-flex items-center gap-2",children:[O.jsx(or,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):"Upload & save"})]})]}):O.jsxs("div",{className:"flex items-center gap-2 text-slate-600 py-4",children:[O.jsx(or,{className:"w-5 h-5 animate-spin shrink-0"}),O.jsx("span",{children:"Reading file..."})]})]})}),l&&O.jsx("p",{className:"text-sm text-red-600 mb-4",children:l}),i&&O.jsxs("p",{className:"flex items-center gap-2 text-sm text-slate-600 mb-4",children:[O.jsx(or,{className:"w-4 h-4 animate-spin"})," Uploading..."]}),Lt?O.jsxs("div",{className:"flex items-center gap-2 text-slate-500",children:[O.jsx(or,{className:"w-5 h-5 animate-spin"})," Loading PDFs..."]}):Bt.length===0?O.jsxs("div",{className:`rounded-xl border ${Un.default} p-8 text-center ${Kt.secondary}`,children:[O.jsx(Aw,{className:"w-12 h-12 mx-auto mb-3 text-slate-400"}),O.jsx("p",{children:"No PDFs in this project yet. Add a PDF above."})]}):O.jsx("ul",{className:"space-y-2",children:Bt.map(Rt=>O.jsx("li",{className:`rounded-lg border ${Un.default} ${Mn.surface} overflow-hidden`,children:u===Rt.id?O.jsxs("div",{className:"flex items-center gap-2 px-4 py-3",children:[O.jsx("input",{type:"text",value:f,onChange:jt=>p(jt.target.value),className:"flex-1 min-w-0 border border-slate-200 rounded-lg px-3 py-2 text-slate-900",autoFocus:!0,onKeyDown:jt=>{jt.key==="Enter"&&mt(),jt.key==="Escape"&&xt()}}),O.jsx("button",{type:"button",onClick:mt,className:"p-2.5 text-green-600 hover:bg-slate-100 rounded-lg shrink-0",title:"Save",children:O.jsx(qv,{className:"w-4 h-4"})}),O.jsx("button",{type:"button",onClick:xt,className:"p-2.5 text-slate-500 hover:bg-slate-100 rounded-lg shrink-0",title:"Cancel",children:O.jsx(Vp,{className:"w-4 h-4"})})]}):O.jsxs("div",{className:"flex items-center gap-3 px-4 py-3",children:[O.jsxs("button",{type:"button",className:"flex-1 min-w-0 text-left py-1",onClick:()=>t(`/document/${Rt.id}`),children:[O.jsx("span",{className:`font-medium ${Kt.body} truncate block`,children:Rt.filename}),O.jsx("span",{className:`text-xs ${Kt.muted}`,children:Rt.file_size!=null&&`${(Rt.file_size/1024).toFixed(1)} KB`})]}),O.jsxs("div",{className:"flex items-center gap-1 shrink-0",children:[O.jsx("button",{type:"button",onClick:()=>J(Rt),className:"p-2.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded-lg",title:"Rename",children:O.jsx(Gp,{className:"w-4 h-4"})}),O.jsx("button",{type:"button",onClick:jt=>{jt.stopPropagation(),confirm("Delete this PDF?")&&st.mutate(Rt.id)},className:"p-2.5 text-slate-400 hover:text-red-600 hover:bg-slate-100 rounded-lg",title:"Delete",children:O.jsx(Mm,{className:"w-4 h-4"})})]})]})},Rt.id))})]})}const di={yellow:{key:"yellow",label:"Yellow",name:"Key Metrics",hex:"#EAB308",rgba:"rgba(254, 243, 199, 0.5)",rgbaSoft:"rgba(234,179,8,0.18)",rgbaHover:"rgba(234,179,8,0.38)",solid:"#fbbf24"},green:{key:"green",label:"Green",name:"Competitive Advantages",hex:"#22C55E",rgba:"rgba(209, 250, 229, 0.5)",rgbaSoft:"rgba(34,197,94,0.18)",rgbaHover:"rgba(34,197,94,0.38)",solid:"#10b981"},blue:{key:"blue",label:"Blue",name:"Management Questions",hex:"#3B82F6",rgba:"rgba(219, 234, 254, 0.5)",rgbaSoft:"rgba(59,130,246,0.18)",rgbaHover:"rgba(59,130,246,0.38)",solid:"#3b82f6"},pink:{key:"pink",label:"Pink",name:"Investment Risks",hex:"#EC4899",rgba:"rgba(252, 231, 243, 0.5)",rgbaSoft:"rgba(236,72,153,0.18)",rgbaHover:"rgba(236,72,153,0.38)",solid:"#ec4899"},orange:{key:"orange",label:"Orange",name:"Commercial DD",hex:"#F97316",rgba:"rgba(254, 215, 170, 0.5)",rgbaSoft:"rgba(249,115,22,0.18)",rgbaHover:"rgba(249,115,22,0.38)",solid:"#f59e0b"}},lr=Object.keys(di);function Es(a,t={}){return t&&typeof t[a]=="string"&&t[a].trim()?t[a].trim():di[a]&&di[a].name||a}const Zn=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser"),Xp=[.001,0,0,.001,0,0],xp=1.35,Ei={ANY:1,DISPLAY:2,PRINT:4,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,IS_EDITING:128,OPLIST:256},Yr={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3},Lc="pdfjs_internal_editor_",ae={DISABLE:-1,NONE:0,FREETEXT:3,HIGHLIGHT:9,STAMP:13,INK:15,POPUP:16,SIGNATURE:101,COMMENT:102},be={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23,HIGHLIGHT_COLOR:31,HIGHLIGHT_THICKNESS:32,HIGHLIGHT_FREE:33,HIGHLIGHT_SHOW_ALL:34,DRAW_STEP:41},EC={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048},Yp={TRIANGLES:1,LATTICE:2},vn={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4},Lh={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3},yn={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26},Qo={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5},ed={ERRORS:0,WARNINGS:1,INFOS:5},Pc={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91,setStrokeTransparent:92,setFillTransparent:93,rawFillPath:94},Ac={moveTo:0,lineTo:1,curveTo:2,quadraticCurveTo:3,closePath:4},_C={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};let nd=ed.WARNINGS;function CC(a){Number.isInteger(a)&&(nd=a)}function TC(){return nd}function id(a){nd>=ed.INFOS&&console.info(`Info: ${a}`)}function ne(a){nd>=ed.WARNINGS&&console.warn(`Warning: ${a}`)}function Me(a){throw new Error(a)}function Re(a,t){a||Me(t)}function RC(a){switch(a?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function Ew(a,t=null,e=null){if(!a)return null;if(e&&typeof a=="string"&&(e.addDefaultProtocol&&a.startsWith("www.")&&a.match(/\./g)?.length>=2&&(a=`http://${a}`),e.tryConvertEncoding))try{a=LC(a)}catch{}const i=t?URL.parse(a,t):URL.parse(a);return RC(i)?i:null}function _w(a,t,e=!1){const i=URL.parse(a);return i?(i.hash=t,i.href):e&&Ew(a,"http://example.com")?a.split("#",1)[0]+`${t?`#${t}`:""}`:""}function ie(a,t,e,i=!1){return Object.defineProperty(a,t,{value:e,enumerable:!i,configurable:!0,writable:!1}),e}const Za=(function(){function t(e,i){this.message=e,this.name=i}return t.prototype=new Error,t.constructor=t,t})();class Kv extends Za{constructor(t,e){super(t,"PasswordException"),this.code=e}}class Ap extends Za{constructor(t,e){super(t,"UnknownErrorException"),this.details=e}}class Qp extends Za{constructor(t){super(t,"InvalidPDFException")}}class Gh extends Za{constructor(t,e,i){super(t,"ResponseException"),this.status=e,this.missing=i}}class MC extends Za{constructor(t){super(t,"FormatError")}}class Zr extends Za{constructor(t){super(t,"AbortException")}}function DC(a){(typeof a!="object"||a?.length===void 0)&&Me("Invalid argument for bytesToString");const t=a.length,e=8192;if(t<e)return String.fromCharCode.apply(null,a);const i=[];for(let r=0;r<t;r+=e){const l=Math.min(r+e,t),c=a.subarray(r,l);i.push(String.fromCharCode.apply(null,c))}return i.join("")}function sd(a){typeof a!="string"&&Me("Invalid argument for stringToBytes");const t=a.length,e=new Uint8Array(t);for(let i=0;i<t;++i)e[i]=a.charCodeAt(i)&255;return e}function OC(a){return String.fromCharCode(a>>24&255,a>>16&255,a>>8&255,a&255)}function NC(){const a=new Uint8Array(4);return a[0]=1,new Uint32Array(a.buffer,0,1)[0]===1}function kC(){try{return new Function(""),!0}catch{return!1}}class xn{static get isLittleEndian(){return ie(this,"isLittleEndian",NC())}static get isEvalSupported(){return ie(this,"isEvalSupported",kC())}static get isOffscreenCanvasSupported(){return ie(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get isImageDecoderSupported(){return ie(this,"isImageDecoderSupported",typeof ImageDecoder<"u")}static get isFloat16ArraySupported(){return ie(this,"isFloat16ArraySupported",typeof Float16Array<"u")}static get isSanitizerSupported(){return ie(this,"isSanitizerSupported",typeof Sanitizer<"u")}static get platform(){const{platform:t,userAgent:e}=navigator;return ie(this,"platform",{isAndroid:e.includes("Android"),isLinux:t.includes("Linux"),isMac:t.includes("Mac"),isWindows:t.includes("Win"),isFirefox:e.includes("Firefox")})}static get isCSSRoundSupported(){return ie(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}const Sp=Array.from(Array(256).keys(),a=>a.toString(16).padStart(2,"0"));class qt{static makeHexColor(t,e,i){return`#${Sp[t]}${Sp[e]}${Sp[i]}`}static domMatrixToTransform(t){return[t.a,t.b,t.c,t.d,t.e,t.f]}static scaleMinMax(t,e){let i;t[0]?(t[0]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[0],e[2]*=t[0],t[3]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[3],e[3]*=t[3]):(i=e[0],e[0]=e[1],e[1]=i,i=e[2],e[2]=e[3],e[3]=i,t[1]<0&&(i=e[1],e[1]=e[3],e[3]=i),e[1]*=t[1],e[3]*=t[1],t[2]<0&&(i=e[0],e[0]=e[2],e[2]=i),e[0]*=t[2],e[2]*=t[2]),e[0]+=t[4],e[1]+=t[5],e[2]+=t[4],e[3]+=t[5]}static transform(t,e){return[t[0]*e[0]+t[2]*e[1],t[1]*e[0]+t[3]*e[1],t[0]*e[2]+t[2]*e[3],t[1]*e[2]+t[3]*e[3],t[0]*e[4]+t[2]*e[5]+t[4],t[1]*e[4]+t[3]*e[5]+t[5]]}static multiplyByDOMMatrix(t,e){return[t[0]*e.a+t[2]*e.b,t[1]*e.a+t[3]*e.b,t[0]*e.c+t[2]*e.d,t[1]*e.c+t[3]*e.d,t[0]*e.e+t[2]*e.f+t[4],t[1]*e.e+t[3]*e.f+t[5]]}static applyTransform(t,e,i=0){const r=t[i],l=t[i+1];t[i]=r*e[0]+l*e[2]+e[4],t[i+1]=r*e[1]+l*e[3]+e[5]}static applyTransformToBezier(t,e,i=0){const r=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5];for(let p=0;p<6;p+=2){const y=t[i+p],w=t[i+p+1];t[i+p]=y*r+w*c+d,t[i+p+1]=y*l+w*u+f}}static applyInverseTransform(t,e){const i=t[0],r=t[1],l=e[0]*e[3]-e[1]*e[2];t[0]=(i*e[3]-r*e[2]+e[2]*e[5]-e[4]*e[3])/l,t[1]=(-i*e[1]+r*e[0]+e[4]*e[1]-e[5]*e[0])/l}static axialAlignedBoundingBox(t,e,i){const r=e[0],l=e[1],c=e[2],u=e[3],d=e[4],f=e[5],p=t[0],y=t[1],w=t[2],A=t[3];let _=r*p+d,S=_,C=r*w+d,M=C,k=u*y+f,L=k,j=u*A+f,F=j;if(l!==0||c!==0){const z=l*p,H=l*w,ut=c*y,ft=c*A;_+=ut,M+=ut,C+=ft,S+=ft,k+=z,F+=z,j+=H,L+=H}i[0]=Math.min(i[0],_,C,S,M),i[1]=Math.min(i[1],k,j,L,F),i[2]=Math.max(i[2],_,C,S,M),i[3]=Math.max(i[3],k,j,L,F)}static inverseTransform(t){const e=t[0]*t[3]-t[1]*t[2];return[t[3]/e,-t[1]/e,-t[2]/e,t[0]/e,(t[2]*t[5]-t[4]*t[3])/e,(t[4]*t[1]-t[5]*t[0])/e]}static singularValueDecompose2dScale(t,e){const i=t[0],r=t[1],l=t[2],c=t[3],u=i**2+r**2,d=i*l+r*c,f=l**2+c**2,p=(u+f)/2,y=Math.sqrt(p**2-(u*f-d**2));e[0]=Math.sqrt(p+y||1),e[1]=Math.sqrt(p-y||1)}static normalizeRect(t){const e=t.slice(0);return t[0]>t[2]&&(e[0]=t[2],e[2]=t[0]),t[1]>t[3]&&(e[1]=t[3],e[3]=t[1]),e}static intersect(t,e){const i=Math.max(Math.min(t[0],t[2]),Math.min(e[0],e[2])),r=Math.min(Math.max(t[0],t[2]),Math.max(e[0],e[2]));if(i>r)return null;const l=Math.max(Math.min(t[1],t[3]),Math.min(e[1],e[3])),c=Math.min(Math.max(t[1],t[3]),Math.max(e[1],e[3]));return l>c?null:[i,l,r,c]}static pointBoundingBox(t,e,i){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}static rectBoundingBox(t,e,i,r,l){l[0]=Math.min(l[0],t,i),l[1]=Math.min(l[1],e,r),l[2]=Math.max(l[2],t,i),l[3]=Math.max(l[3],e,r)}static#t(t,e,i,r,l,c,u,d,f,p){if(f<=0||f>=1)return;const y=1-f,w=f*f,A=w*f,_=y*(y*(y*t+3*f*e)+3*w*i)+A*r,S=y*(y*(y*l+3*f*c)+3*w*u)+A*d;p[0]=Math.min(p[0],_),p[1]=Math.min(p[1],S),p[2]=Math.max(p[2],_),p[3]=Math.max(p[3],S)}static#e(t,e,i,r,l,c,u,d,f,p,y,w){if(Math.abs(f)<1e-12){Math.abs(p)>=1e-12&&this.#t(t,e,i,r,l,c,u,d,-y/p,w);return}const A=p**2-4*y*f;if(A<0)return;const _=Math.sqrt(A),S=2*f;this.#t(t,e,i,r,l,c,u,d,(-p+_)/S,w),this.#t(t,e,i,r,l,c,u,d,(-p-_)/S,w)}static bezierBoundingBox(t,e,i,r,l,c,u,d,f){f[0]=Math.min(f[0],t,u),f[1]=Math.min(f[1],e,d),f[2]=Math.max(f[2],t,u),f[3]=Math.max(f[3],e,d),this.#e(t,i,l,u,e,r,c,d,3*(-t+3*(i-l)+u),6*(t-2*i+l),3*(i-t),f),this.#e(t,i,l,u,e,r,c,d,3*(-e+3*(r-c)+d),6*(e-2*r+c),3*(r-e),f)}}function LC(a){return decodeURIComponent(escape(a))}let Ep=null,Xv=null;function PC(a){return Ep||(Ep=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Xv=new Map([["","t"]])),a.replaceAll(Ep,(t,e,i)=>e?e.normalize("NFKC"):Xv.get(i))}function Cw(){if(typeof crypto.randomUUID=="function")return crypto.randomUUID();const a=new Uint8Array(32);return crypto.getRandomValues(a),DC(a)}const Jo="pdfjs_internal_id_";function BC(a,t,e){if(!Array.isArray(e)||e.length<2)return!1;const[i,r,...l]=e;if(!a(i)&&!Number.isInteger(i)||!t(r))return!1;const c=l.length;let u=!0;switch(r.name){case"XYZ":if(c<2||c>3)return!1;break;case"Fit":case"FitB":return c===0;case"FitH":case"FitBH":case"FitV":case"FitBV":if(c>1)return!1;break;case"FitR":if(c!==4)return!1;u=!1;break;default:return!1}for(const d of l)if(!(typeof d=="number"||u&&d===null))return!1;return!0}function Fn(a,t,e){return Math.min(Math.max(a,t),e)}typeof Math.sumPrecise!="function"&&(Math.sumPrecise=function(a){return a.reduce((t,e)=>t+e,0)});class Bc{static textContent(t){const e=[],i={items:e,styles:Object.create(null)};function r(l){if(!l)return;let c=null;const u=l.name;if(u==="#text")c=l.value;else if(Bc.shouldBuildText(u))l?.attributes?.textContent?c=l.attributes.textContent:l.value&&(c=l.value);else return;if(c!==null&&e.push({str:c}),!!l.children)for(const d of l.children)r(d)}return r(t),i}static shouldBuildText(t){return!(t==="textarea"||t==="input"||t==="option"||t==="select")}}class Tw{static setupStorage(t,e,i,r,l){const c=r.getValue(e,{value:null});switch(i.name){case"textarea":if(c.value!==null&&(t.textContent=c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})});break;case"input":if(i.attributes.type==="radio"||i.attributes.type==="checkbox"){if(c.value===i.attributes.xfaOn?t.setAttribute("checked",!0):c.value===i.attributes.xfaOff&&t.removeAttribute("checked"),l==="print")break;t.addEventListener("change",u=>{r.setValue(e,{value:u.target.checked?u.target.getAttribute("xfaOn"):u.target.getAttribute("xfaOff")})})}else{if(c.value!==null&&t.setAttribute("value",c.value),l==="print")break;t.addEventListener("input",u=>{r.setValue(e,{value:u.target.value})})}break;case"select":if(c.value!==null){t.setAttribute("value",c.value);for(const u of i.children)u.attributes.value===c.value?u.attributes.selected=!0:u.attributes.hasOwnProperty("selected")&&delete u.attributes.selected}t.addEventListener("input",u=>{const d=u.target.options,f=d.selectedIndex===-1?"":d[d.selectedIndex].value;r.setValue(e,{value:f})});break}}static setAttributes({html:t,element:e,storage:i=null,intent:r,linkService:l}){const{attributes:c}=e,u=t instanceof HTMLAnchorElement;c.type==="radio"&&(c.name=`${c.name}-${r}`);for(const[d,f]of Object.entries(c))if(f!=null)switch(d){case"class":f.length&&t.setAttribute(d,f.join(" "));break;case"dataId":break;case"id":t.setAttribute("data-element-id",f);break;case"style":Object.assign(t.style,f);break;case"textContent":t.textContent=f;break;default:(!u||d!=="href"&&d!=="newWindow")&&t.setAttribute(d,f)}u&&l.addLinkAttributes(t,c.href,c.newWindow),i&&c.dataId&&this.setupStorage(t,c.dataId,e,i)}static render(t){const e=t.annotationStorage,i=t.linkService,r=t.xfaHtml,l=t.intent||"display",c=document.createElement(r.name);r.attributes&&this.setAttributes({html:c,element:r,intent:l,linkService:i});const u=l!=="richText",d=t.div;if(d.append(c),t.viewport){const y=`matrix(${t.viewport.transform.join(",")})`;d.style.transform=y}u&&d.setAttribute("class","xfaLayer xfaFont");const f=[];if(r.children.length===0){if(r.value){const y=document.createTextNode(r.value);c.append(y),u&&Bc.shouldBuildText(r.name)&&f.push(y)}return{textDivs:f}}const p=[[r,-1,c]];for(;p.length>0;){const[y,w,A]=p.at(-1);if(w+1===y.children.length){p.pop();continue}const _=y.children[++p.at(-1)[1]];if(_===null)continue;const{name:S}=_;if(S==="#text"){const M=document.createTextNode(_.value);f.push(M),A.append(M);continue}const C=_?.attributes?.xmlns?document.createElementNS(_.attributes.xmlns,S):document.createElement(S);if(A.append(C),_.attributes&&this.setAttributes({html:C,element:_,storage:e,intent:l,linkService:i}),_.children?.length>0)p.push([_,-1,C]);else if(_.value){const M=document.createTextNode(_.value);u&&Bc.shouldBuildText(S)&&f.push(M),C.append(M)}}for(const y of d.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))y.setAttribute("readOnly",!0);return{textDivs:f}}static update(t){const e=`matrix(${t.viewport.transform.join(",")})`;t.div.style.transform=e,t.div.hidden=!1}}const sr="http://www.w3.org/2000/svg";class cl{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}async function Vc(a,t="text"){if(Tc(a,document.baseURI)){const e=await fetch(a);if(!e.ok)throw new Error(e.statusText);switch(t){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"json":return e.json()}return e.text()}return new Promise((e,i)=>{const r=new XMLHttpRequest;r.open("GET",a,!0),r.responseType=t,r.onreadystatechange=()=>{if(r.readyState===XMLHttpRequest.DONE){if(r.status===200||r.status===0){switch(t){case"arraybuffer":case"blob":case"json":e(r.response);return}e(r.responseText);return}i(new Error(r.statusText))}},r.send(null)})}class Kc{constructor({viewBox:t,userUnit:e,scale:i,rotation:r,offsetX:l=0,offsetY:c=0,dontFlip:u=!1}){this.viewBox=t,this.userUnit=e,this.scale=i,this.rotation=r,this.offsetX=l,this.offsetY=c,i*=e;const d=(t[2]+t[0])/2,f=(t[3]+t[1])/2;let p,y,w,A;switch(r%=360,r<0&&(r+=360),r){case 180:p=-1,y=0,w=0,A=1;break;case 90:p=0,y=1,w=1,A=0;break;case 270:p=0,y=-1,w=-1,A=0;break;case 0:p=1,y=0,w=0,A=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}u&&(w=-w,A=-A);let _,S,C,M;p===0?(_=Math.abs(f-t[1])*i+l,S=Math.abs(d-t[0])*i+c,C=(t[3]-t[1])*i,M=(t[2]-t[0])*i):(_=Math.abs(d-t[0])*i+l,S=Math.abs(f-t[1])*i+c,C=(t[2]-t[0])*i,M=(t[3]-t[1])*i),this.transform=[p*i,y*i,w*i,A*i,_-p*i*d-w*i*f,S-y*i*d-A*i*f],this.width=C,this.height=M}get rawDims(){const t=this.viewBox;return ie(this,"rawDims",{pageWidth:t[2]-t[0],pageHeight:t[3]-t[1],pageX:t[0],pageY:t[1]})}clone({scale:t=this.scale,rotation:e=this.rotation,offsetX:i=this.offsetX,offsetY:r=this.offsetY,dontFlip:l=!1}={}){return new Kc({viewBox:this.viewBox.slice(),userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:l})}convertToViewportPoint(t,e){const i=[t,e];return qt.applyTransform(i,this.transform),i}convertToViewportRectangle(t){const e=[t[0],t[1]];qt.applyTransform(e,this.transform);const i=[t[2],t[3]];return qt.applyTransform(i,this.transform),[e[0],e[1],i[0],i[1]]}convertToPdfPoint(t,e){const i=[t,e];return qt.applyInverseTransform(i,this.transform),i}}class Nm extends Za{constructor(t,e=0){super(t,"RenderingCancelledException"),this.extraDelay=e}}function rd(a){const t=a.length;let e=0;for(;e<t&&a[e].trim()==="";)e++;return a.substring(e,e+5).toLowerCase()==="data:"}function km(a){return typeof a=="string"&&/\.pdf$/i.test(a)}function jC(a){return[a]=a.split(/[#?]/,1),a.substring(a.lastIndexOf("/")+1)}function FC(a,t="document.pdf"){if(typeof a!="string")return t;if(rd(a))return ne('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),t;const i=(u=>{try{return new URL(u)}catch{try{return new URL(decodeURIComponent(u))}catch{try{return new URL(u,"https://foo.bar")}catch{try{return new URL(decodeURIComponent(u),"https://foo.bar")}catch{return null}}}}})(a);if(!i)return t;const r=u=>{try{let d=decodeURIComponent(u);return d.includes("/")?(d=d.split("/").at(-1),d.test(/^\.pdf$/i)?d:u):d}catch{return u}},l=/\.pdf$/i,c=i.pathname.split("/").at(-1);if(l.test(c))return r(c);if(i.searchParams.size>0){const u=Array.from(i.searchParams.values()).reverse();for(const f of u)if(l.test(f))return r(f);const d=Array.from(i.searchParams.keys()).reverse();for(const f of d)if(l.test(f))return r(f)}if(i.hash){const d=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i.exec(i.hash);if(d)return r(d[0])}return t}class Yv{started=Object.create(null);times=[];time(t){t in this.started&&ne(`Timer is already running for ${t}`),this.started[t]=Date.now()}timeEnd(t){t in this.started||ne(`Timer has not been started for ${t}`),this.times.push({name:t,start:this.started[t],end:Date.now()}),delete this.started[t]}toString(){const t=[];let e=0;for(const{name:i}of this.times)e=Math.max(i.length,e);for(const{name:i,start:r,end:l}of this.times)t.push(`${i.padEnd(e)} ${l-r}ms
`);return t.join("")}}function Tc(a,t){const e=t?URL.parse(a,t):URL.parse(a);return e?.protocol==="http:"||e?.protocol==="https:"}function $i(a){a.preventDefault()}function en(a){a.preventDefault(),a.stopPropagation()}function IC(a){console.log("Deprecated API usage: "+a)}class Wp{static#t;static toDateObject(t){if(t instanceof Date)return t;if(!t||typeof t!="string")return null;this.#t||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const e=this.#t.exec(t);if(!e)return null;const i=parseInt(e[1],10);let r=parseInt(e[2],10);r=r>=1&&r<=12?r-1:0;let l=parseInt(e[3],10);l=l>=1&&l<=31?l:1;let c=parseInt(e[4],10);c=c>=0&&c<=23?c:0;let u=parseInt(e[5],10);u=u>=0&&u<=59?u:0;let d=parseInt(e[6],10);d=d>=0&&d<=59?d:0;const f=e[7]||"Z";let p=parseInt(e[8],10);p=p>=0&&p<=23?p:0;let y=parseInt(e[9],10)||0;return y=y>=0&&y<=59?y:0,f==="-"?(c+=p,u+=y):f==="+"&&(c-=p,u-=y),new Date(Date.UTC(i,r,l,c,u,d))}}function UC(a,{scale:t=1,rotation:e=0}){const{width:i,height:r}=a.attributes.style,l=[0,0,parseInt(i),parseInt(r)];return new Kc({viewBox:l,userUnit:1,scale:t,rotation:e})}function Xc(a){if(a.startsWith("#")){const t=parseInt(a.slice(1),16);return[(t&16711680)>>16,(t&65280)>>8,t&255]}return a.startsWith("rgb(")?a.slice(4,-1).split(",").map(t=>parseInt(t)):a.startsWith("rgba(")?a.slice(5,-1).split(",").map(t=>parseInt(t)).slice(0,3):(ne(`Not a valid color format: "${a}"`),[0,0,0])}function zC(a){const t=document.createElement("span");t.style.visibility="hidden",t.style.colorScheme="only light",document.body.append(t);for(const e of a.keys()){t.style.color=e;const i=window.getComputedStyle(t).color;a.set(e,Xc(i))}t.remove()}function Qe(a){const{a:t,b:e,c:i,d:r,e:l,f:c}=a.getTransform();return[t,e,i,r,l,c]}function ws(a){const{a:t,b:e,c:i,d:r,e:l,f:c}=a.getTransform().invertSelf();return[t,e,i,r,l,c]}function Qa(a,t,e=!1,i=!0){if(t instanceof Kc){const{pageWidth:r,pageHeight:l}=t.rawDims,{style:c}=a,u=xn.isCSSRoundSupported,d=`var(--total-scale-factor) * ${r}px`,f=`var(--total-scale-factor) * ${l}px`,p=u?`round(down, ${d}, var(--scale-round-x))`:`calc(${d})`,y=u?`round(down, ${f}, var(--scale-round-y))`:`calc(${f})`;!e||t.rotation%180===0?(c.width=p,c.height=y):(c.width=y,c.height=p)}i&&a.setAttribute("data-main-rotation",t.rotation)}class Ts{constructor(){const{pixelRatio:t}=Ts;this.sx=t,this.sy=t}get scaled(){return this.sx!==1||this.sy!==1}get symmetric(){return this.sx===this.sy}limitCanvas(t,e,i,r,l=-1){let c=1/0,u=1/0,d=1/0;i=Ts.capPixels(i,l),i>0&&(c=Math.sqrt(i/(t*e))),r!==-1&&(u=r/t,d=r/e);const f=Math.min(c,u,d);return this.sx>f||this.sy>f?(this.sx=f,this.sy=f,!0):!1}static get pixelRatio(){return globalThis.devicePixelRatio||1}static capPixels(t,e){if(e>=0){const i=Math.ceil(window.screen.availWidth*window.screen.availHeight*this.pixelRatio**2*(1+e/100));return t>0?Math.min(t,i):i}return t}}const Zp=["image/apng","image/avif","image/bmp","image/gif","image/jpeg","image/png","image/svg+xml","image/webp","image/x-icon"];class HC{static get isDarkMode(){return ie(this,"isDarkMode",!!window?.matchMedia?.("(prefers-color-scheme: dark)").matches)}}class qC{static get commentForegroundColor(){const t=document.createElement("span");t.classList.add("comment","sidebar");const{style:e}=t;e.width=e.height="0",e.display="none",e.color="var(--comment-fg-color)",document.body.append(t);const{color:i}=window.getComputedStyle(t);return t.remove(),ie(this,"commentForegroundColor",Xc(i))}}function GC(a,t,e,i){i=Math.min(Math.max(i??1,0),1);const r=255*(1-i);return a=Math.round(a*i+r),t=Math.round(t*i+r),e=Math.round(e*i+r),[a,t,e]}function Qv(a,t){const e=a[0]/255,i=a[1]/255,r=a[2]/255,l=Math.max(e,i,r),c=Math.min(e,i,r),u=(l+c)/2;if(l===c)t[0]=t[1]=0;else{const d=l-c;switch(t[1]=u<.5?d/(l+c):d/(2-l-c),l){case e:t[0]=((i-r)/d+(i<r?6:0))*60;break;case i:t[0]=((r-e)/d+2)*60;break;case r:t[0]=((e-i)/d+4)*60;break}}t[2]=u}function Jp(a,t){const e=a[0],i=a[1],r=a[2],l=(1-Math.abs(2*r-1))*i,c=l*(1-Math.abs(e/60%2-1)),u=r-l/2;switch(Math.floor(e/60)){case 0:t[0]=l+u,t[1]=c+u,t[2]=u;break;case 1:t[0]=c+u,t[1]=l+u,t[2]=u;break;case 2:t[0]=u,t[1]=l+u,t[2]=c+u;break;case 3:t[0]=u,t[1]=c+u,t[2]=l+u;break;case 4:t[0]=c+u,t[1]=u,t[2]=l+u;break;case 5:case 6:t[0]=l+u,t[1]=u,t[2]=c+u;break}}function Wv(a){return a<=.03928?a/12.92:((a+.055)/1.055)**2.4}function Zv(a,t,e){Jp(a,e),e.map(Wv);const i=.2126*e[0]+.7152*e[1]+.0722*e[2];Jp(t,e),e.map(Wv);const r=.2126*e[0]+.7152*e[1]+.0722*e[2];return i>r?(i+.05)/(r+.05):(r+.05)/(i+.05)}const Jv=new Map;function $C(a,t){const e=a[0]+a[1]*256+a[2]*65536+t[0]*16777216+t[1]*4294967296+t[2]*1099511627776;let i=Jv.get(e);if(i)return i;const r=new Float32Array(9),l=r.subarray(0,3),c=r.subarray(3,6);Qv(a,c);const u=r.subarray(6,9);Qv(t,u);const d=u[2]<.5,f=d?12:4.5;if(c[2]=d?Math.sqrt(c[2]):1-Math.sqrt(1-c[2]),Zv(c,u,l)<f){let p,y;d?(p=c[2],y=1):(p=0,y=c[2]);const w=.005;for(;y-p>w;){const A=c[2]=(p+y)/2;d===Zv(c,u,l)<f?p=A:y=A}c[2]=d?y:p}return Jp(c,l),i=qt.makeHexColor(Math.round(l[0]*255),Math.round(l[1]*255),Math.round(l[2]*255)),Jv.set(e,i),i}function Rw({html:a,dir:t,className:e},i){const r=document.createDocumentFragment();if(typeof a=="string"){const l=document.createElement("p");l.dir=t||"auto";const c=a.split(/(?:\r\n?|\n)/);for(let u=0,d=c.length;u<d;++u){const f=c[u];l.append(document.createTextNode(f)),u<d-1&&l.append(document.createElement("br"))}r.append(l)}else Tw.render({xfaHtml:a,div:r,intent:"richText"});r.firstElementChild.classList.add("richText",e),i.append(r)}function Mw(a){const t=new Path2D;if(!a)return t;for(let e=0,i=a.length;e<i;)switch(a[e++]){case Ac.moveTo:t.moveTo(a[e++],a[e++]);break;case Ac.lineTo:t.lineTo(a[e++],a[e++]);break;case Ac.curveTo:t.bezierCurveTo(a[e++],a[e++],a[e++],a[e++],a[e++],a[e++]);break;case Ac.quadraticCurveTo:t.quadraticCurveTo(a[e++],a[e++],a[e++],a[e++]);break;case Ac.closePath:t.closePath();break;default:ne(`Unrecognized drawing path operator: ${a[e-1]}`);break}return t}class Ce{static#t=null;static#e=null;static#i=null;static#n=0;static#s=[];get pagesNumber(){return Ce.#n}set pagesNumber(t){Ce.#n!==t&&(Ce.#n=t,t===0&&(Ce.#e=null,Ce.#t=null))}addListener(t){Ce.#s.push(t)}removeListener(t){const e=Ce.#s.indexOf(t);e>=0&&Ce.#s.splice(e,1)}#a(){for(const t of Ce.#s)t()}#r(t){if(Ce.#e)return;const e=Ce.#n,i=new Uint32Array(3*e),r=Ce.#e=i.subarray(0,e),l=Ce.#t=i.subarray(e,2*e);if(t)for(let c=0;c<e;c++)r[c]=l[c]=c+1;Ce.#i=i.subarray(2*e)}movePages(t,e,i){this.#r(!0);const r=Ce.#e,l=Ce.#t;Ce.#i.set(l);const c=e.length,u=new Uint32Array(c);let d=0;for(let A=0;A<c;A++){const _=e[A]-1;u[A]=r[_],_<i&&(d+=1)}const f=Ce.#n;let p=i-d;const y=f-c;p=Fn(p,0,y);for(let A=0,_=0;A<f;A++)t.has(A+1)||(r[_++]=r[A]);r.copyWithin(p+c,p,y),r.set(u,p);let w=!1;for(let A=0,_=f;A<_;A++){const S=r[A];w||=S!==A+1,l[S-1]=A+1}this.#a(),w||(this.pagesNumber=0)}hasBeenAltered(){return Ce.#e!==null}getPageMappingForSaving(){return{pageIndices:Ce.#t?Ce.#t.map(t=>t-1):null}}getPrevPageNumber(t){return Ce.#i[Ce.#e[t-1]-1]}getPageNumber(t){return Ce.#t?.[t-1]??t}getPageId(t){return Ce.#e?.[t-1]??t}static get instance(){return ie(this,"instance",new Ce)}getMapping(){return Ce.#e.subarray(0,this.pagesNumber)}}class Oc{#t=null;#e=null;#i;#n=null;#s=null;#a=null;#r=null;#o=null;static#c=null;constructor(t){this.#i=t,Oc.#c||=Object.freeze({freetext:"pdfjs-editor-remove-freetext-button",highlight:"pdfjs-editor-remove-highlight-button",ink:"pdfjs-editor-remove-ink-button",stamp:"pdfjs-editor-remove-stamp-button",signature:"pdfjs-editor-remove-signature-button"})}render(){const t=this.#t=document.createElement("div");t.classList.add("editToolbar","hidden"),t.setAttribute("role","toolbar");const e=this.#i._uiManager._signal;e instanceof AbortSignal&&!e.aborted&&(t.addEventListener("contextmenu",$i,{signal:e}),t.addEventListener("pointerdown",Oc.#l,{signal:e}));const i=this.#n=document.createElement("div");i.className="buttons",t.append(i);const r=this.#i.toolbarPosition;if(r){const{style:l}=t,c=this.#i._uiManager.direction==="ltr"?1-r[0]:r[0];l.insetInlineEnd=`${100*c}%`,l.top=`calc(${100*r[1]}% + var(--editor-toolbar-vert-offset))`}return t}get div(){return this.#t}static#l(t){t.stopPropagation()}#d(t){this.#i._focusEventsAllowed=!1,en(t)}#h(t){this.#i._focusEventsAllowed=!0,en(t)}#f(t){const e=this.#i._uiManager._signal;return!(e instanceof AbortSignal)||e.aborted?!1:(t.addEventListener("focusin",this.#d.bind(this),{capture:!0,signal:e}),t.addEventListener("focusout",this.#h.bind(this),{capture:!0,signal:e}),t.addEventListener("contextmenu",$i,{signal:e}),!0)}hide(){this.#t.classList.add("hidden"),this.#e?.hideDropdown()}show(){this.#t.classList.remove("hidden"),this.#s?.shown(),this.#a?.shown()}addDeleteButton(){const{editorType:t,_uiManager:e}=this.#i,i=document.createElement("button");i.classList.add("basic","deleteButton"),i.tabIndex=0,i.setAttribute("data-l10n-id",Oc.#c[t]),this.#f(i)&&i.addEventListener("click",r=>{e.delete()},{signal:e._signal}),this.#n.append(i)}get#g(){const t=document.createElement("div");return t.className="divider",t}async addAltText(t){const e=await t.render();this.#f(e),this.#n.append(e,this.#g),this.#s=t}addComment(t,e=null){if(this.#a)return;const i=t.renderForToolbar();if(!i)return;this.#f(i);const r=this.#r=this.#g;e?(this.#n.insertBefore(i,e),this.#n.insertBefore(r,e)):this.#n.append(i,r),this.#a=t,t.toolbar=this}addColorPicker(t){if(this.#e)return;this.#e=t;const e=t.renderButton();this.#f(e),this.#n.append(e,this.#g)}async addEditSignatureButton(t){const e=this.#o=await t.renderEditButton(this.#i);this.#f(e),this.#n.append(e,this.#g)}removeButton(t){t==="comment"&&(this.#a?.removeToolbarCommentButton(),this.#a=null,this.#r?.remove(),this.#r=null)}async addButton(t,e){switch(t){case"colorPicker":e&&this.addColorPicker(e);break;case"altText":e&&await this.addAltText(e);break;case"editSignature":e&&await this.addEditSignatureButton(e);break;case"delete":this.addDeleteButton();break;case"comment":e&&this.addComment(e);break}}async addButtonBefore(t,e,i){if(!e&&t==="comment")return;const r=this.#n.querySelector(i);r&&t==="comment"&&this.addComment(e,r)}updateEditSignatureButton(t){this.#o&&(this.#o.title=t)}remove(){this.#t.remove(),this.#e?.destroy(),this.#e=null}}class VC{#t=null;#e=null;#i;constructor(t){this.#i=t}#n(){const t=this.#e=document.createElement("div");t.className="editToolbar",t.setAttribute("role","toolbar");const e=this.#i._signal;e instanceof AbortSignal&&!e.aborted&&t.addEventListener("contextmenu",$i,{signal:e});const i=this.#t=document.createElement("div");return i.className="buttons",t.append(i),this.#i.hasCommentManager()&&this.#a("commentButton","pdfjs-comment-floating-button","pdfjs-comment-floating-button-label",()=>{this.#i.commentSelection("floating_button")}),this.#a("highlightButton","pdfjs-highlight-floating-button1","pdfjs-highlight-floating-button-label",()=>{this.#i.highlightSelection("floating_button")}),t}#s(t,e){let i=0,r=0;for(const l of t){const c=l.y+l.height;if(c<i)continue;const u=l.x+(e?l.width:0);if(c>i){r=u,i=c;continue}e?u>r&&(r=u):u<r&&(r=u)}return[e?1-r:r,i]}show(t,e,i){const[r,l]=this.#s(e,i),{style:c}=this.#e||=this.#n();t.append(this.#e),c.insetInlineEnd=`${100*r}%`,c.top=`calc(${100*l}% + var(--editor-toolbar-vert-offset))`}hide(){this.#e.remove()}#a(t,e,i,r){const l=document.createElement("button");l.classList.add("basic",t),l.tabIndex=0,l.setAttribute("data-l10n-id",e);const c=document.createElement("span");l.append(c),c.className="visuallyHidden",c.setAttribute("data-l10n-id",i);const u=this.#i._signal;u instanceof AbortSignal&&!u.aborted&&(l.addEventListener("contextmenu",$i,{signal:u}),l.addEventListener("click",r,{signal:u})),this.#t.append(l)}}function Dw(a,t,e){for(const i of e)t.addEventListener(i,a[i].bind(a))}class Te{static#t=NaN;static#e=null;static#i=NaN;static#n=null;static initializeAndAddPointerId(t){(Te.#e||=new Set).add(t)}static setPointer(t,e){Te.#t||=e,Te.#n??=t}static setTimeStamp(t){Te.#i=t}static isSamePointerId(t){return Te.#t===t}static isSamePointerIdOrRemove(t){return Te.#t===t?!0:(Te.#e?.delete(t),!1)}static isSamePointerType(t){return Te.#n===t}static isInitializedAndDifferentPointerType(t){return Te.#n!==null&&!Te.isSamePointerType(t)}static isSameTimeStamp(t){return Te.#i===t}static isUsingMultiplePointers(){return Te.#e?.size>=1}static clearPointerType(){Te.#n=null}static clearPointerIds(){Te.#t=NaN,Te.#e=null}static clearTimeStamp(){Te.#i=NaN}}class KC{#t=0;get id(){return`${Lc}${this.#t++}`}}class Lm{#t=Cw();#e=0;#i=null;static get _isSVGFittingCanvas(){const t='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',i=new OffscreenCanvas(1,3).getContext("2d",{willReadFrequently:!0}),r=new Image;r.src=t;const l=r.decode().then(()=>(i.drawImage(r,0,0,1,1,0,0,1,3),new Uint32Array(i.getImageData(0,0,1,1).data.buffer)[0]===0));return ie(this,"_isSVGFittingCanvas",l)}async#n(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i===null)return null;if(i?.bitmap)return i.refCounter+=1,i;try{i||={bitmap:null,id:`image_${this.#t}_${this.#e++}`,refCounter:0,isSvg:!1};let r;if(typeof e=="string"?(i.url=e,r=await Vc(e,"blob")):e instanceof File?r=i.file=e:e instanceof Blob&&(r=e),r.type==="image/svg+xml"){const l=Lm._isSVGFittingCanvas,c=new FileReader,u=new Image,d=new Promise((f,p)=>{u.onload=()=>{i.bitmap=u,i.isSvg=!0,f()},c.onload=async()=>{const y=i.svgUrl=c.result;u.src=await l?`${y}#svgView(preserveAspectRatio(none))`:y},u.onerror=c.onerror=p});c.readAsDataURL(r),await d}else i.bitmap=await createImageBitmap(r);i.refCounter=1}catch(r){ne(r),i=null}return this.#i.set(t,i),i&&this.#i.set(i.id,i),i}async getFromFile(t){const{lastModified:e,name:i,size:r,type:l}=t;return this.#n(`${e}_${i}_${r}_${l}`,t)}async getFromUrl(t){return this.#n(t,t)}async getFromBlob(t,e){const i=await e;return this.#n(t,i)}async getFromId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e)return null;if(e.bitmap)return e.refCounter+=1,e;if(e.file)return this.getFromFile(e.file);if(e.blobPromise){const{blobPromise:i}=e;return delete e.blobPromise,this.getFromBlob(e.id,i)}return this.getFromUrl(e.url)}getFromCanvas(t,e){this.#i||=new Map;let i=this.#i.get(t);if(i?.bitmap)return i.refCounter+=1,i;const r=new OffscreenCanvas(e.width,e.height);return r.getContext("2d").drawImage(e,0,0),i={bitmap:r.transferToImageBitmap(),id:`image_${this.#t}_${this.#e++}`,refCounter:1,isSvg:!1},this.#i.set(t,i),this.#i.set(i.id,i),i}getSvgUrl(t){const e=this.#i.get(t);return e?.isSvg?e.svgUrl:null}deleteId(t){this.#i||=new Map;const e=this.#i.get(t);if(!e||(e.refCounter-=1,e.refCounter!==0))return;const{bitmap:i}=e;if(!e.url&&!e.file){const r=new OffscreenCanvas(i.width,i.height);r.getContext("bitmaprenderer").transferFromImageBitmap(i),e.blobPromise=r.convertToBlob()}i.close?.(),e.bitmap=null}isValidId(t){return t.startsWith(`image_${this.#t}_`)}}class XC{#t=[];#e=!1;#i;#n=-1;constructor(t=128){this.#i=t}add({cmd:t,undo:e,post:i,mustExec:r,type:l=NaN,overwriteIfSameType:c=!1,keepUndo:u=!1}){if(r&&t(),this.#e)return;const d={cmd:t,undo:e,post:i,type:l};if(this.#n===-1){this.#t.length>0&&(this.#t.length=0),this.#n=0,this.#t.push(d);return}if(c&&this.#t[this.#n].type===l){u&&(d.undo=this.#t[this.#n].undo),this.#t[this.#n]=d;return}const f=this.#n+1;f===this.#i?this.#t.splice(0,1):(this.#n=f,f<this.#t.length&&this.#t.splice(f)),this.#t.push(d)}undo(){if(this.#n===-1)return;this.#e=!0;const{undo:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1,this.#n-=1}redo(){if(this.#n<this.#t.length-1){this.#n+=1,this.#e=!0;const{cmd:t,post:e}=this.#t[this.#n];t(),e?.(),this.#e=!1}}hasSomethingToUndo(){return this.#n!==-1}hasSomethingToRedo(){return this.#n<this.#t.length-1}cleanType(t){if(this.#n!==-1){for(let e=this.#n;e>=0;e--)if(this.#t[e].type!==t){this.#t.splice(e+1,this.#n-e),this.#n=e;return}this.#t.length=0,this.#n=-1}}destroy(){this.#t=null}}class Yc{constructor(t){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:e}=xn.platform;for(const[i,r,l={}]of t)for(const c of i){const u=c.startsWith("mac+");e&&u?(this.callbacks.set(c.slice(4),{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1))):!e&&!u&&(this.callbacks.set(c,{callback:r,options:l}),this.allKeys.add(c.split("+").at(-1)))}}#t(t){t.altKey&&this.buffer.push("alt"),t.ctrlKey&&this.buffer.push("ctrl"),t.metaKey&&this.buffer.push("meta"),t.shiftKey&&this.buffer.push("shift"),this.buffer.push(t.key);const e=this.buffer.join("+");return this.buffer.length=0,e}exec(t,e){if(!this.allKeys.has(e.key))return;const i=this.callbacks.get(this.#t(e));if(!i)return;const{callback:r,options:{bubbles:l=!1,args:c=[],checker:u=null}}=i;u&&!u(t,e)||(r.bind(t,...c,e)(),l||en(e))}}class Pm{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const t=new Map([["CanvasText",null],["Canvas",null]]);return zC(t),ie(this,"_colors",t)}convert(t){const e=Xc(t);if(!window.matchMedia("(forced-colors: active)").matches)return e;for(const[i,r]of this._colors)if(r.every((l,c)=>l===e[c]))return Pm._colorsMapping.get(i);return e}getHexCode(t){const e=this._colors.get(t);return e?qt.makeHexColor(...e):t}}class Jr{#t=new AbortController;#e=null;#i=null;#n=new Map;#s=new Map;#a=null;#r=null;#o=null;#c=new XC;#l=null;#d=null;#h=null;#f=0;#g=new Set;#m=null;#u=null;#p=new Set;_editorUndoBar=null;#y=!1;#v=!1;#b=!1;#E=null;#S=null;#w=null;#C=null;#x=!1;#_=null;#D=new KC;#R=!1;#M=!1;#j=!1;#N=null;#L=null;#F=null;#P=null;#G=null;#T=ae.NONE;#A=new Set;#k=null;#I=null;#z=null;#K=null;#V=null;#X={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1,hasSelectedText:!1};#H=[0,0];#B=null;#$=null;#Z=null;#J=null;#U=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const t=Jr.prototype,e=c=>c.#$.contains(document.activeElement)&&document.activeElement.tagName!=="BUTTON"&&c.hasSomethingToControl(),i=(c,{target:u})=>{if(u instanceof HTMLInputElement){const{type:d}=u;return d!=="text"&&d!=="number"}return!0},r=this.TRANSLATE_SMALL,l=this.TRANSLATE_BIG;return ie(this,"_keyboardManager",new Yc([[["ctrl+a","mac+meta+a"],t.selectAll,{checker:i}],[["ctrl+z","mac+meta+z"],t.undo,{checker:i}],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],t.redo,{checker:i}],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],t.delete,{checker:i}],[["Enter","mac+Enter"],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#$.contains(u)&&!c.isEnterHandled}],[[" ","mac+ "],t.addNewEditorFromKeyboard,{checker:(c,{target:u})=>!(u instanceof HTMLButtonElement)&&c.#$.contains(document.activeElement)}],[["Escape","mac+Escape"],t.unselectAll],[["ArrowLeft","mac+ArrowLeft"],t.translateSelectedEditors,{args:[-r,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t.translateSelectedEditors,{args:[-l,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t.translateSelectedEditors,{args:[r,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t.translateSelectedEditors,{args:[l,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t.translateSelectedEditors,{args:[0,-r],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t.translateSelectedEditors,{args:[0,-l],checker:e}],[["ArrowDown","mac+ArrowDown"],t.translateSelectedEditors,{args:[0,r],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t.translateSelectedEditors,{args:[0,l],checker:e}]]))}constructor(t,e,i,r,l,c,u,d,f,p,y,w,A,_,S,C){const M=this._signal=this.#t.signal;this.#$=t,this.#Z=e,this.#J=i,this.#a=r,this.#l=l,this.#I=c,this.#V=d,this._eventBus=u,u._on("editingaction",this.onEditingAction.bind(this),{signal:M}),u._on("pagechanging",this.onPageChanging.bind(this),{signal:M}),u._on("scalechanging",this.onScaleChanging.bind(this),{signal:M}),u._on("rotationchanging",this.onRotationChanging.bind(this),{signal:M}),u._on("setpreference",this.onSetPreference.bind(this),{signal:M}),u._on("switchannotationeditorparams",k=>this.updateParams(k.type,k.value),{signal:M}),u._on("pagesedited",this.onPagesEdited.bind(this),{signal:M}),window.addEventListener("pointerdown",()=>{this.#M=!0},{capture:!0,signal:M}),window.addEventListener("pointerup",()=>{this.#M=!1},{capture:!0,signal:M}),this.#at(),this.#dt(),this.#et(),this.#r=d.annotationStorage,this.#E=d.filterFactory,this.#z=f,this.#C=p||null,this.#y=y,this.#v=w,this.#b=A,this.#G=_||null,this.viewParameters={realScale:cl.PDF_TO_CSS_UNITS,rotation:0},this.isShiftKeyDown=!1,this._editorUndoBar=S||null,this._supportsPinchToZoom=C!==!1,l?.setSidebarUiManager(this)}destroy(){this.#U?.resolve(),this.#U=null,this.#t?.abort(),this.#t=null,this._signal=null;for(const t of this.#s.values())t.destroy();this.#s.clear(),this.#n.clear(),this.#p.clear(),this.#P?.clear(),this.#e=null,this.#A.clear(),this.#c.destroy(),this.#a?.destroy(),this.#l?.destroy(),this.#I?.destroy(),this.#_?.hide(),this.#_=null,this.#F?.destroy(),this.#F=null,this.#i=null,this.#S&&(clearTimeout(this.#S),this.#S=null),this.#B&&(clearTimeout(this.#B),this.#B=null),this._editorUndoBar?.destroy(),this.#V=null}combinedSignal(t){return AbortSignal.any([this._signal,t.signal])}get mlManager(){return this.#G}get useNewAltTextFlow(){return this.#v}get useNewAltTextWhenAddingImage(){return this.#b}get hcmFilter(){return ie(this,"hcmFilter",this.#z?this.#E.addHCMFilter(this.#z.foreground,this.#z.background):"none")}get direction(){return ie(this,"direction",getComputedStyle(this.#$).direction)}get _highlightColors(){return ie(this,"_highlightColors",this.#C?new Map(this.#C.split(",").map(t=>(t=t.split("=").map(e=>e.trim()),t[1]=t[1].toUpperCase(),t))):null)}get highlightColors(){const{_highlightColors:t}=this;if(!t)return ie(this,"highlightColors",null);const e=new Map,i=!!this.#z;for(const[r,l]of t){const c=r.endsWith("_HCM");if(i&&c){e.set(r.replace("_HCM",""),l);continue}!i&&!c&&e.set(r,l)}return ie(this,"highlightColors",e)}get highlightColorNames(){return ie(this,"highlightColorNames",this.highlightColors?new Map(Array.from(this.highlightColors,t=>t.reverse())):null)}getNonHCMColor(t){if(!this._highlightColors)return t;const e=this.highlightColorNames.get(t);return this._highlightColors.get(e)||t}getNonHCMColorName(t){return this.highlightColorNames.get(t)||t}setCurrentDrawingSession(t){t?(this.unselectAll(),this.disableUserSelect(!0)):this.disableUserSelect(!1),this.#h=t}setMainHighlightColorPicker(t){this.#F=t}editAltText(t,e=!1){this.#a?.editAltText(this,t,e)}hasCommentManager(){return!!this.#l}editComment(t,e,i,r){this.#l?.showDialog(this,t,e,i,r)}selectComment(t,e){this.#s.get(t)?.getEditorByUID(e)?.toggleComment(!0,!0)}updateComment(t){this.#l?.updateComment(t.getData())}updatePopupColor(t){this.#l?.updatePopupColor(t)}removeComment(t){this.#l?.removeComments([t.uid])}deleteComment(t,e){const i=()=>{t.comment=e},r=()=>{this._editorUndoBar?.show(i,"comment"),this.toggleComment(null),t.comment=null};this.addCommands({cmd:r,undo:i,mustExec:!0})}toggleComment(t,e,i=void 0){this.#l?.toggleCommentPopup(t,e,i)}makeCommentColor(t,e){return t&&this.#l?.makeCommentColor(t,e)||null}getCommentDialogElement(){return this.#l?.dialogElement||null}async waitForEditorsRendered(t){if(this.#s.has(t-1))return;const{resolve:e,promise:i}=Promise.withResolvers(),r=l=>{l.pageNumber===t&&(this._eventBus._off("editorsrendered",r),e())};this._eventBus.on("editorsrendered",r),await i}getSignature(t){this.#I?.getSignature({uiManager:this,editor:t})}get signatureManager(){return this.#I}switchToMode(t,e){this._eventBus.on("annotationeditormodechanged",e,{once:!0,signal:this._signal}),this._eventBus.dispatch("showannotationeditorui",{source:this,mode:t})}setPreference(t,e){this._eventBus.dispatch("setpreference",{source:this,name:t,value:e})}onSetPreference({name:t,value:e}){t==="enableNewAltTextWhenAddingImage"&&(this.#b=e)}onPagesEdited({pagesMapper:t}){for(const r of this.#n.values())r.updatePageIndex(t.getPrevPageNumber(r.pageIndex+1)-1);const e=this.#s,i=this.#s=new Map;for(const[r,l]of e){const c=t.getPrevPageNumber(r+1)-1;if(c===-1){l.destroy();continue}i.set(c,l),l.updatePageIndex(c)}}onPageChanging({pageNumber:t}){this.#f=t-1}focusMainContainer(){this.#$.focus()}findParent(t,e){for(const i of this.#s.values()){const{x:r,y:l,width:c,height:u}=i.div.getBoundingClientRect();if(t>=r&&t<=r+c&&e>=l&&e<=l+u)return i}return null}disableUserSelect(t=!1){this.#Z.classList.toggle("noUserSelect",t)}addShouldRescale(t){this.#p.add(t)}removeShouldRescale(t){this.#p.delete(t)}onScaleChanging({scale:t}){this.commitOrRemove(),this.viewParameters.realScale=t*cl.PDF_TO_CSS_UNITS;for(const e of this.#p)e.onScaleChanging();this.#h?.onScaleChanging()}onRotationChanging({pagesRotation:t}){this.commitOrRemove(),this.viewParameters.rotation=t}#W({anchorNode:t}){return t.nodeType===Node.TEXT_NODE?t.parentElement:t}#tt(t){const{currentLayer:e}=this;if(e.hasTextLayer(t))return e;for(const i of this.#s.values())if(i.hasTextLayer(t))return i;return null}highlightSelection(t="",e=!1){const i=document.getSelection();if(!i||i.isCollapsed)return;const{anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u}=i,d=i.toString(),p=this.#W(i).closest(".textLayer"),y=this.getSelectionBoxes(p);if(!y)return;i.empty();const w=this.#tt(p),A=this.#T===ae.NONE,_=()=>{const S=w?.createAndAddNewEditor({x:0,y:0},!1,{methodOfCreation:t,boxes:y,anchorNode:r,anchorOffset:l,focusNode:c,focusOffset:u,text:d});A&&this.showAllEditors("highlight",!0,!0),e&&S?.editComment()};if(A){this.switchToMode(ae.HIGHLIGHT,_);return}_()}commentSelection(t=""){this.highlightSelection(t,!0)}#st(){const t=document.getSelection();if(!t||t.isCollapsed)return;const i=this.#W(t).closest(".textLayer"),r=this.getSelectionBoxes(i);r&&(this.#_||=new VC(this),this.#_.show(i,r,this.direction==="ltr"))}getAndRemoveDataFromAnnotationStorage(t){if(!this.#r)return null;const e=`${Lc}${t}`,i=this.#r.getRawValue(e);return i&&this.#r.remove(e),i}addToAnnotationStorage(t){!t.isEmpty()&&this.#r&&!this.#r.has(t.id)&&this.#r.setValue(t.id,t)}a11yAlert(t,e=null){const i=this.#J;i&&(i.setAttribute("data-l10n-id",t),e?i.setAttribute("data-l10n-args",JSON.stringify(e)):i.removeAttribute("data-l10n-args"))}#rt(){const t=document.getSelection();if(!t||t.isCollapsed){this.#k&&(this.#_?.hide(),this.#k=null,this.#O({hasSelectedText:!1}));return}const{anchorNode:e}=t;if(e===this.#k)return;const r=this.#W(t).closest(".textLayer");if(!r){this.#k&&(this.#_?.hide(),this.#k=null,this.#O({hasSelectedText:!1}));return}if(this.#_?.hide(),this.#k=e,this.#O({hasSelectedText:!0}),!(this.#T!==ae.HIGHLIGHT&&this.#T!==ae.NONE)&&(this.#T===ae.HIGHLIGHT&&this.showAllEditors("highlight",!0,!0),this.#x=this.isShiftKeyDown,!this.isShiftKeyDown)){const l=this.#T===ae.HIGHLIGHT?this.#tt(r):null;if(l?.toggleDrawing(),this.#M){const c=new AbortController,u=this.combinedSignal(c),d=f=>{f.type==="pointerup"&&f.button!==0||(c.abort(),l?.toggleDrawing(!0),f.type==="pointerup"&&this.#Y("main_toolbar"))};window.addEventListener("pointerup",d,{signal:u}),window.addEventListener("blur",d,{signal:u})}else l?.toggleDrawing(!0),this.#Y("main_toolbar")}}#Y(t=""){this.#T===ae.HIGHLIGHT?this.highlightSelection(t):this.#y&&this.#st()}#at(){document.addEventListener("selectionchange",this.#rt.bind(this),{signal:this._signal})}#ot(){if(this.#w)return;this.#w=new AbortController;const t=this.combinedSignal(this.#w);window.addEventListener("focus",this.focus.bind(this),{signal:t}),window.addEventListener("blur",this.blur.bind(this),{signal:t})}#lt(){this.#w?.abort(),this.#w=null}blur(){if(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")),!this.hasSelection)return;const{activeElement:t}=document;for(const e of this.#A)if(e.div.contains(t)){this.#L=[e,t],e._focusEventsAllowed=!1;break}}focus(){if(!this.#L)return;const[t,e]=this.#L;this.#L=null,e.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this._signal}),e.focus()}#et(){if(this.#N)return;this.#N=new AbortController;const t=this.combinedSignal(this.#N);window.addEventListener("keydown",this.keydown.bind(this),{signal:t}),window.addEventListener("keyup",this.keyup.bind(this),{signal:t})}#ct(){this.#N?.abort(),this.#N=null}#ut(){if(this.#d)return;this.#d=new AbortController;const t=this.combinedSignal(this.#d);document.addEventListener("copy",this.copy.bind(this),{signal:t}),document.addEventListener("cut",this.cut.bind(this),{signal:t}),document.addEventListener("paste",this.paste.bind(this),{signal:t})}#ht(){this.#d?.abort(),this.#d=null}#dt(){const t=this._signal;document.addEventListener("dragover",this.dragOver.bind(this),{signal:t}),document.addEventListener("drop",this.drop.bind(this),{signal:t})}addEditListeners(){this.#et(),this.setEditingState(!0)}removeEditListeners(){this.#ct(),this.setEditingState(!1)}dragOver(t){for(const{type:e}of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e)){t.dataTransfer.dropEffect="copy",t.preventDefault();return}}drop(t){for(const e of t.dataTransfer.items)for(const i of this.#u)if(i.isHandlingMimeForPasting(e.type)){i.paste(e,this.currentLayer),t.preventDefault();return}}copy(t){if(t.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const e=[];for(const i of this.#A){const r=i.serialize(!0);r&&e.push(r)}e.length!==0&&t.clipboardData.setData("application/pdfjs",JSON.stringify(e))}cut(t){this.copy(t),this.delete()}async paste(t){t.preventDefault();const{clipboardData:e}=t;for(const l of e.items)for(const c of this.#u)if(c.isHandlingMimeForPasting(l.type)){c.paste(l,this.currentLayer);return}let i=e.getData("application/pdfjs");if(!i)return;try{i=JSON.parse(i)}catch(l){ne(`paste: "${l.message}".`);return}if(!Array.isArray(i))return;this.unselectAll();const r=this.currentLayer;try{const l=[];for(const d of i){const f=await r.deserialize(d);if(!f)return;l.push(f)}const c=()=>{for(const d of l)this.#nt(d);this.#it(l)},u=()=>{for(const d of l)d.remove()};this.addCommands({cmd:c,undo:u,mustExec:!0})}catch(l){ne(`paste: "${l.message}".`)}}keydown(t){!this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!0),this.#T!==ae.NONE&&!this.isEditorHandlingKeyboard&&Jr._keyboardManager.exec(this,t)}keyup(t){this.isShiftKeyDown&&t.key==="Shift"&&(this.isShiftKeyDown=!1,this.#x&&(this.#x=!1,this.#Y("main_toolbar")))}onEditingAction({name:t}){switch(t){case"undo":case"redo":case"delete":case"selectAll":this[t]();break;case"highlightSelection":this.highlightSelection("context_menu");break;case"commentSelection":this.commentSelection("context_menu");break}}#O(t){Object.entries(t).some(([i,r])=>this.#X[i]!==r)&&(this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#X,t)}),this.#T===ae.HIGHLIGHT&&t.hasSelectedEditor===!1&&this.#q([[be.HIGHLIGHT_FREE,!0]]))}#q(t){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:t})}setEditingState(t){t?(this.#ot(),this.#ut(),this.#O({isEditing:this.#T!==ae.NONE,isEmpty:this.#Q(),hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:this.#c.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#lt(),this.#ht(),this.#O({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(t){if(!this.#u){this.#u=t;for(const e of this.#u)this.#q(e.defaultPropertiesToUpdate)}}getId(){return this.#D.id}get currentLayer(){return this.#s.get(this.#f)}getLayer(t){return this.#s.get(t)}get currentPageIndex(){return this.#f}addLayer(t){this.#s.set(t.pageIndex,t),this.#R?t.enable():t.disable()}removeLayer(t){this.#s.delete(t.pageIndex)}async updateMode(t,e=null,i=!1,r=!1,l=!1,c=!1){if(this.#T!==t&&!(this.#U&&(await this.#U.promise,!this.#U))){if(this.#U=Promise.withResolvers(),this.#h?.commitOrRemove(),this.#T===ae.POPUP&&this.#l?.hideSidebar(),this.#l?.destroyPopup(),this.#T=t,t===ae.NONE){this.setEditingState(!1),this.#pt();for(const u of this.#n.values())u.hideStandaloneCommentButton();this._editorUndoBar?.hide(),this.toggleComment(null),this.#U.resolve();return}for(const u of this.#n.values())u.addStandaloneCommentButton();t===ae.SIGNATURE&&await this.#I?.loadSignatures(),i&&Te.clearPointerType(),this.setEditingState(!0),await this.#ft(),this.unselectAll();for(const u of this.#s.values())u.updateMode(t);if(t===ae.POPUP){this.#i||=await this.#V.getAnnotationsByType(new Set(this.#u.map(f=>f._editorType)));const u=new Set,d=[];for(const f of this.#n.values()){const{annotationElementId:p,hasComment:y,deleted:w}=f;p&&u.add(p),y&&!w&&d.push(f.getData())}for(const f of this.#i){const{id:p,popupRef:y,contentsObj:w}=f;y&&w?.str&&!u.has(p)&&!this.#g.has(p)&&d.push(f)}this.#l?.showSidebar(d)}if(!e){r&&this.addNewEditorFromKeyboard(),this.#U.resolve();return}for(const u of this.#n.values())u.uid===e?(this.setSelected(u),c?u.editComment():l?u.enterInEditMode():u.focus()):u.unselect();this.#U.resolve()}}addNewEditorFromKeyboard(){this.currentLayer.canCreateNewEmptyEditor()&&this.currentLayer.addNewEditor()}updateToolbar(t){t.mode!==this.#T&&this._eventBus.dispatch("switchannotationeditormode",{source:this,...t})}updateParams(t,e){if(this.#u){switch(t){case be.CREATE:this.currentLayer.addNewEditor(e);return;case be.HIGHLIGHT_SHOW_ALL:this._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:{type:"highlight",action:"toggle_visibility"}}}),(this.#K||=new Map).set(t,e),this.showAllEditors("highlight",e);break}if(this.hasSelection)for(const i of this.#A)i.updateParams(t,e);else for(const i of this.#u)i.updateDefaultParams(t,e)}}showAllEditors(t,e,i=!1){for(const l of this.#n.values())l.editorType===t&&l.show(e);(this.#K?.get(be.HIGHLIGHT_SHOW_ALL)??!0)!==e&&this.#q([[be.HIGHLIGHT_SHOW_ALL,e]])}enableWaiting(t=!1){if(this.#j!==t){this.#j=t;for(const e of this.#s.values())t?e.disableClick():e.enableClick(),e.div.classList.toggle("waiting",t)}}async#ft(){if(!this.#R){this.#R=!0;const t=[];for(const e of this.#s.values())t.push(e.enable());await Promise.all(t);for(const e of this.#n.values())e.enable()}}#pt(){if(this.unselectAll(),this.#R){this.#R=!1;for(const t of this.#s.values())t.disable();for(const t of this.#n.values())t.disable()}}*getEditors(t){for(const e of this.#n.values())e.pageIndex===t&&(yield e)}getEditor(t){return this.#n.get(t)}addEditor(t){this.#n.set(t.id,t)}removeEditor(t){t.div.contains(document.activeElement)&&(this.#S&&clearTimeout(this.#S),this.#S=setTimeout(()=>{this.focusMainContainer(),this.#S=null},0)),this.#n.delete(t.id),t.annotationElementId&&this.#P?.delete(t.annotationElementId),this.unselect(t),(!t.annotationElementId||!this.#g.has(t.annotationElementId))&&this.#r?.remove(t.id)}addDeletedAnnotationElement(t){this.#g.add(t.annotationElementId),this.addChangedExistingAnnotation(t),t.deleted=!0}isDeletedAnnotationElement(t){return this.#g.has(t)}removeDeletedAnnotationElement(t){this.#g.delete(t.annotationElementId),this.removeChangedExistingAnnotation(t),t.deleted=!1}#nt(t){const e=this.#s.get(t.pageIndex);e?e.addOrRebuild(t):(this.addEditor(t),this.addToAnnotationStorage(t))}setActiveEditor(t){this.#e!==t&&(this.#e=t,t&&this.#q(t.propertiesToUpdate))}get#mt(){let t=null;for(t of this.#A);return t}updateUI(t){this.#mt===t&&this.#q(t.propertiesToUpdate)}updateUIForDefaultProperties(t){this.#q(t.defaultPropertiesToUpdate)}toggleSelected(t){if(this.#A.has(t)){this.#A.delete(t),t.unselect(),this.#O({hasSelectedEditor:this.hasSelection});return}this.#A.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}setSelected(t){this.updateToolbar({mode:t.mode,editId:t.uid}),this.#h?.commitOrRemove();for(const e of this.#A)e!==t&&e.unselect();this.#A.clear(),this.#A.add(t),t.select(),this.#q(t.propertiesToUpdate),this.#O({hasSelectedEditor:!0})}isSelected(t){return this.#A.has(t)}get firstSelectedEditor(){return this.#A.values().next().value}unselect(t){t.unselect(),this.#A.delete(t),this.#O({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#A.size!==0}get isEnterHandled(){return this.#A.size===1&&this.firstSelectedEditor.isEnterHandled}undo(){this.#c.undo(),this.#O({hasSomethingToUndo:this.#c.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#Q()}),this._editorUndoBar?.hide()}redo(){this.#c.redo(),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:this.#c.hasSomethingToRedo(),isEmpty:this.#Q()})}addCommands(t){this.#c.add(t),this.#O({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#Q()})}cleanUndoStack(t){this.#c.cleanType(t)}#Q(){if(this.#n.size===0)return!0;if(this.#n.size===1)for(const t of this.#n.values())return t.isEmpty();return!1}delete(){this.commitOrRemove();const t=this.currentLayer?.endDrawingSession(!0);if(!this.hasSelection&&!t)return;const e=t?[t]:[...this.#A],i=()=>{this._editorUndoBar?.show(r,e.length===1?e[0].editorType:e.length);for(const l of e)l.remove()},r=()=>{for(const l of e)this.#nt(l)};this.addCommands({cmd:i,undo:r,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#it(t){for(const e of this.#A)e.unselect();this.#A.clear();for(const e of t)e.isEmpty()||(this.#A.add(e),e.select());this.#O({hasSelectedEditor:this.hasSelection})}selectAll(){for(const t of this.#A)t.commit();this.#it(this.#n.values())}unselectAll(){if(!(this.#e&&(this.#e.commitOrRemove(),this.#T!==ae.NONE))&&!this.#h?.commitOrRemove()&&this.hasSelection){for(const t of this.#A)t.unselect();this.#A.clear(),this.#O({hasSelectedEditor:!1})}}translateSelectedEditors(t,e,i=!1){if(i||this.commitOrRemove(),!this.hasSelection)return;this.#H[0]+=t,this.#H[1]+=e;const[r,l]=this.#H,c=[...this.#A],u=1e3;this.#B&&clearTimeout(this.#B),this.#B=setTimeout(()=>{this.#B=null,this.#H[0]=this.#H[1]=0,this.addCommands({cmd:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(r,l),d.translationDone())},undo:()=>{for(const d of c)this.#n.has(d.id)&&(d.translateInPage(-r,-l),d.translationDone())},mustExec:!1})},u);for(const d of c)d.translateInPage(t,e),d.translationDone()}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#m=new Map;for(const t of this.#A)this.#m.set(t,{savedX:t.x,savedY:t.y,savedPageIndex:t.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#m)return!1;this.disableUserSelect(!1);const t=this.#m;this.#m=null;let e=!1;for(const[{x:r,y:l,pageIndex:c},u]of t)u.newX=r,u.newY=l,u.newPageIndex=c,e||=r!==u.savedX||l!==u.savedY||c!==u.savedPageIndex;if(!e)return!1;const i=(r,l,c,u)=>{if(this.#n.has(r.id)){const d=this.#s.get(u);d?r._setParentAndPosition(d,l,c):(r.pageIndex=u,r.x=l,r.y=c)}};return this.addCommands({cmd:()=>{for(const[r,{newX:l,newY:c,newPageIndex:u}]of t)i(r,l,c,u)},undo:()=>{for(const[r,{savedX:l,savedY:c,savedPageIndex:u}]of t)i(r,l,c,u)},mustExec:!0}),!0}dragSelectedEditors(t,e){if(this.#m)for(const i of this.#m.keys())i.drag(t,e)}rebuild(t){if(t.parent===null){const e=this.getLayer(t.pageIndex);e?(e.changeParent(t),e.addOrRebuild(t)):(this.addEditor(t),this.addToAnnotationStorage(t),t.rebuild())}else t.parent.addOrRebuild(t)}get isEditorHandlingKeyboard(){return this.getActive()?.shouldGetKeyboardEvents()||this.#A.size===1&&this.firstSelectedEditor.shouldGetKeyboardEvents()}isActive(t){return this.#e===t}getActive(){return this.#e}getMode(){return this.#T}isEditingMode(){return this.#T!==ae.NONE}get imageManager(){return ie(this,"imageManager",new Lm)}getSelectionBoxes(t){if(!t)return null;const e=document.getSelection();for(let f=0,p=e.rangeCount;f<p;f++)if(!t.contains(e.getRangeAt(f).commonAncestorContainer))return null;const{x:i,y:r,width:l,height:c}=t.getBoundingClientRect();let u;switch(t.getAttribute("data-main-rotation")){case"90":u=(f,p,y,w)=>({x:(p-r)/c,y:1-(f+y-i)/l,width:w/c,height:y/l});break;case"180":u=(f,p,y,w)=>({x:1-(f+y-i)/l,y:1-(p+w-r)/c,width:y/l,height:w/c});break;case"270":u=(f,p,y,w)=>({x:1-(p+w-r)/c,y:(f-i)/l,width:w/c,height:y/l});break;default:u=(f,p,y,w)=>({x:(f-i)/l,y:(p-r)/c,width:y/l,height:w/c});break}const d=[];for(let f=0,p=e.rangeCount;f<p;f++){const y=e.getRangeAt(f);if(!y.collapsed)for(const{x:w,y:A,width:_,height:S}of y.getClientRects())_===0||S===0||d.push(u(w,A,_,S))}return d.length===0?null:d}addChangedExistingAnnotation({annotationElementId:t,id:e}){(this.#o||=new Map).set(t,e)}removeChangedExistingAnnotation({annotationElementId:t}){this.#o?.delete(t)}renderAnnotationElement(t){const e=this.#o?.get(t.data.id);if(!e)return;const i=this.#r.getRawValue(e);i&&(this.#T===ae.NONE&&!i.hasBeenModified||i.renderAnnotationElement(t))}setMissingCanvas(t,e,i){const r=this.#P?.get(t);r&&(r.setCanvas(e,i),this.#P.delete(t))}addMissingCanvas(t,e){(this.#P||=new Map).set(t,e)}}class _s{#t=null;#e=!1;#i=null;#n=null;#s=null;#a=null;#r=!1;#o=null;#c=null;#l=null;#d=null;#h=!1;static#f=null;static _l10n=null;constructor(t){this.#c=t,this.#h=t._uiManager.useNewAltTextFlow,_s.#f||=Object.freeze({added:"pdfjs-editor-new-alt-text-added-button","added-label":"pdfjs-editor-new-alt-text-added-button-label",missing:"pdfjs-editor-new-alt-text-missing-button","missing-label":"pdfjs-editor-new-alt-text-missing-button-label",review:"pdfjs-editor-new-alt-text-to-review-button","review-label":"pdfjs-editor-new-alt-text-to-review-button-label"})}static initialize(t){_s._l10n??=t}async render(){const t=this.#i=document.createElement("button");t.className="altText",t.tabIndex="0";const e=this.#n=document.createElement("span");t.append(e),this.#h?(t.classList.add("new"),t.setAttribute("data-l10n-id",_s.#f.missing),e.setAttribute("data-l10n-id",_s.#f["missing-label"])):(t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button"),e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-button-label"));const i=this.#c._uiManager._signal;t.addEventListener("contextmenu",$i,{signal:i}),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const r=l=>{l.preventDefault(),this.#c._uiManager.editAltText(this.#c),this.#h&&this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_clicked",data:{label:this.#g}})};return t.addEventListener("click",r,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#r=!0,r(l))},{signal:i}),await this.#m(),t}get#g(){return this.#t&&"added"||this.#t===null&&this.guessedText&&"review"||"missing"}finish(){this.#i&&(this.#i.focus({focusVisible:this.#r}),this.#r=!1)}isEmpty(){return this.#h?this.#t===null:!this.#t&&!this.#e}hasData(){return this.#h?this.#t!==null||!!this.#l:this.isEmpty()}get guessedText(){return this.#l}async setGuessedText(t){this.#t===null&&(this.#l=t,this.#d=await _s._l10n.get("pdfjs-editor-new-alt-text-generated-alt-text-with-disclaimer",{generatedAltText:t}),this.#m())}toggleAltTextBadge(t=!1){if(!this.#h||this.#t){this.#o?.remove(),this.#o=null;return}if(!this.#o){const e=this.#o=document.createElement("div");e.className="noAltTextBadge",this.#c.div.append(e)}this.#o.classList.toggle("hidden",!t)}serialize(t){let e=this.#t;return!t&&this.#l===e&&(e=this.#d),{altText:e,decorative:this.#e,guessedText:this.#l,textWithDisclaimer:this.#d}}get data(){return{altText:this.#t,decorative:this.#e}}set data({altText:t,decorative:e,guessedText:i,textWithDisclaimer:r,cancel:l=!1}){i&&(this.#l=i,this.#d=r),!(this.#t===t&&this.#e===e)&&(l||(this.#t=t,this.#e=e),this.#m())}toggle(t=!1){this.#i&&(!t&&this.#a&&(clearTimeout(this.#a),this.#a=null),this.#i.disabled=!t)}shown(){this.#c._reportTelemetry({action:"pdfjs.image.alt_text.image_status_label_displayed",data:{label:this.#g}})}destroy(){this.#i?.remove(),this.#i=null,this.#n=null,this.#s=null,this.#o?.remove(),this.#o=null}async#m(){const t=this.#i;if(!t)return;if(this.#h){if(t.classList.toggle("done",!!this.#t),t.setAttribute("data-l10n-id",_s.#f[this.#g]),this.#n?.setAttribute("data-l10n-id",_s.#f[`${this.#g}-label`]),!this.#t){this.#s?.remove();return}}else{if(!this.#t&&!this.#e){t.classList.remove("done"),this.#s?.remove();return}t.classList.add("done"),t.setAttribute("data-l10n-id","pdfjs-editor-alt-text-edit-button")}let e=this.#s;if(!e){this.#s=e=document.createElement("span"),e.className="tooltip",e.setAttribute("role","tooltip"),e.id=`alt-text-tooltip-${this.#c.id}`;const r=100,l=this.#c._uiManager._signal;l.addEventListener("abort",()=>{clearTimeout(this.#a),this.#a=null},{once:!0}),t.addEventListener("mouseenter",()=>{this.#a=setTimeout(()=>{this.#a=null,this.#s.classList.add("show"),this.#c._reportTelemetry({action:"alt_text_tooltip"})},r)},{signal:l}),t.addEventListener("mouseleave",()=>{this.#a&&(clearTimeout(this.#a),this.#a=null),this.#s?.classList.remove("show")},{signal:l})}this.#e?e.setAttribute("data-l10n-id","pdfjs-editor-alt-text-decorative-tooltip"):(e.removeAttribute("data-l10n-id"),e.textContent=this.#t),e.parentNode||t.append(e),this.#c.getElementForAltText()?.setAttribute("aria-describedby",e.id)}}class gh{#t=null;#e=null;#i=!1;#n=null;#s=null;#a=null;#r=null;#o=null;#c=!1;#l=null;constructor(t){this.#n=t}renderForToolbar(){const t=this.#e=document.createElement("button");return t.className="comment",this.#d(t,!1)}renderForStandalone(){const t=this.#t=document.createElement("button");t.className="annotationCommentButton";const e=this.#n.commentButtonPosition;if(e){const{style:i}=t;i.insetInlineEnd=`calc(${100*(this.#n._uiManager.direction==="ltr"?1-e[0]:e[0])}% - var(--comment-button-dim))`,i.top=`calc(${100*e[1]}% - var(--comment-button-dim))`;const r=this.#n.commentButtonColor;r&&(i.backgroundColor=r)}return this.#d(t,!0)}focusButton(){setTimeout(()=>{(this.#t??this.#e)?.focus()},0)}onUpdatedColor(){if(!this.#t)return;const t=this.#n.commentButtonColor;t&&(this.#t.style.backgroundColor=t),this.#n._uiManager.updatePopupColor(this.#n)}get commentButtonWidth(){return(this.#t?.getBoundingClientRect().width??0)/this.#n.parent.boundingClientRect.width}get commentPopupPositionInLayer(){if(this.#l)return this.#l;if(!this.#t)return null;const{x:t,y:e,height:i}=this.#t.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#n.parent.boundingClientRect;return[(t-r)/c,(e+i-l)/u]}set commentPopupPositionInLayer(t){this.#l=t}hasDefaultPopupPosition(){return this.#l===null}removeStandaloneCommentButton(){this.#t?.remove(),this.#t=null}removeToolbarCommentButton(){this.#e?.remove(),this.#e=null}setCommentButtonStates({selected:t,hasPopup:e}){this.#t&&(this.#t.classList.toggle("selected",t),this.#t.ariaExpanded=e)}#d(t,e){if(!this.#n._uiManager.hasCommentManager())return null;t.tabIndex="0",t.ariaHasPopup="dialog",e?(t.ariaControls="commentPopup",t.setAttribute("data-l10n-id","pdfjs-show-comment-button")):(t.ariaControlsElements=[this.#n._uiManager.getCommentDialogElement()],t.setAttribute("data-l10n-id","pdfjs-editor-add-comment-button"));const i=this.#n._uiManager._signal;if(!(i instanceof AbortSignal)||i.aborted)return t;t.addEventListener("contextmenu",$i,{signal:i}),e&&(t.addEventListener("focusin",l=>{this.#n._focusEventsAllowed=!1,en(l)},{capture:!0,signal:i}),t.addEventListener("focusout",l=>{this.#n._focusEventsAllowed=!0,en(l)},{capture:!0,signal:i})),t.addEventListener("pointerdown",l=>l.stopPropagation(),{signal:i});const r=l=>{l.preventDefault(),t===this.#e?this.edit():this.#n.toggleComment(!0)};return t.addEventListener("click",r,{capture:!0,signal:i}),t.addEventListener("keydown",l=>{l.target===t&&l.key==="Enter"&&(this.#i=!0,r(l))},{signal:i}),t.addEventListener("pointerenter",()=>{this.#n.toggleComment(!1,!0)},{signal:i}),t.addEventListener("pointerleave",()=>{this.#n.toggleComment(!1,!1)},{signal:i}),t}edit(t){const e=this.commentPopupPositionInLayer;let i,r;if(e)[i,r]=e;else{[i,r]=this.#n.commentButtonPosition;const{width:p,height:y,x:w,y:A}=this.#n;i=w+i*p,r=A+r*y}const l=this.#n.parent.boundingClientRect,{x:c,y:u,width:d,height:f}=l;this.#n._uiManager.editComment(this.#n,c+i*d,u+r*f,{...t,parentDimensions:l})}finish(){this.#e&&(this.#e.focus({focusVisible:this.#i}),this.#i=!1)}isDeleted(){return this.#c||this.#r===""}isEmpty(){return this.#r===null}hasBeenEdited(){return this.isDeleted()||this.#r!==this.#s}serialize(){return this.data}get data(){return{text:this.#r,richText:this.#a,date:this.#o,deleted:this.isDeleted()}}set data(t){if(t!==this.#r&&(this.#a=null),t===null){this.#r="",this.#c=!0;return}this.#r=t,this.#o=new Date,this.#c=!1}restoreData({text:t,richText:e,date:i}){this.#r=t,this.#a=e,this.#o=i,this.#c=!1}setInitialText(t,e=null){this.#s=t,this.data=t,this.#o=null,this.#a=e}shown(){}destroy(){this.#e?.remove(),this.#e=null,this.#t?.remove(),this.#t=null,this.#r="",this.#a=null,this.#o=null,this.#n=null,this.#i=!1,this.#c=!1}}class ad{#t;#e=!1;#i=null;#n;#s;#a;#r;#o=null;#c;#l=null;#d;#h=null;constructor({container:t,isPinchingDisabled:e=null,isPinchingStopped:i=null,onPinchStart:r=null,onPinching:l=null,onPinchEnd:c=null,signal:u}){this.#t=t,this.#i=i,this.#n=e,this.#s=r,this.#a=l,this.#r=c,this.#d=new AbortController,this.#c=AbortSignal.any([u,this.#d.signal]),t.addEventListener("touchstart",this.#f.bind(this),{passive:!1,signal:this.#c})}get MIN_TOUCH_DISTANCE_TO_PINCH(){return 35/Ts.pixelRatio}#f(t){if(this.#n?.())return;if(t.touches.length===1){if(this.#o)return;const r=this.#o=new AbortController,l=AbortSignal.any([this.#c,r.signal]),c=this.#t,u={capture:!0,signal:l,passive:!1},d=f=>{f.pointerType==="touch"&&(this.#o?.abort(),this.#o=null)};c.addEventListener("pointerdown",f=>{f.pointerType==="touch"&&(en(f),d(f))},u),c.addEventListener("pointerup",d,u),c.addEventListener("pointercancel",d,u);return}if(!this.#h){this.#h=new AbortController;const r=AbortSignal.any([this.#c,this.#h.signal]),l=this.#t,c={signal:r,capture:!1,passive:!1};l.addEventListener("touchmove",this.#g.bind(this),c);const u=this.#m.bind(this);l.addEventListener("touchend",u,c),l.addEventListener("touchcancel",u,c),c.capture=!0,l.addEventListener("pointerdown",en,c),l.addEventListener("pointermove",en,c),l.addEventListener("pointercancel",en,c),l.addEventListener("pointerup",en,c),this.#s?.()}if(en(t),t.touches.length!==2||this.#i?.()){this.#l=null;return}let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]),this.#l={touch0X:e.screenX,touch0Y:e.screenY,touch1X:i.screenX,touch1Y:i.screenY}}#g(t){if(!this.#l||t.touches.length!==2)return;en(t);let[e,i]=t.touches;e.identifier>i.identifier&&([e,i]=[i,e]);const{screenX:r,screenY:l}=e,{screenX:c,screenY:u}=i,d=this.#l,{touch0X:f,touch0Y:p,touch1X:y,touch1Y:w}=d,A=y-f,_=w-p,S=c-r,C=u-l,M=Math.hypot(S,C)||1,k=Math.hypot(A,_)||1;if(!this.#e&&Math.abs(k-M)<=ad.MIN_TOUCH_DISTANCE_TO_PINCH)return;if(d.touch0X=r,d.touch0Y=l,d.touch1X=c,d.touch1Y=u,!this.#e){this.#e=!0;return}const L=[(r+c)/2,(l+u)/2];this.#a?.(L,k,M)}#m(t){t.touches.length>=2||(this.#h&&(this.#h.abort(),this.#h=null,this.#r?.()),this.#l&&(en(t),this.#l=null,this.#e=!1))}destroy(){this.#d?.abort(),this.#d=null,this.#o?.abort(),this.#o=null}}class Zt{#t=null;#e=null;#i=null;#n=null;#s=null;#a=!1;#r=null;#o="";#c=null;#l=null;#d=null;#h=null;#f=null;#g="";#m=!1;#u=null;#p=!1;#y=!1;#v=!1;#b=null;#E=0;#S=0;#w=null;#C=null;isSelected=!1;_isCopy=!1;_editToolbar=null;_initialOptions=Object.create(null);_initialData=null;_isVisible=!0;_uiManager=null;_focusEventsAllowed=!0;static _l10n=null;static _l10nResizer=null;#x=!1;#_=Zt._zIndex++;static _borderLineWidth=-1;static _colorManager=new Pm;static _zIndex=1;static _telemetryTimeout=1e3;static get _resizerKeyboardManager(){const t=Zt.prototype._resizeWithKeyboard,e=Jr.TRANSLATE_SMALL,i=Jr.TRANSLATE_BIG;return ie(this,"_resizerKeyboardManager",new Yc([[["ArrowLeft","mac+ArrowLeft"],t,{args:[-e,0]}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t,{args:[-i,0]}],[["ArrowRight","mac+ArrowRight"],t,{args:[e,0]}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t,{args:[i,0]}],[["ArrowUp","mac+ArrowUp"],t,{args:[0,-e]}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t,{args:[0,-i]}],[["ArrowDown","mac+ArrowDown"],t,{args:[0,e]}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t,{args:[0,i]}],[["Escape","mac+Escape"],Zt.prototype._stopResizingWithKeyboard]]))}constructor(t){this.parent=t.parent,this.id=t.id,this.width=this.height=null,this.pageIndex=t.parent.pageIndex,this.name=t.name,this.div=null,this._uiManager=t.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=t.isCentered,this._structTreeParentId=null,this.annotationElementId=t.annotationElementId||null,this.creationDate=t.creationDate||new Date,this.modificationDate=t.modificationDate||null,this.canAddComment=!0;const{rotation:e,rawDims:{pageWidth:i,pageHeight:r,pageX:l,pageY:c}}=this.parent.viewport;this.rotation=e,this.pageRotation=(360+e-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[i,r],this.pageTranslation=[l,c];const[u,d]=this.parentDimensions;this.x=t.x/u,this.y=t.y/d,this.isAttachedToDOM=!1,this.deleted=!1}updatePageIndex(t){this.pageIndex=t}get editorType(){return Object.getPrototypeOf(this).constructor._type}get mode(){return Object.getPrototypeOf(this).constructor._editorType}static get isDrawer(){return!1}static get _defaultLineColor(){return ie(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(t){const e=new YC({id:t.parent.getNextId(),parent:t.parent,uiManager:t._uiManager});e.annotationElementId=t.annotationElementId,e.deleted=!0,e._uiManager.addToAnnotationStorage(e)}static initialize(t,e){if(Zt._l10n??=t,Zt._l10nResizer||=Object.freeze({topLeft:"pdfjs-editor-resizer-top-left",topMiddle:"pdfjs-editor-resizer-top-middle",topRight:"pdfjs-editor-resizer-top-right",middleRight:"pdfjs-editor-resizer-middle-right",bottomRight:"pdfjs-editor-resizer-bottom-right",bottomMiddle:"pdfjs-editor-resizer-bottom-middle",bottomLeft:"pdfjs-editor-resizer-bottom-left",middleLeft:"pdfjs-editor-resizer-middle-left"}),Zt._borderLineWidth!==-1)return;const i=getComputedStyle(document.documentElement);Zt._borderLineWidth=parseFloat(i.getPropertyValue("--outline-width"))||0}static updateDefaultParams(t,e){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(t){return!1}static paste(t,e){Me("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#x}set _isDraggable(t){this.#x=t,this.div?.classList.toggle("draggable",t)}get uid(){return this.annotationElementId||this.id}get isEnterHandled(){return!0}center(){const[t,e]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*e/(t*2),this.y+=this.width*t/(e*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*e/(t*2),this.y-=this.width*t/(e*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(t){this._uiManager.addCommands(t)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#_}setParent(t){t!==null?(this.pageIndex=t.pageIndex,this.pageDimensions=t.pageDimensions):(this.#B(),this.#h?.remove(),this.#h=null),this.parent=t}focusin(t){this._focusEventsAllowed&&(this.#m?this.#m=!1:this.parent.setSelected(this))}focusout(t){!this._focusEventsAllowed||!this.isAttachedToDOM||t.relatedTarget?.closest(`#${this.id}`)||(t.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.isInEditMode()&&this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(t,e,i,r){const[l,c]=this.parentDimensions;[i,r]=this.screenToPageTranslation(i,r),this.x=(t+i)/l,this.y=(e+r)/c,this.fixAndSetPosition()}_moveAfterPaste(t,e){const[i,r]=this.parentDimensions;this.setAt(t*i,e*r,this.width*i,this.height*r),this._onTranslated()}#D([t,e],i,r){[i,r]=this.screenToPageTranslation(i,r),this.x+=i/t,this.y+=r/e,this._onTranslating(this.x,this.y),this.fixAndSetPosition()}translate(t,e){this.#D(this.parentDimensions,t,e)}translateInPage(t,e){this.#u||=[this.x,this.y,this.width,this.height],this.#D(this.pageDimensions,t,e),this.div.scrollIntoView({block:"nearest"})}translationDone(){this._onTranslated(this.x,this.y)}drag(t,e){this.#u||=[this.x,this.y,this.width,this.height];const{div:i,parentDimensions:[r,l]}=this;if(this.x+=t/r,this.y+=e/l,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:y,y:w}=this.div.getBoundingClientRect();this.parent.findNewParent(this,y,w)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:c,y:u}=this;const[d,f]=this.getBaseTranslation();c+=d,u+=f;const{style:p}=i;p.left=`${(100*c).toFixed(2)}%`,p.top=`${(100*u).toFixed(2)}%`,this._onTranslating(c,u),i.scrollIntoView({block:"nearest"})}_onTranslating(t,e){}_onTranslated(t,e){}get _hasBeenMoved(){return!!this.#u&&(this.#u[0]!==this.x||this.#u[1]!==this.y)}get _hasBeenResized(){return!!this.#u&&(this.#u[2]!==this.width||this.#u[3]!==this.height)}getBaseTranslation(){const[t,e]=this.parentDimensions,{_borderLineWidth:i}=Zt,r=i/t,l=i/e;switch(this.rotation){case 90:return[-r,l];case 180:return[r,l];case 270:return[r,-l];default:return[-r,-l]}}get _mustFixPosition(){return!0}fixAndSetPosition(t=this.rotation){const{div:{style:e},pageDimensions:[i,r]}=this;let{x:l,y:c,width:u,height:d}=this;if(u*=i,d*=r,l*=i,c*=r,this._mustFixPosition)switch(t){case 0:l=Fn(l,0,i-u),c=Fn(c,0,r-d);break;case 90:l=Fn(l,0,i-d),c=Fn(c,u,r);break;case 180:l=Fn(l,u,i),c=Fn(c,d,r);break;case 270:l=Fn(l,d,i),c=Fn(c,0,r-u);break}this.x=l/=i,this.y=c/=r;const[f,p]=this.getBaseTranslation();l+=f,c+=p,e.left=`${(100*l).toFixed(2)}%`,e.top=`${(100*c).toFixed(2)}%`,this.moveInDOM()}static#R(t,e,i){switch(i){case 90:return[e,-t];case 180:return[-t,-e];case 270:return[-e,t];default:return[t,e]}}screenToPageTranslation(t,e){return Zt.#R(t,e,this.parentRotation)}pageTranslationToScreen(t,e){return Zt.#R(t,e,360-this.parentRotation)}#M(t){switch(t){case 90:{const[e,i]=this.pageDimensions;return[0,-e/i,i/e,0]}case 180:return[-1,0,0,-1];case 270:{const[e,i]=this.pageDimensions;return[0,e/i,-i/e,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:t,pageDimensions:[e,i]}=this;return[e*t,i*t]}setDims(){const{div:{style:t},width:e,height:i}=this;t.width=`${(100*e).toFixed(2)}%`,t.height=`${(100*i).toFixed(2)}%`}getInitialTranslation(){return[0,0]}#j(){if(this.#c)return;this.#c=document.createElement("div"),this.#c.classList.add("resizers");const t=this._willKeepAspectRatio?["topLeft","topRight","bottomRight","bottomLeft"]:["topLeft","topMiddle","topRight","middleRight","bottomRight","bottomMiddle","bottomLeft","middleLeft"],e=this._uiManager._signal;for(const i of t){const r=document.createElement("div");this.#c.append(r),r.classList.add("resizer",i),r.setAttribute("data-resizer-name",i),r.addEventListener("pointerdown",this.#N.bind(this,i),{signal:e}),r.addEventListener("contextmenu",$i,{signal:e}),r.tabIndex=-1}this.div.prepend(this.#c)}#N(t,e){e.preventDefault();const{isMac:i}=xn.platform;if(e.button!==0||e.ctrlKey&&i)return;this.#i?.toggle(!1);const r=this._isDraggable;this._isDraggable=!1,this.#l=[e.screenX,e.screenY];const l=new AbortController,c=this._uiManager.combinedSignal(l);this.parent.togglePointerEvents(!1),window.addEventListener("pointermove",this.#P.bind(this,t),{passive:!0,capture:!0,signal:c}),window.addEventListener("touchmove",en,{passive:!1,signal:c}),window.addEventListener("contextmenu",$i,{signal:c}),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const u=this.parent.div.style.cursor,d=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(e.target).cursor;const f=()=>{l.abort(),this.parent.togglePointerEvents(!0),this.#i?.toggle(!0),this._isDraggable=r,this.parent.div.style.cursor=u,this.div.style.cursor=d,this.#F()};window.addEventListener("pointerup",f,{signal:c}),window.addEventListener("blur",f,{signal:c})}#L(t,e,i,r){this.width=i,this.height=r,this.x=t,this.y=e,this.setDims(),this.fixAndSetPosition(),this._onResized()}_onResized(){}#F(){if(!this.#d)return;const{savedX:t,savedY:e,savedWidth:i,savedHeight:r}=this.#d;this.#d=null;const l=this.x,c=this.y,u=this.width,d=this.height;l===t&&c===e&&u===i&&d===r||this.addCommands({cmd:this.#L.bind(this,l,c,u,d),undo:this.#L.bind(this,t,e,i,r),mustExec:!0})}static _round(t){return Math.round(t*1e4)/1e4}#P(t,e){const[i,r]=this.parentDimensions,l=this.x,c=this.y,u=this.width,d=this.height,f=Zt.MIN_SIZE/i,p=Zt.MIN_SIZE/r,y=this.#M(this.rotation),w=(G,st)=>[y[0]*G+y[2]*st,y[1]*G+y[3]*st],A=this.#M(360-this.rotation),_=(G,st)=>[A[0]*G+A[2]*st,A[1]*G+A[3]*st];let S,C,M=!1,k=!1;switch(t){case"topLeft":M=!0,S=(G,st)=>[0,0],C=(G,st)=>[G,st];break;case"topMiddle":S=(G,st)=>[G/2,0],C=(G,st)=>[G/2,st];break;case"topRight":M=!0,S=(G,st)=>[G,0],C=(G,st)=>[0,st];break;case"middleRight":k=!0,S=(G,st)=>[G,st/2],C=(G,st)=>[0,st/2];break;case"bottomRight":M=!0,S=(G,st)=>[G,st],C=(G,st)=>[0,0];break;case"bottomMiddle":S=(G,st)=>[G/2,st],C=(G,st)=>[G/2,0];break;case"bottomLeft":M=!0,S=(G,st)=>[0,st],C=(G,st)=>[G,0];break;case"middleLeft":k=!0,S=(G,st)=>[0,st/2],C=(G,st)=>[G,st/2];break}const L=S(u,d),j=C(u,d);let F=w(...j);const z=Zt._round(l+F[0]),H=Zt._round(c+F[1]);let ut=1,ft=1,_t,ct;if(e.fromKeyboard)({deltaX:_t,deltaY:ct}=e);else{const{screenX:G,screenY:st}=e,[wt,Yt]=this.#l;[_t,ct]=this.screenToPageTranslation(G-wt,st-Yt),this.#l[0]=G,this.#l[1]=st}if([_t,ct]=_(_t/i,ct/r),M){const G=Math.hypot(u,d);ut=ft=Math.max(Math.min(Math.hypot(j[0]-L[0]-_t,j[1]-L[1]-ct)/G,1/u,1/d),f/u,p/d)}else k?ut=Fn(Math.abs(j[0]-L[0]-_t),f,1)/u:ft=Fn(Math.abs(j[1]-L[1]-ct),p,1)/d;const Tt=Zt._round(u*ut),Lt=Zt._round(d*ft);F=w(...C(Tt,Lt));const Bt=z-F[0],Vt=H-F[1];this.#u||=[this.x,this.y,this.width,this.height],this.width=Tt,this.height=Lt,this.x=Bt,this.y=Vt,this.setDims(),this.fixAndSetPosition(),this._onResizing()}_onResizing(){}altTextFinish(){this.#i?.finish()}get toolbarButtons(){return null}async addEditToolbar(){if(this._editToolbar||this.#y)return this._editToolbar;this._editToolbar=new Oc(this),this.div.append(this._editToolbar.render());const{toolbarButtons:t}=this;if(t)for(const[e,i]of t)await this._editToolbar.addButton(e,i);return this.hasComment||this._editToolbar.addButton("comment",this.addCommentButton()),this._editToolbar.addButton("delete"),this._editToolbar}addCommentButtonInToolbar(){this._editToolbar?.addButtonBefore("comment",this.addCommentButton(),".deleteButton")}removeCommentButtonFromToolbar(){this._editToolbar?.removeButton("comment")}removeEditToolbar(){this._editToolbar?.remove(),this._editToolbar=null,this.#i?.destroy()}addContainer(t){const e=this._editToolbar?.div;e?e.before(t):this.div.append(t)}getClientDimensions(){return this.div.getBoundingClientRect()}createAltText(){return this.#i||(_s.initialize(Zt._l10n),this.#i=new _s(this),this.#t&&(this.#i.data=this.#t,this.#t=null)),this.#i}get altTextData(){return this.#i?.data}set altTextData(t){this.#i&&(this.#i.data=t)}get guessedAltText(){return this.#i?.guessedText}async setGuessedAltText(t){await this.#i?.setGuessedText(t)}serializeAltText(t){return this.#i?.serialize(t)}hasAltText(){return!!this.#i&&!this.#i.isEmpty()}hasAltTextData(){return this.#i?.hasData()??!1}focusCommentButton(){this.#n?.focusButton()}addCommentButton(){return this.canAddComment?this.#n||=new gh(this):null}addStandaloneCommentButton(){if(this._uiManager.hasCommentManager()){if(this.#s){this._uiManager.isEditingMode()&&this.#s.classList.remove("hidden");return}this.hasComment&&(this.#s=this.#n.renderForStandalone(),this.div.append(this.#s))}}removeStandaloneCommentButton(){this.#n.removeStandaloneCommentButton(),this.#s=null}hideStandaloneCommentButton(){this.#s?.classList.add("hidden")}get comment(){if(!this.#n)return null;const{data:{richText:t,text:e,date:i,deleted:r}}=this.#n;return{text:e,richText:t,date:i,deleted:r,color:this.getNonHCMColor(),opacity:this.opacity??1}}set comment(t){this.#n||=new gh(this),typeof t=="object"&&t!==null?this.#n.restoreData(t):this.#n.data=t,this.hasComment?(this.removeCommentButtonFromToolbar(),this.addStandaloneCommentButton(),this._uiManager.updateComment(this)):(this.addCommentButtonInToolbar(),this.removeStandaloneCommentButton(),this._uiManager.removeComment(this))}setCommentData({comment:t,popupRef:e,richText:i}){if(!e||(this.#n||=new gh(this),this.#n.setInitialText(t,i),!this.annotationElementId))return;const r=this._uiManager.getAndRemoveDataFromAnnotationStorage(this.annotationElementId);r&&this.updateFromAnnotationLayer(r)}get hasEditedComment(){return this.#n?.hasBeenEdited()}get hasDeletedComment(){return this.#n?.isDeleted()}get hasComment(){return!!this.#n&&!this.#n.isEmpty()&&!this.#n.isDeleted()}async editComment(t){this.#n||=new gh(this),this.#n.edit(t)}toggleComment(t,e=void 0){this.hasComment&&this._uiManager.toggleComment(this,t,e)}setSelectedCommentButton(t){this.#n.setSelectedButton(t)}addComment(t){if(this.hasEditedComment){const[,,,r]=t.rect,[l]=this.pageDimensions,[c]=this.pageTranslation,u=c+l+1,d=r-100,f=u+180;t.popup={contents:this.comment.text,deleted:this.comment.deleted,rect:[u,d,f,r]}}}updateFromAnnotationLayer({popup:{contents:t,deleted:e}}){this.#n.data=e?null:t}get parentBoundingClientRect(){return this.parent.boundingClientRect}render(){const t=this.div=document.createElement("div");t.setAttribute("data-editor-rotation",(360-this.rotation)%360),t.className=this.name,t.setAttribute("id",this.id),t.tabIndex=this.#a?-1:0,t.setAttribute("role","application"),this.defaultL10nId&&t.setAttribute("data-l10n-id",this.defaultL10nId),this._isVisible||t.classList.add("hidden"),this.setInForeground(),this.#z();const[e,i]=this.parentDimensions;this.parentRotation%180!==0&&(t.style.maxWidth=`${(100*i/e).toFixed(2)}%`,t.style.maxHeight=`${(100*e/i).toFixed(2)}%`);const[r,l]=this.getInitialTranslation();return this.translate(r,l),Dw(this,t,["keydown","pointerdown","dblclick"]),this.isResizable&&this._uiManager._supportsPinchToZoom&&(this.#C||=new ad({container:t,isPinchingDisabled:()=>!this.isSelected,onPinchStart:this.#G.bind(this),onPinching:this.#T.bind(this),onPinchEnd:this.#A.bind(this),signal:this._uiManager._signal})),this.addStandaloneCommentButton(),this._uiManager._editorUndoBar?.hide(),t}#G(){this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height},this.#i?.toggle(!1),this.parent.togglePointerEvents(!1)}#T(t,e,i){let l=.7*(i/e)+1-.7;if(l===1)return;const c=this.#M(this.rotation),u=(z,H)=>[c[0]*z+c[2]*H,c[1]*z+c[3]*H],[d,f]=this.parentDimensions,p=this.x,y=this.y,w=this.width,A=this.height,_=Zt.MIN_SIZE/d,S=Zt.MIN_SIZE/f;l=Math.max(Math.min(l,1/w,1/A),_/w,S/A);const C=Zt._round(w*l),M=Zt._round(A*l);if(C===w&&M===A)return;this.#u||=[p,y,w,A];const k=u(w/2,A/2),L=Zt._round(p+k[0]),j=Zt._round(y+k[1]),F=u(C/2,M/2);this.x=L-F[0],this.y=j-F[1],this.width=C,this.height=M,this.setDims(),this.fixAndSetPosition(),this._onResizing()}#A(){this.#i?.toggle(!0),this.parent.togglePointerEvents(!0),this.#F()}pointerdown(t){const{isMac:e}=xn.platform;if(t.button!==0||t.ctrlKey&&e){t.preventDefault();return}if(this.#m=!0,this._isDraggable){this.#I(t);return}this.#k(t)}#k(t){const{isMac:e}=xn.platform;t.ctrlKey&&!e||t.shiftKey||t.metaKey&&e?this.parent.toggleSelected(this):this.parent.setSelected(this)}#I(t){const{isSelected:e}=this;this._uiManager.setUpDragSession();let i=!1;const r=new AbortController,l=this._uiManager.combinedSignal(r),c={capture:!0,passive:!1,signal:l},u=f=>{r.abort(),this.#r=null,this.#m=!1,this._uiManager.endDragSession()||this.#k(f),i&&this._onStopDragging()};e&&(this.#E=t.clientX,this.#S=t.clientY,this.#r=t.pointerId,this.#o=t.pointerType,window.addEventListener("pointermove",f=>{i||(i=!0,this._uiManager.toggleComment(this,!0,!1),this._onStartDragging());const{clientX:p,clientY:y,pointerId:w}=f;if(w!==this.#r){en(f);return}const[A,_]=this.screenToPageTranslation(p-this.#E,y-this.#S);this.#E=p,this.#S=y,this._uiManager.dragSelectedEditors(A,_)},c),window.addEventListener("touchmove",en,c),window.addEventListener("pointerdown",f=>{f.pointerType===this.#o&&(this.#C||f.isPrimary)&&u(f),en(f)},c));const d=f=>{if(!this.#r||this.#r===f.pointerId){u(f);return}en(f)};window.addEventListener("pointerup",d,{signal:l}),window.addEventListener("blur",d,{signal:l})}_onStartDragging(){}_onStopDragging(){}moveInDOM(){this.#b&&clearTimeout(this.#b),this.#b=setTimeout(()=>{this.#b=null,this.parent?.moveEditorInDOM(this)},0)}_setParentAndPosition(t,e,i){t.changeParent(this),this.x=e,this.y=i,this.fixAndSetPosition(),this._onTranslated()}getRect(t,e,i=this.rotation){const r=this.parentScale,[l,c]=this.pageDimensions,[u,d]=this.pageTranslation,f=t/r,p=e/r,y=this.x*l,w=this.y*c,A=this.width*l,_=this.height*c;switch(i){case 0:return[y+f+u,c-w-p-_+d,y+f+A+u,c-w-p+d];case 90:return[y+p+u,c-w+f+d,y+p+_+u,c-w+f+A+d];case 180:return[y-f-A+u,c-w+p+d,y-f+u,c-w+p+_+d];case 270:return[y-p-_+u,c-w-f-A+d,y-p+u,c-w-f+d];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(t,e){const[i,r,l,c]=t,u=l-i,d=c-r;switch(this.rotation){case 0:return[i,e-c,u,d];case 90:return[i,e-r,d,u];case 180:return[l,e-r,u,d];case 270:return[l,e-c,d,u];default:throw new Error("Invalid rotation")}}getPDFRect(){return this.getRect(0,0)}getNonHCMColor(){return this.color&&Zt._colorManager.convert(this._uiManager.getNonHCMColor(this.color))}onUpdatedColor(){this.#n?.onUpdatedColor()}getData(){const{comment:{text:t,color:e,date:i,opacity:r,deleted:l,richText:c},uid:u,pageIndex:d,creationDate:f,modificationDate:p}=this;return{id:u,pageIndex:d,rect:this.getPDFRect(),richText:c,contentsObj:{str:t},creationDate:f,modificationDate:i||p,popupRef:!l,color:e,opacity:r}}onceAdded(t){}isEmpty(){return!1}enableEditMode(){return this.isInEditMode()?!1:(this.parent.setEditingState(!1),this.#y=!0,!0)}disableEditMode(){return this.isInEditMode()?(this.parent.setEditingState(!0),this.#y=!1,!0):!1}isInEditMode(){return this.#y}shouldGetKeyboardEvents(){return this.#v}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}get isOnScreen(){const{top:t,left:e,bottom:i,right:r}=this.getClientDimensions(),{innerHeight:l,innerWidth:c}=window;return e<c&&r>0&&t<l&&i>0}#z(){if(this.#f||!this.div)return;this.#f=new AbortController;const t=this._uiManager.combinedSignal(this.#f);this.div.addEventListener("focusin",this.focusin.bind(this),{signal:t}),this.div.addEventListener("focusout",this.focusout.bind(this),{signal:t})}rebuild(){this.#z()}rotate(t){}resize(){}serializeDeleted(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex,popupRef:this._initialData?.popupRef||""}}serialize(t=!1,e=null){return{annotationType:this.mode,pageIndex:this.pageIndex,rect:this.getPDFRect(),rotation:this.rotation,structTreeParentId:this._structTreeParentId,popupRef:this._initialData?.popupRef||""}}static async deserialize(t,e,i){const r=new this.prototype.constructor({parent:e,id:e.getNextId(),uiManager:i,annotationElementId:t.annotationElementId,creationDate:t.creationDate,modificationDate:t.modificationDate});r.rotation=t.rotation,r.#t=t.accessibilityData,r._isCopy=t.isCopy||!1;const[l,c]=r.pageDimensions,[u,d,f,p]=r.getRectInCurrentCoords(t.rect,c);return r.x=u/l,r.y=d/c,r.width=f/l,r.height=p/c,r}get hasBeenModified(){return!!this.annotationElementId&&(this.deleted||this.serialize()!==null)}remove(){if(this.#f?.abort(),this.#f=null,this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.hideCommentPopup(),this.#b&&(clearTimeout(this.#b),this.#b=null),this.#B(),this.removeEditToolbar(),this.#w){for(const t of this.#w.values())clearTimeout(t);this.#w=null}this.parent=null,this.#C?.destroy(),this.#C=null,this.#h?.remove(),this.#h=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#j(),this.#c.classList.remove("hidden"))}get toolbarPosition(){return null}get commentButtonPosition(){return this._uiManager.direction==="ltr"?[1,0]:[0,0]}get commentButtonPositionInPage(){const{commentButtonPosition:[t,e]}=this,[i,r,l,c]=this.getPDFRect();return[Zt._round(i+(l-i)*t),Zt._round(r+(c-r)*(1-e))]}get commentButtonColor(){return this._uiManager.makeCommentColor(this.getNonHCMColor(),this.opacity)}get commentPopupPosition(){return this.#n.commentPopupPositionInLayer}set commentPopupPosition(t){this.#n.commentPopupPositionInLayer=t}hasDefaultPopupPosition(){return this.#n.hasDefaultPopupPosition()}get commentButtonWidth(){return this.#n.commentButtonWidth}get elementBeforePopup(){return this.div}setCommentButtonStates(t){this.#n?.setCommentButtonStates(t)}keydown(t){if(!this.isResizable||t.target!==this.div||t.key!=="Enter")return;this._uiManager.setSelected(this),this.#d={savedX:this.x,savedY:this.y,savedWidth:this.width,savedHeight:this.height};const e=this.#c.children;if(!this.#e){this.#e=Array.from(e);const c=this.#K.bind(this),u=this.#V.bind(this),d=this._uiManager._signal;for(const f of this.#e){const p=f.getAttribute("data-resizer-name");f.setAttribute("role","spinbutton"),f.addEventListener("keydown",c,{signal:d}),f.addEventListener("blur",u,{signal:d}),f.addEventListener("focus",this.#X.bind(this,p),{signal:d}),f.setAttribute("data-l10n-id",Zt._l10nResizer[p])}}const i=this.#e[0];let r=0;for(const c of e){if(c===i)break;r++}const l=(360-this.rotation+this.parentRotation)%360/90*(this.#e.length/4);if(l!==r){if(l<r)for(let u=0;u<r-l;u++)this.#c.append(this.#c.firstElementChild);else if(l>r)for(let u=0;u<l-r;u++)this.#c.firstElementChild.before(this.#c.lastElementChild);let c=0;for(const u of e){const f=this.#e[c++].getAttribute("data-resizer-name");u.setAttribute("data-l10n-id",Zt._l10nResizer[f])}}this.#H(0),this.#v=!0,this.#c.firstElementChild.focus({focusVisible:!0}),t.preventDefault(),t.stopImmediatePropagation()}#K(t){Zt._resizerKeyboardManager.exec(this,t)}#V(t){this.#v&&t.relatedTarget?.parentNode!==this.#c&&this.#B()}#X(t){this.#g=this.#v?t:""}#H(t){if(this.#e)for(const e of this.#e)e.tabIndex=t}_resizeWithKeyboard(t,e){this.#v&&this.#P(this.#g,{deltaX:t,deltaY:e,fromKeyboard:!0})}#B(){this.#v=!1,this.#H(-1),this.#F()}_stopResizingWithKeyboard(){this.#B(),this.div.focus()}select(){if(this.isSelected&&this._editToolbar){this._editToolbar.show();return}if(this.isSelected=!0,this.makeResizable(),this.div?.classList.add("selectedEditor"),!this._editToolbar){this.addEditToolbar().then(()=>{this.div?.classList.contains("selectedEditor")&&this._editToolbar?.show()});return}this._editToolbar?.show(),this.#i?.toggleAltTextBadge(!1)}focus(){this.div&&!this.div.contains(document.activeElement)&&setTimeout(()=>this.div?.focus({preventScroll:!0}),0)}unselect(){this.isSelected&&(this.isSelected=!1,this.#c?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus({preventScroll:!0}),this._editToolbar?.hide(),this.#i?.toggleAltTextBadge(!0),this.hideCommentPopup())}hideCommentPopup(){this.hasComment&&this._uiManager.toggleComment(null)}updateParams(t,e){}disableEditing(){}enableEditing(){}get canChangeContent(){return!1}enterInEditMode(){this.canChangeContent&&(this.enableEditMode(),this.div.focus())}dblclick(t){t.target.nodeName!=="BUTTON"&&(this.enterInEditMode(),this.parent.updateToolbar({mode:this.constructor._editorType,editId:this.uid}))}getElementForAltText(){return this.div}get contentDiv(){return this.div}get isEditing(){return this.#p}set isEditing(t){this.#p=t,this.parent&&(t?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}static get MIN_SIZE(){return 16}static canCreateNewEmptyEditor(){return!0}get telemetryInitialData(){return{action:"added"}}get telemetryFinalData(){return null}_reportTelemetry(t,e=!1){if(e){this.#w||=new Map;const{action:i}=t;let r=this.#w.get(i);r&&clearTimeout(r),r=setTimeout(()=>{this._reportTelemetry(t),this.#w.delete(i),this.#w.size===0&&(this.#w=null)},Zt._telemetryTimeout),this.#w.set(i,r);return}t.type||=this.editorType,this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",data:t}})}show(t=this._isVisible){this.div.classList.toggle("hidden",!t),this._isVisible=t}enable(){this.div&&(this.div.tabIndex=0),this.#a=!1}disable(){this.div&&(this.div.tabIndex=-1),this.#a=!0}updateFakeAnnotationElement(t){if(!this.#h&&!this.deleted){this.#h=t.addFakeAnnotation(this);return}if(this.deleted){this.#h.remove(),this.#h=null;return}(this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized)&&this.#h.updateEdited({rect:this.getPDFRect(),popup:this.comment})}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;let e=t.container.querySelector(".annotationContent");if(!e)e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),t.container.prepend(e);else if(e.nodeName==="CANVAS"){const i=e;e=document.createElement("div"),e.classList.add("annotationContent",this.editorType),i.before(e)}return e}resetAnnotationElement(t){const{firstElementChild:e}=t.container;e?.nodeName==="DIV"&&e.classList.contains("annotationContent")&&e.remove()}}class YC extends Zt{constructor(t){super(t),this.annotationElementId=t.annotationElementId,this.deleted=!0}serialize(){return this.serializeDeleted()}}const t0=3285377520,Hi=4294901760,xs=65535;class Ow{constructor(t){this.h1=t?t&4294967295:t0,this.h2=t?t&4294967295:t0}update(t){let e,i;if(typeof t=="string"){e=new Uint8Array(t.length*2),i=0;for(let S=0,C=t.length;S<C;S++){const M=t.charCodeAt(S);M<=255?e[i++]=M:(e[i++]=M>>>8,e[i++]=M&255)}}else if(ArrayBuffer.isView(t))e=t.slice(),i=e.byteLength;else throw new Error("Invalid data format, must be a string or TypedArray.");const r=i>>2,l=i-r*4,c=new Uint32Array(e.buffer,0,r);let u=0,d=0,f=this.h1,p=this.h2;const y=3432918353,w=461845907,A=y&xs,_=w&xs;for(let S=0;S<r;S++)S&1?(u=c[S],u=u*y&Hi|u*A&xs,u=u<<15|u>>>17,u=u*w&Hi|u*_&xs,f^=u,f=f<<13|f>>>19,f=f*5+3864292196):(d=c[S],d=d*y&Hi|d*A&xs,d=d<<15|d>>>17,d=d*w&Hi|d*_&xs,p^=d,p=p<<13|p>>>19,p=p*5+3864292196);switch(u=0,l){case 3:u^=e[r*4+2]<<16;case 2:u^=e[r*4+1]<<8;case 1:u^=e[r*4],u=u*y&Hi|u*A&xs,u=u<<15|u>>>17,u=u*w&Hi|u*_&xs,r&1?f^=u:p^=u}this.h1=f,this.h2=p}hexdigest(){let t=this.h1,e=this.h2;return t^=e>>>1,t=t*3981806797&Hi|t*36045&xs,e=e*4283543511&Hi|((e<<16|t>>>16)*2950163797&Hi)>>>16,t^=e>>>1,t=t*444984403&Hi|t*60499&xs,e=e*3301882366&Hi|((e<<16|t>>>16)*3120437893&Hi)>>>16,t^=e>>>1,(t>>>0).toString(16).padStart(8,"0")+(e>>>0).toString(16).padStart(8,"0")}}const tm=Object.freeze({map:null,hash:"",transfer:void 0});class Bm{#t=!1;#e=null;#i=null;#n=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(t,e){const i=this.#n.get(t);return i===void 0?e:Object.assign(e,i)}getRawValue(t){return this.#n.get(t)}remove(t){const e=this.#n.get(t);if(e!==void 0&&(e instanceof Zt&&this.#i.delete(e.annotationElementId),this.#n.delete(t),this.#n.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function")){for(const i of this.#n.values())if(i instanceof Zt)return;this.onAnnotationEditor(null)}}setValue(t,e){const i=this.#n.get(t);let r=!1;if(i!==void 0)for(const[l,c]of Object.entries(e))i[l]!==c&&(r=!0,i[l]=c);else r=!0,this.#n.set(t,e);r&&this.#s(),e instanceof Zt&&((this.#i||=new Map).set(e.annotationElementId,e),typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(e.constructor._type))}has(t){return this.#n.has(t)}get size(){return this.#n.size}#s(){this.#t||(this.#t=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#t&&(this.#t=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new Nw(this)}get serializable(){if(this.#n.size===0)return tm;const t=new Map,e=new Ow,i=[],r=Object.create(null);let l=!1;for(const[c,u]of this.#n){const d=u instanceof Zt?u.serialize(!1,r):u;u.page&&(u.pageIndex=u.page._pageIndex,delete u.page),d&&(t.set(c,d),e.update(`${c}:${JSON.stringify(d)}`),l||=!!d.bitmap)}if(l)for(const c of t.values())c.bitmap&&i.push(c.bitmap);return t.size>0?{map:t,hash:e.hexdigest(),transfer:i}:tm}get editorStats(){let t=null;const e=new Map;let i=0,r=0;for(const l of this.#n.values()){if(!(l instanceof Zt)){l.popup&&(l.popup.deleted?r+=1:i+=1);continue}l.isCommentDeleted?r+=1:l.hasEditedComment&&(i+=1);const c=l.telemetryFinalData;if(!c)continue;const{type:u}=c;e.has(u)||e.set(u,Object.getPrototypeOf(l).constructor),t||=Object.create(null);const d=t[u]||=new Map;for(const[f,p]of Object.entries(c)){if(f==="type")continue;let y=d.get(f);y||(y=new Map,d.set(f,y));const w=y.get(p)??0;y.set(p,w+1)}}if((r>0||i>0)&&(t||=Object.create(null),t.comments={deleted:r,edited:i}),!t)return null;for(const[l,c]of e)t[l]=c.computeTelemetryFinalData(t[l]);return t}resetModifiedIds(){this.#e=null}updateEditor(t,e){const i=this.#i?.get(t);return i?(i.updateFromAnnotationLayer(e),!0):!1}getEditor(t){return this.#i?.get(t)||null}get modifiedIds(){if(this.#e)return this.#e;const t=[];if(this.#i)for(const e of this.#i.values())e.serialize()&&t.push(e.annotationElementId);return this.#e={ids:new Set(t),hash:t.join(",")}}[Symbol.iterator](){return this.#n.entries()}}class Nw extends Bm{#t;constructor(t){super();const{map:e,hash:i,transfer:r}=t.serializable,l=structuredClone(e,r?{transfer:r}:null);this.#t={map:l,hash:i,transfer:r}}get print(){Me("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#t}get modifiedIds(){return ie(this,"modifiedIds",{ids:new Set,hash:""})}}class QC{#t=new Set;constructor({ownerDocument:t=globalThis.document,styleElement:e=null}){this._document=t,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(t){this.nativeFontFaces.add(t),this._document.fonts.add(t)}removeNativeFontFace(t){this.nativeFontFaces.delete(t),this._document.fonts.delete(t)}insertRule(t){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const e=this.styleElement.sheet;e.insertRule(t,e.cssRules.length)}clear(){for(const t of this.nativeFontFaces)this._document.fonts.delete(t);this.nativeFontFaces.clear(),this.#t.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont({systemFontInfo:t,disableFontFace:e,_inspectFont:i}){if(!(!t||this.#t.has(t.loadedName))){if(Re(!e,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:r,src:l,style:c}=t,u=new FontFace(r,l,c);this.addNativeFontFace(u);try{await u.load(),this.#t.add(r),i?.(t)}catch{ne(`Cannot load system font: ${t.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(u)}return}Me("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(t){if(t.attached||t.missingFile&&!t.systemFontInfo)return;if(t.attached=!0,t.systemFontInfo){await this.loadSystemFont(t);return}if(this.isFontLoadingAPISupported){const i=t.createNativeFontFace();if(i){this.addNativeFontFace(i);try{await i.loaded}catch(r){throw ne(`Failed to load font '${i.family}': '${r}'.`),t.disableFontFace=!0,r}}return}const e=t.createFontFaceRule();if(e){if(this.insertRule(e),this.isSyncFontLoadingSupported)return;await new Promise(i=>{const r=this._queueLoadingCallback(i);this._prepareFontLoadEvent(t,r)})}}get isFontLoadingAPISupported(){const t=!!this._document?.fonts;return ie(this,"isFontLoadingAPISupported",t)}get isSyncFontLoadingSupported(){return ie(this,"isSyncFontLoadingSupported",Zn||xn.platform.isFirefox)}_queueLoadingCallback(t){function e(){for(Re(!r.done,"completeRequest() cannot be called twice."),r.done=!0;i.length>0&&i[0].done;){const l=i.shift();setTimeout(l.callback,0)}}const{loadingRequests:i}=this,r={done:!1,complete:e,callback:t};return i.push(r),r}get _loadTestFont(){const t=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return ie(this,"_loadTestFont",t)}_prepareFontLoadEvent(t,e){function i(j,F){return j.charCodeAt(F)<<24|j.charCodeAt(F+1)<<16|j.charCodeAt(F+2)<<8|j.charCodeAt(F+3)&255}function r(j,F,z,H){const ut=j.substring(0,F),ft=j.substring(F+z);return ut+H+ft}let l,c;const u=this._document.createElement("canvas");u.width=1,u.height=1;const d=u.getContext("2d");let f=0;function p(j,F){if(++f>30){ne("Load test font never loaded."),F();return}if(d.font="30px "+j,d.fillText(".",0,20),d.getImageData(0,0,1,1).data[3]>0){F();return}setTimeout(p.bind(null,j,F))}const y=`lt${Date.now()}${this.loadTestFontId++}`;let w=this._loadTestFont;w=r(w,976,y.length,y);const _=16,S=1482184792;let C=i(w,_);for(l=0,c=y.length-3;l<c;l+=4)C=C-S+i(y,l)|0;l<y.length&&(C=C-S+i(y+"XXX",l)|0),w=r(w,_,4,OC(C));const M=`url(data:font/opentype;base64,${btoa(w)});`,k=`@font-face {font-family:"${y}";src:${M}}`;this.insertRule(k);const L=this._document.createElement("div");L.style.visibility="hidden",L.style.width=L.style.height="10px",L.style.position="absolute",L.style.top=L.style.left="0px";for(const j of[t.loadedName,y]){const F=this._document.createElement("span");F.textContent="Hi",F.style.fontFamily=j,L.append(F)}this._document.body.append(L),p(y,()=>{L.remove(),e.complete()})}}class WC{#t;constructor(t,e=null,i,r){this.compiledGlyphs=Object.create(null),this.#t=t,this._inspectFont=e,i&&Object.assign(this,i),r&&(this.charProcOperatorList=r)}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let t;if(!this.cssFontInfo)t=new FontFace(this.loadedName,this.data,{});else{const e={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(e.style=`oblique ${this.cssFontInfo.italicAngle}deg`),t=new FontFace(this.cssFontInfo.fontFamily,this.data,e)}return this._inspectFont?.(this),t}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const t=`url(data:${this.mimetype};base64,${this.data.toBase64()});`;let e;if(!this.cssFontInfo)e=`@font-face {font-family:"${this.loadedName}";src:${t}}`;else{let i=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(i+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),e=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${i}src:${t}}`}return this._inspectFont?.(this,t),e}getPathGenerator(t,e){if(this.compiledGlyphs[e]!==void 0)return this.compiledGlyphs[e];const i=this.loadedName+"_path_"+e;let r;try{r=t.get(i)}catch(c){ne(`getPathGenerator - ignoring character: "${c}".`)}const l=Mw(r?.path);return this.fontExtraProperties||t.delete(i),this.compiledGlyphs[e]=l}get black(){return this.#t.black}get bold(){return this.#t.bold}get disableFontFace(){return this.#t.disableFontFace??!1}set disableFontFace(t){ie(this,"disableFontFace",!!t)}get fontExtraProperties(){return this.#t.fontExtraProperties??!1}get isInvalidPDFjsFont(){return this.#t.isInvalidPDFjsFont}get isType3Font(){return this.#t.isType3Font}get italic(){return this.#t.italic}get missingFile(){return this.#t.missingFile}get remeasure(){return this.#t.remeasure}get vertical(){return this.#t.vertical}get ascent(){return this.#t.ascent}get defaultWidth(){return this.#t.defaultWidth}get descent(){return this.#t.descent}get bbox(){return this.#t.bbox}set bbox(t){ie(this,"bbox",t)}get fontMatrix(){return this.#t.fontMatrix}get fallbackName(){return this.#t.fallbackName}get loadedName(){return this.#t.loadedName}get mimetype(){return this.#t.mimetype}get name(){return this.#t.name}get data(){return this.#t.data}clearData(){this.#t.clearData()}get cssFontInfo(){return this.#t.cssFontInfo}get systemFontInfo(){return this.#t.systemFontInfo}get defaultVMetrics(){return this.#t.defaultVMetrics}}class nl{#t;#e;#i;static strings=["fontFamily","fontWeight","italicAngle"];static write(t){const e=new TextEncoder,i={};let r=0;for(const f of nl.strings){const p=e.encode(t[f]);i[f]=p,r+=4+p.length}const l=new ArrayBuffer(r),c=new Uint8Array(l),u=new DataView(l);let d=0;for(const f of nl.strings){const p=i[f],y=p.length;u.setUint32(d,y),c.set(p,d+4),d+=4+y}return Re(d===l.byteLength,"CssFontInfo.write: Buffer overflow"),l}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}#n(t){Re(t<nl.strings.length,"Invalid string index");let e=0;for(let r=0;r<t;r++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get fontFamily(){return this.#n(0)}get fontWeight(){return this.#n(1)}get italicAngle(){return this.#n(2)}}class il{#t;#e;#i;static strings=["css","loadedName","baseFontName","src"];static write(t){const e=new TextEncoder,i={};let r=0;for(const w of il.strings){const A=e.encode(t[w]);i[w]=A,r+=4+A.length}r+=4;let l,c,u=1+r;t.style&&(l=e.encode(t.style.style),c=e.encode(t.style.weight),u+=4+l.length+4+c.length);const d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;p.setUint8(y++,t.guessFallback?1:0),p.setUint32(y,0),y+=4,r=0;for(const w of il.strings){const A=i[w],_=A.length;r+=4+_,p.setUint32(y,_),f.set(A,y+4),y+=4+_}return p.setUint32(y-r-4,r),t.style&&(p.setUint32(y,l.length),f.set(l,y+4),y+=4+l.length,p.setUint32(y,c.length),f.set(c,y+4),y+=4+c.length),Re(y<=d.byteLength,"SubstitionInfo.write: Buffer overflow"),d.transferToFixedLength(y)}constructor(t){this.#t=t,this.#e=new DataView(this.#t),this.#i=new TextDecoder}get guessFallback(){return this.#e.getUint8(0)!==0}#n(t){Re(t<il.strings.length,"Invalid string index");let e=5;for(let r=0;r<t;r++)e+=this.#e.getUint32(e)+4;const i=this.#e.getUint32(e);return this.#i.decode(new Uint8Array(this.#t,e+4,i))}get css(){return this.#n(0)}get loadedName(){return this.#n(1)}get baseFontName(){return this.#n(2)}get src(){return this.#n(3)}get style(){let t=1;t+=4+this.#e.getUint32(t);const e=this.#e.getUint32(t),i=this.#i.decode(new Uint8Array(this.#t,t+4,e));t+=4+e;const r=this.#e.getUint32(t),l=this.#i.decode(new Uint8Array(this.#t,t+4,r));return{style:i,weight:l}}}class Fe{static bools=["black","bold","disableFontFace","fontExtraProperties","isInvalidPDFjsFont","isType3Font","italic","missingFile","remeasure","vertical"];static numbers=["ascent","defaultWidth","descent"];static strings=["fallbackName","loadedName","mimetype","name"];static#t=Math.ceil(this.bools.length*2/8);static#e=this.#t+this.numbers.length*8;static#i=this.#e+1+8;static#n=this.#i+1+48;static#s=this.#n+1+6;#a;#r;#o;constructor({data:t,extra:e}){this.#a=t,this.#r=new TextDecoder,this.#o=new DataView(this.#a),e&&Object.assign(this,e)}#c(t){Re(t<Fe.bools.length,"Invalid boolean index");const e=Math.floor(t/4),i=t*2%8,r=this.#o.getUint8(e)>>i&3;return r===0?void 0:r===2}get black(){return this.#c(0)}get bold(){return this.#c(1)}get disableFontFace(){return this.#c(2)}get fontExtraProperties(){return this.#c(3)}get isInvalidPDFjsFont(){return this.#c(4)}get isType3Font(){return this.#c(5)}get italic(){return this.#c(6)}get missingFile(){return this.#c(7)}get remeasure(){return this.#c(8)}get vertical(){return this.#c(9)}#l(t){return Re(t<Fe.numbers.length,"Invalid number index"),this.#o.getFloat64(Fe.#t+t*8)}get ascent(){return this.#l(0)}get defaultWidth(){return this.#l(1)}get descent(){return this.#l(2)}get bbox(){let t=Fe.#e;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let r=0;r<4;r++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}get fontMatrix(){let t=Fe.#i;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let r=0;r<6;r++)i.push(this.#o.getFloat64(t,!0)),t+=8;return i}get defaultVMetrics(){let t=Fe.#n;if(this.#o.getUint8(t)===0)return;t+=1;const i=[];for(let r=0;r<3;r++)i.push(this.#o.getInt16(t,!0)),t+=2;return i}#d(t){Re(t<Fe.strings.length,"Invalid string index");let e=Fe.#s+4;for(let l=0;l<t;l++)e+=this.#o.getUint32(e)+4;const i=this.#o.getUint32(e),r=new Uint8Array(i);return r.set(new Uint8Array(this.#a,e+4,i)),this.#r.decode(r)}get fallbackName(){return this.#d(0)}get loadedName(){return this.#d(1)}get mimetype(){return this.#d(2)}get name(){return this.#d(3)}get data(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const r=this.#o.getUint32(t);t+=4+r;const l=this.#o.getUint32(t);if(l!==0)return new Uint8Array(this.#a,t+4,l)}clearData(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const r=this.#o.getUint32(t);t+=4+r;const l=this.#o.getUint32(t);new Uint8Array(this.#a,t+4,l).fill(0),this.#o.setUint32(t,0)}get cssFontInfo(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);t+=4+i;const r=this.#o.getUint32(t);if(r===0)return null;const l=new Uint8Array(r);return l.set(new Uint8Array(this.#a,t+4,r)),new nl(l.buffer)}get systemFontInfo(){let t=Fe.#s;const e=this.#o.getUint32(t);t+=4+e;const i=this.#o.getUint32(t);if(i===0)return null;const r=new Uint8Array(i);return r.set(new Uint8Array(this.#a,t+4,i)),new il(r.buffer)}static write(t){const e=t.systemFontInfo?il.write(t.systemFontInfo):null,i=t.cssFontInfo?nl.write(t.cssFontInfo):null,r=new TextEncoder,l={};let c=0;for(const S of Fe.strings)l[S]=r.encode(t[S]),c+=4+l[S].length;const u=Fe.#s+4+c+4+(e?e.byteLength:0)+4+(i?i.byteLength:0)+4+(t.data?t.data.length:0),d=new ArrayBuffer(u),f=new Uint8Array(d),p=new DataView(d);let y=0;const w=Fe.bools.length;let A=0,_=0;for(let S=0;S<w;S++){const C=t[Fe.bools[S]];A|=(C===void 0?0:C?2:1)<<_,_+=2,(_===8||S===w-1)&&(p.setUint8(y++,A),A=0,_=0)}Re(y===Fe.#t,"FontInfo.write: Boolean properties offset mismatch");for(const S of Fe.numbers)p.setFloat64(y,t[S]),y+=8;if(Re(y===Fe.#e,"FontInfo.write: Number properties offset mismatch"),t.bbox){p.setUint8(y++,4);for(const S of t.bbox)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=8;if(Re(y===Fe.#i,"FontInfo.write: BBox properties offset mismatch"),t.fontMatrix){p.setUint8(y++,6);for(const S of t.fontMatrix)p.setFloat64(y,S,!0),y+=8}else p.setUint8(y++,0),y+=48;if(Re(y===Fe.#n,"FontInfo.write: FontMatrix properties offset mismatch"),t.defaultVMetrics){p.setUint8(y++,1);for(const S of t.defaultVMetrics)p.setInt16(y,S,!0),y+=2}else p.setUint8(y++,0),y+=6;Re(y===Fe.#s,"FontInfo.write: DefaultVMetrics properties offset mismatch"),p.setUint32(Fe.#s,0),y+=4;for(const S of Fe.strings){const C=l[S],M=C.length;p.setUint32(y,M),f.set(C,y+4),y+=4+M}if(p.setUint32(Fe.#s,y-Fe.#s-4),!e)p.setUint32(y,0),y+=4;else{const S=e.byteLength;p.setUint32(y,S),Re(y+4+S<=d.byteLength,"FontInfo.write: Buffer overflow at systemFontInfo"),f.set(new Uint8Array(e),y+4),y+=4+S}if(!i)p.setUint32(y,0),y+=4;else{const S=i.byteLength;p.setUint32(y,S),Re(y+4+S<=d.byteLength,"FontInfo.write: Buffer overflow at cssFontInfo"),f.set(new Uint8Array(i),y+4),y+=4+S}return t.data===void 0?(p.setUint32(y,0),y+=4):(p.setUint32(y,t.data.length),f.set(t.data,y+4),y+=4+t.data.length),Re(y<=d.byteLength,"FontInfo.write: Buffer overflow"),d.transferToFixedLength(y)}}class Tn{static#t=0;static#e=1;static#i=2;static#n=3;static#s=4;static#a=8;static#r=12;static#o=16;constructor(t){this.buffer=t,this.view=new DataView(t),this.data=new Uint8Array(t)}static write(t){let e,i=null,r=[],l=[],c=[],u=[],d=null,f=null;switch(t[0]){case"RadialAxial":e=t[1]==="axial"?1:2,i=t[2],c=t[3],e===1?r.push(...t[4],...t[5]):r.push(t[4][0],t[4][1],t[6],t[5][0],t[5][1],t[7]);break;case"Mesh":e=3,d=t[1],r=t[2],l=t[3],u=t[4]||[],i=t[6],f=t[7];break;default:throw new Error(`Unsupported pattern type: ${t[0]}`)}const p=Math.floor(r.length/2),y=Math.floor(l.length/3),w=c.length,A=u.length;let _=0;for(const F of u)_+=1,_=Math.ceil(_/4)*4,_+=4+F.coords.length*4,_+=4+F.colors.length*4,F.verticesPerRow!==void 0&&(_+=4);const S=20+p*8+y*3+w*8+(i?16:0)+(f?3:0)+_,C=new ArrayBuffer(S),M=new DataView(C),k=new Uint8Array(C);M.setUint8(Tn.#t,e),M.setUint8(Tn.#e,i?1:0),M.setUint8(Tn.#i,f?1:0),M.setUint8(Tn.#n,d),M.setUint32(Tn.#s,p,!0),M.setUint32(Tn.#a,y,!0),M.setUint32(Tn.#r,w,!0),M.setUint32(Tn.#o,A,!0);let L=20;new Float32Array(C,L,p*2).set(r),L+=p*8,k.set(l,L),L+=y*3;for(const[F,z]of c)M.setFloat32(L,F,!0),L+=4,M.setUint32(L,parseInt(z.slice(1),16),!0),L+=4;if(i)for(const F of i)M.setFloat32(L,F,!0),L+=4;f&&(k.set(f,L),L+=3);for(let F=0;F<u.length;F++){const z=u[F];M.setUint8(L,z.type),L+=1,L=Math.ceil(L/4)*4,M.setUint32(L,z.coords.length,!0),L+=4,new Int32Array(C,L,z.coords.length).set(z.coords),L+=z.coords.length*4,M.setUint32(L,z.colors.length,!0),L+=4,new Int32Array(C,L,z.colors.length).set(z.colors),L+=z.colors.length*4,z.verticesPerRow!==void 0&&(M.setUint32(L,z.verticesPerRow,!0),L+=4)}return C}getIR(){const t=this.view,e=this.data[Tn.#t],i=!!this.data[Tn.#e],r=!!this.data[Tn.#i],l=t.getUint32(Tn.#s,!0),c=t.getUint32(Tn.#a,!0),u=t.getUint32(Tn.#r,!0),d=t.getUint32(Tn.#o,!0);let f=20;const p=new Float32Array(this.buffer,f,l*2);f+=l*8;const y=new Uint8Array(this.buffer,f,c*3);f+=c*3;const w=[];for(let C=0;C<u;++C){const M=t.getFloat32(f,!0);f+=4;const k=t.getUint32(f,!0);f+=4,w.push([M,`#${k.toString(16).padStart(6,"0")}`])}let A=null;if(i){A=[];for(let C=0;C<4;++C)A.push(t.getFloat32(f,!0)),f+=4}let _=null;r&&(_=new Uint8Array(this.buffer,f,3),f+=3);const S=[];for(let C=0;C<d;++C){const M=t.getUint8(f);f+=1,f=Math.ceil(f/4)*4;const k=t.getUint32(f,!0);f+=4;const L=new Int32Array(this.buffer,f,k);f+=k*4;const j=t.getUint32(f,!0);f+=4;const F=new Int32Array(this.buffer,f,j);f+=j*4;const z={type:M,coords:L,colors:F};M===Yp.LATTICE&&(z.verticesPerRow=t.getUint32(f,!0),f+=4),S.push(z)}if(e===1)return["RadialAxial","axial",A,w,Array.from(p.slice(0,2)),Array.from(p.slice(2,4)),null,null];if(e===2)return["RadialAxial","radial",A,w,[p[0],p[1]],[p[3],p[4]],p[2],p[5]];if(e===3){const C=this.data[Tn.#n];let M=null;if(p.length>0){let k=p[0],L=p[0],j=p[1],F=p[1];for(let z=0;z<p.length;z+=2){const H=p[z],ut=p[z+1];k=k>H?H:k,j=j>ut?ut:j,L=L<H?H:L,F=F<ut?ut:F}M=[k,j,L,F]}return["Mesh",C,p,y,S,M,A,_]}throw new Error(`Unsupported pattern kind: ${e}`)}}class ZC{static write(t){let e,i;return xn.isFloat16ArraySupported?(i=new ArrayBuffer(t.length*2),e=new Float16Array(i)):(i=new ArrayBuffer(t.length*4),e=new Float32Array(i)),e.set(t),i}#t;constructor(t){this.#t=t}get path(){return xn.isFloat16ArraySupported?new Float16Array(this.#t):new Float32Array(this.#t)}}function JC(a){if(a instanceof URL)return a.href;if(typeof a=="string"){if(Zn)return a;const t=URL.parse(a,window.location);if(t)return t.href}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function tT(a){if(Zn&&typeof Buffer<"u"&&a instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength)return a;if(typeof a=="string")return sd(a);if(a instanceof ArrayBuffer||ArrayBuffer.isView(a)||typeof a=="object"&&!isNaN(a?.length))return new Uint8Array(a);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}function yh(a){if(typeof a!="string")return null;if(a.endsWith("/"))return a;throw new Error(`Invalid factory url: "${a}" must include trailing slash.`)}const em=a=>typeof a=="object"&&Number.isInteger(a?.num)&&a.num>=0&&Number.isInteger(a?.gen)&&a.gen>=0,eT=a=>typeof a=="object"&&typeof a?.name=="string",nT=BC.bind(null,em,eT);class iT{#t=new Map;#e=Promise.resolve();postMessage(t,e){const i={data:structuredClone(t,e?{transfer:e}:null)};this.#e.then(()=>{for(const[r]of this.#t)r.call(this,i)})}addEventListener(t,e,i=null){let r=null;if(i?.signal instanceof AbortSignal){const{signal:l}=i;if(l.aborted){ne("LoopbackPort - cannot use an `aborted` signal.");return}const c=()=>this.removeEventListener(t,e);r=()=>l.removeEventListener("abort",c),l.addEventListener("abort",c)}this.#t.set(e,r)}removeEventListener(t,e){this.#t.get(e)?.(),this.#t.delete(e)}terminate(){for(const[,t]of this.#t)t?.();this.#t.clear()}}const bh={DATA:1,ERROR:2},gn={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function e0(){}function ui(a){if(a instanceof Zr||a instanceof Qp||a instanceof Kv||a instanceof Gh||a instanceof Ap)return a;switch(a instanceof Error||typeof a=="object"&&a!==null||Me('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),a.name){case"AbortException":return new Zr(a.message);case"InvalidPDFException":return new Qp(a.message);case"PasswordException":return new Kv(a.message,a.code);case"ResponseException":return new Gh(a.message,a.status,a.missing);case"UnknownErrorException":return new Ap(a.message,a.details)}return new Ap(a.message,a.toString())}class Rc{#t=new AbortController;constructor(t,e,i){this.sourceName=t,this.targetName=e,this.comObj=i,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),i.addEventListener("message",this.#e.bind(this),{signal:this.#t.signal})}#e({data:t}){if(t.targetName!==this.sourceName)return;if(t.stream){this.#n(t);return}if(t.callback){const i=t.callbackId,r=this.callbackCapabilities[i];if(!r)throw new Error(`Cannot resolve callback ${i}`);if(delete this.callbackCapabilities[i],t.callback===bh.DATA)r.resolve(t.data);else if(t.callback===bh.ERROR)r.reject(ui(t.reason));else throw new Error("Unexpected callback case");return}const e=this.actionHandler[t.action];if(!e)throw new Error(`Unknown action from worker: ${t.action}`);if(t.callbackId){const i=this.sourceName,r=t.sourceName,l=this.comObj;Promise.try(e,t.data).then(function(c){l.postMessage({sourceName:i,targetName:r,callback:bh.DATA,callbackId:t.callbackId,data:c})},function(c){l.postMessage({sourceName:i,targetName:r,callback:bh.ERROR,callbackId:t.callbackId,reason:ui(c)})});return}if(t.streamId){this.#i(t);return}e(t.data)}on(t,e){const i=this.actionHandler;if(i[t])throw new Error(`There is already an actionName called "${t}"`);i[t]=e}send(t,e,i){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,data:e},i)}sendWithPromise(t,e,i){const r=this.callbackId++,l=Promise.withResolvers();this.callbackCapabilities[r]=l;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:t,callbackId:r,data:e},i)}catch(c){l.reject(c)}return l.promise}sendWithStream(t,e,i,r){const l=this.streamId++,c=this.sourceName,u=this.targetName,d=this.comObj;return new ReadableStream({start:f=>{const p=Promise.withResolvers();return this.streamControllers[l]={controller:f,startCall:p,pullCall:null,cancelCall:null,isClosed:!1},d.postMessage({sourceName:c,targetName:u,action:t,streamId:l,data:e,desiredSize:f.desiredSize},r),p.promise},pull:f=>{const p=Promise.withResolvers();return this.streamControllers[l].pullCall=p,d.postMessage({sourceName:c,targetName:u,stream:gn.PULL,streamId:l,desiredSize:f.desiredSize}),p.promise},cancel:f=>{Re(f instanceof Error,"cancel must have a valid reason");const p=Promise.withResolvers();return this.streamControllers[l].cancelCall=p,this.streamControllers[l].isClosed=!0,d.postMessage({sourceName:c,targetName:u,stream:gn.CANCEL,streamId:l,reason:ui(f)}),p.promise}},i)}#i(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,l=this.comObj,c=this,u=this.actionHandler[t.action],d={enqueue(f,p=1,y){if(this.isCancelled)return;const w=this.desiredSize;this.desiredSize-=p,w>0&&this.desiredSize<=0&&(this.sinkCapability=Promise.withResolvers(),this.ready=this.sinkCapability.promise),l.postMessage({sourceName:i,targetName:r,stream:gn.ENQUEUE,streamId:e,chunk:f},y)},close(){this.isCancelled||(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:r,stream:gn.CLOSE,streamId:e}),delete c.streamSinks[e])},error(f){Re(f instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,l.postMessage({sourceName:i,targetName:r,stream:gn.ERROR,streamId:e,reason:ui(f)}))},sinkCapability:Promise.withResolvers(),onPull:null,onCancel:null,isCancelled:!1,desiredSize:t.desiredSize,ready:null};d.sinkCapability.resolve(),d.ready=d.sinkCapability.promise,this.streamSinks[e]=d,Promise.try(u,t.data,d).then(function(){l.postMessage({sourceName:i,targetName:r,stream:gn.START_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:r,stream:gn.START_COMPLETE,streamId:e,reason:ui(f)})})}#n(t){const e=t.streamId,i=this.sourceName,r=t.sourceName,l=this.comObj,c=this.streamControllers[e],u=this.streamSinks[e];switch(t.stream){case gn.START_COMPLETE:t.success?c.startCall.resolve():c.startCall.reject(ui(t.reason));break;case gn.PULL_COMPLETE:t.success?c.pullCall.resolve():c.pullCall.reject(ui(t.reason));break;case gn.PULL:if(!u){l.postMessage({sourceName:i,targetName:r,stream:gn.PULL_COMPLETE,streamId:e,success:!0});break}u.desiredSize<=0&&t.desiredSize>0&&u.sinkCapability.resolve(),u.desiredSize=t.desiredSize,Promise.try(u.onPull||e0).then(function(){l.postMessage({sourceName:i,targetName:r,stream:gn.PULL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:r,stream:gn.PULL_COMPLETE,streamId:e,reason:ui(f)})});break;case gn.ENQUEUE:if(Re(c,"enqueue should have stream controller"),c.isClosed)break;c.controller.enqueue(t.chunk);break;case gn.CLOSE:if(Re(c,"close should have stream controller"),c.isClosed)break;c.isClosed=!0,c.controller.close(),this.#s(c,e);break;case gn.ERROR:Re(c,"error should have stream controller"),c.controller.error(ui(t.reason)),this.#s(c,e);break;case gn.CANCEL_COMPLETE:t.success?c.cancelCall.resolve():c.cancelCall.reject(ui(t.reason)),this.#s(c,e);break;case gn.CANCEL:if(!u)break;const d=ui(t.reason);Promise.try(u.onCancel||e0,d).then(function(){l.postMessage({sourceName:i,targetName:r,stream:gn.CANCEL_COMPLETE,streamId:e,success:!0})},function(f){l.postMessage({sourceName:i,targetName:r,stream:gn.CANCEL_COMPLETE,streamId:e,reason:ui(f)})}),u.sinkCapability.reject(d),u.isCancelled=!0,delete this.streamSinks[e];break;default:throw new Error("Unexpected stream case")}}async#s(t,e){await Promise.allSettled([t.startCall?.promise,t.pullCall?.promise,t.cancelCall?.promise]),delete this.streamControllers[e]}destroy(){this.#t?.abort(),this.#t=null}}class kw{#t=!1;constructor({enableHWA:t=!1}){this.#t=t}create(t,e){if(t<=0||e<=0)throw new Error("Invalid canvas size");const i=this._createCanvas(t,e);return{canvas:i,context:i.getContext("2d",{willReadFrequently:!this.#t})}}reset(t,e,i){if(!t.canvas)throw new Error("Canvas is not specified");if(e<=0||i<=0)throw new Error("Invalid canvas size");t.canvas.width=e,t.canvas.height=i}destroy(t){if(!t.canvas)throw new Error("Canvas is not specified");t.canvas.width=0,t.canvas.height=0,t.canvas=null,t.context=null}_createCanvas(t,e){Me("Abstract method `_createCanvas` called.")}}class sT extends kw{constructor({ownerDocument:t=globalThis.document,enableHWA:e=!1}){super({enableHWA:e}),this._document=t}_createCanvas(t,e){const i=this._document.createElement("canvas");return i.width=t,i.height=e,i}}class Lw{constructor({baseUrl:t=null,isCompressed:e=!0}){this.baseUrl=t,this.isCompressed=e}async fetch({name:t}){if(!this.baseUrl)throw new Error("Ensure that the `cMapUrl` and `cMapPacked` API parameters are provided.");if(!t)throw new Error("CMap name must be specified.");const e=this.baseUrl+t+(this.isCompressed?".bcmap":"");return this._fetch(e).then(i=>({cMapData:i,isCompressed:this.isCompressed})).catch(i=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class n0 extends Lw{async _fetch(t){const e=await Vc(t,this.isCompressed?"arraybuffer":"text");return e instanceof ArrayBuffer?new Uint8Array(e):sd(e)}}class Pw{addFilter(t){return"none"}addHCMFilter(t,e){return"none"}addAlphaFilter(t){return"none"}addLuminosityFilter(t){return"none"}addHighlightHCMFilter(t,e,i,r,l){return"none"}destroy(t=!1){}}class rT extends Pw{#t;#e;#i;#n;#s;#a;#r=0;constructor({docId:t,ownerDocument:e=globalThis.document}){super(),this.#n=t,this.#s=e}get#o(){return this.#e||=new Map}get#c(){return this.#a||=new Map}get#l(){if(!this.#i){const t=this.#s.createElement("div"),{style:e}=t;e.visibility="hidden",e.contain="strict",e.width=e.height=0,e.position="absolute",e.top=e.left=0,e.zIndex=-1;const i=this.#s.createElementNS(sr,"svg");i.setAttribute("width",0),i.setAttribute("height",0),this.#i=this.#s.createElementNS(sr,"defs"),t.append(i),i.append(this.#i),this.#s.body.append(t)}return this.#i}#d(t){if(t.length===1){const d=t[0],f=new Array(256);for(let y=0;y<256;y++)f[y]=d[y]/255;const p=f.join(",");return[p,p,p]}const[e,i,r]=t,l=new Array(256),c=new Array(256),u=new Array(256);for(let d=0;d<256;d++)l[d]=e[d]/255,c[d]=i[d]/255,u[d]=r[d]/255;return[l.join(","),c.join(","),u.join(",")]}#h(t){if(this.#t===void 0){this.#t="";const e=this.#s.URL;e!==this.#s.baseURI&&(rd(e)?ne('#createUrl: ignore "data:"-URL for performance reasons.'):this.#t=_w(e,""))}return`url(${this.#t}#${t})`}addFilter(t){if(!t)return"none";let e=this.#o.get(t);if(e)return e;const[i,r,l]=this.#d(t),c=t.length===1?i:`${i}${r}${l}`;if(e=this.#o.get(c),e)return this.#o.set(t,e),e;const u=`g_${this.#n}_transfer_map_${this.#r++}`,d=this.#h(u);this.#o.set(t,d),this.#o.set(c,d);const f=this.#m(u);return this.#p(i,r,l,f),d}addHCMFilter(t,e){const i=`${t}-${e}`,r="base";let l=this.#c.get(r);if(l?.key===i||(l?(l.filter?.remove(),l.key=i,l.url="none",l.filter=null):(l={key:i,url:"none",filter:null},this.#c.set(r,l)),!t||!e))return l.url;const c=this.#v(t);t=qt.makeHexColor(...c);const u=this.#v(e);if(e=qt.makeHexColor(...u),this.#l.style.color="",t==="#000000"&&e==="#ffffff"||t===e)return l.url;const d=new Array(256);for(let A=0;A<=255;A++){const _=A/255;d[A]=_<=.03928?_/12.92:((_+.055)/1.055)**2.4}const f=d.join(","),p=`g_${this.#n}_hcm_filter`,y=l.filter=this.#m(p);this.#p(f,f,f,y),this.#g(y);const w=(A,_)=>{const S=c[A]/255,C=u[A]/255,M=new Array(_+1);for(let k=0;k<=_;k++)M[k]=S+k/_*(C-S);return M.join(",")};return this.#p(w(0,5),w(1,5),w(2,5),y),l.url=this.#h(p),l.url}addAlphaFilter(t){let e=this.#o.get(t);if(e)return e;const[i]=this.#d([t]),r=`alpha_${i}`;if(e=this.#o.get(r),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_alpha_map_${this.#r++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(r,c);const u=this.#m(l);return this.#y(i,u),c}addLuminosityFilter(t){let e=this.#o.get(t||"luminosity");if(e)return e;let i,r;if(t?([i]=this.#d([t]),r=`luminosity_${i}`):r="luminosity",e=this.#o.get(r),e)return this.#o.set(t,e),e;const l=`g_${this.#n}_luminosity_map_${this.#r++}`,c=this.#h(l);this.#o.set(t,c),this.#o.set(r,c);const u=this.#m(l);return this.#f(u),t&&this.#y(i,u),c}addHighlightHCMFilter(t,e,i,r,l){const c=`${e}-${i}-${r}-${l}`;let u=this.#c.get(t);if(u?.key===c||(u?(u.filter?.remove(),u.key=c,u.url="none",u.filter=null):(u={key:c,url:"none",filter:null},this.#c.set(t,u)),!e||!i))return u.url;const[d,f]=[e,i].map(this.#v.bind(this));let p=Math.round(.2126*d[0]+.7152*d[1]+.0722*d[2]),y=Math.round(.2126*f[0]+.7152*f[1]+.0722*f[2]),[w,A]=[r,l].map(this.#v.bind(this));y<p&&([p,y,w,A]=[y,p,A,w]),this.#l.style.color="";const _=(M,k,L)=>{const j=new Array(256),F=(y-p)/L,z=M/255,H=(k-M)/(255*L);let ut=0;for(let ft=0;ft<=L;ft++){const _t=Math.round(p+ft*F),ct=z+ft*H;for(let Tt=ut;Tt<=_t;Tt++)j[Tt]=ct;ut=_t+1}for(let ft=ut;ft<256;ft++)j[ft]=j[ut-1];return j.join(",")},S=`g_${this.#n}_hcm_${t}_filter`,C=u.filter=this.#m(S);return this.#g(C),this.#p(_(w[0],A[0],5),_(w[1],A[1],5),_(w[2],A[2],5),C),u.url=this.#h(S),u.url}destroy(t=!1){t&&this.#a?.size||(this.#i?.parentNode.parentNode.remove(),this.#i=null,this.#e?.clear(),this.#e=null,this.#a?.clear(),this.#a=null,this.#r=0)}#f(t){const e=this.#s.createElementNS(sr,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0.59 0.11 0 0"),t.append(e)}#g(t){const e=this.#s.createElementNS(sr,"feColorMatrix");e.setAttribute("type","matrix"),e.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),t.append(e)}#m(t){const e=this.#s.createElementNS(sr,"filter");return e.setAttribute("color-interpolation-filters","sRGB"),e.setAttribute("id",t),this.#l.append(e),e}#u(t,e,i){const r=this.#s.createElementNS(sr,e);r.setAttribute("type","discrete"),r.setAttribute("tableValues",i),t.append(r)}#p(t,e,i,r){const l=this.#s.createElementNS(sr,"feComponentTransfer");r.append(l),this.#u(l,"feFuncR",t),this.#u(l,"feFuncG",e),this.#u(l,"feFuncB",i)}#y(t,e){const i=this.#s.createElementNS(sr,"feComponentTransfer");e.append(i),this.#u(i,"feFuncA",t)}#v(t){return this.#l.style.color=t,Xc(getComputedStyle(this.#l).getPropertyValue("color"))}}class Bw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `standardFontDataUrl` API parameter is provided.");if(!t)throw new Error("Font filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load font data at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class i0 extends Bw{async _fetch(t){const e=await Vc(t,"arraybuffer");return new Uint8Array(e)}}class jw{constructor({baseUrl:t=null}){this.baseUrl=t}async fetch({filename:t}){if(!this.baseUrl)throw new Error("Ensure that the `wasmUrl` API parameter is provided.");if(!t)throw new Error("Wasm filename must be specified.");const e=`${this.baseUrl}${t}`;return this._fetch(e).catch(i=>{throw new Error(`Unable to load wasm data at: ${e}`)})}async _fetch(t){Me("Abstract method `_fetch` called.")}}class s0 extends jw{async _fetch(t){const e=await Vc(t,"arraybuffer");return new Uint8Array(e)}}Zn&&ne("Please use the `legacy` build in Node.js environments.");async function jm(a){const e=await process.getBuiltinModule("fs").promises.readFile(a);return new Uint8Array(e)}class aT extends Pw{}class oT extends kw{_createCanvas(t,e){return process.getBuiltinModule("module").createRequire(import.meta.url)("@napi-rs/canvas").createCanvas(t,e)}}class lT extends Lw{async _fetch(t){return jm(t)}}class cT extends Bw{async _fetch(t){return jm(t)}}class uT extends jw{async _fetch(t){return jm(t)}}const Yo="__forcedDependency",{floor:r0,ceil:a0}=Math;function vh(a,t,e,i,r,l){a[t*4+0]=Math.min(a[t*4+0],e),a[t*4+1]=Math.min(a[t*4+1],i),a[t*4+2]=Math.max(a[t*4+2],r),a[t*4+3]=Math.max(a[t*4+3],l)}const nm=new Uint32Array(new Uint8Array([255,255,0,0]).buffer)[0];class hT{#t;#e;constructor(t,e){this.#t=t,this.#e=e}get length(){return this.#t.length}isEmpty(t){return this.#t[t]===nm}minX(t){return this.#e[t*4+0]/256}minY(t){return this.#e[t*4+1]/256}maxX(t){return(this.#e[t*4+2]+1)/256}maxY(t){return(this.#e[t*4+3]+1)/256}}const wh=(a,t)=>{if(!a)return;let e=a.get(t);return e||(e={dependencies:new Set,isRenderingOperation:!1},a.set(t,e)),e};class dT{#t={__proto__:null};#e={__proto__:null,transform:[],moveText:[],sameLineText:[],[Yo]:[]};#i=new Map;#n=[];#s=[];#a=[[1,0,0,1,0,0]];#r=[-1/0,-1/0,1/0,1/0];#o=new Float64Array([1/0,1/0,-1/0,-1/0]);#c=-1;#l=new Set;#d=new Map;#h=new Map;#f;#g;#m;#u;#p;constructor(t,e,i=!1){this.#f=t.width,this.#g=t.height,this.#y(e),i&&(this.#p=new Map)}growOperationsCount(t){t>=this.#u.length&&this.#y(t,this.#u)}#y(t,e){const i=new ArrayBuffer(t*4);this.#m=new Uint8ClampedArray(i),this.#u=new Uint32Array(i),e&&e.length>0?(this.#u.set(e),this.#u.fill(nm,e.length)):this.#u.fill(nm)}save(t){return this.#t={__proto__:this.#t},this.#e={__proto__:this.#e,transform:{__proto__:this.#e.transform},moveText:{__proto__:this.#e.moveText},sameLineText:{__proto__:this.#e.sameLineText},[Yo]:{__proto__:this.#e[Yo]}},this.#r={__proto__:this.#r},this.#n.push(t),this}restore(t){const e=Object.getPrototypeOf(this.#t);if(e===null)return this;this.#t=e,this.#e=Object.getPrototypeOf(this.#e),this.#r=Object.getPrototypeOf(this.#r);const i=this.#n.pop();return i!==void 0&&(wh(this.#p,t)?.dependencies.add(i),this.#u[t]=this.#u[i]),this}recordOpenMarker(t){return this.#n.push(t),this}getOpenMarker(){return this.#n.length===0?null:this.#n.at(-1)}recordCloseMarker(t){const e=this.#n.pop();return e!==void 0&&(wh(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}beginMarkedContent(t){return this.#s.push(t),this}endMarkedContent(t){const e=this.#s.pop();return e!==void 0&&(wh(this.#p,t)?.dependencies.add(e),this.#u[t]=this.#u[e]),this}pushBaseTransform(t){return this.#a.push(qt.multiplyByDOMMatrix(this.#a.at(-1),t.getTransform())),this}popBaseTransform(){return this.#a.length>1&&this.#a.pop(),this}recordSimpleData(t,e){return this.#t[t]=e,this}recordIncrementalData(t,e){return this.#e[t].push(e),this}resetIncrementalData(t,e){return this.#e[t].length=0,this}recordNamedData(t,e){return this.#i.set(t,e),this}recordSimpleDataFromNamed(t,e,i){this.#t[t]=this.#i.get(e)??i}recordFutureForcedDependency(t,e){return this.recordIncrementalData(Yo,e),this}inheritSimpleDataAsFutureForcedDependencies(t){for(const e of t)e in this.#t&&this.recordFutureForcedDependency(e,this.#t[e]);return this}inheritPendingDependenciesAsFutureForcedDependencies(){for(const t of this.#l)this.recordFutureForcedDependency(Yo,t);return this}resetBBox(t){return this.#c!==t&&(this.#c=t,this.#o[0]=1/0,this.#o[1]=1/0,this.#o[2]=-1/0,this.#o[3]=-1/0),this}recordClipBox(t,e,i,r,l,c){const u=qt.multiplyByDOMMatrix(this.#a.at(-1),e.getTransform()),d=[1/0,1/0,-1/0,-1/0];qt.axialAlignedBoundingBox([i,l,r,c],u,d);const f=qt.intersect(this.#r,d);return f?(this.#r[0]=f[0],this.#r[1]=f[1],this.#r[2]=f[2],this.#r[3]=f[3]):(this.#r[0]=this.#r[1]=1/0,this.#r[2]=this.#r[3]=-1/0),this}recordBBox(t,e,i,r,l,c){const u=this.#r;if(u[0]===1/0)return this;const d=qt.multiplyByDOMMatrix(this.#a.at(-1),e.getTransform());if(u[0]===-1/0)return qt.axialAlignedBoundingBox([i,l,r,c],d,this.#o),this;const f=[1/0,1/0,-1/0,-1/0];return qt.axialAlignedBoundingBox([i,l,r,c],d,f),this.#o[0]=Math.min(this.#o[0],Math.max(f[0],u[0])),this.#o[1]=Math.min(this.#o[1],Math.max(f[1],u[1])),this.#o[2]=Math.max(this.#o[2],Math.min(f[2],u[2])),this.#o[3]=Math.max(this.#o[3],Math.min(f[3],u[3])),this}recordCharacterBBox(t,e,i,r=1,l=0,c=0,u){const d=i.bbox;let f,p;if(d&&(f=d[2]!==d[0]&&d[3]!==d[1]&&this.#h.get(i),f!==!1&&(p=[0,0,0,0],qt.axialAlignedBoundingBox(d,i.fontMatrix,p),(r!==1||l!==0||c!==0)&&qt.scaleMinMax([r,0,0,-r,l,c],p),f)))return this.recordBBox(t,e,p[0],p[2],p[1],p[3]);if(!u)return this.recordFullPageBBox(t);const y=u();return d&&p&&f===void 0&&(f=p[0]<=l-y.actualBoundingBoxLeft&&p[2]>=l+y.actualBoundingBoxRight&&p[1]<=c-y.actualBoundingBoxAscent&&p[3]>=c+y.actualBoundingBoxDescent,this.#h.set(i,f),f)?this.recordBBox(t,e,p[0],p[2],p[1],p[3]):this.recordBBox(t,e,l-y.actualBoundingBoxLeft,l+y.actualBoundingBoxRight,c-y.actualBoundingBoxAscent,c+y.actualBoundingBoxDescent)}recordFullPageBBox(t){return this.#o[0]=Math.max(0,this.#r[0]),this.#o[1]=Math.max(0,this.#r[1]),this.#o[2]=Math.min(this.#f,this.#r[2]),this.#o[3]=Math.min(this.#g,this.#r[3]),this}getSimpleIndex(t){return this.#t[t]}recordDependencies(t,e){const i=this.#l,r=this.#t,l=this.#e;for(const c of e)c in this.#t?i.add(r[c]):c in l&&l[c].forEach(i.add,i);return this}recordNamedDependency(t,e){return this.#i.has(e)&&this.#l.add(this.#i.get(e)),this}recordOperation(t,e=!1){if(this.recordDependencies(t,[Yo]),this.#p){const i=wh(this.#p,t),{dependencies:r}=i;this.#l.forEach(r.add,r),this.#n.forEach(r.add,r),this.#s.forEach(r.add,r),r.delete(t),i.isRenderingOperation=!0}if(this.#c===t){const i=r0(this.#o[0]*256/this.#f),r=r0(this.#o[1]*256/this.#g),l=a0(this.#o[2]*256/this.#f),c=a0(this.#o[3]*256/this.#g);vh(this.#m,t,i,r,l,c);for(const u of this.#l)u!==t&&vh(this.#m,u,i,r,l,c);for(const u of this.#n)u!==t&&vh(this.#m,u,i,r,l,c);for(const u of this.#s)u!==t&&vh(this.#m,u,i,r,l,c);e||(this.#l.clear(),this.#c=-1)}return this}recordShowTextOperation(t,e=!1){const i=Array.from(this.#l);this.recordOperation(t,e),this.recordIncrementalData("sameLineText",t);for(const r of i)this.recordIncrementalData("sameLineText",r);return this}bboxToClipBoxDropOperation(t,e=!1){return this.#c===t&&(this.#c=-1,this.#r[0]=Math.max(this.#r[0],this.#o[0]),this.#r[1]=Math.max(this.#r[1],this.#o[1]),this.#r[2]=Math.min(this.#r[2],this.#o[2]),this.#r[3]=Math.min(this.#r[3],this.#o[3]),e||this.#l.clear()),this}_takePendingDependencies(){const t=this.#l;return this.#l=new Set,t}_extractOperation(t){const e=this.#d.get(t);return this.#d.delete(t),e}_pushPendingDependencies(t){for(const e of t)this.#l.add(e)}take(){return this.#h.clear(),new hT(this.#u,this.#m)}takeDebugMetadata(){return this.#p}}class $h{#t;#e;#i;#n=0;#s=0;constructor(t,e,i){if(t instanceof $h&&t.#i===!!i)return t;this.#t=t,this.#e=e,this.#i=!!i}growOperationsCount(){throw new Error("Unreachable")}save(t){return this.#s++,this.#t.save(this.#e),this}restore(t){return this.#s>0&&(this.#t.restore(this.#e),this.#s--),this}recordOpenMarker(t){return this.#n++,this}getOpenMarker(){return this.#n>0?this.#e:this.#t.getOpenMarker()}recordCloseMarker(t){return this.#n--,this}beginMarkedContent(t){return this}endMarkedContent(t){return this}pushBaseTransform(t){return this.#t.pushBaseTransform(t),this}popBaseTransform(){return this.#t.popBaseTransform(),this}recordSimpleData(t,e){return this.#t.recordSimpleData(t,this.#e),this}recordIncrementalData(t,e){return this.#t.recordIncrementalData(t,this.#e),this}resetIncrementalData(t,e){return this.#t.resetIncrementalData(t,this.#e),this}recordNamedData(t,e){return this}recordSimpleDataFromNamed(t,e,i){return this.#t.recordSimpleDataFromNamed(t,e,this.#e),this}recordFutureForcedDependency(t,e){return this.#t.recordFutureForcedDependency(t,this.#e),this}inheritSimpleDataAsFutureForcedDependencies(t){return this.#t.inheritSimpleDataAsFutureForcedDependencies(t),this}inheritPendingDependenciesAsFutureForcedDependencies(){return this.#t.inheritPendingDependenciesAsFutureForcedDependencies(),this}resetBBox(t){return this.#i||this.#t.resetBBox(this.#e),this}recordClipBox(t,e,i,r,l,c){return this.#i||this.#t.recordClipBox(this.#e,e,i,r,l,c),this}recordBBox(t,e,i,r,l,c){return this.#i||this.#t.recordBBox(this.#e,e,i,r,l,c),this}recordCharacterBBox(t,e,i,r,l,c,u){return this.#i||this.#t.recordCharacterBBox(this.#e,e,i,r,l,c,u),this}recordFullPageBBox(t){return this.#i||this.#t.recordFullPageBBox(this.#e),this}getSimpleIndex(t){return this.#t.getSimpleIndex(t)}recordDependencies(t,e){return this.#t.recordDependencies(this.#e,e),this}recordNamedDependency(t,e){return this.#t.recordNamedDependency(this.#e,e),this}recordOperation(t){return this.#t.recordOperation(this.#e,!0),this}recordShowTextOperation(t){return this.#t.recordShowTextOperation(this.#e,!0),this}bboxToClipBoxDropOperation(t){return this.#i||this.#t.bboxToClipBoxDropOperation(this.#e,!0),this}take(){throw new Error("Unreachable")}takeDebugMetadata(){throw new Error("Unreachable")}}const qi={stroke:["path","transform","filter","strokeColor","strokeAlpha","lineWidth","lineCap","lineJoin","miterLimit","dash"],fill:["path","transform","filter","fillColor","fillAlpha","globalCompositeOperation","SMask"],imageXObject:["transform","SMask","filter","fillAlpha","strokeAlpha","globalCompositeOperation"],rawFillPath:["filter","fillColor","fillAlpha"],showText:["transform","leading","charSpacing","wordSpacing","hScale","textRise","moveText","textMatrix","font","fontObj","filter","fillColor","textRenderingMode","SMask","fillAlpha","strokeAlpha","globalCompositeOperation","sameLineText"],transform:["transform"],transformAndFill:["transform","fillColor"]},In={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};function im(a,t){if(!t)return;const e=t[2]-t[0],i=t[3]-t[1],r=new Path2D;r.rect(t[0],t[1],e,i),a.clip(r)}class Fm{isModifyingCurrentTransform(){return!1}getPattern(){Me("Abstract method `getPattern` called.")}}class fT extends Fm{constructor(t){super(),this._type=t[1],this._bbox=t[2],this._colorStops=t[3],this._p0=t[4],this._p1=t[5],this._r0=t[6],this._r1=t[7],this.matrix=null}isOriginBased(){return this._p0[0]===0&&this._p0[1]===0&&(!this.isRadial()||this._p1[0]===0&&this._p1[1]===0)}isRadial(){return this._type==="radial"}_createGradient(t,e=null){let i,r=this._p0,l=this._p1;if(e&&(r=r.slice(),l=l.slice(),qt.applyTransform(r,e),qt.applyTransform(l,e)),this._type==="axial")i=t.createLinearGradient(r[0],r[1],l[0],l[1]);else if(this._type==="radial"){let c=this._r0,u=this._r1;if(e){const d=new Float32Array(2);qt.singularValueDecompose2dScale(e,d),c*=d[0],u*=d[0]}i=t.createRadialGradient(r[0],r[1],c,l[0],l[1],u)}for(const c of this._colorStops)i.addColorStop(c[0],c[1]);return i}getPattern(t,e,i,r){let l;if(r===In.STROKE||r===In.FILL){if(this.isOriginBased()){let w=qt.transform(i,e.baseTransform);this.matrix&&(w=qt.transform(w,this.matrix));const A=.001,_=Math.hypot(w[0],w[1]),S=Math.hypot(w[2],w[3]),C=(w[0]*w[2]+w[1]*w[3])/(_*S);if(Math.abs(C)<A)if(this.isRadial()){if(Math.abs(_-S)<A)return this._createGradient(t,w)}else return this._createGradient(t,w)}const c=e.current.getClippedPathBoundingBox(r,Qe(t))||[0,0,0,0],u=Math.ceil(c[2]-c[0])||1,d=Math.ceil(c[3]-c[1])||1,f=e.cachedCanvases.getCanvas("pattern",u,d),p=f.context;p.clearRect(0,0,p.canvas.width,p.canvas.height),p.beginPath(),p.rect(0,0,p.canvas.width,p.canvas.height),p.translate(-c[0],-c[1]),i=qt.transform(i,[1,0,0,1,c[0],c[1]]),p.transform(...e.baseTransform),this.matrix&&p.transform(...this.matrix),im(p,this._bbox),p.fillStyle=this._createGradient(p),p.fill(),l=t.createPattern(f.canvas,"no-repeat");const y=new DOMMatrix(i);l.setTransform(y)}else im(t,this._bbox),l=this._createGradient(t);return l}}function _p(a,t,e,i,r,l,c,u){const d=t.coords,f=t.colors,p=a.data,y=a.width*4;let w;d[e+1]>d[i+1]&&(w=e,e=i,i=w,w=l,l=c,c=w),d[i+1]>d[r+1]&&(w=i,i=r,r=w,w=c,c=u,u=w),d[e+1]>d[i+1]&&(w=e,e=i,i=w,w=l,l=c,c=w);const A=(d[e]+t.offsetX)*t.scaleX,_=(d[e+1]+t.offsetY)*t.scaleY,S=(d[i]+t.offsetX)*t.scaleX,C=(d[i+1]+t.offsetY)*t.scaleY,M=(d[r]+t.offsetX)*t.scaleX,k=(d[r+1]+t.offsetY)*t.scaleY;if(_>=k)return;const L=f[l],j=f[l+1],F=f[l+2],z=f[c],H=f[c+1],ut=f[c+2],ft=f[u],_t=f[u+1],ct=f[u+2],Tt=Math.round(_),Lt=Math.round(k);let Bt,Vt,G,st,wt,Yt,Ct,I;for(let J=Tt;J<=Lt;J++){if(J<C){const Ot=J<_?0:(_-J)/(_-C);Bt=A-(A-S)*Ot,Vt=L-(L-z)*Ot,G=j-(j-H)*Ot,st=F-(F-ut)*Ot}else{let Ot;J>k?Ot=1:C===k?Ot=0:Ot=(C-J)/(C-k),Bt=S-(S-M)*Ot,Vt=z-(z-ft)*Ot,G=H-(H-_t)*Ot,st=ut-(ut-ct)*Ot}let mt;J<_?mt=0:J>k?mt=1:mt=(_-J)/(_-k),wt=A-(A-M)*mt,Yt=L-(L-ft)*mt,Ct=j-(j-_t)*mt,I=F-(F-ct)*mt;const xt=Math.round(Math.min(Bt,wt)),It=Math.round(Math.max(Bt,wt));let Ut=y*J+xt*4;for(let Ot=xt;Ot<=It;Ot++)mt=(Bt-Ot)/(Bt-wt),mt<0?mt=0:mt>1&&(mt=1),p[Ut++]=Vt-(Vt-Yt)*mt|0,p[Ut++]=G-(G-Ct)*mt|0,p[Ut++]=st-(st-I)*mt|0,p[Ut++]=255}}function pT(a,t,e){const i=t.coords,r=t.colors;let l,c;switch(t.type){case Yp.LATTICE:const u=t.verticesPerRow,d=Math.floor(i.length/u)-1,f=u-1;for(l=0;l<d;l++){let p=l*u;for(let y=0;y<f;y++,p++)_p(a,e,i[p],i[p+1],i[p+u],r[p],r[p+1],r[p+u]),_p(a,e,i[p+u+1],i[p+1],i[p+u],r[p+u+1],r[p+1],r[p+u])}break;case Yp.TRIANGLES:for(l=0,c=i.length;l<c;l+=3)_p(a,e,i[l],i[l+1],i[l+2],r[l],r[l+1],r[l+2]);break;default:throw new Error("illegal figure")}}class mT extends Fm{constructor(t){super(),this._coords=t[2],this._colors=t[3],this._figures=t[4],this._bounds=t[5],this._bbox=t[6],this._background=t[7],this.matrix=null}_createMeshCanvas(t,e,i){const u=Math.floor(this._bounds[0]),d=Math.floor(this._bounds[1]),f=Math.ceil(this._bounds[2])-u,p=Math.ceil(this._bounds[3])-d,y=Math.min(Math.ceil(Math.abs(f*t[0]*1.1)),3e3),w=Math.min(Math.ceil(Math.abs(p*t[1]*1.1)),3e3),A=f/y,_=p/w,S={coords:this._coords,colors:this._colors,offsetX:-u,offsetY:-d,scaleX:1/A,scaleY:1/_},C=y+4,M=w+4,k=i.getCanvas("mesh",C,M),L=k.context,j=L.createImageData(y,w);if(e){const z=j.data;for(let H=0,ut=z.length;H<ut;H+=4)z[H]=e[0],z[H+1]=e[1],z[H+2]=e[2],z[H+3]=255}for(const z of this._figures)pT(j,z,S);return L.putImageData(j,2,2),{canvas:k.canvas,offsetX:u-2*A,offsetY:d-2*_,scaleX:A,scaleY:_}}isModifyingCurrentTransform(){return!0}getPattern(t,e,i,r){im(t,this._bbox);const l=new Float32Array(2);if(r===In.SHADING)qt.singularValueDecompose2dScale(Qe(t),l);else if(this.matrix){qt.singularValueDecompose2dScale(this.matrix,l);const[u,d]=l;qt.singularValueDecompose2dScale(e.baseTransform,l),l[0]*=u,l[1]*=d}else qt.singularValueDecompose2dScale(e.baseTransform,l);const c=this._createMeshCanvas(l,r===In.SHADING?null:this._background,e.cachedCanvases);return r!==In.SHADING&&(t.setTransform(...e.baseTransform),this.matrix&&t.transform(...this.matrix)),t.translate(c.offsetX,c.offsetY),t.scale(c.scaleX,c.scaleY),t.createPattern(c.canvas,"no-repeat")}}class gT extends Fm{getPattern(){return"hotpink"}}function yT(a){switch(a[0]){case"RadialAxial":return new fT(a);case"Mesh":return new mT(a);case"Dummy":return new gT}throw new Error(`Unknown IR type: ${a[0]}`)}const o0={COLORED:1,UNCOLORED:2};class Im{static MAX_PATTERN_SIZE=3e3;constructor(t,e,i,r){this.color=t[1],this.operatorList=t[2],this.matrix=t[3],this.bbox=t[4],this.xstep=t[5],this.ystep=t[6],this.paintType=t[7],this.tilingType=t[8],this.ctx=e,this.canvasGraphicsFactory=i,this.baseTransform=r}createPatternCanvas(t,e){const{bbox:i,operatorList:r,paintType:l,tilingType:c,color:u,canvasGraphicsFactory:d}=this;let{xstep:f,ystep:p}=this;f=Math.abs(f),p=Math.abs(p),id("TilingType: "+c);const y=i[0],w=i[1],A=i[2],_=i[3],S=A-y,C=_-w,M=new Float32Array(2);qt.singularValueDecompose2dScale(this.matrix,M);const[k,L]=M;qt.singularValueDecompose2dScale(this.baseTransform,M);const j=k*M[0],F=L*M[1];let z=S,H=C,ut=!1,ft=!1;const _t=Math.ceil(f*j),ct=Math.ceil(p*F),Tt=Math.ceil(S*j),Lt=Math.ceil(C*F);_t>=Tt?z=f:ut=!0,ct>=Lt?H=p:ft=!0;const Bt=this.getSizeAndScale(z,this.ctx.canvas.width,j),Vt=this.getSizeAndScale(H,this.ctx.canvas.height,F),G=t.cachedCanvases.getCanvas("pattern",Bt.size,Vt.size),st=G.context,wt=d.createCanvasGraphics(st,e);if(wt.groupLevel=t.groupLevel,this.setFillAndStrokeStyleToContext(wt,l,u),st.translate(-Bt.scale*y,-Vt.scale*w),wt.transform(0,Bt.scale,0,0,Vt.scale,0,0),st.save(),wt.dependencyTracker?.save(),this.clipBbox(wt,y,w,A,_),wt.baseTransform=Qe(wt.ctx),wt.executeOperatorList(r),wt.endDrawing(),wt.dependencyTracker?.restore(),st.restore(),ut||ft){const Yt=G.canvas;ut&&(z=f),ft&&(H=p);const Ct=this.getSizeAndScale(z,this.ctx.canvas.width,j),I=this.getSizeAndScale(H,this.ctx.canvas.height,F),J=Ct.size,mt=I.size,xt=t.cachedCanvases.getCanvas("pattern-workaround",J,mt),It=xt.context,Ut=ut?Math.floor(S/f):0,Ot=ft?Math.floor(C/p):0;for(let Rt=0;Rt<=Ut;Rt++)for(let jt=0;jt<=Ot;jt++)It.drawImage(Yt,J*Rt,mt*jt,J,mt,0,0,J,mt);return{canvas:xt.canvas,scaleX:Ct.scale,scaleY:I.scale,offsetX:y,offsetY:w}}return{canvas:G.canvas,scaleX:Bt.scale,scaleY:Vt.scale,offsetX:y,offsetY:w}}getSizeAndScale(t,e,i){const r=Math.max(Im.MAX_PATTERN_SIZE,e);let l=Math.ceil(t*i);return l>=r?l=r:i=l/t,{scale:i,size:l}}clipBbox(t,e,i,r,l){const c=r-e,u=l-i;t.ctx.rect(e,i,c,u),qt.axialAlignedBoundingBox([e,i,r,l],Qe(t.ctx),t.current.minMax),t.clip(),t.endPath()}setFillAndStrokeStyleToContext(t,e,i){const r=t.ctx,l=t.current;switch(e){case o0.COLORED:const{fillStyle:c,strokeStyle:u}=this.ctx;r.fillStyle=l.fillColor=c,r.strokeStyle=l.strokeColor=u;break;case o0.UNCOLORED:r.fillStyle=r.strokeStyle=i,l.fillColor=l.strokeColor=i;break;default:throw new MC(`Unsupported paint type: ${e}`)}}isModifyingCurrentTransform(){return!1}getPattern(t,e,i,r,l){let c=i;r!==In.SHADING&&(c=qt.transform(c,e.baseTransform),this.matrix&&(c=qt.transform(c,this.matrix)));const u=this.createPatternCanvas(e,l);let d=new DOMMatrix(c);d=d.translate(u.offsetX,u.offsetY),d=d.scale(1/u.scaleX,1/u.scaleY);const f=t.createPattern(u.canvas,"repeat");return f.setTransform(d),f}}function bT({src:a,srcPos:t=0,dest:e,width:i,height:r,nonBlackColor:l=4294967295,inverseDecode:c=!1}){const u=xn.isLittleEndian?4278190080:255,[d,f]=c?[l,u]:[u,l],p=i>>3,y=i&7,w=a.length;e=new Uint32Array(e.buffer);let A=0;for(let _=0;_<r;_++){for(const C=t+p;t<C;t++){const M=t<w?a[t]:255;e[A++]=M&128?f:d,e[A++]=M&64?f:d,e[A++]=M&32?f:d,e[A++]=M&16?f:d,e[A++]=M&8?f:d,e[A++]=M&4?f:d,e[A++]=M&2?f:d,e[A++]=M&1?f:d}if(y===0)continue;const S=t<w?a[t++]:255;for(let C=0;C<y;C++)e[A++]=S&1<<7-C?f:d}return{srcPos:t,destPos:A}}const l0=16,c0=100,vT=15,u0=10,hi=16,Cp=new DOMMatrix,Ci=new Float32Array(2),tl=new Float32Array([1/0,1/0,-1/0,-1/0]);function wT(a,t){if(a._removeMirroring)throw new Error("Context is already forwarding operations.");a.__originalSave=a.save,a.__originalRestore=a.restore,a.__originalRotate=a.rotate,a.__originalScale=a.scale,a.__originalTranslate=a.translate,a.__originalTransform=a.transform,a.__originalSetTransform=a.setTransform,a.__originalResetTransform=a.resetTransform,a.__originalClip=a.clip,a.__originalMoveTo=a.moveTo,a.__originalLineTo=a.lineTo,a.__originalBezierCurveTo=a.bezierCurveTo,a.__originalRect=a.rect,a.__originalClosePath=a.closePath,a.__originalBeginPath=a.beginPath,a._removeMirroring=()=>{a.save=a.__originalSave,a.restore=a.__originalRestore,a.rotate=a.__originalRotate,a.scale=a.__originalScale,a.translate=a.__originalTranslate,a.transform=a.__originalTransform,a.setTransform=a.__originalSetTransform,a.resetTransform=a.__originalResetTransform,a.clip=a.__originalClip,a.moveTo=a.__originalMoveTo,a.lineTo=a.__originalLineTo,a.bezierCurveTo=a.__originalBezierCurveTo,a.rect=a.__originalRect,a.closePath=a.__originalClosePath,a.beginPath=a.__originalBeginPath,delete a._removeMirroring},a.save=function(){t.save(),this.__originalSave()},a.restore=function(){t.restore(),this.__originalRestore()},a.translate=function(e,i){t.translate(e,i),this.__originalTranslate(e,i)},a.scale=function(e,i){t.scale(e,i),this.__originalScale(e,i)},a.transform=function(e,i,r,l,c,u){t.transform(e,i,r,l,c,u),this.__originalTransform(e,i,r,l,c,u)},a.setTransform=function(e,i,r,l,c,u){t.setTransform(e,i,r,l,c,u),this.__originalSetTransform(e,i,r,l,c,u)},a.resetTransform=function(){t.resetTransform(),this.__originalResetTransform()},a.rotate=function(e){t.rotate(e),this.__originalRotate(e)},a.clip=function(e){t.clip(e),this.__originalClip(e)},a.moveTo=function(e,i){t.moveTo(e,i),this.__originalMoveTo(e,i)},a.lineTo=function(e,i){t.lineTo(e,i),this.__originalLineTo(e,i)},a.bezierCurveTo=function(e,i,r,l,c,u){t.bezierCurveTo(e,i,r,l,c,u),this.__originalBezierCurveTo(e,i,r,l,c,u)},a.rect=function(e,i,r,l){t.rect(e,i,r,l),this.__originalRect(e,i,r,l)},a.closePath=function(){t.closePath(),this.__originalClosePath()},a.beginPath=function(){t.beginPath(),this.__originalBeginPath()}}class xT{constructor(t){this.canvasFactory=t,this.cache=Object.create(null)}getCanvas(t,e,i){let r;return this.cache[t]!==void 0?(r=this.cache[t],this.canvasFactory.reset(r,e,i)):(r=this.canvasFactory.create(e,i),this.cache[t]=r),r}delete(t){delete this.cache[t]}clear(){for(const t in this.cache){const e=this.cache[t];this.canvasFactory.destroy(e),delete this.cache[t]}}}function xh(a,t,e,i,r,l,c,u,d,f){const[p,y,w,A,_,S]=Qe(a);if(y===0&&w===0){const k=c*p+_,L=Math.round(k),j=u*A+S,F=Math.round(j),z=(c+d)*p+_,H=Math.abs(Math.round(z)-L)||1,ut=(u+f)*A+S,ft=Math.abs(Math.round(ut)-F)||1;return a.setTransform(Math.sign(p),0,0,Math.sign(A),L,F),a.drawImage(t,e,i,r,l,0,0,H,ft),a.setTransform(p,y,w,A,_,S),[H,ft]}if(p===0&&A===0){const k=u*w+_,L=Math.round(k),j=c*y+S,F=Math.round(j),z=(u+f)*w+_,H=Math.abs(Math.round(z)-L)||1,ut=(c+d)*y+S,ft=Math.abs(Math.round(ut)-F)||1;return a.setTransform(0,Math.sign(y),Math.sign(w),0,L,F),a.drawImage(t,e,i,r,l,0,0,ft,H),a.setTransform(p,y,w,A,_,S),[ft,H]}a.drawImage(t,e,i,r,l,c,u,d,f);const C=Math.hypot(p,y),M=Math.hypot(w,A);return[C*d,M*f]}class h0{alphaIsShape=!1;fontSize=0;fontSizeScale=1;textMatrix=null;textMatrixScale=1;fontMatrix=Xp;leading=0;x=0;y=0;lineX=0;lineY=0;charSpacing=0;wordSpacing=0;textHScale=1;textRenderingMode=vn.FILL;textRise=0;fillColor="#000000";strokeColor="#000000";patternFill=!1;patternStroke=!1;fillAlpha=1;strokeAlpha=1;lineWidth=1;activeSMask=null;transferMaps="none";constructor(t,e,i){i?.(this),this.clipBox=new Float32Array([0,0,t,e]),this.minMax=tl.slice()}clone(){const t=Object.create(this);return t.clipBox=this.clipBox.slice(),t.minMax=this.minMax.slice(),t}getPathBoundingBox(t=In.FILL,e=null){const i=this.minMax.slice();if(t===In.STROKE){e||Me("Stroke bounding box must include transform."),qt.singularValueDecompose2dScale(e,Ci);const r=Ci[0]*this.lineWidth/2,l=Ci[1]*this.lineWidth/2;i[0]-=r,i[1]-=l,i[2]+=r,i[3]+=l}return i}updateClipFromPath(){const t=qt.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(t||[0,0,0,0])}isEmptyClip(){return this.minMax[0]===1/0}startNewPathAndClipBox(t){this.clipBox.set(t,0),this.minMax.set(tl,0)}getClippedPathBoundingBox(t=In.FILL,e=null){return qt.intersect(this.clipBox,this.getPathBoundingBox(t,e))}}function d0(a,t){if(t instanceof ImageData){a.putImageData(t,0,0);return}const e=t.height,i=t.width,r=e%hi,l=(e-r)/hi,c=r===0?l:l+1,u=a.createImageData(i,hi);let d=0,f;const p=t.data,y=u.data;let w,A,_,S;if(t.kind===Lh.GRAYSCALE_1BPP){const C=p.byteLength,M=new Uint32Array(y.buffer,0,y.byteLength>>2),k=M.length,L=i+7>>3,j=4294967295,F=xn.isLittleEndian?4278190080:255;for(w=0;w<c;w++){for(_=w<l?hi:r,f=0,A=0;A<_;A++){const z=C-d;let H=0;const ut=z>L?i:z*8-7,ft=ut&-8;let _t=0,ct=0;for(;H<ft;H+=8)ct=p[d++],M[f++]=ct&128?j:F,M[f++]=ct&64?j:F,M[f++]=ct&32?j:F,M[f++]=ct&16?j:F,M[f++]=ct&8?j:F,M[f++]=ct&4?j:F,M[f++]=ct&2?j:F,M[f++]=ct&1?j:F;for(;H<ut;H++)_t===0&&(ct=p[d++],_t=128),M[f++]=ct&_t?j:F,_t>>=1}for(;f<k;)M[f++]=0;a.putImageData(u,0,w*hi)}}else if(t.kind===Lh.RGBA_32BPP){for(A=0,S=i*hi*4,w=0;w<l;w++)y.set(p.subarray(d,d+S)),d+=S,a.putImageData(u,0,A),A+=hi;w<c&&(S=i*r*4,y.set(p.subarray(d,d+S)),a.putImageData(u,0,A))}else if(t.kind===Lh.RGB_24BPP)for(_=hi,S=i*_,w=0;w<c;w++){for(w>=l&&(_=r,S=i*_),f=0,A=S;A--;)y[f++]=p[d++],y[f++]=p[d++],y[f++]=p[d++],y[f++]=255;a.putImageData(u,0,w*hi)}else throw new Error(`bad image kind: ${t.kind}`)}function f0(a,t){if(t.bitmap){a.drawImage(t.bitmap,0,0);return}const e=t.height,i=t.width,r=e%hi,l=(e-r)/hi,c=r===0?l:l+1,u=a.createImageData(i,hi);let d=0;const f=t.data,p=u.data;for(let y=0;y<c;y++){const w=y<l?hi:r;({srcPos:d}=bT({src:f,srcPos:d,dest:p,width:i,height:w,nonBlackColor:0})),a.putImageData(u,0,y*hi)}}function Sc(a,t){const e=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const i of e)a[i]!==void 0&&(t[i]=a[i]);a.setLineDash!==void 0&&(t.setLineDash(a.getLineDash()),t.lineDashOffset=a.lineDashOffset)}function Ah(a){a.strokeStyle=a.fillStyle="#000000",a.fillRule="nonzero",a.globalAlpha=1,a.lineWidth=1,a.lineCap="butt",a.lineJoin="miter",a.miterLimit=10,a.globalCompositeOperation="source-over",a.font="10px sans-serif",a.setLineDash!==void 0&&(a.setLineDash([]),a.lineDashOffset=0);const{filter:t}=a;t!=="none"&&t!==""&&(a.filter="none")}function p0(a,t){if(t)return!0;qt.singularValueDecompose2dScale(a,Ci);const e=Math.fround(Ts.pixelRatio*cl.PDF_TO_CSS_UNITS);return Ci[0]<=e&&Ci[1]<=e}const AT=["butt","round","square"],ST=["miter","round","bevel"],ET={},m0={};class sl{constructor(t,e,i,r,l,{optionalContentConfig:c,markedContentStack:u=null},d,f,p){this.ctx=t,this.current=new h0(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=e,this.objs=i,this.canvasFactory=r,this.filterFactory=l,this.groupStack=[],this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=u||[],this.optionalContentConfig=c,this.cachedCanvases=new xT(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=d,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=f,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map,this.dependencyTracker=p??null}getObject(t,e,i=null){return typeof e=="string"?(this.dependencyTracker?.recordNamedDependency(t,e),e.startsWith("g_")?this.commonObjs.get(e):this.objs.get(e)):i}beginDrawing({transform:t,viewport:e,transparency:i=!1,background:r=null}){const l=this.ctx.canvas.width,c=this.ctx.canvas.height,u=this.ctx.fillStyle;if(this.ctx.fillStyle=r||"#ffffff",this.ctx.fillRect(0,0,l,c),this.ctx.fillStyle=u,i){const d=this.cachedCanvases.getCanvas("transparent",l,c);this.compositeCtx=this.ctx,this.transparentCanvas=d.canvas,this.ctx=d.context,this.ctx.save(),this.ctx.transform(...Qe(this.compositeCtx))}this.ctx.save(),Ah(this.ctx),t&&(this.ctx.transform(...t),this.outputScaleX=t[0],this.outputScaleY=t[0]),this.ctx.transform(...e.transform),this.viewportScale=e.scale,this.baseTransform=Qe(this.ctx)}executeOperatorList(t,e,i,r,l){const c=t.argsArray,u=t.fnArray;let d=e||0;const f=c.length;if(f===d)return d;const p=f-d>u0&&typeof i=="function",y=p?Date.now()+vT:0;let w=0;const A=this.commonObjs,_=this.objs;let S,C;for(;;){if(r!==void 0&&d===r.nextBreakPoint)return r.breakIt(d,i),d;if(!l||l(d))if(S=u[d],C=c[d]??null,S!==Pc.dependency)C===null?this[S](d):this[S](d,...C);else for(const M of C){this.dependencyTracker?.recordNamedData(M,d);const k=M.startsWith("g_")?A:_;if(!k.has(M))return k.get(M,i),d}if(d++,d===f)return d;if(p&&++w>u0){if(Date.now()>y)return i(),d;w=0}}}#t(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.current.activeSMask=null,this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#t(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const t of this._cachedBitmapsMap.values()){for(const e of t.values())typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&(e.width=e.height=0);t.clear()}this._cachedBitmapsMap.clear(),this.#e()}#e(){if(this.pageColors){const t=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(t!=="none"){const e=this.ctx.filter;this.ctx.filter=t,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=e}}}_scaleImage(t,e){const i=t.width??t.displayWidth,r=t.height??t.displayHeight;let l=Math.max(Math.hypot(e[0],e[1]),1),c=Math.max(Math.hypot(e[2],e[3]),1),u=i,d=r,f="prescale1",p,y;for(;l>2&&u>1||c>2&&d>1;){let w=u,A=d;l>2&&u>1&&(w=u>=16384?Math.floor(u/2)-1||1:Math.ceil(u/2),l/=u/w),c>2&&d>1&&(A=d>=16384?Math.floor(d/2)-1||1:Math.ceil(d)/2,c/=d/A),p=this.cachedCanvases.getCanvas(f,w,A),y=p.context,y.clearRect(0,0,w,A),y.drawImage(t,0,0,u,d,0,0,w,A),t=p.canvas,u=w,d=A,f=f==="prescale1"?"prescale2":"prescale1"}return{img:t,paintWidth:u,paintHeight:d}}_createMaskCanvas(t,e){const i=this.ctx,{width:r,height:l}=e,c=this.current.fillColor,u=this.current.patternFill,d=Qe(i);let f,p,y,w;if((e.bitmap||e.data)&&e.count>1){const _t=e.bitmap||e.data.buffer;p=JSON.stringify(u?d:[d.slice(0,4),c]),f=this._cachedBitmapsMap.get(_t),f||(f=new Map,this._cachedBitmapsMap.set(_t,f));const ct=f.get(p);if(ct&&!u){const Tt=Math.round(Math.min(d[0],d[2])+d[4]),Lt=Math.round(Math.min(d[1],d[3])+d[5]);return this.dependencyTracker?.recordDependencies(t,qi.transformAndFill),{canvas:ct,offsetX:Tt,offsetY:Lt}}y=ct}y||(w=this.cachedCanvases.getCanvas("maskCanvas",r,l),f0(w.context,e));let A=qt.transform(d,[1/r,0,0,-1/l,0,0]);A=qt.transform(A,[1,0,0,1,0,-l]);const _=tl.slice();qt.axialAlignedBoundingBox([0,0,r,l],A,_);const[S,C,M,k]=_,L=Math.round(M-S)||1,j=Math.round(k-C)||1,F=this.cachedCanvases.getCanvas("fillCanvas",L,j),z=F.context,H=S,ut=C;z.translate(-H,-ut),z.transform(...A),y||(y=this._scaleImage(w.canvas,ws(z)),y=y.img,f&&u&&f.set(p,y)),z.imageSmoothingEnabled=p0(Qe(z),e.interpolate),xh(z,y,0,0,y.width,y.height,0,0,r,l),z.globalCompositeOperation="source-in";const ft=qt.transform(ws(z),[1,0,0,1,-H,-ut]);return z.fillStyle=u?c.getPattern(i,this,ft,In.FILL,t):c,z.fillRect(0,0,r,l),f&&!u&&(this.cachedCanvases.delete("fillCanvas"),f.set(p,F.canvas)),this.dependencyTracker?.recordDependencies(t,qi.transformAndFill),{canvas:F.canvas,offsetX:Math.round(H),offsetY:Math.round(ut)}}setLineWidth(t,e){this.dependencyTracker?.recordSimpleData("lineWidth",t),e!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=e,this.ctx.lineWidth=e}setLineCap(t,e){this.dependencyTracker?.recordSimpleData("lineCap",t),this.ctx.lineCap=AT[e]}setLineJoin(t,e){this.dependencyTracker?.recordSimpleData("lineJoin",t),this.ctx.lineJoin=ST[e]}setMiterLimit(t,e){this.dependencyTracker?.recordSimpleData("miterLimit",t),this.ctx.miterLimit=e}setDash(t,e,i){this.dependencyTracker?.recordSimpleData("dash",t);const r=this.ctx;r.setLineDash!==void 0&&(r.setLineDash(e),r.lineDashOffset=i)}setRenderingIntent(t,e){}setFlatness(t,e){}setGState(t,e){for(const[i,r]of e)switch(i){case"LW":this.setLineWidth(t,r);break;case"LC":this.setLineCap(t,r);break;case"LJ":this.setLineJoin(t,r);break;case"ML":this.setMiterLimit(t,r);break;case"D":this.setDash(t,r[0],r[1]);break;case"RI":this.setRenderingIntent(t,r);break;case"FL":this.setFlatness(t,r);break;case"Font":this.setFont(t,r[0],r[1]);break;case"CA":this.dependencyTracker?.recordSimpleData("strokeAlpha",t),this.current.strokeAlpha=r;break;case"ca":this.dependencyTracker?.recordSimpleData("fillAlpha",t),this.ctx.globalAlpha=this.current.fillAlpha=r;break;case"BM":this.dependencyTracker?.recordSimpleData("globalCompositeOperation",t),this.ctx.globalCompositeOperation=r;break;case"SMask":this.dependencyTracker?.recordSimpleData("SMask",t),this.current.activeSMask=r?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.dependencyTracker?.recordSimpleData("filter",t),this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(r);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const t=this.inSMaskMode;this.current.activeSMask&&!t?this.beginSMaskMode():!this.current.activeSMask&&t&&this.endSMaskMode()}beginSMaskMode(t){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const e=this.ctx.canvas.width,i=this.ctx.canvas.height,r="smaskGroupAt"+this.groupLevel,l=this.cachedCanvases.getCanvas(r,e,i);this.suspendedCtx=this.ctx;const c=this.ctx=l.context;c.setTransform(this.suspendedCtx.getTransform()),Sc(this.suspendedCtx,c),wT(c,this.suspendedCtx),this.setGState(t,[["BM","source-over"]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),Sc(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(t){if(!this.current.activeSMask)return;t?(t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.ceil(t[2]),t[3]=Math.ceil(t[3])):t=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const e=this.current.activeSMask,i=this.suspendedCtx;this.composeSMask(i,e,this.ctx,t),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}composeSMask(t,e,i,r){const l=r[0],c=r[1],u=r[2]-l,d=r[3]-c;u===0||d===0||(this.genericComposeSMask(e.context,i,u,d,e.subtype,e.backdrop,e.transferMap,l,c,e.offsetX,e.offsetY),t.save(),t.globalAlpha=1,t.globalCompositeOperation="source-over",t.setTransform(1,0,0,1,0,0),t.drawImage(i.canvas,0,0),t.restore())}genericComposeSMask(t,e,i,r,l,c,u,d,f,p,y){let w=t.canvas,A=d-p,_=f-y;if(c)if(A<0||_<0||A+i>w.width||_+r>w.height){const C=this.cachedCanvases.getCanvas("maskExtension",i,r),M=C.context;M.drawImage(w,-A,-_),M.globalCompositeOperation="destination-atop",M.fillStyle=c,M.fillRect(0,0,i,r),M.globalCompositeOperation="source-over",w=C.canvas,A=_=0}else{t.save(),t.globalAlpha=1,t.setTransform(1,0,0,1,0,0);const C=new Path2D;C.rect(A,_,i,r),t.clip(C),t.globalCompositeOperation="destination-atop",t.fillStyle=c,t.fillRect(A,_,i,r),t.restore()}e.save(),e.globalAlpha=1,e.setTransform(1,0,0,1,0,0),l==="Alpha"&&u?e.filter=this.filterFactory.addAlphaFilter(u):l==="Luminosity"&&(e.filter=this.filterFactory.addLuminosityFilter(u));const S=new Path2D;S.rect(d,f,i,r),e.clip(S),e.globalCompositeOperation="destination-in",e.drawImage(w,A,_,i,r,d,f,i,r),e.restore()}save(t){this.inSMaskMode&&Sc(this.ctx,this.suspendedCtx),this.ctx.save();const e=this.current;this.stateStack.push(e),this.current=e.clone(),this.dependencyTracker?.save(t)}restore(t){if(this.dependencyTracker?.restore(t),this.stateStack.length===0){this.inSMaskMode&&this.endSMaskMode();return}this.current=this.stateStack.pop(),this.ctx.restore(),this.inSMaskMode&&Sc(this.suspendedCtx,this.ctx),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}transform(t,e,i,r,l,c,u){this.dependencyTracker?.recordIncrementalData("transform",t),this.ctx.transform(e,i,r,l,c,u),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(t,e,i,r){let[l]=i;if(!r){l||=i[0]=new Path2D,this[e](t,l);return}if(this.dependencyTracker!==null){const c=e===Pc.stroke?this.current.lineWidth/2:0;this.dependencyTracker.resetBBox(t).recordBBox(t,this.ctx,r[0]-c,r[2]+c,r[1]-c,r[3]+c).recordDependencies(t,["transform"])}l instanceof Path2D||(l=i[0]=Mw(l)),qt.axialAlignedBoundingBox(r,Qe(this.ctx),this.current.minMax),this[e](t,l),this._pathStartIdx=t}closePath(t){this.ctx.closePath()}stroke(t,e,i=!0){const r=this.ctx,l=this.current.strokeColor;if(r.globalAlpha=this.current.strokeAlpha,this.contentVisible)if(typeof l=="object"&&l?.getPattern){const c=l.isModifyingCurrentTransform()?r.getTransform():null;if(r.save(),r.strokeStyle=l.getPattern(r,this,ws(r),In.STROKE,t),c){const u=new Path2D;u.addPath(e,r.getTransform().invertSelf().multiplySelf(c)),e=u}this.rescaleAndStroke(e,!1),r.restore()}else this.rescaleAndStroke(e,!0);this.dependencyTracker?.recordDependencies(t,qi.stroke),i&&this.consumePath(t,e,this.current.getClippedPathBoundingBox(In.STROKE,Qe(this.ctx))),r.globalAlpha=this.current.fillAlpha}closeStroke(t,e){this.stroke(t,e)}fill(t,e,i=!0){const r=this.ctx,l=this.current.fillColor,c=this.current.patternFill;let u=!1;if(c){const f=l.isModifyingCurrentTransform()?r.getTransform():null;if(this.dependencyTracker?.save(t),r.save(),r.fillStyle=l.getPattern(r,this,ws(r),In.FILL,t),f){const p=new Path2D;p.addPath(e,r.getTransform().invertSelf().multiplySelf(f)),e=p}u=!0}const d=this.current.getClippedPathBoundingBox();this.contentVisible&&d!==null&&(this.pendingEOFill?(r.fill(e,"evenodd"),this.pendingEOFill=!1):r.fill(e)),this.dependencyTracker?.recordDependencies(t,qi.fill),u&&(r.restore(),this.dependencyTracker?.restore(t)),i&&this.consumePath(t,e,d)}eoFill(t,e){this.pendingEOFill=!0,this.fill(t,e)}fillStroke(t,e){this.fill(t,e,!1),this.stroke(t,e,!1),this.consumePath(t,e)}eoFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}closeFillStroke(t,e){this.fillStroke(t,e)}closeEOFillStroke(t,e){this.pendingEOFill=!0,this.fillStroke(t,e)}endPath(t,e){this.consumePath(t,e)}rawFillPath(t,e){this.ctx.fill(e),this.dependencyTracker?.recordDependencies(t,qi.rawFillPath).recordOperation(t)}clip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=ET}eoClip(t){this.dependencyTracker?.recordFutureForcedDependency("clipMode",t),this.pendingClip=m0}beginText(t){this.current.textMatrix=null,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0,this.dependencyTracker?.recordOpenMarker(t).resetIncrementalData("sameLineText").resetIncrementalData("moveText",t)}endText(t){const e=this.pendingTextPaths,i=this.ctx;if(this.dependencyTracker){const{dependencyTracker:r}=this;e!==void 0&&r.recordFutureForcedDependency("textClip",r.getOpenMarker()).recordFutureForcedDependency("textClip",t),r.recordCloseMarker(t)}if(e!==void 0){const r=new Path2D,l=i.getTransform().invertSelf();for(const{transform:c,x:u,y:d,fontSize:f,path:p}of e)p&&r.addPath(p,new DOMMatrix(c).preMultiplySelf(l).translate(u,d).scale(f,-f));i.clip(r)}delete this.pendingTextPaths}setCharSpacing(t,e){this.dependencyTracker?.recordSimpleData("charSpacing",t),this.current.charSpacing=e}setWordSpacing(t,e){this.dependencyTracker?.recordSimpleData("wordSpacing",t),this.current.wordSpacing=e}setHScale(t,e){this.dependencyTracker?.recordSimpleData("hScale",t),this.current.textHScale=e/100}setLeading(t,e){this.dependencyTracker?.recordSimpleData("leading",t),this.current.leading=-e}setFont(t,e,i){this.dependencyTracker?.recordSimpleData("font",t).recordSimpleDataFromNamed("fontObj",e,t);const r=this.commonObjs.get(e),l=this.current;if(!r)throw new Error(`Can't find font for ${e}`);if(l.fontMatrix=r.fontMatrix||Xp,(l.fontMatrix[0]===0||l.fontMatrix[3]===0)&&ne("Invalid font matrix for font "+e),i<0?(i=-i,l.fontDirection=-1):l.fontDirection=1,this.current.font=r,this.current.fontSize=i,r.isType3Font)return;const c=r.loadedName||"sans-serif",u=r.systemFontInfo?.css||`"${c}", ${r.fallbackName}`;let d="normal";r.black?d="900":r.bold&&(d="bold");const f=r.italic?"italic":"normal";let p=i;i<l0?p=l0:i>c0&&(p=c0),this.current.fontSizeScale=i/p,this.ctx.font=`${f} ${d} ${p}px ${u}`}setTextRenderingMode(t,e){this.dependencyTracker?.recordSimpleData("textRenderingMode",t),this.current.textRenderingMode=e}setTextRise(t,e){this.dependencyTracker?.recordSimpleData("textRise",t),this.current.textRise=e}moveText(t,e,i){this.dependencyTracker?.resetIncrementalData("sameLineText").recordIncrementalData("moveText",t),this.current.x=this.current.lineX+=e,this.current.y=this.current.lineY+=i}setLeadingMoveText(t,e,i){this.setLeading(t,-i),this.moveText(t,e,i)}setTextMatrix(t,e){this.dependencyTracker?.resetIncrementalData("sameLineText").recordSimpleData("textMatrix",t);const{current:i}=this;i.textMatrix=e,i.textMatrixScale=Math.hypot(e[0],e[1]),i.x=i.lineX=0,i.y=i.lineY=0}nextLine(t){this.moveText(t,0,this.current.leading),this.dependencyTracker?.recordIncrementalData("moveText",this.dependencyTracker.getSimpleIndex("leading")??t)}#i(t,e,i){const r=new Path2D;return r.addPath(t,new DOMMatrix(i).invertSelf().multiplySelf(e)),r}paintChar(t,e,i,r,l,c){const u=this.ctx,d=this.current,f=d.font,p=d.textRenderingMode,y=d.fontSize/d.fontSizeScale,w=p&vn.FILL_STROKE_MASK,A=!!(p&vn.ADD_TO_PATH_FLAG),_=d.patternFill&&!f.missingFile,S=d.patternStroke&&!f.missingFile;let C;if((f.disableFontFace||A||_||S)&&!f.missingFile&&(C=f.getPathGenerator(this.commonObjs,e)),C&&(f.disableFontFace||_||S)){u.save(),u.translate(i,r),u.scale(y,-y),this.dependencyTracker?.recordCharacterBBox(t,u,f);let M;if(w===vn.FILL||w===vn.FILL_STROKE)if(l){M=u.getTransform(),u.setTransform(...l);const k=this.#i(C,M,l);u.fill(k)}else u.fill(C);if(w===vn.STROKE||w===vn.FILL_STROKE)if(c){M||=u.getTransform(),u.setTransform(...c);const{a:k,b:L,c:j,d:F}=M,z=qt.inverseTransform(c),H=qt.transform([k,L,j,F,0,0],z);qt.singularValueDecompose2dScale(H,Ci),u.lineWidth*=Math.max(Ci[0],Ci[1])/y,u.stroke(this.#i(C,M,c))}else u.lineWidth/=y,u.stroke(C);u.restore()}else(w===vn.FILL||w===vn.FILL_STROKE)&&(u.fillText(e,i,r),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,r,()=>u.measureText(e))),(w===vn.STROKE||w===vn.FILL_STROKE)&&(this.dependencyTracker&&this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,r,()=>u.measureText(e)).recordDependencies(t,qi.stroke),u.strokeText(e,i,r));A&&((this.pendingTextPaths||=[]).push({transform:Qe(u),x:i,y:r,fontSize:y,path:C}),this.dependencyTracker?.recordCharacterBBox(t,u,f,y,i,r))}get isFontSubpixelAAEnabled(){const{context:t}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);t.scale(1.5,1),t.fillText("I",0,10);const e=t.getImageData(0,0,10,10).data;let i=!1;for(let r=3;r<e.length;r+=4)if(e[r]>0&&e[r]<255){i=!0;break}return ie(this,"isFontSubpixelAAEnabled",i)}showText(t,e){this.dependencyTracker&&(this.dependencyTracker.recordDependencies(t,qi.showText).resetBBox(t),this.current.textRenderingMode&vn.ADD_TO_PATH_FLAG&&this.dependencyTracker.recordFutureForcedDependency("textClip",t).inheritPendingDependenciesAsFutureForcedDependencies());const i=this.current,r=i.font;if(r.isType3Font){this.showType3Text(t,e),this.dependencyTracker?.recordShowTextOperation(t);return}const l=i.fontSize;if(l===0){this.dependencyTracker?.recordOperation(t);return}const c=this.ctx,u=i.fontSizeScale,d=i.charSpacing,f=i.wordSpacing,p=i.fontDirection,y=i.textHScale*p,w=e.length,A=r.vertical,_=A?1:-1,S=r.defaultVMetrics,C=l*i.fontMatrix[0],M=i.textRenderingMode===vn.FILL&&!r.disableFontFace&&!i.patternFill;c.save(),i.textMatrix&&c.transform(...i.textMatrix),c.translate(i.x,i.y+i.textRise),p>0?c.scale(y,-1):c.scale(y,1);let k,L;const j=i.textRenderingMode&vn.FILL_STROKE_MASK,F=j===vn.FILL||j===vn.FILL_STROKE,z=j===vn.STROKE||j===vn.FILL_STROKE;if(F&&i.patternFill){c.save();const ct=i.fillColor.getPattern(c,this,ws(c),In.FILL,t);k=Qe(c),c.restore(),c.fillStyle=ct}if(z&&i.patternStroke){c.save();const ct=i.strokeColor.getPattern(c,this,ws(c),In.STROKE,t);L=Qe(c),c.restore(),c.strokeStyle=ct}let H=i.lineWidth;const ut=i.textMatrixScale;if(ut===0||H===0?z&&(H=this.getSinglePixelWidth()):H/=ut,u!==1&&(c.scale(u,u),H/=u),c.lineWidth=H,r.isInvalidPDFjsFont){const ct=[];let Tt=0;for(const Bt of e)ct.push(Bt.unicode),Tt+=Bt.width;const Lt=ct.join("");if(c.fillText(Lt,0,0),this.dependencyTracker!==null){const Bt=c.measureText(Lt);this.dependencyTracker.recordBBox(t,this.ctx,-Bt.actualBoundingBoxLeft,Bt.actualBoundingBoxRight,-Bt.actualBoundingBoxAscent,Bt.actualBoundingBoxDescent).recordShowTextOperation(t)}i.x+=Tt*C*y,c.restore(),this.compose();return}let ft=0,_t;for(_t=0;_t<w;++_t){const ct=e[_t];if(typeof ct=="number"){ft+=_*ct*l/1e3;continue}let Tt=!1;const Lt=(ct.isSpace?f:0)+d,Bt=ct.fontChar,Vt=ct.accent;let G,st,wt=ct.width;if(A){const I=ct.vmetric||S,J=-(ct.vmetric?I[1]:wt*.5)*C,mt=I[2]*C;wt=I?-I[0]:wt,G=J/u,st=(ft+mt)/u}else G=ft/u,st=0;let Yt;if(r.remeasure&&wt>0){Yt=c.measureText(Bt);const I=Yt.width*1e3/l*u;if(wt<I&&this.isFontSubpixelAAEnabled){const J=wt/I;Tt=!0,c.save(),c.scale(J,1),G/=J}else wt!==I&&(G+=(wt-I)/2e3*l/u)}if(this.contentVisible&&(ct.isInFont||r.missingFile)){if(M&&!Vt)c.fillText(Bt,G,st),this.dependencyTracker?.recordCharacterBBox(t,c,Yt?{bbox:null}:r,l/u,G,st,()=>Yt??c.measureText(Bt));else if(this.paintChar(t,Bt,G,st,k,L),Vt){const I=G+l*Vt.offset.x/u,J=st-l*Vt.offset.y/u;this.paintChar(t,Vt.fontChar,I,J,k,L)}}const Ct=A?wt*C-Lt*p:wt*C+Lt*p;ft+=Ct,Tt&&c.restore()}A?i.y-=ft:i.x+=ft*y,c.restore(),this.compose(),this.dependencyTracker?.recordShowTextOperation(t)}showType3Text(t,e){const i=this.ctx,r=this.current,l=r.font,c=r.fontSize,u=r.fontDirection,d=l.vertical?1:-1,f=r.charSpacing,p=r.wordSpacing,y=r.textHScale*u,w=r.fontMatrix||Xp,A=e.length,_=r.textRenderingMode===vn.INVISIBLE;let S,C,M,k;if(_||c===0)return;this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,i.save(),r.textMatrix&&i.transform(...r.textMatrix),i.translate(r.x,r.y+r.textRise),i.scale(y,u);const L=this.dependencyTracker;for(this.dependencyTracker=L?new $h(L,t):null,S=0;S<A;++S){if(C=e[S],typeof C=="number"){k=d*C*c/1e3,this.ctx.translate(k,0),r.x+=k*y;continue}const j=(C.isSpace?p:0)+f,F=l.charProcOperatorList[C.operatorListId];F?this.contentVisible&&(this.save(),i.scale(c,c),i.transform(...w),this.executeOperatorList(F),this.restore()):ne(`Type3 character "${C.operatorListId}" is not available.`);const z=[C.width,0];qt.applyTransform(z,w),M=z[0]*c+j,i.translate(M,0),r.x+=M*y}i.restore(),L&&(this.dependencyTracker=L)}setCharWidth(t,e,i){}setCharWidthAndBounds(t,e,i,r,l,c,u){const d=new Path2D;d.rect(r,l,c-r,u-l),this.ctx.clip(d),this.dependencyTracker?.recordBBox(t,this.ctx,r,c,l,u).recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}getColorN_Pattern(t,e){let i;if(e[0]==="TilingPattern"){const r=this.baseTransform||Qe(this.ctx),l={createCanvasGraphics:(c,u)=>new sl(c,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack},void 0,void 0,this.dependencyTracker?new $h(this.dependencyTracker,u,!0):null)};i=new Im(e,this.ctx,l,r)}else i=this._getPattern(t,e[1],e[2]);return i}setStrokeColorN(t,...e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.current.strokeColor=this.getColorN_Pattern(t,e),this.current.patternStroke=!0}setFillColorN(t,...e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.current.fillColor=this.getColorN_Pattern(t,e),this.current.patternFill=!0}setStrokeRGBColor(t,e){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor=e,this.current.patternStroke=!1}setStrokeTransparent(t){this.dependencyTracker?.recordSimpleData("strokeColor",t),this.ctx.strokeStyle=this.current.strokeColor="transparent",this.current.patternStroke=!1}setFillRGBColor(t,e){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor=e,this.current.patternFill=!1}setFillTransparent(t){this.dependencyTracker?.recordSimpleData("fillColor",t),this.ctx.fillStyle=this.current.fillColor="transparent",this.current.patternFill=!1}_getPattern(t,e,i=null){let r;return this.cachedPatterns.has(e)?r=this.cachedPatterns.get(e):(r=yT(this.getObject(t,e)),this.cachedPatterns.set(e,r)),i&&(r.matrix=i),r}shadingFill(t,e){if(!this.contentVisible)return;const i=this.ctx;this.save(t);const r=this._getPattern(t,e);i.fillStyle=r.getPattern(i,this,ws(i),In.SHADING,t);const l=ws(i);if(l){const{width:c,height:u}=i.canvas,d=tl.slice();qt.axialAlignedBoundingBox([0,0,c,u],l,d);const[f,p,y,w]=d;this.ctx.fillRect(f,p,y-f,w-p)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.dependencyTracker?.resetBBox(t).recordFullPageBBox(t).recordDependencies(t,qi.transform).recordDependencies(t,qi.fill).recordOperation(t),this.compose(this.current.getClippedPathBoundingBox()),this.restore(t)}beginInlineImage(){Me("Should not call beginInlineImage")}beginImageData(){Me("Should not call beginImageData")}paintFormXObjectBegin(t,e,i){if(this.contentVisible&&(this.save(t),this.baseTransformStack.push(this.baseTransform),e&&this.transform(t,...e),this.baseTransform=Qe(this.ctx),i)){qt.axialAlignedBoundingBox(i,this.baseTransform,this.current.minMax);const[r,l,c,u]=i,d=new Path2D;d.rect(r,l,c-r,u-l),this.ctx.clip(d),this.dependencyTracker?.recordClipBox(t,this.ctx,r,c,l,u),this.endPath(t)}}paintFormXObjectEnd(t){this.contentVisible&&(this.restore(t),this.baseTransform=this.baseTransformStack.pop())}beginGroup(t,e){if(!this.contentVisible)return;this.save(t),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const i=this.ctx;e.isolated||id("TODO: Support non-isolated groups."),e.knockout&&ne("Knockout groups not supported.");const r=Qe(i);if(e.matrix&&i.transform(...e.matrix),!e.bbox)throw new Error("Bounding box is required.");let l=tl.slice();qt.axialAlignedBoundingBox(e.bbox,Qe(i),l);const c=[0,0,i.canvas.width,i.canvas.height];l=qt.intersect(l,c)||[0,0,0,0];const u=Math.floor(l[0]),d=Math.floor(l[1]),f=Math.max(Math.ceil(l[2])-u,1),p=Math.max(Math.ceil(l[3])-d,1);this.current.startNewPathAndClipBox([0,0,f,p]);let y="groupAt"+this.groupLevel;e.smask&&(y+="_smask_"+this.smaskCounter++%2);const w=this.cachedCanvases.getCanvas(y,f,p),A=w.context;A.translate(-u,-d),A.transform(...r);let _=new Path2D;const[S,C,M,k]=e.bbox;if(_.rect(S,C,M-S,k-C),e.matrix){const L=new Path2D;L.addPath(_,new DOMMatrix(e.matrix)),_=L}A.clip(_),e.smask&&this.smaskStack.push({canvas:w.canvas,context:A,offsetX:u,offsetY:d,subtype:e.smask.subtype,backdrop:e.smask.backdrop,transferMap:e.smask.transferMap||null,startTransformInverse:null}),(!e.smask||this.dependencyTracker)&&(i.setTransform(1,0,0,1,0,0),i.translate(u,d),i.save()),Sc(i,A),this.ctx=A,this.dependencyTracker?.inheritSimpleDataAsFutureForcedDependencies(["fillAlpha","strokeAlpha","globalCompositeOperation"]).pushBaseTransform(i),this.setGState(t,[["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(i),this.groupLevel++}endGroup(t,e){if(!this.contentVisible)return;this.groupLevel--;const i=this.ctx,r=this.groupStack.pop();if(this.ctx=r,this.ctx.imageSmoothingEnabled=!1,this.dependencyTracker?.popBaseTransform(),e.smask)this.tempSMask=this.smaskStack.pop(),this.restore(t),this.dependencyTracker&&this.ctx.restore();else{this.ctx.restore();const l=Qe(this.ctx);this.restore(t),this.ctx.save(),this.ctx.setTransform(...l);const c=tl.slice();qt.axialAlignedBoundingBox([0,0,i.canvas.width,i.canvas.height],l,c),this.ctx.drawImage(i.canvas,0,0),this.ctx.restore(),this.compose(c)}}beginAnnotation(t,e,i,r,l,c){if(this.#t(),Ah(this.ctx),this.ctx.save(),this.save(t),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),i){const u=i[2]-i[0],d=i[3]-i[1];if(c&&this.annotationCanvasMap){r=r.slice(),r[4]-=i[0],r[5]-=i[1],i=i.slice(),i[0]=i[1]=0,i[2]=u,i[3]=d,qt.singularValueDecompose2dScale(Qe(this.ctx),Ci);const{viewportScale:f}=this,p=Math.ceil(u*this.outputScaleX*f),y=Math.ceil(d*this.outputScaleY*f);this.annotationCanvas=this.canvasFactory.create(p,y);const{canvas:w,context:A}=this.annotationCanvas;this.annotationCanvasMap.set(e,w),this.annotationCanvas.savedCtx=this.ctx,this.ctx=A,this.ctx.save(),this.ctx.setTransform(Ci[0],0,0,-Ci[1],0,d*Ci[1]),Ah(this.ctx)}else{Ah(this.ctx),this.endPath(t);const f=new Path2D;f.rect(i[0],i[1],u,d),this.ctx.clip(f)}}this.current=new h0(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(t,...r),this.transform(t,...l)}endAnnotation(t){this.annotationCanvas&&(this.ctx.restore(),this.#e(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(t,e){if(!this.contentVisible)return;const i=e.count;e=this.getObject(t,e.data,e),e.count=i;const r=this.ctx,l=this._createMaskCanvas(t,e),c=l.canvas;r.save(),r.setTransform(1,0,0,1,0,0),r.drawImage(c,l.offsetX,l.offsetY),this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,l.offsetX,l.offsetX+c.width,l.offsetY,l.offsetY+c.height).recordOperation(t),r.restore(),this.compose()}paintImageMaskXObjectRepeat(t,e,i,r=0,l=0,c,u){if(!this.contentVisible)return;e=this.getObject(t,e.data,e);const d=this.ctx;d.save();const f=Qe(d);d.transform(i,r,l,c,0,0);const p=this._createMaskCanvas(t,e);d.setTransform(1,0,0,1,p.offsetX-f[4],p.offsetY-f[5]),this.dependencyTracker?.resetBBox(t);for(let y=0,w=u.length;y<w;y+=2){const A=qt.transform(f,[i,r,l,c,u[y],u[y+1]]);d.drawImage(p.canvas,A[4],A[5]),this.dependencyTracker?.recordBBox(t,this.ctx,A[4],A[4]+p.canvas.width,A[5],A[5]+p.canvas.height)}d.restore(),this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageMaskXObjectGroup(t,e){if(!this.contentVisible)return;const i=this.ctx,r=this.current.fillColor,l=this.current.patternFill;this.dependencyTracker?.resetBBox(t).recordDependencies(t,qi.transformAndFill);for(const c of e){const{data:u,width:d,height:f,transform:p}=c,y=this.cachedCanvases.getCanvas("maskCanvas",d,f),w=y.context;w.save();const A=this.getObject(t,u,c);f0(w,A),w.globalCompositeOperation="source-in",w.fillStyle=l?r.getPattern(w,this,ws(i),In.FILL,t):r,w.fillRect(0,0,d,f),w.restore(),i.save(),i.transform(...p),i.scale(1,-1),xh(i,y.canvas,0,0,d,f,0,-1,1,1),this.dependencyTracker?.recordBBox(t,i,0,d,0,f),i.restore()}this.compose(),this.dependencyTracker?.recordOperation(t)}paintImageXObject(t,e){if(!this.contentVisible)return;const i=this.getObject(t,e);if(!i){ne("Dependent image isn't ready yet");return}this.paintInlineImageXObject(t,i)}paintImageXObjectRepeat(t,e,i,r,l){if(!this.contentVisible)return;const c=this.getObject(t,e);if(!c){ne("Dependent image isn't ready yet");return}const u=c.width,d=c.height,f=[];for(let p=0,y=l.length;p<y;p+=2)f.push({transform:[i,0,0,r,l[p],l[p+1]],x:0,y:0,w:u,h:d});this.paintInlineImageXObjectGroup(t,c,f)}applyTransferMapsToCanvas(t){return this.current.transferMaps!=="none"&&(t.filter=this.current.transferMaps,t.drawImage(t.canvas,0,0),t.filter="none"),t.canvas}applyTransferMapsToBitmap(t){if(this.current.transferMaps==="none")return t.bitmap;const{bitmap:e,width:i,height:r}=t,l=this.cachedCanvases.getCanvas("inlineImage",i,r),c=l.context;return c.filter=this.current.transferMaps,c.drawImage(e,0,0),c.filter="none",l.canvas}paintInlineImageXObject(t,e){if(!this.contentVisible)return;const i=e.width,r=e.height,l=this.ctx;this.save(t);const{filter:c}=l;c!=="none"&&c!==""&&(l.filter="none"),l.scale(1/i,-1/r);let u;if(e.bitmap)u=this.applyTransferMapsToBitmap(e);else if(typeof HTMLElement=="function"&&e instanceof HTMLElement||!e.data)u=e;else{const p=this.cachedCanvases.getCanvas("inlineImage",i,r).context;d0(p,e),u=this.applyTransferMapsToCanvas(p)}const d=this._scaleImage(u,ws(l));l.imageSmoothingEnabled=p0(Qe(l),e.interpolate),this.dependencyTracker?.resetBBox(t).recordBBox(t,l,0,i,-r,0).recordDependencies(t,qi.imageXObject).recordOperation(t),xh(l,d.img,0,0,d.paintWidth,d.paintHeight,0,-r,i,r),this.compose(),this.restore(t)}paintInlineImageXObjectGroup(t,e,i){if(!this.contentVisible)return;const r=this.ctx;let l;if(e.bitmap)l=e.bitmap;else{const c=e.width,u=e.height,f=this.cachedCanvases.getCanvas("inlineImage",c,u).context;d0(f,e),l=this.applyTransferMapsToCanvas(f)}this.dependencyTracker?.resetBBox(t);for(const c of i)r.save(),r.transform(...c.transform),r.scale(1,-1),xh(r,l,c.x,c.y,c.w,c.h,0,-1,1,1),this.dependencyTracker?.recordBBox(t,r,0,1,-1,0),r.restore();this.dependencyTracker?.recordOperation(t),this.compose()}paintSolidColorImageMask(t){this.contentVisible&&(this.dependencyTracker?.resetBBox(t).recordBBox(t,this.ctx,0,1,0,1).recordDependencies(t,qi.fill).recordOperation(t),this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(t,e){}markPointProps(t,e,i){}beginMarkedContent(t,e){this.dependencyTracker?.beginMarkedContent(t),this.markedContentStack.push({visible:!0})}beginMarkedContentProps(t,e,i){this.dependencyTracker?.beginMarkedContent(t),e==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(i)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(t){this.dependencyTracker?.endMarkedContent(t),this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(t){}endCompat(t){}consumePath(t,e,i){const r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(i);const l=this.ctx;this.pendingClip?(r||(this.pendingClip===m0?l.clip(e,"evenodd"):l.clip(e)),this.pendingClip=null,this.dependencyTracker?.bboxToClipBoxDropOperation(t).recordFutureForcedDependency("clipPath",t)):this.dependencyTracker?.recordOperation(t),this.current.startNewPathAndClipBox(this.current.clipBox)}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const t=Qe(this.ctx);if(t[1]===0&&t[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(t[0]),Math.abs(t[3]));else{const e=Math.abs(t[0]*t[3]-t[2]*t[1]),i=Math.hypot(t[0],t[2]),r=Math.hypot(t[1],t[3]);this._cachedGetSinglePixelWidth=Math.max(i,r)/e}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:t}=this.current,{a:e,b:i,c:r,d:l}=this.ctx.getTransform();let c,u;if(i===0&&r===0){const d=Math.abs(e),f=Math.abs(l);if(d===f)if(t===0)c=u=1/d;else{const p=d*t;c=u=p<1?1/p:1}else if(t===0)c=1/d,u=1/f;else{const p=d*t,y=f*t;c=p<1?1/p:1,u=y<1?1/y:1}}else{const d=Math.abs(e*l-i*r),f=Math.hypot(e,i),p=Math.hypot(r,l);if(t===0)c=p/d,u=f/d;else{const y=t*d;c=p>y?p/y:1,u=f>y?f/y:1}}this._cachedScaleForStroking[0]=c,this._cachedScaleForStroking[1]=u}return this._cachedScaleForStroking}rescaleAndStroke(t,e){const{ctx:i,current:{lineWidth:r}}=this,[l,c]=this.getScaleForStroking();if(l===c){i.lineWidth=(r||1)*l,i.stroke(t);return}const u=i.getLineDash();e&&i.save(),i.scale(l,c),Cp.a=1/l,Cp.d=1/c;const d=new Path2D;if(d.addPath(t,Cp),u.length>0){const f=Math.max(l,c);i.setLineDash(u.map(p=>p/f)),i.lineDashOffset/=f}i.lineWidth=r||1,i.stroke(d),e&&i.restore()}isContentVisible(){for(let t=this.markedContentStack.length-1;t>=0;t--)if(!this.markedContentStack[t].visible)return!1;return!0}}for(const a in Pc)sl.prototype[a]!==void 0&&(sl.prototype[Pc[a]]=sl.prototype[a]);class rl{static#t=null;static#e="";static get workerPort(){return this.#t}static set workerPort(t){if(!(typeof Worker<"u"&&t instanceof Worker)&&t!==null)throw new Error("Invalid `workerPort` type.");this.#t=t}static get workerSrc(){return this.#e}static set workerSrc(t){if(typeof t!="string")throw new Error("Invalid `workerSrc` type.");this.#e=t}}class _T{#t;#e;constructor({parsedData:t,rawData:e}){this.#t=t,this.#e=e}getRaw(){return this.#e}get(t){return this.#t.get(t)??null}[Symbol.iterator](){return this.#t.entries()}}const Wo=Symbol("INTERNAL");class CT{#t=!1;#e=!1;#i=!1;#n=!0;constructor(t,{name:e,intent:i,usage:r,rbGroups:l}){this.#t=!!(t&Ei.DISPLAY),this.#e=!!(t&Ei.PRINT),this.name=e,this.intent=i,this.usage=r,this.rbGroups=l}get visible(){if(this.#i)return this.#n;if(!this.#n)return!1;const{print:t,view:e}=this.usage;return this.#t?e?.viewState!=="OFF":this.#e?t?.printState!=="OFF":!0}_setVisible(t,e,i=!1){t!==Wo&&Me("Internal method `_setVisible` called."),this.#i=i,this.#n=e}}class TT{#t=null;#e=new Map;#i=null;#n=null;constructor(t,e=Ei.DISPLAY){if(this.renderingIntent=e,this.name=null,this.creator=null,t!==null){this.name=t.name,this.creator=t.creator,this.#n=t.order;for(const i of t.groups)this.#e.set(i.id,new CT(e,i));if(t.baseState==="OFF")for(const i of this.#e.values())i._setVisible(Wo,!1);for(const i of t.on)this.#e.get(i)._setVisible(Wo,!0);for(const i of t.off)this.#e.get(i)._setVisible(Wo,!1);this.#i=this.getHash()}}#s(t){const e=t.length;if(e<2)return!0;const i=t[0];for(let r=1;r<e;r++){const l=t[r];let c;if(Array.isArray(l))c=this.#s(l);else if(this.#e.has(l))c=this.#e.get(l).visible;else return ne(`Optional content group not found: ${l}`),!0;switch(i){case"And":if(!c)return!1;break;case"Or":if(c)return!0;break;case"Not":return!c;default:return!0}}return i==="And"}isVisible(t){if(this.#e.size===0)return!0;if(!t)return id("Optional content group not defined."),!0;if(t.type==="OCG")return this.#e.has(t.id)?this.#e.get(t.id).visible:(ne(`Optional content group not found: ${t.id}`),!0);if(t.type==="OCMD"){if(t.expression)return this.#s(t.expression);if(!t.policy||t.policy==="AnyOn"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOn"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!1}return!0}else if(t.policy==="AnyOff"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(!this.#e.get(e).visible)return!0}return!1}else if(t.policy==="AllOff"){for(const e of t.ids){if(!this.#e.has(e))return ne(`Optional content group not found: ${e}`),!0;if(this.#e.get(e).visible)return!1}return!0}return ne(`Unknown optional content policy ${t.policy}.`),!0}return ne(`Unknown group type ${t.type}.`),!0}setVisibility(t,e=!0,i=!0){const r=this.#e.get(t);if(!r){ne(`Optional content group not found: ${t}`);return}if(i&&e&&r.rbGroups.length)for(const l of r.rbGroups)for(const c of l)c!==t&&this.#e.get(c)?._setVisible(Wo,!1,!0);r._setVisible(Wo,!!e,!0),this.#t=null}setOCGState({state:t,preserveRB:e}){let i;for(const r of t){switch(r){case"ON":case"OFF":case"Toggle":i=r;continue}const l=this.#e.get(r);if(l)switch(i){case"ON":this.setVisibility(r,!0,e);break;case"OFF":this.setVisibility(r,!1,e);break;case"Toggle":this.setVisibility(r,!l.visible,e);break}}this.#t=null}get hasInitialVisibility(){return this.#i===null||this.getHash()===this.#i}getOrder(){return this.#e.size?this.#n?this.#n.slice():[...this.#e.keys()]:null}getGroup(t){return this.#e.get(t)||null}getHash(){if(this.#t!==null)return this.#t;const t=new Ow;for(const[e,i]of this.#e)t.update(`${e}:${i.visible}`);return this.#t=t.hexdigest()}[Symbol.iterator](){return this.#e.entries()}}class od{#t=null;#e=null;_fullReader=null;_rangeReaders=new Set;_source=null;constructor(t,e,i){this._source=t,this.#t=e,this.#e=i}get _progressiveDataLength(){return this._fullReader?._loaded??0}getFullReader(){return Re(!this._fullReader,"BasePDFStream.getFullReader can only be called once."),this._fullReader=new this.#t(this)}getRangeReader(t,e){if(e<=this._progressiveDataLength)return null;const i=new this.#e(this,t,e);return this._rangeReaders.add(i),i}cancelAllRequests(t){this._fullReader?.cancel(t);for(const e of new Set(this._rangeReaders))e.cancel(t)}}class ld{onProgress=null;_contentLength=0;_filename=null;_headersCapability=Promise.withResolvers();_isRangeSupported=!1;_isStreamingSupported=!1;_loaded=0;_stream=null;constructor(t){this._stream=t}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){Me("Abstract method `read` called")}cancel(t){Me("Abstract method `cancel` called")}}class cd{_stream=null;constructor(t,e,i){this._stream=t}async read(){Me("Abstract method `read` called")}cancel(t){Me("Abstract method `cancel` called")}}function g0(a){return a instanceof Uint8Array&&a.byteLength===a.buffer.byteLength?a.buffer:new Uint8Array(a).buffer}class RT extends od{_progressiveDone=!1;_queuedChunks=[];constructor(t){super(t,MT,DT);const{pdfDataRangeTransport:e}=t,{initialData:i,progressiveDone:r}=e;if(i?.length>0){const l=g0(i);this._queuedChunks.push(l)}this._progressiveDone=r,e.addRangeListener((l,c)=>{this.#t(l,c)}),e.addProgressListener((l,c)=>{c!==void 0&&this._fullReader?.onProgress?.({loaded:l,total:c})}),e.addProgressiveReadListener(l=>{this.#t(void 0,l)}),e.addProgressiveDoneListener(()=>{this._fullReader?.progressiveDone(),this._progressiveDone=!0}),e.transportReady()}#t(t,e){const i=g0(e);if(t===void 0)this._fullReader?this._fullReader._enqueue(i):this._queuedChunks.push(i);else{const r=this._rangeReaders.keys().find(l=>l._begin===t);Re(r,"#onReceiveData - no `PDFDataTransportStreamRangeReader` instance found."),r._enqueue(i)}}getFullReader(){const t=super.getFullReader();return this._queuedChunks=null,t}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onDone=()=>this._rangeReaders.delete(i),this._source.pdfDataRangeTransport.requestDataRange(t,e)),i}cancelAllRequests(t){super.cancelAllRequests(t),this._source.pdfDataRangeTransport.abort()}}class MT extends ld{_done=!1;_queuedChunks=null;_requests=[];constructor(t){super(t);const{pdfDataRangeTransport:e,disableRange:i,disableStream:r}=t._source,{length:l,contentDispositionFilename:c}=e;this._queuedChunks=t._queuedChunks||[];for(const u of this._queuedChunks)this._loaded+=u.byteLength;this._done=t._progressiveDone,this._contentLength=l,this._isStreamingSupported=!r,this._isRangeSupported=!i,km(c)&&(this._filename=c),this._headersCapability.resolve()}_enqueue(t){this._done||(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunks.push(t),this._loaded+=t.byteLength)}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||=!0}}class DT extends cd{onDone=null;_begin=-1;_done=!1;_queuedChunk=null;_requests=[];constructor(t,e,i){super(t,e,i),this._begin=e}_enqueue(t){if(!this._done){if(this._requests.length===0)this._queuedChunk=t;else{this._requests.shift().resolve({value:t,done:!1});for(const i of this._requests)i.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this.onDone?.()}}async read(){if(this._queuedChunk){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onDone?.()}}function OT(a){let t=!0,e=i("filename\\*","i").exec(a);if(e){e=e[1];let p=u(e);return p=unescape(p),p=d(p),p=f(p),l(p)}if(e=c(a),e){const p=f(e);return l(p)}if(e=i("filename","i").exec(a),e){e=e[1];let p=u(e);return p=f(p),l(p)}function i(p,y){return new RegExp("(?:^|;)\\s*"+p+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',y)}function r(p,y){if(p){if(!/^[\x00-\xFF]+$/.test(y))return y;try{const w=new TextDecoder(p,{fatal:!0}),A=sd(y);y=w.decode(A),t=!1}catch{}}return y}function l(p){return t&&/[\x80-\xff]/.test(p)&&(p=r("utf-8",p),t&&(p=r("iso-8859-1",p))),p}function c(p){const y=[];let w;const A=i("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(w=A.exec(p))!==null;){let[,S,C,M]=w;if(S=parseInt(S,10),S in y){if(S===0)break;continue}y[S]=[C,M]}const _=[];for(let S=0;S<y.length&&S in y;++S){let[C,M]=y[S];M=u(M),C&&(M=unescape(M),S===0&&(M=d(M))),_.push(M)}return _.join("")}function u(p){if(p.startsWith('"')){const y=p.slice(1).split('\\"');for(let w=0;w<y.length;++w){const A=y[w].indexOf('"');A!==-1&&(y[w]=y[w].slice(0,A),y.length=w+1),y[w]=y[w].replaceAll(/\\(.)/g,"$1")}p=y.join('"')}return p}function d(p){const y=p.indexOf("'");if(y===-1)return p;const w=p.slice(0,y),_=p.slice(y+1).replace(/^[^']*'/,"");return r(w,_)}function f(p){return!p.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(p)?p:p.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function(y,w,A,_){if(A==="q"||A==="Q")return _=_.replaceAll("_"," "),_=_.replaceAll(/=([0-9a-fA-F]{2})/g,function(S,C){return String.fromCharCode(parseInt(C,16))}),r(w,_);try{_=atob(_)}catch{}return r(w,_)})}return""}function Fw(a,t){const e=new Headers;if(!a||!t||typeof t!="object")return e;for(const i in t){const r=t[i];r!==void 0&&e.append(i,r)}return e}function ud(a){return URL.parse(a)?.origin??null}function Iw({responseHeaders:a,isHttp:t,rangeChunkSize:e,disableRange:i}){const r={allowRangeRequests:!1,suggestedLength:void 0},l=parseInt(a.get("Content-Length"),10);return!Number.isInteger(l)||(r.suggestedLength=l,l<=2*e)||i||!t||a.get("Accept-Ranges")!=="bytes"||(a.get("Content-Encoding")||"identity")!=="identity"||(r.allowRangeRequests=!0),r}function Uw(a){const t=a.get("Content-Disposition");if(t){let e=OT(t);if(e.includes("%"))try{e=decodeURIComponent(e)}catch{}if(km(e))return e}return null}function hd(a,t){return new Gh(`Unexpected server response (${a}) while retrieving PDF "${t}".`,a,a===404||a===0&&t.startsWith("file:"))}function zw(a,t){if(a!==t)throw new Error(`Expected range response-origin "${a}" to match "${t}".`)}function Hw(a,t,e,i){return fetch(a,{method:"GET",headers:t,signal:i.signal,mode:"cors",credentials:e?"include":"same-origin",redirect:"follow"})}function qw(a,t){if(a!==200&&a!==206)throw hd(a,t)}function Gw(a){return a instanceof Uint8Array?a.buffer:a instanceof ArrayBuffer?a:(ne(`getArrayBuffer - unexpected data format: ${a}`),new Uint8Array(a).buffer)}class NT extends od{_responseOrigin=null;constructor(t){super(t,kT,LT),this.isHttp=/^https?:/i.test(t.url),this.headers=Fw(this.isHttp,t.httpHeaders)}}class kT extends ld{_abortController=new AbortController;_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:r,rangeChunkSize:l,url:c,withCredentials:u}=t._source;this._contentLength=r,this._isStreamingSupported=!i,this._isRangeSupported=!e;const d=new Headers(t.headers);Hw(c,d,u,this._abortController).then(f=>{t._responseOrigin=ud(f.url),qw(f.status,c),this._reader=f.body.getReader();const p=f.headers,{allowRangeRequests:y,suggestedLength:w}=Iw({responseHeaders:p,isHttp:t.isHttp,rangeChunkSize:l,disableRange:e});this._isRangeSupported=y,this._contentLength=w||this._contentLength,this._filename=Uw(p),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Zr("Streaming is disabled.")),this._headersCapability.resolve()}).catch(this._headersCapability.reject)}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Gw(t),done:!1})}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}class LT extends cd{_abortController=new AbortController;_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const{url:r,withCredentials:l}=t._source,c=new Headers(t.headers);c.append("Range",`bytes=${e}-${i-1}`),Hw(r,c,l,this._abortController).then(u=>{const d=ud(u.url);zw(d,t._responseOrigin),qw(u.status,r),this._reader=u.body.getReader(),this._readCapability.resolve()}).catch(this._readCapability.reject)}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:Gw(t),done:!1}}cancel(t){this._reader?.cancel(t),this._abortController.abort()}}const Tp=200,y0=206;function PT(a){return typeof a!="string"?a:sd(a).buffer}class BT extends od{#t=new WeakMap;_responseOrigin=null;constructor(t){super(t,jT,FT),this.url=t.url,this.isHttp=/^https?:/i.test(this.url),this.headers=Fw(this.isHttp,t.httpHeaders)}_request(t){const e=new XMLHttpRequest,i={validateStatus:null,onHeadersReceived:t.onHeadersReceived,onDone:t.onDone,onError:t.onError,onProgress:t.onProgress};this.#t.set(e,i),e.open("GET",this.url),e.withCredentials=this._source.withCredentials;for(const[r,l]of this.headers)e.setRequestHeader(r,l);return this.isHttp&&"begin"in t&&"end"in t?(e.setRequestHeader("Range",`bytes=${t.begin}-${t.end-1}`),i.validateStatus=r=>r===y0||r===Tp):i.validateStatus=r=>r===Tp,e.responseType="arraybuffer",Re(t.onError,"Expected `onError` callback to be provided."),e.onerror=()=>t.onError(e.status),e.onreadystatechange=this.#i.bind(this,e),e.onprogress=this.#e.bind(this,e),e.send(null),e}#e(t,e){this.#t.get(t)?.onProgress?.(e)}#i(t,e){const i=this.#t.get(t);if(!i||(t.readyState>=2&&i.onHeadersReceived&&(i.onHeadersReceived(),delete i.onHeadersReceived),t.readyState!==4)||!this.#t.has(t))return;if(this.#t.delete(t),t.status===0&&this.isHttp){i.onError(t.status);return}const r=t.status||Tp;if(!i.validateStatus(r)){i.onError(t.status);return}const l=PT(t.response);if(r===y0){const c=t.getResponseHeader("Content-Range");/bytes (\d+)-(\d+)\/(\d+)/.test(c)?i.onDone(l):(ne('Missing or invalid "Content-Range" header.'),i.onError(0))}else l?i.onDone(l):i.onError(t.status)}_abortRequest(t){this.#t.has(t)&&(this.#t.delete(t),t.abort())}getRangeReader(t,e){const i=super.getRangeReader(t,e);return i&&(i.onClosed=()=>this._rangeReaders.delete(i)),i}}class jT extends ld{_cachedChunks=[];_done=!1;_requests=[];_storedError=null;constructor(t){super(t);const{length:e}=t._source;this._contentLength=e,this._fullRequestXhr=t._request({onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:this.#n.bind(this)})}#t(){const t=this._stream,{disableRange:e,rangeChunkSize:i}=t._source,r=this._fullRequestXhr;t._responseOrigin=ud(r.responseURL);const l=r.getAllResponseHeaders(),c=new Headers(l?l.trimStart().replace(/[^\S ]+$/,"").split(/[\r\n]+/).map(f=>{const[p,...y]=f.split(": ");return[p,y.join(": ")]}):[]),{allowRangeRequests:u,suggestedLength:d}=Iw({responseHeaders:c,isHttp:t.isHttp,rangeChunkSize:i,disableRange:e});u&&(this._isRangeSupported=!0),this._contentLength=d||this._contentLength,this._filename=Uw(c),this._isRangeSupported&&t._abortRequest(r),this._headersCapability.resolve()}#e(t){if(this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._cachedChunks.push(t),this._done=!0,!(this._cachedChunks.length>0)){for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0}}#i(t){this._storedError=hd(t,this._stream.url),this._headersCapability.reject(this._storedError);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}#n(t){this.onProgress?.({loaded:t.loaded,total:t.lengthComputable?t.total:this._contentLength})}async read(){if(await this._headersCapability.promise,this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0,this._headersCapability.reject(t);for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._fullRequestXhr),this._fullRequestXhr=null}}class FT extends cd{onClosed=null;_done=!1;_queuedChunk=null;_requests=[];_storedError=null;constructor(t,e,i){super(t,e,i),this._requestXhr=t._request({begin:e,end:i,onHeadersReceived:this.#t.bind(this),onDone:this.#e.bind(this),onError:this.#i.bind(this),onProgress:null})}#t(){const t=ud(this._requestXhr?.responseURL);try{zw(t,this._stream._responseOrigin)}catch(e){this._storedError=e,this.#i(0)}}#e(t){this._requests.length>0?this._requests.shift().resolve({value:t,done:!1}):this._queuedChunk=t,this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this.onClosed?.()}#i(t){this._storedError??=hd(t,this._stream.url);for(const e of this._requests)e.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const e=this._queuedChunk;return this._queuedChunk=null,{value:e,done:!1}}if(this._done)return{value:void 0,done:!0};const t=Promise.withResolvers();return this._requests.push(t),t.promise}cancel(t){this._done=!0;for(const e of this._requests)e.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._abortRequest(this._requestXhr),this.onClosed?.()}}const IT=/^[a-z][a-z0-9\-+.]+:/i;function UT(a){if(IT.test(a))return new URL(a);const t=process.getBuiltinModule("url");return new URL(t.pathToFileURL(a))}function $w(a){const{Readable:t}=process.getBuiltinModule("stream");return typeof t.toWeb=="function"?t.toWeb(a):process.getBuiltinModule("module").createRequire(import.meta.url)("node-readable-to-web-readable-stream").makeDefaultReadableStreamFromNodeReadable(a)}function Vw(a){return a instanceof Uint8Array?a.buffer:a instanceof ArrayBuffer?a:(ne(`getArrayBuffer - unexpected data format: ${a}`),new Uint8Array(a).buffer)}class zT extends od{constructor(t){super(t,HT,qT),this.url=UT(t.url),Re(this.url.protocol==="file:","PDFNodeStream only supports file:// URLs.")}}class HT extends ld{_reader=null;constructor(t){super(t);const{disableRange:e,disableStream:i,length:r,rangeChunkSize:l}=t._source;this._contentLength=r,this._isStreamingSupported=!i,this._isRangeSupported=!e;const c=t.url,u=process.getBuiltinModule("fs");u.promises.lstat(c).then(d=>{const f=u.createReadStream(c),p=$w(f);this._reader=p.getReader();const{size:y}=d;y<=2*l&&(this._isRangeSupported=!1),this._contentLength=y,!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new Zr("Streaming is disabled.")),this._headersCapability.resolve()}).catch(d=>{d.code==="ENOENT"&&(d=hd(0,c.href)),this._headersCapability.reject(d)})}async read(){await this._headersCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:(this._loaded+=t.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Vw(t),done:!1})}cancel(t){this._reader?.cancel(t)}}class qT extends cd{_readCapability=Promise.withResolvers();_reader=null;constructor(t,e,i){super(t,e,i);const r=t.url,l=process.getBuiltinModule("fs");try{const c=l.createReadStream(r,{start:e,end:i-1}),u=$w(c);this._reader=u.getReader(),this._readCapability.resolve()}catch(c){this._readCapability.reject(c)}}async read(){await this._readCapability.promise;const{value:t,done:e}=await this._reader.read();return e?{value:t,done:e}:{value:Vw(t),done:!1}}cancel(t){this._reader?.cancel(t)}}const Ec=Symbol("INITIAL_DATA");class Kw{#t=Object.create(null);#e(t){return this.#t[t]||={...Promise.withResolvers(),data:Ec}}get(t,e=null){if(e){const r=this.#e(t);return r.promise.then(()=>e(r.data)),null}const i=this.#t[t];if(!i||i.data===Ec)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return i.data}has(t){const e=this.#t[t];return!!e&&e.data!==Ec}delete(t){const e=this.#t[t];return!e||e.data===Ec?!1:(delete this.#t[t],!0)}resolve(t,e=null){const i=this.#e(t);i.data=e,i.resolve()}clear(){for(const t in this.#t){const{data:e}=this.#t[t];e?.bitmap?.close()}this.#t=Object.create(null)}*[Symbol.iterator](){for(const t in this.#t){const{data:e}=this.#t[t];e!==Ec&&(yield[t,e])}}}const GT=1e5,b0=30;class _i{#t=Promise.withResolvers();#e=null;#i=!1;#n=!!globalThis.FontInspector?.enabled;#s=null;#a=null;#r=0;#o=0;#c=null;#l=null;#d=0;#h=0;#f=Object.create(null);#g=[];#m=null;#u=[];#p=new WeakMap;#y=null;static#v=new Map;static#b=new Map;static#E=new WeakMap;static#S=null;static#w=new Set;constructor({textContentSource:t,container:e,viewport:i}){if(t instanceof ReadableStream)this.#m=t;else if(typeof t=="object")this.#m=new ReadableStream({start(d){d.enqueue(t),d.close()}});else throw new Error('No "textContentSource" parameter specified.');this.#e=this.#l=e,this.#h=i.scale*Ts.pixelRatio,this.#d=i.rotation,this.#a={div:null,properties:null,ctx:null};const{pageWidth:r,pageHeight:l,pageX:c,pageY:u}=i.rawDims;this.#y=[1,0,0,-1,-c,u+l],this.#o=r,this.#r=l,_i.#M(),e.style.setProperty("--min-font-size",_i.#S),Qa(e,i),this.#t.promise.finally(()=>{_i.#w.delete(this),this.#a=null,this.#f=null}).catch(()=>{})}static get fontFamilyMap(){const{isWindows:t,isFirefox:e}=xn.platform;return ie(this,"fontFamilyMap",new Map([["sans-serif",`${t&&e?"Calibri, ":""}sans-serif`],["monospace",`${t&&e?"Lucida Console, ":""}monospace`]]))}render(){const t=()=>{this.#c.read().then(({value:e,done:i})=>{if(i){this.#t.resolve();return}this.#s??=e.lang,Object.assign(this.#f,e.styles),this.#C(e.items),t()},this.#t.reject)};return this.#c=this.#m.getReader(),_i.#w.add(this),t(),this.#t.promise}update({viewport:t,onBefore:e=null}){const i=t.scale*Ts.pixelRatio,r=t.rotation;if(r!==this.#d&&(e?.(),this.#d=r,Qa(this.#l,{rotation:r})),i!==this.#h){e?.(),this.#h=i;const l={div:null,properties:null,ctx:_i.#D(this.#s)};for(const c of this.#u)l.properties=this.#p.get(c),l.div=c,this.#_(l)}}cancel(){const t=new Zr("TextLayer task cancelled.");this.#c?.cancel(t).catch(()=>{}),this.#c=null,this.#t.reject(t)}get textDivs(){return this.#u}get textContentItemsStr(){return this.#g}#C(t){if(this.#i)return;this.#a.ctx??=_i.#D(this.#s);const e=this.#u,i=this.#g;for(const r of t){if(e.length>GT){ne("Ignoring additional textDivs for performance reasons."),this.#i=!0;return}if(r.str===void 0){if(r.type==="beginMarkedContentProps"||r.type==="beginMarkedContent"){const l=this.#e;this.#e=document.createElement("span"),this.#e.classList.add("markedContent"),r.id&&this.#e.setAttribute("id",`${r.id}`),r.tag==="Artifact"&&(this.#e.ariaHidden=!0),l.append(this.#e)}else r.type==="endMarkedContent"&&(this.#e=this.#e.parentNode);continue}i.push(r.str),this.#x(r)}}#x(t){const e=document.createElement("span"),i={angle:0,canvasWidth:0,hasText:t.str!=="",hasEOL:t.hasEOL,fontSize:0};this.#u.push(e);const r=qt.transform(this.#y,t.transform);let l=Math.atan2(r[1],r[0]);const c=this.#f[t.fontName];c.vertical&&(l+=Math.PI/2);let u=this.#n&&c.fontSubstitution||c.fontFamily;u=_i.fontFamilyMap.get(u)||u;const d=Math.hypot(r[2],r[3]),f=d*_i.#j(u,c,this.#s);let p,y;l===0?(p=r[4],y=r[5]-f):(p=r[4]+f*Math.sin(l),y=r[5]-f*Math.cos(l));const w=e.style;w.left=`${(100*p/this.#o).toFixed(2)}%`,w.top=`${(100*y/this.#r).toFixed(2)}%`,w.setProperty("--font-height",`${d.toFixed(2)}px`),w.fontFamily=u,i.fontSize=d,e.setAttribute("role","presentation"),e.textContent=t.str,e.dir=t.dir,this.#n&&(e.dataset.fontName=c.fontSubstitutionLoadedName||t.fontName),l!==0&&(i.angle=l*(180/Math.PI));let A=!1;if(t.str.length>1)A=!0;else if(t.str!==" "&&t.transform[0]!==t.transform[3]){const _=Math.abs(t.transform[0]),S=Math.abs(t.transform[3]);_!==S&&Math.max(_,S)/Math.min(_,S)>1.5&&(A=!0)}if(A&&(i.canvasWidth=c.vertical?t.height:t.width),this.#p.set(e,i),this.#a.div=e,this.#a.properties=i,this.#_(this.#a),i.hasText&&this.#e.append(e),i.hasEOL){const _=document.createElement("br");_.setAttribute("role","presentation"),this.#e.append(_)}}#_(t){const{div:e,properties:i,ctx:r}=t,{style:l}=e;if(i.canvasWidth!==0&&i.hasText){const{fontFamily:c}=l,{canvasWidth:u,fontSize:d}=i;_i.#R(r,d*this.#h,c);const{width:f}=r.measureText(e.textContent);f>0&&l.setProperty("--scale-x",u*this.#h/f)}i.angle!==0&&l.setProperty("--rotate",`${i.angle}deg`)}static cleanup(){if(!(this.#w.size>0)){this.#v.clear();for(const{canvas:t}of this.#b.values())t.remove();this.#b.clear()}}static#D(t=null){let e=this.#b.get(t||="");if(!e){const i=document.createElement("canvas");i.className="hiddenCanvasElement",i.lang=t,document.body.append(i),e=i.getContext("2d",{alpha:!1,willReadFrequently:!0}),this.#b.set(t,e),this.#E.set(e,{size:0,family:""})}return e}static#R(t,e,i){const r=this.#E.get(t);e===r.size&&i===r.family||(t.font=`${e}px ${i}`,r.size=e,r.family=i)}static#M(){if(this.#S!==null)return;const t=document.createElement("div");t.style.opacity=0,t.style.lineHeight=1,t.style.fontSize="1px",t.style.position="absolute",t.textContent="X",document.body.append(t),this.#S=t.getBoundingClientRect().height,t.remove()}static#j(t,e,i){const r=this.#v.get(t);if(r)return r;const l=this.#D(i);l.canvas.width=l.canvas.height=b0,this.#R(l,b0,t);const c=l.measureText(""),u=c.fontBoundingBoxAscent,d=Math.abs(c.fontBoundingBoxDescent);l.canvas.width=l.canvas.height=0;let f=.8;return u?f=u/(u+d):(xn.platform.isFirefox&&ne("Enable the `dom.textMetrics.fontBoundingBox.enabled` preference in `about:config` to improve TextLayer rendering."),e.ascent?f=e.ascent:e.descent&&(f=1+e.descent)),this.#v.set(t,f),f}}const $T=100;function Xw(a={}){typeof a=="string"||a instanceof URL?a={url:a}:(a instanceof ArrayBuffer||ArrayBuffer.isView(a))&&(a={data:a});const t=new Um,{docId:e}=t,i=a.url?JC(a.url):null,r=a.data?tT(a.data):null,l=a.httpHeaders||null,c=a.withCredentials===!0,u=a.password??null,d=a.range instanceof Yw?a.range:null,f=Number.isInteger(a.rangeChunkSize)&&a.rangeChunkSize>0?a.rangeChunkSize:2**16;let p=a.worker instanceof jc?a.worker:null;const y=a.verbosity,w=typeof a.docBaseUrl=="string"&&!rd(a.docBaseUrl)?a.docBaseUrl:null,A=yh(a.cMapUrl),_=a.cMapPacked!==!1,S=a.CMapReaderFactory||(Zn?lT:n0),C=yh(a.iccUrl),M=yh(a.standardFontDataUrl),k=a.StandardFontDataFactory||(Zn?cT:i0),L=yh(a.wasmUrl),j=a.WasmFactory||(Zn?uT:s0),F=a.stopAtErrors!==!0,z=Number.isInteger(a.maxImageSize)&&a.maxImageSize>-1?a.maxImageSize:-1,H=a.isEvalSupported!==!1,ut=typeof a.isOffscreenCanvasSupported=="boolean"?a.isOffscreenCanvasSupported:!Zn,ft=typeof a.isImageDecoderSupported=="boolean"?a.isImageDecoderSupported:!Zn&&(xn.platform.isFirefox||!globalThis.chrome),_t=Number.isInteger(a.canvasMaxAreaInBytes)?a.canvasMaxAreaInBytes:-1,ct=typeof a.disableFontFace=="boolean"?a.disableFontFace:Zn,Tt=a.fontExtraProperties===!0,Lt=a.enableXfa===!0,Bt=a.ownerDocument||globalThis.document,Vt=a.disableRange===!0,G=a.disableStream===!0,st=a.disableAutoFetch===!0,wt=a.pdfBug===!0,Yt=a.CanvasFactory||(Zn?oT:sT),Ct=a.FilterFactory||(Zn?aT:rT),I=a.enableHWA===!0,J=a.useWasm!==!1,mt=d?d.length:a.length??NaN,xt=typeof a.useSystemFonts=="boolean"?a.useSystemFonts:!Zn&&!ct,It=typeof a.useWorkerFetch=="boolean"?a.useWorkerFetch:!!(S===n0&&k===i0&&j===s0&&A&&M&&L&&Tc(A,document.baseURI)&&Tc(M,document.baseURI)&&Tc(L,document.baseURI)),Ut=null;CC(y);const Ot={canvasFactory:new Yt({ownerDocument:Bt,enableHWA:I}),filterFactory:new Ct({docId:e,ownerDocument:Bt}),cMapReaderFactory:It?null:new S({baseUrl:A,isCompressed:_}),standardFontDataFactory:It?null:new k({baseUrl:M}),wasmFactory:It?null:new j({baseUrl:L})};p||(p=jc.create({verbosity:y,port:rl.workerPort}),t._worker=p);const Rt={docId:e,apiVersion:"5.4.624",data:r,password:u,disableAutoFetch:st,rangeChunkSize:f,length:mt,docBaseUrl:w,enableXfa:Lt,evaluatorOptions:{maxImageSize:z,disableFontFace:ct,ignoreErrors:F,isEvalSupported:H,isOffscreenCanvasSupported:ut,isImageDecoderSupported:ft,canvasMaxAreaInBytes:_t,fontExtraProperties:Tt,useSystemFonts:xt,useWasm:J,useWorkerFetch:It,cMapUrl:A,iccUrl:C,standardFontDataUrl:M,wasmUrl:L}},jt={ownerDocument:Bt,pdfBug:wt,styleElement:Ut,enableHWA:I,loadingParams:{disableAutoFetch:st,enableXfa:Lt}};return p.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const kt=p.messageHandler.sendWithPromise("GetDocRequest",Rt,r?[r.buffer]:null);let we;if(d)we=new RT({pdfDataRangeTransport:d,disableRange:Vt,disableStream:G});else if(!r){if(!i)throw new Error("getDocument - no `url` parameter provided.");const pt=Tc(i)?NT:Zn?zT:BT;we=new pt({url:i,length:mt,httpHeaders:l,withCredentials:c,rangeChunkSize:f,disableRange:Vt,disableStream:G})}return kt.then(pt=>{if(t.destroyed)throw new Error("Loading aborted");if(p.destroyed)throw new Error("Worker was destroyed");const fe=new Rc(e,pt,p.port),ve=new XT(fe,t,we,jt,Ot);t._transport=ve,fe.send("Ready",null)})}).catch(t._capability.reject),t}class Um{static#t=0;_capability=Promise.withResolvers();_transport=null;_worker=null;docId=`d${Um.#t++}`;destroyed=!1;onPassword=null;onProgress=null;get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker?.destroy(),this._worker=null}async getData(){return this._transport.getData()}}class Yw{#t=Promise.withResolvers();#e=[];#i=[];#n=[];#s=[];constructor(t,e,i=!1,r=null){this.length=t,this.initialData=e,this.progressiveDone=i,this.contentDispositionFilename=r}addRangeListener(t){this.#s.push(t)}addProgressListener(t){this.#n.push(t)}addProgressiveReadListener(t){this.#i.push(t)}addProgressiveDoneListener(t){this.#e.push(t)}onDataRange(t,e){for(const i of this.#s)i(t,e)}onDataProgress(t,e){this.#t.promise.then(()=>{for(const i of this.#n)i(t,e)})}onDataProgressiveRead(t){this.#t.promise.then(()=>{for(const e of this.#i)e(t)})}onDataProgressiveDone(){this.#t.promise.then(()=>{for(const t of this.#e)t()})}transportReady(){this.#t.resolve()}requestDataRange(t,e){Me("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}class VT{constructor(t,e){this._pdfInfo=t,this._transport=e}get annotationStorage(){return this._transport.annotationStorage}get canvasFactory(){return this._transport.canvasFactory}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getAnnotationsByType(t,e){return this._transport.getAnnotationsByType(t,e)}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getOptionalContentConfig(e)}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}extractPages(t){return this._transport.extractPages(t)}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}cachedPageNumber(t){return this._transport.cachedPageNumber(t)}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}class KT{#t=!1;#e=Ce.instance;constructor(t,e,i,r=!1){this._pageIndex=t,this._pageInfo=e,this._transport=i,this._stats=r?new Yv:null,this._pdfBug=r,this.commonObjs=i.commonObjs,this.objs=new Kw,this._intentStates=new Map,this.destroyed=!1,this.recordedBBoxes=null}get pageNumber(){return this._pageIndex+1}set pageNumber(t){this._pageIndex=t-1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:e=this.rotate,offsetX:i=0,offsetY:r=0,dontFlip:l=!1}={}){return new Kc({viewBox:this.view,userUnit:this.userUnit,scale:t,rotation:e,offsetX:i,offsetY:r,dontFlip:l})}getAnnotations({intent:t="display"}={}){const{renderingIntent:e}=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,e)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return ie(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,canvas:e=t.canvas,viewport:i,intent:r="display",annotationMode:l=Yr.ENABLE,transform:c=null,background:u=null,optionalContentConfigPromise:d=null,annotationCanvasMap:f=null,pageColors:p=null,printAnnotationStorage:y=null,isEditing:w=!1,recordOperations:A=!1,operationsFilter:_=null}){this._stats?.time("Overall");const S=this._transport.getRenderingIntent(r,l,y,w),{renderingIntent:C,cacheKey:M}=S;this.#t=!1,d||=this._transport.getOptionalContentConfig(C);let k=this._intentStates.get(M);k||(k=Object.create(null),this._intentStates.set(M,k)),k.streamReaderCancelTimeout&&(clearTimeout(k.streamReaderCancelTimeout),k.streamReaderCancelTimeout=null);const L=!!(C&Ei.PRINT);k.displayReadyCapability||(k.displayReadyCapability=Promise.withResolvers(),k.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(S));const j=!!(this._pdfBug&&globalThis.StepperManager?.enabled),F=!this.recordedBBoxes&&(A||j),z=ft=>{if(k.renderTasks.delete(H),F){const _t=H.gfx?.dependencyTracker.take();_t&&(H.stepper&&H.stepper.setOperatorBBoxes(_t,H.gfx.dependencyTracker.takeDebugMetadata()),A&&(this.recordedBBoxes=_t))}L&&(this.#t=!0),this.#i(),ft?(H.capability.reject(ft),this._abortOperatorList({intentState:k,reason:ft instanceof Error?ft:new Error(ft)})):H.capability.resolve(),this._stats&&(this._stats.timeEnd("Rendering"),this._stats.timeEnd("Overall"),globalThis.Stats?.enabled&&globalThis.Stats.add(this.pageNumber,this._stats))},H=new el({callback:z,params:{canvas:e,canvasContext:t,dependencyTracker:F?new dT(e,k.operatorList.length,j):null,viewport:i,transform:c,background:u},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:f,operatorList:k.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!L,pdfBug:this._pdfBug,pageColors:p,enableHWA:this._transport.enableHWA,operationsFilter:_});(k.renderTasks||=new Set).add(H);const ut=H.task;return Promise.all([k.displayReadyCapability.promise,d]).then(([ft,_t])=>{if(this.destroyed){z();return}if(this._stats?.time("Rendering"),!(_t.renderingIntent&C))throw new Error("Must use the same `intent`-argument when calling the `PDFPageProxy.render` and `PDFDocumentProxy.getOptionalContentConfig` methods.");H.initializeGraphics({transparency:ft,optionalContentConfig:_t}),H.operatorListChanged()}).catch(z),ut}getOperatorList({intent:t="display",annotationMode:e=Yr.ENABLE,printAnnotationStorage:i=null,isEditing:r=!1}={}){function l(){u.operatorList.lastChunk&&(u.opListReadCapability.resolve(u.operatorList),u.renderTasks.delete(d))}const c=this._transport.getRenderingIntent(t,e,i,r,!0);let u=this._intentStates.get(c.cacheKey);u||(u=Object.create(null),this._intentStates.set(c.cacheKey,u));let d;return u.opListReadCapability||(d=Object.create(null),d.operatorListChanged=l,u.opListReadCapability=Promise.withResolvers(),(u.renderTasks||=new Set).add(d),u.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(c)),u.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:e=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:e===!0},{highWaterMark:100,size(r){return r.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(i=>Bc.textContent(i));const e=this.streamTextContent(t);return new Promise(function(i,r){function l(){c.read().then(function({value:d,done:f}){if(f){i(u);return}u.lang??=d.lang,Object.assign(u.styles,d.styles),u.items.push(...d.items),l()},r)}const c=e.getReader(),u={items:[],styles:Object.create(null),lang:null};l()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const e of this._intentStates.values())if(this._abortOperatorList({intentState:e,reason:new Error("Page was destroyed."),force:!0}),!e.opListReadCapability)for(const i of e.renderTasks)t.push(i.completed),i.cancel();return this.objs.clear(),this.#t=!1,Promise.all(t)}cleanup(t=!1){this.#t=!0;const e=this.#i();return t&&e&&(this._stats&&=new Yv),e}#i(){if(!this.#t||this.destroyed)return!1;for(const{renderTasks:t,operatorList:e}of this._intentStates.values())if(t.size>0||!e.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}_startRenderPage(t,e){const i=this._intentStates.get(e);i&&(this._stats?.timeEnd("Page Request"),i.displayReadyCapability?.resolve(t))}_renderPageChunk(t,e){for(let i=0,r=t.length;i<r;i++)e.operatorList.fnArray.push(t.fnArray[i]),e.operatorList.argsArray.push(t.argsArray[i]);e.operatorList.lastChunk=t.lastChunk,e.operatorList.separateAnnots=t.separateAnnots;for(const i of e.renderTasks)i.operatorListChanged();t.lastChunk&&this.#i()}_pumpOperatorList({renderingIntent:t,cacheKey:e,annotationStorageSerializable:i,modifiedIds:r}){const{map:l,transfer:c}=i,d=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageId:this.#e.getPageId(this._pageIndex+1)-1,pageIndex:this._pageIndex,intent:t,cacheKey:e,annotationStorage:l,modifiedIds:r},c).getReader(),f=this._intentStates.get(e);f.streamReader=d;const p=()=>{d.read().then(({value:y,done:w})=>{if(w){f.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(y,f),p())},y=>{if(f.streamReader=null,!this._transport.destroyed){if(f.operatorList){f.operatorList.lastChunk=!0;for(const w of f.renderTasks)w.operatorListChanged();this.#i()}if(f.displayReadyCapability)f.displayReadyCapability.reject(y);else if(f.opListReadCapability)f.opListReadCapability.reject(y);else throw y}})};p()}_abortOperatorList({intentState:t,reason:e,force:i=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!i){if(t.renderTasks.size>0)return;if(e instanceof Nm){let r=$T;e.extraDelay>0&&e.extraDelay<1e3&&(r+=e.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:e,force:!0})},r);return}}if(t.streamReader.cancel(new Zr(e.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[r,l]of this._intentStates)if(l===t){this._intentStates.delete(r);break}this.cleanup()}}}get stats(){return this._stats}}var Qr,Zi,ar,Ha,Kh,qa,Ga,ei,Ph,Qw,Ww,Mc,al,Bh;const Xe=class Xe{constructor({name:t=null,port:e=null,verbosity:i=TC()}={}){bs(this,ei);bs(this,Qr,Promise.withResolvers());bs(this,Zi,null);bs(this,ar,null);bs(this,Ha,null);if(this.name=t,this.destroyed=!1,this.verbosity=i,e){if(Ke(Xe,Ga).has(e))throw new Error("Cannot use more than one PDFWorker per port.");Ke(Xe,Ga).set(e,this),vs(this,ei,Qw).call(this,e)}else vs(this,ei,Ww).call(this)}get promise(){return Ke(this,Qr).promise}get port(){return Ke(this,ar)}get messageHandler(){return Ke(this,Zi)}destroy(){this.destroyed=!0,Ke(this,Ha)?.terminate(),ci(this,Ha,null),Ke(Xe,Ga).delete(Ke(this,ar)),ci(this,ar,null),Ke(this,Zi)?.destroy(),ci(this,Zi,null)}static create(t){const e=Ke(this,Ga).get(t?.port);if(e){if(e._pendingDestroy)throw new Error("PDFWorker.create - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return e}return new Xe(t)}static get workerSrc(){if(rl.workerSrc)return rl.workerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _setupFakeWorkerGlobal(){return ie(this,"_setupFakeWorkerGlobal",(async()=>Ke(this,al,Bh)?Ke(this,al,Bh):(await import(this.workerSrc)).WorkerMessageHandler)())}};Qr=new WeakMap,Zi=new WeakMap,ar=new WeakMap,Ha=new WeakMap,Kh=new WeakMap,qa=new WeakMap,Ga=new WeakMap,ei=new WeakSet,Ph=function(){Ke(this,Qr).resolve(),Ke(this,Zi).send("configure",{verbosity:this.verbosity})},Qw=function(t){ci(this,ar,t),ci(this,Zi,new Rc("main","worker",t)),Ke(this,Zi).on("ready",()=>{}),vs(this,ei,Ph).call(this)},Ww=function(){if(Ke(Xe,qa)||Ke(Xe,al,Bh)){vs(this,ei,Mc).call(this);return}let{workerSrc:t}=Xe;try{Xe._isSameOrigin(window.location,t)||(t=Xe._createCDNWrapper(new URL(t,window.location).href));const e=new Worker(t,{type:"module"}),i=new Rc("main","worker",e),r=()=>{l.abort(),i.destroy(),e.terminate(),this.destroyed?Ke(this,Qr).reject(new Error("Worker was destroyed")):vs(this,ei,Mc).call(this)},l=new AbortController;e.addEventListener("error",()=>{Ke(this,Ha)||r()},{signal:l.signal}),i.on("test",u=>{if(l.abort(),this.destroyed||!u){r();return}ci(this,Zi,i),ci(this,ar,e),ci(this,Ha,e),vs(this,ei,Ph).call(this)}),i.on("ready",u=>{if(l.abort(),this.destroyed){r();return}try{c()}catch{vs(this,ei,Mc).call(this)}});const c=()=>{const u=new Uint8Array;i.send("test",u,[u.buffer])};c();return}catch{id("The worker has been disabled.")}vs(this,ei,Mc).call(this)},Mc=function(){Ke(Xe,qa)||(ne("Setting up fake worker."),ci(Xe,qa,!0)),Xe._setupFakeWorkerGlobal.then(t=>{if(this.destroyed){Ke(this,Qr).reject(new Error("Worker was destroyed"));return}const e=new iT;ci(this,ar,e);const i=`fake${Yb(Xe,Kh)._++}`,r=new Rc(i+"_worker",i,e);t.setup(r,e),ci(this,Zi,new Rc(i,i+"_worker",e)),vs(this,ei,Ph).call(this)}).catch(t=>{Ke(this,Qr).reject(new Error(`Setting up fake worker failed: "${t.message}".`))})},al=new WeakSet,Bh=function(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}},bs(Xe,al),bs(Xe,Kh,0),bs(Xe,qa,!1),bs(Xe,Ga,new WeakMap),Zn&&(ci(Xe,qa,!0),rl.workerSrc||="./pdf.worker.mjs"),Xe._isSameOrigin=(t,e)=>{const i=URL.parse(t);if(!i?.origin||i.origin==="null")return!1;const r=new URL(e,i);return i.origin===r.origin},Xe._createCDNWrapper=t=>{const e=`await import("${t}");`;return URL.createObjectURL(new Blob([e],{type:"text/javascript"}))},Xe.fromPort=t=>{if(IC("`PDFWorker.fromPort` - please use `PDFWorker.create` instead."),!t?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");return Xe.create(t)};let jc=Xe;class XT{downloadInfoCapability=Promise.withResolvers();#t=null;#e=new Map;#i=null;#n=new Map;#s=new Map;#a=new Map;#r=null;#o=Ce.instance;constructor(t,e,i,r,l){this.messageHandler=t,this.loadingTask=e,this.#i=i,this.commonObjs=new Kw,this.fontLoader=new QC({ownerDocument:r.ownerDocument,styleElement:r.styleElement}),this.enableHWA=r.enableHWA,this.loadingParams=r.loadingParams,this._params=r,this.canvasFactory=l.canvasFactory,this.filterFactory=l.filterFactory,this.cMapReaderFactory=l.cMapReaderFactory,this.standardFontDataFactory=l.standardFontDataFactory,this.wasmFactory=l.wasmFactory,this.destroyed=!1,this.destroyCapability=null,this.setupMessageHandler(),this.#o.addListener(this.#c.bind(this))}#c(){const t=new Map,e=new Map;for(let i=0,r=this.#o.pagesNumber;i<r;i++){const l=this.#o.getPrevPageNumber(i+1)-1,c=this.#n.get(l);c&&t.set(i,c);const u=this.#s.get(l);u&&e.set(i,u)}this.#n=t,this.#s=e}#l(t,e=null){const i=this.#e.get(t);if(i)return i;const r=this.messageHandler.sendWithPromise(t,e);return this.#e.set(t,r),r}#d({loaded:t,total:e}){this.loadingTask.onProgress?.({loaded:t,total:e,percent:Fn(Math.round(t/e*100),0,100)})}get annotationStorage(){return ie(this,"annotationStorage",new Bm)}getRenderingIntent(t,e=Yr.ENABLE,i=null,r=!1,l=!1){let c=Ei.DISPLAY,u=tm;switch(t){case"any":c=Ei.ANY;break;case"display":break;case"print":c=Ei.PRINT;break;default:ne(`getRenderingIntent - invalid intent: ${t}`)}const d=c&Ei.PRINT&&i instanceof Nw?i:this.annotationStorage;switch(e){case Yr.DISABLE:c+=Ei.ANNOTATIONS_DISABLE;break;case Yr.ENABLE:break;case Yr.ENABLE_FORMS:c+=Ei.ANNOTATIONS_FORMS;break;case Yr.ENABLE_STORAGE:c+=Ei.ANNOTATIONS_STORAGE,u=d.serializable;break;default:ne(`getRenderingIntent - invalid annotationMode: ${e}`)}r&&(c+=Ei.IS_EDITING),l&&(c+=Ei.OPLIST);const{ids:f,hash:p}=d.modifiedIds,y=[c,u.hash,p];return{renderingIntent:c,cacheKey:y.join("_"),annotationStorageSerializable:u,modifiedIds:f}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=Promise.withResolvers(),this.#r?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const i of this.#n.values())t.push(i._destroy());this.#n.clear(),this.#s.clear(),this.#a.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const e=this.messageHandler.sendWithPromise("Terminate",null);return t.push(e),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),_i.cleanup(),this.#i?.cancelAllRequests(new Zr("Worker was terminated.")),this.messageHandler?.destroy(),this.messageHandler=null,this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:e}=this;t.on("GetReader",(i,r)=>{Re(this.#i,"GetReader - no `BasePDFStream` instance available."),this.#t=this.#i.getFullReader(),this.#t.onProgress=l=>this.#d(l),r.onPull=()=>{this.#t.read().then(function({value:l,done:c}){if(c){r.close();return}Re(l instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(l),1,[l])}).catch(l=>{r.error(l)})},r.onCancel=l=>{this.#t.cancel(l),r.ready.catch(c=>{if(!this.destroyed)throw c})}}),t.on("ReaderHeadersReady",async i=>{await this.#t.headersReady;const{isStreamingSupported:r,isRangeSupported:l,contentLength:c}=this.#t;return r&&l&&(this.#t.onProgress=null),{isStreamingSupported:r,isRangeSupported:l,contentLength:c}}),t.on("GetRangeReader",(i,r)=>{Re(this.#i,"GetRangeReader - no `BasePDFStream` instance available.");const l=this.#i.getRangeReader(i.begin,i.end);if(!l){r.close();return}r.onPull=()=>{l.read().then(function({value:c,done:u}){if(u){r.close();return}Re(c instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),r.enqueue(new Uint8Array(c),1,[c])}).catch(c=>{r.error(c)})},r.onCancel=c=>{l.cancel(c),r.ready.catch(u=>{if(!this.destroyed)throw u})}}),t.on("GetDoc",({pdfInfo:i})=>{this.#o.pagesNumber=i.numPages,this._numPages=i.numPages,this._htmlForXfa=i.htmlForXfa,delete i.htmlForXfa,e._capability.resolve(new VT(i,this))}),t.on("DocException",i=>{e._capability.reject(ui(i))}),t.on("PasswordRequest",i=>{this.#r=Promise.withResolvers();try{if(!e.onPassword)throw ui(i);const r=l=>{l instanceof Error?this.#r.reject(l):this.#r.resolve({password:l})};e.onPassword(r,i.code)}catch(r){this.#r.reject(r)}return this.#r.promise}),t.on("DataLoaded",i=>{this.#d({loaded:i.length,total:i.length}),this.downloadInfoCapability.resolve(i)}),t.on("StartRenderPage",i=>{if(this.destroyed)return;this.#n.get(i.pageIndex)._startRenderPage(i.transparency,i.cacheKey)}),t.on("commonobj",([i,r,l])=>{if(this.destroyed||this.commonObjs.has(i))return null;switch(r){case"Font":if("error"in l){const y=l.error;ne(`Error during font loading: ${y}`),this.commonObjs.resolve(i,y);break}const c=new Fe(l),u=this._params.pdfBug&&globalThis.FontInspector?.enabled?(y,w)=>globalThis.FontInspector.fontAdded(y,w):null,d=new WC(c,u,l.extra,l.charProcOperatorList);this.fontLoader.bind(d).catch(()=>t.sendWithPromise("FontFallback",{id:i})).finally(()=>{!d.fontExtraProperties&&d.data&&d.clearData(),this.commonObjs.resolve(i,d)});break;case"CopyLocalImage":const{imageRef:f}=l;Re(f,"The imageRef must be defined.");for(const y of this.#n.values())for(const[,w]of y.objs)if(w?.ref===f)return w.dataLen?(this.commonObjs.resolve(i,structuredClone(w)),w.dataLen):null;break;case"FontPath":this.commonObjs.resolve(i,new ZC(l));break;case"Image":this.commonObjs.resolve(i,l);break;case"Pattern":const p=new Tn(l);this.commonObjs.resolve(i,p.getIR());break;default:throw new Error(`Got unknown common object type ${r}`)}return null}),t.on("obj",([i,r,l,c])=>{if(this.destroyed)return;const u=this.#n.get(r);if(!u.objs.has(i)){if(u._intentStates.size===0){c?.bitmap?.close();return}switch(l){case"Image":case"Pattern":u.objs.resolve(i,c);break;default:throw new Error(`Got unknown object type ${l}`)}}}),t.on("DocProgress",i=>{this.destroyed||this.#d(i)}),t.on("FetchBinaryData",async i=>{if(this.destroyed)throw new Error("Worker was destroyed.");const r=this[i.type];if(!r)throw new Error(`${i.type} not initialized, see the \`useWorkerFetch\` parameter.`);return r.fetch(i)})}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&ne("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfer:e}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this.#t?.filename??null},e).finally(()=>{this.annotationStorage.resetModified()})}extractPages(t){return this.messageHandler.sendWithPromise("ExtractPages",{pageInfos:t})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this.#o.pagesNumber)return Promise.reject(new Error("Invalid page request."));const e=t-1,i=this.#o.getPageId(t)-1,r=this.#s.get(e);if(r)return r;const l=this.messageHandler.sendWithPromise("GetPage",{pageIndex:i}).then(c=>{if(this.destroyed)throw new Error("Transport destroyed");c.refStr&&this.#a.set(c.refStr,i);const u=new KT(e,c,this,this._params.pdfBug);return this.#n.set(e,u),u});return this.#s.set(e,l),l}async getPageIndex(t){if(!em(t))throw new Error("Invalid pageIndex request.");const e=await this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen});return this.#o.getPageNumber(e+1)-1}getAnnotations(t,e){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:this.#o.getPageId(t+1)-1,intent:e})}getFieldObjects(){return this.#l("GetFieldObjects")}hasJSActions(){return this.#l("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getAnnotationsByType(t,e){return this.messageHandler.sendWithPromise("GetAnnotationsByType",{types:t,pageIndexesToSkip:e})}getDocJSActions(){return this.#l("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:this.#o.getPageId(t+1)-1})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:this.#o.getPageId(t+1)-1})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(t){return this.#l("GetOptionalContentConfig").then(e=>new TT(e,t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",e=this.#e.get(t);if(e)return e;const i=this.messageHandler.sendWithPromise(t,null).then(r=>({info:r[0],metadata:r[1]?new _T(r[1]):null,contentDispositionFilename:this.#t?.filename??null,contentLength:this.#t?.contentLength??null,hasStructTree:r[2]}));return this.#e.set(t,i),i}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const e of this.#n.values())if(!e.cleanup())throw new Error(`startCleanup: Page ${e.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0),_i.cleanup()}}cachedPageNumber(t){if(!em(t))return null;const e=t.gen===0?`${t.num}R`:`${t.num}R${t.gen}`,i=this.#a.get(e);return i>=0?this.#o.getPageNumber(i+1):null}}class YT{_internalRenderTask=null;onContinue=null;onError=null;constructor(t){this._internalRenderTask=t}get promise(){return this._internalRenderTask.capability.promise}cancel(t=0){this._internalRenderTask.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this._internalRenderTask.operatorList;if(!t)return!1;const{annotationCanvasMap:e}=this._internalRenderTask;return t.form||t.canvas&&e?.size>0}}class el{#t=null;static#e=new WeakSet;constructor({callback:t,params:e,objs:i,commonObjs:r,annotationCanvasMap:l,operatorList:c,pageIndex:u,canvasFactory:d,filterFactory:f,useRequestAnimationFrame:p=!1,pdfBug:y=!1,pageColors:w=null,enableHWA:A=!1,operationsFilter:_=null}){this.callback=t,this.params=e,this.objs=i,this.commonObjs=r,this.annotationCanvasMap=l,this.operatorListIdx=null,this.operatorList=c,this._pageIndex=u,this.canvasFactory=d,this.filterFactory=f,this._pdfBug=y,this.pageColors=w,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=p===!0&&typeof window<"u",this.cancelled=!1,this.capability=Promise.withResolvers(),this.task=new YT(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=e.canvas,this._canvasContext=e.canvas?null:e.canvasContext,this._enableHWA=A,this._dependencyTracker=e.dependencyTracker,this._operationsFilter=_}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:e}){if(this.cancelled)return;if(this._canvas){if(el.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");el.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{viewport:i,transform:r,background:l,dependencyTracker:c}=this.params,u=this._canvasContext||this._canvas.getContext("2d",{alpha:!1,willReadFrequently:!this._enableHWA});this.gfx=new sl(u,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:e},this.annotationCanvasMap,this.pageColors,c),this.gfx.beginDrawing({transform:r,viewport:i,transparency:t,background:l}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,e=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),this.#t&&(window.cancelAnimationFrame(this.#t),this.#t=null),el.#e.delete(this._canvas),t||=new Nm(`Rendering cancelled, page ${this._pageIndex+1}`,e),this.callback(t),this.task.onError?.(t)}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.gfx.dependencyTracker?.growOperationsCount(this.operatorList.fnArray.length),this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?this.#t=window.requestAnimationFrame(()=>{this.#t=null,this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper,this._operationsFilter),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),el.#e.delete(this._canvas),this.callback())))}}const QT="5.4.624",WT="384c6208b";let Zw=class As{#t=null;#e=null;#i;#n=null;#s=!1;#a=!1;#r=null;#o;#c=null;#l=null;static#d=null;static get _keyboardManager(){return ie(this,"_keyboardManager",new Yc([[["Escape","mac+Escape"],As.prototype._hideDropdownFromKeyboard],[[" ","mac+ "],As.prototype._colorSelectFromKeyboard],[["ArrowDown","ArrowRight","mac+ArrowDown","mac+ArrowRight"],As.prototype._moveToNext],[["ArrowUp","ArrowLeft","mac+ArrowUp","mac+ArrowLeft"],As.prototype._moveToPrevious],[["Home","mac+Home"],As.prototype._moveToBeginning],[["End","mac+End"],As.prototype._moveToEnd]]))}constructor({editor:t=null,uiManager:e=null}){t?(this.#a=!1,this.#r=t):this.#a=!0,this.#l=t?._uiManager||e,this.#o=this.#l._eventBus,this.#i=t?.color?.toUpperCase()||this.#l?.highlightColors.values().next().value||"#FFFF98",As.#d||=Object.freeze({blue:"pdfjs-editor-colorpicker-blue",green:"pdfjs-editor-colorpicker-green",pink:"pdfjs-editor-colorpicker-pink",red:"pdfjs-editor-colorpicker-red",yellow:"pdfjs-editor-colorpicker-yellow"})}renderButton(){const t=this.#t=document.createElement("button");t.className="colorPicker",t.tabIndex="0",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-button"),t.ariaHasPopup="true",this.#r&&(t.ariaControls=`${this.#r.id}_colorpicker_dropdown`);const e=this.#l._signal;t.addEventListener("click",this.#m.bind(this),{signal:e}),t.addEventListener("keydown",this.#g.bind(this),{signal:e});const i=this.#e=document.createElement("span");return i.className="swatch",i.ariaHidden="true",i.style.backgroundColor=this.#i,t.append(i),t}renderMainDropdown(){const t=this.#n=this.#h();return t.ariaOrientation="horizontal",t.ariaLabelledBy="highlightColorPickerLabel",t}#h(){const t=document.createElement("div"),e=this.#l._signal;t.addEventListener("contextmenu",$i,{signal:e}),t.className="dropdown",t.role="listbox",t.ariaMultiSelectable="false",t.ariaOrientation="vertical",t.setAttribute("data-l10n-id","pdfjs-editor-colorpicker-dropdown"),this.#r&&(t.id=`${this.#r.id}_colorpicker_dropdown`);for(const[i,r]of this.#l.highlightColors){const l=document.createElement("button");l.tabIndex="0",l.role="option",l.setAttribute("data-color",r),l.title=i,l.setAttribute("data-l10n-id",As.#d[i]);const c=document.createElement("span");l.append(c),c.className="swatch",c.style.backgroundColor=r,l.ariaSelected=r===this.#i,l.addEventListener("click",this.#f.bind(this,r),{signal:e}),t.append(l)}return t.addEventListener("keydown",this.#g.bind(this),{signal:e}),t}#f(t,e){e.stopPropagation(),this.#o.dispatch("switchannotationeditorparams",{source:this,type:be.HIGHLIGHT_COLOR,value:t}),this.updateColor(t)}_colorSelectFromKeyboard(t){if(t.target===this.#t){this.#m(t);return}const e=t.target.getAttribute("data-color");e&&this.#f(e,t)}_moveToNext(t){if(!this.#p){this.#m(t);return}if(t.target===this.#t){this.#n.firstElementChild?.focus();return}t.target.nextSibling?.focus()}_moveToPrevious(t){if(t.target===this.#n?.firstElementChild||t.target===this.#t){this.#p&&this._hideDropdownFromKeyboard();return}this.#p||this.#m(t),t.target.previousSibling?.focus()}_moveToBeginning(t){if(!this.#p){this.#m(t);return}this.#n.firstElementChild?.focus()}_moveToEnd(t){if(!this.#p){this.#m(t);return}this.#n.lastElementChild?.focus()}#g(t){As._keyboardManager.exec(this,t)}#m(t){if(this.#p){this.hideDropdown();return}if(this.#s=t.detail===0,this.#c||(this.#c=new AbortController,window.addEventListener("pointerdown",this.#u.bind(this),{signal:this.#l.combinedSignal(this.#c)})),this.#t.ariaExpanded="true",this.#n){this.#n.classList.remove("hidden");return}const e=this.#n=this.#h();this.#t.append(e)}#u(t){this.#n?.contains(t.target)||this.hideDropdown()}hideDropdown(){this.#n?.classList.add("hidden"),this.#t.ariaExpanded="false",this.#c?.abort(),this.#c=null}get#p(){return this.#n&&!this.#n.classList.contains("hidden")}_hideDropdownFromKeyboard(){if(!this.#a){if(!this.#p){this.#r?.unselect();return}this.hideDropdown(),this.#t.focus({preventScroll:!0,focusVisible:this.#s})}}updateColor(t){if(this.#e&&(this.#e.style.backgroundColor=t),!this.#n)return;const e=this.#l.highlightColors.values();for(const i of this.#n.children)i.ariaSelected=e.next().value===t.toUpperCase()}destroy(){this.#t?.remove(),this.#t=null,this.#e=null,this.#n?.remove(),this.#n=null}};class Fc{#t=null;#e=null;#i=null;static#n=null;constructor(t){this.#e=t,this.#i=t._uiManager,Fc.#n||=Object.freeze({freetext:"pdfjs-editor-color-picker-free-text-input",ink:"pdfjs-editor-color-picker-ink-input"})}renderButton(){if(this.#t)return this.#t;const{editorType:t,colorType:e,color:i}=this.#e,r=this.#t=document.createElement("input");return r.type="color",r.value=i||"#000000",r.className="basicColorPicker",r.tabIndex=0,r.setAttribute("data-l10n-id",Fc.#n[t]),r.addEventListener("input",()=>{this.#i.updateParams(e,r.value)},{signal:this.#i._signal}),r}update(t){this.#t&&(this.#t.value=t)}destroy(){this.#t?.remove(),this.#t=null}hideDropdown(){}}function v0(a){return Math.floor(Math.max(0,Math.min(1,a))*255).toString(16).padStart(2,"0")}function _c(a){return Math.max(0,Math.min(255,255*a))}class w0{static CMYK_G([t,e,i,r]){return["G",1-Math.min(1,.3*t+.59*i+.11*e+r)]}static G_CMYK([t]){return["CMYK",0,0,0,1-t]}static G_RGB([t]){return["RGB",t,t,t]}static G_rgb([t]){return t=_c(t),[t,t,t]}static G_HTML([t]){const e=v0(t);return`#${e}${e}${e}`}static RGB_G([t,e,i]){return["G",.3*t+.59*e+.11*i]}static RGB_rgb(t){return t.map(_c)}static RGB_HTML(t){return`#${t.map(v0).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([t,e,i,r]){return["RGB",1-Math.min(1,t+r),1-Math.min(1,i+r),1-Math.min(1,e+r)]}static CMYK_rgb([t,e,i,r]){return[_c(1-Math.min(1,t+r)),_c(1-Math.min(1,i+r)),_c(1-Math.min(1,e+r))]}static CMYK_HTML(t){const e=this.CMYK_RGB(t).slice(1);return this.RGB_HTML(e)}static RGB_CMYK([t,e,i]){const r=1-t,l=1-e,c=1-i,u=Math.min(r,l,c);return["CMYK",r,l,c,u]}}class ZT{create(t,e,i=!1){if(t<=0||e<=0)throw new Error("Invalid SVG dimensions");const r=this._createSVG("svg:svg");return r.setAttribute("version","1.1"),i||(r.setAttribute("width",`${t}px`),r.setAttribute("height",`${e}px`)),r.setAttribute("preserveAspectRatio","none"),r.setAttribute("viewBox",`0 0 ${t} ${e}`),r}createElement(t){if(typeof t!="string")throw new Error("Invalid SVG element type");return this._createSVG(t)}_createSVG(t){Me("Abstract method `_createSVG` called.")}}class Vh extends ZT{_createSVG(t){return document.createElementNS(sr,t)}}const JT=9,Wa=new WeakSet,t2=new Date().getTimezoneOffset()*60*1e3;class Rp{static create(t){switch(t.data.annotationType){case yn.LINK:return new zm(t);case yn.TEXT:return new n2(t);case yn.WIDGET:switch(t.data.fieldType){case"Tx":return new i2(t);case"Btn":return t.data.radioButton?new Jw(t):t.data.checkBox?new r2(t):new a2(t);case"Ch":return new o2(t);case"Sig":return new s2(t)}return new Ja(t);case yn.POPUP:return new sm(t);case yn.FREETEXT:return new t1(t);case yn.LINE:return new c2(t);case yn.SQUARE:return new u2(t);case yn.CIRCLE:return new h2(t);case yn.POLYLINE:return new e1(t);case yn.CARET:return new f2(t);case yn.INK:return new Hm(t);case yn.POLYGON:return new d2(t);case yn.HIGHLIGHT:return new n1(t);case yn.UNDERLINE:return new p2(t);case yn.SQUIGGLY:return new m2(t);case yn.STRIKEOUT:return new g2(t);case yn.STAMP:return new i1(t);case yn.FILEATTACHMENT:return new y2(t);default:return new We(t)}}}class We{#t=null;#e=!1;#i=null;constructor(t,{isRenderable:e=!1,ignoreBorder:i=!1,createQuadrilaterals:r=!1}={}){this.isRenderable=e,this.data=t.data,this.layer=t.layer,this.linkService=t.linkService,this.downloadManager=t.downloadManager,this.imageResourcesPath=t.imageResourcesPath,this.renderForms=t.renderForms,this.svgFactory=t.svgFactory,this.annotationStorage=t.annotationStorage,this.enableComment=t.enableComment,this.enableScripting=t.enableScripting,this.hasJSActions=t.hasJSActions,this._fieldObjects=t.fieldObjects,this.parent=t.parent,this.hasOwnCommentButton=!1,e&&(this.contentElement=this.container=this._createContainer(i)),r&&this._createQuadrilaterals()}static _hasPopupData({contentsObj:t,richText:e}){return!!(t?.str||e?.str)}get _isEditable(){return this.data.isEditable}get hasPopupData(){return We._hasPopupData(this.data)||this.enableComment&&!!this.commentText}get commentData(){const{data:t}=this,e=this.annotationStorage?.getEditor(t.id);return e?e.getData():t}get hasCommentButton(){return this.enableComment&&this.hasPopupElement}get commentButtonPosition(){const t=this.annotationStorage?.getEditor(this.data.id);if(t)return t.commentButtonPositionInPage;const{quadPoints:e,inkLists:i,rect:r}=this.data;let l=-1/0,c=-1/0;if(e?.length>=8){for(let u=0;u<e.length;u+=8)e[u+1]>c?(c=e[u+1],l=e[u+2]):e[u+1]===c&&(l=Math.max(l,e[u+2]));return[l,c]}if(i?.length>=1){for(const u of i)for(let d=0,f=u.length;d<f;d+=2)u[d+1]>c?(c=u[d+1],l=u[d]):u[d+1]===c&&(l=Math.max(l,u[d]));if(l!==1/0)return[l,c]}return r?[r[2],r[3]]:null}_normalizePoint(t){const{page:{view:e},viewport:{rawDims:{pageWidth:i,pageHeight:r,pageX:l,pageY:c}}}=this.parent;return t[1]=e[3]-t[1]+e[1],t[0]=100*(t[0]-l)/i,t[1]=100*(t[1]-c)/r,t}get commentText(){const{data:t}=this;return this.annotationStorage.getRawValue(`${Lc}${t.id}`)?.popup?.contents||t.contentsObj?.str||""}set commentText(t){const{data:e}=this,i={deleted:!t,contents:t||""};this.annotationStorage.updateEditor(e.id,{popup:i})||this.annotationStorage.setValue(`${Lc}${e.id}`,{id:e.id,annotationType:e.annotationType,page:this.parent.page,popup:i,popupRef:e.popupRef,modificationDate:new Date}),t||this.removePopup()}removePopup(){(this.#i?.popup||this.popup)?.remove(),this.#i=this.popup=null}updateEdited(t){if(!this.container)return;t.rect&&(this.#t||={rect:this.data.rect.slice(0)});const{rect:e,popup:i}=t;e&&this.#n(e);let r=this.#i?.popup||this.popup;!r&&i?.text&&(this._createPopup(i),r=this.#i.popup),r&&(r.updateEdited(t),i?.deleted&&(r.remove(),this.#i=null,this.popup=null))}resetEdited(){this.#t&&(this.#n(this.#t.rect),this.#i?.popup.resetEdited(),this.#t=null)}#n(t){const{container:{style:e},data:{rect:i,rotation:r},parent:{viewport:{rawDims:{pageWidth:l,pageHeight:c,pageX:u,pageY:d}}}}=this;i?.splice(0,4,...t),e.left=`${100*(t[0]-u)/l}%`,e.top=`${100*(c-t[3]+d)/c}%`,r===0?(e.width=`${100*(t[2]-t[0])/l}%`,e.height=`${100*(t[3]-t[1])/c}%`):this.setRotation(r)}_createContainer(t){const{data:e,parent:{page:i,viewport:r}}=this,l=document.createElement("section");l.setAttribute("data-annotation-id",e.id),!(this instanceof Ja)&&!(this instanceof zm)&&(l.tabIndex=0);const{style:c}=l;if(c.zIndex=this.parent.zIndex,this.parent.zIndex+=2,e.alternativeText&&(l.title=e.alternativeText),e.noRotate&&l.classList.add("norotate"),!e.rect||this instanceof sm){const{rotation:S}=e;return!e.hasOwnCanvas&&S!==0&&this.setRotation(S,l),l}const{width:u,height:d}=this;if(!t&&e.borderStyle.width>0){c.borderWidth=`${e.borderStyle.width}px`;const S=e.borderStyle.horizontalCornerRadius,C=e.borderStyle.verticalCornerRadius;if(S>0||C>0){const k=`calc(${S}px * var(--total-scale-factor)) / calc(${C}px * var(--total-scale-factor))`;c.borderRadius=k}else if(this instanceof Jw){const k=`calc(${u}px * var(--total-scale-factor)) / calc(${d}px * var(--total-scale-factor))`;c.borderRadius=k}switch(e.borderStyle.style){case Qo.SOLID:c.borderStyle="solid";break;case Qo.DASHED:c.borderStyle="dashed";break;case Qo.BEVELED:ne("Unimplemented border style: beveled");break;case Qo.INSET:ne("Unimplemented border style: inset");break;case Qo.UNDERLINE:c.borderBottomStyle="solid";break}const M=e.borderColor||null;M?(this.#e=!0,c.borderColor=qt.makeHexColor(M[0]|0,M[1]|0,M[2]|0)):c.borderWidth=0}const f=qt.normalizeRect([e.rect[0],i.view[3]-e.rect[1]+i.view[1],e.rect[2],i.view[3]-e.rect[3]+i.view[1]]),{pageWidth:p,pageHeight:y,pageX:w,pageY:A}=r.rawDims;c.left=`${100*(f[0]-w)/p}%`,c.top=`${100*(f[1]-A)/y}%`;const{rotation:_}=e;return e.hasOwnCanvas||_===0?(c.width=`${100*u/p}%`,c.height=`${100*d/y}%`):this.setRotation(_,l),l}setRotation(t,e=this.container){if(!this.data.rect)return;const{pageWidth:i,pageHeight:r}=this.parent.viewport.rawDims;let{width:l,height:c}=this;t%180!==0&&([l,c]=[c,l]),e.style.width=`${100*l/i}%`,e.style.height=`${100*c/r}%`,e.setAttribute("data-main-rotation",(360-t)%360)}get _commonActions(){const t=(e,i,r)=>{const l=r.detail[e],c=l[0],u=l.slice(1);r.target.style[i]=w0[`${c}_HTML`](u),this.annotationStorage.setValue(this.data.id,{[i]:w0[`${c}_rgb`](u)})};return ie(this,"_commonActions",{display:e=>{const{display:i}=e.detail,r=i%2===1;this.container.style.visibility=r?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:r,noPrint:i===1||i===2})},print:e=>{this.annotationStorage.setValue(this.data.id,{noPrint:!e.detail.print})},hidden:e=>{const{hidden:i}=e.detail;this.container.style.visibility=i?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:i,noView:i})},focus:e=>{setTimeout(()=>e.target.focus({preventScroll:!1}),0)},userName:e=>{e.target.title=e.detail.userName},readonly:e=>{e.target.disabled=e.detail.readonly},required:e=>{this._setRequired(e.target,e.detail.required)},bgColor:e=>{t("bgColor","backgroundColor",e)},fillColor:e=>{t("fillColor","backgroundColor",e)},fgColor:e=>{t("fgColor","color",e)},textColor:e=>{t("textColor","color",e)},borderColor:e=>{t("borderColor","borderColor",e)},strokeColor:e=>{t("strokeColor","borderColor",e)},rotation:e=>{const i=e.detail.rotation;this.setRotation(i),this.annotationStorage.setValue(this.data.id,{rotation:i})}})}_dispatchEventFromSandbox(t,e){const i=this._commonActions;for(const r of Object.keys(e.detail))(t[r]||i[r])?.(e)}_setDefaultPropertiesFromJS(t){if(!this.enableScripting)return;const e=this.annotationStorage.getRawValue(this.data.id);if(!e)return;const i=this._commonActions;for(const[r,l]of Object.entries(e)){const c=i[r];if(c){const u={detail:{[r]:l},target:t};c(u),delete e[r]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:t}=this.data;if(!t)return;const[e,i,r,l]=this.data.rect.map(S=>Math.fround(S));if(t.length===8){const[S,C,M,k]=t.subarray(2,6);if(r===S&&l===C&&e===M&&i===k)return}const{style:c}=this.container;let u;if(this.#e){const{borderColor:S,borderWidth:C}=c;c.borderWidth=0,u=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${S}" stroke-width="${C}">`],this.container.classList.add("hasBorder")}const d=r-e,f=l-i,{svgFactory:p}=this,y=p.createElement("svg");y.classList.add("quadrilateralsContainer"),y.setAttribute("width",0),y.setAttribute("height",0),y.role="none";const w=p.createElement("defs");y.append(w);const A=p.createElement("clipPath"),_=`clippath_${this.data.id}`;A.setAttribute("id",_),A.setAttribute("clipPathUnits","objectBoundingBox"),w.append(A);for(let S=2,C=t.length;S<C;S+=8){const M=t[S],k=t[S+1],L=t[S+2],j=t[S+3],F=p.createElement("rect"),z=(L-e)/d,H=(l-k)/f,ut=(M-L)/d,ft=(k-j)/f;F.setAttribute("x",z),F.setAttribute("y",H),F.setAttribute("width",ut),F.setAttribute("height",ft),A.append(F),u?.push(`<rect vector-effect="non-scaling-stroke" x="${z}" y="${H}" width="${ut}" height="${ft}"/>`)}this.#e&&(u.push("</g></svg>')"),c.backgroundImage=u.join("")),this.container.append(y),this.container.style.clipPath=`url(#${_})`}_createPopup(t=null){const{data:e}=this;let i,r;t?(i={str:t.text},r=t.date):(i=e.contentsObj,r=e.modificationDate),this.#i=new sm({data:{color:e.color,titleObj:e.titleObj,modificationDate:r,contentsObj:i,richText:e.richText,parentRect:e.rect,borderStyle:0,id:`popup_${e.id}`,rotation:e.rotation,noRotate:!0},linkService:this.linkService,parent:this.parent,elements:[this]})}get hasPopupElement(){return!!(this.#i||this.popup||this.data.popupRef)}get extraPopupElement(){return this.#i}render(){Me("Abstract method `AnnotationElement.render` called")}_getElementsByName(t,e=null){const i=[];if(this._fieldObjects){const r=this._fieldObjects[t];if(r)for(const{page:l,id:c,exportValues:u}of r){if(l===-1||c===e)continue;const d=typeof u=="string"?u:null,f=document.querySelector(`[data-element-id="${c}"]`);if(f&&!Wa.has(f)){ne(`_getElementsByName - element not allowed: ${c}`);continue}i.push({id:c,exportValue:d,domElement:f})}return i}for(const r of document.getElementsByName(t)){const{exportValue:l}=r,c=r.getAttribute("data-element-id");c!==e&&Wa.has(r)&&i.push({id:c,exportValue:l,domElement:r})}return i}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const t=this.getElementsToTriggerPopup();if(Array.isArray(t))for(const e of t)e.classList.add("highlightArea");else t.classList.add("highlightArea")}_editOnDoubleClick(){if(!this._isEditable)return;const{annotationEditorType:t,data:{id:e}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:t,editId:e,mustEnterInEditMode:!0})})}get width(){return this.data.rect[2]-this.data.rect[0]}get height(){return this.data.rect[3]-this.data.rect[1]}}class e2 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.editor=t.editor}render(){return this.container.className="editorAnnotation",this.container}createOrUpdatePopup(){const{editor:t}=this;t.hasComment&&this._createPopup(t.comment)}get hasCommentButton(){return this.enableComment&&this.editor.hasComment}get commentButtonPosition(){return this.editor.commentButtonPositionInPage}get commentText(){return this.editor.comment.text}set commentText(t){this.editor.comment=t,t||this.removePopup()}get commentData(){return this.editor.getData()}remove(){this.parent.removeAnnotation(this.data.id),this.container.remove(),this.container=null,this.removePopup()}}class zm extends We{constructor(t,e=null){super(t,{isRenderable:!0,ignoreBorder:!!e?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=t.data.isTooltipOnly}render(){const{data:t,linkService:e}=this,i=document.createElement("a");i.setAttribute("data-element-id",t.id);let r=!1;return t.url?(e.addLinkAttributes(i,t.url,t.newWindow),r=!0):t.action?(this._bindNamedAction(i,t.action,t.overlaidText),r=!0):t.attachment?(this.#e(i,t.attachment,t.overlaidText,t.attachmentDest),r=!0):t.setOCGState?(this.#i(i,t.setOCGState,t.overlaidText),r=!0):t.dest?(this._bindLink(i,t.dest,t.overlaidText),r=!0):(t.actions&&(t.actions.Action||t.actions["Mouse Up"]||t.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(i,t),r=!0),t.resetForm?(this._bindResetFormAction(i,t.resetForm),r=!0):this.isTooltipOnly&&!r&&(this._bindLink(i,""),r=!0)),this.container.classList.add("linkAnnotation"),r&&(this.contentElement=i,this.container.append(i)),this.container}#t(){this.container.setAttribute("data-internal-link","")}_bindLink(t,e,i=""){t.href=this.linkService.getDestinationHash(e),t.onclick=()=>(e&&this.linkService.goToDestination(e),!1),(e||e==="")&&this.#t(),i&&(t.title=i)}_bindNamedAction(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeNamedAction(e),!1),i&&(t.title=i),this.#t()}#e(t,e,i="",r=null){t.href=this.linkService.getAnchorUrl(""),e.description?t.title=e.description:i&&(t.title=i),t.onclick=()=>(this.downloadManager?.openOrDownloadData(e.content,e.filename,r),!1),this.#t()}#i(t,e,i=""){t.href=this.linkService.getAnchorUrl(""),t.onclick=()=>(this.linkService.executeSetOCGState(e),!1),i&&(t.title=i),this.#t()}_bindJSAction(t,e){t.href=this.linkService.getAnchorUrl("");const i=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const r of Object.keys(e.actions)){const l=i.get(r);l&&(t[l]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e.id,name:r}}),!1))}e.overlaidText&&(t.title=e.overlaidText),t.onclick||(t.onclick=()=>!1),this.#t()}_bindResetFormAction(t,e){const i=t.onclick;if(i||(t.href=this.linkService.getAnchorUrl("")),this.#t(),!this._fieldObjects){ne('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),i||(t.onclick=()=>!1);return}t.onclick=()=>{i?.();const{fields:r,refs:l,include:c}=e,u=[];if(r.length!==0||l.length!==0){const p=new Set(l);for(const y of r){const w=this._fieldObjects[y]||[];for(const{id:A}of w)p.add(A)}for(const y of Object.values(this._fieldObjects))for(const w of y)p.has(w.id)===c&&u.push(w)}else for(const p of Object.values(this._fieldObjects))u.push(...p);const d=this.annotationStorage,f=[];for(const p of u){const{id:y}=p;switch(f.push(y),p.type){case"text":{const A=p.defaultValue||"";d.setValue(y,{value:A});break}case"checkbox":case"radiobutton":{const A=p.defaultValue===p.exportValues;d.setValue(y,{value:A});break}case"combobox":case"listbox":{const A=p.defaultValue||"";d.setValue(y,{value:A});break}default:continue}const w=document.querySelector(`[data-element-id="${y}"]`);if(w){if(!Wa.has(w)){ne(`_bindResetFormAction - element not allowed: ${y}`);continue}}else continue;w.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:f,name:"ResetForm"}}),!1}}}class n2 extends We{constructor(t){super(t,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const t=document.createElement("img");return t.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",t.setAttribute("data-l10n-id","pdfjs-text-annotation-type"),t.setAttribute("data-l10n-args",JSON.stringify({type:this.data.name})),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(t),this.container}}class Ja extends We{render(){return this.container}showElementAndHideCanvas(t){this.data.hasOwnCanvas&&(t.previousSibling?.nodeName==="CANVAS"&&(t.previousSibling.hidden=!0),t.hidden=!1)}_getKeyModifier(t){return xn.platform.isMac?t.metaKey:t.ctrlKey}_setEventListener(t,e,i,r,l){i.includes("mouse")?t.addEventListener(i,c=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c),shift:c.shiftKey,modifier:this._getKeyModifier(c)}})}):t.addEventListener(i,c=>{if(i==="blur"){if(!e.focused||!c.relatedTarget)return;e.focused=!1}else if(i==="focus"){if(e.focused)return;e.focused=!0}l&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:r,value:l(c)}})})}_setEventListeners(t,e,i,r){for(const[l,c]of i)(c==="Action"||this.data.actions?.[c])&&((c==="Focus"||c==="Blur")&&(e||={focused:!1}),this._setEventListener(t,e,l,c,r),c==="Focus"&&!this.data.actions?.Blur?this._setEventListener(t,e,"blur","Blur",null):c==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(t,e,"focus","Focus",null))}_setBackgroundColor(t){const e=this.data.backgroundColor||null;t.style.backgroundColor=e===null?"transparent":qt.makeHexColor(e[0],e[1],e[2])}_setTextStyle(t){const e=["left","center","right"],{fontColor:i}=this.data.defaultAppearanceData,r=this.data.defaultAppearanceData.fontSize||JT,l=t.style;let c;const u=2,d=f=>Math.round(10*f)/10;if(this.data.multiLine){const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u),p=Math.round(f/(xp*r))||1,y=f/p;c=Math.min(r,d(y/xp))}else{const f=Math.abs(this.data.rect[3]-this.data.rect[1]-u);c=Math.min(r,d(f/xp))}l.fontSize=`calc(${c}px * var(--total-scale-factor))`,l.color=qt.makeHexColor(i[0],i[1],i[2]),this.data.textAlignment!==null&&(l.textAlign=e[this.data.textAlignment])}_setRequired(t,e){e?t.setAttribute("required",!0):t.removeAttribute("required"),t.setAttribute("aria-required",e)}}class i2 extends Ja{constructor(t){const e=t.renderForms||t.data.hasOwnCanvas||!t.data.hasAppearance&&!!t.data.fieldValue;super(t,{isRenderable:e})}setPropertyOnSiblings(t,e,i,r){const l=this.annotationStorage;for(const c of this._getElementsByName(t.name,t.id))c.domElement&&(c.domElement[e]=i),l.setValue(c.id,{[r]:i})}render(){const t=this.annotationStorage,e=this.data.id;this.container.classList.add("textWidgetAnnotation");let i=null;if(this.renderForms){const r=t.getValue(e,{value:this.data.fieldValue});let l=r.value||"";const c=t.getValue(e,{charLimit:this.data.maxLen}).charLimit;c&&l.length>c&&(l=l.slice(0,c));let u=r.formattedValue||this.data.textContent?.join(`
`)||null;u&&this.data.comb&&(u=u.replaceAll(/\s+/g,""));const d={userValue:l,formattedValue:u,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(i=document.createElement("textarea"),i.textContent=u??l,this.data.doNotScroll&&(i.style.overflowY="hidden")):(i=document.createElement("input"),i.type=this.data.password?"password":"text",i.setAttribute("value",u??l),this.data.doNotScroll&&(i.style.overflowX="hidden")),this.data.hasOwnCanvas&&(i.hidden=!0),Wa.add(i),this.contentElement=i,i.setAttribute("data-element-id",e),i.disabled=this.data.readOnly,i.name=this.data.fieldName,i.tabIndex=0;const{datetimeFormat:f,datetimeType:p,timeStep:y}=this.data,w=!!p&&this.enableScripting;f&&(i.title=f),this._setRequired(i,this.data.required),c&&(i.maxLength=c),i.addEventListener("input",_=>{t.setValue(e,{value:_.target.value}),this.setPropertyOnSiblings(i,"value",_.target.value,"value"),d.formattedValue=null}),i.addEventListener("resetform",_=>{const S=this.data.defaultFieldValue??"";i.value=d.userValue=S,d.formattedValue=null});let A=_=>{const{formattedValue:S}=d;S!=null&&(_.target.value=S),_.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){i.addEventListener("focus",S=>{if(d.focused)return;const{target:C}=S;if(w&&(C.type=p,y&&(C.step=y)),d.userValue){const M=d.userValue;if(w)if(p==="time"){const k=new Date(M),L=[k.getHours(),k.getMinutes(),k.getSeconds()];C.value=L.map(j=>j.toString().padStart(2,"0")).join(":")}else C.value=new Date(M-t2).toISOString().split(p==="date"?"T":".",1)[0];else C.value=M}d.lastCommittedValue=C.value,d.commitKey=1,this.data.actions?.Focus||(d.focused=!0)}),i.addEventListener("updatefromsandbox",S=>{this.showElementAndHideCanvas(S.target);const C={value(M){d.userValue=M.detail.value??"",w||t.setValue(e,{value:d.userValue.toString()}),M.target.value=d.userValue},formattedValue(M){const{formattedValue:k}=M.detail;d.formattedValue=k,k!=null&&M.target!==document.activeElement&&(M.target.value=k);const L={formattedValue:k};w&&(L.value=k),t.setValue(e,L)},selRange(M){M.target.setSelectionRange(...M.detail.selRange)},charLimit:M=>{const{charLimit:k}=M.detail,{target:L}=M;if(k===0){L.removeAttribute("maxLength");return}L.setAttribute("maxLength",k);let j=d.userValue;!j||j.length<=k||(j=j.slice(0,k),L.value=d.userValue=j,t.setValue(e,{value:j}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:j,willCommit:!0,commitKey:1,selStart:L.selectionStart,selEnd:L.selectionEnd}}))}};this._dispatchEventFromSandbox(C,S)}),i.addEventListener("keydown",S=>{d.commitKey=1;let C=-1;if(S.key==="Escape"?C=0:S.key==="Enter"&&!this.data.multiLine?C=2:S.key==="Tab"&&(d.commitKey=3),C===-1)return;const{value:M}=S.target;d.lastCommittedValue!==M&&(d.lastCommittedValue=M,d.userValue=M,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,willCommit:!0,commitKey:C,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}))});const _=A;A=null,i.addEventListener("blur",S=>{if(!d.focused||!S.relatedTarget)return;this.data.actions?.Blur||(d.focused=!1);const{target:C}=S;let{value:M}=C;if(w){if(M&&p==="time"){const k=M.split(":").map(L=>parseInt(L,10));M=new Date(2e3,0,1,k[0],k[1],k[2]||0).valueOf(),C.step=""}else M.includes("T")||(M=`${M}T00:00`),M=new Date(M).valueOf();C.type="text"}d.userValue=M,d.lastCommittedValue!==M&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:M,willCommit:!0,commitKey:d.commitKey,selStart:S.target.selectionStart,selEnd:S.target.selectionEnd}}),_(S)}),this.data.actions?.Keystroke&&i.addEventListener("beforeinput",S=>{d.lastCommittedValue=null;const{data:C,target:M}=S,{value:k,selectionStart:L,selectionEnd:j}=M;let F=L,z=j;switch(S.inputType){case"deleteWordBackward":{const H=k.substring(0,L).match(/\w*[^\w]*$/);H&&(F-=H[0].length);break}case"deleteWordForward":{const H=k.substring(L).match(/^[^\w]*\w*/);H&&(z+=H[0].length);break}case"deleteContentBackward":L===j&&(F-=1);break;case"deleteContentForward":L===j&&(z+=1);break}S.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:k,change:C||"",willCommit:!1,selStart:F,selEnd:z}})}),this._setEventListeners(i,d,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],S=>S.target.value)}if(A&&i.addEventListener("blur",A),this.data.comb){const S=(this.data.rect[2]-this.data.rect[0])/c;i.classList.add("comb"),i.style.letterSpacing=`calc(${S}px * var(--total-scale-factor) - 1ch)`}}else i=document.createElement("div"),i.textContent=this.data.fieldValue,i.style.verticalAlign="middle",i.style.display="table-cell",this.data.hasOwnCanvas&&(i.hidden=!0);return this._setTextStyle(i),this._setBackgroundColor(i),this._setDefaultPropertiesFromJS(i),this.container.append(i),this.container}}class s2 extends Ja{constructor(t){super(t,{isRenderable:!!t.data.hasOwnCanvas})}}class r2 extends Ja{constructor(t){super(t,{isRenderable:t.renderForms})}render(){const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.exportValue===e.fieldValue}).value;typeof r=="string"&&(r=r!=="Off",t.setValue(i,{value:r})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const l=document.createElement("input");return Wa.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="checkbox",l.name=e.fieldName,r&&l.setAttribute("checked",!0),l.setAttribute("exportValue",e.exportValue),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i)){const p=d&&f.exportValue===e.exportValue;f.domElement&&(f.domElement.checked=p),t.setValue(f.id,{value:p})}t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue||"Off";c.target.checked=u===e.exportValue}),this.enableScripting&&this.hasJSActions&&(l.addEventListener("updatefromsandbox",c=>{const u={value(d){d.target.checked=d.detail.value!=="Off",t.setValue(i,{value:d.target.checked})}};this._dispatchEventFromSandbox(u,c)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],c=>c.target.checked)),this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class Jw extends Ja{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const t=this.annotationStorage,e=this.data,i=e.id;let r=t.getValue(i,{value:e.fieldValue===e.buttonValue}).value;if(typeof r=="string"&&(r=r!==e.buttonValue,t.setValue(i,{value:r})),r)for(const c of this._getElementsByName(e.fieldName,i))t.setValue(c.id,{value:!1});const l=document.createElement("input");if(Wa.add(l),l.setAttribute("data-element-id",i),l.disabled=e.readOnly,this._setRequired(l,this.data.required),l.type="radio",l.name=e.fieldName,r&&l.setAttribute("checked",!0),l.tabIndex=0,l.addEventListener("change",c=>{const{name:u,checked:d}=c.target;for(const f of this._getElementsByName(u,i))t.setValue(f.id,{value:!1});t.setValue(i,{value:d})}),l.addEventListener("resetform",c=>{const u=e.defaultFieldValue;c.target.checked=u!=null&&u===e.buttonValue}),this.enableScripting&&this.hasJSActions){const c=e.buttonValue;l.addEventListener("updatefromsandbox",u=>{const d={value:f=>{const p=c===f.detail.value;for(const y of this._getElementsByName(f.target.name)){const w=p&&y.id===i;y.domElement&&(y.domElement.checked=w),t.setValue(y.id,{value:w})}}};this._dispatchEventFromSandbox(d,u)}),this._setEventListeners(l,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],u=>u.target.checked)}return this._setBackgroundColor(l),this._setDefaultPropertiesFromJS(l),this.container.append(l),this.container}}class a2 extends zm{constructor(t){super(t,{ignoreBorder:t.data.hasAppearance})}render(){const t=super.render();t.classList.add("buttonWidgetAnnotation","pushButton");const e=t.lastChild;return this.enableScripting&&this.hasJSActions&&e&&(this._setDefaultPropertiesFromJS(e),e.addEventListener("updatefromsandbox",i=>{this._dispatchEventFromSandbox({},i)})),t}}class o2 extends Ja{constructor(t){super(t,{isRenderable:t.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const t=this.annotationStorage,e=this.data.id,i=t.getValue(e,{value:this.data.fieldValue}),r=document.createElement("select");Wa.add(r),r.setAttribute("data-element-id",e),r.disabled=this.data.readOnly,this._setRequired(r,this.data.required),r.name=this.data.fieldName,r.tabIndex=0;let l=this.data.combo&&this.data.options.length>0;this.data.combo||(r.size=this.data.options.length,this.data.multiSelect&&(r.multiple=!0)),r.addEventListener("resetform",p=>{const y=this.data.defaultFieldValue;for(const w of r.options)w.selected=w.value===y});for(const p of this.data.options){const y=document.createElement("option");y.textContent=p.displayValue,y.value=p.exportValue,i.value.includes(p.exportValue)&&(y.setAttribute("selected",!0),l=!1),r.append(y)}let c=null;if(l){const p=document.createElement("option");p.value=" ",p.setAttribute("hidden",!0),p.setAttribute("selected",!0),r.prepend(p),c=()=>{p.remove(),r.removeEventListener("input",c),c=null},r.addEventListener("input",c)}const u=p=>{const y=p?"value":"textContent",{options:w,multiple:A}=r;return A?Array.prototype.filter.call(w,_=>_.selected).map(_=>_[y]):w.selectedIndex===-1?null:w[w.selectedIndex][y]};let d=u(!1);const f=p=>{const y=p.target.options;return Array.prototype.map.call(y,w=>({displayValue:w.textContent,exportValue:w.value}))};return this.enableScripting&&this.hasJSActions?(r.addEventListener("updatefromsandbox",p=>{const y={value(w){c?.();const A=w.detail.value,_=new Set(Array.isArray(A)?A:[A]);for(const S of r.options)S.selected=_.has(S.value);t.setValue(e,{value:u(!0)}),d=u(!1)},multipleSelection(w){r.multiple=!0},remove(w){const A=r.options,_=w.detail.remove;A[_].selected=!1,r.remove(_),A.length>0&&Array.prototype.findIndex.call(A,C=>C.selected)===-1&&(A[0].selected=!0),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},clear(w){for(;r.length!==0;)r.remove(0);t.setValue(e,{value:null,items:[]}),d=u(!1)},insert(w){const{index:A,displayValue:_,exportValue:S}=w.detail.insert,C=r.children[A],M=document.createElement("option");M.textContent=_,M.value=S,C?C.before(M):r.append(M),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},items(w){const{items:A}=w.detail;for(;r.length!==0;)r.remove(0);for(const _ of A){const{displayValue:S,exportValue:C}=_,M=document.createElement("option");M.textContent=S,M.value=C,r.append(M)}r.options.length>0&&(r.options[0].selected=!0),t.setValue(e,{value:u(!0),items:f(w)}),d=u(!1)},indices(w){const A=new Set(w.detail.indices);for(const _ of w.target.options)_.selected=A.has(_.index);t.setValue(e,{value:u(!0)}),d=u(!1)},editable(w){w.target.disabled=!w.detail.editable}};this._dispatchEventFromSandbox(y,p)}),r.addEventListener("input",p=>{const y=u(!0),w=u(!1);t.setValue(e,{value:y}),p.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:e,name:"Keystroke",value:d,change:w,changeEx:y,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(r,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],p=>p.target.value)):r.addEventListener("input",function(p){t.setValue(e,{value:u(!0)})}),this.data.combo&&this._setTextStyle(r),this._setBackgroundColor(r),this._setDefaultPropertiesFromJS(r),this.container.append(r),this.container}}class sm extends We{constructor(t){const{data:e,elements:i,parent:r}=t,l=!!r._commentManager;if(super(t,{isRenderable:!l&&We._hasPopupData(e)}),this.elements=i,l&&We._hasPopupData(e)){const c=this.popup=this.#t();for(const u of i)u.popup=c}else this.popup=null}#t(){return new l2({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate||this.data.creationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open,commentManager:this.parent._commentManager})}render(){const{container:t}=this;t.classList.add("popupAnnotation"),t.role="comment";const e=this.popup=this.#t(),i=[];for(const r of this.elements)r.popup=e,r.container.ariaHasPopup="dialog",i.push(r.data.id),r.addHighlightArea();return this.container.setAttribute("aria-controls",i.map(r=>`${Jo}${r}`).join(",")),this.container}}class l2{#t=null;#e=this.#G.bind(this);#i=this.#I.bind(this);#n=this.#k.bind(this);#s=this.#A.bind(this);#a=null;#r=null;#o=null;#c=null;#l=null;#d=null;#h=null;#f=!1;#g=null;#m=null;#u=null;#p=null;#y=null;#v=null;#b=null;#E=null;#S=null;#w=null;#C=!1;#x=null;#_=null;constructor({container:t,color:e,elements:i,titleObj:r,modificationDate:l,contentsObj:c,richText:u,parent:d,rect:f,parentRect:p,open:y,commentManager:w=null}){this.#r=t,this.#S=r,this.#o=c,this.#E=u,this.#d=d,this.#a=e,this.#b=f,this.#h=p,this.#l=i,this.#t=w,this.#x=i[0],this.#c=Wp.toDateObject(l),this.trigger=i.flatMap(A=>A.getElementsToTriggerPopup()),w||(this.#D(),this.#r.hidden=!0,y&&this.#A())}#D(){if(this.#m)return;this.#m=new AbortController;const{signal:t}=this.#m;for(const e of this.trigger)e.addEventListener("click",this.#s,{signal:t}),e.addEventListener("pointerenter",this.#n,{signal:t}),e.addEventListener("pointerleave",this.#i,{signal:t}),e.classList.add("popupTriggerArea");for(const e of this.#l)e.container?.addEventListener("keydown",this.#e,{signal:t})}#R(){const t=this.#l.find(e=>e.hasCommentButton);t&&(this.#y=t._normalizePoint(t.commentButtonPosition))}renderCommentButton(){if(this.#p){this.#p.parentNode||this.#x.container.after(this.#p);return}if(this.#y||this.#R(),!this.#y)return;const{signal:t}=this.#m=new AbortController,e=this.#x.hasOwnCommentButton,i=()=>{this.#t.toggleCommentPopup(this,!0,void 0,!e)},r=()=>{this.#t.toggleCommentPopup(this,!1,!0,!e)},l=()=>{this.#t.toggleCommentPopup(this,!1,!1)};if(e){this.#p=this.#x.container;for(const c of this.trigger)c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),c.classList.add("popupTriggerArea")}else{const c=this.#p=document.createElement("button");c.className="annotationCommentButton";const u=this.#x.container;c.style.zIndex=u.style.zIndex+1,c.tabIndex=0,c.ariaHasPopup="dialog",c.ariaControls="commentPopup",c.setAttribute("data-l10n-id","pdfjs-show-comment-button"),this.#j(),this.#M(),c.addEventListener("keydown",this.#e,{signal:t}),c.addEventListener("click",i,{signal:t}),c.addEventListener("pointerenter",r,{signal:t}),c.addEventListener("pointerleave",l,{signal:t}),u.after(c)}}#M(){if(this.#x.extraPopupElement&&!this.#x.editor)return;this.#p||this.renderCommentButton();const[t,e]=this.#y,{style:i}=this.#p;i.left=`calc(${t}%)`,i.top=`calc(${e}% - var(--comment-button-dim))`}#j(){this.#x.extraPopupElement||(this.#p||this.renderCommentButton(),this.#p.style.backgroundColor=this.commentButtonColor||"")}get commentButtonColor(){const{color:t,opacity:e}=this.#x.commentData;return t?this.#d._commentManager.makeCommentColor(t,e):null}focusCommentButton(){setTimeout(()=>{this.#p?.focus()},0)}getData(){const{richText:t,color:e,opacity:i,creationDate:r,modificationDate:l}=this.#x.commentData;return{contentsObj:{str:this.comment},richText:t,color:e,opacity:i,creationDate:r,modificationDate:l}}get elementBeforePopup(){return this.#p}get comment(){return this.#_||=this.#x.commentText,this.#_}set comment(t){t!==this.comment&&(this.#x.commentText=this.#_=t)}focus(){this.#x.container?.focus()}get parentBoundingClientRect(){return this.#x.layer.getBoundingClientRect()}setCommentButtonStates({selected:t,hasPopup:e}){this.#p&&(this.#p.classList.toggle("selected",t),this.#p.ariaExpanded=e)}setSelectedCommentButton(t){this.#p.classList.toggle("selected",t)}get commentPopupPosition(){if(this.#v)return this.#v;const{x:t,y:e,height:i}=this.#p.getBoundingClientRect(),{x:r,y:l,width:c,height:u}=this.#x.layer.getBoundingClientRect();return[(t-r)/c,(e+i-l)/u]}set commentPopupPosition(t){this.#v=t}hasDefaultPopupPosition(){return this.#v===null}get commentButtonPosition(){return this.#y}get commentButtonWidth(){return this.#p.getBoundingClientRect().width/this.parentBoundingClientRect.width}editComment(t){const[e,i]=this.#v||this.commentButtonPosition.map(f=>f/100),r=this.parentBoundingClientRect,{x:l,y:c,width:u,height:d}=r;this.#t.showDialog(null,this,l+e*u,c+i*d,{...t,parentDimensions:r})}render(){if(this.#g)return;const t=this.#g=document.createElement("div");if(t.className="popup",this.#a){const i=t.style.outlineColor=qt.makeHexColor(...this.#a);t.style.backgroundColor=`color-mix(in srgb, ${i} 30%, white)`}const e=document.createElement("span");if(e.className="header",this.#S?.str){const i=document.createElement("span");i.className="title",e.append(i),{dir:i.dir,str:i.textContent}=this.#S}if(t.append(e),this.#c){const i=document.createElement("time");i.className="popupDate",i.setAttribute("data-l10n-id","pdfjs-annotation-date-time-string"),i.setAttribute("data-l10n-args",JSON.stringify({dateObj:this.#c.valueOf()})),i.dateTime=this.#c.toISOString(),e.append(i)}Rw({html:this.#N||this.#o.str,dir:this.#o?.dir,className:"popupContent"},t),this.#r.append(t)}get#N(){const t=this.#E,e=this.#o;return t?.str&&(!e?.str||e.str===t.str)&&this.#E.html||null}get#L(){return this.#N?.attributes?.style?.fontSize||0}get#F(){return this.#N?.attributes?.style?.color||null}#P(t){const e=[],i={str:t,html:{name:"div",attributes:{dir:"auto"},children:[{name:"p",children:e}]}},r={style:{color:this.#F,fontSize:this.#L?`calc(${this.#L}px * var(--total-scale-factor))`:""}};for(const l of t.split(`
`))e.push({name:"span",value:l,attributes:r});return i}#G(t){t.altKey||t.shiftKey||t.ctrlKey||t.metaKey||(t.key==="Enter"||t.key==="Escape"&&this.#f)&&this.#A()}updateEdited({rect:t,popup:e,deleted:i}){if(this.#t){i?(this.remove(),this.#_=null):e&&(e.deleted?this.remove():(this.#j(),this.#_=e.text)),t&&(this.#y=null,this.#R(),this.#M());return}if(i||e?.deleted){this.remove();return}this.#D(),this.#w||={contentsObj:this.#o,richText:this.#E},t&&(this.#u=null),e&&e.text&&(this.#E=this.#P(e.text),this.#c=Wp.toDateObject(e.date),this.#o=null),this.#g?.remove(),this.#g=null}resetEdited(){this.#w&&({contentsObj:this.#o,richText:this.#E}=this.#w,this.#w=null,this.#g?.remove(),this.#g=null,this.#u=null)}remove(){if(this.#m?.abort(),this.#m=null,this.#g?.remove(),this.#g=null,this.#C=!1,this.#f=!1,this.#p?.remove(),this.#p=null,this.trigger)for(const t of this.trigger)t.classList.remove("popupTriggerArea")}#T(){if(this.#u!==null)return;const{page:{view:t},viewport:{rawDims:{pageWidth:e,pageHeight:i,pageX:r,pageY:l}}}=this.#d;let c=!!this.#h,u=c?this.#h:this.#b;for(const _ of this.#l)if(!u||qt.intersect(_.data.rect,u)!==null){u=_.data.rect,c=!0;break}const d=qt.normalizeRect([u[0],t[3]-u[1]+t[1],u[2],t[3]-u[3]+t[1]]),p=c?u[2]-u[0]+5:0,y=d[0]+p,w=d[1];this.#u=[100*(y-r)/e,100*(w-l)/i];const{style:A}=this.#r;A.left=`${this.#u[0]}%`,A.top=`${this.#u[1]}%`}#A(){if(this.#t){this.#t.toggleCommentPopup(this,!1);return}this.#f=!this.#f,this.#f?(this.#k(),this.#r.addEventListener("click",this.#s),this.#r.addEventListener("keydown",this.#e)):(this.#I(),this.#r.removeEventListener("click",this.#s),this.#r.removeEventListener("keydown",this.#e))}#k(){this.#g||this.render(),this.isVisible?this.#f&&this.#r.classList.add("focused"):(this.#T(),this.#r.hidden=!1,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)+1e3)}#I(){this.#r.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#r.hidden=!0,this.#r.style.zIndex=parseInt(this.#r.style.zIndex)-1e3)}forceHide(){this.#C=this.isVisible,this.#C&&(this.#r.hidden=!0)}maybeShow(){this.#t||(this.#D(),this.#C&&(this.#g||this.#k(),this.#C=!1,this.#r.hidden=!1))}get isVisible(){return this.#t?!1:this.#r.hidden===!1}}class t1 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.textContent=t.data.textContent,this.textPosition=t.data.textPosition,this.annotationEditorType=ae.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const t=this.contentElement=document.createElement("div");t.classList.add("annotationTextContent"),t.setAttribute("role","comment");for(const e of this.textContent){const i=document.createElement("span");i.textContent=e,t.append(i)}this.container.append(t)}return!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class c2 extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),l=this.#t=this.svgFactory.createElement("svg:line");return l.setAttribute("x1",t.rect[2]-t.lineCoordinates[0]),l.setAttribute("y1",t.rect[3]-t.lineCoordinates[1]),l.setAttribute("x2",t.rect[2]-t.lineCoordinates[2]),l.setAttribute("y2",t.rect[3]-t.lineCoordinates[3]),l.setAttribute("stroke-width",t.borderStyle.width||1),l.setAttribute("stroke","transparent"),l.setAttribute("fill","transparent"),r.append(l),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class u2 extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:rect");return c.setAttribute("x",l/2),c.setAttribute("y",l/2),c.setAttribute("width",e-l),c.setAttribute("height",i-l),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class h2 extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const{data:t,width:e,height:i}=this,r=this.svgFactory.create(e,i,!0),l=t.borderStyle.width,c=this.#t=this.svgFactory.createElement("svg:ellipse");return c.setAttribute("cx",e/2),c.setAttribute("cy",i/2),c.setAttribute("rx",e/2-l/2),c.setAttribute("ry",i/2-l/2),c.setAttribute("stroke-width",l||1),c.setAttribute("stroke","transparent"),c.setAttribute("fill","transparent"),r.append(c),this.container.append(r),!t.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class e1 extends We{#t=null;constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,vertices:e,borderStyle:i,popupRef:r},width:l,height:c}=this;if(!e)return this.container;const u=this.svgFactory.create(l,c,!0);let d=[];for(let p=0,y=e.length;p<y;p+=2){const w=e[p]-t[0],A=t[3]-e[p+1];d.push(`${w},${A}`)}d=d.join(" ");const f=this.#t=this.svgFactory.createElement(this.svgElementName);return f.setAttribute("points",d),f.setAttribute("stroke-width",i.width||1),f.setAttribute("stroke","transparent"),f.setAttribute("fill","transparent"),u.append(f),this.container.append(u),!r&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}}class d2 extends e1{constructor(t){super(t),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class f2 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container}}class Hm extends We{#t=null;#e=[];constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=this.data.it==="InkHighlight"?ae.HIGHLIGHT:ae.INK}#i(t,e){switch(t){case 90:return{transform:`rotate(90) translate(${-e[0]},${e[1]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};case 180:return{transform:`rotate(180) translate(${-e[2]},${e[1]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]};case 270:return{transform:`rotate(270) translate(${-e[2]},${e[3]}) scale(1,-1)`,width:e[3]-e[1],height:e[2]-e[0]};default:return{transform:`translate(${-e[0]},${e[3]}) scale(1,-1)`,width:e[2]-e[0],height:e[3]-e[1]}}}render(){this.container.classList.add(this.containerClassName);const{data:{rect:t,rotation:e,inkLists:i,borderStyle:r,popupRef:l}}=this,{transform:c,width:u,height:d}=this.#i(e,t),f=this.svgFactory.create(u,d,!0),p=this.#t=this.svgFactory.createElement("svg:g");f.append(p),p.setAttribute("stroke-width",r.width||1),p.setAttribute("stroke-linecap","round"),p.setAttribute("stroke-linejoin","round"),p.setAttribute("stroke-miterlimit",10),p.setAttribute("stroke","transparent"),p.setAttribute("fill","transparent"),p.setAttribute("transform",c);for(let y=0,w=i.length;y<w;y++){const A=this.svgFactory.createElement(this.svgElementName);this.#e.push(A),A.setAttribute("points",i[y].join(",")),p.append(A)}return!l&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.append(f),this._editOnDoubleClick(),this.container}updateEdited(t){super.updateEdited(t);const{thickness:e,points:i,rect:r}=t,l=this.#t;if(e>=0&&l.setAttribute("stroke-width",e||1),i)for(let c=0,u=this.#e.length;c<u;c++)this.#e[c].setAttribute("points",i[c].join(","));if(r){const{transform:c,width:u,height:d}=this.#i(this.data.rotation,r);l.parentElement.setAttribute("viewBox",`0 0 ${u} ${d}`),l.setAttribute("transform",c)}}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class n1 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0}),this.annotationEditorType=ae.HIGHLIGHT}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("highlightAnnotation"),this._editOnDoubleClick(),t){const i=document.createElement("mark");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class p2 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("underlineAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class m2 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("squigglyAnnotation"),t){const i=document.createElement("u");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class g2 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){const{data:{overlaidText:t,popupRef:e}}=this;if(!e&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this.container.classList.add("strikeoutAnnotation"),t){const i=document.createElement("s");i.classList.add("overlaidText"),i.textContent=t,this.container.append(i)}return this.container}}class i1 extends We{constructor(t){super(t,{isRenderable:!0,ignoreBorder:!0}),this.annotationEditorType=ae.STAMP}render(){return this.container.classList.add("stampAnnotation"),this.container.setAttribute("role","img"),!this.data.popupRef&&this.hasPopupData&&(this.hasOwnCommentButton=!0,this._createPopup()),this._editOnDoubleClick(),this.container}}class y2 extends We{#t=null;constructor(t){super(t,{isRenderable:!0});const{file:e}=this.data;this.filename=e.filename,this.content=e.content,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,...e})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:t,data:e}=this;let i;e.hasAppearance||e.fillAlpha===0?i=document.createElement("div"):(i=document.createElement("img"),i.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(e.name)?"paperclip":"pushpin"}.svg`,e.fillAlpha&&e.fillAlpha<1&&(i.style=`filter: opacity(${Math.round(e.fillAlpha*100)}%);`)),i.addEventListener("dblclick",this.#e.bind(this)),this.#t=i;const{isMac:r}=xn.platform;return t.addEventListener("keydown",l=>{l.key==="Enter"&&(r?l.metaKey:l.ctrlKey)&&this.#e()}),!e.popupRef&&this.hasPopupData?(this.hasOwnCommentButton=!0,this._createPopup()):i.classList.add("popupTriggerArea"),t.append(i),t}getElementsToTriggerPopup(){return this.#t}addHighlightArea(){this.container.classList.add("highlightArea")}#e(){this.downloadManager?.openOrDownloadData(this.content,this.filename)}}class qm{#t=null;#e=null;#i=null;#n=new Map;#s=null;#a=null;#r=[];#o=!1;constructor({div:t,accessibilityManager:e,annotationCanvasMap:i,annotationEditorUIManager:r,page:l,viewport:c,structTreeLayer:u,commentManager:d,linkService:f,annotationStorage:p}){this.div=t,this.#t=e,this.#e=i,this.#s=u||null,this.#a=f||null,this.#i=p||new Bm,this.page=l,this.viewport=c,this.zIndex=0,this._annotationEditorUIManager=r,this._commentManager=d||null}hasEditableAnnotations(){return this.#n.size>0}async render(t){const{annotations:e}=t,i=this.div;Qa(i,this.viewport);const r=new Map,l=[],c={data:null,layer:i,linkService:this.#a,downloadManager:t.downloadManager,imageResourcesPath:t.imageResourcesPath||"",renderForms:t.renderForms!==!1,svgFactory:new Vh,annotationStorage:this.#i,enableComment:t.enableComment===!0,enableScripting:t.enableScripting===!0,hasJSActions:t.hasJSActions,fieldObjects:t.fieldObjects,parent:this,elements:null};for(const u of e){if(u.noHTML)continue;const d=u.annotationType===yn.POPUP;if(d){const y=r.get(u.id);if(!y)continue;if(!this._commentManager){l.push(u);continue}c.elements=y}else if(u.rect[2]===u.rect[0]||u.rect[3]===u.rect[1])continue;c.data=u;const f=Rp.create(c);if(!f.isRenderable)continue;if(!d&&(this.#r.push(f),u.popupRef)){const y=r.get(u.popupRef);y?y.push(f):r.set(u.popupRef,[f])}const p=f.render();u.hidden&&(p.style.visibility="hidden"),f._isEditable&&(this.#n.set(f.data.id,f),this._annotationEditorUIManager?.renderAnnotationElement(f))}await this.#c();for(const u of l){const d=c.elements=r.get(u.id);c.data=u;const f=Rp.create(c);if(!f.isRenderable)continue;const p=f.render();f.contentElement.id=`${Jo}${u.id}`,u.hidden&&(p.style.visibility="hidden"),d.at(-1).container.after(p)}this.#l()}async#c(){if(this.#r.length===0)return;this.div.replaceChildren();const t=[];if(!this.#o){this.#o=!0;for(const{contentElement:i,data:{id:r}}of this.#r){const l=i.id=`${Jo}${r}`;t.push(this.#s?.getAriaAttributes(l).then(c=>{if(c)for(const[u,d]of c)i.setAttribute(u,d)}))}}this.#r.sort(({data:{rect:[i,r,l,c]}},{data:{rect:[u,d,f,p]}})=>{if(i===l&&r===c)return 1;if(u===f&&d===p)return-1;const y=c,w=r,A=(r+c)/2,_=p,S=d,C=(d+p)/2;if(A>=_&&C<=w)return-1;if(C>=y&&A<=S)return 1;const M=(i+l)/2,k=(u+f)/2;return M-k});const e=document.createDocumentFragment();for(const i of this.#r)e.append(i.container),this._commentManager?(i.extraPopupElement?.popup||i.popup)?.renderCommentButton():i.extraPopupElement&&e.append(i.extraPopupElement.render());if(this.div.append(e),await Promise.all(t),this.#t)for(const i of this.#r)this.#t.addPointerInTextLayer(i.contentElement,!1)}async addLinkAnnotations(t){const e={data:null,layer:this.div,linkService:this.#a,svgFactory:new Vh,parent:this};for(const i of t){i.borderStyle||=qm._defaultBorderStyle,e.data=i;const r=Rp.create(e);r.isRenderable&&(r.render(),r.contentElement.id=`${Jo}${i.id}`,this.#r.push(r))}await this.#c()}update({viewport:t}){const e=this.div;this.viewport=t,Qa(e,{rotation:t.rotation}),this.#l(),e.hidden=!1}#l(){if(!this.#e)return;const t=this.div;for(const[e,i]of this.#e){const r=t.querySelector(`[data-annotation-id="${e}"]`);if(!r)continue;i.className="annotationContent";const{firstChild:l}=r;l?l.nodeName==="CANVAS"?l.replaceWith(i):l.classList.contains("annotationContent")?l.after(i):l.before(i):r.append(i);const c=this.#n.get(e);c&&(c._hasNoCanvas?(this._annotationEditorUIManager?.setMissingCanvas(e,r.id,i),c._hasNoCanvas=!1):c.canvas=i)}this.#e.clear()}getEditableAnnotations(){return Array.from(this.#n.values())}getEditableAnnotation(t){return this.#n.get(t)}addFakeAnnotation(t){const{div:e}=this,{id:i,rotation:r}=t,l=new e2({data:{id:i,rect:t.getPDFRect(),rotation:r},editor:t,layer:e,parent:this,enableComment:!!this._commentManager,linkService:this.#a,annotationStorage:this.#i});return l.render(),l.contentElement.id=`${Jo}${i}`,l.createOrUpdatePopup(),this.#r.push(l),l}removeAnnotation(t){const e=this.#r.findIndex(r=>r.data.id===t);if(e<0)return;const[i]=this.#r.splice(e,1);this.#t?.removePointerInTextLayer(i.contentElement)}updateFakeAnnotations(t){if(t.length!==0){for(const e of t)e.updateFakeAnnotationElement(this);this.#c()}}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}static get _defaultBorderStyle(){return ie(this,"_defaultBorderStyle",Object.freeze({width:1,rawWidth:1,style:Qo.SOLID,dashArray:[3],horizontalCornerRadius:0,verticalCornerRadius:0}))}}const Sh=/\r\n?|\n/g;class Rn extends Zt{#t="";#e=`${this.id}-editor`;#i=null;#n;_colorPicker=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const t=Rn.prototype,e=l=>l.isEmpty(),i=Jr.TRANSLATE_SMALL,r=Jr.TRANSLATE_BIG;return ie(this,"_keyboardManager",new Yc([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],t.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],t.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],t._translateEmpty,{args:[-i,0],checker:e}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],t._translateEmpty,{args:[-r,0],checker:e}],[["ArrowRight","mac+ArrowRight"],t._translateEmpty,{args:[i,0],checker:e}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],t._translateEmpty,{args:[r,0],checker:e}],[["ArrowUp","mac+ArrowUp"],t._translateEmpty,{args:[0,-i],checker:e}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],t._translateEmpty,{args:[0,-r],checker:e}],[["ArrowDown","mac+ArrowDown"],t._translateEmpty,{args:[0,i],checker:e}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],t._translateEmpty,{args:[0,r],checker:e}]]))}static _type="freetext";static _editorType=ae.FREETEXT;constructor(t){super({...t,name:"freeTextEditor"}),this.color=t.color||Rn._defaultColor||Zt._defaultLineColor,this.#n=t.fontSize||Rn._defaultFontSize,this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-freetext-added-alert"),this.canAddComment=!1}static initialize(t,e){Zt.initialize(t,e);const i=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(i.getPropertyValue("--freetext-padding"))}static updateDefaultParams(t,e){switch(t){case be.FREETEXT_SIZE:Rn._defaultFontSize=e;break;case be.FREETEXT_COLOR:Rn._defaultColor=e;break}}updateParams(t,e){switch(t){case be.FREETEXT_SIZE:this.#s(e);break;case be.FREETEXT_COLOR:this.#a(e);break}}static get defaultPropertiesToUpdate(){return[[be.FREETEXT_SIZE,Rn._defaultFontSize],[be.FREETEXT_COLOR,Rn._defaultColor||Zt._defaultLineColor]]}get propertiesToUpdate(){return[[be.FREETEXT_SIZE,this.#n],[be.FREETEXT_COLOR,this.color]]}get toolbarButtons(){return this._colorPicker||=new Fc(this),[["colorPicker",this._colorPicker]]}get colorType(){return be.FREETEXT_COLOR}#s(t){const e=r=>{this.editorDiv.style.fontSize=`calc(${r}px * var(--total-scale-factor))`,this.translate(0,-(r-this.#n)*this.parentScale),this.#n=r,this.#o()},i=this.#n;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:be.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}onUpdatedColor(){this.editorDiv.style.color=this.color,this._colorPicker?.update(this.color),super.onUpdatedColor()}#a(t){const e=r=>{this.color=r,this.onUpdatedColor()},i=this.color;this.addCommands({cmd:e.bind(this,t),undo:e.bind(this,i),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:be.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(t,e){this._uiManager.translateSelectedEditors(t,e,!0)}getInitialTranslation(){const t=this.parentScale;return[-Rn._internalPadding*t,-(Rn._internalPadding+this.#n)*t]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){if(!super.enableEditMode())return!1;this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.#i=new AbortController;const t=this._uiManager.combinedSignal(this.#i);return this.editorDiv.addEventListener("keydown",this.editorDivKeydown.bind(this),{signal:t}),this.editorDiv.addEventListener("focus",this.editorDivFocus.bind(this),{signal:t}),this.editorDiv.addEventListener("blur",this.editorDivBlur.bind(this),{signal:t}),this.editorDiv.addEventListener("input",this.editorDivInput.bind(this),{signal:t}),this.editorDiv.addEventListener("paste",this.editorDivPaste.bind(this),{signal:t}),!0}disableEditMode(){return super.disableEditMode()?(this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#e),this._isDraggable=!0,this.#i?.abort(),this.#i=null,this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freetextEditing"),!0):!1}focusin(t){this._focusEventsAllowed&&(super.focusin(t),t.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(t){this.width||(this.enableEditMode(),t&&this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null)}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freetextEditing")),super.remove()}#r(){const t=[];this.editorDiv.normalize();let e=null;for(const i of this.editorDiv.childNodes)e?.nodeType===Node.TEXT_NODE&&i.nodeName==="BR"||(t.push(Rn.#c(i)),e=i);return t.join(`
`)}#o(){const[t,e]=this.parentDimensions;let i;if(this.isAttachedToDOM)i=this.div.getBoundingClientRect();else{const{currentLayer:r,div:l}=this,c=l.style.display,u=l.classList.contains("hidden");l.classList.remove("hidden"),l.style.display="hidden",r.div.append(this.div),i=l.getBoundingClientRect(),l.remove(),l.style.display=c,l.classList.toggle("hidden",u)}this.rotation%180===this.parentRotation%180?(this.width=i.width/t,this.height=i.height/e):(this.width=i.height/t,this.height=i.width/e),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const t=this.#t,e=this.#t=this.#r().trimEnd();if(t===e)return;const i=r=>{if(this.#t=r,!r){this.remove();return}this.#l(),this._uiManager.rebuild(this),this.#o()};this.addCommands({cmd:()=>{i(e)},undo:()=>{i(t)},mustExec:!1}),this.#o()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}keydown(t){t.target===this.div&&t.key==="Enter"&&(this.enterInEditMode(),t.preventDefault())}editorDivKeydown(t){Rn._keyboardManager.exec(this,t)}editorDivFocus(t){this.isEditing=!0}editorDivBlur(t){this.isEditing=!1}editorDivInput(t){this.parent.div.classList.toggle("freetextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}get canChangeContent(){return!0}render(){if(this.div)return this.div;let t,e;(this._isCopy||this.annotationElementId)&&(t=this.x,e=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#e),this.editorDiv.setAttribute("data-l10n-id","pdfjs-free-text2"),this.editorDiv.setAttribute("data-l10n-attrs","default-content"),this.enableEditing(),this.editorDiv.contentEditable=!0;const{style:i}=this.editorDiv;if(i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),this._isCopy||this.annotationElementId){const[r,l]=this.parentDimensions;if(this.annotationElementId){const{position:c}=this._initialData;let[u,d]=this.getInitialTranslation();[u,d]=this.pageTranslationToScreen(u,d);const[f,p]=this.pageDimensions,[y,w]=this.pageTranslation;let A,_;switch(this.rotation){case 0:A=t+(c[0]-y)/f,_=e+this.height-(c[1]-w)/p;break;case 90:A=t+(c[0]-y)/f,_=e-(c[1]-w)/p,[u,d]=[d,-u];break;case 180:A=t-this.width+(c[0]-y)/f,_=e-(c[1]-w)/p,[u,d]=[-u,-d];break;case 270:A=t+(c[0]-y-this.height*p)/f,_=e+(c[1]-w-this.width*f)/p,[u,d]=[-d,u];break}this.setAt(A*r,_*l,u,d)}else this._moveAfterPaste(t,e);this.#l(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}static#c(t){return(t.nodeType===Node.TEXT_NODE?t.nodeValue:t.innerText).replaceAll(Sh,"")}editorDivPaste(t){const e=t.clipboardData||window.clipboardData,{types:i}=e;if(i.length===1&&i[0]==="text/plain")return;t.preventDefault();const r=Rn.#h(e.getData("text")||"").replaceAll(Sh,`
`);if(!r)return;const l=window.getSelection();if(!l.rangeCount)return;this.editorDiv.normalize(),l.deleteFromDocument();const c=l.getRangeAt(0);if(!r.includes(`
`)){c.insertNode(document.createTextNode(r)),this.editorDiv.normalize(),l.collapseToStart();return}const{startContainer:u,startOffset:d}=c,f=[],p=[];if(u.nodeType===Node.TEXT_NODE){const A=u.parentElement;if(p.push(u.nodeValue.slice(d).replaceAll(Sh,"")),A!==this.editorDiv){let _=f;for(const S of this.editorDiv.childNodes){if(S===A){_=p;continue}_.push(Rn.#c(S))}}f.push(u.nodeValue.slice(0,d).replaceAll(Sh,""))}else if(u===this.editorDiv){let A=f,_=0;for(const S of this.editorDiv.childNodes)_++===d&&(A=p),A.push(Rn.#c(S))}this.#t=`${f.join(`
`)}${r}${p.join(`
`)}`,this.#l();const y=new Range;let w=Math.sumPrecise(f.map(A=>A.length));for(const{firstChild:A}of this.editorDiv.childNodes)if(A.nodeType===Node.TEXT_NODE){const _=A.nodeValue.length;if(w<=_){y.setStart(A,w),y.setEnd(A,w);break}w-=_}l.removeAllRanges(),l.addRange(y)}#l(){if(this.editorDiv.replaceChildren(),!!this.#t)for(const t of this.#t.split(`
`)){const e=document.createElement("div");e.append(t?document.createTextNode(t):document.createElement("br")),this.editorDiv.append(e)}}#d(){return this.#t.replaceAll(""," ")}static#h(t){return t.replaceAll(" ","")}get contentDiv(){return this.editorDiv}getPDFRect(){const t=Rn._internalPadding*this.parentScale;return this.getRect(t,t)}static async deserialize(t,e,i){let r=null;if(t instanceof t1){const{data:{defaultAppearanceData:{fontSize:c,fontColor:u},rect:d,rotation:f,id:p,popupRef:y,richText:w,contentsObj:A,creationDate:_,modificationDate:S},textContent:C,textPosition:M,parent:{page:{pageNumber:k}}}=t;if(!C||C.length===0)return null;r=t={annotationType:ae.FREETEXT,color:Array.from(u),fontSize:c,value:C.join(`
`),position:M,pageIndex:k-1,rect:d.slice(0),rotation:f,annotationElementId:p,id:p,deleted:!1,popupRef:y,comment:A?.str||null,richText:w,creationDate:_,modificationDate:S}}const l=await super.deserialize(t,e,i);return l.#n=t.fontSize,l.color=qt.makeHexColor(...t.color),l.#t=Rn.#h(t.value),l._initialData=r,t.comment&&l.setCommentData(t),l}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const e=Zt._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.color),i=Object.assign(super.serialize(t),{color:e,fontSize:this.#n,value:this.#d()});return this.addComment(i),t?(i.isCopy=!0,i):this.annotationElementId&&!this.#f(i)?null:(i.id=this.annotationElementId,i)}#f(t){const{value:e,fontSize:i,color:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||t.value!==e||t.fontSize!==i||t.color.some((c,u)=>c!==r[u])||t.pageIndex!==l}renderAnnotationElement(t){const e=super.renderAnnotationElement(t);if(!e)return null;const{style:i}=e;i.fontSize=`calc(${this.#n}px * var(--total-scale-factor))`,i.color=this.color,e.replaceChildren();for(const r of this.#t.split(`
`)){const l=document.createElement("div");l.append(r?document.createTextNode(r):document.createElement("br")),e.append(l)}return t.updateEdited({rect:this.getPDFRect(),popup:this._uiManager.hasCommentManager()||this.hasEditedComment?this.comment:{text:this.#t}}),e}resetAnnotationElement(t){super.resetAnnotationElement(t),t.resetEdited()}}class Gt{static PRECISION=1e-4;toSVGPath(){Me("Abstract method `toSVGPath` must be implemented.")}get box(){Me("Abstract getter `box` must be implemented.")}serialize(t,e){Me("Abstract method `serialize` must be implemented.")}static _rescale(t,e,i,r,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u]*r,c[u+1]=i+t[u+1]*l;return c}static _rescaleAndSwap(t,e,i,r,l,c){c||=new Float32Array(t.length);for(let u=0,d=t.length;u<d;u+=2)c[u]=e+t[u+1]*r,c[u+1]=i+t[u]*l;return c}static _translate(t,e,i,r){r||=new Float32Array(t.length);for(let l=0,c=t.length;l<c;l+=2)r[l]=e+t[l],r[l+1]=i+t[l+1];return r}static svgRound(t){return Math.round(t*1e4)}static _normalizePoint(t,e,i,r,l){switch(l){case 90:return[1-e/i,t/r];case 180:return[1-t/i,1-e/r];case 270:return[e/i,1-t/r];default:return[t/i,e/r]}}static _normalizePagePoint(t,e,i){switch(i){case 90:return[1-e,t];case 180:return[1-t,1-e];case 270:return[e,1-t];default:return[t,e]}}static createBezierPoints(t,e,i,r,l,c){return[(t+5*i)/6,(e+5*r)/6,(5*i+l)/6,(5*r+c)/6,(i+l)/2,(r+c)/2]}}class za{#t;#e=[];#i;#n;#s=[];#a=new Float32Array(18);#r;#o;#c;#l;#d;#h;#f=[];static#g=8;static#m=2;static#u=za.#g+za.#m;constructor({x:t,y:e},i,r,l,c,u=0){this.#t=i,this.#h=l*r,this.#n=c,this.#a.set([NaN,NaN,NaN,NaN,t,e],6),this.#i=u,this.#l=za.#g*r,this.#c=za.#u*r,this.#d=r,this.#f.push(t,e)}isEmpty(){return isNaN(this.#a[8])}#p(){const t=this.#a.subarray(4,6),e=this.#a.subarray(16,18),[i,r,l,c]=this.#t;return[(this.#r+(t[0]-e[0])/2-i)/l,(this.#o+(t[1]-e[1])/2-r)/c,(this.#r+(e[0]-t[0])/2-i)/l,(this.#o+(e[1]-t[1])/2-r)/c]}add({x:t,y:e}){this.#r=t,this.#o=e;const[i,r,l,c]=this.#t;let[u,d,f,p]=this.#a.subarray(8,12);const y=t-f,w=e-p,A=Math.hypot(y,w);if(A<this.#c)return!1;const _=A-this.#l,S=_/A,C=S*y,M=S*w;let k=u,L=d;u=f,d=p,f+=C,p+=M,this.#f?.push(t,e);const j=-M/_,F=C/_,z=j*this.#h,H=F*this.#h;return this.#a.set(this.#a.subarray(2,8),0),this.#a.set([f+z,p+H],4),this.#a.set(this.#a.subarray(14,18),12),this.#a.set([f-z,p-H],16),isNaN(this.#a[6])?(this.#s.length===0&&(this.#a.set([u+z,d+H],2),this.#s.push(NaN,NaN,NaN,NaN,(u+z-i)/l,(d+H-r)/c),this.#a.set([u-z,d-H],14),this.#e.push(NaN,NaN,NaN,NaN,(u-z-i)/l,(d-H-r)/c)),this.#a.set([k,L,u,d,f,p],6),!this.isEmpty()):(this.#a.set([k,L,u,d,f,p],6),Math.abs(Math.atan2(L-d,k-u)-Math.atan2(M,C))<Math.PI/2?([u,d,f,p]=this.#a.subarray(2,6),this.#s.push(NaN,NaN,NaN,NaN,((u+f)/2-i)/l,((d+p)/2-r)/c),[u,d,k,L]=this.#a.subarray(14,18),this.#e.push(NaN,NaN,NaN,NaN,((k+u)/2-i)/l,((L+d)/2-r)/c),!0):([k,L,u,d,f,p]=this.#a.subarray(0,6),this.#s.push(((k+5*u)/6-i)/l,((L+5*d)/6-r)/c,((5*u+f)/6-i)/l,((5*d+p)/6-r)/c,((u+f)/2-i)/l,((d+p)/2-r)/c),[f,p,u,d,k,L]=this.#a.subarray(12,18),this.#e.push(((k+5*u)/6-i)/l,((L+5*d)/6-r)/c,((5*u+f)/6-i)/l,((5*d+p)/6-r)/c,((u+f)/2-i)/l,((d+p)/2-r)/c),!0))}toSVGPath(){if(this.isEmpty())return"";const t=this.#s,e=this.#e;if(isNaN(this.#a[6])&&!this.isEmpty())return this.#y();const i=[];i.push(`M${t[4]} ${t[5]}`);for(let r=6;r<t.length;r+=6)isNaN(t[r])?i.push(`L${t[r+4]} ${t[r+5]}`):i.push(`C${t[r]} ${t[r+1]} ${t[r+2]} ${t[r+3]} ${t[r+4]} ${t[r+5]}`);this.#b(i);for(let r=e.length-6;r>=6;r-=6)isNaN(e[r])?i.push(`L${e[r+4]} ${e[r+5]}`):i.push(`C${e[r]} ${e[r+1]} ${e[r+2]} ${e[r+3]} ${e[r+4]} ${e[r+5]}`);return this.#v(i),i.join(" ")}#y(){const[t,e,i,r]=this.#t,[l,c,u,d]=this.#p();return`M${(this.#a[2]-t)/i} ${(this.#a[3]-e)/r} L${(this.#a[4]-t)/i} ${(this.#a[5]-e)/r} L${l} ${c} L${u} ${d} L${(this.#a[16]-t)/i} ${(this.#a[17]-e)/r} L${(this.#a[14]-t)/i} ${(this.#a[15]-e)/r} Z`}#v(t){const e=this.#e;t.push(`L${e[4]} ${e[5]} Z`)}#b(t){const[e,i,r,l]=this.#t,c=this.#a.subarray(4,6),u=this.#a.subarray(16,18),[d,f,p,y]=this.#p();t.push(`L${(c[0]-e)/r} ${(c[1]-i)/l} L${d} ${f} L${p} ${y} L${(u[0]-e)/r} ${(u[1]-i)/l}`)}newFreeDrawOutline(t,e,i,r,l,c){return new s1(t,e,i,r,l,c)}getOutlines(){const t=this.#s,e=this.#e,i=this.#a,[r,l,c,u]=this.#t,d=new Float32Array((this.#f?.length??0)+2);for(let y=0,w=d.length-2;y<w;y+=2)d[y]=(this.#f[y]-r)/c,d[y+1]=(this.#f[y+1]-l)/u;if(d[d.length-2]=(this.#r-r)/c,d[d.length-1]=(this.#o-l)/u,isNaN(i[6])&&!this.isEmpty())return this.#E(d);const f=new Float32Array(this.#s.length+24+this.#e.length);let p=t.length;for(let y=0;y<p;y+=2){if(isNaN(t[y])){f[y]=f[y+1]=NaN;continue}f[y]=t[y],f[y+1]=t[y+1]}p=this.#w(f,p);for(let y=e.length-6;y>=6;y-=6)for(let w=0;w<6;w+=2){if(isNaN(e[y+w])){f[p]=f[p+1]=NaN,p+=2;continue}f[p]=e[y+w],f[p+1]=e[y+w+1],p+=2}return this.#S(f,p),this.newFreeDrawOutline(f,d,this.#t,this.#d,this.#i,this.#n)}#E(t){const e=this.#a,[i,r,l,c]=this.#t,[u,d,f,p]=this.#p(),y=new Float32Array(36);return y.set([NaN,NaN,NaN,NaN,(e[2]-i)/l,(e[3]-r)/c,NaN,NaN,NaN,NaN,(e[4]-i)/l,(e[5]-r)/c,NaN,NaN,NaN,NaN,u,d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,(e[16]-i)/l,(e[17]-r)/c,NaN,NaN,NaN,NaN,(e[14]-i)/l,(e[15]-r)/c],0),this.newFreeDrawOutline(y,t,this.#t,this.#d,this.#i,this.#n)}#S(t,e){const i=this.#e;return t.set([NaN,NaN,NaN,NaN,i[4],i[5]],e),e+=6}#w(t,e){const i=this.#a.subarray(4,6),r=this.#a.subarray(16,18),[l,c,u,d]=this.#t,[f,p,y,w]=this.#p();return t.set([NaN,NaN,NaN,NaN,(i[0]-l)/u,(i[1]-c)/d,NaN,NaN,NaN,NaN,f,p,NaN,NaN,NaN,NaN,y,w,NaN,NaN,NaN,NaN,(r[0]-l)/u,(r[1]-c)/d],e),e+=24}}class s1 extends Gt{#t;#e=new Float32Array(4);#i;#n;#s;#a;#r;constructor(t,e,i,r,l,c){super(),this.#r=t,this.#s=e,this.#t=i,this.#a=r,this.#i=l,this.#n=c,this.firstPoint=[NaN,NaN],this.lastPoint=[NaN,NaN],this.#o(c);const[u,d,f,p]=this.#e;for(let y=0,w=t.length;y<w;y+=2)t[y]=(t[y]-u)/f,t[y+1]=(t[y+1]-d)/p;for(let y=0,w=e.length;y<w;y+=2)e[y]=(e[y]-u)/f,e[y+1]=(e[y+1]-d)/p}toSVGPath(){const t=[`M${this.#r[4]} ${this.#r[5]}`];for(let e=6,i=this.#r.length;e<i;e+=6){if(isNaN(this.#r[e])){t.push(`L${this.#r[e+4]} ${this.#r[e+5]}`);continue}t.push(`C${this.#r[e]} ${this.#r[e+1]} ${this.#r[e+2]} ${this.#r[e+3]} ${this.#r[e+4]} ${this.#r[e+5]}`)}return t.push("Z"),t.join(" ")}serialize([t,e,i,r],l){const c=i-t,u=r-e;let d,f;switch(l){case 0:d=Gt._rescale(this.#r,t,r,c,-u),f=Gt._rescale(this.#s,t,r,c,-u);break;case 90:d=Gt._rescaleAndSwap(this.#r,t,e,c,u),f=Gt._rescaleAndSwap(this.#s,t,e,c,u);break;case 180:d=Gt._rescale(this.#r,i,e,-c,u),f=Gt._rescale(this.#s,i,e,-c,u);break;case 270:d=Gt._rescaleAndSwap(this.#r,i,r,-c,-u),f=Gt._rescaleAndSwap(this.#s,i,r,-c,-u);break}return{outline:Array.from(d),points:[Array.from(f)]}}#o(t){const e=this.#r;let i=e[4],r=e[5];const l=[i,r,i,r];let c=i,u=r,d=i,f=r;const p=t?Math.max:Math.min,y=new Float32Array(4);for(let A=6,_=e.length;A<_;A+=6){const S=e[A+4],C=e[A+5];isNaN(e[A])?(qt.pointBoundingBox(S,C,l),u>C?(c=S,u=C):u===C&&(c=p(c,S)),f<C?(d=S,f=C):f===C&&(d=p(d,S))):(y[0]=y[1]=1/0,y[2]=y[3]=-1/0,qt.bezierBoundingBox(i,r,...e.slice(A,A+6),y),qt.rectBoundingBox(y[0],y[1],y[2],y[3],l),u>y[1]?(c=y[0],u=y[1]):u===y[1]&&(c=p(c,y[0])),f<y[3]?(d=y[2],f=y[3]):f===y[3]&&(d=p(d,y[2]))),i=S,r=C}const w=this.#e;w[0]=l[0]-this.#i,w[1]=l[1]-this.#i,w[2]=l[2]-l[0]+2*this.#i,w[3]=l[3]-l[1]+2*this.#i,this.firstPoint=[c,u],this.lastPoint=[d,f]}get box(){return this.#e}newOutliner(t,e,i,r,l,c=0){return new za(t,e,i,r,l,c)}getNewOutline(t,e){const[i,r,l,c]=this.#e,[u,d,f,p]=this.#t,y=l*f,w=c*p,A=i*f+u,_=r*p+d,S=this.newOutliner({x:this.#s[0]*y+A,y:this.#s[1]*w+_},this.#t,this.#a,t,this.#n,e??this.#i);for(let C=2;C<this.#s.length;C+=2)S.add({x:this.#s[C]*y+A,y:this.#s[C+1]*w+_});return S.getOutlines()}}class rm{#t;#e;#i;#n=[];#s=[];constructor(t,e=0,i=0,r=!0){const l=[1/0,1/0,-1/0,-1/0],c=10**-4;for(const{x:S,y:C,width:M,height:k}of t){const L=Math.floor((S-e)/c)*c,j=Math.ceil((S+M+e)/c)*c,F=Math.floor((C-e)/c)*c,z=Math.ceil((C+k+e)/c)*c,H=[L,F,z,!0],ut=[j,F,z,!1];this.#n.push(H,ut),qt.rectBoundingBox(L,F,j,z,l)}const u=l[2]-l[0]+2*i,d=l[3]-l[1]+2*i,f=l[0]-i,p=l[1]-i;let y=r?-1/0:1/0,w=1/0;const A=this.#n.at(r?-1:-2),_=[A[0],A[2]];for(const S of this.#n){const[C,M,k,L]=S;!L&&r?M<w?(w=M,y=C):M===w&&(y=Math.max(y,C)):L&&!r&&(M<w?(w=M,y=C):M===w&&(y=Math.min(y,C))),S[0]=(C-f)/u,S[1]=(M-p)/d,S[2]=(k-p)/d}this.#t=new Float32Array([f,p,u,d]),this.#e=[y,w],this.#i=_}getOutlines(){this.#n.sort((e,i)=>e[0]-i[0]||e[1]-i[1]||e[2]-i[2]);const t=[];for(const e of this.#n)e[3]?(t.push(...this.#l(e)),this.#o(e)):(this.#c(e),t.push(...this.#l(e)));return this.#a(t)}#a(t){const e=[],i=new Set;for(const c of t){const[u,d,f]=c;e.push([u,d,c],[u,f,c])}e.sort((c,u)=>c[1]-u[1]||c[0]-u[0]);for(let c=0,u=e.length;c<u;c+=2){const d=e[c][2],f=e[c+1][2];d.push(f),f.push(d),i.add(d),i.add(f)}const r=[];let l;for(;i.size>0;){const c=i.values().next().value;let[u,d,f,p,y]=c;i.delete(c);let w=u,A=d;for(l=[u,f],r.push(l);;){let _;if(i.has(p))_=p;else if(i.has(y))_=y;else break;i.delete(_),[u,d,f,p,y]=_,w!==u&&(l.push(w,A,u,A===d?d:f),w=u),A=A===d?f:d}l.push(w,A)}return new b2(r,this.#t,this.#e,this.#i)}#r(t){const e=this.#s;let i=0,r=e.length-1;for(;i<=r;){const l=i+r>>1,c=e[l][0];if(c===t)return l;c<t?i=l+1:r=l-1}return r+1}#o([,t,e]){const i=this.#r(t);this.#s.splice(i,0,[t,e])}#c([,t,e]){const i=this.#r(t);for(let r=i;r<this.#s.length;r++){const[l,c]=this.#s[r];if(l!==t)break;if(l===t&&c===e){this.#s.splice(r,1);return}}for(let r=i-1;r>=0;r--){const[l,c]=this.#s[r];if(l!==t)break;if(l===t&&c===e){this.#s.splice(r,1);return}}}#l(t){const[e,i,r]=t,l=[[e,i,r]],c=this.#r(r);for(let u=0;u<c;u++){const[d,f]=this.#s[u];for(let p=0,y=l.length;p<y;p++){const[,w,A]=l[p];if(!(f<=w||A<=d)){if(w>=d){if(A>f)l[p][1]=f;else{if(y===1)return[];l.splice(p,1),p--,y--}continue}l[p][2]=d,A>f&&l.push([e,f,A])}}}return l}}class b2 extends Gt{#t;#e;constructor(t,e,i,r){super(),this.#e=t,this.#t=e,this.firstPoint=i,this.lastPoint=r}toSVGPath(){const t=[];for(const e of this.#e){let[i,r]=e;t.push(`M${i} ${r}`);for(let l=2;l<e.length;l+=2){const c=e[l],u=e[l+1];c===i?(t.push(`V${u}`),r=u):u===r&&(t.push(`H${c}`),i=c)}t.push("Z")}return t.join(" ")}serialize([t,e,i,r],l){const c=[],u=i-t,d=r-e;for(const f of this.#e){const p=new Array(f.length);for(let y=0;y<f.length;y+=2)p[y]=t+f[y]*u,p[y+1]=r-f[y+1]*d;c.push(p)}return c}get box(){return this.#t}get classNamesForOutlining(){return["highlightOutline"]}}class am extends za{newFreeDrawOutline(t,e,i,r,l,c){return new v2(t,e,i,r,l,c)}}class v2 extends s1{newOutliner(t,e,i,r,l,c=0){return new am(t,e,i,r,l,c)}}class ln extends Zt{#t=null;#e=0;#i;#n=null;#s=null;#a=null;#r=null;#o=0;#c=null;#l=null;#d=null;#h=!1;#f=null;#g=null;#m=null;#u="";#p;#y="";static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=12;static _type="highlight";static _editorType=ae.HIGHLIGHT;static _freeHighlightId=-1;static _freeHighlight=null;static _freeHighlightClipId="";static get _keyboardManager(){const t=ln.prototype;return ie(this,"_keyboardManager",new Yc([[["ArrowLeft","mac+ArrowLeft"],t._moveCaret,{args:[0]}],[["ArrowRight","mac+ArrowRight"],t._moveCaret,{args:[1]}],[["ArrowUp","mac+ArrowUp"],t._moveCaret,{args:[2]}],[["ArrowDown","mac+ArrowDown"],t._moveCaret,{args:[3]}]]))}constructor(t){super({...t,name:"highlightEditor"}),this.color=t.color||ln._defaultColor,this.#p=t.thickness||ln._defaultThickness,this.opacity=t.opacity||ln._defaultOpacity,this.#i=t.boxes||null,this.#y=t.methodOfCreation||"",this.#u=t.text||"",this._isDraggable=!1,this.defaultL10nId="pdfjs-editor-highlight-editor",t.highlightId>-1?(this.#h=!0,this.#b(t),this.#x()):this.#i&&(this.#t=t.anchorNode,this.#e=t.anchorOffset,this.#r=t.focusNode,this.#o=t.focusOffset,this.#v(),this.#x(),this.rotate(this.rotation)),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-highlight-added-alert")}get telemetryInitialData(){return{action:"added",type:this.#h?"free_highlight":"highlight",color:this._uiManager.getNonHCMColorName(this.color),thickness:this.#p,methodOfCreation:this.#y}}get telemetryFinalData(){return{type:"highlight",color:this._uiManager.getNonHCMColorName(this.color)}}static computeTelemetryFinalData(t){return{numberOfColors:t.get("color").size}}#v(){const t=new rm(this.#i,.001);this.#l=t.getOutlines(),[this.x,this.y,this.width,this.height]=this.#l.box;const e=new rm(this.#i,.0025,.001,this._uiManager.direction==="ltr");this.#a=e.getOutlines();const{firstPoint:i}=this.#l;this.#f=[(i[0]-this.x)/this.width,(i[1]-this.y)/this.height];const{lastPoint:r}=this.#a;this.#g=[(r[0]-this.x)/this.width,(r[1]-this.y)/this.height]}#b({highlightOutlines:t,highlightId:e,clipPathId:i}){this.#l=t;const r=1.5;if(this.#a=t.getNewOutline(this.#p/2+r,.0025),e>=0)this.#d=e,this.#n=i,this.parent.drawLayer.finalizeDraw(e,{bbox:t.box,path:{d:t.toSVGPath()}}),this.#m=this.parent.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:!0},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},!0);else if(this.parent){const y=this.parent.viewport.rotation;this.parent.drawLayer.updateProperties(this.#d,{bbox:ln.#_(this.#l.box,(y-this.rotation+360)%360),path:{d:t.toSVGPath()}}),this.parent.drawLayer.updateProperties(this.#m,{bbox:ln.#_(this.#a.box,y),path:{d:this.#a.toSVGPath()}})}const[l,c,u,d]=t.box;switch(this.rotation){case 0:this.x=l,this.y=c,this.width=u,this.height=d;break;case 90:{const[y,w]=this.parentDimensions;this.x=c,this.y=1-l,this.width=u*w/y,this.height=d*y/w;break}case 180:this.x=1-l,this.y=1-c,this.width=u,this.height=d;break;case 270:{const[y,w]=this.parentDimensions;this.x=1-c,this.y=l,this.width=u*w/y,this.height=d*y/w;break}}const{firstPoint:f}=t;this.#f=[(f[0]-l)/u,(f[1]-c)/d];const{lastPoint:p}=this.#a;this.#g=[(p[0]-l)/u,(p[1]-c)/d]}static initialize(t,e){Zt.initialize(t,e),ln._defaultColor||=e.highlightColors?.values().next().value||"#fff066"}static updateDefaultParams(t,e){switch(t){case be.HIGHLIGHT_COLOR:ln._defaultColor=e;break;case be.HIGHLIGHT_THICKNESS:ln._defaultThickness=e;break}}translateInPage(t,e){}get toolbarPosition(){return this.#g}get commentButtonPosition(){return this.#f}updateParams(t,e){switch(t){case be.HIGHLIGHT_COLOR:this.#E(e);break;case be.HIGHLIGHT_THICKNESS:this.#S(e);break}}static get defaultPropertiesToUpdate(){return[[be.HIGHLIGHT_COLOR,ln._defaultColor],[be.HIGHLIGHT_THICKNESS,ln._defaultThickness]]}get propertiesToUpdate(){return[[be.HIGHLIGHT_COLOR,this.color||ln._defaultColor],[be.HIGHLIGHT_THICKNESS,this.#p||ln._defaultThickness],[be.HIGHLIGHT_FREE,this.#h]]}onUpdatedColor(){this.parent?.drawLayer.updateProperties(this.#d,{root:{fill:this.color,"fill-opacity":this.opacity}}),this.#s?.updateColor(this.color),super.onUpdatedColor()}#E(t){const e=(l,c)=>{this.color=l,this.opacity=c,this.onUpdatedColor()},i=this.color,r=this.opacity;this.addCommands({cmd:e.bind(this,t,ln._defaultOpacity),undo:e.bind(this,i,r),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:be.HIGHLIGHT_COLOR,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"color_changed",color:this._uiManager.getNonHCMColorName(t)},!0)}#S(t){const e=this.#p,i=r=>{this.#p=r,this.#w(r)};this.addCommands({cmd:i.bind(this,t),undo:i.bind(this,e),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:be.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0}),this._reportTelemetry({action:"thickness_changed",thickness:t},!0)}get toolbarButtons(){return this._uiManager.highlightColors?[["colorPicker",this.#s=new Zw({editor:this})]]:super.toolbarButtons}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}fixAndSetPosition(){return super.fixAndSetPosition(this.#M())}getBaseTranslation(){return[0,0]}getRect(t,e){return super.getRect(t,e,this.#M())}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),t&&this.div.focus()}remove(){this.#C(),this._reportTelemetry({action:"deleted"}),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#x(),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?this.#C():t&&(this.#x(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),this.show(this._isVisible),e&&this.select()}#w(t){this.#h&&(this.#b({highlightOutlines:this.#l.getNewOutline(t/2)}),this.fixAndSetPosition(),this.setDims())}#C(){this.#d===null||!this.parent||(this.parent.drawLayer.remove(this.#d),this.#d=null,this.parent.drawLayer.remove(this.#m),this.#m=null)}#x(t=this.parent){this.#d===null&&({id:this.#d,clipPathId:this.#n}=t.drawLayer.draw({bbox:this.#l.box,root:{viewBox:"0 0 1 1",fill:this.color,"fill-opacity":this.opacity},rootClass:{highlight:!0,free:this.#h},path:{d:this.#l.toSVGPath()}},!1,!0),this.#m=t.drawLayer.drawOutline({rootClass:{highlightOutline:!0,free:this.#h},bbox:this.#a.box,path:{d:this.#a.toSVGPath()}},this.#h),this.#c&&(this.#c.style.clipPath=this.#n))}static#_([t,e,i,r],l){switch(l){case 90:return[1-e-r,t,r,i];case 180:return[1-t-i,1-e-r,i,r];case 270:return[e,1-t-i,r,i]}return[t,e,i,r]}rotate(t){const{drawLayer:e}=this.parent;let i;this.#h?(t=(t-this.rotation+360)%360,i=ln.#_(this.#l.box,t)):i=ln.#_([this.x,this.y,this.width,this.height],t),e.updateProperties(this.#d,{bbox:i,root:{"data-main-rotation":t}}),e.updateProperties(this.#m,{bbox:ln.#_(this.#a.box,t),root:{"data-main-rotation":t}})}render(){if(this.div)return this.div;const t=super.render();this.#u&&(t.setAttribute("aria-label",this.#u),t.setAttribute("role","mark")),this.#h?t.classList.add("free"):this.div.addEventListener("keydown",this.#D.bind(this),{signal:this._uiManager._signal});const e=this.#c=document.createElement("div");return t.append(e),e.setAttribute("aria-hidden","true"),e.className="internal",e.style.clipPath=this.#n,this.setDims(),Dw(this,this.#c,["pointerover","pointerleave"]),this.enableEditing(),t}pointerover(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!0}})}pointerleave(){this.isSelected||this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1}})}#D(t){ln._keyboardManager.exec(this,t)}_moveCaret(t){switch(this.parent.unselect(this),t){case 0:case 2:this.#R(!0);break;case 1:case 3:this.#R(!1);break}}#R(t){if(!this.#t)return;const e=window.getSelection();t?e.setPosition(this.#t,this.#e):e.setPosition(this.#r,this.#o)}select(){super.select(),this.#m&&this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{hovered:!1,selected:!0}})}unselect(){super.unselect(),this.#m&&(this.parent?.drawLayer.updateProperties(this.#m,{rootClass:{selected:!1}}),this.#h||this.#R(!1))}get _mustFixPosition(){return!this.#h}show(t=this._isVisible){super.show(t),this.parent&&(this.parent.drawLayer.updateProperties(this.#d,{rootClass:{hidden:!t}}),this.parent.drawLayer.updateProperties(this.#m,{rootClass:{hidden:!t}}))}#M(){return this.#h?this.rotation:0}#j(){if(this.#h)return null;const[t,e]=this.pageDimensions,[i,r]=this.pageTranslation,l=this.#i,c=new Float32Array(l.length*8);let u=0;for(const{x:d,y:f,width:p,height:y}of l){const w=d*t+i,A=(1-f)*e+r;c[u]=c[u+4]=w,c[u+1]=c[u+3]=A,c[u+2]=c[u+6]=w+p*t,c[u+5]=c[u+7]=A-y*e,u+=8}return c}#N(t){return this.#l.serialize(t,this.#M())}static startHighlighting(t,e,{target:i,x:r,y:l}){const{x:c,y:u,width:d,height:f}=i.getBoundingClientRect(),p=new AbortController,y=t.combinedSignal(p),w=A=>{p.abort(),this.#F(t,A)};window.addEventListener("blur",w,{signal:y}),window.addEventListener("pointerup",w,{signal:y}),window.addEventListener("pointerdown",en,{capture:!0,passive:!1,signal:y}),window.addEventListener("contextmenu",$i,{signal:y}),i.addEventListener("pointermove",this.#L.bind(this,t),{signal:y}),this._freeHighlight=new am({x:r,y:l},[c,u,d,f],t.scale,this._defaultThickness/2,e,.001),{id:this._freeHighlightId,clipPathId:this._freeHighlightClipId}=t.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:this._defaultColor,"fill-opacity":this._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:this._freeHighlight.toSVGPath()}},!0,!0)}static#L(t,e){this._freeHighlight.add(e)&&t.drawLayer.updateProperties(this._freeHighlightId,{path:{d:this._freeHighlight.toSVGPath()}})}static#F(t,e){this._freeHighlight.isEmpty()?t.drawLayer.remove(this._freeHighlightId):t.createAndAddNewEditor(e,!1,{highlightId:this._freeHighlightId,highlightOutlines:this._freeHighlight.getOutlines(),clipPathId:this._freeHighlightClipId,methodOfCreation:"main_toolbar"}),this._freeHighlightId=-1,this._freeHighlight=null,this._freeHighlightClipId=""}static async deserialize(t,e,i){let r=null;if(t instanceof n1){const{data:{quadPoints:_,rect:S,rotation:C,id:M,color:k,opacity:L,popupRef:j,richText:F,contentsObj:z,creationDate:H,modificationDate:ut},parent:{page:{pageNumber:ft}}}=t;r=t={annotationType:ae.HIGHLIGHT,color:Array.from(k),opacity:L,quadPoints:_,boxes:null,pageIndex:ft-1,rect:S.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,popupRef:j,richText:F,comment:z?.str||null,creationDate:H,modificationDate:ut}}else if(t instanceof Hm){const{data:{inkLists:_,rect:S,rotation:C,id:M,color:k,borderStyle:{rawWidth:L},popupRef:j,richText:F,contentsObj:z,creationDate:H,modificationDate:ut},parent:{page:{pageNumber:ft}}}=t;r=t={annotationType:ae.HIGHLIGHT,color:Array.from(k),thickness:L,inkLists:_,boxes:null,pageIndex:ft-1,rect:S.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,popupRef:j,richText:F,comment:z?.str||null,creationDate:H,modificationDate:ut}}const{color:l,quadPoints:c,inkLists:u,opacity:d}=t,f=await super.deserialize(t,e,i);f.color=qt.makeHexColor(...l),f.opacity=d||1,u&&(f.#p=t.thickness),f._initialData=r,t.comment&&f.setCommentData(t);const[p,y]=f.pageDimensions,[w,A]=f.pageTranslation;if(c){const _=f.#i=[];for(let S=0;S<c.length;S+=8)_.push({x:(c[S]-w)/p,y:1-(c[S+1]-A)/y,width:(c[S+2]-c[S])/p,height:(c[S+1]-c[S+5])/y});f.#v(),f.#x(),f.rotate(f.rotation)}else if(u){f.#h=!0;const _=u[0],S={x:_[0]-w,y:y-(_[1]-A)},C=new am(S,[0,0,p,y],1,f.#p/2,!0,.001);for(let L=0,j=_.length;L<j;L+=2)S.x=_[L]-w,S.y=y-(_[L+1]-A),C.add(S);const{id:M,clipPathId:k}=e.drawLayer.draw({bbox:[0,0,1,1],root:{viewBox:"0 0 1 1",fill:f.color,"fill-opacity":f._defaultOpacity},rootClass:{highlight:!0,free:!0},path:{d:C.toSVGPath()}},!0,!0);f.#b({highlightOutlines:C.getOutlines(),highlightId:M,clipPathId:k}),f.#x(),f.rotate(f.parentRotation)}return f}serialize(t=!1){if(this.isEmpty()||t)return null;if(this.deleted)return this.serializeDeleted();const e=Zt._colorManager.convert(this._uiManager.getNonHCMColor(this.color)),i=super.serialize(t);return Object.assign(i,{color:e,opacity:this.opacity,thickness:this.#p,quadPoints:this.#j(),outlines:this.#N(i.rect)}),this.addComment(i),this.annotationElementId&&!this.#P(i)?null:(i.id=this.annotationElementId,i)}#P(t){const{color:e}=this._initialData;return this.hasEditedComment||t.color.some((i,r)=>i!==e[r])}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}static canCreateNewEmptyEditor(){return!1}}class r1{#t=Object.create(null);updateProperty(t,e){this[t]=e,this.updateSVGProperty(t,e)}updateProperties(t){if(t)for(const[e,i]of Object.entries(t))e.startsWith("_")||this.updateProperty(e,i)}updateSVGProperty(t,e){this.#t[t]=e}toSVGProperties(){const t=this.#t;return this.#t=Object.create(null),{root:t}}reset(){this.#t=Object.create(null)}updateAll(t=this){this.updateProperties(t)}clone(){Me("Not implemented")}}class _e extends Zt{#t=null;#e;_colorPicker=null;_drawId=null;static _currentDrawId=-1;static _currentParent=null;static#i=null;static#n=null;static#s=null;static _INNER_MARGIN=3;constructor(t){super(t),this.#e=t.mustBeCommitted||!1,this._addOutlines(t)}onUpdatedColor(){this._colorPicker?.update(this.color),super.onUpdatedColor()}_addOutlines(t){t.drawOutlines&&(this.#a(t),this.#c())}#a({drawOutlines:t,drawId:e,drawingOptions:i}){this.#t=t,this._drawingOptions||=i,this.annotationElementId||this._uiManager.a11yAlert(`pdfjs-editor-${this.editorType}-added-alert`),e>=0?(this._drawId=e,this.parent.drawLayer.finalizeDraw(e,t.defaultProperties)):this._drawId=this.#r(t,this.parent),this.#h(t.box)}#r(t,e){const{id:i}=e.drawLayer.draw(_e._mergeSVGProperties(this._drawingOptions.toSVGProperties(),t.defaultSVGProperties),!1,!1);return i}static _mergeSVGProperties(t,e){const i=new Set(Object.keys(t));for(const[r,l]of Object.entries(e))i.has(r)?Object.assign(t[r],l):t[r]=l;return t}static getDefaultDrawingOptions(t){Me("Not implemented")}static get typesMap(){Me("Not implemented")}static get isDrawer(){return!0}static get supportMultipleDrawings(){return!1}static updateDefaultParams(t,e){const i=this.typesMap.get(t);i&&this._defaultDrawingOptions.updateProperty(i,e),this._currentParent&&(_e.#i.updateProperty(i,e),this._currentParent.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}updateParams(t,e){const i=this.constructor.typesMap.get(t);i&&this._updateProperty(t,i,e)}static get defaultPropertiesToUpdate(){const t=[],e=this._defaultDrawingOptions;for(const[i,r]of this.typesMap)t.push([i,e[r]]);return t}get propertiesToUpdate(){const t=[],{_drawingOptions:e}=this;for(const[i,r]of this.constructor.typesMap)t.push([i,e[r]]);return t}_updateProperty(t,e,i){const r=this._drawingOptions,l=r[e],c=u=>{r.updateProperty(e,u);const d=this.#t.updateProperty(e,u);d&&this.#h(d),this.parent?.drawLayer.updateProperties(this._drawId,r.toSVGProperties()),t===this.colorType&&this.onUpdatedColor()};this.addCommands({cmd:c.bind(this,i),undo:c.bind(this,l),post:this._uiManager.updateUI.bind(this._uiManager,this),mustExec:!0,type:t,overwriteIfSameType:!0,keepUndo:!0})}_onResizing(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathResizingSVGProperties(this.#d()),{bbox:this.#f()}))}_onResized(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathResizedSVGProperties(this.#d()),{bbox:this.#f()}))}_onTranslating(t,e){this.parent?.drawLayer.updateProperties(this._drawId,{bbox:this.#f()})}_onTranslated(){this.parent?.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties(this.#t.getPathTranslatedSVGProperties(this.#d(),this.parentDimensions),{bbox:this.#f()}))}_onStartDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!0}})}_onStopDragging(){this.parent?.drawLayer.updateProperties(this._drawId,{rootClass:{moving:!1}})}commit(){super.commit(),this.disableEditMode(),this.disableEditing()}disableEditing(){super.disableEditing(),this.div.classList.toggle("disabled",!0)}enableEditing(){super.enableEditing(),this.div.classList.toggle("disabled",!1)}getBaseTranslation(){return[0,0]}get isResizable(){return!0}onceAdded(t){this.annotationElementId||this.parent.addUndoableEditor(this),this._isDraggable=!0,this.#e&&(this.#e=!1,this.commit(),this.parent.setSelected(this),t&&this.isOnScreen&&this.div.focus())}remove(){this.#o(),super.remove()}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.#c(),this.#h(this.#t.box),this.isAttachedToDOM||this.parent.add(this)))}setParent(t){let e=!1;this.parent&&!t?(this._uiManager.removeShouldRescale(this),this.#o()):t&&(this._uiManager.addShouldRescale(this),this.#c(t),e=!this.parent&&this.div?.classList.contains("selectedEditor")),super.setParent(t),e&&this.select()}#o(){this._drawId===null||!this.parent||(this.parent.drawLayer.remove(this._drawId),this._drawId=null,this._drawingOptions.reset())}#c(t=this.parent){if(!(this._drawId!==null&&this.parent===t)){if(this._drawId!==null){this.parent.drawLayer.updateParent(this._drawId,t.drawLayer);return}this._drawingOptions.updateAll(),this._drawId=this.#r(this.#t,t)}}#l([t,e,i,r]){const{parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[e,1-t,i*(c/l),r*(l/c)];case 180:return[1-t,1-e,i,r];case 270:return[1-e,t,i*(c/l),r*(l/c)];default:return[t,e,i,r]}}#d(){const{x:t,y:e,width:i,height:r,parentDimensions:[l,c],rotation:u}=this;switch(u){case 90:return[1-e,t,i*(l/c),r*(c/l)];case 180:return[1-t,1-e,i,r];case 270:return[e,1-t,i*(l/c),r*(c/l)];default:return[t,e,i,r]}}#h(t){[this.x,this.y,this.width,this.height]=this.#l(t),this.div&&(this.fixAndSetPosition(),this.setDims()),this._onResized()}#f(){const{x:t,y:e,width:i,height:r,rotation:l,parentRotation:c,parentDimensions:[u,d]}=this;switch((l*4+c)/90){case 1:return[1-e-r,t,r,i];case 2:return[1-t-i,1-e-r,i,r];case 3:return[e,1-t-i,r,i];case 4:return[t,e-i*(u/d),r*(d/u),i*(u/d)];case 5:return[1-e,t,i*(u/d),r*(d/u)];case 6:return[1-t-r*(d/u),1-e,r*(d/u),i*(u/d)];case 7:return[e-i*(u/d),1-t-r*(d/u),i*(u/d),r*(d/u)];case 8:return[t-i,e-r,i,r];case 9:return[1-e,t-i,r,i];case 10:return[1-t,1-e,i,r];case 11:return[e-r,1-t,r,i];case 12:return[t-r*(d/u),e,r*(d/u),i*(u/d)];case 13:return[1-e-i*(u/d),t-r*(d/u),i*(u/d),r*(d/u)];case 14:return[1-t,1-e-i*(u/d),r*(d/u),i*(u/d)];case 15:return[e,1-t,i*(u/d),r*(d/u)];default:return[t,e,i,r]}}rotate(){this.parent&&this.parent.drawLayer.updateProperties(this._drawId,_e._mergeSVGProperties({bbox:this.#f()},this.#t.updateRotation((this.parentRotation-this.rotation+360)%360)))}onScaleChanging(){this.parent&&this.#h(this.#t.updateParentDimensions(this.parentDimensions,this.parent.scale))}static onScaleChangingWhenDrawing(){}render(){if(this.div)return this.div;let t,e;this._isCopy&&(t=this.x,e=this.y);const i=super.render();i.classList.add("draw");const r=document.createElement("div");return i.append(r),r.setAttribute("aria-hidden","true"),r.className="internal",this.setDims(),this._uiManager.addShouldRescale(this),this.disableEditing(),this._isCopy&&this._moveAfterPaste(t,e),i}static createDrawerInstance(t,e,i,r,l){Me("Not implemented")}static startDrawing(t,e,i,r){const{target:l,offsetX:c,offsetY:u,pointerId:d,pointerType:f}=r;if(Te.isInitializedAndDifferentPointerType(f))return;const{viewport:{rotation:p}}=t,{width:y,height:w}=l.getBoundingClientRect(),A=_e.#n=new AbortController,_=t.combinedSignal(A);if(Te.setPointer(f,d),window.addEventListener("pointerup",S=>{Te.isSamePointerIdOrRemove(S.pointerId)&&this._endDraw(S)},{signal:_}),window.addEventListener("pointercancel",S=>{Te.isSamePointerIdOrRemove(S.pointerId)&&this._currentParent.endDrawingSession()},{signal:_}),window.addEventListener("pointerdown",S=>{Te.isSamePointerType(S.pointerType)&&(Te.initializeAndAddPointerId(S.pointerId),_e.#i.isCancellable()&&(_e.#i.removeLastElement(),_e.#i.isEmpty()?this._currentParent.endDrawingSession(!0):this._endDraw(null)))},{capture:!0,passive:!1,signal:_}),window.addEventListener("contextmenu",$i,{signal:_}),l.addEventListener("pointermove",this._drawMove.bind(this),{signal:_}),l.addEventListener("touchmove",S=>{Te.isSameTimeStamp(S.timeStamp)&&en(S)},{signal:_}),t.toggleDrawing(),e._editorUndoBar?.hide(),_e.#i){t.drawLayer.updateProperties(this._currentDrawId,_e.#i.startNew(c,u,y,w,p));return}e.updateUIForDefaultProperties(this),_e.#i=this.createDrawerInstance(c,u,y,w,p),_e.#s=this.getDefaultDrawingOptions(),this._currentParent=t,{id:this._currentDrawId}=t.drawLayer.draw(this._mergeSVGProperties(_e.#s.toSVGProperties(),_e.#i.defaultSVGProperties),!0,!1)}static _drawMove(t){if(Te.isSameTimeStamp(t.timeStamp),!_e.#i)return;const{offsetX:e,offsetY:i,pointerId:r}=t;if(Te.isSamePointerId(r)){if(Te.isUsingMultiplePointers()){this._endDraw(t);return}this._currentParent.drawLayer.updateProperties(this._currentDrawId,_e.#i.add(e,i)),Te.setTimeStamp(t.timeStamp),en(t)}}static _cleanup(t){t&&(this._currentDrawId=-1,this._currentParent=null,_e.#i=null,_e.#s=null,Te.clearTimeStamp()),_e.#n&&(_e.#n.abort(),_e.#n=null,Te.clearPointerIds())}static _endDraw(t){const e=this._currentParent;if(e){if(e.toggleDrawing(!0),this._cleanup(!1),t?.target===e.div&&e.drawLayer.updateProperties(this._currentDrawId,_e.#i.end(t.offsetX,t.offsetY)),this.supportMultipleDrawings){const i=_e.#i,r=this._currentDrawId,l=i.getLastElement();e.addCommands({cmd:()=>{e.drawLayer.updateProperties(r,i.setLastElement(l))},undo:()=>{e.drawLayer.updateProperties(r,i.removeLastElement())},mustExec:!1,type:be.DRAW_STEP});return}this.endDrawing(!1)}}static endDrawing(t){const e=this._currentParent;if(!e)return null;if(e.toggleDrawing(!0),e.cleanUndoStack(be.DRAW_STEP),!_e.#i.isEmpty()){const{pageDimensions:[i,r],scale:l}=e,c=e.createAndAddNewEditor({offsetX:0,offsetY:0},!1,{drawId:this._currentDrawId,drawOutlines:_e.#i.getOutlines(i*l,r*l,l,this._INNER_MARGIN),drawingOptions:_e.#s,mustBeCommitted:!t});return this._cleanup(!0),c}return e.drawLayer.remove(this._currentDrawId),this._cleanup(!0),null}createDrawingOptions(t){}static deserializeDraw(t,e,i,r,l,c){Me("Not implemented")}static async deserialize(t,e,i){const{rawDims:{pageWidth:r,pageHeight:l,pageX:c,pageY:u}}=e.viewport,d=this.deserializeDraw(c,u,r,l,this._INNER_MARGIN,t),f=await super.deserialize(t,e,i);return f.createDrawingOptions(t),f.#a({drawOutlines:d}),f.#c(),f.onScaleChanging(),f.rotate(),f}serializeDraw(t){const[e,i]=this.pageTranslation,[r,l]=this.pageDimensions;return this.#t.serialize([e,i,r,l],t)}renderAnnotationElement(t){return t.updateEdited({rect:this.getPDFRect()}),null}static canCreateNewEmptyEditor(){return!1}}class w2{#t=new Float64Array(6);#e;#i;#n;#s;#a;#r="";#o=0;#c=new Qc;#l;#d;constructor(t,e,i,r,l,c){this.#l=i,this.#d=r,this.#n=l,this.#s=c,[t,e]=this.#h(t,e);const u=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#a=[t,e],this.#i=[{line:u,points:this.#a}],this.#t.set(u,0)}updateProperty(t,e){t==="stroke-width"&&(this.#s=e)}#h(t,e){return Gt._normalizePoint(t,e,this.#l,this.#d,this.#n)}isEmpty(){return!this.#i||this.#i.length===0}isCancellable(){return this.#a.length<=10}add(t,e){[t,e]=this.#h(t,e);const[i,r,l,c]=this.#t.subarray(2,6),u=t-l,d=e-c;return Math.hypot(this.#l*u,this.#d*d)<=2?null:(this.#a.push(t,e),isNaN(i)?(this.#t.set([l,c,t,e],2),this.#e.push(NaN,NaN,NaN,NaN,t,e),{path:{d:this.toSVGPath()}}):(isNaN(this.#t[0])&&this.#e.splice(6,6),this.#t.set([i,r,l,c,t,e],0),this.#e.push(...Gt.createBezierPoints(i,r,l,c,t,e)),{path:{d:this.toSVGPath()}}))}end(t,e){const i=this.add(t,e);return i||(this.#a.length===2?{path:{d:this.toSVGPath()}}:null)}startNew(t,e,i,r,l){this.#l=i,this.#d=r,this.#n=l,[t,e]=this.#h(t,e);const c=this.#e=[NaN,NaN,NaN,NaN,t,e];this.#a=[t,e];const u=this.#i.at(-1);return u&&(u.line=new Float32Array(u.line),u.points=new Float32Array(u.points)),this.#i.push({line:c,points:this.#a}),this.#t.set(c,0),this.#o=0,this.toSVGPath(),null}getLastElement(){return this.#i.at(-1)}setLastElement(t){return this.#i?(this.#i.push(t),this.#e=t.line,this.#a=t.points,this.#o=0,{path:{d:this.toSVGPath()}}):this.#c.setLastElement(t)}removeLastElement(){if(!this.#i)return this.#c.removeLastElement();this.#i.pop(),this.#r="";for(let t=0,e=this.#i.length;t<e;t++){const{line:i,points:r}=this.#i[t];this.#e=i,this.#a=r,this.#o=0,this.toSVGPath()}return{path:{d:this.#r}}}toSVGPath(){const t=Gt.svgRound(this.#e[4]),e=Gt.svgRound(this.#e[5]);if(this.#a.length===2)return this.#r=`${this.#r} M ${t} ${e} Z`,this.#r;if(this.#a.length<=6){const r=this.#r.lastIndexOf("M");this.#r=`${this.#r.slice(0,r)} M ${t} ${e}`,this.#o=6}if(this.#a.length===4){const r=Gt.svgRound(this.#e[10]),l=Gt.svgRound(this.#e[11]);return this.#r=`${this.#r} L ${r} ${l}`,this.#o=12,this.#r}const i=[];this.#o===0&&(i.push(`M ${t} ${e}`),this.#o=6);for(let r=this.#o,l=this.#e.length;r<l;r+=6){const[c,u,d,f,p,y]=this.#e.slice(r,r+6).map(Gt.svgRound);i.push(`C${c} ${u} ${d} ${f} ${p} ${y}`)}return this.#r+=i.join(" "),this.#o=this.#e.length,this.#r}getOutlines(t,e,i,r){const l=this.#i.at(-1);return l.line=new Float32Array(l.line),l.points=new Float32Array(l.points),this.#c.build(this.#i,t,e,i,this.#n,this.#s,r),this.#t=null,this.#e=null,this.#i=null,this.#r=null,this.#c}get defaultSVGProperties(){return{root:{viewBox:"0 0 10000 10000"},rootClass:{draw:!0},bbox:[0,0,1,1]}}}class Qc extends Gt{#t;#e=0;#i;#n;#s;#a;#r;#o;#c;build(t,e,i,r,l,c,u){this.#s=e,this.#a=i,this.#r=r,this.#o=l,this.#c=c,this.#i=u??0,this.#n=t,this.#h()}get thickness(){return this.#c}setLastElement(t){return this.#n.push(t),{path:{d:this.toSVGPath()}}}removeLastElement(){return this.#n.pop(),{path:{d:this.toSVGPath()}}}toSVGPath(){const t=[];for(const{line:e}of this.#n){if(t.push(`M${Gt.svgRound(e[4])} ${Gt.svgRound(e[5])}`),e.length===6){t.push("Z");continue}if(e.length===12&&isNaN(e[6])){t.push(`L${Gt.svgRound(e[10])} ${Gt.svgRound(e[11])}`);continue}for(let i=6,r=e.length;i<r;i+=6){const[l,c,u,d,f,p]=e.subarray(i,i+6).map(Gt.svgRound);t.push(`C${l} ${c} ${u} ${d} ${f} ${p}`)}}return t.join("")}serialize([t,e,i,r],l){const c=[],u=[],[d,f,p,y]=this.#d();let w,A,_,S,C,M,k,L,j;switch(this.#o){case 0:j=Gt._rescale,w=t,A=e+r,_=i,S=-r,C=t+d*i,M=e+(1-f-y)*r,k=t+(d+p)*i,L=e+(1-f)*r;break;case 90:j=Gt._rescaleAndSwap,w=t,A=e,_=i,S=r,C=t+f*i,M=e+d*r,k=t+(f+y)*i,L=e+(d+p)*r;break;case 180:j=Gt._rescale,w=t+i,A=e,_=-i,S=r,C=t+(1-d-p)*i,M=e+f*r,k=t+(1-d)*i,L=e+(f+y)*r;break;case 270:j=Gt._rescaleAndSwap,w=t+i,A=e+r,_=-i,S=-r,C=t+(1-f-y)*i,M=e+(1-d-p)*r,k=t+(1-f)*i,L=e+(1-d)*r;break}for(const{line:F,points:z}of this.#n)c.push(j(F,w,A,_,S,l?new Array(F.length):null)),u.push(j(z,w,A,_,S,l?new Array(z.length):null));return{lines:c,points:u,rect:[C,M,k,L]}}static deserialize(t,e,i,r,l,{paths:{lines:c,points:u},rotation:d,thickness:f}){const p=[];let y,w,A,_,S;switch(d){case 0:S=Gt._rescale,y=-t/i,w=e/r+1,A=1/i,_=-1/r;break;case 90:S=Gt._rescaleAndSwap,y=-e/r,w=-t/i,A=1/r,_=1/i;break;case 180:S=Gt._rescale,y=t/i+1,w=-e/r,A=-1/i,_=1/r;break;case 270:S=Gt._rescaleAndSwap,y=e/r+1,w=t/i+1,A=-1/r,_=-1/i;break}if(!c){c=[];for(const M of u){const k=M.length;if(k===2){c.push(new Float32Array([NaN,NaN,NaN,NaN,M[0],M[1]]));continue}if(k===4){c.push(new Float32Array([NaN,NaN,NaN,NaN,M[0],M[1],NaN,NaN,NaN,NaN,M[2],M[3]]));continue}const L=new Float32Array(3*(k-2));c.push(L);let[j,F,z,H]=M.subarray(0,4);L.set([NaN,NaN,NaN,NaN,j,F],0);for(let ut=4;ut<k;ut+=2){const ft=M[ut],_t=M[ut+1];L.set(Gt.createBezierPoints(j,F,z,H,ft,_t),(ut-2)*3),[j,F,z,H]=[z,H,ft,_t]}}}for(let M=0,k=c.length;M<k;M++)p.push({line:S(c[M].map(L=>L??NaN),y,w,A,_),points:S(u[M].map(L=>L??NaN),y,w,A,_)});const C=new this.prototype.constructor;return C.build(p,i,r,1,d,f,l),C}#l(t=this.#c){const e=this.#i+t/2*this.#r;return this.#o%180===0?[e/this.#s,e/this.#a]:[e/this.#a,e/this.#s]}#d(){const[t,e,i,r]=this.#t,[l,c]=this.#l(0);return[t+l,e+c,i-2*l,r-2*c]}#h(){const t=this.#t=new Float32Array([1/0,1/0,-1/0,-1/0]);for(const{line:r}of this.#n){if(r.length<=12){for(let u=4,d=r.length;u<d;u+=6)qt.pointBoundingBox(r[u],r[u+1],t);continue}let l=r[4],c=r[5];for(let u=6,d=r.length;u<d;u+=6){const[f,p,y,w,A,_]=r.subarray(u,u+6);qt.bezierBoundingBox(l,c,f,p,y,w,A,_,t),l=A,c=_}}const[e,i]=this.#l();t[0]=Fn(t[0]-e,0,1),t[1]=Fn(t[1]-i,0,1),t[2]=Fn(t[2]+e,0,1),t[3]=Fn(t[3]+i,0,1),t[2]-=t[0],t[3]-=t[1]}get box(){return this.#t}updateProperty(t,e){return t==="stroke-width"?this.#f(e):null}#f(t){const[e,i]=this.#l();this.#c=t;const[r,l]=this.#l(),[c,u]=[r-e,l-i],d=this.#t;return d[0]-=c,d[1]-=u,d[2]+=2*c,d[3]+=2*u,d}updateParentDimensions([t,e],i){const[r,l]=this.#l();this.#s=t,this.#a=e,this.#r=i;const[c,u]=this.#l(),d=c-r,f=u-l,p=this.#t;return p[0]-=d,p[1]-=f,p[2]+=2*d,p[3]+=2*f,p}updateRotation(t){return this.#e=t,{path:{transform:this.rotationTransform}}}get viewBox(){return this.#t.map(Gt.svgRound).join(" ")}get defaultProperties(){const[t,e]=this.#t;return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get rotationTransform(){const[,,t,e]=this.#t;let i=0,r=0,l=0,c=0,u=0,d=0;switch(this.#e){case 90:r=e/t,l=-t/e,u=t;break;case 180:i=-1,c=-1,u=t,d=e;break;case 270:r=-e/t,l=t/e,d=e;break;default:return""}return`matrix(${i} ${r} ${l} ${c} ${Gt.svgRound(u)} ${Gt.svgRound(d)})`}getPathResizingSVGProperties([t,e,i,r]){const[l,c]=this.#l(),[u,d,f,p]=this.#t;if(Math.abs(f-l)<=Gt.PRECISION||Math.abs(p-c)<=Gt.PRECISION){const S=t+i/2-(u+f/2),C=e+r/2-(d+p/2);return{path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:`${this.rotationTransform} translate(${S} ${C})`}}}const y=(i-2*l)/(f-2*l),w=(r-2*c)/(p-2*c),A=f/i,_=p/r;return{path:{"transform-origin":`${Gt.svgRound(u)} ${Gt.svgRound(d)}`,transform:`${this.rotationTransform} scale(${A} ${_}) translate(${Gt.svgRound(l)} ${Gt.svgRound(c)}) scale(${y} ${w}) translate(${Gt.svgRound(-l)} ${Gt.svgRound(-c)})`}}}getPathResizedSVGProperties([t,e,i,r]){const[l,c]=this.#l(),u=this.#t,[d,f,p,y]=u;if(u[0]=t,u[1]=e,u[2]=i,u[3]=r,Math.abs(p-l)<=Gt.PRECISION||Math.abs(y-c)<=Gt.PRECISION){const C=t+i/2-(d+p/2),M=e+r/2-(f+y/2);for(const{line:k,points:L}of this.#n)Gt._translate(k,C,M,k),Gt._translate(L,C,M,L);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}const w=(i-2*l)/(p-2*l),A=(r-2*c)/(y-2*c),_=-w*(d+l)+t+l,S=-A*(f+c)+e+c;if(w!==1||A!==1||_!==0||S!==0)for(const{line:C,points:M}of this.#n)Gt._rescale(C,_,S,w,A,C),Gt._rescale(M,_,S,w,A,M);return{root:{viewBox:this.viewBox},path:{"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`,transform:this.rotationTransform||null,d:this.toSVGPath()}}}getPathTranslatedSVGProperties([t,e],i){const[r,l]=i,c=this.#t,u=t-c[0],d=e-c[1];if(this.#s===r&&this.#a===l)for(const{line:f,points:p}of this.#n)Gt._translate(f,u,d,f),Gt._translate(p,u,d,p);else{const f=this.#s/r,p=this.#a/l;this.#s=r,this.#a=l;for(const{line:y,points:w}of this.#n)Gt._rescale(y,u,d,f,p,y),Gt._rescale(w,u,d,f,p,w);c[2]*=f,c[3]*=p}return c[0]=t,c[1]=e,{root:{viewBox:this.viewBox},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t)} ${Gt.svgRound(e)}`}}}get defaultSVGProperties(){const t=this.#t;return{root:{viewBox:this.viewBox},rootClass:{draw:!0},path:{d:this.toSVGPath(),"transform-origin":`${Gt.svgRound(t[0])} ${Gt.svgRound(t[1])}`,transform:this.rotationTransform||null},bbox:t}}}class dd extends r1{constructor(t){super(),this._viewParameters=t,super.updateProperties({fill:"none",stroke:Zt._defaultLineColor,"stroke-opacity":1,"stroke-width":1,"stroke-linecap":"round","stroke-linejoin":"round","stroke-miterlimit":10})}updateSVGProperty(t,e){t==="stroke-width"&&(e??=this["stroke-width"],e*=this._viewParameters.realScale),super.updateSVGProperty(t,e)}clone(){const t=new dd(this._viewParameters);return t.updateAll(this),t}}class Gm extends _e{static _type="ink";static _editorType=ae.INK;static _defaultDrawingOptions=null;constructor(t){super({...t,name:"inkEditor"}),this._willKeepAspectRatio=!0,this.defaultL10nId="pdfjs-editor-ink-editor"}static initialize(t,e){Zt.initialize(t,e),this._defaultDrawingOptions=new dd(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!0}static get typesMap(){return ie(this,"typesMap",new Map([[be.INK_THICKNESS,"stroke-width"],[be.INK_COLOR,"stroke"],[be.INK_OPACITY,"stroke-opacity"]]))}static createDrawerInstance(t,e,i,r,l){return new w2(t,e,i,r,l,this._defaultDrawingOptions["stroke-width"])}static deserializeDraw(t,e,i,r,l,c){return Qc.deserialize(t,e,i,r,l,c)}static async deserialize(t,e,i){let r=null;if(t instanceof Hm){const{data:{inkLists:c,rect:u,rotation:d,id:f,color:p,opacity:y,borderStyle:{rawWidth:w},popupRef:A,richText:_,contentsObj:S,creationDate:C,modificationDate:M},parent:{page:{pageNumber:k}}}=t;r=t={annotationType:ae.INK,color:Array.from(p),thickness:w,opacity:y,paths:{points:c},boxes:null,pageIndex:k-1,rect:u.slice(0),rotation:d,annotationElementId:f,id:f,deleted:!1,popupRef:A,richText:_,comment:S?.str||null,creationDate:C,modificationDate:M}}const l=await super.deserialize(t,e,i);return l._initialData=r,t.comment&&l.setCommentData(t),l}get toolbarButtons(){return this._colorPicker||=new Fc(this),[["colorPicker",this._colorPicker]]}get colorType(){return be.INK_COLOR}get color(){return this._drawingOptions.stroke}get opacity(){return this._drawingOptions["stroke-opacity"]}onScaleChanging(){if(!this.parent)return;super.onScaleChanging();const{_drawId:t,_drawingOptions:e,parent:i}=this;e.updateSVGProperty("stroke-width"),i.drawLayer.updateProperties(t,e.toSVGProperties())}static onScaleChangingWhenDrawing(){const t=this._currentParent;t&&(super.onScaleChangingWhenDrawing(),this._defaultDrawingOptions.updateSVGProperty("stroke-width"),t.drawLayer.updateProperties(this._currentDrawId,this._defaultDrawingOptions.toSVGProperties()))}createDrawingOptions({color:t,thickness:e,opacity:i}){this._drawingOptions=Gm.getDefaultDrawingOptions({stroke:qt.makeHexColor(...t),"stroke-width":e,"stroke-opacity":i})}serialize(t=!1){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{stroke:r,"stroke-opacity":l,"stroke-width":c}}=this,u=Object.assign(super.serialize(t),{color:Zt._colorManager.convert(r),opacity:l,thickness:c,paths:{lines:e,points:i}});return this.addComment(u),t?(u.isCopy=!0,u):this.annotationElementId&&!this.#t(u)?null:(u.id=this.annotationElementId,u)}#t(t){const{color:e,thickness:i,opacity:r,pageIndex:l}=this._initialData;return this.hasEditedComment||this._hasBeenMoved||this._hasBeenResized||t.color.some((c,u)=>c!==e[u])||t.thickness!==i||t.opacity!==r||t.pageIndex!==l}renderAnnotationElement(t){if(this.deleted)return t.hide(),null;const{points:e,rect:i}=this.serializeDraw(!1);return t.updateEdited({rect:i,thickness:this._drawingOptions["stroke-width"],points:e,popup:this.comment}),null}}class om extends Qc{toSVGPath(){let t=super.toSVGPath();return t.endsWith("Z")||(t+="Z"),t}}const Eh=8,Cc=3;class Zo{static#t={maxDim:512,sigmaSFactor:.02,sigmaR:25,kernelSize:16};static#e(t,e,i,r){return i-=t,r-=e,i===0?r>0?0:4:i===1?r+6:2-r}static#i=new Int32Array([0,1,-1,1,-1,0,-1,-1,0,-1,1,-1,1,0,1,1]);static#n(t,e,i,r,l,c,u){const d=this.#e(i,r,l,c);for(let f=0;f<8;f++){const p=(-f+d-u+16)%8,y=this.#i[2*p],w=this.#i[2*p+1];if(t[(i+y)*e+(r+w)]!==0)return p}return-1}static#s(t,e,i,r,l,c,u){const d=this.#e(i,r,l,c);for(let f=0;f<8;f++){const p=(f+d+u+16)%8,y=this.#i[2*p],w=this.#i[2*p+1];if(t[(i+y)*e+(r+w)]!==0)return p}return-1}static#a(t,e,i,r){const l=t.length,c=new Int32Array(l);for(let p=0;p<l;p++)c[p]=t[p]<=r?1:0;for(let p=1;p<i-1;p++)c[p*e]=c[p*e+e-1]=0;for(let p=0;p<e;p++)c[p]=c[e*i-1-p]=0;let u=1,d;const f=[];for(let p=1;p<i-1;p++){d=1;for(let y=1;y<e-1;y++){const w=p*e+y,A=c[w];if(A===0)continue;let _=p,S=y;if(A===1&&c[w-1]===0)u+=1,S-=1;else if(A>=1&&c[w+1]===0)u+=1,S+=1,A>1&&(d=A);else{A!==1&&(d=Math.abs(A));continue}const C=[y,p],M=S===y+1,k={isHole:M,points:C,id:u,parent:0};f.push(k);let L;for(const ct of f)if(ct.id===d){L=ct;break}L?L.isHole?k.parent=M?L.parent:d:k.parent=M?d:L.parent:k.parent=M?d:0;const j=this.#n(c,e,p,y,_,S,0);if(j===-1){c[w]=-u,c[w]!==1&&(d=Math.abs(c[w]));continue}let F=this.#i[2*j],z=this.#i[2*j+1];const H=p+F,ut=y+z;_=H,S=ut;let ft=p,_t=y;for(;;){const ct=this.#s(c,e,ft,_t,_,S,1);F=this.#i[2*ct],z=this.#i[2*ct+1];const Tt=ft+F,Lt=_t+z;C.push(Lt,Tt);const Bt=ft*e+_t;if(c[Bt+1]===0?c[Bt]=-u:c[Bt]===1&&(c[Bt]=u),Tt===p&&Lt===y&&ft===H&&_t===ut){c[w]!==1&&(d=Math.abs(c[w]));break}else _=ft,S=_t,ft=Tt,_t=Lt}}}return f}static#r(t,e,i,r){if(i-e<=4){for(let H=e;H<i-2;H+=2)r.push(t[H],t[H+1]);return}const l=t[e],c=t[e+1],u=t[i-4]-l,d=t[i-3]-c,f=Math.hypot(u,d),p=u/f,y=d/f,w=p*c-y*l,A=d/u,_=1/f,S=Math.atan(A),C=Math.cos(S),M=Math.sin(S),k=_*(Math.abs(C)+Math.abs(M)),L=_*(1-k+k**2),j=Math.max(Math.atan(Math.abs(M+C)*L),Math.atan(Math.abs(M-C)*L));let F=0,z=e;for(let H=e+2;H<i-2;H+=2){const ut=Math.abs(w-p*t[H+1]+y*t[H]);ut>F&&(z=H,F=ut)}F>(f*j)**2?(this.#r(t,e,z+2,r),this.#r(t,z,i,r)):r.push(l,c)}static#o(t){const e=[],i=t.length;return this.#r(t,0,i,e),e.push(t[i-2],t[i-1]),e.length<=4?null:e}static#c(t,e,i,r,l,c){const u=new Float32Array(c**2),d=-2*r**2,f=c>>1;for(let S=0;S<c;S++){const C=(S-f)**2;for(let M=0;M<c;M++)u[S*c+M]=Math.exp((C+(M-f)**2)/d)}const p=new Float32Array(256),y=-2*l**2;for(let S=0;S<256;S++)p[S]=Math.exp(S**2/y);const w=t.length,A=new Uint8Array(w),_=new Uint32Array(256);for(let S=0;S<i;S++)for(let C=0;C<e;C++){const M=S*e+C,k=t[M];let L=0,j=0;for(let z=0;z<c;z++){const H=S+z-f;if(!(H<0||H>=i))for(let ut=0;ut<c;ut++){const ft=C+ut-f;if(ft<0||ft>=e)continue;const _t=t[H*e+ft],ct=u[z*c+ut]*p[Math.abs(_t-k)];L+=_t*ct,j+=ct}}const F=A[M]=Math.round(L/j);_[F]++}return[A,_]}static#l(t){const e=new Uint32Array(256);for(const i of t)e[i]++;return e}static#d(t){const e=t.length,i=new Uint8ClampedArray(e>>2);let r=-1/0,l=1/0;for(let u=0,d=i.length;u<d;u++){const f=i[u]=t[u<<2];r=Math.max(r,f),l=Math.min(l,f)}const c=255/(r-l);for(let u=0,d=i.length;u<d;u++)i[u]=(i[u]-l)*c;return i}static#h(t){let e,i=-1/0,r=-1/0;const l=t.findIndex(d=>d!==0);let c=l,u=l;for(e=l;e<256;e++){const d=t[e];d>i&&(e-c>r&&(r=e-c,u=e-1),i=d,c=e)}for(e=u-1;e>=0&&!(t[e]>t[e+1]);e--);return e}static#f(t){const e=t,{width:i,height:r}=t,{maxDim:l}=this.#t;let c=i,u=r;if(i>l||r>l){let w=i,A=r,_=Math.log2(Math.max(i,r)/l);const S=Math.floor(_);_=_===S?S-1:S;for(let M=0;M<_;M++){c=Math.ceil(w/2),u=Math.ceil(A/2);const k=new OffscreenCanvas(c,u);k.getContext("2d").drawImage(t,0,0,w,A,0,0,c,u),w=c,A=u,t!==e&&t.close(),t=k.transferToImageBitmap()}const C=Math.min(l/c,l/u);c=Math.round(c*C),u=Math.round(u*C)}const f=new OffscreenCanvas(c,u).getContext("2d",{willReadFrequently:!0});f.fillStyle="white",f.fillRect(0,0,c,u),f.filter="grayscale(1)",f.drawImage(t,0,0,t.width,t.height,0,0,c,u);const p=f.getImageData(0,0,c,u).data;return[this.#d(p),c,u]}static extractContoursFromText(t,{fontFamily:e,fontStyle:i,fontWeight:r},l,c,u,d){let f=new OffscreenCanvas(1,1),p=f.getContext("2d",{alpha:!1});const y=200,w=p.font=`${i} ${r} ${y}px ${e}`,{actualBoundingBoxLeft:A,actualBoundingBoxRight:_,actualBoundingBoxAscent:S,actualBoundingBoxDescent:C,fontBoundingBoxAscent:M,fontBoundingBoxDescent:k,width:L}=p.measureText(t),j=1.5,F=Math.ceil(Math.max(Math.abs(A)+Math.abs(_)||0,L)*j),z=Math.ceil(Math.max(Math.abs(S)+Math.abs(C)||y,Math.abs(M)+Math.abs(k)||y)*j);f=new OffscreenCanvas(F,z),p=f.getContext("2d",{alpha:!0,willReadFrequently:!0}),p.font=w,p.filter="grayscale(1)",p.fillStyle="white",p.fillRect(0,0,F,z),p.fillStyle="black",p.fillText(t,F*(j-1)/2,z*(3-j)/2);const H=this.#d(p.getImageData(0,0,F,z).data),ut=this.#l(H),ft=this.#h(ut),_t=this.#a(H,F,z,ft);return this.processDrawnLines({lines:{curves:_t,width:F,height:z},pageWidth:l,pageHeight:c,rotation:u,innerMargin:d,mustSmooth:!0,areContours:!0})}static process(t,e,i,r,l){const[c,u,d]=this.#f(t),[f,p]=this.#c(c,u,d,Math.hypot(u,d)*this.#t.sigmaSFactor,this.#t.sigmaR,this.#t.kernelSize),y=this.#h(p),w=this.#a(f,u,d,y);return this.processDrawnLines({lines:{curves:w,width:u,height:d},pageWidth:e,pageHeight:i,rotation:r,innerMargin:l,mustSmooth:!0,areContours:!0})}static processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:l,mustSmooth:c,areContours:u}){r%180!==0&&([e,i]=[i,e]);const{curves:d,width:f,height:p}=t,y=t.thickness??0,w=[],A=Math.min(e/f,i/p),_=A/e,S=A/i,C=[];for(const{points:k}of d){const L=c?this.#o(k):k;if(!L)continue;C.push(L);const j=L.length,F=new Float32Array(j),z=new Float32Array(3*(j===2?2:j-2));if(w.push({line:z,points:F}),j===2){F[0]=L[0]*_,F[1]=L[1]*S,z.set([NaN,NaN,NaN,NaN,F[0],F[1]],0);continue}let[H,ut,ft,_t]=L;H*=_,ut*=S,ft*=_,_t*=S,F.set([H,ut,ft,_t],0),z.set([NaN,NaN,NaN,NaN,H,ut],0);for(let ct=4;ct<j;ct+=2){const Tt=F[ct]=L[ct]*_,Lt=F[ct+1]=L[ct+1]*S;z.set(Gt.createBezierPoints(H,ut,ft,_t,Tt,Lt),(ct-2)*3),[H,ut,ft,_t]=[ft,_t,Tt,Lt]}}if(w.length===0)return null;const M=u?new om:new Qc;return M.build(w,e,i,1,r,u?0:y,l),{outline:M,newCurves:C,areContours:u,thickness:y,width:f,height:p}}static async compressSignature({outlines:t,areContours:e,thickness:i,width:r,height:l}){let c=1/0,u=-1/0,d=0;for(const L of t){d+=L.length;for(let j=2,F=L.length;j<F;j++){const z=L[j]-L[j-2];c=Math.min(c,z),u=Math.max(u,z)}}let f;c>=-128&&u<=127?f=Int8Array:c>=-32768&&u<=32767?f=Int16Array:f=Int32Array;const p=t.length,y=Eh+Cc*p,w=new Uint32Array(y);let A=0;w[A++]=y*Uint32Array.BYTES_PER_ELEMENT+(d-2*p)*f.BYTES_PER_ELEMENT,w[A++]=0,w[A++]=r,w[A++]=l,w[A++]=e?0:1,w[A++]=Math.max(0,Math.floor(i??0)),w[A++]=p,w[A++]=f.BYTES_PER_ELEMENT;for(const L of t)w[A++]=L.length-2,w[A++]=L[0],w[A++]=L[1];const _=new CompressionStream("deflate-raw"),S=_.writable.getWriter();await S.ready,S.write(w);const C=f.prototype.constructor;for(const L of t){const j=new C(L.length-2);for(let F=2,z=L.length;F<z;F++)j[F-2]=L[F]-L[F-2];S.write(j)}S.close();const M=await new Response(_.readable).arrayBuffer();return new Uint8Array(M).toBase64()}static async decompressSignature(t){try{const e=Uint8Array.fromBase64(t),{readable:i,writable:r}=new DecompressionStream("deflate-raw"),l=r.getWriter();await l.ready,l.write(e).then(async()=>{await l.ready,await l.close()}).catch(()=>{});let c=null,u=0;for await(const L of i)c||=new Uint8Array(new Uint32Array(L.buffer,0,4)[0]),c.set(L,u),u+=L.length;const d=new Uint32Array(c.buffer,0,c.length>>2),f=d[1];if(f!==0)throw new Error(`Invalid version: ${f}`);const p=d[2],y=d[3],w=d[4]===0,A=d[5],_=d[6],S=d[7],C=[],M=(Eh+Cc*_)*Uint32Array.BYTES_PER_ELEMENT;let k;switch(S){case Int8Array.BYTES_PER_ELEMENT:k=new Int8Array(c.buffer,M);break;case Int16Array.BYTES_PER_ELEMENT:k=new Int16Array(c.buffer,M);break;case Int32Array.BYTES_PER_ELEMENT:k=new Int32Array(c.buffer,M);break}u=0;for(let L=0;L<_;L++){const j=d[Cc*L+Eh],F=new Float32Array(j+2);C.push(F);for(let z=0;z<Cc-1;z++)F[z]=d[Cc*L+Eh+z+1];for(let z=0;z<j;z++)F[z+2]=F[z]+k[u++]}return{areContours:w,thickness:A,outlines:C,width:p,height:y}}catch(e){return ne(`decompressSignature: ${e}`),null}}}class $m extends r1{constructor(){super(),super.updateProperties({fill:Zt._defaultLineColor,"stroke-width":0})}clone(){const t=new $m;return t.updateAll(this),t}}class Vm extends dd{constructor(t){super(t),super.updateProperties({stroke:Zt._defaultLineColor,"stroke-width":1})}clone(){const t=new Vm(this._viewParameters);return t.updateAll(this),t}}class Ss extends _e{#t=!1;#e=null;#i=null;#n=null;static _type="signature";static _editorType=ae.SIGNATURE;static _defaultDrawingOptions=null;constructor(t){super({...t,mustBeCommitted:!0,name:"signatureEditor"}),this._willKeepAspectRatio=!0,this.#i=t.signatureData||null,this.#e=null,this.defaultL10nId="pdfjs-editor-signature-editor1"}static initialize(t,e){Zt.initialize(t,e),this._defaultDrawingOptions=new $m,this._defaultDrawnSignatureOptions=new Vm(e.viewParameters)}static getDefaultDrawingOptions(t){const e=this._defaultDrawingOptions.clone();return e.updateProperties(t),e}static get supportMultipleDrawings(){return!1}static get typesMap(){return ie(this,"typesMap",new Map)}static get isDrawer(){return!1}get telemetryFinalData(){return{type:"signature",hasDescription:!!this.#e}}static computeTelemetryFinalData(t){const e=t.get("hasDescription");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}get isResizable(){return!0}onScaleChanging(){this._drawId!==null&&super.onScaleChanging()}render(){if(this.div)return this.div;let t,e;const{_isCopy:i}=this;if(i&&(this._isCopy=!1,t=this.x,e=this.y),super.render(),this._drawId===null)if(this.#i){const{lines:r,mustSmooth:l,areContours:c,description:u,uuid:d,heightInPage:f}=this.#i,{rawDims:{pageWidth:p,pageHeight:y},rotation:w}=this.parent.viewport,A=Zo.processDrawnLines({lines:r,pageWidth:p,pageHeight:y,rotation:w,innerMargin:Ss._INNER_MARGIN,mustSmooth:l,areContours:c});this.addSignature(A,f,u,d)}else this.div.setAttribute("data-l10n-args",JSON.stringify({description:""})),this.div.hidden=!0,this._uiManager.getSignature(this);else this.div.setAttribute("data-l10n-args",JSON.stringify({description:this.#e||""}));return i&&(this._isCopy=!0,this._moveAfterPaste(t,e)),this.div}setUuid(t){this.#n=t,this.addEditToolbar()}getUuid(){return this.#n}get description(){return this.#e}set description(t){this.#e=t,this.div&&(this.div.setAttribute("data-l10n-args",JSON.stringify({description:t})),super.addEditToolbar().then(e=>{e?.updateEditSignatureButton(t)}))}getSignaturePreview(){const{newCurves:t,areContours:e,thickness:i,width:r,height:l}=this.#i,c=Math.max(r,l),u=Zo.processDrawnLines({lines:{curves:t.map(d=>({points:d})),thickness:i,width:r,height:l},pageWidth:c,pageHeight:c,rotation:0,innerMargin:0,mustSmooth:!1,areContours:e});return{areContours:e,outline:u.outline}}get toolbarButtons(){return this._uiManager.signatureManager?[["editSignature",this._uiManager.signatureManager]]:super.toolbarButtons}addSignature(t,e,i,r){const{x:l,y:c}=this,{outline:u}=this.#i=t;this.#t=u instanceof om,this.description=i;let d;this.#t?d=Ss.getDefaultDrawingOptions():(d=Ss._defaultDrawnSignatureOptions.clone(),d.updateProperties({"stroke-width":u.thickness})),this._addOutlines({drawOutlines:u,drawingOptions:d});const[,f]=this.pageDimensions;let p=e/f;p=p>=1?.5:p,this.width*=p/this.height,this.width>=1&&(p*=.9/this.width,this.width=.9),this.height=p,this.setDims(),this.x=l,this.y=c,this.center(),this._onResized(),this.onScaleChanging(),this.rotate(),this._uiManager.addToAnnotationStorage(this),this.setUuid(r),this._reportTelemetry({action:"pdfjs.signature.inserted",data:{hasBeenSaved:!!r,hasDescription:!!i}}),this.div.hidden=!1}getFromImage(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return Zo.process(t,e,i,r,Ss._INNER_MARGIN)}getFromText(t,e){const{rawDims:{pageWidth:i,pageHeight:r},rotation:l}=this.parent.viewport;return Zo.extractContoursFromText(t,e,i,r,l,Ss._INNER_MARGIN)}getDrawnSignature(t){const{rawDims:{pageWidth:e,pageHeight:i},rotation:r}=this.parent.viewport;return Zo.processDrawnLines({lines:t,pageWidth:e,pageHeight:i,rotation:r,innerMargin:Ss._INNER_MARGIN,mustSmooth:!1,areContours:!1})}createDrawingOptions({areContours:t,thickness:e}){t?this._drawingOptions=Ss.getDefaultDrawingOptions():(this._drawingOptions=Ss._defaultDrawnSignatureOptions.clone(),this._drawingOptions.updateProperties({"stroke-width":e}))}serialize(t=!1){if(this.isEmpty())return null;const{lines:e,points:i}=this.serializeDraw(t),{_drawingOptions:{"stroke-width":r}}=this,l=Object.assign(super.serialize(t),{isSignature:!0,areContours:this.#t,color:[0,0,0],thickness:this.#t?0:r});return this.addComment(l),t?(l.paths={lines:e,points:i},l.uuid=this.#n,l.isCopy=!0):l.lines=e,this.#e&&(l.accessibilityData={type:"Figure",alt:this.#e}),l}static deserializeDraw(t,e,i,r,l,c){return c.areContours?om.deserialize(t,e,i,r,l,c):Qc.deserialize(t,e,i,r,l,c)}static async deserialize(t,e,i){const r=await super.deserialize(t,e,i);return r.#t=t.areContours,r.description=t.accessibilityData?.alt||"",r.#n=t.uuid,r}}class x2 extends Zt{#t=null;#e=null;#i=null;#n=null;#s=null;#a="";#r=null;#o=!1;#c=null;#l=!1;#d=!1;static _type="stamp";static _editorType=ae.STAMP;constructor(t){super({...t,name:"stampEditor"}),this.#n=t.bitmapUrl,this.#s=t.bitmapFile,this.defaultL10nId="pdfjs-editor-stamp-editor"}static initialize(t,e){Zt.initialize(t,e)}static isHandlingMimeForPasting(t){return Zp.includes(t)}static paste(t,e){e.pasteEditor({mode:ae.STAMP},{bitmapFile:t.getAsFile()})}altTextFinish(){this._uiManager.useNewAltTextFlow&&(this.div.hidden=!1),super.altTextFinish()}get telemetryFinalData(){return{type:"stamp",hasAltText:!!this.altTextData?.altText}}static computeTelemetryFinalData(t){const e=t.get("hasAltText");return{hasAltText:e.get(!0)??0,hasNoAltText:e.get(!1)??0}}#h(t,e=!1){if(!t){this.remove();return}this.#t=t.bitmap,e||(this.#e=t.id,this.#l=t.isSvg),t.file&&(this.#a=t.file.name),this.#m()}#f(){if(this.#i=null,this._uiManager.enableWaiting(!1),!!this.#r){if(this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this.addEditToolbar().then(()=>{this._editToolbar.hide(),this._uiManager.editAltText(this,!0)});return}if(!this._uiManager.useNewAltTextWhenAddingImage&&this._uiManager.useNewAltTextFlow&&this.#t){this._reportTelemetry({action:"pdfjs.image.image_added",data:{alt_text_modal:!1,alt_text_type:"empty"}});try{this.mlGuessAltText()}catch{}}this.div.focus()}}async mlGuessAltText(t=null,e=!0){if(this.hasAltTextData())return null;const{mlManager:i}=this._uiManager;if(!i)throw new Error("No ML.");if(!await i.isEnabledFor("altText"))throw new Error("ML isn't enabled for alt text.");const{data:r,width:l,height:c}=t||this.copyCanvas(null,null,!0).imageData,u=await i.guess({name:"altText",request:{data:r,width:l,height:c,channels:r.length/(l*c)}});if(!u)throw new Error("No response from the AI service.");if(u.error)throw new Error("Error from the AI service.");if(u.cancel)return null;if(!u.output)throw new Error("No valid response from the AI service.");const d=u.output;return await this.setGuessedAltText(d),e&&!this.hasAltTextData()&&(this.altTextData={alt:d,decorative:!1}),d}#g(){if(this.#e){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#e).then(i=>this.#h(i,!0)).finally(()=>this.#f());return}if(this.#n){const i=this.#n;this.#n=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromUrl(i).then(r=>this.#h(r)).finally(()=>this.#f());return}if(this.#s){const i=this.#s;this.#s=null,this._uiManager.enableWaiting(!0),this.#i=this._uiManager.imageManager.getFromFile(i).then(r=>this.#h(r)).finally(()=>this.#f());return}const t=document.createElement("input");t.type="file",t.accept=Zp.join(",");const e=this._uiManager._signal;this.#i=new Promise(i=>{t.addEventListener("change",async()=>{if(!t.files||t.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const r=await this._uiManager.imageManager.getFromFile(t.files[0]);this._reportTelemetry({action:"pdfjs.image.image_selected",data:{alt_text_modal:this._uiManager.useNewAltTextFlow}}),this.#h(r)}i()},{signal:e}),t.addEventListener("cancel",()=>{this.remove(),i()},{signal:e})}).finally(()=>this.#f()),t.click()}remove(){this.#e&&(this.#t=null,this._uiManager.imageManager.deleteId(this.#e),this.#r?.remove(),this.#r=null,this.#c&&(clearTimeout(this.#c),this.#c=null)),super.remove()}rebuild(){if(!this.parent){this.#e&&this.#g();return}super.rebuild(),this.div!==null&&(this.#e&&this.#r===null&&this.#g(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(t){this._isDraggable=!0,t&&this.div.focus()}isEmpty(){return!(this.#i||this.#t||this.#n||this.#s||this.#e||this.#o)}get toolbarButtons(){return[["altText",this.createAltText()]]}get isResizable(){return!0}render(){if(this.div)return this.div;let t,e;return this._isCopy&&(t=this.x,e=this.y),super.render(),this.div.hidden=!0,this.createAltText(),this.#o||(this.#t?this.#m():this.#g()),this._isCopy&&this._moveAfterPaste(t,e),this._uiManager.addShouldRescale(this),this.div}setCanvas(t,e){const{id:i,bitmap:r}=this._uiManager.imageManager.getFromCanvas(t,e);e.remove(),i&&this._uiManager.imageManager.isValidId(i)&&(this.#e=i,r&&(this.#t=r),this.#o=!1,this.#m())}_onResized(){this.onScaleChanging()}onScaleChanging(){if(!this.parent)return;this.#c!==null&&clearTimeout(this.#c);const t=200;this.#c=setTimeout(()=>{this.#c=null,this.#p()},t)}#m(){const{div:t}=this;let{width:e,height:i}=this.#t;const[r,l]=this.pageDimensions,c=.75;if(this.width)e=this.width*r,i=this.height*l;else if(e>c*r||i>c*l){const d=Math.min(c*r/e,c*l/i);e*=d,i*=d}this._uiManager.enableWaiting(!1);const u=this.#r=document.createElement("canvas");u.setAttribute("role","img"),this.addContainer(u),this.width=e/r,this.height=i/l,this.setDims(),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,(!this._uiManager.useNewAltTextWhenAddingImage||!this._uiManager.useNewAltTextFlow||this.annotationElementId)&&(t.hidden=!1),this.#p(),this.#d||(this.parent.addUndoableEditor(this),this.#d=!0),this._reportTelemetry({action:"inserted_image"}),this.#a&&this.div.setAttribute("aria-description",this.#a),this.annotationElementId||this._uiManager.a11yAlert("pdfjs-editor-stamp-added-alert")}copyCanvas(t,e,i=!1){t||(t=224);const{width:r,height:l}=this.#t,c=new Ts;let u=this.#t,d=r,f=l,p=null;if(e){if(r>e||l>e){const z=Math.min(e/r,e/l);d=Math.floor(r*z),f=Math.floor(l*z)}p=document.createElement("canvas");const w=p.width=Math.ceil(d*c.sx),A=p.height=Math.ceil(f*c.sy);this.#l||(u=this.#u(w,A));const _=p.getContext("2d");_.filter=this._uiManager.hcmFilter;let S="white",C="#cfcfd8";this._uiManager.hcmFilter!=="none"?C="black":HC.isDarkMode&&(S="#8f8f9d",C="#42414d");const M=15,k=M*c.sx,L=M*c.sy,j=new OffscreenCanvas(k*2,L*2),F=j.getContext("2d");F.fillStyle=S,F.fillRect(0,0,k*2,L*2),F.fillStyle=C,F.fillRect(0,0,k,L),F.fillRect(k,L,k,L),_.fillStyle=_.createPattern(j,"repeat"),_.fillRect(0,0,w,A),_.drawImage(u,0,0,u.width,u.height,0,0,w,A)}let y=null;if(i){let w,A;if(c.symmetric&&u.width<t&&u.height<t)w=u.width,A=u.height;else if(u=this.#t,r>t||l>t){const C=Math.min(t/r,t/l);w=Math.floor(r*C),A=Math.floor(l*C),this.#l||(u=this.#u(w,A))}const S=new OffscreenCanvas(w,A).getContext("2d",{willReadFrequently:!0});S.drawImage(u,0,0,u.width,u.height,0,0,w,A),y={width:w,height:A,data:S.getImageData(0,0,w,A).data}}return{canvas:p,width:d,height:f,imageData:y}}#u(t,e){const{width:i,height:r}=this.#t;let l=i,c=r,u=this.#t;for(;l>2*t||c>2*e;){const d=l,f=c;l>2*t&&(l=l>=16384?Math.floor(l/2)-1:Math.ceil(l/2)),c>2*e&&(c=c>=16384?Math.floor(c/2)-1:Math.ceil(c/2));const p=new OffscreenCanvas(l,c);p.getContext("2d").drawImage(u,0,0,d,f,0,0,l,c),u=p.transferToImageBitmap()}return u}#p(){const[t,e]=this.parentDimensions,{width:i,height:r}=this,l=new Ts,c=Math.ceil(i*t*l.sx),u=Math.ceil(r*e*l.sy),d=this.#r;if(!d||d.width===c&&d.height===u)return;d.width=c,d.height=u;const f=this.#l?this.#t:this.#u(c,u),p=d.getContext("2d");p.filter=this._uiManager.hcmFilter,p.drawImage(f,0,0,f.width,f.height,0,0,c,u)}#y(t){if(t){if(this.#l){const r=this._uiManager.imageManager.getSvgUrl(this.#e);if(r)return r}const e=document.createElement("canvas");return{width:e.width,height:e.height}=this.#t,e.getContext("2d").drawImage(this.#t,0,0),e.toDataURL()}if(this.#l){const[e,i]=this.pageDimensions,r=Math.round(this.width*e*cl.PDF_TO_CSS_UNITS),l=Math.round(this.height*i*cl.PDF_TO_CSS_UNITS),c=new OffscreenCanvas(r,l);return c.getContext("2d").drawImage(this.#t,0,0,this.#t.width,this.#t.height,0,0,r,l),c.transferToImageBitmap()}return structuredClone(this.#t)}static async deserialize(t,e,i){let r=null,l=!1;if(t instanceof i1){const{data:{rect:S,rotation:C,id:M,structParent:k,popupRef:L,richText:j,contentsObj:F,creationDate:z,modificationDate:H},container:ut,parent:{page:{pageNumber:ft}},canvas:_t}=t;let ct,Tt;_t?(delete t.canvas,{id:ct,bitmap:Tt}=i.imageManager.getFromCanvas(ut.id,_t),_t.remove()):(l=!0,t._hasNoCanvas=!0);const Lt=(await e._structTree.getAriaAttributes(`${Jo}${M}`))?.get("aria-label")||"";r=t={annotationType:ae.STAMP,bitmapId:ct,bitmap:Tt,pageIndex:ft-1,rect:S.slice(0),rotation:C,annotationElementId:M,id:M,deleted:!1,accessibilityData:{decorative:!1,altText:Lt},isSvg:!1,structParent:k,popupRef:L,richText:j,comment:F?.str||null,creationDate:z,modificationDate:H}}const c=await super.deserialize(t,e,i),{rect:u,bitmap:d,bitmapUrl:f,bitmapId:p,isSvg:y,accessibilityData:w}=t;l?(i.addMissingCanvas(t.id,c),c.#o=!0):p&&i.imageManager.isValidId(p)?(c.#e=p,d&&(c.#t=d)):c.#n=f,c.#l=y;const[A,_]=c.pageDimensions;return c.width=(u[2]-u[0])/A,c.height=(u[3]-u[1])/_,w&&(c.altTextData=w),c._initialData=r,t.comment&&c.setCommentData(t),c.#d=!!r,c}serialize(t=!1,e=null){if(this.isEmpty())return null;if(this.deleted)return this.serializeDeleted();const i=Object.assign(super.serialize(t),{bitmapId:this.#e,isSvg:this.#l});if(this.addComment(i),t)return i.bitmapUrl=this.#y(!0),i.accessibilityData=this.serializeAltText(!0),i.isCopy=!0,i;const{decorative:r,altText:l}=this.serializeAltText(!1);if(!r&&l&&(i.accessibilityData={type:"Figure",alt:l}),this.annotationElementId){const u=this.#v(i);return u.isSame?null:(u.isSameAltText?delete i.accessibilityData:i.accessibilityData.structParent=this._initialData.structParent??-1,i.id=this.annotationElementId,delete i.bitmapId,i)}if(e===null)return i;e.stamps||=new Map;const c=this.#l?(i.rect[2]-i.rect[0])*(i.rect[3]-i.rect[1]):null;if(!e.stamps.has(this.#e))e.stamps.set(this.#e,{area:c,serialized:i}),i.bitmap=this.#y(!1);else if(this.#l){const u=e.stamps.get(this.#e);c>u.area&&(u.area=c,u.serialized.bitmap.close(),u.serialized.bitmap=this.#y(!1))}return i}#v(t){const{pageIndex:e,accessibilityData:{altText:i}}=this._initialData,r=t.pageIndex===e,l=(t.accessibilityData?.alt||"")===i;return{isSame:!this.hasEditedComment&&!this._hasBeenMoved&&!this._hasBeenResized&&r&&l,isSameAltText:l}}renderAnnotationElement(t){return this.deleted?(t.hide(),null):(t.updateEdited({rect:this.getPDFRect(),popup:this.comment}),null)}}class rr{#t;#e=!1;#i=null;#n=null;#s=null;#a=new Map;#r=!1;#o=!1;#c=!1;#l=null;#d=null;#h=null;#f=null;#g=null;#m=-1;#u;static _initialized=!1;static#p=new Map([Rn,Gm,x2,ln,Ss].map(t=>[t._editorType,t]));constructor({uiManager:t,pageIndex:e,div:i,structTreeLayer:r,accessibilityManager:l,annotationLayer:c,drawLayer:u,textLayer:d,viewport:f,l10n:p}){const y=[...rr.#p.values()];if(!rr._initialized){rr._initialized=!0;for(const w of y)w.initialize(p,t)}t.registerEditorTypes(y),this.#u=t,this.pageIndex=e,this.div=i,this.#t=l,this.#i=c,this.viewport=f,this.#h=d,this.drawLayer=u,this._structTree=r,this.#u.addLayer(this)}updatePageIndex(t){this.pageIndex=t}get isEmpty(){return this.#a.size===0}get isInvisible(){return this.isEmpty&&this.#u.getMode()===ae.NONE}updateToolbar(t){this.#u.updateToolbar(t)}updateMode(t=this.#u.getMode()){switch(this.#w(),t){case ae.NONE:this.div.classList.toggle("nonEditing",!0),this.disableTextSelection(),this.togglePointerEvents(!1),this.toggleAnnotationLayerPointerEvents(!0),this.disableClick();return;case ae.INK:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick();break;case ae.HIGHLIGHT:this.enableTextSelection(),this.togglePointerEvents(!1),this.disableClick();break;default:this.disableTextSelection(),this.togglePointerEvents(!0),this.enableClick()}this.toggleAnnotationLayerPointerEvents(!1);const{classList:e}=this.div;if(e.toggle("nonEditing",!1),t===ae.POPUP)e.toggle("commentEditing",!0);else{e.toggle("commentEditing",!1);for(const i of rr.#p.values())e.toggle(`${i._type}Editing`,t===i._editorType)}this.div.hidden=!1}hasTextLayer(t){return t===this.#h?.div}setEditingState(t){this.#u.setEditingState(t)}addCommands(t){this.#u.addCommands(t)}cleanUndoStack(t){this.#u.cleanUndoStack(t)}toggleDrawing(t=!1){this.div.classList.toggle("drawing",!t)}togglePointerEvents(t=!1){this.div.classList.toggle("disabled",!t)}toggleAnnotationLayerPointerEvents(t=!1){this.#i?.togglePointerEvents(t)}get#y(){return this.#a.size!==0?this.#a.values():this.#u.getEditors(this.pageIndex)}async enable(){this.#c=!0,this.div.tabIndex=0,this.togglePointerEvents(!0),this.div.classList.toggle("nonEditing",!1),this.#g?.abort(),this.#g=null;const t=new Set;for(const i of this.#y)i.enableEditing(),i.show(!0),i.annotationElementId&&(this.#u.removeChangedExistingAnnotation(i),t.add(i.annotationElementId));const e=this.#i;if(e)for(const i of e.getEditableAnnotations()){if(i.hide(),this.#u.isDeletedAnnotationElement(i.data.id)||t.has(i.data.id))continue;const r=await this.deserialize(i);r&&(this.addOrRebuild(r),r.enableEditing())}this.#c=!1,this.#u._eventBus.dispatch("editorsrendered",{source:this,pageNumber:this.pageIndex+1})}disable(){if(this.#o=!0,this.div.tabIndex=-1,this.togglePointerEvents(!1),this.div.classList.toggle("nonEditing",!0),this.#h&&!this.#g){this.#g=new AbortController;const r=this.#u.combinedSignal(this.#g);this.#h.div.addEventListener("pointerdown",l=>{const{clientX:u,clientY:d,timeStamp:f}=l,p=this.#m;if(f-p>500){this.#m=f;return}this.#m=-1;const{classList:y}=this.div;y.toggle("getElements",!0);const w=document.elementsFromPoint(u,d);if(y.toggle("getElements",!1),!this.div.contains(w[0]))return;let A;const _=new RegExp(`^${Lc}[0-9]+$`);for(const C of w)if(_.test(C.id)){A=C.id;break}if(!A)return;const S=this.#a.get(A);S?.annotationElementId===null&&(l.stopPropagation(),l.preventDefault(),S.dblclick(l))},{signal:r,capture:!0})}const t=this.#i,e=[];if(t){const r=new Map,l=new Map;for(const u of this.#y){if(u.disableEditing(),!u.annotationElementId){e.push(u);continue}if(u.serialize()!==null){r.set(u.annotationElementId,u);continue}else l.set(u.annotationElementId,u);this.getEditableAnnotation(u.annotationElementId)?.show(),u.remove()}const c=t.getEditableAnnotations();for(const u of c){const{id:d}=u.data;if(this.#u.isDeletedAnnotationElement(d)){u.updateEdited({deleted:!0});continue}let f=l.get(d);if(f){f.resetAnnotationElement(u),f.show(!1),u.show();continue}f=r.get(d),f&&(this.#u.addChangedExistingAnnotation(f),f.renderAnnotationElement(u)&&f.show(!1)),u.show()}}this.#w(),this.isEmpty&&(this.div.hidden=!0);const{classList:i}=this.div;for(const r of rr.#p.values())i.remove(`${r._type}Editing`);this.disableTextSelection(),this.toggleAnnotationLayerPointerEvents(!0),t?.updateFakeAnnotations(e),this.#o=!1}getEditableAnnotation(t){return this.#i?.getEditableAnnotation(t)||null}setActiveEditor(t){this.#u.getActive()!==t&&this.#u.setActiveEditor(t)}enableTextSelection(){if(this.div.tabIndex=-1,this.#h?.div&&!this.#f){this.#f=new AbortController;const t=this.#u.combinedSignal(this.#f);this.#h.div.addEventListener("pointerdown",this.#v.bind(this),{signal:t}),this.#h.div.classList.add("highlighting")}}disableTextSelection(){this.div.tabIndex=0,this.#h?.div&&this.#f&&(this.#f.abort(),this.#f=null,this.#h.div.classList.remove("highlighting"))}#v(t){this.#u.unselectAll();const{target:e}=t;if(e===this.#h.div||(e.getAttribute("role")==="img"||e.classList.contains("endOfContent"))&&this.#h.div.contains(e)){const{isMac:i}=xn.platform;if(t.button!==0||t.ctrlKey&&i)return;this.#u.showAllEditors("highlight",!0,!0),this.#h.div.classList.add("free"),this.toggleDrawing(),ln.startHighlighting(this,this.#u.direction==="ltr",{target:this.#h.div,x:t.x,y:t.y}),this.#h.div.addEventListener("pointerup",()=>{this.#h.div.classList.remove("free"),this.toggleDrawing(!0)},{once:!0,signal:this.#u._signal}),t.preventDefault()}}enableClick(){if(this.#n)return;this.#n=new AbortController;const t=this.#u.combinedSignal(this.#n);this.div.addEventListener("pointerdown",this.pointerdown.bind(this),{signal:t});const e=this.pointerup.bind(this);this.div.addEventListener("pointerup",e,{signal:t}),this.div.addEventListener("pointercancel",e,{signal:t})}disableClick(){this.#n?.abort(),this.#n=null}attach(t){this.#a.set(t.id,t);const{annotationElementId:e}=t;e&&this.#u.isDeletedAnnotationElement(e)&&this.#u.removeDeletedAnnotationElement(t)}detach(t){this.#a.delete(t.id),this.#t?.removePointerInTextLayer(t.contentDiv),!this.#o&&t.annotationElementId&&this.#u.addDeletedAnnotationElement(t)}remove(t){this.detach(t),this.#u.removeEditor(t),t.div.remove(),t.isAttachedToDOM=!1}changeParent(t){t.parent!==this&&(t.parent&&t.annotationElementId&&(this.#u.addDeletedAnnotationElement(t),Zt.deleteAnnotationElement(t),t.annotationElementId=null),this.attach(t),t.parent?.detach(t),t.setParent(this),t.div&&t.isAttachedToDOM&&(t.div.remove(),this.div.append(t.div)))}add(t){if(!(t.parent===this&&t.isAttachedToDOM)){if(this.changeParent(t),this.#u.addEditor(t),this.attach(t),!t.isAttachedToDOM){const e=t.render();this.div.append(e),t.isAttachedToDOM=!0}t.fixAndSetPosition(),t.onceAdded(!this.#c),this.#u.addToAnnotationStorage(t),t._reportTelemetry(t.telemetryInitialData)}}moveEditorInDOM(t){if(!t.isAttachedToDOM)return;const{activeElement:e}=document;t.div.contains(e)&&!this.#s&&(t._focusEventsAllowed=!1,this.#s=setTimeout(()=>{this.#s=null,t.div.contains(document.activeElement)?t._focusEventsAllowed=!0:(t.div.addEventListener("focusin",()=>{t._focusEventsAllowed=!0},{once:!0,signal:this.#u._signal}),e.focus())},0)),t._structTreeParentId=this.#t?.moveElementInDOM(this.div,t.div,t.contentDiv,!0)}addOrRebuild(t){t.needsToBeRebuilt()?(t.parent||=this,t.rebuild(),t.show()):this.add(t)}addUndoableEditor(t){const e=()=>t._uiManager.rebuild(t),i=()=>{t.remove()};this.addCommands({cmd:e,undo:i,mustExec:!1})}getEditorByUID(t){for(const e of this.#a.values())if(e.uid===t)return e;return null}getNextId(){return this.#u.getId()}get#b(){return rr.#p.get(this.#u.getMode())}combinedSignal(t){return this.#u.combinedSignal(t)}#E(t){const e=this.#b;return e?new e.prototype.constructor(t):null}canCreateNewEmptyEditor(){return this.#b?.canCreateNewEmptyEditor()}async pasteEditor(t,e){this.updateToolbar(t),await this.#u.updateMode(t.mode);const{offsetX:i,offsetY:r}=this.#S(),l=this.getNextId(),c=this.#E({parent:this,id:l,x:i,y:r,uiManager:this.#u,isCentered:!0,...e});c&&this.add(c)}async deserialize(t){return await rr.#p.get(t.annotationType??t.annotationEditorType)?.deserialize(t,this,this.#u)||null}createAndAddNewEditor(t,e,i={}){const r=this.getNextId(),l=this.#E({parent:this,id:r,x:t.offsetX,y:t.offsetY,uiManager:this.#u,isCentered:e,...i});return l&&this.add(l),l}get boundingClientRect(){return this.div.getBoundingClientRect()}#S(){const{x:t,y:e,width:i,height:r}=this.boundingClientRect,l=Math.max(0,t),c=Math.max(0,e),u=Math.min(window.innerWidth,t+i),d=Math.min(window.innerHeight,e+r),f=(l+u)/2-t,p=(c+d)/2-e,[y,w]=this.viewport.rotation%180===0?[f,p]:[p,f];return{offsetX:y,offsetY:w}}addNewEditor(t={}){this.createAndAddNewEditor(this.#S(),!0,t)}setSelected(t){this.#u.setSelected(t)}toggleSelected(t){this.#u.toggleSelected(t)}unselect(t){this.#u.unselect(t)}pointerup(t){const{isMac:e}=xn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div||!this.#r||(this.#r=!1,this.#b?.isDrawer&&this.#b.supportMultipleDrawings))return;if(!this.#e){this.#e=!0;return}const i=this.#u.getMode();if(i===ae.STAMP||i===ae.SIGNATURE){this.#u.unselectAll();return}this.createAndAddNewEditor(t,!1)}pointerdown(t){if(this.#u.getMode()===ae.HIGHLIGHT&&this.enableTextSelection(),this.#r){this.#r=!1;return}const{isMac:e}=xn.platform;if(t.button!==0||t.ctrlKey&&e||t.target!==this.div)return;if(this.#r=!0,this.#b?.isDrawer){this.startDrawingSession(t);return}const i=this.#u.getActive();this.#e=!i||i.isEmpty()}startDrawingSession(t){if(this.div.focus({preventScroll:!0}),this.#l){this.#b.startDrawing(this,this.#u,!1,t);return}this.#u.setCurrentDrawingSession(this),this.#l=new AbortController;const e=this.#u.combinedSignal(this.#l);this.div.addEventListener("blur",({relatedTarget:i})=>{i&&!this.div.contains(i)&&(this.#d=null,this.commitOrRemove())},{signal:e}),this.#b.startDrawing(this,this.#u,!1,t)}pause(t){if(t){const{activeElement:e}=document;this.div.contains(e)&&(this.#d=e);return}this.#d&&setTimeout(()=>{this.#d?.focus(),this.#d=null},0)}endDrawingSession(t=!1){return this.#l?(this.#u.setCurrentDrawingSession(null),this.#l.abort(),this.#l=null,this.#d=null,this.#b.endDrawing(t)):null}findNewParent(t,e,i){const r=this.#u.findParent(e,i);return r===null||r===this?!1:(r.changeParent(t),!0)}commitOrRemove(){return this.#l?(this.endDrawingSession(),!0):!1}onScaleChanging(){this.#l&&this.#b.onScaleChangingWhenDrawing(this)}destroy(){this.commitOrRemove(),this.#u.getActive()?.parent===this&&(this.#u.commitOrRemove(),this.#u.setActiveEditor(null)),this.#s&&(clearTimeout(this.#s),this.#s=null);for(const t of this.#a.values())this.#t?.removePointerInTextLayer(t.contentDiv),t.setParent(null),t.isAttachedToDOM=!1,t.div.remove();this.div=null,this.#a.clear(),this.#u.removeLayer(this)}#w(){for(const t of this.#a.values())t.isEmpty()&&t.remove()}render({viewport:t}){this.viewport=t,Qa(this.div,t);for(const e of this.#u.getEditors(this.pageIndex))this.add(e),e.rebuild();this.updateMode()}update({viewport:t}){this.#u.commitOrRemove(),this.#w();const e=this.viewport.rotation,i=t.rotation;if(this.viewport=t,Qa(this.div,{rotation:i}),e!==i)for(const r of this.#a.values())r.rotate(i)}get pageDimensions(){const{pageWidth:t,pageHeight:e}=this.viewport.rawDims;return[t,e]}get scale(){return this.#u.viewParameters.realScale}}class jn{#t=null;#e=new Map;#i=new Map;static#n=0;setParent(t){if(!this.#t){this.#t=t;return}if(this.#t!==t){if(this.#e.size>0)for(const e of this.#e.values())e.remove(),t.append(e);this.#t=t}}static get _svgFactory(){return ie(this,"_svgFactory",new Vh)}static#s(t,[e,i,r,l]){const{style:c}=t;c.top=`${100*i}%`,c.left=`${100*e}%`,c.width=`${100*r}%`,c.height=`${100*l}%`}#a(){const t=jn._svgFactory.create(1,1,!0);return this.#t.append(t),t.setAttribute("aria-hidden",!0),t}#r(t,e){const i=jn._svgFactory.createElement("clipPath");t.append(i);const r=`clip_${e}`;i.setAttribute("id",r),i.setAttribute("clipPathUnits","objectBoundingBox");const l=jn._svgFactory.createElement("use");return i.append(l),l.setAttribute("href",`#${e}`),l.classList.add("clip"),r}#o(t,e){for(const[i,r]of Object.entries(e))r===null?t.removeAttribute(i):t.setAttribute(i,r)}draw(t,e=!1,i=!1){const r=jn.#n++,l=this.#a(),c=jn._svgFactory.createElement("defs");l.append(c);const u=jn._svgFactory.createElement("path");c.append(u);const d=`path_${r}`;u.setAttribute("id",d),u.setAttribute("vector-effect","non-scaling-stroke"),e&&this.#i.set(r,u);const f=i?this.#r(c,d):null,p=jn._svgFactory.createElement("use");return l.append(p),p.setAttribute("href",`#${d}`),this.updateProperties(l,t),this.#e.set(r,l),{id:r,clipPathId:`url(#${f})`}}drawOutline(t,e){const i=jn.#n++,r=this.#a(),l=jn._svgFactory.createElement("defs");r.append(l);const c=jn._svgFactory.createElement("path");l.append(c);const u=`path_${i}`;c.setAttribute("id",u),c.setAttribute("vector-effect","non-scaling-stroke");let d;if(e){const y=jn._svgFactory.createElement("mask");l.append(y),d=`mask_${i}`,y.setAttribute("id",d),y.setAttribute("maskUnits","objectBoundingBox");const w=jn._svgFactory.createElement("rect");y.append(w),w.setAttribute("width","1"),w.setAttribute("height","1"),w.setAttribute("fill","white");const A=jn._svgFactory.createElement("use");y.append(A),A.setAttribute("href",`#${u}`),A.setAttribute("stroke","none"),A.setAttribute("fill","black"),A.setAttribute("fill-rule","nonzero"),A.classList.add("mask")}const f=jn._svgFactory.createElement("use");r.append(f),f.setAttribute("href",`#${u}`),d&&f.setAttribute("mask",`url(#${d})`);const p=f.cloneNode();return r.append(p),f.classList.add("mainOutline"),p.classList.add("secondaryOutline"),this.updateProperties(r,t),this.#e.set(i,r),i}finalizeDraw(t,e){this.#i.delete(t),this.updateProperties(t,e)}updateProperties(t,e){if(!e)return;const{root:i,bbox:r,rootClass:l,path:c}=e,u=typeof t=="number"?this.#e.get(t):t;if(u){if(i&&this.#o(u,i),r&&jn.#s(u,r),l){const{classList:d}=u;for(const[f,p]of Object.entries(l))d.toggle(f,p)}if(c){const f=u.firstElementChild.firstElementChild;this.#o(f,c)}}}updateParent(t,e){if(e===this)return;const i=this.#e.get(t);i&&(e.#t.append(i),this.#e.delete(t),e.#e.set(t,i))}remove(t){this.#i.delete(t),this.#t!==null&&(this.#e.get(t).remove(),this.#e.delete(t))}destroy(){this.#t=null;for(const t of this.#e.values())t.remove();this.#e.clear(),this.#i.clear()}}globalThis._pdfjsTestingUtils={HighlightOutliner:rm};globalThis.pdfjsLib={AbortException:Zr,AnnotationEditorLayer:rr,AnnotationEditorParamsType:be,AnnotationEditorType:ae,AnnotationEditorUIManager:Jr,AnnotationLayer:qm,AnnotationMode:Yr,AnnotationType:yn,applyOpacity:GC,build:WT,ColorPicker:Zw,createValidAbsoluteUrl:Ew,CSSConstants:qC,DOMSVGFactory:Vh,DrawLayer:jn,FeatureTest:xn,fetchData:Vc,findContrastColor:$C,getDocument:Xw,getFilenameFromUrl:jC,getPdfFilenameFromUrl:FC,getRGB:Xc,getUuid:Cw,getXfaPageViewport:UC,GlobalWorkerOptions:rl,ImageKind:Lh,InvalidPDFException:Qp,isDataScheme:rd,isPdfFile:km,isValidExplicitDest:nT,MathClamp:Fn,noContextMenu:$i,normalizeUnicode:PC,OPS:Pc,OutputScale:Ts,PagesMapper:Ce,PasswordResponses:_C,PDFDataRangeTransport:Yw,PDFDateString:Wp,PDFWorker:jc,PermissionFlag:EC,PixelsPerInch:cl,RenderingCancelledException:Nm,renderRichText:Rw,ResponseException:Gh,setLayerDimensions:Qa,shadow:ie,SignatureExtractor:Zo,stopEvent:en,SupportedImageMimeTypes:Zp,TextLayer:_i,TouchManager:ad,updateUrlHash:_w,Util:qt,VerbosityLevel:ed,version:QT,XfaLayer:Tw};rl.workerSrc=new URL("/static/frontend/assets/pdf.worker-BA9kU3Pw.mjs",import.meta.url).toString();const A2=()=>typeof window<"u"&&window.devicePixelRatio||1;function S2(a,t){const e=Math.sqrt(t[2]*t[2]+t[3]*t[3]),i=Math.sqrt(t[0]*t[0]+t[1]*t[1]),r=e,l=r,c=typeof a.width=="number"&&a.width>0?a.width*i:(a.str?.length||1)*l*.5,u=t[4],d=t[5]-r*.85;return{x:u,y:d,w:c,h:l}}function E2(a,t,e){const r=(typeof document<"u"?document.createElement("canvas"):null)?.getContext("2d"),l=[];let c=0,u=-999;const d=4;let f=0;return a.items.forEach(p=>{if(!p.str||p.str.trim()==="")return;const y=qt.transform(t.transform,p.transform),w=S2(p,y);Math.abs(w.y-u)>d&&(c+=1,u=w.y);const A=w.h,_=typeof p.width=="number"&&p.width>0?p.width*e:w.w,S=p.str.split(/(\s+)/);if(!r||S.length===0){l.push({id:f++,text:p.str,x:w.x,y:w.y,w:w.w,h:w.h,fontSize:w.h,lineIndex:c});return}r.font=`${A}px sans-serif`;const C=S.map(j=>({text:j,measured:r.measureText(j).width,isSpace:/^\s+$/.test(j)||j===""})),M=C.reduce((j,F)=>j+F.measured,0),k=M>0?_/M:1;let L=0;C.forEach(j=>{const F=j.measured*k;if(j.text===""||j.isSpace){L+=F;return}l.push({id:f,text:j.text,x:w.x+L,y:w.y,w:F,h:A,fontSize:A,lineIndex:c}),f+=1,L+=F})}),l}function a1(a){const t={};return a.forEach(e=>{const i=e.lineIndex??Math.round(e.y/4)*4;t[i]||(t[i]=[]),t[i].push(e)}),Object.values(t)}function x0(a,t,e){let l=null,c=1/0;for(const u of a){if(!(e>=u.y-6&&e<=u.y+u.h+6))continue;if(t>=u.x-4&&t<=u.x+u.w+4)return u;const p=t<u.x?u.x-t:t-(u.x+u.w);p<c&&p<40&&(c=p,l=u)}return l}function _2(a){if(!a.length)return"";let t="";for(let e=0;e<a.length;e++){const i=a[e];if(e>0){const r=a[e-1];Math.abs(i.y-r.y)<6?i.x-(r.x+r.w)>1&&(t+=" "):t+=" "}t+=i.text}return t.trim()}function C2(a,t){return a.length?a1(a).map(i=>{const r=Math.min(...i.map(y=>y.x)),l=Math.max(...i.map(y=>y.x+y.w)),c=i.map(y=>y.y),u=c.sort((y,w)=>y-w)[Math.floor(c.length/2)],d=Math.max(...i.map(y=>y.h)),f=2;return{x:(r-1)/t,y:(u-f)/t,width:(l-r+2)/t,height:(d+f+3)/t}}):[]}function T2({pdfData:a,scale:t,highlights:e=[],hoveredHighlightId:i=null,activeHighlightId:r=null,selectionForPicker:l=null,onSelectionComplete:c,onNumPages:u,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y}){const[w,A]=U.useState(null),[_,S]=U.useState(0),[C,M]=U.useState(!0);return U.useEffect(()=>{if(!a)return;let k=!1;return(async()=>{M(!0);try{const j=a.slice(0),F=await Xw({data:j}).promise;k||(A(F),S(F.numPages),u?.(F.numPages))}catch(j){console.error("Failed to load PDF",j)}k||M(!1)})(),()=>{k=!0}},[a,u]),C?O.jsx("div",{className:"flex items-center justify-center h-full",children:O.jsx(or,{className:"w-6 h-6 text-slate-400 animate-spin"})}):w?O.jsx("div",{className:"flex flex-col items-center py-6 gap-4",children:Array.from({length:_},(k,L)=>O.jsx(R2,{pdf:w,pageNumber:L+1,scale:t,pageHighlights:e.filter(j=>j.page_number===L+1),hoveredHighlightId:i,activeHighlightId:r,selectionForPicker:l,onSelectionComplete:c,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y},L))}):null}function R2({pdf:a,pageNumber:t,scale:e,pageHighlights:i,hoveredHighlightId:r,activeHighlightId:l,selectionForPicker:c,onSelectionComplete:u,onHighlightHover:d,onHighlightHoverEnd:f,onHighlightEdit:p,onHighlightDelete:y}){const w=U.useRef(null),A=U.useRef(null),_=U.useRef(null),S=U.useRef(null),[C,M]=U.useState({width:0,height:0}),[k,L]=U.useState([]),[j,F]=U.useState(null),[z,H]=U.useState(null),[ut,ft]=U.useState(!1),_t=U.useRef(null),ct=U.useRef(null),Tt=U.useCallback(()=>{ct.current&&clearTimeout(ct.current),ct.current=setTimeout(()=>{f?.(),ct.current=null},1e3)},[f]),Lt=U.useCallback(Ct=>{ct.current&&(clearTimeout(ct.current),ct.current=null),d?.(Ct)},[d]);U.useEffect(()=>()=>{ct.current&&clearTimeout(ct.current)},[]),U.useEffect(()=>{let Ct=!1;return(async()=>{const J=await a.getPage(t),mt=A2(),xt=J.getViewport({scale:e}),It=J.getViewport({scale:e*mt}),Ut=A.current;if(!Ut||Ct)return;const Ot=Ut.getContext("2d",{alpha:!1});Ot.imageSmoothingEnabled=!0,Ot.imageSmoothingQuality="high",Ut.width=It.width,Ut.height=It.height,Ut.style.width=`${xt.width}px`,Ut.style.height=`${xt.height}px`,M({width:xt.width,height:xt.height}),await J.render({canvasContext:Ot,viewport:It}).promise;const Rt=await J.getTextContent();if(Ct)return;const jt=E2(Rt,xt,e);L(jt);const kt=_.current;!kt||Ct||(kt.innerHTML="",kt.style.width=`${xt.width}px`,kt.style.height=`${xt.height}px`,jt.forEach(we=>{const pt=document.createElement("span");pt.textContent=we.text,pt.style.position="absolute",pt.style.left=`${we.x}px`,pt.style.top=`${we.y}px`,pt.style.width=`${we.w}px`,pt.style.height=`${we.h}px`,pt.style.fontSize=`${we.fontSize}px`,pt.style.fontFamily="sans-serif",pt.style.color="transparent",pt.style.whiteSpace="pre",pt.style.pointerEvents="none",pt.style.lineHeight="1",kt.appendChild(pt)}))})(),()=>{Ct=!0}},[a,t,e]);const Bt=U.useMemo(()=>{if(c&&c.pageNumber===t){const J=Math.min(c.spanStart,c.spanEnd),mt=Math.max(c.spanStart,c.spanEnd);return k.filter(xt=>xt.id>=J&&xt.id<=mt)}if(j==null||z==null)return[];const Ct=Math.min(j,z),I=Math.max(j,z);return k.filter(J=>J.id>=Ct&&J.id<=I)},[k,c,t,j,z]);U.useEffect(()=>{c===null&&_t.current?.pageNumber===t&&(F(null),H(null)),_t.current=c},[c,t]);const Vt=U.useCallback((Ct,I)=>{const J=w.current?.getBoundingClientRect();return J?{x:Ct-J.left,y:I-J.top}:{x:0,y:0}},[]),G=U.useCallback(Ct=>{if(Ct.button!==0||!k.length)return;const{x:I,y:J}=Vt(Ct.clientX,Ct.clientY),mt=x0(k,I,J);mt?(F(mt.id),H(mt.id),ft(!0)):(F(null),H(null))},[k,Vt]),st=U.useCallback(Ct=>{if(!ut)return;const{x:I,y:J}=Vt(Ct.clientX,Ct.clientY),mt=x0(k,I,J);mt&&H(mt.id)},[ut,k,Vt]),wt=U.useCallback(Ct=>{if(Ct.button!==0||!ut)return;if(ft(!1),Bt.length<2){F(null),H(null);return}if(!u)return;const I=w.current?.getBoundingClientRect();if(!I)return;const J={rects:C2(Bt,e)},mt=_2(Bt),xt=Bt[Bt.length-1],It={x:I.left+(xt.x+xt.w/2),y:I.top+(xt.y-8)};u({pageNumber:t,position_data:J,highlighted_text:mt,spanStart:Math.min(j,z),spanEnd:Math.max(j,z),pickerPosition:It})},[ut,Bt,j,z,e,t,u]);U.useEffect(()=>{const Ct=S.current||w.current;if(Ct)return Ct.addEventListener("mousedown",G),Ct.addEventListener("mousemove",st),Ct.addEventListener("mouseup",wt),Ct.addEventListener("mouseleave",wt),()=>{Ct.removeEventListener("mousedown",G),Ct.removeEventListener("mousemove",st),Ct.removeEventListener("mouseup",wt),Ct.removeEventListener("mouseleave",wt)}},[G,st,wt]);const Yt=U.useMemo(()=>a1(Bt),[Bt]);return O.jsxs("div",{ref:w,"data-page":t,className:"relative shadow-lg bg-white overflow-hidden select-none",style:{width:C.width||0,height:C.height||0,cursor:"text"},title:"Drag to highlight text",children:[O.jsx("canvas",{ref:A,className:"block w-full h-full",style:{display:"block"}}),O.jsxs("div",{ref:S,className:"absolute inset-0",style:{pointerEvents:"auto"},children:[i.map(Ct=>{const I=Ct.position_data?.rects||[],J=di[Ct.color]||di.yellow,mt=r!=null&&String(Ct.id)===String(r),xt=l!=null&&String(Ct.id)===String(l),It=mt||xt?J.rgbaHover??J.rgba:J.rgbaSoft??J.rgba,Ut=p||y;let Ot=null;if(I.length>0){const Rt=Math.min(...I.map(pt=>pt.x))*e,jt=Math.min(...I.map(pt=>pt.y))*e,kt=Math.max(...I.map(pt=>(pt.x||0)+(pt.width||0)))*e,we=Math.max(...I.map(pt=>(pt.y||0)+(pt.height||4)))*e;Ot={left:Rt,top:jt,width:kt-Rt,height:we-jt}}return Ot?O.jsxs("div",{className:"absolute rounded-sm transition-colors duration-150 group",style:{left:Ot.left,top:Ot.top,width:Ot.width,height:Ot.height,pointerEvents:"auto"},onMouseEnter:()=>Lt(Ct.id),onMouseLeave:Tt,children:[I.map((Rt,jt)=>O.jsx("div",{className:"absolute rounded-sm transition-colors duration-150",style:{left:(Rt.x||0)*e-Ot.left,top:(Rt.y||0)*e-Ot.top,width:Math.max(0,(Rt.width||0)*e),height:Math.max(4,(Rt.height||0)*e),backgroundColor:It,pointerEvents:"none"}},jt)),Ut&&mt&&Ot&&O.jsxs("div",{className:"absolute flex items-center gap-0.5 rounded-md border border-slate-200 bg-white shadow-sm z-10",style:{left:0,bottom:"100%",marginBottom:4},onMouseEnter:()=>Lt(Ct.id),onMouseLeave:Tt,children:[p&&O.jsx("button",{type:"button",onClick:Rt=>{Rt.stopPropagation(),p(Ct.id,Rt)},className:"p-1.5 text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-l-md transition-colors",title:"Edit note","aria-label":"Edit note",children:O.jsx(Gp,{className:"w-3.5 h-3.5",strokeWidth:2})}),y&&O.jsx("button",{type:"button",onClick:Rt=>{Rt.stopPropagation(),y(Ct.id)},className:"p-1.5 text-slate-600 hover:text-red-600 hover:bg-red-50 rounded-r-md transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:O.jsx(Mm,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]},Ct.id):null}),Yt.map((Ct,I)=>{const J=Math.min(...Ct.map(jt=>jt.x)),mt=Math.max(...Ct.map(jt=>jt.x+jt.w)),xt=Ct.map(jt=>jt.y).sort((jt,kt)=>jt-kt),It=xt[Math.floor(xt.length/2)],Ut=Math.max(...Ct.map(jt=>jt.h)),Ot=2;return O.jsx("div",{className:"absolute rounded-sm pointer-events-none",style:{left:`${J-1}px`,top:`${It-Ot}px`,width:`${mt-J+2}px`,height:`${Ut+Ot+3}px`,backgroundColor:"rgba(59, 130, 246, 0.2)"}},I)})]}),O.jsx("div",{ref:_,className:"absolute inset-0 overflow-hidden pointer-events-none","aria-hidden":!0})]})}function M2({highlights:a,colorLabels:t,documentColorKeys:e,activeHighlightId:i,onScrollToPage:r,onHighlightClick:l,onHighlightHover:c,onHighlightHoverEnd:u,onClearActive:d,documentId:f,onHighlightNoteUpdate:p,onHighlightDelete:y,openEditForHighlightId:w,onClearOpenEditForHighlightId:A}){const _=e?.length>0?e:lr,[S,C]=U.useState("all"),[M,k]=U.useState(""),[L,j]=U.useState(null),[F,z]=U.useState("");U.useEffect(()=>{if(w==null||!a?.length)return;const ct=a.find(Tt=>String(Tt.id)===String(w));ct&&(j(ct.id),z(ct.note?.content??"")),A?.()},[w,a,A]);const H=U.useMemo(()=>{let ct=a||[];if(S!=="all"&&(ct=ct.filter(Tt=>Tt.color===S)),M.trim()){const Tt=M.trim().toLowerCase();ct=ct.filter(Lt=>Lt.highlighted_text&&Lt.highlighted_text.toLowerCase().includes(Tt)||Lt.note?.content&&Lt.note.content.toLowerCase().includes(Tt))}return ct},[a,S,M]),ut=ct=>{j(ct.id),z(ct.note?.content??"")},ft=async()=>{if(L==null||!f||!p){j(null);return}await p(L,F.trim()||""),j(null)},_t=()=>{j(null),z("")};return O.jsxs("div",{className:`w-80 shrink-0 flex flex-col border-l ${Un.default} ${Mn.surface}`,children:[O.jsxs("div",{className:`px-4 pt-5 pb-0 border-b ${Un.default}`,children:[O.jsx("h2",{className:`text-[15px] font-semibold ${Kt.heading} mb-1`,children:"Annotations"}),O.jsxs("p",{className:`text-xs ${Kt.muted} mb-4`,children:[H.length," highlight",H.length!==1?"s":"",a?.length!==H.length&&` of ${a?.length||0}`]}),O.jsxs("div",{className:"flex flex-wrap gap-1.5 mb-4",children:[O.jsx("button",{type:"button",onClick:()=>{C("all"),d?.()},className:`text-[11px] font-semibold px-3 py-1 rounded-full border cursor-pointer transition-colors ${S==="all"?"bg-slate-900 text-white border-slate-900":`border-slate-200 ${Kt.secondary} hover:bg-slate-50`}`,children:"All"}),_.map(ct=>{const Tt=(a||[]).filter(Bt=>Bt.color===ct).length,Lt=di[ct];return Lt?O.jsx("button",{type:"button",onClick:()=>{C(S===ct?"all":ct),d?.()},className:`w-7 h-7 rounded-full border-2 flex items-center justify-center text-[10px] font-bold cursor-pointer transition-all ${S===ct?"border-slate-800 scale-105":"border-transparent"}`,style:{backgroundColor:S===ct?Lt.hex??Lt.solid:`${Lt.hex??Lt.solid}25`,color:S===ct?"white":Lt.hex??Lt.solid},title:Es(ct,t),children:Tt},ct):null})]}),O.jsxs("div",{className:"relative mb-4",children:[O.jsx(oC,{className:"absolute left-2.5 top-1/2 -translate-y-1/2 w-3.5 h-3.5 text-slate-400",strokeWidth:2}),O.jsx("input",{type:"text",placeholder:"Search highlights...",value:M,onChange:ct=>k(ct.target.value),className:`w-full pl-8 pr-3 py-1.5 text-xs border ${Un.default} rounded-lg bg-slate-50 outline-none ${Kt.body} placeholder:${Kt.muted}`})]})]}),O.jsx("div",{className:"flex-1 overflow-auto px-3 pb-5",children:a?.length?H.length?O.jsx("ul",{className:"space-y-1.5",children:H.map(ct=>{const Tt=di[ct.color]||di.yellow,Lt=ct.note?.content,Bt=i!=null&&String(ct.id)===String(i);return O.jsx("li",{children:O.jsxs("div",{role:"button",tabIndex:0,className:`w-full text-left rounded-[10px] p-3 transition-all cursor-pointer border ${Bt?"border-slate-300":"border-transparent hover:border-slate-200"} hover:bg-slate-50`,onClick:()=>{l?.(ct.id),r?.(ct.page_number)},onKeyDown:Vt=>{Vt.target.tagName==="TEXTAREA"||Vt.target.tagName==="INPUT"||Vt.target.isContentEditable||(Vt.key==="Enter"||Vt.key===" ")&&(Vt.preventDefault(),l?.(ct.id),r?.(ct.page_number))},onMouseEnter:()=>c?.(ct.id),onMouseLeave:u,children:[O.jsxs("div",{className:"flex gap-2.5",children:[O.jsx("div",{className:"w-0.5 min-h-9 shrink-0 rounded-full transition-opacity",style:{backgroundColor:Tt.hex??Tt.solid,opacity:Bt?1:.6}}),O.jsx("div",{className:"flex-1 min-w-0",children:O.jsx("p",{className:`text-xs leading-snug ${Kt.body} line-clamp-3`,children:ct.highlighted_text||"(No text captured)"})})]}),L===ct.id?O.jsxs("div",{className:"mt-2 pl-3.5 space-y-1.5",children:[O.jsx("textarea",{value:F,onChange:Vt=>z(Vt.target.value),placeholder:"Add a comment...",rows:2,className:`w-full text-[11.5px] border ${Un.default} rounded-lg px-2 py-1.5 resize-none outline-none focus:ring-1 focus:ring-slate-300 ${Kt.body}`}),O.jsxs("div",{className:"flex gap-1.5",children:[O.jsx("button",{type:"button",onClick:ft,className:"text-[11px] font-medium px-2 py-1 rounded bg-slate-800 text-white hover:bg-slate-700",children:"Save"}),O.jsx("button",{type:"button",onClick:_t,className:"text-[11px] font-medium px-2 py-1 rounded text-slate-600 hover:bg-slate-100",children:"Cancel"})]})]}):O.jsxs(O.Fragment,{children:[Lt&&O.jsx("p",{className:`text-[11.5px] ${Kt.muted} mt-2 pl-3.5 leading-snug italic`,children:Lt}),f&&p&&O.jsx("button",{type:"button",onClick:()=>ut(ct),className:"mt-1.5 pl-3.5 text-[11px] text-slate-500 hover:text-slate-700",children:Lt?"Edit comment":"Add comment"})]}),O.jsxs("div",{className:"mt-2 pl-3.5 flex items-center gap-2 flex-wrap",children:[O.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:Tt.hex??Tt.solid,backgroundColor:`${Tt.hex??Tt.solid}12`},children:Es(ct.color,t)}),O.jsxs("span",{className:"text-[10px] text-slate-400",children:["p.",ct.page_number]}),f&&y&&O.jsx("button",{type:"button",onClick:Vt=>{Vt.stopPropagation(),y(ct.id)},className:"ml-auto p-1 rounded text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors",title:"Delete highlight","aria-label":"Delete highlight",children:O.jsx(Mm,{className:"w-3.5 h-3.5",strokeWidth:2})})]})]})},ct.id)})}):O.jsx("div",{className:`py-6 text-center ${Kt.muted} text-sm`,children:"No matching highlights."}):O.jsxs("div",{className:`py-8 text-center ${Kt.muted} text-sm`,children:[O.jsx(Aw,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),O.jsx("p",{children:"No highlights yet."}),O.jsx("p",{className:"mt-1 text-xs",children:"Select text on the document to create your first highlight."})]})})]})}const Mp=[{colorKey:"yellow",color:"#FBBF24",shortcut:"1"},{colorKey:"green",color:"#34D399",shortcut:"2"},{colorKey:"blue",color:"#60A5FA",shortcut:"3"},{colorKey:"pink",color:"#F472B6",shortcut:"4"},{colorKey:"orange",color:"#FB923C",shortcut:"5"}];function D2({position:a,onSelect:t,onClose:e,colorLabels:i,documentColorKeys:r}){const l=U.useRef(null),c=U.useRef(null),[u,d]=U.useState(null),[f,p]=U.useState(""),[y,w]=U.useState(!1),[A,_]=U.useState(!1),S=r?.length>0?r.map(F=>Mp.find(z=>z.colorKey===F)).filter(Boolean):Mp,C=S.length>0?S:Mp,M=U.useCallback(F=>Es(F,i),[i]);U.useEffect(()=>{y&&c.current&&c.current.focus()},[y]);const k=U.useCallback(F=>{d(F.colorKey),y||(t(F.colorKey,""),_(!0),setTimeout(()=>e(),400))},[y,t,e]),L=U.useCallback(()=>{u&&(t(u,f.trim()||void 0),_(!0),setTimeout(()=>e(),400))},[u,f,t,e]);if(U.useEffect(()=>{const F=z=>{if(z.key==="Escape"){e();return}if(!y){const H=parseInt(z.key,10);if(H>=1&&H<=C.length){const ut=C[H-1];ut&&k(ut)}}y&&z.key==="Enter"&&(z.metaKey||z.ctrlKey)&&(z.preventDefault(),L())};return window.addEventListener("keydown",F),()=>window.removeEventListener("keydown",F)},[y,u,f,e,k,L,C]),U.useEffect(()=>{const F=z=>{l.current&&!l.current.contains(z.target)&&e()};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[e]),U.useEffect(()=>{p(""),d(null),w(!1),_(!1)},[a]),!a)return null;const j=u?C.find(F=>F.colorKey===u):null;return O.jsx("div",{ref:l,className:"fixed z-[1000]",style:{left:a.x,top:a.y-48,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:A?O.jsxs("div",{className:"flex items-center gap-2 rounded-[10px] px-3.5 py-2 bg-white border border-slate-200 shadow-md",children:[O.jsx("div",{className:"flex h-[18px] w-[18px] items-center justify-center rounded-full",style:{background:j?.color??"#64748b"},children:O.jsx("svg",{width:"10",height:"10",viewBox:"0 0 12 12",fill:"none",children:O.jsx("path",{d:"M2 6L5 9L10 3",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),O.jsx("span",{className:"text-[13px] font-medium text-slate-800",children:"Saved"})]}):O.jsxs("div",{className:"overflow-hidden rounded-xl bg-white border border-slate-200 shadow-lg",style:{width:y?280:"auto",transition:"width 0.2s cubic-bezier(0.16, 1, 0.3, 1)"},children:[O.jsxs("div",{className:"flex items-center gap-0.5 p-1.5",children:[C.map((F,z)=>O.jsx("button",{type:"button",onClick:()=>k(F),title:`${M(F.colorKey)}${C.length<=5?` (${z+1})`:""}`,className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 hover:bg-slate-100",style:{background:u===F.colorKey?`${F.color}25`:"transparent"},children:O.jsx("div",{className:"h-4 w-4 rounded-full transition-[box-shadow,transform] duration-150",style:{background:F.color,boxShadow:u===F.colorKey?`0 0 0 2px ${F.color}80`:"none",transform:u===F.colorKey?"scale(1.15)":"scale(1)"}})},F.colorKey)),O.jsx("div",{className:"mx-0.5 h-4 w-px bg-slate-200"}),O.jsx("button",{type:"button",onClick:()=>w(!y),title:"Add note",className:`flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 transition-colors duration-150 ${y?"bg-slate-100":"hover:bg-slate-100"}`,children:O.jsxs("svg",{width:"14",height:"14",viewBox:"0 0 16 16",fill:"none",children:[O.jsx("path",{d:"M13 2.5H3C2.72386 2.5 2.5 2.72386 2.5 3V13C2.5 13.2761 2.72386 13.5 3 13.5H10L13.5 10V3C13.5 2.72386 13.2761 2.5 13 2.5Z",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"}),O.jsx("path",{d:"M5.5 6H10.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),O.jsx("path",{d:"M5.5 8.5H8.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round"}),O.jsx("path",{d:"M10 13.5V10H13.5",stroke:y?"#475569":"#64748b",strokeWidth:"1.2",strokeLinecap:"round",strokeLinejoin:"round"})]})}),O.jsx("button",{type:"button",onClick:e,className:"flex h-7 w-7 shrink-0 items-center justify-center rounded-lg border-0 bg-transparent text-slate-500 hover:bg-slate-100 hover:text-slate-700 transition-colors duration-150",children:O.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:O.jsx("path",{d:"M9 3L3 9M3 3L9 9",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round"})})})]}),y&&O.jsxs("div",{className:"px-2 pb-2 border-t border-slate-100 pt-2",style:{animation:"expandIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[!j&&O.jsx("div",{className:"px-1.5 pb-2 pt-1 text-[11px] text-slate-500",children:"Pick a category above, then add your note"}),j&&O.jsxs("div",{className:"flex items-center gap-1.5 px-1.5 pb-2 pt-0.5",children:[O.jsx("div",{className:"h-2 w-2 rounded-full shrink-0",style:{background:j.color}}),O.jsx("span",{className:"text-[11px] font-medium text-slate-600",children:M(j.colorKey)})]}),O.jsx("textarea",{ref:c,value:f,onChange:F=>p(F.target.value),placeholder:"Add a note...",rows:2,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200"}),O.jsx("div",{className:"mt-1.5 flex items-center justify-end",children:O.jsx("button",{type:"button",onClick:L,disabled:!j,className:"rounded-lg border-0 px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 disabled:opacity-50 disabled:cursor-default transition-colors",children:"Save"})})]})]})})}const _h="color_label_";function O2({colorLabels:a={},documentId:t,onSave:e,onClose:i}){const r=pl(),l=U.useRef(null),[c,u]=U.useState(()=>Object.keys(a||{}).length>0?Object.keys(a):[...lr]);U.useEffect(()=>{const C=Object.keys(a||{});u(C.length>0?C:[...lr])},[t,a]);const d=Dc({mutationFn:C=>ti.update(t,C),onSuccess:()=>{r.invalidateQueries({queryKey:["document",t]}),e?.()},onError:C=>{console.error("Failed to save color labels",C?.response?.data??C)}}),f=C=>{u(M=>M.filter(k=>k!==C))},p=C=>{c.includes(C)||u(M=>[...M,C].sort((k,L)=>lr.indexOf(k)-lr.indexOf(L)))},y=lr.filter(C=>!c.includes(C)),w=c.length<5&&y.length>0,A=C=>{if(C.preventDefault(),!t)return;const M=l.current;if(!M)return;const k={};c.forEach(L=>{const j=M.elements.namedItem(_h+L),F=j&&"value"in j?String(j.value).trim():"";k[L]=F}),d.mutate({color_labels:k})},_=C=>{C.target===C.currentTarget&&i()},S=O.jsx("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/40",onClick:_,children:O.jsxs("div",{role:"dialog","aria-modal":"true",className:`relative z-10 ${Mn.surface} rounded-xl shadow-xl border ${Un.default} w-full max-w-md mx-4 overflow-hidden max-h-[90vh] flex flex-col`,onClick:C=>C.stopPropagation(),onMouseDown:C=>C.stopPropagation(),children:[O.jsx("div",{className:"px-5 pt-5 pb-2 border-b border-slate-200 shrink-0",children:O.jsx("h3",{className:`text-base font-semibold ${Kt.heading}`,children:"Colours in this document"})}),O.jsxs("form",{ref:l,onSubmit:A,className:"p-5 space-y-4 overflow-auto flex-1 min-h-0",children:[c.map(C=>{const M=di[C],k=M?.name||C,L=(a&&a[C])??"";return O.jsxs("div",{className:"flex items-center gap-3",children:[O.jsx("div",{className:"h-8 w-8 rounded-full shrink-0 border-2 border-slate-200",style:{backgroundColor:M?.hex??M?.solid}}),O.jsxs("div",{className:"flex-1 min-w-0",children:[O.jsxs("label",{className:`text-xs ${Kt.muted} block mb-0.5`,htmlFor:_h+C,children:[M?.label??C," (default: ",k,")"]}),O.jsxs("div",{className:"flex items-center gap-2",children:[O.jsx("input",{id:_h+C,name:_h+C,type:"text",defaultValue:L,placeholder:k,className:`w-full rounded-lg border ${Un.default} px-3 py-2 text-sm ${Kt.body} placeholder:${Kt.muted} outline-none focus:ring-2 focus:ring-slate-300`}),O.jsx("button",{type:"button",onMouseDown:j=>{j.preventDefault(),j.stopPropagation(),f(C)},onClick:j=>{j.preventDefault(),j.stopPropagation(),f(C)},className:"shrink-0 p-2 rounded-lg text-slate-400 hover:text-red-600 hover:bg-red-50 transition-colors select-none",title:"Remove this colour from the document","aria-label":"Remove colour",children:O.jsx(Vp,{className:"w-4 h-4 pointer-events-none",strokeWidth:2})})]})]})]},C)}),w&&O.jsxs("div",{className:"pt-2 border-t border-slate-200",children:[O.jsx("p",{className:`text-xs ${Kt.muted} mb-2`,children:"Add a colour"}),O.jsx("div",{className:"flex flex-wrap gap-2",children:y.map(C=>{const M=di[C];return O.jsxs("button",{type:"button",onClick:()=>p(C),className:"flex items-center gap-2 rounded-lg border border-slate-200 px-3 py-2 text-sm text-slate-700 hover:bg-slate-50 transition-colors",children:[O.jsx("span",{className:"h-5 w-5 rounded-full border border-slate-200 shrink-0",style:{backgroundColor:M?.hex??M?.solid}}),O.jsx("span",{children:M?.label??C}),O.jsx(rC,{className:"w-4 h-4 text-slate-400",strokeWidth:2})]},C)})})]}),c.length===0&&O.jsx("p",{className:`text-sm ${Kt.muted}`,children:"No colours in this document. Add one above to use for highlights."}),d.isError&&O.jsx("p",{className:"text-sm text-red-600",children:d.error?.response?.data?.detail??d.error?.message??"Failed to save. Try again."}),O.jsxs("div",{className:"flex justify-end gap-2 pt-2 shrink-0",children:[O.jsx("button",{type:"button",onClick:i,className:"px-4 py-2 text-sm text-slate-600 hover:bg-slate-100 rounded-lg",children:"Cancel"}),O.jsx("button",{type:"submit",className:Ti,disabled:d.isPending,children:d.isPending?"Saving":"Save"})]})]})]})});return typeof document>"u"||!document.body?S:uS.createPortal(S,document.body)}function N2({position:a,initialValue:t="",onSave:e,onClose:i}){const[r,l]=U.useState(t),c=U.useRef(null),u=U.useRef(null);return U.useEffect(()=>{l(t)},[t,a]),U.useEffect(()=>{u.current?.focus()},[a]),U.useEffect(()=>{const d=f=>{f.key==="Escape"&&i(),f.key==="Enter"&&(f.metaKey||f.ctrlKey)&&(f.preventDefault(),e(r.trim()))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[r,e,i]),U.useEffect(()=>{const d=f=>{c.current&&!c.current.contains(f.target)&&i()};return document.addEventListener("mousedown",d),()=>document.removeEventListener("mousedown",d)},[i]),a?O.jsxs("div",{ref:c,className:"fixed z-[1001] w-64 rounded-xl border border-slate-200 bg-white p-3 shadow-lg",style:{left:a.x,top:a.y+6,transform:"translateX(-50%)",animation:"pickerIn 0.15s cubic-bezier(0.16, 1, 0.3, 1)"},children:[O.jsx("textarea",{ref:u,value:r,onChange:d=>l(d.target.value),placeholder:"Add a note...",rows:3,className:"w-full resize-none rounded-lg border border-slate-200 bg-slate-50 px-2.5 py-2 text-[13px] leading-relaxed text-slate-800 placeholder:text-slate-400 outline-none focus:border-slate-300 focus:ring-1 focus:ring-slate-200 mb-2"}),O.jsxs("div",{className:"flex items-center justify-end gap-2",children:[O.jsx("button",{type:"button",onClick:i,className:"rounded-lg px-2.5 py-1.5 text-xs font-medium text-slate-600 hover:bg-slate-100 transition-colors",children:"Cancel"}),O.jsx("button",{type:"button",onClick:()=>e(r.trim()),className:"rounded-lg px-3 py-1.5 text-xs font-medium bg-slate-800 text-white hover:bg-slate-700 transition-colors",children:"Save"})]})]}):null}function k2(){const{id:a}=dm(),t=ea(),e=pl(),[i,r]=U.useState(null),[l,c]=U.useState(!1),[u,d]=U.useState(!0),[f,p]=U.useState(1.3),[y,w]=U.useState(!0),[A,_]=U.useState(null),[S,C]=U.useState(null),[M,k]=U.useState(null),[L,j]=U.useState(null),[F,z]=U.useState(null),[H,ut]=U.useState(0),[ft,_t]=U.useState(1),[ct,Tt]=U.useState(!1),[Lt,Bt]=U.useState(null),[Vt,G]=U.useState(null),{data:st,isLoading:wt,isError:Yt}=Xa({queryKey:["document",a],queryFn:async()=>{const{data:pt}=await ti.get(a);return pt},enabled:!!a}),Ct=U.useMemo(()=>{const pt=Object.keys(st?.color_labels||{});return pt.length>0?pt:[...lr]},[st?.color_labels]);U.useEffect(()=>{if(!st||!a)return;let pt=!1;return(async()=>{d(!0);try{const ve=await AC(st);pt||(ve?r(ve.data):c(!0))}finally{pt||d(!1)}})(),()=>{pt=!0}},[st,a]);const{data:I=[]}=Xa({queryKey:["highlights",a],queryFn:async()=>{const{data:pt}=await ti.highlights(a);return pt},enabled:!!a}),J=U.useCallback(async pt=>{if(a)try{await ti.createHighlight(a,pt),e.invalidateQueries({queryKey:["highlights",a]}),k(null),j(null),z(null)}catch(fe){console.error("Failed to save highlight",fe)}},[a,e]),mt=U.useCallback(pt=>{k({page_number:pt.pageNumber,position_data:pt.position_data,highlighted_text:pt.highlighted_text}),j(pt.pickerPosition),z({pageNumber:pt.pageNumber,spanStart:pt.spanStart,spanEnd:pt.spanEnd})},[]),xt=U.useCallback((pt,fe)=>{M&&J({...M,color:pt,comment:fe})},[M,J]),It=U.useCallback(()=>{k(null),j(null),z(null)},[]),Ut=U.useCallback(pt=>{_t(pt),window.document.getElementById("pdf-scroll-container")?.querySelector(`[data-page="${pt}"]`)?.scrollIntoView({behavior:"smooth",block:"start"})},[]),Ot=U.useCallback(pt=>{C(fe=>fe!=null&&String(fe)===String(pt)?null:pt)},[]),Rt=U.useCallback(pt=>ut(pt??0),[]),jt=U.useCallback(()=>{if(ft<=1)return;const pt=ft-1;_t(pt),Ut(pt)},[ft,Ut]),kt=U.useCallback(()=>{if(ft>=H)return;const pt=ft+1;_t(pt),Ut(pt)},[ft,H,Ut]),we=async pt=>{const fe=pt.target.files?.[0];if(!fe||!st)return;const ve=await fe.arrayBuffer(),An=await Sw(ve);if(An!==st.pdf_hash){alert("This file does not match the original document.");return}await Om(An,fe.name,fe.size,ve),r(ve),c(!1)};return a?wt||u?O.jsx("div",{className:`${Cs} flex items-center justify-center min-h-[50vh]`,children:O.jsx(or,{className:`w-8 h-8 ${Kt.muted} animate-spin`})}):Yt||!st&&!wt?O.jsxs("div",{className:`${Cs} flex flex-col items-center justify-center min-h-[50vh]`,children:[O.jsx("h2",{className:`text-lg font-semibold ${Kt.heading} mb-2`,children:"Document not found"}),O.jsx("p",{className:`text-sm ${Kt.secondary} mb-4`,children:"It may have been deleted or you dont have access to it."}),O.jsx("button",{type:"button",onClick:()=>t(st?.project?`/project/${st.project}`:"/"),className:Ti,children:"Back to project"})]}):l?O.jsxs("div",{className:`${Cs} flex flex-col items-center justify-center`,children:[O.jsx($p,{className:`w-12 h-12 ${Kt.muted} mb-4`}),O.jsx("h2",{className:`text-lg font-semibold ${Kt.heading} mb-2`,children:"PDF needed on this device"}),O.jsxs("p",{className:`text-sm ${Kt.secondary} mb-4 text-center max-w-sm`,children:["Upload the same file to open ",O.jsx("strong",{children:st?.filename}),"."]}),O.jsxs("label",{className:`${Ti} inline-flex items-center gap-2`,children:[O.jsx($p,{className:"w-4 h-4"})," Upload PDF",O.jsx("input",{type:"file",accept:".pdf",onChange:we,className:"hidden"})]}),O.jsx("button",{type:"button",onClick:()=>t(st?.project?`/project/${st.project}`:"/"),className:`mt-4 text-sm ${Kt.muted} hover:underline`,children:"Back to project"})]}):O.jsxs("div",{className:`h-screen flex flex-col ${Mn.page} overflow-hidden`,children:[O.jsxs("header",{className:`${ww} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[O.jsxs("div",{className:"flex items-center gap-3",children:[O.jsx("button",{type:"button",onClick:()=>t(st?.project?`/project/${st.project}`:"/"),className:Ua,title:"Back to project",children:O.jsx(Rm,{className:"w-4 h-4"})}),O.jsx("p",{className:`text-sm font-medium ${Kt.heading} truncate max-w-xs`,children:st?.filename})]}),O.jsxs("div",{className:"flex items-center gap-2",children:[O.jsx("button",{type:"button",onClick:()=>Tt(!0),className:Ua,title:"Customise topic names",children:O.jsx(cC,{className:"w-4 h-4"})}),O.jsx("button",{type:"button",onClick:()=>t(`/document/${a}/summary`),className:Ua,title:"Summary",children:O.jsx(z_,{className:"w-4 h-4"})}),O.jsx("div",{className:zv}),O.jsxs("div",{className:`flex items-center gap-1 ${Mn.muted} rounded-lg px-1 py-0.5`,children:[O.jsx("button",{type:"button",onClick:()=>p(pt=>Math.max(.5,pt-.1)),className:`p-1.5 ${Kt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:O.jsx(gC,{className:"w-3.5 h-3.5"})}),O.jsxs("span",{className:`text-xs ${Kt.secondary} w-12 text-center`,children:[Math.round(f*100),"%"]}),O.jsx("button",{type:"button",onClick:()=>p(pt=>Math.min(3,pt+.1)),className:`p-1.5 ${Kt.secondary} hover:text-slate-700 rounded cursor-pointer`,children:O.jsx(pC,{className:"w-3.5 h-3.5"})})]}),O.jsx("div",{className:zv}),O.jsx("button",{type:"button",onClick:()=>w(pt=>!pt),className:Ua,title:y?"Close annotations":"Open annotations",children:y?O.jsx(tC,{className:"w-4 h-4"}):O.jsx(nC,{className:"w-4 h-4"})})]})]}),O.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[O.jsxs("div",{className:"flex-1 overflow-auto flex flex-col relative pb-14",id:"pdf-scroll-container",children:[i&&O.jsx(T2,{pdfData:i,scale:f,highlights:I,hoveredHighlightId:A,activeHighlightId:S,selectionForPicker:F,onSelectionComplete:mt,onNumPages:Rt,onHighlightHover:_,onHighlightHoverEnd:()=>_(null),onHighlightEdit:(pt,fe)=>{const ve=fe?.target?.getBoundingClientRect?.();ve?G({highlightId:pt,x:ve.left+ve.width/2,y:ve.bottom}):(Bt(pt),w(!0))},onHighlightDelete:async pt=>{a&&(await ti.deleteHighlight(a,pt),e.invalidateQueries({queryKey:["highlights",a]}),String(S)===String(pt)&&C(null),String(A)===String(pt)&&_(null))}}),L&&O.jsx(D2,{position:L,onSelect:xt,onClose:It,colorLabels:st?.color_labels,documentColorKeys:Ct}),Vt&&O.jsx(N2,{position:{x:Vt.x,y:Vt.y},initialValue:(I||[]).find(pt=>String(pt.id)===String(Vt.highlightId))?.note?.content??"",onSave:async pt=>{a&&(await ti.updateHighlight(a,Vt.highlightId,{note:pt}),e.invalidateQueries({queryKey:["highlights",a]}),G(null))},onClose:()=>G(null)}),ct&&O.jsx(O2,{colorLabels:st?.color_labels||{},documentId:a,onSave:()=>{e.invalidateQueries({queryKey:["document",a]}),Tt(!1)},onClose:()=>Tt(!1)})]}),y&&O.jsx(M2,{highlights:I,colorLabels:st?.color_labels,documentColorKeys:Ct,activeHighlightId:S,onScrollToPage:Ut,onHighlightClick:Ot,onHighlightHover:_,onHighlightHoverEnd:()=>_(null),onClearActive:()=>C(null),documentId:a,openEditForHighlightId:Lt,onClearOpenEditForHighlightId:()=>Bt(null),onHighlightNoteUpdate:async(pt,fe)=>{a&&(await ti.updateHighlight(a,pt,{note:fe}),e.invalidateQueries({queryKey:["highlights",a]}))},onHighlightDelete:async pt=>{a&&(await ti.deleteHighlight(a,pt),e.invalidateQueries({queryKey:["highlights",a]}),String(S)===String(pt)&&C(null),String(A)===String(pt)&&_(null))}})]}),H>0&&O.jsxs("div",{className:`fixed bottom-0 left-0 z-10 flex items-center justify-center gap-2 border-t border-slate-200 bg-white py-2.5 shadow-[0_-2px_8px_rgba(0,0,0,0.06)] ${y?"right-80":"right-0"}`,children:[O.jsx("button",{type:"button",onClick:jt,disabled:ft<=1,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""}),O.jsxs("span",{className:"min-w-[80px] text-center text-xs text-slate-500",children:["Page ",ft," of ",H]}),O.jsx("button",{type:"button",onClick:kt,disabled:ft>=H,className:"flex h-8 w-8 items-center justify-center rounded-md border border-slate-200 bg-white text-slate-600 disabled:opacity-30 disabled:cursor-default cursor-pointer hover:bg-slate-50 text-sm",children:""})]})]}):(t("/",{replace:!0}),null)}const Ch="sequence",Th="topic";function L2(){const{id:a}=dm(),t=ea(),[e,i]=U.useState(Ch),{data:r,isLoading:l,isError:c}=Xa({queryKey:["document",a],queryFn:async()=>{const{data:y}=await ti.get(a);return y},enabled:!!a}),{data:u=[]}=Xa({queryKey:["highlights",a],queryFn:async()=>{const{data:y}=await ti.highlights(a);return y},enabled:!!a}),d=r?.color_labels||{},f=U.useMemo(()=>{const y=[...u||[]];return e===Ch?(y.sort((w,A)=>w.page_number!==A.page_number?w.page_number-A.page_number:new Date(w.created_at)-new Date(A.created_at)),y):(y.sort((w,A)=>{const _=Es(w.color,d),S=Es(A.color,d);return _!==S?_.localeCompare(S):w.page_number!==A.page_number?w.page_number-A.page_number:new Date(w.created_at)-new Date(A.created_at)}),y)},[u,e,d]),p=U.useMemo(()=>{if(e!==Th)return[];const y={};return(u||[]).forEach(w=>{const A=Es(w.color,d);y[A]||(y[A]=[]),y[A].push(w)}),lr.forEach(w=>{const A=Es(w,d);y[A]&&y[A].sort((_,S)=>_.page_number!==S.page_number?_.page_number-S.page_number:new Date(_.created_at)-new Date(S.created_at))}),lr.map(w=>({topic:Es(w,d),colorKey:w,items:y[Es(w,d)]||[]})).filter(w=>w.items.length>0)},[u,e,d]);return a?l?O.jsx("div",{className:`${Cs} flex items-center justify-center min-h-[50vh]`,children:O.jsx(or,{className:`w-8 h-8 ${Kt.muted} animate-spin`})}):c||!r?O.jsxs("div",{className:`${Cs} flex flex-col items-center justify-center min-h-[50vh]`,children:[O.jsx("h2",{className:`text-lg font-semibold ${Kt.heading} mb-2`,children:"Document not found"}),O.jsx("button",{type:"button",onClick:()=>t(r?.project?`/project/${r.project}`:"/"),className:Ti,children:"Back to project"})]}):O.jsxs("div",{className:`min-h-screen flex flex-col ${Mn.page}`,children:[O.jsxs("header",{className:`${ww} px-4 py-2.5 flex items-center justify-between shrink-0`,children:[O.jsxs("div",{className:"flex items-center gap-3",children:[O.jsx("button",{type:"button",onClick:()=>t(`/document/${a}`),className:Ua,children:O.jsx(Rm,{className:"w-4 h-4"})}),O.jsxs("div",{children:[O.jsx("h1",{className:`text-sm font-semibold ${Kt.heading}`,children:"Summary"}),O.jsx("p",{className:`text-xs ${Kt.muted} truncate max-w-[200px]`,children:r.filename})]})]}),O.jsxs("div",{className:"flex items-center gap-1 rounded-lg border border-slate-200 p-0.5 bg-slate-50",children:[O.jsxs("button",{type:"button",onClick:()=>i(Ch),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===Ch?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[O.jsx(Y_,{className:"w-3.5 h-3.5"}),"Sequence"]}),O.jsxs("button",{type:"button",onClick:()=>i(Th),className:`flex items-center gap-1.5 px-3 py-1.5 rounded-md text-xs font-medium transition-colors ${e===Th?"bg-white text-slate-800 shadow-sm":"text-slate-600 hover:text-slate-800"}`,children:[O.jsx(K_,{className:"w-3.5 h-3.5"}),"Topic"]})]})]}),O.jsx("main",{className:"flex-1 overflow-auto p-6 max-w-3xl mx-auto w-full",children:u?.length?e===Th&&p.length>0?O.jsx("div",{className:"space-y-8",children:p.map(({topic:y,colorKey:w,items:A})=>{const _=di[w]||di.yellow;return O.jsxs("section",{children:[O.jsxs("h2",{className:"text-sm font-semibold text-slate-800 mb-3 pb-2 border-b border-slate-200 flex items-center gap-2",children:[O.jsx("span",{className:"w-2.5 h-2.5 rounded-full shrink-0",style:{backgroundColor:_.hex??_.solid}}),y,O.jsxs("span",{className:"text-slate-400 font-normal text-xs",children:["(",A.length,")"]})]}),O.jsx("ul",{className:"space-y-3",children:A.map(S=>O.jsxs("li",{className:`rounded-lg border ${Un.default} ${Mn.surface} p-4`,children:[O.jsx("p",{className:`text-sm ${Kt.body} leading-snug`,children:S.highlighted_text||"(No text captured)"}),S.note?.content&&O.jsx("p",{className:`text-xs ${Kt.muted} mt-2 italic`,children:S.note.content}),O.jsxs("p",{className:`text-[11px] ${Kt.muted} mt-2`,children:["p.",S.page_number]})]},S.id))})]},y)})}):O.jsx("ul",{className:"space-y-3",children:f.map(y=>{const w=di[y.color]||di.yellow,A=Es(y.color,d);return O.jsxs("li",{className:`rounded-lg border ${Un.default} ${Mn.surface} p-4 flex gap-3`,children:[O.jsx("div",{className:"w-1 min-h-8 rounded-full shrink-0",style:{backgroundColor:w.hex??w.solid}}),O.jsxs("div",{className:"min-w-0 flex-1",children:[O.jsx("p",{className:`text-sm ${Kt.body} leading-snug`,children:y.highlighted_text||"(No text captured)"}),y.note?.content&&O.jsx("p",{className:`text-xs ${Kt.muted} mt-2 italic`,children:y.note.content}),O.jsxs("div",{className:"mt-2 flex items-center gap-2 flex-wrap",children:[O.jsx("span",{className:"text-[10px] font-semibold px-2 py-0.5 rounded",style:{color:w.hex??w.solid,backgroundColor:`${w.hex??w.solid}18`},children:A}),O.jsxs("span",{className:`text-[11px] ${Kt.muted}`,children:["p.",y.page_number]})]})]})]},y.id)})}):O.jsxs("div",{className:`py-12 text-center ${Kt.muted} text-sm`,children:[O.jsx("p",{children:"No highlights yet."}),O.jsx("p",{className:"mt-1",children:"Select text in the document to create highlights, then return here for a summary."}),O.jsx("button",{type:"button",onClick:()=>t(`/document/${a}`),className:`${Ti} mt-4`,children:"Open document"})]})})]}):(t("/",{replace:!0}),null)}const P2=new LS({defaultOptions:{queries:{staleTime:3e4,retry:1}}});function jh({children:a}){return na(e=>e.token)?a:O.jsx(mm,{to:"/login",replace:!0})}function A0({children:a}){return na(e=>e.token)?O.jsx(mm,{to:"/",replace:!0}):a}function B2(){return na(t=>t.token)?O.jsx(jh,{children:O.jsx(yC,{})}):O.jsx(N_,{})}function j2(){return O.jsx(PS,{client:P2,children:O.jsx(tS,{children:O.jsxs(DA,{children:[O.jsx(Xr,{path:"/login",element:O.jsx(A0,{children:O.jsx(D_,{})})}),O.jsx(Xr,{path:"/register",element:O.jsx(A0,{children:O.jsx(O_,{})})}),O.jsx(Xr,{path:"/",element:O.jsx(B2,{})}),O.jsx(Xr,{path:"/project/:projectId",element:O.jsx(jh,{children:O.jsx(SC,{})})}),O.jsx(Xr,{path:"/document/:id",element:O.jsx(jh,{children:O.jsx(k2,{})})}),O.jsx(Xr,{path:"/document/:id/summary",element:O.jsx(jh,{children:O.jsx(L2,{})})}),O.jsx(Xr,{path:"*",element:O.jsx(mm,{to:"/",replace:!0})})]})})})}kx.createRoot(document.getElementById("root")).render(O.jsx(U.StrictMode,{children:O.jsx(j2,{})}));
